GAS LISTING /tmp/ccnOh1is.s 			page 1


   1              		.file	"vsprintf_s.c"
   2              		.text
   3              	.Ltext0:
   4              		.section	.text.vsprintf_s,"ax",@progbits
   5              		.globl	vsprintf_s
   7              	vsprintf_s:
   8              	.LFB6:
   9              		.file 1 "/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c"
   1:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c **** /*
   2:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  * Copyright (c) [2019] Huawei Technologies Co.,Ltd.All rights reserved.
   3:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  *
   4:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  * OpenArkCompiler is licensed under the Mulan PSL v1. 
   5:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  * You can use this software according to the terms and conditions of the Mulan PSL v1.
   6:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  * You may obtain a copy of Mulan PSL v1 at:
   7:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  *
   8:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  * 	http://license.coscl.org.cn/MulanPSL 
   9:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  *
  10:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  * THIS SOFTWARE IS PROVIDED ON AN "AS IS" BASIS, WITHOUT WARRANTIES OF ANY KIND, EITHER 
  11:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO NON-INFRINGEMENT, MERCHANTABILITY OR
  12:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  * FIT FOR A PARTICULAR PURPOSE.  
  13:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  * See the Mulan PSL v1 for more details.  
  14:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  */
  15:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c **** 
  16:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c **** #include "secureprintoutput.h"
  17:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c **** 
  18:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c **** /*
  19:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  * <FUNCTION DESCRIPTION>
  20:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  *    The vsprintf_s function is equivalent to the vsprintf function
  21:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  *    except for the parameter destMax and the explicit runtime-constraints violation
  22:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  *    The vsprintf_s function takes a pointer to an argument list, and then formats
  23:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  *    and writes the given data to the memory pointed to by strDest.
  24:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  *    The function differ from the non-secure versions only in that the secure
  25:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  *    versions support positional parameters.
  26:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  *
  27:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  * <INPUT PARAMETERS>
  28:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  *    strDest                Storage location for the output.
  29:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  *    destMax                Size of strDest
  30:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  *    format                 Format specification.
  31:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  *    argList                   pointer to list of arguments
  32:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  *
  33:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  * <OUTPUT PARAMETERS>
  34:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  *    strDest                is updated
  35:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  *
  36:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  * <RETURN VALUE>
  37:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  *    return  the number of characters written, not including the terminating null character,
  38:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  *    return -1  if an  error occurs.
  39:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  *
  40:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  * If there is a runtime-constraint violation, strDest[0] will be set to the '\0' when strDest and 
  41:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****  */
  42:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c **** int vsprintf_s(char *strDest, size_t destMax, const char *format, va_list argList)
  43:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c **** {
  10              		.loc 1 43 1
  11              		.cfi_startproc
  12 0000 F30F1EFA 		endbr64
  13 0004 55       		pushq	%rbp
  14              	.LCFI0:
  15              		.cfi_def_cfa_offset 16
GAS LISTING /tmp/ccnOh1is.s 			page 2


  16              		.cfi_offset 6, -16
  17 0005 4889E5   		movq	%rsp, %rbp
  18              	.LCFI1:
  19              		.cfi_def_cfa_register 6
  20 0008 4883EC30 		subq	$48, %rsp
  21 000c 48897DE8 		movq	%rdi, -24(%rbp)
  22 0010 488975E0 		movq	%rsi, -32(%rbp)
  23 0014 488955D8 		movq	%rdx, -40(%rbp)
  24 0018 48894DD0 		movq	%rcx, -48(%rbp)
  25              		.loc 1 43 1
  26 001c 64488B04 		movq	%fs:40, %rax
  26      25280000 
  26      00
  27 0025 488945F8 		movq	%rax, -8(%rbp)
  28 0029 31C0     		xorl	%eax, %eax
  44:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****     int retVal;               /* If initialization causes  e838 */
  45:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c **** 
  46:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****     if (format == NULL || strDest == NULL || destMax == 0 || destMax > SECUREC_STRING_MAX_LEN) {
  29              		.loc 1 46 8
  30 002b 48837DD8 		cmpq	$0, -40(%rbp)
  30      00
  31 0030 7419     		je	.L2
  32              		.loc 1 46 24 discriminator 1
  33 0032 48837DE8 		cmpq	$0, -24(%rbp)
  33      00
  34 0037 7412     		je	.L2
  35              		.loc 1 46 43 discriminator 2
  36 0039 48837DE0 		cmpq	$0, -32(%rbp)
  36      00
  37 003e 740B     		je	.L2
  38              		.loc 1 46 59 discriminator 3
  39 0040 B8000000 		movl	$2147483648, %eax
  39      80
  40 0045 483945E0 		cmpq	%rax, -32(%rbp)
  41 0049 7227     		jb	.L3
  42              	.L2:
  47:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****         if (strDest != NULL && destMax > 0 && destMax <= SECUREC_STRING_MAX_LEN) {
  43              		.loc 1 47 12
  44 004b 48837DE8 		cmpq	$0, -24(%rbp)
  44      00
  45 0050 7419     		je	.L4
  46              		.loc 1 47 29 discriminator 1
  47 0052 48837DE0 		cmpq	$0, -32(%rbp)
  47      00
  48 0057 7412     		je	.L4
  49              		.loc 1 47 44 discriminator 2
  50 0059 B8000000 		movl	$2147483648, %eax
  50      80
  51 005e 483945E0 		cmpq	%rax, -32(%rbp)
  52 0062 7307     		jnb	.L4
  48:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****             strDest[0] = '\0';
  53              		.loc 1 48 24
  54 0064 488B45E8 		movq	-24(%rbp), %rax
  55 0068 C60000   		movb	$0, (%rax)
  56              	.L4:
  49:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****         }
  50:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****         SECUREC_ERROR_INVALID_PARAMTER("vsprintf_s");
GAS LISTING /tmp/ccnOh1is.s 			page 3


  51:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****         return -1;
  57              		.loc 1 51 16
  58 006b B8FFFFFF 		movl	$-1, %eax
  58      FF
  59 0070 EB32     		jmp	.L5
  60              	.L3:
  52:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****     }
  53:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c **** 
  54:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****     retVal = SecVsnprintfImpl(strDest, destMax, format, argList);
  61              		.loc 1 54 14
  62 0072 488B4DD0 		movq	-48(%rbp), %rcx
  63 0076 488B55D8 		movq	-40(%rbp), %rdx
  64 007a 488B75E0 		movq	-32(%rbp), %rsi
  65 007e 488B45E8 		movq	-24(%rbp), %rax
  66 0082 4889C7   		movq	%rax, %rdi
  67 0085 E8000000 		call	SecVsnprintfImpl@PLT
  67      00
  68 008a 8945F4   		movl	%eax, -12(%rbp)
  55:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c **** 
  56:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****     if (retVal < 0) {
  69              		.loc 1 56 8
  70 008d 837DF400 		cmpl	$0, -12(%rbp)
  71 0091 790E     		jns	.L6
  57:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****         strDest[0] = '\0';
  72              		.loc 1 57 20
  73 0093 488B45E8 		movq	-24(%rbp), %rax
  74 0097 C60000   		movb	$0, (%rax)
  58:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****         if (retVal == SECUREC_PRINTF_TRUNCATE) {
  59:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****             /* Buffer is too small */
  60:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****             SECUREC_ERROR_INVALID_RANGE("vsprintf_s");
  61:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****         }
  62:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****         SECUREC_ERROR_INVALID_PARAMTER("vsprintf_s");
  63:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****         return -1;
  75              		.loc 1 63 16
  76 009a B8FFFFFF 		movl	$-1, %eax
  76      FF
  77 009f EB03     		jmp	.L5
  78              	.L6:
  64:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****     }
  65:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c **** 
  66:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c ****     return retVal;
  79              		.loc 1 66 12
  80 00a1 8B45F4   		movl	-12(%rbp), %eax
  81              	.L5:
  67:/home/xingli/share/LiteOS_Lab/secure_c/src/vsprintf_s.c **** }
  82              		.loc 1 67 1
  83 00a4 488B7DF8 		movq	-8(%rbp), %rdi
  84 00a8 6448333C 		xorq	%fs:40, %rdi
  84      25280000 
  84      00
  85 00b1 7405     		je	.L7
  86 00b3 E8000000 		call	__stack_chk_fail@PLT
  86      00
  87              	.L7:
  88 00b8 C9       		leave
  89              	.LCFI2:
  90              		.cfi_def_cfa 7, 8
GAS LISTING /tmp/ccnOh1is.s 			page 4


  91 00b9 C3       		ret
  92              		.cfi_endproc
  93              	.LFE6:
  95              		.text
  96              	.Letext0:
  97              		.file 2 "<built-in>"
  98              		.file 3 "/usr/lib/gcc/x86_64-linux-gnu/9/include/stddef.h"
  99              		.file 4 "/usr/include/x86_64-linux-gnu/bits/types.h"
 100              		.file 5 "/usr/include/x86_64-linux-gnu/bits/types/struct_FILE.h"
 101              		.file 6 "/usr/include/x86_64-linux-gnu/bits/types/FILE.h"
 102              		.file 7 "/usr/include/stdio.h"
 103              		.file 8 "/usr/include/x86_64-linux-gnu/bits/sys_errlist.h"
 1126              		.section	.note.gnu.property,"a"
 1127              		.align 8
 1128 0000 04000000 		.long	 1f - 0f
 1129 0004 10000000 		.long	 4f - 1f
 1130 0008 05000000 		.long	 5
 1131              	0:
 1132 000c 474E5500 		.string	 "GNU"
 1133              	1:
 1134              		.align 8
 1135 0010 020000C0 		.long	 0xc0000002
 1136 0014 04000000 		.long	 3f - 2f
 1137              	2:
 1138 0018 03000000 		.long	 0x3
 1139              	3:
 1140 001c 00000000 		.align 8
 1141              	4:
GAS LISTING /tmp/ccnOh1is.s 			page 5


DEFINED SYMBOLS
                            *ABS*:0000000000000000 vsprintf_s.c
     /tmp/ccnOh1is.s:7      .text.vsprintf_s:0000000000000000 vsprintf_s

UNDEFINED SYMBOLS
_GLOBAL_OFFSET_TABLE_
SecVsnprintfImpl
__stack_chk_fail
