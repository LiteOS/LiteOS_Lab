GAS LISTING /tmp/cc1ytava.s 			page 1


   1              		.file	"secureinput_w.c"
   2              		.text
   3              	.Ltext0:
   4              		.section	.text.SecIs64BitPtr,"ax",@progbits
   6              	SecIs64BitPtr:
   7              	.LFB6:
   8              		.file 1 "/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl"
   1:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
   2:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * Copyright (c) [2019] Huawei Technologies Co.,Ltd.All rights reserved.
   3:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  *
   4:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * OpenArkCompiler is licensed under the Mulan PSL v1. 
   5:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * You can use this software according to the terms and conditions of the Mulan PSL v1.
   6:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * You may obtain a copy of Mulan PSL v1 at:
   7:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  *
   8:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * 	http://license.coscl.org.cn/MulanPSL 
   9:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  *
  10:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * THIS SOFTWARE IS PROVIDED ON AN "AS IS" BASIS, WITHOUT WARRANTIES OF ANY KIND, EITHER 
  11:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO NON-INFRINGEMENT, MERCHANTABILITY OR
  12:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * FIT FOR A PARTICULAR PURPOSE.  
  13:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * See the Mulan PSL v1 for more details.  
  14:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
  15:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /* [Standardize-exceptions] Use unsafe function: Performance-sensitive
  16:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * [reason] Always used in the performance critical path,
  17:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  *          and sufficient input validation is performed before calling
  18:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
  19:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
  20:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifndef INPUT_INL_5D13A042_DC3F_4ED9_A8D1_882811274C27
  21:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define INPUT_INL_5D13A042_DC3F_4ED9_A8D1_882811274C27
  22:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
  23:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if SECUREC_IN_KERNEL
  24:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #include <linux/ctype.h>
  25:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifndef EOF
  26:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define EOF  (-1)
  27:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
  28:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
  29:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if !defined(SECUREC_SYSAPI4VXWORKS) && !defined(SECUREC_CTYPE_MACRO_ADAPT)
  30:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #include <ctype.h>
  31:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_FOR_WCHAR
  32:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #include <wctype.h>             /* for iswspace */
  33:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
  34:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
  35:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
  36:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
  37:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_NUM_WIDTH_SHORT                 0
  38:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_NUM_WIDTH_INT                   1
  39:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_NUM_WIDTH_LONG                  2
  40:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_NUM_WIDTH_LONG_LONG             3 /* also long double */
  41:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
  42:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_BUF_EXT_MUL                     2
  43:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_BUFFERED_BLOK_SIZE              1024
  44:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
  45:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if defined(SECUREC_VXWORKS_PLATFORM) && !defined(va_copy) && !defined(__va_copy)
  46:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /* the name is the same as system macro. */
  47:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define __va_copy(d, s) do { \
  48:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     size_t size_of_d = (size_t)sizeof(d); \
  49:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     size_t size_of_s = (size_t)sizeof(s); \
  50:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (size_of_d != size_of_s) { \
GAS LISTING /tmp/cc1ytava.s 			page 2


  51:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         (void)memcpy((d), (s), sizeof(va_list)); \
  52:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else { \
  53:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         (void)memcpy(&(d), &(s), sizeof(va_list)); \
  54:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } \
  55:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** } SECUREC_WHILE_ZERO
  56:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
  57:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
  58:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
  59:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_MULTI_BYTE_MAX_LEN              6
  60:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /* Record a flag for each bit */
  61:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_BRACKET_INDEX(x)                ((unsigned int)(x) >> 3)
  62:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_BRACKET_VALUE(x)                ((unsigned char)(1 << ((unsigned int)(x) & 7)))
  63:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
  64:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
  65:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /* Compatibility macro name cannot be modifie */
  66:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifndef UNALIGNED
  67:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if !(defined(_M_IA64)) && !(defined(_M_AMD64))
  68:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define UNALIGNED
  69:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
  70:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define UNALIGNED __unaligned
  71:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
  72:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
  73:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
  74:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if (defined(SECUREC_COMPATIBLE_LINUX_FORMAT) && !(defined(SECUREC_ON_UNIX)))
  75:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /* Max 64bit value is 0xffffffffffffffff */
  76:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_MAX_64BITS_VALUE                18446744073709551615ULL
  77:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_MAX_64BITS_VALUE_DIV_TEN        1844674407370955161ULL
  78:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_MAX_64BITS_VALUE_CUT_LAST_DIGIT 18446744073709551610ULL
  79:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_MIN_64BITS_NEG_VALUE            9223372036854775808ULL
  80:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_MAX_64BITS_POS_VALUE            9223372036854775807ULL
  81:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_MIN_32BITS_NEG_VALUE            2147483648ULL
  82:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_MAX_32BITS_POS_VALUE            2147483647ULL
  83:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_MAX_32BITS_VALUE                4294967295ULL
  84:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_MAX_32BITS_VALUE_INC            4294967296ULL
  85:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_MAX_32BITS_VALUE_DIV_TEN        429496729ULL
  86:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_LONG_BIT_NUM                    ((unsigned int)(sizeof(long) << 3U))
  87:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
  88:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_LONG_HEX_BEYOND_MAX(number)     (((number) >> (SECUREC_LONG_BIT_NUM - 4U)) > 0)
  89:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_LONG_OCTAL_BEYOND_MAX(number)   (((number) >> (SECUREC_LONG_BIT_NUM - 3U)) > 0)
  90:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
  91:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_QWORD_HEX_BEYOND_MAX(number)    (((number) >> (64U - 4U)) > 0)
  92:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_QWORD_OCTAL_BEYOND_MAX(number)  (((number) >> (64U - 3U)) > 0)
  93:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
  94:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_LP64_BIT_WIDTH                  64
  95:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_LP32_BIT_WIDTH                  32
  96:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
  97:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
  98:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
  99:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_CHAR(x)                         (x)
 100:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_BRACE                           '{'     /* [ to { */
 101:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 102:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_FOR_WCHAR
 103:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_SCANF_BRACKET_CONDITION(comChr, ch, table, mask) ((comChr) == SECUREC_BRACE && \
 104:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     (table) != NULL && \
 105:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     (((table)[((unsigned int)(int)(ch) & SECUREC_CHAR_MASK) >> 3] ^ (mask)) & \
 106:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     (1 << ((unsigned int)(int)(ch) & 7))))
 107:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
GAS LISTING /tmp/cc1ytava.s 			page 3


 108:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_SCANF_BRACKET_CONDITION(comChr, ch, table, mask) ((comChr) == SECUREC_BRACE && \
 109:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     (((table)[((unsigned char)(ch) & 0xff) >> 3] ^ (mask)) & (1 << ((unsigned char)(ch) & 7))))
 110:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 111:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_SCANF_STRING_CONDITION(comChr, ch) ((comChr) == SECUREC_CHAR('s') && \
 112:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     (!((ch) >= SECUREC_CHAR('\t') && (ch) <= SECUREC_CHAR('\r')) && (ch) != SECUREC_CHAR(' ')))
 113:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 114:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /* Do not use   |=   optimize this code, it will cause compiling warning */
 115:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /* only supports  wide characters with a maximum length of two bytes */
 116:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_BRACKET_SET_BIT(table, ch) do { \
 117:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     unsigned int tableIndex = SECUREC_BRACKET_INDEX(((unsigned int)(int)(ch) & SECUREC_CHAR_MASK));
 118:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     unsigned int tableValue = SECUREC_BRACKET_VALUE(((unsigned int)(int)(ch) & SECUREC_CHAR_MASK));
 119:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     (table)[tableIndex] = (unsigned char)((table)[tableIndex] | tableValue); \
 120:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** } SECUREC_WHILE_ZERO
 121:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 122:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_FOR_WCHAR
 123:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /* table size is 32 x 256 */
 124:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_BRACKET_TABLE_SIZE    8192
 125:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_EOF WEOF
 126:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_MB_LEN 16       /* max. # bytes in multibyte char  ,see MB_LEN_MAX */
 127:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /* int to unsigned int clear  e571 */
 128:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_IS_DIGIT(chr)  (!((unsigned int)(int)(chr) & 0xff00) && isdigit(((unsigned int)(int
 129:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_IS_XDIGIT(chr) (!((unsigned int)(int)(chr) & 0xff00) && isxdigit(((unsigned int)(in
 130:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_IS_SPACE(chr)    iswspace((wint_t)(int)(chr))
 131:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
 132:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_BRACKET_TABLE_SIZE    32
 133:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_EOF EOF
 134:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_IS_DIGIT(chr)    isdigit((unsigned char)(chr) & 0x00ff)
 135:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_IS_XDIGIT(chr)   isxdigit((unsigned char)(chr) & 0x00ff)
 136:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_IS_SPACE(chr)    isspace((unsigned char)(chr) & 0x00ff)
 137:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 138:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 139:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 140:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static SecInt SecSkipSpaceChar(SecFileStream *stream, int *counter);
 141:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static SecInt SecGetChar(SecFileStream *stream, int *counter);
 142:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecUnGetChar(SecInt ch, SecFileStream *stream, int *counter);
 143:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 144:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** typedef struct {
 145:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_FOR_WCHAR
 146:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     unsigned char *table; /* default NULL */
 147:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
 148:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     unsigned char table[SECUREC_BRACKET_TABLE_SIZE]; /* Array length is large enough in application
 149:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 150:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     unsigned char mask; /* default 0 */
 151:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** } SecBracketTable;
 152:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 153:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_FOR_WCHAR
 154:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_INIT_BRACKET_TABLE { NULL, 0 }
 155:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
 156:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_INIT_BRACKET_TABLE { { 0 }, 0 }
 157:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 158:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 159:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if SECUREC_ENABLE_SCANF_FLOAT
 160:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** typedef struct {
 161:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     size_t floatStrSize;           /* tialization must be length of buffer in charater */
 162:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     size_t floatStrUsedLen;        /* store float string len */
 163:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecChar buffer[SECUREC_FLOAT_BUFSIZE + 1];
 164:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecChar *floatStr;            /* Initialization must point to buffer */
GAS LISTING /tmp/cc1ytava.s 			page 4


 165:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecChar *allocatedFloatStr;   /* Initialization must be NULL  to store alloced point */
 166:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** } SecFloatSpec;
 167:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 168:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 169:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** typedef struct {
 170:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecUnsignedInt64 number64;
 171:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     unsigned long number;
 172:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     int numberWidth;     /* 0 = SHORT, 1 = int, > 1  long or L_DOUBLE */
 173:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     int isInt64Arg;      /* 1 for 64-bit integer, 0 otherwise */
 174:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     int negative;        /* 0 is positive */
 175:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if (defined(SECUREC_COMPATIBLE_LINUX_FORMAT) && !(defined(SECUREC_ON_UNIX)))
 176:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     int beyondMax;       /* Non-zero means beyond */
 177:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 178:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     void *argPtr;        /* Variable parameter pointer */
 179:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     size_t arrayWidth;   /* length of pointer Variable parameter, in charaters */
 180:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     int width;           /* width number in format */
 181:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     int widthSet;        /* 0 is not set width in format */
 182:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     int comChr;          /* Lowercase format conversion characters */
 183:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     int oriComChr;       /* store number conversion */
 184:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     signed char isWChar; /* -1/0 not wchar, 1 for wchar */
 185:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     char suppress;       /* 0 is not have %* in format */
 186:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** } SecScanSpec;
 187:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 188:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if (defined(SECUREC_COMPATIBLE_LINUX_FORMAT) && !(defined(SECUREC_ON_UNIX)))
 189:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_INIT_NUMBER_SPEC { 0, 0, 0, 0, 0, 0, NULL, 0, 0, 0, 0, 0, 0 }
 190:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
 191:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_INIT_NUMBER_SPEC { 0, 0, 0, 0, 0, 0, NULL, 0, 0, 0, 0, 0 }
 192:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 193:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 194:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_FOR_WCHAR
 195:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_GETC fgetwc
 196:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_UN_GETC ungetwc
 197:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_CHAR_MASK 0xffff
 198:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
 199:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_GETC fgetc
 200:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_UN_GETC ungetc
 201:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_CHAR_MASK 0xff
 202:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 203:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 204:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 205:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * Determine if it is a 64-bit pointer  function
 206:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * return 0 is not ,1 is 64bit pointer
 207:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 208:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static int SecIs64BitPtr(size_t sizeOfVoidStar)
 209:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
   9              		.loc 1 209 1
  10              		.cfi_startproc
  11 0000 F30F1EFA 		endbr64
  12 0004 55       		pushq	%rbp
  13              	.LCFI0:
  14              		.cfi_def_cfa_offset 16
  15              		.cfi_offset 6, -16
  16 0005 4889E5   		movq	%rsp, %rbp
  17              	.LCFI1:
  18              		.cfi_def_cfa_register 6
  19 0008 4883EC20 		subq	$32, %rsp
  20 000c 48897DE8 		movq	%rdi, -24(%rbp)
GAS LISTING /tmp/cc1ytava.s 			page 5


  21              		.loc 1 209 1
  22 0010 64488B04 		movq	%fs:40, %rax
  22      25280000 
  22      00
  23 0019 488945F8 		movq	%rax, -8(%rbp)
  24 001d 31C0     		xorl	%eax, %eax
 210:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     /* point size is 4 or 8 , Under the 64 bit system, the value not 0 */
 211:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     /* to clear e778 */
 212:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if ((sizeOfVoidStar & sizeof(SecInt64)) != 0) {
  25              		.loc 1 212 25
  26 001f 488B45E8 		movq	-24(%rbp), %rax
  27 0023 83E008   		andl	$8, %eax
  28              		.loc 1 212 8
  29 0026 4885C0   		testq	%rax, %rax
  30 0029 7407     		je	.L2
 213:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return 1;
  31              		.loc 1 213 16
  32 002b B8010000 		movl	$1, %eax
  32      00
  33 0030 EB05     		jmp	.L3
  34              	.L2:
 214:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 215:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return 0;
  35              		.loc 1 215 12
  36 0032 B8000000 		movl	$0, %eax
  36      00
  37              	.L3:
 216:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
  38              		.loc 1 216 1
  39 0037 488B55F8 		movq	-8(%rbp), %rdx
  40 003b 64483314 		xorq	%fs:40, %rdx
  40      25280000 
  40      00
  41 0044 7405     		je	.L4
  42 0046 E8000000 		call	__stack_chk_fail@PLT
  42      00
  43              	.L4:
  44 004b C9       		leave
  45              	.LCFI2:
  46              		.cfi_def_cfa 7, 8
  47 004c C3       		ret
  48              		.cfi_endproc
  49              	.LFE6:
  51              		.section	.text.SecAssignFloat,"ax",@progbits
  53              	SecAssignFloat:
  54              	.LFB7:
 217:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 218:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if SECUREC_ENABLE_SCANF_FLOAT
 219:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 220:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 221:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * Convert a floating point string to a floating point number
 222:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 223:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecAssignFloat(const char *floatStr, int numberWidth, void *argPtr)
 224:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
  55              		.loc 1 224 1
  56              		.cfi_startproc
  57 0000 F30F1EFA 		endbr64
GAS LISTING /tmp/cc1ytava.s 			page 6


  58 0004 55       		pushq	%rbp
  59              	.LCFI3:
  60              		.cfi_def_cfa_offset 16
  61              		.cfi_offset 6, -16
  62 0005 4889E5   		movq	%rsp, %rbp
  63              	.LCFI4:
  64              		.cfi_def_cfa_register 6
  65 0008 4883EC50 		subq	$80, %rsp
  66 000c 48897DC8 		movq	%rdi, -56(%rbp)
  67 0010 8975C4   		movl	%esi, -60(%rbp)
  68 0013 488955B8 		movq	%rdx, -72(%rbp)
  69              		.loc 1 224 1
  70 0017 64488B04 		movq	%fs:40, %rax
  70      25280000 
  70      00
  71 0020 488945F8 		movq	%rax, -8(%rbp)
  72 0024 31C0     		xorl	%eax, %eax
 225:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     char *endPtr = NULL;
  73              		.loc 1 225 11
  74 0026 48C745D0 		movq	$0, -48(%rbp)
  74      00000000 
 226:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     double d;
 227:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if SECUREC_SUPPORT_STRTOLD
 228:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (numberWidth == SECUREC_NUM_WIDTH_LONG_LONG) {
  75              		.loc 1 228 8
  76 002e 837DC403 		cmpl	$3, -60(%rbp)
  77 0032 7521     		jne	.L6
  78              	.LBB2:
 229:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         long double d2 = strtold(floatStr, &endPtr);
  79              		.loc 1 229 26
  80 0034 488D55D0 		leaq	-48(%rbp), %rdx
  81 0038 488B45C8 		movq	-56(%rbp), %rax
  82 003c 4889D6   		movq	%rdx, %rsi
  83 003f 4889C7   		movq	%rax, %rdi
  84 0042 E8000000 		call	strtold@PLT
  84      00
  85 0047 DB7DE0   		fstpt	-32(%rbp)
 230:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         *(long double UNALIGNED *)(argPtr) = d2;
  86              		.loc 1 230 44
  87 004a 488B45B8 		movq	-72(%rbp), %rax
  88 004e DB6DE0   		fldt	-32(%rbp)
  89 0051 DB38     		fstpt	(%rax)
  90 0053 EB3E     		jmp	.L5
  91              	.L6:
  92              	.LBE2:
 231:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return;
 232:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 233:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 234:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     d = strtod(floatStr, &endPtr);
  93              		.loc 1 234 9
  94 0055 488D55D0 		leaq	-48(%rbp), %rdx
  95 0059 488B45C8 		movq	-56(%rbp), %rax
  96 005d 4889D6   		movq	%rdx, %rsi
  97 0060 4889C7   		movq	%rax, %rdi
  98 0063 E8000000 		call	strtod@PLT
  98      00
  99 0068 66480F7E 		movq	%xmm0, %rax
GAS LISTING /tmp/cc1ytava.s 			page 7


  99      C0
 100 006d 488945D8 		movq	%rax, -40(%rbp)
 235:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (numberWidth > SECUREC_NUM_WIDTH_INT) {
 101              		.loc 1 235 8
 102 0071 837DC401 		cmpl	$1, -60(%rbp)
 103 0075 7E0F     		jle	.L8
 236:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         *(double UNALIGNED *)(argPtr) = (double)d;
 104              		.loc 1 236 39
 105 0077 488B45B8 		movq	-72(%rbp), %rax
 106 007b F20F1045 		movsd	-40(%rbp), %xmm0
 106      D8
 107 0080 F20F1100 		movsd	%xmm0, (%rax)
 108 0084 EB0D     		jmp	.L5
 109              	.L8:
 237:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else {
 238:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         *(float UNALIGNED *)(argPtr) = (float)d;
 110              		.loc 1 238 40
 111 0086 F20F5A45 		cvtsd2ss	-40(%rbp), %xmm0
 111      D8
 112              		.loc 1 238 38
 113 008b 488B45B8 		movq	-72(%rbp), %rax
 114 008f F30F1100 		movss	%xmm0, (%rax)
 115              	.L5:
 239:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 240:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 116              		.loc 1 240 1
 117 0093 488B45F8 		movq	-8(%rbp), %rax
 118 0097 64483304 		xorq	%fs:40, %rax
 118      25280000 
 118      00
 119 00a0 7405     		je	.L10
 120 00a2 E8000000 		call	__stack_chk_fail@PLT
 120      00
 121              	.L10:
 122 00a7 C9       		leave
 123              	.LCFI5:
 124              		.cfi_def_cfa 7, 8
 125 00a8 C3       		ret
 126              		.cfi_endproc
 127              	.LFE7:
 129              		.section	.text.SecAssignFloatW,"ax",@progbits
 131              	SecAssignFloatW:
 132              	.LFB8:
 241:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 242:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_FOR_WCHAR
 243:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 244:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * Convert a floating point wchar string to a floating point number
 245:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * Success  ret 0
 246:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 247:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static int SecAssignFloatW(const SecFloatSpec *floatSpec, const  SecScanSpec *spec)
 248:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 133              		.loc 1 248 1
 134              		.cfi_startproc
 135 0000 F30F1EFA 		endbr64
 136 0004 55       		pushq	%rbp
 137              	.LCFI6:
 138              		.cfi_def_cfa_offset 16
GAS LISTING /tmp/cc1ytava.s 			page 8


 139              		.cfi_offset 6, -16
 140 0005 4889E5   		movq	%rsp, %rbp
 141              	.LCFI7:
 142              		.cfi_def_cfa_register 6
 143 0008 4883EC30 		subq	$48, %rsp
 144 000c 48897DD8 		movq	%rdi, -40(%rbp)
 145 0010 488975D0 		movq	%rsi, -48(%rbp)
 146              		.loc 1 248 1
 147 0014 64488B04 		movq	%fs:40, %rax
 147      25280000 
 147      00
 148 001d 488945F8 		movq	%rax, -8(%rbp)
 149 0021 31C0     		xorl	%eax, %eax
 249:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     /* convert float string */
 250:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     size_t mbsLen;
 251:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     size_t tempFloatStrLen = (size_t)(floatSpec->floatStrSize + 1) * sizeof(wchar_t);
 150              		.loc 1 251 48
 151 0023 488B45D8 		movq	-40(%rbp), %rax
 152 0027 488B00   		movq	(%rax), %rax
 153              		.loc 1 251 30
 154 002a 4883C001 		addq	$1, %rax
 155              		.loc 1 251 12
 156 002e 48C1E002 		salq	$2, %rax
 157 0032 488945E0 		movq	%rax, -32(%rbp)
 252:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     char *tempFloatStr = (char *)SECUREC_MALLOC(tempFloatStrLen);
 158              		.loc 1 252 34
 159 0036 488B45E0 		movq	-32(%rbp), %rax
 160 003a 4889C7   		movq	%rax, %rdi
 161 003d E8000000 		call	malloc@PLT
 161      00
 162 0042 488945E8 		movq	%rax, -24(%rbp)
 253:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 254:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (tempFloatStr == NULL) {
 163              		.loc 1 254 8
 164 0046 48837DE8 		cmpq	$0, -24(%rbp)
 164      00
 165 004b 750A     		jne	.L12
 255:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return -1;
 166              		.loc 1 255 16
 167 004d B8FFFFFF 		movl	$-1, %eax
 167      FF
 168 0052 E9830000 		jmp	.L13
 168      00
 169              	.L12:
 256:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 257:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     tempFloatStr[0] = '\0';
 170              		.loc 1 257 21
 171 0057 488B45E8 		movq	-24(%rbp), %rax
 172 005b C60000   		movb	$0, (%rax)
 258:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SECUREC_MASK_MSVC_CRT_WARNING
 259:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     mbsLen = wcstombs(tempFloatStr, floatSpec->floatStr, tempFloatStrLen - 1);
 173              		.loc 1 259 14
 174 005e 488B45E0 		movq	-32(%rbp), %rax
 175 0062 488D50FF 		leaq	-1(%rax), %rdx
 176              		.loc 1 259 46
 177 0066 488B45D8 		movq	-40(%rbp), %rax
 178 006a 488B8888 		movq	1416(%rax), %rcx
GAS LISTING /tmp/cc1ytava.s 			page 9


 178      050000
 179              		.loc 1 259 14
 180 0071 488B45E8 		movq	-24(%rbp), %rax
 181 0075 4889CE   		movq	%rcx, %rsi
 182 0078 4889C7   		movq	%rax, %rdi
 183 007b E8000000 		call	wcstombs@PLT
 183      00
 184 0080 488945F0 		movq	%rax, -16(%rbp)
 260:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SECUREC_END_MASK_MSVC_CRT_WARNING
 261:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (mbsLen != (size_t)-1) {
 185              		.loc 1 261 8
 186 0084 48837DF0 		cmpq	$-1, -16(%rbp)
 186      FF
 187 0089 743E     		je	.L14
 262:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         tempFloatStr[mbsLen] = '\0';
 188              		.loc 1 262 21
 189 008b 488B55E8 		movq	-24(%rbp), %rdx
 190 008f 488B45F0 		movq	-16(%rbp), %rax
 191 0093 4801D0   		addq	%rdx, %rax
 192              		.loc 1 262 30
 193 0096 C60000   		movb	$0, (%rax)
 263:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SecAssignFloat(tempFloatStr, spec->numberWidth, spec->argPtr);
 194              		.loc 1 263 9
 195 0099 488B45D0 		movq	-48(%rbp), %rax
 196 009d 488B5020 		movq	32(%rax), %rdx
 197 00a1 488B45D0 		movq	-48(%rbp), %rax
 198 00a5 8B4810   		movl	16(%rax), %ecx
 199 00a8 488B45E8 		movq	-24(%rbp), %rax
 200 00ac 89CE     		movl	%ecx, %esi
 201 00ae 4889C7   		movq	%rax, %rdi
 202 00b1 E8000000 		call	SecAssignFloat
 202      00
 264:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else {
 265:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SECUREC_FREE(tempFloatStr);
 266:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return -1;
 267:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 268:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SECUREC_FREE(tempFloatStr);
 203              		.loc 1 268 5
 204 00b6 488B45E8 		movq	-24(%rbp), %rax
 205 00ba 4889C7   		movq	%rax, %rdi
 206 00bd E8000000 		call	free@PLT
 206      00
 269:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return 0;
 207              		.loc 1 269 12
 208 00c2 B8000000 		movl	$0, %eax
 208      00
 209 00c7 EB11     		jmp	.L13
 210              	.L14:
 265:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return -1;
 211              		.loc 1 265 9
 212 00c9 488B45E8 		movq	-24(%rbp), %rax
 213 00cd 4889C7   		movq	%rax, %rdi
 214 00d0 E8000000 		call	free@PLT
 214      00
 266:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 215              		.loc 1 266 16
 216 00d5 B8FFFFFF 		movl	$-1, %eax
GAS LISTING /tmp/cc1ytava.s 			page 10


 216      FF
 217              	.L13:
 270:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 218              		.loc 1 270 1
 219 00da 488B75F8 		movq	-8(%rbp), %rsi
 220 00de 64483334 		xorq	%fs:40, %rsi
 220      25280000 
 220      00
 221 00e7 7405     		je	.L16
 222 00e9 E8000000 		call	__stack_chk_fail@PLT
 222      00
 223              	.L16:
 224 00ee C9       		leave
 225              	.LCFI8:
 226              		.cfi_def_cfa 7, 8
 227 00ef C3       		ret
 228              		.cfi_endproc
 229              	.LFE8:
 231              		.section	.text.SecUpdateFloatString,"ax",@progbits
 233              	SecUpdateFloatString:
 234              	.LFB9:
 271:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 272:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 273:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * Splice floating point string
 274:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * return 0 OK
 275:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 276:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static int SecUpdateFloatString(SecChar ch, SecFloatSpec *floatSpec)
 277:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 235              		.loc 1 277 1
 236              		.cfi_startproc
 237 0000 F30F1EFA 		endbr64
 238 0004 55       		pushq	%rbp
 239              	.LCFI9:
 240              		.cfi_def_cfa_offset 16
 241              		.cfi_offset 6, -16
 242 0005 4889E5   		movq	%rsp, %rbp
 243              	.LCFI10:
 244              		.cfi_def_cfa_register 6
 245 0008 4883EC40 		subq	$64, %rsp
 246 000c 897DCC   		movl	%edi, -52(%rbp)
 247 000f 488975C0 		movq	%rsi, -64(%rbp)
 248              		.loc 1 277 1
 249 0013 64488B04 		movq	%fs:40, %rax
 249      25280000 
 249      00
 250 001c 488945F8 		movq	%rax, -8(%rbp)
 251 0020 31C0     		xorl	%eax, %eax
 278:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     floatSpec->floatStr[floatSpec->floatStrUsedLen++] = ch;    /* ch must be '0' - '9' */
 252              		.loc 1 278 14
 253 0022 488B45C0 		movq	-64(%rbp), %rax
 254 0026 488BB088 		movq	1416(%rax), %rsi
 254      050000
 255              		.loc 1 278 34
 256 002d 488B45C0 		movq	-64(%rbp), %rax
 257 0031 488B4008 		movq	8(%rax), %rax
 258              		.loc 1 278 51
 259 0035 488D4801 		leaq	1(%rax), %rcx
GAS LISTING /tmp/cc1ytava.s 			page 11


 260 0039 488B55C0 		movq	-64(%rbp), %rdx
 261 003d 48894A08 		movq	%rcx, 8(%rdx)
 262              		.loc 1 278 24
 263 0041 48C1E002 		salq	$2, %rax
 264 0045 488D1406 		leaq	(%rsi,%rax), %rdx
 265              		.loc 1 278 55
 266 0049 8B45CC   		movl	-52(%rbp), %eax
 267 004c 8902     		movl	%eax, (%rdx)
 279:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (floatSpec->floatStrUsedLen < floatSpec->floatStrSize) {
 268              		.loc 1 279 18
 269 004e 488B45C0 		movq	-64(%rbp), %rax
 270 0052 488B5008 		movq	8(%rax), %rdx
 271              		.loc 1 279 47
 272 0056 488B45C0 		movq	-64(%rbp), %rax
 273 005a 488B00   		movq	(%rax), %rax
 274              		.loc 1 279 8
 275 005d 4839C2   		cmpq	%rax, %rdx
 276 0060 730A     		jnb	.L18
 280:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return 0;
 277              		.loc 1 280 16
 278 0062 B8000000 		movl	$0, %eax
 278      00
 279 0067 E9D50100 		jmp	.L19
 279      00
 280              	.L18:
 281:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 282:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (floatSpec->allocatedFloatStr == NULL) {
 281              		.loc 1 282 18
 282 006c 488B45C0 		movq	-64(%rbp), %rax
 283 0070 488B8090 		movq	1424(%rax), %rax
 283      050000
 284              		.loc 1 282 8
 285 0077 4885C0   		testq	%rax, %rax
 286 007a 0F85B200 		jne	.L20
 286      0000
 287              	.LBB3:
 283:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* add 1 to clear ZERO LENGTH ALLOCATIONS warning */
 284:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         size_t oriBufSize = floatSpec->floatStrSize* (SECUREC_BUF_EXT_MUL * sizeof(SecChar)) + 1;
 288              		.loc 1 284 38
 289 0080 488B45C0 		movq	-64(%rbp), %rax
 290 0084 488B00   		movq	(%rax), %rax
 291              		.loc 1 284 52
 292 0087 48C1E003 		salq	$3, %rax
 293              		.loc 1 284 16
 294 008b 4883C001 		addq	$1, %rax
 295 008f 488945E8 		movq	%rax, -24(%rbp)
 285:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         void *tmpPointer = (void *)SECUREC_MALLOC(oriBufSize);
 296              		.loc 1 285 28
 297 0093 488B45E8 		movq	-24(%rbp), %rax
 298 0097 4889C7   		movq	%rax, %rdi
 299 009a E8000000 		call	malloc@PLT
 299      00
 300 009f 488945F0 		movq	%rax, -16(%rbp)
 286:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (tmpPointer == NULL) {
 301              		.loc 1 286 12
 302 00a3 48837DF0 		cmpq	$0, -16(%rbp)
 302      00
GAS LISTING /tmp/cc1ytava.s 			page 12


 303 00a8 750A     		jne	.L21
 287:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             return -1;
 304              		.loc 1 287 20
 305 00aa B8FFFFFF 		movl	$-1, %eax
 305      FF
 306 00af E98D0100 		jmp	.L19
 306      00
 307              	.L21:
 288:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 289:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (memcpy_s(tmpPointer, oriBufSize, floatSpec->floatStr, floatSpec->floatStrSize * sizeof(
 308              		.loc 1 289 76
 309 00b4 488B45C0 		movq	-64(%rbp), %rax
 310 00b8 488B00   		movq	(%rax), %rax
 311              		.loc 1 289 13
 312 00bb 488D0C85 		leaq	0(,%rax,4), %rcx
 312      00000000 
 313              		.loc 1 289 55
 314 00c3 488B45C0 		movq	-64(%rbp), %rax
 315 00c7 488B9088 		movq	1416(%rax), %rdx
 315      050000
 316              		.loc 1 289 13
 317 00ce 488B75E8 		movq	-24(%rbp), %rsi
 318 00d2 488B45F0 		movq	-16(%rbp), %rax
 319 00d6 4889C7   		movq	%rax, %rdi
 320 00d9 E8000000 		call	memcpy_s@PLT
 320      00
 321              		.loc 1 289 12
 322 00de 85C0     		testl	%eax, %eax
 323 00e0 7416     		je	.L22
 290:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SECUREC_FREE(tmpPointer);   /* This is a dead code, just to meet the coding requirement
 324              		.loc 1 290 13
 325 00e2 488B45F0 		movq	-16(%rbp), %rax
 326 00e6 4889C7   		movq	%rax, %rdi
 327 00e9 E8000000 		call	free@PLT
 327      00
 291:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             return -1;
 328              		.loc 1 291 20
 329 00ee B8FFFFFF 		movl	$-1, %eax
 329      FF
 330 00f3 E9490100 		jmp	.L19
 330      00
 331              	.L22:
 292:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 293:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         floatSpec->floatStr = (SecChar *) (tmpPointer);
 332              		.loc 1 293 29
 333 00f8 488B45C0 		movq	-64(%rbp), %rax
 334 00fc 488B55F0 		movq	-16(%rbp), %rdx
 335 0100 48899088 		movq	%rdx, 1416(%rax)
 335      050000
 294:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         floatSpec->allocatedFloatStr = (SecChar *) (tmpPointer); /* use to clear free on stack warn
 336              		.loc 1 294 38
 337 0107 488B45C0 		movq	-64(%rbp), %rax
 338 010b 488B55F0 		movq	-16(%rbp), %rdx
 339 010f 48899090 		movq	%rdx, 1424(%rax)
 339      050000
 295:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         floatSpec->floatStrSize *= SECUREC_BUF_EXT_MUL; /* this is OK, oriBufSize plus 1 just clear
 340              		.loc 1 295 33
GAS LISTING /tmp/cc1ytava.s 			page 13


 341 0116 488B45C0 		movq	-64(%rbp), %rax
 342 011a 488B00   		movq	(%rax), %rax
 343 011d 488D1400 		leaq	(%rax,%rax), %rdx
 344 0121 488B45C0 		movq	-64(%rbp), %rax
 345 0125 488910   		movq	%rdx, (%rax)
 296:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return 0;
 346              		.loc 1 296 16
 347 0128 B8000000 		movl	$0, %eax
 347      00
 348 012d E90F0100 		jmp	.L19
 348      00
 349              	.L20:
 350              	.LBE3:
 351              	.LBB4:
 297:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else {
 298:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* LSD 2014.3.6 fix, replace realloc to malloc to avoid heap injection */
 299:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         size_t oriBufSize = floatSpec->floatStrSize * sizeof(SecChar);
 352              		.loc 1 299 38
 353 0132 488B45C0 		movq	-64(%rbp), %rax
 354 0136 488B00   		movq	(%rax), %rax
 355              		.loc 1 299 16
 356 0139 48C1E002 		salq	$2, %rax
 357 013d 488945D0 		movq	%rax, -48(%rbp)
 300:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         size_t nextSize = (oriBufSize * SECUREC_BUF_EXT_MUL) + 1; /* add 1 to clear satic check too
 358              		.loc 1 300 39
 359 0141 488B45D0 		movq	-48(%rbp), %rax
 360 0145 4801C0   		addq	%rax, %rax
 361              		.loc 1 300 16
 362 0148 4883C001 		addq	$1, %rax
 363 014c 488945D8 		movq	%rax, -40(%rbp)
 301:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* Prevents integer overflow when calculating the wide character length.
 302:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****          * The maximum length of SECUREC_MAX_WIDTH_LEN is enough
 303:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****          */
 304:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (nextSize <= SECUREC_MAX_WIDTH_LEN) {
 364              		.loc 1 304 12
 365 0150 48817DD8 		cmpq	$214748360, -40(%rbp)
 365      C8CCCC0C 
 366 0158 0F87DE00 		ja	.L23
 366      0000
 367              	.LBB5:
 305:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             void *tmpPointer = (void *)SECUREC_MALLOC(nextSize);
 368              		.loc 1 305 32
 369 015e 488B45D8 		movq	-40(%rbp), %rax
 370 0162 4889C7   		movq	%rax, %rdi
 371 0165 E8000000 		call	malloc@PLT
 371      00
 372 016a 488945E0 		movq	%rax, -32(%rbp)
 306:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (tmpPointer == NULL) {
 373              		.loc 1 306 16
 374 016e 48837DE0 		cmpq	$0, -32(%rbp)
 374      00
 375 0173 750A     		jne	.L24
 307:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 return -1;
 376              		.loc 1 307 24
 377 0175 B8FFFFFF 		movl	$-1, %eax
 377      FF
 378 017a E9C20000 		jmp	.L19
GAS LISTING /tmp/cc1ytava.s 			page 14


 378      00
 379              	.L24:
 308:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
 309:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (memcpy_s(tmpPointer, nextSize, floatSpec->floatStr, oriBufSize) != EOK) {
 380              		.loc 1 309 57
 381 017f 488B45C0 		movq	-64(%rbp), %rax
 382 0183 488B9088 		movq	1416(%rax), %rdx
 382      050000
 383              		.loc 1 309 17
 384 018a 488B4DD0 		movq	-48(%rbp), %rcx
 385 018e 488B75D8 		movq	-40(%rbp), %rsi
 386 0192 488B45E0 		movq	-32(%rbp), %rax
 387 0196 4889C7   		movq	%rax, %rdi
 388 0199 E8000000 		call	memcpy_s@PLT
 388      00
 389              		.loc 1 309 16
 390 019e 85C0     		testl	%eax, %eax
 391 01a0 7416     		je	.L25
 310:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 SECUREC_FREE(tmpPointer);   /* This is a dead code, just to meet the coding require
 392              		.loc 1 310 17
 393 01a2 488B45E0 		movq	-32(%rbp), %rax
 394 01a6 4889C7   		movq	%rax, %rdi
 395 01a9 E8000000 		call	free@PLT
 395      00
 311:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 return -1;
 396              		.loc 1 311 24
 397 01ae B8FFFFFF 		movl	$-1, %eax
 397      FF
 398 01b3 E9890000 		jmp	.L19
 398      00
 399              	.L25:
 312:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
 313:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (memset_s(floatSpec->floatStr, oriBufSize, 0, oriBufSize) != EOK) {
 400              		.loc 1 313 35
 401 01b8 488B45C0 		movq	-64(%rbp), %rax
 402 01bc 488B8088 		movq	1416(%rax), %rax
 402      050000
 403              		.loc 1 313 17
 404 01c3 488B55D0 		movq	-48(%rbp), %rdx
 405 01c7 488B75D0 		movq	-48(%rbp), %rsi
 406 01cb 4889D1   		movq	%rdx, %rcx
 407 01ce BA000000 		movl	$0, %edx
 407      00
 408 01d3 4889C7   		movq	%rax, %rdi
 409 01d6 E8000000 		call	memset_s@PLT
 409      00
 410              		.loc 1 313 16
 411 01db 85C0     		testl	%eax, %eax
 412 01dd 7413     		je	.L26
 314:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 SECUREC_FREE(tmpPointer);   /* This is a dead code, just to meet the coding require
 413              		.loc 1 314 17
 414 01df 488B45E0 		movq	-32(%rbp), %rax
 415 01e3 4889C7   		movq	%rax, %rdi
 416 01e6 E8000000 		call	free@PLT
 416      00
 315:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 return -1;
 417              		.loc 1 315 24
GAS LISTING /tmp/cc1ytava.s 			page 15


 418 01eb B8FFFFFF 		movl	$-1, %eax
 418      FF
 419 01f0 EB4F     		jmp	.L19
 420              	.L26:
 316:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
 317:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SECUREC_FREE(floatSpec->floatStr);
 421              		.loc 1 317 13
 422 01f2 488B45C0 		movq	-64(%rbp), %rax
 423 01f6 488B8088 		movq	1416(%rax), %rax
 423      050000
 424 01fd 4889C7   		movq	%rax, %rdi
 425 0200 E8000000 		call	free@PLT
 425      00
 318:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 319:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             floatSpec->floatStr = (SecChar *) (tmpPointer);
 426              		.loc 1 319 33
 427 0205 488B45C0 		movq	-64(%rbp), %rax
 428 0209 488B55E0 		movq	-32(%rbp), %rdx
 429 020d 48899088 		movq	%rdx, 1416(%rax)
 429      050000
 320:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             floatSpec->allocatedFloatStr = (SecChar *) (tmpPointer);    /* use to clear free on sta
 430              		.loc 1 320 42
 431 0214 488B45C0 		movq	-64(%rbp), %rax
 432 0218 488B55E0 		movq	-32(%rbp), %rdx
 433 021c 48899090 		movq	%rdx, 1424(%rax)
 433      050000
 321:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             floatSpec->floatStrSize *= SECUREC_BUF_EXT_MUL; /* this is OK, oriBufSize plus 1 just c
 434              		.loc 1 321 37
 435 0223 488B45C0 		movq	-64(%rbp), %rax
 436 0227 488B00   		movq	(%rax), %rax
 437 022a 488D1400 		leaq	(%rax,%rax), %rdx
 438 022e 488B45C0 		movq	-64(%rbp), %rax
 439 0232 488910   		movq	%rdx, (%rax)
 322:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             return 0;
 440              		.loc 1 322 20
 441 0235 B8000000 		movl	$0, %eax
 441      00
 442 023a EB05     		jmp	.L19
 443              	.L23:
 444              	.LBE5:
 445              	.LBE4:
 323:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 324:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 325:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return -1;
 446              		.loc 1 325 12
 447 023c B8FFFFFF 		movl	$-1, %eax
 447      FF
 448              	.L19:
 326:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 449              		.loc 1 326 1
 450 0241 488B4DF8 		movq	-8(%rbp), %rcx
 451 0245 6448330C 		xorq	%fs:40, %rcx
 451      25280000 
 451      00
 452 024e 7405     		je	.L27
 453 0250 E8000000 		call	__stack_chk_fail@PLT
 453      00
GAS LISTING /tmp/cc1ytava.s 			page 16


 454              	.L27:
 455 0255 C9       		leave
 456              	.LCFI11:
 457              		.cfi_def_cfa 7, 8
 458 0256 C3       		ret
 459              		.cfi_endproc
 460              	.LFE9:
 462              		.section	.text.SecUpdateWcharFlagByType,"ax",@progbits
 464              	SecUpdateWcharFlagByType:
 465              	.LFB10:
 327:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 328:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 329:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifndef SECUREC_FOR_WCHAR
 330:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /* LSD only multi-bytes string need isleadbyte() function */
 331:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static int SecIsLeadByte(SecInt ch)
 332:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 333:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     unsigned int c = (unsigned int)ch;
 334:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if !(defined(_MSC_VER) || defined(_INC_WCTYPE))
 335:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return (int)(c & 0x80);
 336:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
 337:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return (int)isleadbyte((int)(c & 0xff));
 338:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 339:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 340:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 341:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 342:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 343:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * Parsing whether it is a wide character
 344:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 345:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecUpdateWcharFlagByType(SecUnsignedChar ch, SecScanSpec *spec)
 346:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 466              		.loc 1 346 1
 467              		.cfi_startproc
 468 0000 F30F1EFA 		endbr64
 469 0004 55       		pushq	%rbp
 470              	.LCFI12:
 471              		.cfi_def_cfa_offset 16
 472              		.cfi_offset 6, -16
 473 0005 4889E5   		movq	%rsp, %rbp
 474              	.LCFI13:
 475              		.cfi_def_cfa_register 6
 476 0008 4883EC20 		subq	$32, %rsp
 477 000c 897DEC   		movl	%edi, -20(%rbp)
 478 000f 488975E0 		movq	%rsi, -32(%rbp)
 479              		.loc 1 346 1
 480 0013 64488B04 		movq	%fs:40, %rax
 480      25280000 
 480      00
 481 001c 488945F8 		movq	%rax, -8(%rbp)
 482 0020 31C0     		xorl	%eax, %eax
 347:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if defined(SECUREC_FOR_WCHAR) && (defined(SECUREC_COMPATIBLE_WIN_FORMAT))
 348:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     signed char flagForUpperType = -1;
 349:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     signed char flagForLowerType = 1;
 350:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
 351:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     signed char flagForUpperType = 1;
 483              		.loc 1 351 17
 484 0022 C645F601 		movb	$1, -10(%rbp)
 352:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     signed char flagForLowerType = -1;
GAS LISTING /tmp/cc1ytava.s 			page 17


 485              		.loc 1 352 17
 486 0026 C645F7FF 		movb	$-1, -9(%rbp)
 353:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 354:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     /* if no  l or h flag  */
 355:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (spec->isWChar == 0) {
 487              		.loc 1 355 13
 488 002a 488B45E0 		movq	-32(%rbp), %rax
 489 002e 0FB64040 		movzbl	64(%rax), %eax
 490              		.loc 1 355 8
 491 0032 84C0     		testb	%al, %al
 492 0034 7525     		jne	.L34
 356:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if ((ch == SECUREC_CHAR('C')) || (ch == SECUREC_CHAR('S'))) {
 493              		.loc 1 356 12
 494 0036 837DEC43 		cmpl	$67, -20(%rbp)
 495 003a 7406     		je	.L30
 496              		.loc 1 356 39 discriminator 1
 497 003c 837DEC53 		cmpl	$83, -20(%rbp)
 498 0040 750D     		jne	.L31
 499              	.L30:
 357:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->isWChar = flagForUpperType;
 500              		.loc 1 357 27
 501 0042 488B45E0 		movq	-32(%rbp), %rax
 502 0046 0FB655F6 		movzbl	-10(%rbp), %edx
 503 004a 885040   		movb	%dl, 64(%rax)
 504 004d EB0B     		jmp	.L29
 505              	.L31:
 358:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         } else {
 359:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->isWChar = flagForLowerType;
 506              		.loc 1 359 27
 507 004f 488B45E0 		movq	-32(%rbp), %rax
 508 0053 0FB655F7 		movzbl	-9(%rbp), %edx
 509 0057 885040   		movb	%dl, 64(%rax)
 510              	.L29:
 360:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 361:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 362:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return;
 511              		.loc 1 362 5
 512 005a 90       		nop
 513              	.L34:
 514 005b 90       		nop
 363:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 515              		.loc 1 363 1
 516 005c 488B45F8 		movq	-8(%rbp), %rax
 517 0060 64483304 		xorq	%fs:40, %rax
 517      25280000 
 517      00
 518 0069 7405     		je	.L33
 519 006b E8000000 		call	__stack_chk_fail@PLT
 519      00
 520              	.L33:
 521 0070 C9       		leave
 522              	.LCFI14:
 523              		.cfi_def_cfa 7, 8
 524 0071 C3       		ret
 525              		.cfi_endproc
 526              	.LFE10:
 528              		.section	.text.SecDecodeScanQualifierL,"ax",@progbits
GAS LISTING /tmp/cc1ytava.s 			page 18


 530              	SecDecodeScanQualifierL:
 531              	.LFB11:
 364:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 365:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * decode  %l %ll
 366:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 367:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecDecodeScanQualifierL(const SecUnsignedChar **format, SecScanSpec *spec)
 368:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 532              		.loc 1 368 1
 533              		.cfi_startproc
 534 0000 F30F1EFA 		endbr64
 535 0004 55       		pushq	%rbp
 536              	.LCFI15:
 537              		.cfi_def_cfa_offset 16
 538              		.cfi_offset 6, -16
 539 0005 4889E5   		movq	%rsp, %rbp
 540              	.LCFI16:
 541              		.cfi_def_cfa_register 6
 542 0008 4883EC20 		subq	$32, %rsp
 543 000c 48897DE8 		movq	%rdi, -24(%rbp)
 544 0010 488975E0 		movq	%rsi, -32(%rbp)
 545              		.loc 1 368 1
 546 0014 64488B04 		movq	%fs:40, %rax
 546      25280000 
 546      00
 547 001d 488945F8 		movq	%rax, -8(%rbp)
 548 0021 31C0     		xorl	%eax, %eax
 369:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     const SecUnsignedChar *fmt = *format;
 549              		.loc 1 369 28
 550 0023 488B45E8 		movq	-24(%rbp), %rax
 551 0027 488B00   		movq	(%rax), %rax
 552 002a 488945F0 		movq	%rax, -16(%rbp)
 370:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (*(fmt + 1) == SECUREC_CHAR('l')) {
 553              		.loc 1 370 15
 554 002e 488B45F0 		movq	-16(%rbp), %rax
 555 0032 4883C004 		addq	$4, %rax
 556              		.loc 1 370 9
 557 0036 8B00     		movl	(%rax), %eax
 558              		.loc 1 370 8
 559 0038 83F86C   		cmpl	$108, %eax
 560 003b 751D     		jne	.L36
 371:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->isInt64Arg = 1;
 561              		.loc 1 371 26
 562 003d 488B45E0 		movq	-32(%rbp), %rax
 563 0041 C7401401 		movl	$1, 20(%rax)
 563      000000
 372:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->numberWidth = SECUREC_NUM_WIDTH_LONG_LONG;
 564              		.loc 1 372 27
 565 0048 488B45E0 		movq	-32(%rbp), %rax
 566 004c C7401003 		movl	$3, 16(%rax)
 566      000000
 373:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ++fmt;
 567              		.loc 1 373 9
 568 0053 488345F0 		addq	$4, -16(%rbp)
 568      04
 569 0058 EB1E     		jmp	.L37
 570              	.L36:
 374:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else {
GAS LISTING /tmp/cc1ytava.s 			page 19


 375:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->numberWidth = SECUREC_NUM_WIDTH_LONG;
 571              		.loc 1 375 27
 572 005a 488B45E0 		movq	-32(%rbp), %rax
 573 005e C7401002 		movl	$2, 16(%rax)
 573      000000
 376:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if defined(SECUREC_ON_64BITS) && !(defined(SECUREC_COMPATIBLE_WIN_FORMAT))
 377:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* on window 64 system sizeof long is 32bit */
 378:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->isInt64Arg = 1;
 574              		.loc 1 378 26
 575 0065 488B45E0 		movq	-32(%rbp), %rax
 576 0069 C7401401 		movl	$1, 20(%rax)
 576      000000
 379:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 380:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->isWChar = 1;
 577              		.loc 1 380 23
 578 0070 488B45E0 		movq	-32(%rbp), %rax
 579 0074 C6404001 		movb	$1, 64(%rax)
 580              	.L37:
 381:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 382:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     *format = fmt;
 581              		.loc 1 382 13
 582 0078 488B45E8 		movq	-24(%rbp), %rax
 583 007c 488B55F0 		movq	-16(%rbp), %rdx
 584 0080 488910   		movq	%rdx, (%rax)
 383:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 585              		.loc 1 383 1
 586 0083 90       		nop
 587 0084 488B45F8 		movq	-8(%rbp), %rax
 588 0088 64483304 		xorq	%fs:40, %rax
 588      25280000 
 588      00
 589 0091 7405     		je	.L38
 590 0093 E8000000 		call	__stack_chk_fail@PLT
 590      00
 591              	.L38:
 592 0098 C9       		leave
 593              	.LCFI17:
 594              		.cfi_def_cfa 7, 8
 595 0099 C3       		ret
 596              		.cfi_endproc
 597              	.LFE11:
 599              		.section	.text.SecDecodeScanQualifierI,"ax",@progbits
 601              	SecDecodeScanQualifierI:
 602              	.LFB12:
 384:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 385:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 386:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * decode  %I %I43 %I64 %Id %Ii %Io ...
 387:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * set finishFlag to  1  finish Flag
 388:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 389:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecDecodeScanQualifierI(const SecUnsignedChar **format, SecScanSpec *spec, int *finishF
 390:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 603              		.loc 1 390 1
 604              		.cfi_startproc
 605 0000 F30F1EFA 		endbr64
 606 0004 55       		pushq	%rbp
 607              	.LCFI18:
 608              		.cfi_def_cfa_offset 16
GAS LISTING /tmp/cc1ytava.s 			page 20


 609              		.cfi_offset 6, -16
 610 0005 4889E5   		movq	%rsp, %rbp
 611              	.LCFI19:
 612              		.cfi_def_cfa_register 6
 613 0008 4883EC30 		subq	$48, %rsp
 614 000c 48897DE8 		movq	%rdi, -24(%rbp)
 615 0010 488975E0 		movq	%rsi, -32(%rbp)
 616 0014 488955D8 		movq	%rdx, -40(%rbp)
 617              		.loc 1 390 1
 618 0018 64488B04 		movq	%fs:40, %rax
 618      25280000 
 618      00
 619 0021 488945F8 		movq	%rax, -8(%rbp)
 620 0025 31C0     		xorl	%eax, %eax
 391:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     const SecUnsignedChar *fmt = *format;
 621              		.loc 1 391 28
 622 0027 488B45E8 		movq	-24(%rbp), %rax
 623 002b 488B00   		movq	(%rax), %rax
 624 002e 488945F0 		movq	%rax, -16(%rbp)
 392:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if ((*(fmt + 1) == SECUREC_CHAR('6')) &&
 625              		.loc 1 392 16
 626 0032 488B45F0 		movq	-16(%rbp), %rax
 627 0036 4883C004 		addq	$4, %rax
 628              		.loc 1 392 10
 629 003a 8B00     		movl	(%rax), %eax
 630              		.loc 1 392 8
 631 003c 83F836   		cmpl	$54, %eax
 632 003f 7531     		jne	.L40
 393:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         (*(fmt + 2) == SECUREC_CHAR('4'))) { /* offset 2 for I64 */
 633              		.loc 1 393 16 discriminator 1
 634 0041 488B45F0 		movq	-16(%rbp), %rax
 635 0045 4883C008 		addq	$8, %rax
 636              		.loc 1 393 10 discriminator 1
 637 0049 8B00     		movl	(%rax), %eax
 392:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if ((*(fmt + 1) == SECUREC_CHAR('6')) &&
 638              		.loc 1 392 43 discriminator 1
 639 004b 83F834   		cmpl	$52, %eax
 640 004e 7522     		jne	.L40
 394:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->isInt64Arg = 1;
 641              		.loc 1 394 26
 642 0050 488B45E0 		movq	-32(%rbp), %rax
 643 0054 C7401401 		movl	$1, 20(%rax)
 643      000000
 395:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         *format = *format + 2; /* add 2 to skip I64 point to '4' next loop will inc */
 644              		.loc 1 395 19
 645 005b 488B45E8 		movq	-24(%rbp), %rax
 646 005f 488B00   		movq	(%rax), %rax
 647              		.loc 1 395 27
 648 0062 488D5008 		leaq	8(%rax), %rdx
 649              		.loc 1 395 17
 650 0066 488B45E8 		movq	-24(%rbp), %rax
 651 006a 488910   		movq	%rdx, (%rax)
 652 006d E9AB0000 		jmp	.L41
 652      00
 653              	.L40:
 396:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else if ((*(fmt + 1) == SECUREC_CHAR('3')) &&
 654              		.loc 1 396 23
GAS LISTING /tmp/cc1ytava.s 			page 21


 655 0072 488B45F0 		movq	-16(%rbp), %rax
 656 0076 4883C004 		addq	$4, %rax
 657              		.loc 1 396 17
 658 007a 8B00     		movl	(%rax), %eax
 659              		.loc 1 396 15
 660 007c 83F833   		cmpl	$51, %eax
 661 007f 7523     		jne	.L42
 397:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 (*(fmt + 2) == SECUREC_CHAR('2'))) { /* offset 2 for I32 */
 662              		.loc 1 397 24 discriminator 1
 663 0081 488B45F0 		movq	-16(%rbp), %rax
 664 0085 4883C008 		addq	$8, %rax
 665              		.loc 1 397 18 discriminator 1
 666 0089 8B00     		movl	(%rax), %eax
 396:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else if ((*(fmt + 1) == SECUREC_CHAR('3')) &&
 667              		.loc 1 396 50 discriminator 1
 668 008b 83F832   		cmpl	$50, %eax
 669 008e 7514     		jne	.L42
 398:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         *format = *format + 2; /* add 2 to skip I32 point to '2' next loop will inc */
 670              		.loc 1 398 19
 671 0090 488B45E8 		movq	-24(%rbp), %rax
 672 0094 488B00   		movq	(%rax), %rax
 673              		.loc 1 398 27
 674 0097 488D5008 		leaq	8(%rax), %rdx
 675              		.loc 1 398 17
 676 009b 488B45E8 		movq	-24(%rbp), %rax
 677 009f 488910   		movq	%rdx, (%rax)
 678 00a2 EB79     		jmp	.L41
 679              	.L42:
 399:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else if ((*(fmt + 1) == SECUREC_CHAR('d')) ||
 680              		.loc 1 399 23
 681 00a4 488B45F0 		movq	-16(%rbp), %rax
 682 00a8 4883C004 		addq	$4, %rax
 683              		.loc 1 399 17
 684 00ac 8B00     		movl	(%rax), %eax
 685              		.loc 1 399 15
 686 00ae 83F864   		cmpl	$100, %eax
 687 00b1 743C     		je	.L43
 400:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 (*(fmt + 1) == SECUREC_CHAR('i')) ||
 688              		.loc 1 400 24 discriminator 1
 689 00b3 488B45F0 		movq	-16(%rbp), %rax
 690 00b7 4883C004 		addq	$4, %rax
 691              		.loc 1 400 18 discriminator 1
 692 00bb 8B00     		movl	(%rax), %eax
 399:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else if ((*(fmt + 1) == SECUREC_CHAR('d')) ||
 693              		.loc 1 399 50 discriminator 1
 694 00bd 83F869   		cmpl	$105, %eax
 695 00c0 742D     		je	.L43
 401:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 (*(fmt + 1) == SECUREC_CHAR('o')) ||
 696              		.loc 1 401 24
 697 00c2 488B45F0 		movq	-16(%rbp), %rax
 698 00c6 4883C004 		addq	$4, %rax
 699              		.loc 1 401 18
 700 00ca 8B00     		movl	(%rax), %eax
 400:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 (*(fmt + 1) == SECUREC_CHAR('i')) ||
 701              		.loc 1 400 51
 702 00cc 83F86F   		cmpl	$111, %eax
 703 00cf 741E     		je	.L43
GAS LISTING /tmp/cc1ytava.s 			page 22


 402:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 (*(fmt + 1) == SECUREC_CHAR('x')) ||
 704              		.loc 1 402 24
 705 00d1 488B45F0 		movq	-16(%rbp), %rax
 706 00d5 4883C004 		addq	$4, %rax
 707              		.loc 1 402 18
 708 00d9 8B00     		movl	(%rax), %eax
 401:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 (*(fmt + 1) == SECUREC_CHAR('o')) ||
 709              		.loc 1 401 51
 710 00db 83F878   		cmpl	$120, %eax
 711 00de 740F     		je	.L43
 403:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 (*(fmt + 1) == SECUREC_CHAR('X'))) {
 712              		.loc 1 403 24
 713 00e0 488B45F0 		movq	-16(%rbp), %rax
 714 00e4 4883C004 		addq	$4, %rax
 715              		.loc 1 403 18
 716 00e8 8B00     		movl	(%rax), %eax
 402:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 (*(fmt + 1) == SECUREC_CHAR('x')) ||
 717              		.loc 1 402 51
 718 00ea 83F858   		cmpl	$88, %eax
 719 00ed 7513     		jne	.L44
 720              	.L43:
 404:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->isInt64Arg = SecIs64BitPtr(sizeof(void *));
 721              		.loc 1 404 28
 722 00ef BF080000 		movl	$8, %edi
 722      00
 723 00f4 E8000000 		call	SecIs64BitPtr
 723      00
 724              		.loc 1 404 26
 725 00f9 488B55E0 		movq	-32(%rbp), %rdx
 726 00fd 894214   		movl	%eax, 20(%rdx)
 727 0100 EB1B     		jmp	.L41
 728              	.L44:
 405:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else {
 406:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* for %I */
 407:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->isInt64Arg = SecIs64BitPtr(sizeof(void *));
 729              		.loc 1 407 28
 730 0102 BF080000 		movl	$8, %edi
 730      00
 731 0107 E8000000 		call	SecIs64BitPtr
 731      00
 732              		.loc 1 407 26
 733 010c 488B55E0 		movq	-32(%rbp), %rdx
 734 0110 894214   		movl	%eax, 20(%rdx)
 408:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         *finishFlag = 1;
 735              		.loc 1 408 21
 736 0113 488B45D8 		movq	-40(%rbp), %rax
 737 0117 C7000100 		movl	$1, (%rax)
 737      0000
 738              	.L41:
 409:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 410:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 739              		.loc 1 410 1
 740 011d 90       		nop
 741 011e 488B45F8 		movq	-8(%rbp), %rax
 742 0122 64483304 		xorq	%fs:40, %rax
 742      25280000 
 742      00
GAS LISTING /tmp/cc1ytava.s 			page 23


 743 012b 7405     		je	.L45
 744 012d E8000000 		call	__stack_chk_fail@PLT
 744      00
 745              	.L45:
 746 0132 C9       		leave
 747              	.LCFI20:
 748              		.cfi_def_cfa 7, 8
 749 0133 C3       		ret
 750              		.cfi_endproc
 751              	.LFE12:
 753              		.section	.text.SecDecodeScanWidth,"ax",@progbits
 755              	SecDecodeScanWidth:
 756              	.LFB13:
 411:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 412:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static int SecDecodeScanWidth(const SecUnsignedChar **format, SecScanSpec *spec)
 413:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 757              		.loc 1 413 1
 758              		.cfi_startproc
 759 0000 F30F1EFA 		endbr64
 760 0004 55       		pushq	%rbp
 761              	.LCFI21:
 762              		.cfi_def_cfa_offset 16
 763              		.cfi_offset 6, -16
 764 0005 4889E5   		movq	%rsp, %rbp
 765              	.LCFI22:
 766              		.cfi_def_cfa_register 6
 767 0008 4883EC20 		subq	$32, %rsp
 768 000c 48897DE8 		movq	%rdi, -24(%rbp)
 769 0010 488975E0 		movq	%rsi, -32(%rbp)
 770              		.loc 1 413 1
 771 0014 64488B04 		movq	%fs:40, %rax
 771      25280000 
 771      00
 772 001d 488945F8 		movq	%rax, -8(%rbp)
 773 0021 31C0     		xorl	%eax, %eax
 414:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     const SecUnsignedChar *fmt = *format;
 774              		.loc 1 414 28
 775 0023 488B45E8 		movq	-24(%rbp), %rax
 776 0027 488B00   		movq	(%rax), %rax
 777 002a 488945F0 		movq	%rax, -16(%rbp)
 415:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     while (SECUREC_IS_DIGIT(*fmt)) {
 778              		.loc 1 415 11
 779 002e EB58     		jmp	.L47
 780              	.L51:
 416:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->widthSet = 1;
 781              		.loc 1 416 24
 782 0030 488B45E0 		movq	-32(%rbp), %rax
 783 0034 C7403401 		movl	$1, 52(%rax)
 783      000000
 417:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (SECUREC_MUL_TEN_ADD_BEYOND_MAX(spec->width)) {
 784              		.loc 1 417 13
 785 003b 488B45E0 		movq	-32(%rbp), %rax
 786 003f 8B4030   		movl	48(%rax), %eax
 787              		.loc 1 417 12
 788 0042 3D14AE47 		cmpl	$21474836, %eax
 788      01
 789 0047 7E0A     		jle	.L48
GAS LISTING /tmp/cc1ytava.s 			page 24


 418:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             return -1;
 790              		.loc 1 418 20
 791 0049 B8FFFFFF 		movl	$-1, %eax
 791      FF
 792 004e E9800000 		jmp	.L49
 792      00
 793              	.L48:
 419:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 420:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->width = (int)SECUREC_MUL_TEN((unsigned int)spec->width) + (unsigned char)(*fmt - SECU
 794              		.loc 1 420 28
 795 0053 488B45E0 		movq	-32(%rbp), %rax
 796 0057 8B4030   		movl	48(%rax), %eax
 797 005a 8D148500 		leal	0(,%rax,4), %edx
 797      000000
 798 0061 488B45E0 		movq	-32(%rbp), %rax
 799 0065 8B4030   		movl	48(%rax), %eax
 800 0068 01D0     		addl	%edx, %eax
 801 006a 01C0     		addl	%eax, %eax
 802              		.loc 1 420 23
 803 006c 89C2     		movl	%eax, %edx
 804              		.loc 1 420 89
 805 006e 488B45F0 		movq	-16(%rbp), %rax
 806 0072 8B00     		movl	(%rax), %eax
 807              		.loc 1 420 73
 808 0074 83E830   		subl	$48, %eax
 809 0077 0FB6C0   		movzbl	%al, %eax
 810              		.loc 1 420 71
 811 007a 01C2     		addl	%eax, %edx
 812              		.loc 1 420 21
 813 007c 488B45E0 		movq	-32(%rbp), %rax
 814 0080 895030   		movl	%edx, 48(%rax)
 421:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ++fmt;
 815              		.loc 1 421 9
 816 0083 488345F0 		addq	$4, -16(%rbp)
 816      04
 817              	.L47:
 415:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->widthSet = 1;
 818              		.loc 1 415 12
 819 0088 488B45F0 		movq	-16(%rbp), %rax
 820 008c 8B00     		movl	(%rax), %eax
 821 008e 2500FF00 		andl	$65280, %eax
 821      00
 415:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->widthSet = 1;
 822              		.loc 1 415 11
 823 0093 85C0     		testl	%eax, %eax
 824 0095 752C     		jne	.L50
 415:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->widthSet = 1;
 825              		.loc 1 415 12 discriminator 1
 826 0097 E8000000 		call	__ctype_b_loc@PLT
 826      00
 827 009c 488B10   		movq	(%rax), %rdx
 828 009f 488B45F0 		movq	-16(%rbp), %rax
 829 00a3 8B00     		movl	(%rax), %eax
 830 00a5 4898     		cltq
 831 00a7 0FB6C0   		movzbl	%al, %eax
 832 00aa 4801C0   		addq	%rax, %rax
 833 00ad 4801D0   		addq	%rdx, %rax
GAS LISTING /tmp/cc1ytava.s 			page 25


 834 00b0 0FB700   		movzwl	(%rax), %eax
 835 00b3 0FB7C0   		movzwl	%ax, %eax
 836 00b6 25000800 		andl	$2048, %eax
 836      00
 837 00bb 85C0     		testl	%eax, %eax
 838 00bd 0F856DFF 		jne	.L51
 838      FFFF
 839              	.L50:
 422:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 423:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     *format = fmt;
 840              		.loc 1 423 13
 841 00c3 488B45E8 		movq	-24(%rbp), %rax
 842 00c7 488B55F0 		movq	-16(%rbp), %rdx
 843 00cb 488910   		movq	%rdx, (%rax)
 424:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return 0;
 844              		.loc 1 424 12
 845 00ce B8000000 		movl	$0, %eax
 845      00
 846              	.L49:
 425:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 847              		.loc 1 425 1
 848 00d3 488B4DF8 		movq	-8(%rbp), %rcx
 849 00d7 6448330C 		xorq	%fs:40, %rcx
 849      25280000 
 849      00
 850 00e0 7405     		je	.L52
 851 00e2 E8000000 		call	__stack_chk_fail@PLT
 851      00
 852              	.L52:
 853 00e7 C9       		leave
 854              	.LCFI23:
 855              		.cfi_def_cfa 7, 8
 856 00e8 C3       		ret
 857              		.cfi_endproc
 858              	.LFE13:
 860              		.section	.text.SecSetDefaultScanSpec,"ax",@progbits
 862              	SecSetDefaultScanSpec:
 863              	.LFB14:
 426:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 427:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 428:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * init default flags for each format
 429:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 430:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecSetDefaultScanSpec(SecScanSpec *spec)
 431:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 864              		.loc 1 431 1
 865              		.cfi_startproc
 866 0000 F30F1EFA 		endbr64
 867 0004 55       		pushq	%rbp
 868              	.LCFI24:
 869              		.cfi_def_cfa_offset 16
 870              		.cfi_offset 6, -16
 871 0005 4889E5   		movq	%rsp, %rbp
 872              	.LCFI25:
 873              		.cfi_def_cfa_register 6
 874 0008 4883EC20 		subq	$32, %rsp
 875 000c 48897DE8 		movq	%rdi, -24(%rbp)
 876              		.loc 1 431 1
GAS LISTING /tmp/cc1ytava.s 			page 26


 877 0010 64488B04 		movq	%fs:40, %rax
 877      25280000 
 877      00
 878 0019 488945F8 		movq	%rax, -8(%rbp)
 879 001d 31C0     		xorl	%eax, %eax
 432:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->number64 = 0;
 880              		.loc 1 432 20
 881 001f 488B45E8 		movq	-24(%rbp), %rax
 882 0023 48C70000 		movq	$0, (%rax)
 882      000000
 433:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->number = 0;
 883              		.loc 1 433 18
 884 002a 488B45E8 		movq	-24(%rbp), %rax
 885 002e 48C74008 		movq	$0, 8(%rax)
 885      00000000 
 434:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->numberWidth = SECUREC_NUM_WIDTH_INT;    /* 0 = SHORT, 1 = int, > 1  long or L_DOUBLE */
 886              		.loc 1 434 23
 887 0036 488B45E8 		movq	-24(%rbp), %rax
 888 003a C7401001 		movl	$1, 16(%rax)
 888      000000
 435:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->isInt64Arg = 0;                         /* 1 for 64-bit integer, 0 otherwise */
 889              		.loc 1 435 22
 890 0041 488B45E8 		movq	-24(%rbp), %rax
 891 0045 C7401400 		movl	$0, 20(%rax)
 891      000000
 436:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->negative = 0;
 892              		.loc 1 436 20
 893 004c 488B45E8 		movq	-24(%rbp), %rax
 894 0050 C7401800 		movl	$0, 24(%rax)
 894      000000
 437:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if (defined(SECUREC_COMPATIBLE_LINUX_FORMAT) && !(defined(SECUREC_ON_UNIX)))
 438:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->beyondMax = 0;
 895              		.loc 1 438 21
 896 0057 488B45E8 		movq	-24(%rbp), %rax
 897 005b C7401C00 		movl	$0, 28(%rax)
 897      000000
 439:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 440:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->argPtr = NULL;
 898              		.loc 1 440 18
 899 0062 488B45E8 		movq	-24(%rbp), %rax
 900 0066 48C74020 		movq	$0, 32(%rax)
 900      00000000 
 441:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->arrayWidth = 0;
 901              		.loc 1 441 22
 902 006e 488B45E8 		movq	-24(%rbp), %rax
 903 0072 48C74028 		movq	$0, 40(%rax)
 903      00000000 
 442:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->width = 0;
 904              		.loc 1 442 17
 905 007a 488B45E8 		movq	-24(%rbp), %rax
 906 007e C7403000 		movl	$0, 48(%rax)
 906      000000
 443:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->widthSet = 0;
 907              		.loc 1 443 20
 908 0085 488B45E8 		movq	-24(%rbp), %rax
 909 0089 C7403400 		movl	$0, 52(%rax)
 909      000000
GAS LISTING /tmp/cc1ytava.s 			page 27


 444:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->comChr = 0;
 910              		.loc 1 444 18
 911 0090 488B45E8 		movq	-24(%rbp), %rax
 912 0094 C7403800 		movl	$0, 56(%rax)
 912      000000
 445:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->isWChar = 0;
 913              		.loc 1 445 19
 914 009b 488B45E8 		movq	-24(%rbp), %rax
 915 009f C6404000 		movb	$0, 64(%rax)
 446:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->suppress = 0;
 916              		.loc 1 446 20
 917 00a3 488B45E8 		movq	-24(%rbp), %rax
 918 00a7 C6404100 		movb	$0, 65(%rax)
 447:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 919              		.loc 1 447 1
 920 00ab 90       		nop
 921 00ac 488B45F8 		movq	-8(%rbp), %rax
 922 00b0 64483304 		xorq	%fs:40, %rax
 922      25280000 
 922      00
 923 00b9 7405     		je	.L54
 924 00bb E8000000 		call	__stack_chk_fail@PLT
 924      00
 925              	.L54:
 926 00c0 C9       		leave
 927              	.LCFI26:
 928              		.cfi_def_cfa 7, 8
 929 00c1 C3       		ret
 930              		.cfi_endproc
 931              	.LFE14:
 933              		.section	.text.SecDecodeScanQualifier,"ax",@progbits
 935              	SecDecodeScanQualifier:
 936              	.LFB15:
 448:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 449:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 450:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * decode qualifier %I %L %h ...
 451:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * set finishFlag to  1  finish Flag
 452:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 453:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void  SecDecodeScanQualifier(const SecUnsignedChar **format, SecScanSpec *spec, int *finishF
 454:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 937              		.loc 1 454 1
 938              		.cfi_startproc
 939 0000 F30F1EFA 		endbr64
 940 0004 55       		pushq	%rbp
 941              	.LCFI27:
 942              		.cfi_def_cfa_offset 16
 943              		.cfi_offset 6, -16
 944 0005 4889E5   		movq	%rsp, %rbp
 945              	.LCFI28:
 946              		.cfi_def_cfa_register 6
 947 0008 4883EC30 		subq	$48, %rsp
 948 000c 48897DE8 		movq	%rdi, -24(%rbp)
 949 0010 488975E0 		movq	%rsi, -32(%rbp)
 950 0014 488955D8 		movq	%rdx, -40(%rbp)
 951              		.loc 1 454 1
 952 0018 64488B04 		movq	%fs:40, %rax
 952      25280000 
GAS LISTING /tmp/cc1ytava.s 			page 28


 952      00
 953 0021 488945F8 		movq	%rax, -8(%rbp)
 954 0025 31C0     		xorl	%eax, %eax
 455:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     switch ((int)(unsigned char)(**(format))) {
 955              		.loc 1 455 35
 956 0027 488B45E8 		movq	-24(%rbp), %rax
 957 002b 488B00   		movq	(%rax), %rax
 958              		.loc 1 455 34
 959 002e 8B00     		movl	(%rax), %eax
 960              		.loc 1 455 13
 961 0030 0FB6C0   		movzbl	%al, %eax
 962 0033 83E82A   		subl	$42, %eax
 963 0036 83F850   		cmpl	$80, %eax
 964 0039 0F87CB00 		ja	.L56
 964      0000
 965 003f 89C0     		movl	%eax, %eax
 966 0041 488D1485 		leaq	0(,%rax,4), %rdx
 966      00000000 
 967 0049 488D0500 		leaq	.L58(%rip), %rax
 967      000000
 968 0050 8B0402   		movl	(%rdx,%rax), %eax
 969 0053 4898     		cltq
 970 0055 488D1500 		leaq	.L58(%rip), %rdx
 970      000000
 971 005c 4801D0   		addq	%rdx, %rax
 972 005f 3EFFE0   		notrack jmp	*%rax
 973              		.section	.rodata.SecDecodeScanQualifier,"a",@progbits
 974              		.align 4
 975              		.align 4
 976              	.L58:
 977 0000 00000000 		.long	.L66-.L58
 978 0004 00000000 		.long	.L56-.L58
 979 0008 00000000 		.long	.L56-.L58
 980 000c 00000000 		.long	.L56-.L58
 981 0010 00000000 		.long	.L56-.L58
 982 0014 00000000 		.long	.L56-.L58
 983 0018 00000000 		.long	.L56-.L58
 984 001c 00000000 		.long	.L56-.L58
 985 0020 00000000 		.long	.L56-.L58
 986 0024 00000000 		.long	.L56-.L58
 987 0028 00000000 		.long	.L56-.L58
 988 002c 00000000 		.long	.L56-.L58
 989 0030 00000000 		.long	.L56-.L58
 990 0034 00000000 		.long	.L56-.L58
 991 0038 00000000 		.long	.L56-.L58
 992 003c 00000000 		.long	.L56-.L58
 993 0040 00000000 		.long	.L56-.L58
 994 0044 00000000 		.long	.L56-.L58
 995 0048 00000000 		.long	.L56-.L58
 996 004c 00000000 		.long	.L56-.L58
 997 0050 00000000 		.long	.L56-.L58
 998 0054 00000000 		.long	.L56-.L58
 999 0058 00000000 		.long	.L56-.L58
 1000 005c 00000000 		.long	.L56-.L58
 1001 0060 00000000 		.long	.L56-.L58
 1002 0064 00000000 		.long	.L56-.L58
 1003 0068 00000000 		.long	.L56-.L58
GAS LISTING /tmp/cc1ytava.s 			page 29


 1004 006c 00000000 		.long	.L56-.L58
 1005 0070 00000000 		.long	.L69-.L58
 1006 0074 00000000 		.long	.L56-.L58
 1007 0078 00000000 		.long	.L56-.L58
 1008 007c 00000000 		.long	.L65-.L58
 1009 0080 00000000 		.long	.L56-.L58
 1010 0084 00000000 		.long	.L56-.L58
 1011 0088 00000000 		.long	.L60-.L58
 1012 008c 00000000 		.long	.L56-.L58
 1013 0090 00000000 		.long	.L69-.L58
 1014 0094 00000000 		.long	.L56-.L58
 1015 0098 00000000 		.long	.L56-.L58
 1016 009c 00000000 		.long	.L56-.L58
 1017 00a0 00000000 		.long	.L56-.L58
 1018 00a4 00000000 		.long	.L56-.L58
 1019 00a8 00000000 		.long	.L56-.L58
 1020 00ac 00000000 		.long	.L56-.L58
 1021 00b0 00000000 		.long	.L56-.L58
 1022 00b4 00000000 		.long	.L56-.L58
 1023 00b8 00000000 		.long	.L56-.L58
 1024 00bc 00000000 		.long	.L56-.L58
 1025 00c0 00000000 		.long	.L56-.L58
 1026 00c4 00000000 		.long	.L56-.L58
 1027 00c8 00000000 		.long	.L56-.L58
 1028 00cc 00000000 		.long	.L56-.L58
 1029 00d0 00000000 		.long	.L56-.L58
 1030 00d4 00000000 		.long	.L56-.L58
 1031 00d8 00000000 		.long	.L56-.L58
 1032 00dc 00000000 		.long	.L56-.L58
 1033 00e0 00000000 		.long	.L56-.L58
 1034 00e4 00000000 		.long	.L56-.L58
 1035 00e8 00000000 		.long	.L56-.L58
 1036 00ec 00000000 		.long	.L56-.L58
 1037 00f0 00000000 		.long	.L56-.L58
 1038 00f4 00000000 		.long	.L56-.L58
 1039 00f8 00000000 		.long	.L63-.L58
 1040 00fc 00000000 		.long	.L56-.L58
 1041 0100 00000000 		.long	.L62-.L58
 1042 0104 00000000 		.long	.L56-.L58
 1043 0108 00000000 		.long	.L61-.L58
 1044 010c 00000000 		.long	.L56-.L58
 1045 0110 00000000 		.long	.L56-.L58
 1046 0114 00000000 		.long	.L56-.L58
 1047 0118 00000000 		.long	.L56-.L58
 1048 011c 00000000 		.long	.L60-.L58
 1049 0120 00000000 		.long	.L56-.L58
 1050 0124 00000000 		.long	.L56-.L58
 1051 0128 00000000 		.long	.L57-.L58
 1052 012c 00000000 		.long	.L56-.L58
 1053 0130 00000000 		.long	.L56-.L58
 1054 0134 00000000 		.long	.L59-.L58
 1055 0138 00000000 		.long	.L56-.L58
 1056 013c 00000000 		.long	.L56-.L58
 1057 0140 00000000 		.long	.L57-.L58
 1058              		.section	.text.SecDecodeScanQualifier
 1059              	.L63:
 456:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         case SECUREC_CHAR('F'):    /* fall-through */ /* FALLTHRU */
GAS LISTING /tmp/cc1ytava.s 			page 30


 457:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         case SECUREC_CHAR('N'):
 458:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             break;
 459:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         case SECUREC_CHAR('h'):
 460:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             --spec->numberWidth;  /* h for SHORT , hh for CHAR */
 1060              		.loc 1 460 19
 1061 0062 488B45E0 		movq	-32(%rbp), %rax
 1062 0066 8B4010   		movl	16(%rax), %eax
 1063              		.loc 1 460 13
 1064 0069 8D50FF   		leal	-1(%rax), %edx
 1065 006c 488B45E0 		movq	-32(%rbp), %rax
 1066 0070 895010   		movl	%edx, 16(%rax)
 461:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->isWChar = -1;
 1067              		.loc 1 461 27
 1068 0073 488B45E0 		movq	-32(%rbp), %rax
 1069 0077 C64040FF 		movb	$-1, 64(%rax)
 462:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             break;
 1070              		.loc 1 462 13
 1071 007b E9970000 		jmp	.L67
 1071      00
 1072              	.L62:
 463:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_COMPATIBLE_LINUX_FORMAT
 464:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         case SECUREC_CHAR('j'):
 465:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->numberWidth = SECUREC_NUM_WIDTH_LONG_LONG;  /* intmax_t or uintmax_t */
 1073              		.loc 1 465 31
 1074 0080 488B45E0 		movq	-32(%rbp), %rax
 1075 0084 C7401003 		movl	$3, 16(%rax)
 1075      000000
 466:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->isInt64Arg = 1;
 1076              		.loc 1 466 30
 1077 008b 488B45E0 		movq	-32(%rbp), %rax
 1078 008f C7401401 		movl	$1, 20(%rax)
 1078      000000
 467:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             break;
 1079              		.loc 1 467 13
 1080 0096 EB7F     		jmp	.L67
 1081              	.L57:
 468:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         case SECUREC_CHAR('t'):    /* fall-through */ /* FALLTHRU */
 469:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 470:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         case SECUREC_CHAR('z'):
 471:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_ON_64BITS
 472:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->numberWidth = SECUREC_NUM_WIDTH_LONG_LONG;
 1082              		.loc 1 472 31
 1083 0098 488B45E0 		movq	-32(%rbp), %rax
 1084 009c C7401003 		movl	$3, 16(%rax)
 1084      000000
 473:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->isInt64Arg = 1;
 1085              		.loc 1 473 30
 1086 00a3 488B45E0 		movq	-32(%rbp), %rax
 1087 00a7 C7401401 		movl	$1, 20(%rax)
 1087      000000
 474:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
 475:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->numberWidth = SECUREC_NUM_WIDTH_LONG;
 476:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 477:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             break;
 1088              		.loc 1 477 13
 1089 00ae EB67     		jmp	.L67
 1090              	.L60:
GAS LISTING /tmp/cc1ytava.s 			page 31


 478:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         case SECUREC_CHAR('L'):    /* long double */ /* fall-through */ /* FALLTHRU */
 479:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         case SECUREC_CHAR('q'):
 480:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->numberWidth = SECUREC_NUM_WIDTH_LONG_LONG;
 1091              		.loc 1 480 31
 1092 00b0 488B45E0 		movq	-32(%rbp), %rax
 1093 00b4 C7401003 		movl	$3, 16(%rax)
 1093      000000
 481:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->isInt64Arg = 1;
 1094              		.loc 1 481 30
 1095 00bb 488B45E0 		movq	-32(%rbp), %rax
 1096 00bf C7401401 		movl	$1, 20(%rax)
 1096      000000
 482:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             break;
 1097              		.loc 1 482 13
 1098 00c6 EB4F     		jmp	.L67
 1099              	.L61:
 483:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         case SECUREC_CHAR('l'):
 484:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SecDecodeScanQualifierL(format, spec);
 1100              		.loc 1 484 13
 1101 00c8 488B55E0 		movq	-32(%rbp), %rdx
 1102 00cc 488B45E8 		movq	-24(%rbp), %rax
 1103 00d0 4889D6   		movq	%rdx, %rsi
 1104 00d3 4889C7   		movq	%rax, %rdi
 1105 00d6 E8000000 		call	SecDecodeScanQualifierL
 1105      00
 485:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             break;
 1106              		.loc 1 485 13
 1107 00db EB3A     		jmp	.L67
 1108              	.L59:
 486:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         case SECUREC_CHAR('w'):
 487:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->isWChar = 1;
 1109              		.loc 1 487 27
 1110 00dd 488B45E0 		movq	-32(%rbp), %rax
 1111 00e1 C6404001 		movb	$1, 64(%rax)
 488:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             break;
 1112              		.loc 1 488 13
 1113 00e5 EB30     		jmp	.L67
 1114              	.L66:
 489:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         case SECUREC_CHAR('*'):
 490:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->suppress = 1;
 1115              		.loc 1 490 28
 1116 00e7 488B45E0 		movq	-32(%rbp), %rax
 1117 00eb C6404101 		movb	$1, 65(%rax)
 491:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             break;
 1118              		.loc 1 491 13
 1119 00ef EB26     		jmp	.L67
 1120              	.L65:
 492:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         case SECUREC_CHAR('I'):
 493:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SecDecodeScanQualifierI(format, spec, finishFlag);
 1121              		.loc 1 493 13
 1122 00f1 488B55D8 		movq	-40(%rbp), %rdx
 1123 00f5 488B4DE0 		movq	-32(%rbp), %rcx
 1124 00f9 488B45E8 		movq	-24(%rbp), %rax
 1125 00fd 4889CE   		movq	%rcx, %rsi
 1126 0100 4889C7   		movq	%rax, %rdi
 1127 0103 E8000000 		call	SecDecodeScanQualifierI
 1127      00
GAS LISTING /tmp/cc1ytava.s 			page 32


 494:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             break;
 1128              		.loc 1 494 13
 1129 0108 EB0D     		jmp	.L67
 1130              	.L56:
 495:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         default:
 496:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             *finishFlag = 1;
 1131              		.loc 1 496 25
 1132 010a 488B45D8 		movq	-40(%rbp), %rax
 1133 010e C7000100 		movl	$1, (%rax)
 1133      0000
 497:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             break;
 1134              		.loc 1 497 13
 1135 0114 EB01     		jmp	.L67
 1136              	.L69:
 458:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         case SECUREC_CHAR('h'):
 1137              		.loc 1 458 13
 1138 0116 90       		nop
 1139              	.L67:
 498:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 499:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 500:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 1140              		.loc 1 500 1
 1141 0117 90       		nop
 1142 0118 488B45F8 		movq	-8(%rbp), %rax
 1143 011c 64483304 		xorq	%fs:40, %rax
 1143      25280000 
 1143      00
 1144 0125 7405     		je	.L68
 1145 0127 E8000000 		call	__stack_chk_fail@PLT
 1145      00
 1146              	.L68:
 1147 012c C9       		leave
 1148              	.LCFI29:
 1149              		.cfi_def_cfa 7, 8
 1150 012d C3       		ret
 1151              		.cfi_endproc
 1152              	.LFE15:
 1154              		.section	.text.SecDecodeScanFlag,"ax",@progbits
 1156              	SecDecodeScanFlag:
 1157              	.LFB16:
 501:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 502:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * decode width and qualifier in format
 503:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 504:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static int SecDecodeScanFlag(const SecUnsignedChar **format, SecScanSpec *spec)
 505:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 1158              		.loc 1 505 1
 1159              		.cfi_startproc
 1160 0000 F30F1EFA 		endbr64
 1161 0004 55       		pushq	%rbp
 1162              	.LCFI30:
 1163              		.cfi_def_cfa_offset 16
 1164              		.cfi_offset 6, -16
 1165 0005 4889E5   		movq	%rsp, %rbp
 1166              	.LCFI31:
 1167              		.cfi_def_cfa_register 6
 1168 0008 4883EC30 		subq	$48, %rsp
 1169 000c 48897DD8 		movq	%rdi, -40(%rbp)
GAS LISTING /tmp/cc1ytava.s 			page 33


 1170 0010 488975D0 		movq	%rsi, -48(%rbp)
 1171              		.loc 1 505 1
 1172 0014 64488B04 		movq	%fs:40, %rax
 1172      25280000 
 1172      00
 1173 001d 488945F8 		movq	%rax, -8(%rbp)
 1174 0021 31C0     		xorl	%eax, %eax
 506:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     const SecUnsignedChar *fmt = *format;
 1175              		.loc 1 506 34
 1176 0023 488B45D8 		movq	-40(%rbp), %rax
 1177 0027 488B00   		movq	(%rax), %rax
 1178              		.loc 1 506 28
 1179 002a 488945F0 		movq	%rax, -16(%rbp)
 507:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     int finishFlag = 0;
 1180              		.loc 1 507 9
 1181 002e C745EC00 		movl	$0, -20(%rbp)
 1181      000000
 1182              	.L73:
 508:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 509:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     do {
 510:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ++fmt; /*  first skip % , next  seek fmt */
 1183              		.loc 1 510 9
 1184 0035 488B45F0 		movq	-16(%rbp), %rax
 1185 0039 4883C004 		addq	$4, %rax
 1186 003d 488945F0 		movq	%rax, -16(%rbp)
 511:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* may %*6d , so put it inside the loop */
 512:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (SecDecodeScanWidth(&fmt, spec) != 0) {
 1187              		.loc 1 512 13
 1188 0041 488B55D0 		movq	-48(%rbp), %rdx
 1189 0045 488D45F0 		leaq	-16(%rbp), %rax
 1190 0049 4889D6   		movq	%rdx, %rsi
 1191 004c 4889C7   		movq	%rax, %rdi
 1192 004f E8000000 		call	SecDecodeScanWidth
 1192      00
 1193              		.loc 1 512 12
 1194 0054 85C0     		testl	%eax, %eax
 1195 0056 7407     		je	.L71
 513:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             return -1;
 1196              		.loc 1 513 20
 1197 0058 B8FFFFFF 		movl	$-1, %eax
 1197      FF
 1198 005d EB2E     		jmp	.L74
 1199              	.L71:
 514:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 515:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SecDecodeScanQualifier(&fmt, spec, &finishFlag);
 1200              		.loc 1 515 9
 1201 005f 488D55EC 		leaq	-20(%rbp), %rdx
 1202 0063 488B4DD0 		movq	-48(%rbp), %rcx
 1203 0067 488D45F0 		leaq	-16(%rbp), %rax
 1204 006b 4889CE   		movq	%rcx, %rsi
 1205 006e 4889C7   		movq	%rax, %rdi
 1206 0071 E8000000 		call	SecDecodeScanQualifier
 1206      00
 516:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } while (finishFlag == 0);
 1207              		.loc 1 516 25
 1208 0076 8B45EC   		movl	-20(%rbp), %eax
 1209              		.loc 1 516 5
GAS LISTING /tmp/cc1ytava.s 			page 34


 1210 0079 85C0     		testl	%eax, %eax
 1211 007b 74B8     		je	.L73
 517:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     *format = fmt;
 1212              		.loc 1 517 13
 1213 007d 488B55F0 		movq	-16(%rbp), %rdx
 1214 0081 488B45D8 		movq	-40(%rbp), %rax
 1215 0085 488910   		movq	%rdx, (%rax)
 518:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return 0;
 1216              		.loc 1 518 12
 1217 0088 B8000000 		movl	$0, %eax
 1217      00
 1218              	.L74:
 519:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 1219              		.loc 1 519 1 discriminator 1
 1220 008d 488B4DF8 		movq	-8(%rbp), %rcx
 1221 0091 6448330C 		xorq	%fs:40, %rcx
 1221      25280000 
 1221      00
 1222 009a 7405     		je	.L75
 1223              		.loc 1 519 1 is_stmt 0
 1224 009c E8000000 		call	__stack_chk_fail@PLT
 1224      00
 1225              	.L75:
 1226 00a1 C9       		leave
 1227              	.LCFI32:
 1228              		.cfi_def_cfa 7, 8
 1229 00a2 C3       		ret
 1230              		.cfi_endproc
 1231              	.LFE16:
 1233              		.section	.text.SecDecodeClearFormat,"ax",@progbits
 1235              	SecDecodeClearFormat:
 1236              	.LFB17:
 520:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 521:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 522:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 523:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 524:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 525:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 526:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * Judging whether a zeroing buffer is needed according to different formats
 527:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 528:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static int SecDecodeClearFormat(const SecUnsignedChar *format, int *comChr)
 529:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 1237              		.loc 1 529 1 is_stmt 1
 1238              		.cfi_startproc
 1239 0000 F30F1EFA 		endbr64
 1240 0004 55       		pushq	%rbp
 1241              	.LCFI33:
 1242              		.cfi_def_cfa_offset 16
 1243              		.cfi_offset 6, -16
 1244 0005 4889E5   		movq	%rsp, %rbp
 1245              	.LCFI34:
 1246              		.cfi_def_cfa_register 6
 1247 0008 4883EC30 		subq	$48, %rsp
 1248 000c 48897DD8 		movq	%rdi, -40(%rbp)
 1249 0010 488975D0 		movq	%rsi, -48(%rbp)
 1250              		.loc 1 529 1
 1251 0014 64488B04 		movq	%fs:40, %rax
GAS LISTING /tmp/cc1ytava.s 			page 35


 1251      25280000 
 1251      00
 1252 001d 488945F8 		movq	%rax, -8(%rbp)
 1253 0021 31C0     		xorl	%eax, %eax
 530:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     const SecUnsignedChar *fmt = format;
 1254              		.loc 1 530 28
 1255 0023 488B45D8 		movq	-40(%rbp), %rax
 1256 0027 488945F0 		movq	%rax, -16(%rbp)
 531:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     /* to lowercase */
 532:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     int ch = (unsigned char)(*fmt) | (SECUREC_CHAR('a') - SECUREC_CHAR('A'));
 1257              		.loc 1 532 30
 1258 002b 488B45F0 		movq	-16(%rbp), %rax
 1259 002f 8B00     		movl	(%rax), %eax
 1260              		.loc 1 532 36
 1261 0031 83C820   		orl	$32, %eax
 1262              		.loc 1 532 9
 1263 0034 0FB6C0   		movzbl	%al, %eax
 1264 0037 8945EC   		movl	%eax, -20(%rbp)
 533:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (!(ch == SECUREC_CHAR('c') || ch == SECUREC_CHAR('s') || ch == SECUREC_BRACE)) {
 1265              		.loc 1 533 8
 1266 003a 837DEC63 		cmpl	$99, -20(%rbp)
 1267 003e 7413     		je	.L77
 1268              		.loc 1 533 35 discriminator 1
 1269 0040 837DEC73 		cmpl	$115, -20(%rbp)
 1270 0044 740D     		je	.L77
 1271              		.loc 1 533 9 discriminator 2
 1272 0046 837DEC7B 		cmpl	$123, -20(%rbp)
 1273 004a 7407     		je	.L77
 534:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return -1;     /* first argument is not a string type */
 1274              		.loc 1 534 16
 1275 004c B8FFFFFF 		movl	$-1, %eax
 1275      FF
 1276 0051 EB78     		jmp	.L78
 1277              	.L77:
 535:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 536:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (ch == SECUREC_BRACE) {
 1278              		.loc 1 536 8
 1279 0053 837DEC7B 		cmpl	$123, -20(%rbp)
 1280 0057 7564     		jne	.L79
 537:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if !(defined(SECUREC_COMPATIBLE_WIN_FORMAT))
 538:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (*fmt == SECUREC_CHAR('{')) {
 1281              		.loc 1 538 13
 1282 0059 488B45F0 		movq	-16(%rbp), %rax
 1283 005d 8B00     		movl	(%rax), %eax
 1284              		.loc 1 538 12
 1285 005f 83F87B   		cmpl	$123, %eax
 1286 0062 7507     		jne	.L80
 539:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             return -1;
 1287              		.loc 1 539 20
 1288 0064 B8FFFFFF 		movl	$-1, %eax
 1288      FF
 1289 0069 EB60     		jmp	.L78
 1290              	.L80:
 540:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 541:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 542:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ++fmt;
 1291              		.loc 1 542 9
GAS LISTING /tmp/cc1ytava.s 			page 36


 1292 006b 488345F0 		addq	$4, -16(%rbp)
 1292      04
 543:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (*fmt == SECUREC_CHAR('^')) {
 1293              		.loc 1 543 13
 1294 0070 488B45F0 		movq	-16(%rbp), %rax
 1295 0074 8B00     		movl	(%rax), %eax
 1296              		.loc 1 543 12
 1297 0076 83F85E   		cmpl	$94, %eax
 1298 0079 7505     		jne	.L81
 544:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             ++fmt;
 1299              		.loc 1 544 13
 1300 007b 488345F0 		addq	$4, -16(%rbp)
 1300      04
 1301              	.L81:
 545:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 546:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (*fmt == SECUREC_CHAR(']')) {
 1302              		.loc 1 546 13
 1303 0080 488B45F0 		movq	-16(%rbp), %rax
 1304 0084 8B00     		movl	(%rax), %eax
 1305              		.loc 1 546 12
 1306 0086 83F85D   		cmpl	$93, %eax
 1307 0089 750C     		jne	.L83
 547:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             ++fmt;
 1308              		.loc 1 547 13
 1309 008b 488345F0 		addq	$4, -16(%rbp)
 1309      04
 548:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 549:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         while ((*fmt != SECUREC_CHAR('\0')) && (*fmt != SECUREC_CHAR(']'))) {
 1310              		.loc 1 549 15
 1311 0090 EB05     		jmp	.L83
 1312              	.L85:
 550:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             ++fmt;
 1313              		.loc 1 550 13
 1314 0092 488345F0 		addq	$4, -16(%rbp)
 1314      04
 1315              	.L83:
 549:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             ++fmt;
 1316              		.loc 1 549 17
 1317 0097 488B45F0 		movq	-16(%rbp), %rax
 1318 009b 8B00     		movl	(%rax), %eax
 549:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             ++fmt;
 1319              		.loc 1 549 15
 1320 009d 85C0     		testl	%eax, %eax
 1321 009f 740B     		je	.L84
 549:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             ++fmt;
 1322              		.loc 1 549 49 discriminator 1
 1323 00a1 488B45F0 		movq	-16(%rbp), %rax
 1324 00a5 8B00     		movl	(%rax), %eax
 549:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             ++fmt;
 1325              		.loc 1 549 45 discriminator 1
 1326 00a7 83F85D   		cmpl	$93, %eax
 1327 00aa 75E6     		jne	.L85
 1328              	.L84:
 551:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 552:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (*fmt == SECUREC_CHAR('\0')) {
 1329              		.loc 1 552 13
 1330 00ac 488B45F0 		movq	-16(%rbp), %rax
GAS LISTING /tmp/cc1ytava.s 			page 37


 1331 00b0 8B00     		movl	(%rax), %eax
 1332              		.loc 1 552 12
 1333 00b2 85C0     		testl	%eax, %eax
 1334 00b4 7507     		jne	.L79
 553:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             return -1; /* trunc'd format string */
 1335              		.loc 1 553 20
 1336 00b6 B8FFFFFF 		movl	$-1, %eax
 1336      FF
 1337 00bb EB0E     		jmp	.L78
 1338              	.L79:
 554:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 555:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 556:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     *comChr = ch;
 1339              		.loc 1 556 13
 1340 00bd 488B45D0 		movq	-48(%rbp), %rax
 1341 00c1 8B55EC   		movl	-20(%rbp), %edx
 1342 00c4 8910     		movl	%edx, (%rax)
 557:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return 0;
 1343              		.loc 1 557 12
 1344 00c6 B8000000 		movl	$0, %eax
 1344      00
 1345              	.L78:
 558:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 1346              		.loc 1 558 1
 1347 00cb 488B4DF8 		movq	-8(%rbp), %rcx
 1348 00cf 6448330C 		xorq	%fs:40, %rcx
 1348      25280000 
 1348      00
 1349 00d8 7405     		je	.L86
 1350 00da E8000000 		call	__stack_chk_fail@PLT
 1350      00
 1351              	.L86:
 1352 00df C9       		leave
 1353              	.LCFI35:
 1354              		.cfi_def_cfa 7, 8
 1355 00e0 C3       		ret
 1356              		.cfi_endproc
 1357              	.LFE17:
 1359              		.section	.text.SecAddEndingZero,"ax",@progbits
 1361              	SecAddEndingZero:
 1362              	.LFB18:
 559:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 560:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 561:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * add L'\0' for wchar string , add '\0' for char string
 562:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 563:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecAddEndingZero(void *ptr, const SecScanSpec *spec)
 564:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 1363              		.loc 1 564 1
 1364              		.cfi_startproc
 1365 0000 F30F1EFA 		endbr64
 1366 0004 55       		pushq	%rbp
 1367              	.LCFI36:
 1368              		.cfi_def_cfa_offset 16
 1369              		.cfi_offset 6, -16
 1370 0005 4889E5   		movq	%rsp, %rbp
 1371              	.LCFI37:
 1372              		.cfi_def_cfa_register 6
GAS LISTING /tmp/cc1ytava.s 			page 38


 1373 0008 4883EC20 		subq	$32, %rsp
 1374 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1375 0010 488975E0 		movq	%rsi, -32(%rbp)
 1376              		.loc 1 564 1
 1377 0014 64488B04 		movq	%fs:40, %rax
 1377      25280000 
 1377      00
 1378 001d 488945F8 		movq	%rax, -8(%rbp)
 1379 0021 31C0     		xorl	%eax, %eax
 565:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     *(char *)ptr = '\0';
 1380              		.loc 1 565 18
 1381 0023 488B45E8 		movq	-24(%rbp), %rax
 1382 0027 C60000   		movb	$0, (%rax)
 566:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     (void)spec; /* clear not use */
 567:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if SECUREC_HAVE_WCHART
 568:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (spec->isWChar > 0) {
 1383              		.loc 1 568 13
 1384 002a 488B45E0 		movq	-32(%rbp), %rax
 1385 002e 0FB64040 		movzbl	64(%rax), %eax
 1386              		.loc 1 568 8
 1387 0032 84C0     		testb	%al, %al
 1388 0034 7E0A     		jle	.L90
 569:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         *(wchar_t UNALIGNED *)ptr = L'\0';
 1389              		.loc 1 569 35
 1390 0036 488B45E8 		movq	-24(%rbp), %rax
 1391 003a C7000000 		movl	$0, (%rax)
 1391      0000
 1392              	.L90:
 570:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 571:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 572:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 1393              		.loc 1 572 1
 1394 0040 90       		nop
 1395 0041 488B45F8 		movq	-8(%rbp), %rax
 1396 0045 64483304 		xorq	%fs:40, %rax
 1396      25280000 
 1396      00
 1397 004e 7405     		je	.L89
 1398 0050 E8000000 		call	__stack_chk_fail@PLT
 1398      00
 1399              	.L89:
 1400 0055 C9       		leave
 1401              	.LCFI38:
 1402              		.cfi_def_cfa 7, 8
 1403 0056 C3       		ret
 1404              		.cfi_endproc
 1405              	.LFE18:
 1407              		.section	.text.SecClearDestBufW,"ax",@progbits
 1408              		.globl	SecClearDestBufW
 1410              	SecClearDestBufW:
 1411              	.LFB19:
 573:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 574:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_FOR_WCHAR
 575:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 576:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  *  Clean up the first %s %c buffer to zero for wchar version
 577:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 578:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** void SecClearDestBufW(const wchar_t *buffer, const wchar_t *format, va_list argList)
GAS LISTING /tmp/cc1ytava.s 			page 39


 579:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
 580:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 581:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  *  Clean up the first %s %c buffer to zero for char version
 582:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 583:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** void SecClearDestBuf(const char *buffer, const char *format, va_list argList)
 584:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 585:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 1412              		.loc 1 585 1
 1413              		.cfi_startproc
 1414 0000 F30F1EFA 		endbr64
 1415 0004 55       		pushq	%rbp
 1416              	.LCFI39:
 1417              		.cfi_def_cfa_offset 16
 1418              		.cfi_offset 6, -16
 1419 0005 4889E5   		movq	%rsp, %rbp
 1420              	.LCFI40:
 1421              		.cfi_def_cfa_register 6
 1422 0008 4881ECB0 		subq	$176, %rsp
 1422      000000
 1423 000f 4889BD68 		movq	%rdi, -152(%rbp)
 1423      FFFFFF
 1424 0016 4889B560 		movq	%rsi, -160(%rbp)
 1424      FFFFFF
 1425 001d 48899558 		movq	%rdx, -168(%rbp)
 1425      FFFFFF
 1426              		.loc 1 585 1
 1427 0024 64488B04 		movq	%fs:40, %rax
 1427      25280000 
 1427      00
 1428 002d 488945F8 		movq	%rax, -8(%rbp)
 1429 0031 31C0     		xorl	%eax, %eax
 586:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 587:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     va_list argListSave;        /* backup for argList value, this variable don't need initialized *
 588:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecScanSpec spec;
 589:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     int comChr = 0;
 1430              		.loc 1 589 9
 1431 0033 C78574FF 		movl	$0, -140(%rbp)
 1431      FFFF0000 
 1431      0000
 590:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     const SecUnsignedChar *fmt = (const SecUnsignedChar *)format;
 1432              		.loc 1 590 28
 1433 003d 488B8560 		movq	-160(%rbp), %rax
 1433      FFFFFF
 1434 0044 48898578 		movq	%rax, -136(%rbp)
 1434      FFFFFF
 591:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (fmt == NULL) {
 1435              		.loc 1 591 13
 1436 004b 488B8578 		movq	-136(%rbp), %rax
 1436      FFFFFF
 1437              		.loc 1 591 8
 1438 0052 4885C0   		testq	%rax, %rax
 1439 0055 0F849501 		je	.L110
 1439      0000
 592:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return;
 593:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 594:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 595:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     /* find first % */
GAS LISTING /tmp/cc1ytava.s 			page 40


 596:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     while (*fmt != SECUREC_CHAR('\0') && *fmt != SECUREC_CHAR('%')) {
 1440              		.loc 1 596 11
 1441 005b EB12     		jmp	.L94
 1442              	.L96:
 597:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ++fmt;
 1443              		.loc 1 597 9
 1444 005d 488B8578 		movq	-136(%rbp), %rax
 1444      FFFFFF
 1445 0064 4883C004 		addq	$4, %rax
 1446 0068 48898578 		movq	%rax, -136(%rbp)
 1446      FFFFFF
 1447              	.L94:
 596:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ++fmt;
 1448              		.loc 1 596 12
 1449 006f 488B8578 		movq	-136(%rbp), %rax
 1449      FFFFFF
 1450 0076 8B00     		movl	(%rax), %eax
 596:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ++fmt;
 1451              		.loc 1 596 11
 1452 0078 85C0     		testl	%eax, %eax
 1453 007a 740E     		je	.L95
 596:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ++fmt;
 1454              		.loc 1 596 42 discriminator 1
 1455 007c 488B8578 		movq	-136(%rbp), %rax
 1455      FFFFFF
 1456 0083 8B00     		movl	(%rax), %eax
 596:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ++fmt;
 1457              		.loc 1 596 39 discriminator 1
 1458 0085 83F825   		cmpl	$37, %eax
 1459 0088 75D3     		jne	.L96
 1460              	.L95:
 598:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 599:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (*fmt == SECUREC_CHAR('\0')) {
 1461              		.loc 1 599 9
 1462 008a 488B8578 		movq	-136(%rbp), %rax
 1462      FFFFFF
 1463 0091 8B00     		movl	(%rax), %eax
 1464              		.loc 1 599 8
 1465 0093 85C0     		testl	%eax, %eax
 1466 0095 0F845801 		je	.L111
 1466      0000
 600:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return;
 601:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 602:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 603:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecSetDefaultScanSpec(&spec);
 1467              		.loc 1 603 5
 1468 009b 488D4590 		leaq	-112(%rbp), %rax
 1469 009f 4889C7   		movq	%rax, %rdi
 1470 00a2 E8000000 		call	SecSetDefaultScanSpec
 1470      00
 604:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (SecDecodeScanFlag(&fmt, &spec) != 0) {
 1471              		.loc 1 604 9
 1472 00a7 488D5590 		leaq	-112(%rbp), %rdx
 1473 00ab 488D8578 		leaq	-136(%rbp), %rax
 1473      FFFFFF
 1474 00b2 4889D6   		movq	%rdx, %rsi
 1475 00b5 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/cc1ytava.s 			page 41


 1476 00b8 E8000000 		call	SecDecodeScanFlag
 1476      00
 1477              		.loc 1 604 8
 1478 00bd 85C0     		testl	%eax, %eax
 1479 00bf 0F853101 		jne	.L112
 1479      0000
 605:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return;
 606:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 607:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 608:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     /* update wchar flag for %S %C */
 609:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecUpdateWcharFlagByType(*fmt, &spec);
 1480              		.loc 1 609 5
 1481 00c5 488B8578 		movq	-136(%rbp), %rax
 1481      FFFFFF
 1482 00cc 8B00     		movl	(%rax), %eax
 1483 00ce 488D5590 		leaq	-112(%rbp), %rdx
 1484 00d2 4889D6   		movq	%rdx, %rsi
 1485 00d5 89C7     		movl	%eax, %edi
 1486 00d7 E8000000 		call	SecUpdateWcharFlagByType
 1486      00
 610:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 611:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (spec.suppress != 0 || SecDecodeClearFormat(fmt, &comChr) != 0) {
 1487              		.loc 1 611 13
 1488 00dc 0FB645D1 		movzbl	-47(%rbp), %eax
 1489              		.loc 1 611 8
 1490 00e0 84C0     		testb	%al, %al
 1491 00e2 0F851101 		jne	.L113
 1491      0000
 1492              		.loc 1 611 31 discriminator 1
 1493 00e8 488B8578 		movq	-136(%rbp), %rax
 1493      FFFFFF
 1494 00ef 488D9574 		leaq	-140(%rbp), %rdx
 1494      FFFFFF
 1495 00f6 4889D6   		movq	%rdx, %rsi
 1496 00f9 4889C7   		movq	%rax, %rdi
 1497 00fc E8000000 		call	SecDecodeClearFormat
 1497      00
 1498              		.loc 1 611 28 discriminator 1
 1499 0101 85C0     		testl	%eax, %eax
 1500 0103 0F85F000 		jne	.L113
 1500      0000
 612:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return;
 613:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 614:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 615:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if ((buffer != NULL) && (*buffer != SECUREC_CHAR('\0')) && (comChr != SECUREC_CHAR('s'))) {
 1501              		.loc 1 615 8
 1502 0109 4883BD68 		cmpq	$0, -152(%rbp)
 1502      FFFFFF00 
 1503 0111 741C     		je	.L101
 1504              		.loc 1 615 30 discriminator 1
 1505 0113 488B8568 		movq	-152(%rbp), %rax
 1505      FFFFFF
 1506 011a 8B00     		movl	(%rax), %eax
 1507              		.loc 1 615 26 discriminator 1
 1508 011c 85C0     		testl	%eax, %eax
 1509 011e 740F     		je	.L101
 1510              		.loc 1 615 72 discriminator 2
GAS LISTING /tmp/cc1ytava.s 			page 42


 1511 0120 8B8574FF 		movl	-140(%rbp), %eax
 1511      FFFF
 1512              		.loc 1 615 61 discriminator 2
 1513 0126 83F873   		cmpl	$115, %eax
 1514 0129 0F85CD00 		jne	.L114
 1514      0000
 1515              	.L101:
 616:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* when buffer not empty just clear %s.
 617:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****          * example call sscanf by  argment of (" \n", "%s", s, sizeof(s))
 618:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****          */
 619:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return;
 620:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 621:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     (void)memset(&argListSave, 0, sizeof(va_list)); /* to clear e530 argListSave not initialized */
 1516              		.loc 1 621 11
 1517 012f 488D45E0 		leaq	-32(%rbp), %rax
 1518 0133 BA180000 		movl	$24, %edx
 1518      00
 1519 0138 BE000000 		movl	$0, %esi
 1519      00
 1520 013d 4889C7   		movq	%rax, %rdi
 1521 0140 E8000000 		call	memset@PLT
 1521      00
 622:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if defined(va_copy)
 623:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     va_copy(argListSave, argList);
 1522              		.loc 1 623 5
 1523 0145 488D4DE0 		leaq	-32(%rbp), %rcx
 1524 0149 488BB558 		movq	-168(%rbp), %rsi
 1524      FFFFFF
 1525 0150 488B06   		movq	(%rsi), %rax
 1526 0153 488B5608 		movq	8(%rsi), %rdx
 1527 0157 488901   		movq	%rax, (%rcx)
 1528 015a 48895108 		movq	%rdx, 8(%rcx)
 1529 015e 488B4610 		movq	16(%rsi), %rax
 1530 0162 48894110 		movq	%rax, 16(%rcx)
 1531              	.LBB6:
 624:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #elif defined(__va_copy)        /* for vxworks */
 625:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     __va_copy(argListSave, argList);
 626:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
 627:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     argListSave = argList;
 628:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 629:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     do {
 630:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         void *argPtr = (void *)va_arg(argListSave, void *);
 1532              		.loc 1 630 15
 1533 0166 8B45E0   		movl	-32(%rbp), %eax
 1534 0169 83F82F   		cmpl	$47, %eax
 1535 016c 7717     		ja	.L102
 1536 016e 488B45F0 		movq	-16(%rbp), %rax
 1537 0172 8B55E0   		movl	-32(%rbp), %edx
 1538 0175 89D2     		movl	%edx, %edx
 1539 0177 4801D0   		addq	%rdx, %rax
 1540 017a 8B55E0   		movl	-32(%rbp), %edx
 1541 017d 83C208   		addl	$8, %edx
 1542 0180 8955E0   		movl	%edx, -32(%rbp)
 1543 0183 EB0C     		jmp	.L103
 1544              	.L102:
 1545 0185 488B45E8 		movq	-24(%rbp), %rax
 1546 0189 488D5008 		leaq	8(%rax), %rdx
GAS LISTING /tmp/cc1ytava.s 			page 43


 1547 018d 488955E8 		movq	%rdx, -24(%rbp)
 1548              	.L103:
 1549 0191 488B00   		movq	(%rax), %rax
 1550 0194 48894580 		movq	%rax, -128(%rbp)
 631:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* Get the next argument - size of the array in characters */
 632:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         size_t arrayWidth = ((size_t)(va_arg(argListSave, size_t))) & 0xFFFFFFFFUL;
 1551              		.loc 1 632 39
 1552 0198 8B45E0   		movl	-32(%rbp), %eax
 1553 019b 83F82F   		cmpl	$47, %eax
 1554 019e 7717     		ja	.L104
 1555 01a0 488B45F0 		movq	-16(%rbp), %rax
 1556 01a4 8B55E0   		movl	-32(%rbp), %edx
 1557 01a7 89D2     		movl	%edx, %edx
 1558 01a9 4801D0   		addq	%rdx, %rax
 1559 01ac 8B55E0   		movl	-32(%rbp), %edx
 1560 01af 83C208   		addl	$8, %edx
 1561 01b2 8955E0   		movl	%edx, -32(%rbp)
 1562 01b5 EB0C     		jmp	.L105
 1563              	.L104:
 1564 01b7 488B45E8 		movq	-24(%rbp), %rax
 1565 01bb 488D5008 		leaq	8(%rax), %rdx
 1566 01bf 488955E8 		movq	%rdx, -24(%rbp)
 1567              	.L105:
 1568 01c3 488B00   		movq	(%rax), %rax
 1569              		.loc 1 632 16
 1570 01c6 83E0FF   		andl	$4294967295, %eax
 1571 01c9 48894588 		movq	%rax, -120(%rbp)
 633:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         va_end(argListSave);
 634:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* to clear e438 last value assigned not used , the compiler will optimize this code */
 635:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         (void)argListSave;
 636:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* There is no need to judge the upper limit */
 637:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (arrayWidth == 0 || argPtr == NULL) {
 1572              		.loc 1 637 12
 1573 01cd 48837D88 		cmpq	$0, -120(%rbp)
 1573      00
 1574 01d2 742B     		je	.L115
 1575              		.loc 1 637 29 discriminator 1
 1576 01d4 48837D80 		cmpq	$0, -128(%rbp)
 1576      00
 1577 01d9 7424     		je	.L115
 638:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             return;
 639:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 640:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 641:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* clear one char */
 642:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SecAddEndingZero(argPtr, &spec);
 1578              		.loc 1 642 9
 1579 01db 488D5590 		leaq	-112(%rbp), %rdx
 1580 01df 488B4580 		movq	-128(%rbp), %rax
 1581 01e3 4889D6   		movq	%rdx, %rsi
 1582 01e6 4889C7   		movq	%rax, %rdi
 1583 01e9 E8000000 		call	SecAddEndingZero
 1583      00
 1584              	.LBE6:
 643:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } SECUREC_WHILE_ZERO;
 644:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return;
 1585              		.loc 1 644 5
 1586 01ee EB10     		jmp	.L91
GAS LISTING /tmp/cc1ytava.s 			page 44


 1587              	.L110:
 592:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 1588              		.loc 1 592 9
 1589 01f0 90       		nop
 1590 01f1 EB0D     		jmp	.L91
 1591              	.L111:
 600:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 1592              		.loc 1 600 9
 1593 01f3 90       		nop
 1594 01f4 EB0A     		jmp	.L91
 1595              	.L112:
 605:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 1596              		.loc 1 605 9
 1597 01f6 90       		nop
 1598 01f7 EB07     		jmp	.L91
 1599              	.L113:
 612:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 1600              		.loc 1 612 9
 1601 01f9 90       		nop
 1602 01fa EB04     		jmp	.L91
 1603              	.L114:
 619:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 1604              		.loc 1 619 9
 1605 01fc 90       		nop
 1606 01fd EB01     		jmp	.L91
 1607              	.L115:
 1608              	.LBB7:
 638:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 1609              		.loc 1 638 13
 1610 01ff 90       		nop
 1611              	.L91:
 1612              	.LBE7:
 645:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 646:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 1613              		.loc 1 646 1
 1614 0200 488B45F8 		movq	-8(%rbp), %rax
 1615 0204 64483304 		xorq	%fs:40, %rax
 1615      25280000 
 1615      00
 1616 020d 7405     		je	.L109
 1617 020f E8000000 		call	__stack_chk_fail@PLT
 1617      00
 1618              	.L109:
 1619 0214 C9       		leave
 1620              	.LCFI41:
 1621              		.cfi_def_cfa 7, 8
 1622 0215 C3       		ret
 1623              		.cfi_endproc
 1624              	.LFE19:
 1626              		.section	.text.SecAssignNumber,"ax",@progbits
 1628              	SecAssignNumber:
 1629              	.LFB20:
 647:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 648:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 649:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  *  Assign number  to output buffer
 650:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 651:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecAssignNumber(const SecScanSpec *spec)
GAS LISTING /tmp/cc1ytava.s 			page 45


 652:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 1630              		.loc 1 652 1
 1631              		.cfi_startproc
 1632 0000 F30F1EFA 		endbr64
 1633 0004 55       		pushq	%rbp
 1634              	.LCFI42:
 1635              		.cfi_def_cfa_offset 16
 1636              		.cfi_offset 6, -16
 1637 0005 4889E5   		movq	%rsp, %rbp
 1638              	.LCFI43:
 1639              		.cfi_def_cfa_register 6
 1640 0008 4883EC20 		subq	$32, %rsp
 1641 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1642              		.loc 1 652 1
 1643 0010 64488B04 		movq	%fs:40, %rax
 1643      25280000 
 1643      00
 1644 0019 488945F8 		movq	%rax, -8(%rbp)
 1645 001d 31C0     		xorl	%eax, %eax
 653:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     void *argPtr = spec->argPtr;
 1646              		.loc 1 653 11
 1647 001f 488B45E8 		movq	-24(%rbp), %rax
 1648 0023 488B4020 		movq	32(%rax), %rax
 1649 0027 488945F0 		movq	%rax, -16(%rbp)
 654:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (spec->isInt64Arg != 0) {
 1650              		.loc 1 654 13
 1651 002b 488B45E8 		movq	-24(%rbp), %rax
 1652 002f 8B4014   		movl	20(%rax), %eax
 1653              		.loc 1 654 8
 1654 0032 85C0     		testl	%eax, %eax
 1655 0034 7413     		je	.L117
 655:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if defined(SECUREC_VXWORKS_PLATFORM)
 656:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if defined(SECUREC_VXWORKS_PLATFORM_COMP)
 657:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         *(SecInt64 UNALIGNED *)argPtr = (SecInt64)(spec->number64);
 658:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
 659:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****          /* take number64 as unsigned number unsigned to int clear Compile warning */
 660:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         *(SecInt64 UNALIGNED *)argPtr = *(SecUnsignedInt64 *)(&(spec->number64));
 661:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 662:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
 663:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* take number64 as unsigned number */
 664:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         *(SecInt64 UNALIGNED *)argPtr = (SecInt64)(spec->number64);
 1656              		.loc 1 664 56
 1657 0036 488B45E8 		movq	-24(%rbp), %rax
 1658 003a 488B00   		movq	(%rax), %rax
 1659              		.loc 1 664 41
 1660 003d 4889C2   		movq	%rax, %rdx
 1661              		.loc 1 664 39
 1662 0040 488B45F0 		movq	-16(%rbp), %rax
 1663 0044 488910   		movq	%rdx, (%rax)
 665:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 666:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return;
 1664              		.loc 1 666 9
 1665 0047 EB6C     		jmp	.L116
 1666              	.L117:
 667:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 668:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (spec->numberWidth > SECUREC_NUM_WIDTH_INT) {
 1667              		.loc 1 668 13
GAS LISTING /tmp/cc1ytava.s 			page 46


 1668 0049 488B45E8 		movq	-24(%rbp), %rax
 1669 004d 8B4010   		movl	16(%rax), %eax
 1670              		.loc 1 668 8
 1671 0050 83F801   		cmpl	$1, %eax
 1672 0053 7E14     		jle	.L119
 669:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* take number as unsigned number */
 670:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         *(long UNALIGNED *)argPtr = (long)(spec->number);
 1673              		.loc 1 670 48
 1674 0055 488B45E8 		movq	-24(%rbp), %rax
 1675 0059 488B4008 		movq	8(%rax), %rax
 1676              		.loc 1 670 37
 1677 005d 4889C2   		movq	%rax, %rdx
 1678              		.loc 1 670 35
 1679 0060 488B45F0 		movq	-16(%rbp), %rax
 1680 0064 488910   		movq	%rdx, (%rax)
 1681 0067 EB4C     		jmp	.L116
 1682              	.L119:
 671:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else if (spec->numberWidth == SECUREC_NUM_WIDTH_INT) {
 1683              		.loc 1 671 20
 1684 0069 488B45E8 		movq	-24(%rbp), %rax
 1685 006d 8B4010   		movl	16(%rax), %eax
 1686              		.loc 1 671 15
 1687 0070 83F801   		cmpl	$1, %eax
 1688 0073 7512     		jne	.L120
 672:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         *(int UNALIGNED *)argPtr = (int)(spec->number);
 1689              		.loc 1 672 46
 1690 0075 488B45E8 		movq	-24(%rbp), %rax
 1691 0079 488B4008 		movq	8(%rax), %rax
 1692              		.loc 1 672 36
 1693 007d 89C2     		movl	%eax, %edx
 1694              		.loc 1 672 34
 1695 007f 488B45F0 		movq	-16(%rbp), %rax
 1696 0083 8910     		movl	%edx, (%rax)
 1697 0085 EB2E     		jmp	.L116
 1698              	.L120:
 673:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else if (spec->numberWidth == SECUREC_NUM_WIDTH_SHORT) {
 1699              		.loc 1 673 20
 1700 0087 488B45E8 		movq	-24(%rbp), %rax
 1701 008b 8B4010   		movl	16(%rax), %eax
 1702              		.loc 1 673 15
 1703 008e 85C0     		testl	%eax, %eax
 1704 0090 7513     		jne	.L121
 674:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* take number as unsigned number */
 675:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         *(short UNALIGNED *)argPtr = (short)(spec->number);
 1705              		.loc 1 675 50
 1706 0092 488B45E8 		movq	-24(%rbp), %rax
 1707 0096 488B4008 		movq	8(%rax), %rax
 1708              		.loc 1 675 38
 1709 009a 89C2     		movl	%eax, %edx
 1710              		.loc 1 675 36
 1711 009c 488B45F0 		movq	-16(%rbp), %rax
 1712 00a0 668910   		movw	%dx, (%rax)
 1713 00a3 EB10     		jmp	.L116
 1714              	.L121:
 676:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else {  /* < 0 for hh format modifier */
 677:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* take number as unsigned number */
 678:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         *(char UNALIGNED *)argPtr = (char)(spec->number);
GAS LISTING /tmp/cc1ytava.s 			page 47


 1715              		.loc 1 678 48
 1716 00a5 488B45E8 		movq	-24(%rbp), %rax
 1717 00a9 488B4008 		movq	8(%rax), %rax
 1718              		.loc 1 678 37
 1719 00ad 89C2     		movl	%eax, %edx
 1720              		.loc 1 678 35
 1721 00af 488B45F0 		movq	-16(%rbp), %rax
 1722 00b3 8810     		movb	%dl, (%rax)
 1723              	.L116:
 679:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 680:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 1724              		.loc 1 680 1
 1725 00b5 488B45F8 		movq	-8(%rbp), %rax
 1726 00b9 64483304 		xorq	%fs:40, %rax
 1726      25280000 
 1726      00
 1727 00c2 7405     		je	.L122
 1728 00c4 E8000000 		call	__stack_chk_fail@PLT
 1728      00
 1729              	.L122:
 1730 00c9 C9       		leave
 1731              	.LCFI44:
 1732              		.cfi_def_cfa 7, 8
 1733 00ca C3       		ret
 1734              		.cfi_endproc
 1735              	.LFE20:
 1737              		.section	.text.SecIsLongBitEqual,"ax",@progbits
 1739              	SecIsLongBitEqual:
 1740              	.LFB21:
 681:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 682:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if (defined(SECUREC_COMPATIBLE_LINUX_FORMAT) && !(defined(SECUREC_ON_UNIX)))
 683:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 684:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  *  Judge the long bit width
 685:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 686:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static int SecIsLongBitEqual(int bitNum)
 687:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 1741              		.loc 1 687 1
 1742              		.cfi_startproc
 1743 0000 F30F1EFA 		endbr64
 1744 0004 55       		pushq	%rbp
 1745              	.LCFI45:
 1746              		.cfi_def_cfa_offset 16
 1747              		.cfi_offset 6, -16
 1748 0005 4889E5   		movq	%rsp, %rbp
 1749              	.LCFI46:
 1750              		.cfi_def_cfa_register 6
 1751 0008 4883EC20 		subq	$32, %rsp
 1752 000c 897DEC   		movl	%edi, -20(%rbp)
 1753              		.loc 1 687 1
 1754 000f 64488B04 		movq	%fs:40, %rax
 1754      25280000 
 1754      00
 1755 0018 488945F8 		movq	%rax, -8(%rbp)
 1756 001c 31C0     		xorl	%eax, %eax
 688:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return (unsigned int)bitNum == SECUREC_LONG_BIT_NUM;
 1757              		.loc 1 688 33
 1758 001e 837DEC40 		cmpl	$64, -20(%rbp)
GAS LISTING /tmp/cc1ytava.s 			page 48


 1759 0022 0F94C0   		sete	%al
 1760 0025 0FB6C0   		movzbl	%al, %eax
 689:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 1761              		.loc 1 689 1
 1762 0028 488B55F8 		movq	-8(%rbp), %rdx
 1763 002c 64483314 		xorq	%fs:40, %rdx
 1763      25280000 
 1763      00
 1764 0035 7405     		je	.L125
 1765 0037 E8000000 		call	__stack_chk_fail@PLT
 1765      00
 1766              	.L125:
 1767 003c C9       		leave
 1768              	.LCFI47:
 1769              		.cfi_def_cfa 7, 8
 1770 003d C3       		ret
 1771              		.cfi_endproc
 1772              	.LFE21:
 1774              		.section	.text.SecHexValueOfChar,"ax",@progbits
 1776              	SecHexValueOfChar:
 1777              	.LFB22:
 690:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 691:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 692:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * Convert hexadecimal characters to decimal value
 693:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 694:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static int SecHexValueOfChar(SecInt ch)
 695:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 1778              		.loc 1 695 1
 1779              		.cfi_startproc
 1780 0000 F30F1EFA 		endbr64
 1781 0004 55       		pushq	%rbp
 1782              	.LCFI48:
 1783              		.cfi_def_cfa_offset 16
 1784              		.cfi_offset 6, -16
 1785 0005 4889E5   		movq	%rsp, %rbp
 1786              	.LCFI49:
 1787              		.cfi_def_cfa_register 6
 1788 0008 4883EC20 		subq	$32, %rsp
 1789 000c 897DEC   		movl	%edi, -20(%rbp)
 1790              		.loc 1 695 1
 1791 000f 64488B04 		movq	%fs:40, %rax
 1791      25280000 
 1791      00
 1792 0018 488945F8 		movq	%rax, -8(%rbp)
 1793 001c 31C0     		xorl	%eax, %eax
 696:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     /* use isdigt Causing tool false alarms */
 697:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return (int)((ch >= '0' && ch <= '9') ? ((unsigned char)ch - '0') :
 1794              		.loc 1 697 12
 1795 001e 837DEC2F 		cmpl	$47, -20(%rbp)
 1796 0022 7611     		jbe	.L127
 1797              		.loc 1 697 29 discriminator 1
 1798 0024 837DEC39 		cmpl	$57, -20(%rbp)
 1799 0028 770B     		ja	.L127
 1800              		.loc 1 697 46 discriminator 3
 1801 002a 8B45EC   		movl	-20(%rbp), %eax
 1802 002d 0FB6C0   		movzbl	%al, %eax
 1803              		.loc 1 697 12 discriminator 3
GAS LISTING /tmp/cc1ytava.s 			page 49


 1804 0030 83E830   		subl	$48, %eax
 1805 0033 EB0C     		jmp	.L129
 1806              	.L127:
 698:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             ((((unsigned char)ch | (unsigned char)('a' - 'A')) - ('a')) + 10)); /* Adding 10 is to 
 1807              		.loc 1 698 16 discriminator 4
 1808 0035 8B45EC   		movl	-20(%rbp), %eax
 1809              		.loc 1 698 34 discriminator 4
 1810 0038 83C820   		orl	$32, %eax
 1811 003b 0FB6C0   		movzbl	%al, %eax
 697:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             ((((unsigned char)ch | (unsigned char)('a' - 'A')) - ('a')) + 10)); /* Adding 10 is to 
 1812              		.loc 1 697 12 discriminator 4
 1813 003e 83E857   		subl	$87, %eax
 1814              	.L129:
 699:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 1815              		.loc 1 699 1 discriminator 7
 1816 0041 488B55F8 		movq	-8(%rbp), %rdx
 1817 0045 64483314 		xorq	%fs:40, %rdx
 1817      25280000 
 1817      00
 1818 004e 7405     		je	.L130
 1819              		.loc 1 699 1 is_stmt 0
 1820 0050 E8000000 		call	__stack_chk_fail@PLT
 1820      00
 1821              	.L130:
 1822 0055 C9       		leave
 1823              	.LCFI50:
 1824              		.cfi_def_cfa 7, 8
 1825 0056 C3       		ret
 1826              		.cfi_endproc
 1827              	.LFE22:
 1829              		.section	.text.SecDecodeNumberDecimal,"ax",@progbits
 1831              	SecDecodeNumberDecimal:
 1832              	.LFB23:
 700:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 701:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 702:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 703:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 704:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * Parse decimal character to integer for 32bit .
 705:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 706:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecDecodeNumberDecimal(SecInt ch, SecScanSpec *spec)
 707:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 1833              		.loc 1 707 1 is_stmt 1
 1834              		.cfi_startproc
 1835 0000 F30F1EFA 		endbr64
 1836 0004 55       		pushq	%rbp
 1837              	.LCFI51:
 1838              		.cfi_def_cfa_offset 16
 1839              		.cfi_offset 6, -16
 1840 0005 4889E5   		movq	%rsp, %rbp
 1841              	.LCFI52:
 1842              		.cfi_def_cfa_register 6
 1843 0008 4883EC30 		subq	$48, %rsp
 1844 000c 897DDC   		movl	%edi, -36(%rbp)
 1845 000f 488975D0 		movq	%rsi, -48(%rbp)
 1846              		.loc 1 707 1
 1847 0013 64488B04 		movq	%fs:40, %rax
 1847      25280000 
GAS LISTING /tmp/cc1ytava.s 			page 50


 1847      00
 1848 001c 488945F8 		movq	%rax, -8(%rbp)
 1849 0020 31C0     		xorl	%eax, %eax
 708:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if (defined(SECUREC_COMPATIBLE_LINUX_FORMAT) && !(defined(SECUREC_ON_UNIX)))
 709:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     unsigned long decimalEdge = SECUREC_MAX_32BITS_VALUE_DIV_TEN;
 1850              		.loc 1 709 19
 1851 0022 48C745E8 		movq	$429496729, -24(%rbp)
 1851      99999919 
 710:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_ON_64BITS
 711:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (SecIsLongBitEqual(SECUREC_LP64_BIT_WIDTH)) {
 1852              		.loc 1 711 9
 1853 002a BF400000 		movl	$64, %edi
 1853      00
 1854 002f E8000000 		call	SecIsLongBitEqual
 1854      00
 1855              		.loc 1 711 8
 1856 0034 85C0     		testl	%eax, %eax
 1857 0036 740E     		je	.L132
 712:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         decimalEdge = (unsigned long)SECUREC_MAX_64BITS_VALUE_DIV_TEN;
 1858              		.loc 1 712 21
 1859 0038 48B89999 		movabsq	$1844674407370955161, %rax
 1859      99999999 
 1859      9919
 1860 0042 488945E8 		movq	%rax, -24(%rbp)
 1861              	.L132:
 713:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 714:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
 715:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (SecIsLongBitEqual(SECUREC_LP32_BIT_WIDTH)) {
 716:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         decimalEdge = SECUREC_MAX_32BITS_VALUE_DIV_TEN;
 717:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 718:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 719:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (spec->number > decimalEdge) {
 1862              		.loc 1 719 13
 1863 0046 488B45D0 		movq	-48(%rbp), %rax
 1864 004a 488B4008 		movq	8(%rax), %rax
 1865              		.loc 1 719 8
 1866 004e 483945E8 		cmpq	%rax, -24(%rbp)
 1867 0052 730B     		jnb	.L133
 720:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->beyondMax = 1;
 1868              		.loc 1 720 25
 1869 0054 488B45D0 		movq	-48(%rbp), %rax
 1870 0058 C7401C01 		movl	$1, 28(%rax)
 1870      000000
 1871              	.L133:
 721:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 722:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 723:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->number = SECUREC_MUL_TEN(spec->number);
 1872              		.loc 1 723 20
 1873 005f 488B45D0 		movq	-48(%rbp), %rax
 1874 0063 488B4008 		movq	8(%rax), %rax
 1875 0067 488D1485 		leaq	0(,%rax,4), %rdx
 1875      00000000 
 1876 006f 488B45D0 		movq	-48(%rbp), %rax
 1877 0073 488B4008 		movq	8(%rax), %rax
 1878 0077 4801D0   		addq	%rdx, %rax
 1879 007a 488D1400 		leaq	(%rax,%rax), %rdx
 1880              		.loc 1 723 18
GAS LISTING /tmp/cc1ytava.s 			page 51


 1881 007e 488B45D0 		movq	-48(%rbp), %rax
 1882 0082 48895008 		movq	%rdx, 8(%rax)
 724:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if (defined(SECUREC_COMPATIBLE_LINUX_FORMAT) && !(defined(SECUREC_ON_UNIX)))
 725:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (spec->number == SECUREC_MUL_TEN(decimalEdge)) {
 1883              		.loc 1 725 13
 1884 0086 488B45D0 		movq	-48(%rbp), %rax
 1885 008a 488B4008 		movq	8(%rax), %rax
 1886              		.loc 1 725 25
 1887 008e 488B55E8 		movq	-24(%rbp), %rdx
 1888 0092 488D0C95 		leaq	0(,%rdx,4), %rcx
 1888      00000000 
 1889 009a 488B55E8 		movq	-24(%rbp), %rdx
 1890 009e 4801CA   		addq	%rcx, %rdx
 1891 00a1 4801D2   		addq	%rdx, %rdx
 1892              		.loc 1 725 8
 1893 00a4 4839D0   		cmpq	%rdx, %rax
 1894 00a7 7528     		jne	.L134
 1895              	.LBB8:
 726:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SecUnsignedInt64 number64As = (unsigned long)SECUREC_MAX_64BITS_VALUE - spec->number;
 1896              		.loc 1 726 85
 1897 00a9 488B45D0 		movq	-48(%rbp), %rax
 1898 00ad 488B4008 		movq	8(%rax), %rax
 1899              		.loc 1 726 26
 1900 00b1 48F7D0   		notq	%rax
 1901 00b4 488945F0 		movq	%rax, -16(%rbp)
 727:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (number64As < (SecUnsignedInt64)((SecUnsignedInt)ch - SECUREC_CHAR('0'))) {
 1902              		.loc 1 727 64
 1903 00b8 8B45DC   		movl	-36(%rbp), %eax
 1904 00bb 83E830   		subl	$48, %eax
 1905              		.loc 1 727 26
 1906 00be 89C0     		movl	%eax, %eax
 1907              		.loc 1 727 12
 1908 00c0 483945F0 		cmpq	%rax, -16(%rbp)
 1909 00c4 730B     		jnb	.L134
 728:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->beyondMax = 1;
 1910              		.loc 1 728 29
 1911 00c6 488B45D0 		movq	-48(%rbp), %rax
 1912 00ca C7401C01 		movl	$1, 28(%rax)
 1912      000000
 1913              	.L134:
 1914              	.LBE8:
 729:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 730:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 731:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 732:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->number += (unsigned long)((SecUnsignedInt)ch - SECUREC_CHAR('0'));
 1915              		.loc 1 732 18
 1916 00d1 488B45D0 		movq	-48(%rbp), %rax
 1917 00d5 488B4008 		movq	8(%rax), %rax
 1918              		.loc 1 732 56
 1919 00d9 8B55DC   		movl	-36(%rbp), %edx
 1920 00dc 83EA30   		subl	$48, %edx
 1921              		.loc 1 732 21
 1922 00df 89D2     		movl	%edx, %edx
 1923              		.loc 1 732 18
 1924 00e1 4801C2   		addq	%rax, %rdx
 1925 00e4 488B45D0 		movq	-48(%rbp), %rax
 1926 00e8 48895008 		movq	%rdx, 8(%rax)
GAS LISTING /tmp/cc1ytava.s 			page 52


 733:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 734:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 1927              		.loc 1 734 1
 1928 00ec 90       		nop
 1929 00ed 488B45F8 		movq	-8(%rbp), %rax
 1930 00f1 64483304 		xorq	%fs:40, %rax
 1930      25280000 
 1930      00
 1931 00fa 7405     		je	.L135
 1932 00fc E8000000 		call	__stack_chk_fail@PLT
 1932      00
 1933              	.L135:
 1934 0101 C9       		leave
 1935              	.LCFI53:
 1936              		.cfi_def_cfa 7, 8
 1937 0102 C3       		ret
 1938              		.cfi_endproc
 1939              	.LFE23:
 1941              		.section	.text.SecDecodeNumberHex,"ax",@progbits
 1943              	SecDecodeNumberHex:
 1944              	.LFB24:
 735:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 736:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 737:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 738:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * Parse Hex character to integer for 32bit .
 739:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 740:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecDecodeNumberHex(SecInt ch, SecScanSpec *spec)
 741:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 1945              		.loc 1 741 1
 1946              		.cfi_startproc
 1947 0000 F30F1EFA 		endbr64
 1948 0004 55       		pushq	%rbp
 1949              	.LCFI54:
 1950              		.cfi_def_cfa_offset 16
 1951              		.cfi_offset 6, -16
 1952 0005 4889E5   		movq	%rsp, %rbp
 1953              	.LCFI55:
 1954              		.cfi_def_cfa_register 6
 1955 0008 4883EC20 		subq	$32, %rsp
 1956 000c 897DEC   		movl	%edi, -20(%rbp)
 1957 000f 488975E0 		movq	%rsi, -32(%rbp)
 1958              		.loc 1 741 1
 1959 0013 64488B04 		movq	%fs:40, %rax
 1959      25280000 
 1959      00
 1960 001c 488945F8 		movq	%rax, -8(%rbp)
 1961 0020 31C0     		xorl	%eax, %eax
 742:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if (defined(SECUREC_COMPATIBLE_LINUX_FORMAT) && !(defined(SECUREC_ON_UNIX)))
 743:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (SECUREC_LONG_HEX_BEYOND_MAX(spec->number)) {
 1962              		.loc 1 743 9
 1963 0022 488B45E0 		movq	-32(%rbp), %rax
 1964 0026 488B4008 		movq	8(%rax), %rax
 1965 002a 48C1E83C 		shrq	$60, %rax
 1966              		.loc 1 743 8
 1967 002e 4885C0   		testq	%rax, %rax
 1968 0031 740B     		je	.L137
 744:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->beyondMax = 1;
GAS LISTING /tmp/cc1ytava.s 			page 53


 1969              		.loc 1 744 25
 1970 0033 488B45E0 		movq	-32(%rbp), %rax
 1971 0037 C7401C01 		movl	$1, 28(%rax)
 1971      000000
 1972              	.L137:
 745:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 746:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 747:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->number = SECUREC_MUL_SIXTEEN(spec->number);
 1973              		.loc 1 747 20
 1974 003e 488B45E0 		movq	-32(%rbp), %rax
 1975 0042 488B4008 		movq	8(%rax), %rax
 1976 0046 48C1E004 		salq	$4, %rax
 1977 004a 4889C2   		movq	%rax, %rdx
 1978              		.loc 1 747 18
 1979 004d 488B45E0 		movq	-32(%rbp), %rax
 1980 0051 48895008 		movq	%rdx, 8(%rax)
 748:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->number += (unsigned long)(unsigned int)SecHexValueOfChar(ch);
 1981              		.loc 1 748 50
 1982 0055 8B45EC   		movl	-20(%rbp), %eax
 1983 0058 89C7     		movl	%eax, %edi
 1984 005a E8000000 		call	SecHexValueOfChar
 1984      00
 1985              		.loc 1 748 21
 1986 005f 89C2     		movl	%eax, %edx
 1987              		.loc 1 748 18
 1988 0061 488B45E0 		movq	-32(%rbp), %rax
 1989 0065 488B4008 		movq	8(%rax), %rax
 1990 0069 4801C2   		addq	%rax, %rdx
 1991 006c 488B45E0 		movq	-32(%rbp), %rax
 1992 0070 48895008 		movq	%rdx, 8(%rax)
 749:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 1993              		.loc 1 749 1
 1994 0074 90       		nop
 1995 0075 488B45F8 		movq	-8(%rbp), %rax
 1996 0079 64483304 		xorq	%fs:40, %rax
 1996      25280000 
 1996      00
 1997 0082 7405     		je	.L138
 1998 0084 E8000000 		call	__stack_chk_fail@PLT
 1998      00
 1999              	.L138:
 2000 0089 C9       		leave
 2001              	.LCFI56:
 2002              		.cfi_def_cfa 7, 8
 2003 008a C3       		ret
 2004              		.cfi_endproc
 2005              	.LFE24:
 2007              		.section	.text.SecDecodeNumberOctal,"ax",@progbits
 2009              	SecDecodeNumberOctal:
 2010              	.LFB25:
 750:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 751:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 752:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 753:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * Parse Octal character to integer for 32bit .
 754:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 755:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecDecodeNumberOctal(SecInt ch, SecScanSpec *spec)
 756:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
GAS LISTING /tmp/cc1ytava.s 			page 54


 2011              		.loc 1 756 1
 2012              		.cfi_startproc
 2013 0000 F30F1EFA 		endbr64
 2014 0004 55       		pushq	%rbp
 2015              	.LCFI57:
 2016              		.cfi_def_cfa_offset 16
 2017              		.cfi_offset 6, -16
 2018 0005 4889E5   		movq	%rsp, %rbp
 2019              	.LCFI58:
 2020              		.cfi_def_cfa_register 6
 2021 0008 4883EC20 		subq	$32, %rsp
 2022 000c 897DEC   		movl	%edi, -20(%rbp)
 2023 000f 488975E0 		movq	%rsi, -32(%rbp)
 2024              		.loc 1 756 1
 2025 0013 64488B04 		movq	%fs:40, %rax
 2025      25280000 
 2025      00
 2026 001c 488945F8 		movq	%rax, -8(%rbp)
 2027 0020 31C0     		xorl	%eax, %eax
 757:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if (defined(SECUREC_COMPATIBLE_LINUX_FORMAT) && !(defined(SECUREC_ON_UNIX)))
 758:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (SECUREC_LONG_OCTAL_BEYOND_MAX(spec->number)) {
 2028              		.loc 1 758 9
 2029 0022 488B45E0 		movq	-32(%rbp), %rax
 2030 0026 488B4008 		movq	8(%rax), %rax
 2031 002a 48C1E83D 		shrq	$61, %rax
 2032              		.loc 1 758 8
 2033 002e 4885C0   		testq	%rax, %rax
 2034 0031 740B     		je	.L140
 759:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->beyondMax = 1;
 2035              		.loc 1 759 25
 2036 0033 488B45E0 		movq	-32(%rbp), %rax
 2037 0037 C7401C01 		movl	$1, 28(%rax)
 2037      000000
 2038              	.L140:
 760:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 761:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 762:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->number = SECUREC_MUL_EIGHT(spec->number);
 2039              		.loc 1 762 20
 2040 003e 488B45E0 		movq	-32(%rbp), %rax
 2041 0042 488B4008 		movq	8(%rax), %rax
 2042 0046 488D14C5 		leaq	0(,%rax,8), %rdx
 2042      00000000 
 2043              		.loc 1 762 18
 2044 004e 488B45E0 		movq	-32(%rbp), %rax
 2045 0052 48895008 		movq	%rdx, 8(%rax)
 763:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->number += (unsigned long)((SecUnsignedInt)ch - SECUREC_CHAR('0'));
 2046              		.loc 1 763 18
 2047 0056 488B45E0 		movq	-32(%rbp), %rax
 2048 005a 488B4008 		movq	8(%rax), %rax
 2049              		.loc 1 763 56
 2050 005e 8B55EC   		movl	-20(%rbp), %edx
 2051 0061 83EA30   		subl	$48, %edx
 2052              		.loc 1 763 21
 2053 0064 89D2     		movl	%edx, %edx
 2054              		.loc 1 763 18
 2055 0066 4801C2   		addq	%rax, %rdx
 2056 0069 488B45E0 		movq	-32(%rbp), %rax
GAS LISTING /tmp/cc1ytava.s 			page 55


 2057 006d 48895008 		movq	%rdx, 8(%rax)
 764:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 2058              		.loc 1 764 1
 2059 0071 90       		nop
 2060 0072 488B45F8 		movq	-8(%rbp), %rax
 2061 0076 64483304 		xorq	%fs:40, %rax
 2061      25280000 
 2061      00
 2062 007f 7405     		je	.L141
 2063 0081 E8000000 		call	__stack_chk_fail@PLT
 2063      00
 2064              	.L141:
 2065 0086 C9       		leave
 2066              	.LCFI59:
 2067              		.cfi_def_cfa 7, 8
 2068 0087 C3       		ret
 2069              		.cfi_endproc
 2070              	.LFE25:
 2072              		.section	.text.SecFinishNumberNegativeOther,"ax",@progbits
 2074              	SecFinishNumberNegativeOther:
 2075              	.LFB26:
 765:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 766:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 767:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if (defined(SECUREC_COMPATIBLE_LINUX_FORMAT) && !(defined(SECUREC_ON_UNIX)))
 768:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /* Compatible with integer negative values other than int */
 769:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecFinishNumberNegativeOther(int comChr, int numberWidth, SecScanSpec *spec)
 770:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 2076              		.loc 1 770 1
 2077              		.cfi_startproc
 2078 0000 F30F1EFA 		endbr64
 2079 0004 55       		pushq	%rbp
 2080              	.LCFI60:
 2081              		.cfi_def_cfa_offset 16
 2082              		.cfi_offset 6, -16
 2083 0005 4889E5   		movq	%rsp, %rbp
 2084              	.LCFI61:
 2085              		.cfi_def_cfa_register 6
 2086 0008 4883EC20 		subq	$32, %rsp
 2087 000c 897DEC   		movl	%edi, -20(%rbp)
 2088 000f 8975E8   		movl	%esi, -24(%rbp)
 2089 0012 488955E0 		movq	%rdx, -32(%rbp)
 2090              		.loc 1 770 1
 2091 0016 64488B04 		movq	%fs:40, %rax
 2091      25280000 
 2091      00
 2092 001f 488945F8 		movq	%rax, -8(%rbp)
 2093 0023 31C0     		xorl	%eax, %eax
 771:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if ((comChr == SECUREC_CHAR('d')) || (comChr == SECUREC_CHAR('i'))) {
 2094              		.loc 1 771 8
 2095 0025 837DEC64 		cmpl	$100, -20(%rbp)
 2096 0029 7406     		je	.L143
 2097              		.loc 1 771 39 discriminator 1
 2098 002b 837DEC69 		cmpl	$105, -20(%rbp)
 2099 002f 757A     		jne	.L144
 2100              	.L143:
 772:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec->number > (unsigned long)(1ULL << (SECUREC_LONG_BIT_NUM - 1))) {
 2101              		.loc 1 772 17
GAS LISTING /tmp/cc1ytava.s 			page 56


 2102 0031 488B45E0 		movq	-32(%rbp), %rax
 2103 0035 488B4008 		movq	8(%rax), %rax
 2104              		.loc 1 772 12
 2105 0039 48BA0000 		movabsq	$-9223372036854775808, %rdx
 2105      00000000 
 2105      0080
 2106 0043 4839D0   		cmpq	%rdx, %rax
 2107 0046 7614     		jbe	.L145
 773:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->number = (unsigned long)(1ULL << (SECUREC_LONG_BIT_NUM - 1));
 2108              		.loc 1 773 26
 2109 0048 488B45E0 		movq	-32(%rbp), %rax
 2110 004c 48B90000 		movabsq	$-9223372036854775808, %rcx
 2110      00000000 
 2110      0080
 2111 0056 48894808 		movq	%rcx, 8(%rax)
 2112 005a EB16     		jmp	.L146
 2113              	.L145:
 774:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         } else {
 775:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->number = (unsigned long)(-(long)spec->number);
 2114              		.loc 1 775 55
 2115 005c 488B45E0 		movq	-32(%rbp), %rax
 2116 0060 488B4008 		movq	8(%rax), %rax
 2117              		.loc 1 775 44
 2118 0064 48F7D8   		negq	%rax
 2119              		.loc 1 775 28
 2120 0067 4889C2   		movq	%rax, %rdx
 2121              		.loc 1 775 26
 2122 006a 488B45E0 		movq	-32(%rbp), %rax
 2123 006e 48895008 		movq	%rdx, 8(%rax)
 2124              	.L146:
 776:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 777:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec->beyondMax != 0) {
 2125              		.loc 1 777 17
 2126 0072 488B45E0 		movq	-32(%rbp), %rax
 2127 0076 8B401C   		movl	28(%rax), %eax
 2128              		.loc 1 777 12
 2129 0079 85C0     		testl	%eax, %eax
 2130 007b 745D     		je	.L151
 778:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (numberWidth < SECUREC_NUM_WIDTH_INT) {
 2131              		.loc 1 778 16
 2132 007d 837DE800 		cmpl	$0, -24(%rbp)
 2133 0081 7F0E     		jg	.L148
 779:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number = 0;
 2134              		.loc 1 779 30
 2135 0083 488B45E0 		movq	-32(%rbp), %rax
 2136 0087 48C74008 		movq	$0, 8(%rax)
 2136      00000000 
 777:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (numberWidth < SECUREC_NUM_WIDTH_INT) {
 2137              		.loc 1 777 12
 2138 008f EB49     		jmp	.L151
 2139              	.L148:
 780:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             } else if (numberWidth == SECUREC_NUM_WIDTH_LONG) {
 2140              		.loc 1 780 23
 2141 0091 837DE802 		cmpl	$2, -24(%rbp)
 2142 0095 7543     		jne	.L151
 781:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number = ((unsigned long)(1UL << (SECUREC_LONG_BIT_NUM - 1)));
 2143              		.loc 1 781 30
GAS LISTING /tmp/cc1ytava.s 			page 57


 2144 0097 488B45E0 		movq	-32(%rbp), %rax
 2145 009b 48BE0000 		movabsq	$-9223372036854775808, %rsi
 2145      00000000 
 2145      0080
 2146 00a5 48897008 		movq	%rsi, 8(%rax)
 777:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (numberWidth < SECUREC_NUM_WIDTH_INT) {
 2147              		.loc 1 777 12
 2148 00a9 EB2F     		jmp	.L151
 2149              	.L144:
 782:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
 783:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 784:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else { /* o, u, x, X, p */
 785:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->number = (unsigned long)(-(long)spec->number);
 2150              		.loc 1 785 51
 2151 00ab 488B45E0 		movq	-32(%rbp), %rax
 2152 00af 488B4008 		movq	8(%rax), %rax
 2153              		.loc 1 785 40
 2154 00b3 48F7D8   		negq	%rax
 2155              		.loc 1 785 24
 2156 00b6 4889C2   		movq	%rax, %rdx
 2157              		.loc 1 785 22
 2158 00b9 488B45E0 		movq	-32(%rbp), %rax
 2159 00bd 48895008 		movq	%rdx, 8(%rax)
 786:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec->beyondMax != 0) {
 2160              		.loc 1 786 17
 2161 00c1 488B45E0 		movq	-32(%rbp), %rax
 2162 00c5 8B401C   		movl	28(%rax), %eax
 2163              		.loc 1 786 12
 2164 00c8 85C0     		testl	%eax, %eax
 2165 00ca 740F     		je	.L152
 787:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->number |= (unsigned long)SECUREC_MAX_64BITS_VALUE;
 2166              		.loc 1 787 26
 2167 00cc 488B45E0 		movq	-32(%rbp), %rax
 2168 00d0 48C74008 		movq	$-1, 8(%rax)
 2168      FFFFFFFF 
 788:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 789:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 790:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 2169              		.loc 1 790 1
 2170 00d8 EB01     		jmp	.L152
 2171              	.L151:
 777:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (numberWidth < SECUREC_NUM_WIDTH_INT) {
 2172              		.loc 1 777 12
 2173 00da 90       		nop
 2174              	.L152:
 2175              		.loc 1 790 1
 2176 00db 90       		nop
 2177 00dc 488B45F8 		movq	-8(%rbp), %rax
 2178 00e0 64483304 		xorq	%fs:40, %rax
 2178      25280000 
 2178      00
 2179 00e9 7405     		je	.L150
 2180 00eb E8000000 		call	__stack_chk_fail@PLT
 2180      00
 2181              	.L150:
 2182 00f0 C9       		leave
 2183              	.LCFI62:
GAS LISTING /tmp/cc1ytava.s 			page 58


 2184              		.cfi_def_cfa 7, 8
 2185 00f1 C3       		ret
 2186              		.cfi_endproc
 2187              	.LFE26:
 2189              		.section	.text.SecFinishNumberNegativeInt,"ax",@progbits
 2191              	SecFinishNumberNegativeInt:
 2192              	.LFB27:
 791:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /* Compatible processing of integer negative numbers */
 792:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecFinishNumberNegativeInt(int comChr, SecScanSpec *spec)
 793:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 2193              		.loc 1 793 1
 2194              		.cfi_startproc
 2195 0000 F30F1EFA 		endbr64
 2196 0004 55       		pushq	%rbp
 2197              	.LCFI63:
 2198              		.cfi_def_cfa_offset 16
 2199              		.cfi_offset 6, -16
 2200 0005 4889E5   		movq	%rsp, %rbp
 2201              	.LCFI64:
 2202              		.cfi_def_cfa_register 6
 2203 0008 4883EC20 		subq	$32, %rsp
 2204 000c 897DEC   		movl	%edi, -20(%rbp)
 2205 000f 488975E0 		movq	%rsi, -32(%rbp)
 2206              		.loc 1 793 1
 2207 0013 64488B04 		movq	%fs:40, %rax
 2207      25280000 
 2207      00
 2208 001c 488945F8 		movq	%rax, -8(%rbp)
 2209 0020 31C0     		xorl	%eax, %eax
 794:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if ((comChr == SECUREC_CHAR('d')) || (comChr == SECUREC_CHAR('i'))) {
 2210              		.loc 1 794 8
 2211 0022 837DEC64 		cmpl	$100, -20(%rbp)
 2212 0026 7406     		je	.L154
 2213              		.loc 1 794 39 discriminator 1
 2214 0028 837DEC69 		cmpl	$105, -20(%rbp)
 2215 002c 756E     		jne	.L155
 2216              	.L154:
 795:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_ON_64BITS
 796:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (SecIsLongBitEqual(SECUREC_LP64_BIT_WIDTH)) {
 2217              		.loc 1 796 13
 2218 002e BF400000 		movl	$64, %edi
 2218      00
 2219 0033 E8000000 		call	SecIsLongBitEqual
 2219      00
 2220              		.loc 1 796 12
 2221 0038 85C0     		testl	%eax, %eax
 2222 003a 7439     		je	.L156
 797:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if ((spec->number > SECUREC_MIN_64BITS_NEG_VALUE)) {
 2223              		.loc 1 797 22
 2224 003c 488B45E0 		movq	-32(%rbp), %rax
 2225 0040 488B4008 		movq	8(%rax), %rax
 2226              		.loc 1 797 16
 2227 0044 48BA0000 		movabsq	$-9223372036854775808, %rdx
 2227      00000000 
 2227      0080
 2228 004e 4839D0   		cmpq	%rdx, %rax
 2229 0051 760E     		jbe	.L157
GAS LISTING /tmp/cc1ytava.s 			page 59


 798:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number = 0;
 2230              		.loc 1 798 30
 2231 0053 488B45E0 		movq	-32(%rbp), %rax
 2232 0057 48C74008 		movq	$0, 8(%rax)
 2232      00000000 
 2233 005f EB14     		jmp	.L156
 2234              	.L157:
 799:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             } else {
 800:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number = (unsigned int)(-(int)spec->number);
 2235              		.loc 1 800 57
 2236 0061 488B45E0 		movq	-32(%rbp), %rax
 2237 0065 488B4008 		movq	8(%rax), %rax
 2238              		.loc 1 800 47
 2239 0069 F7D8     		negl	%eax
 2240              		.loc 1 800 32
 2241 006b 89C2     		movl	%eax, %edx
 2242              		.loc 1 800 30
 2243 006d 488B45E0 		movq	-32(%rbp), %rax
 2244 0071 48895008 		movq	%rdx, 8(%rax)
 2245              	.L156:
 801:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
 802:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 803:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
 804:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (SecIsLongBitEqual(SECUREC_LP32_BIT_WIDTH)) {
 805:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if ((spec->number > SECUREC_MIN_32BITS_NEG_VALUE)) {
 806:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number = SECUREC_MIN_32BITS_NEG_VALUE;
 807:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             } else {
 808:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number = (unsigned int)(-(int)spec->number);
 809:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
 810:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 811:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 812:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec->beyondMax != 0) {
 2246              		.loc 1 812 17
 2247 0075 488B45E0 		movq	-32(%rbp), %rax
 2248 0079 8B401C   		movl	28(%rax), %eax
 2249              		.loc 1 812 12
 2250 007c 85C0     		testl	%eax, %eax
 2251 007e 746F     		je	.L163
 813:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_ON_64BITS
 814:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (SecIsLongBitEqual(SECUREC_LP64_BIT_WIDTH)) {
 2252              		.loc 1 814 17
 2253 0080 BF400000 		movl	$64, %edi
 2253      00
 2254 0085 E8000000 		call	SecIsLongBitEqual
 2254      00
 2255              		.loc 1 814 16
 2256 008a 85C0     		testl	%eax, %eax
 2257 008c 7461     		je	.L163
 815:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number = 0;
 2258              		.loc 1 815 30
 2259 008e 488B45E0 		movq	-32(%rbp), %rax
 2260 0092 48C74008 		movq	$0, 8(%rax)
 2260      00000000 
 812:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_ON_64BITS
 2261              		.loc 1 812 12
 2262 009a EB53     		jmp	.L163
 2263              	.L155:
GAS LISTING /tmp/cc1ytava.s 			page 60


 816:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
 817:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
 818:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (SecIsLongBitEqual(SECUREC_LP32_BIT_WIDTH)) {
 819:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number = SECUREC_MIN_32BITS_NEG_VALUE;
 820:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
 821:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 822:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 823:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else {            /* o, u, x, X ,p */
 824:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_ON_64BITS
 825:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec->number > SECUREC_MAX_32BITS_VALUE_INC) {
 2264              		.loc 1 825 17
 2265 009c 488B45E0 		movq	-32(%rbp), %rax
 2266 00a0 488B4008 		movq	8(%rax), %rax
 2267              		.loc 1 825 12
 2268 00a4 48BA0000 		movabsq	$4294967296, %rdx
 2268      00000100 
 2268      0000
 2269 00ae 4839D0   		cmpq	%rdx, %rax
 2270 00b1 760F     		jbe	.L160
 826:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->number = SECUREC_MAX_32BITS_VALUE;
 2271              		.loc 1 826 26
 2272 00b3 488B45E0 		movq	-32(%rbp), %rax
 2273 00b7 B9FFFFFF 		movl	$4294967295, %ecx
 2273      FF
 2274 00bc 48894808 		movq	%rcx, 8(%rax)
 2275 00c0 EB14     		jmp	.L161
 2276              	.L160:
 827:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         } else {
 828:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->number = (unsigned int)(-(int)spec->number);
 2277              		.loc 1 828 53
 2278 00c2 488B45E0 		movq	-32(%rbp), %rax
 2279 00c6 488B4008 		movq	8(%rax), %rax
 2280              		.loc 1 828 43
 2281 00ca F7D8     		negl	%eax
 2282              		.loc 1 828 28
 2283 00cc 89C2     		movl	%eax, %edx
 2284              		.loc 1 828 26
 2285 00ce 488B45E0 		movq	-32(%rbp), %rax
 2286 00d2 48895008 		movq	%rdx, 8(%rax)
 2287              	.L161:
 829:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 830:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
 831:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->number = (unsigned int)(-(int)spec->number);
 832:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 833:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec->beyondMax != 0) {
 2288              		.loc 1 833 17
 2289 00d6 488B45E0 		movq	-32(%rbp), %rax
 2290 00da 8B401C   		movl	28(%rax), %eax
 2291              		.loc 1 833 12
 2292 00dd 85C0     		testl	%eax, %eax
 2293 00df 740F     		je	.L164
 834:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->number |= (unsigned long)SECUREC_MAX_64BITS_VALUE;
 2294              		.loc 1 834 26
 2295 00e1 488B45E0 		movq	-32(%rbp), %rax
 2296 00e5 48C74008 		movq	$-1, 8(%rax)
 2296      FFFFFFFF 
 835:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
GAS LISTING /tmp/cc1ytava.s 			page 61


 836:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 837:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 2297              		.loc 1 837 1
 2298 00ed EB01     		jmp	.L164
 2299              	.L163:
 812:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_ON_64BITS
 2300              		.loc 1 812 12
 2301 00ef 90       		nop
 2302              	.L164:
 2303              		.loc 1 837 1
 2304 00f0 90       		nop
 2305 00f1 488B45F8 		movq	-8(%rbp), %rax
 2306 00f5 64483304 		xorq	%fs:40, %rax
 2306      25280000 
 2306      00
 2307 00fe 7405     		je	.L162
 2308 0100 E8000000 		call	__stack_chk_fail@PLT
 2308      00
 2309              	.L162:
 2310 0105 C9       		leave
 2311              	.LCFI65:
 2312              		.cfi_def_cfa 7, 8
 2313 0106 C3       		ret
 2314              		.cfi_endproc
 2315              	.LFE27:
 2317              		.section	.text.SecFinishNumberPositiveOther,"ax",@progbits
 2319              	SecFinishNumberPositiveOther:
 2320              	.LFB28:
 838:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 839:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /* Compatible with integer positive values other than int */
 840:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecFinishNumberPositiveOther(int comChr, int numberWidth, SecScanSpec *spec)
 841:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 2321              		.loc 1 841 1
 2322              		.cfi_startproc
 2323 0000 F30F1EFA 		endbr64
 2324 0004 55       		pushq	%rbp
 2325              	.LCFI66:
 2326              		.cfi_def_cfa_offset 16
 2327              		.cfi_offset 6, -16
 2328 0005 4889E5   		movq	%rsp, %rbp
 2329              	.LCFI67:
 2330              		.cfi_def_cfa_register 6
 2331 0008 4883EC20 		subq	$32, %rsp
 2332 000c 897DEC   		movl	%edi, -20(%rbp)
 2333 000f 8975E8   		movl	%esi, -24(%rbp)
 2334 0012 488955E0 		movq	%rdx, -32(%rbp)
 2335              		.loc 1 841 1
 2336 0016 64488B04 		movq	%fs:40, %rax
 2336      25280000 
 2336      00
 2337 001f 488945F8 		movq	%rax, -8(%rbp)
 2338 0023 31C0     		xorl	%eax, %eax
 842:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (comChr == SECUREC_CHAR('d') || comChr == SECUREC_CHAR('i')) {
 2339              		.loc 1 842 8
 2340 0025 837DEC64 		cmpl	$100, -20(%rbp)
 2341 0029 7406     		je	.L166
 2342              		.loc 1 842 37 discriminator 1
GAS LISTING /tmp/cc1ytava.s 			page 62


 2343 002b 837DEC69 		cmpl	$105, -20(%rbp)
 2344 002f 7561     		jne	.L167
 2345              	.L166:
 843:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec->number > ((unsigned long)(1UL << (SECUREC_LONG_BIT_NUM - 1)) - 1)) {
 2346              		.loc 1 843 17
 2347 0031 488B45E0 		movq	-32(%rbp), %rax
 2348 0035 488B4008 		movq	8(%rax), %rax
 2349              		.loc 1 843 12
 2350 0039 4885C0   		testq	%rax, %rax
 2351 003c 7912     		jns	.L168
 844:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->number = ((unsigned long)(1UL << (SECUREC_LONG_BIT_NUM - 1)) - 1);
 2352              		.loc 1 844 26
 2353 003e 488B45E0 		movq	-32(%rbp), %rax
 2354 0042 48B9FFFF 		movabsq	$9223372036854775807, %rcx
 2354      FFFFFFFF 
 2354      FF7F
 2355 004c 48894808 		movq	%rcx, 8(%rax)
 2356              	.L168:
 845:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 846:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if ((spec->beyondMax != 0 && numberWidth < SECUREC_NUM_WIDTH_INT)) {
 2357              		.loc 1 846 18
 2358 0050 488B45E0 		movq	-32(%rbp), %rax
 2359 0054 8B401C   		movl	28(%rax), %eax
 2360              		.loc 1 846 12
 2361 0057 85C0     		testl	%eax, %eax
 2362 0059 7412     		je	.L169
 2363              		.loc 1 846 35 discriminator 1
 2364 005b 837DE800 		cmpl	$0, -24(%rbp)
 2365 005f 7F0C     		jg	.L169
 847:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->number |= (unsigned long)SECUREC_MAX_64BITS_VALUE;
 2366              		.loc 1 847 26
 2367 0061 488B45E0 		movq	-32(%rbp), %rax
 2368 0065 48C74008 		movq	$-1, 8(%rax)
 2368      FFFFFFFF 
 2369              	.L169:
 848:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 849:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec->beyondMax != 0 && numberWidth == SECUREC_NUM_WIDTH_LONG) {
 2370              		.loc 1 849 17
 2371 006d 488B45E0 		movq	-32(%rbp), %rax
 2372 0071 8B401C   		movl	28(%rax), %eax
 2373              		.loc 1 849 12
 2374 0074 85C0     		testl	%eax, %eax
 2375 0076 7433     		je	.L173
 2376              		.loc 1 849 34 discriminator 1
 2377 0078 837DE802 		cmpl	$2, -24(%rbp)
 2378 007c 752D     		jne	.L173
 850:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->number = ((unsigned long)(1UL << (SECUREC_LONG_BIT_NUM - 1)) - 1);
 2379              		.loc 1 850 26
 2380 007e 488B45E0 		movq	-32(%rbp), %rax
 2381 0082 48BAFFFF 		movabsq	$9223372036854775807, %rdx
 2381      FFFFFFFF 
 2381      FF7F
 2382 008c 48895008 		movq	%rdx, 8(%rax)
 849:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->number = ((unsigned long)(1UL << (SECUREC_LONG_BIT_NUM - 1)) - 1);
 2383              		.loc 1 849 12
 2384 0090 EB19     		jmp	.L173
 2385              	.L167:
GAS LISTING /tmp/cc1ytava.s 			page 63


 851:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 852:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else {
 853:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec->beyondMax != 0) {
 2386              		.loc 1 853 17
 2387 0092 488B45E0 		movq	-32(%rbp), %rax
 2388 0096 8B401C   		movl	28(%rax), %eax
 2389              		.loc 1 853 12
 2390 0099 85C0     		testl	%eax, %eax
 2391 009b 740F     		je	.L174
 854:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->number |= (unsigned long)SECUREC_MAX_64BITS_VALUE;
 2392              		.loc 1 854 26
 2393 009d 488B45E0 		movq	-32(%rbp), %rax
 2394 00a1 48C74008 		movq	$-1, 8(%rax)
 2394      FFFFFFFF 
 855:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 856:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 857:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 2395              		.loc 1 857 1
 2396 00a9 EB01     		jmp	.L174
 2397              	.L173:
 849:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->number = ((unsigned long)(1UL << (SECUREC_LONG_BIT_NUM - 1)) - 1);
 2398              		.loc 1 849 12
 2399 00ab 90       		nop
 2400              	.L174:
 2401              		.loc 1 857 1
 2402 00ac 90       		nop
 2403 00ad 488B45F8 		movq	-8(%rbp), %rax
 2404 00b1 64483304 		xorq	%fs:40, %rax
 2404      25280000 
 2404      00
 2405 00ba 7405     		je	.L172
 2406 00bc E8000000 		call	__stack_chk_fail@PLT
 2406      00
 2407              	.L172:
 2408 00c1 C9       		leave
 2409              	.LCFI68:
 2410              		.cfi_def_cfa 7, 8
 2411 00c2 C3       		ret
 2412              		.cfi_endproc
 2413              	.LFE28:
 2415              		.section	.text.SecFinishNumberPositiveInt,"ax",@progbits
 2417              	SecFinishNumberPositiveInt:
 2418              	.LFB29:
 858:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 859:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /* Compatible processing of integer positive numbers */
 860:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecFinishNumberPositiveInt(int comChr, SecScanSpec *spec)
 861:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 2419              		.loc 1 861 1
 2420              		.cfi_startproc
 2421 0000 F30F1EFA 		endbr64
 2422 0004 55       		pushq	%rbp
 2423              	.LCFI69:
 2424              		.cfi_def_cfa_offset 16
 2425              		.cfi_offset 6, -16
 2426 0005 4889E5   		movq	%rsp, %rbp
 2427              	.LCFI70:
 2428              		.cfi_def_cfa_register 6
GAS LISTING /tmp/cc1ytava.s 			page 64


 2429 0008 4883EC20 		subq	$32, %rsp
 2430 000c 897DEC   		movl	%edi, -20(%rbp)
 2431 000f 488975E0 		movq	%rsi, -32(%rbp)
 2432              		.loc 1 861 1
 2433 0013 64488B04 		movq	%fs:40, %rax
 2433      25280000 
 2433      00
 2434 001c 488945F8 		movq	%rax, -8(%rbp)
 2435 0020 31C0     		xorl	%eax, %eax
 862:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if ((comChr == SECUREC_CHAR('d')) || (comChr == SECUREC_CHAR('i'))) {
 2436              		.loc 1 862 8
 2437 0022 837DEC64 		cmpl	$100, -20(%rbp)
 2438 0026 7406     		je	.L176
 2439              		.loc 1 862 39 discriminator 1
 2440 0028 837DEC69 		cmpl	$105, -20(%rbp)
 2441 002c 754E     		jne	.L177
 2442              	.L176:
 863:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_ON_64BITS
 864:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (SecIsLongBitEqual(SECUREC_LP64_BIT_WIDTH)) {
 2443              		.loc 1 864 13
 2444 002e BF400000 		movl	$64, %edi
 2444      00
 2445 0033 E8000000 		call	SecIsLongBitEqual
 2445      00
 2446              		.loc 1 864 12
 2447 0038 85C0     		testl	%eax, %eax
 2448 003a 7419     		je	.L178
 865:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (spec->number > SECUREC_MAX_64BITS_POS_VALUE) {
 2449              		.loc 1 865 21
 2450 003c 488B45E0 		movq	-32(%rbp), %rax
 2451 0040 488B4008 		movq	8(%rax), %rax
 2452              		.loc 1 865 16
 2453 0044 4885C0   		testq	%rax, %rax
 2454 0047 790C     		jns	.L178
 866:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number |= (unsigned long)SECUREC_MAX_64BITS_VALUE;
 2455              		.loc 1 866 30
 2456 0049 488B45E0 		movq	-32(%rbp), %rax
 2457 004d 48C74008 		movq	$-1, 8(%rax)
 2457      FFFFFFFF 
 2458              	.L178:
 867:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
 868:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 869:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec->beyondMax != 0 && SecIsLongBitEqual(SECUREC_LP64_BIT_WIDTH)) {
 2459              		.loc 1 869 17
 2460 0055 488B45E0 		movq	-32(%rbp), %rax
 2461 0059 8B401C   		movl	28(%rax), %eax
 2462              		.loc 1 869 12
 2463 005c 85C0     		testl	%eax, %eax
 2464 005e 7436     		je	.L182
 2465              		.loc 1 869 37 discriminator 1
 2466 0060 BF400000 		movl	$64, %edi
 2466      00
 2467 0065 E8000000 		call	SecIsLongBitEqual
 2467      00
 2468              		.loc 1 869 34 discriminator 1
 2469 006a 85C0     		testl	%eax, %eax
 2470 006c 7428     		je	.L182
GAS LISTING /tmp/cc1ytava.s 			page 65


 870:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->number |= (unsigned long)SECUREC_MAX_64BITS_VALUE;
 2471              		.loc 1 870 26
 2472 006e 488B45E0 		movq	-32(%rbp), %rax
 2473 0072 48C74008 		movq	$-1, 8(%rax)
 2473      FFFFFFFF 
 869:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->number |= (unsigned long)SECUREC_MAX_64BITS_VALUE;
 2474              		.loc 1 869 12
 2475 007a EB1A     		jmp	.L182
 2476              	.L177:
 871:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 872:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
 873:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (SecIsLongBitEqual(SECUREC_LP32_BIT_WIDTH)) {
 874:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (spec->number > SECUREC_MAX_32BITS_POS_VALUE) {
 875:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number = SECUREC_MAX_32BITS_POS_VALUE;
 876:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
 877:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 878:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec->beyondMax != 0 && SecIsLongBitEqual(SECUREC_LP32_BIT_WIDTH)) {
 879:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->number = SECUREC_MAX_32BITS_POS_VALUE;
 880:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 881:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 882:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else {            /* o,u,x,X,p */
 883:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec->beyondMax != 0) {
 2477              		.loc 1 883 17
 2478 007c 488B45E0 		movq	-32(%rbp), %rax
 2479 0080 8B401C   		movl	28(%rax), %eax
 2480              		.loc 1 883 12
 2481 0083 85C0     		testl	%eax, %eax
 2482 0085 7410     		je	.L183
 884:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->number = SECUREC_MAX_32BITS_VALUE;
 2483              		.loc 1 884 26
 2484 0087 488B45E0 		movq	-32(%rbp), %rax
 2485 008b BAFFFFFF 		movl	$4294967295, %edx
 2485      FF
 2486 0090 48895008 		movq	%rdx, 8(%rax)
 885:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 886:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 887:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 2487              		.loc 1 887 1
 2488 0094 EB01     		jmp	.L183
 2489              	.L182:
 869:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->number |= (unsigned long)SECUREC_MAX_64BITS_VALUE;
 2490              		.loc 1 869 12
 2491 0096 90       		nop
 2492              	.L183:
 2493              		.loc 1 887 1
 2494 0097 90       		nop
 2495 0098 488B45F8 		movq	-8(%rbp), %rax
 2496 009c 64483304 		xorq	%fs:40, %rax
 2496      25280000 
 2496      00
 2497 00a5 7405     		je	.L181
 2498 00a7 E8000000 		call	__stack_chk_fail@PLT
 2498      00
 2499              	.L181:
 2500 00ac C9       		leave
 2501              	.LCFI71:
 2502              		.cfi_def_cfa 7, 8
GAS LISTING /tmp/cc1ytava.s 			page 66


 2503 00ad C3       		ret
 2504              		.cfi_endproc
 2505              	.LFE29:
 2507              		.section	.text.SecDecodeNumber64Decimal,"ax",@progbits
 2509              	SecDecodeNumber64Decimal:
 2510              	.LFB30:
 888:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 889:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 890:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 891:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 892:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 893:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * Parse decimal character to integer for 64bit .
 894:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 895:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecDecodeNumber64Decimal(SecInt ch, SecScanSpec *spec)
 896:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 2511              		.loc 1 896 1
 2512              		.cfi_startproc
 2513 0000 F30F1EFA 		endbr64
 2514 0004 55       		pushq	%rbp
 2515              	.LCFI72:
 2516              		.cfi_def_cfa_offset 16
 2517              		.cfi_offset 6, -16
 2518 0005 4889E5   		movq	%rsp, %rbp
 2519              	.LCFI73:
 2520              		.cfi_def_cfa_register 6
 2521 0008 4883EC20 		subq	$32, %rsp
 2522 000c 897DEC   		movl	%edi, -20(%rbp)
 2523 000f 488975E0 		movq	%rsi, -32(%rbp)
 2524              		.loc 1 896 1
 2525 0013 64488B04 		movq	%fs:40, %rax
 2525      25280000 
 2525      00
 2526 001c 488945F8 		movq	%rax, -8(%rbp)
 2527 0020 31C0     		xorl	%eax, %eax
 897:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if (defined(SECUREC_COMPATIBLE_LINUX_FORMAT) && !(defined(SECUREC_ON_UNIX)))
 898:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (spec->number64 > SECUREC_MAX_64BITS_VALUE_DIV_TEN) {
 2528              		.loc 1 898 13
 2529 0022 488B45E0 		movq	-32(%rbp), %rax
 2530 0026 488B00   		movq	(%rax), %rax
 2531              		.loc 1 898 8
 2532 0029 48BA9999 		movabsq	$1844674407370955161, %rdx
 2532      99999999 
 2532      9919
 2533 0033 4839D0   		cmpq	%rdx, %rax
 2534 0036 760B     		jbe	.L185
 899:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->beyondMax = 1;
 2535              		.loc 1 899 25
 2536 0038 488B45E0 		movq	-32(%rbp), %rax
 2537 003c C7401C01 		movl	$1, 28(%rax)
 2537      000000
 2538              	.L185:
 900:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 901:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 902:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->number64 = SECUREC_MUL_TEN(spec->number64);
 2539              		.loc 1 902 22
 2540 0043 488B45E0 		movq	-32(%rbp), %rax
 2541 0047 488B00   		movq	(%rax), %rax
GAS LISTING /tmp/cc1ytava.s 			page 67


 2542 004a 488D1485 		leaq	0(,%rax,4), %rdx
 2542      00000000 
 2543 0052 488B45E0 		movq	-32(%rbp), %rax
 2544 0056 488B00   		movq	(%rax), %rax
 2545 0059 4801D0   		addq	%rdx, %rax
 2546 005c 488D1400 		leaq	(%rax,%rax), %rdx
 2547              		.loc 1 902 20
 2548 0060 488B45E0 		movq	-32(%rbp), %rax
 2549 0064 488910   		movq	%rdx, (%rax)
 903:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if (defined(SECUREC_COMPATIBLE_LINUX_FORMAT) && !(defined(SECUREC_ON_UNIX)))
 904:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (spec->number64 == SECUREC_MAX_64BITS_VALUE_CUT_LAST_DIGIT) {
 2550              		.loc 1 904 13
 2551 0067 488B45E0 		movq	-32(%rbp), %rax
 2552 006b 488B00   		movq	(%rax), %rax
 2553              		.loc 1 904 8
 2554 006e 4883F8FA 		cmpq	$-6, %rax
 2555 0072 7527     		jne	.L186
 2556              	.LBB9:
 905:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SecUnsignedInt64 number64As = (SecUnsignedInt64)SECUREC_MAX_64BITS_VALUE - spec->number64;
 2557              		.loc 1 905 88
 2558 0074 488B45E0 		movq	-32(%rbp), %rax
 2559 0078 488B00   		movq	(%rax), %rax
 2560              		.loc 1 905 26
 2561 007b 48F7D0   		notq	%rax
 2562 007e 488945F0 		movq	%rax, -16(%rbp)
 906:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (number64As < (SecUnsignedInt64)((SecUnsignedInt)ch - SECUREC_CHAR('0'))) {
 2563              		.loc 1 906 64
 2564 0082 8B45EC   		movl	-20(%rbp), %eax
 2565 0085 83E830   		subl	$48, %eax
 2566              		.loc 1 906 26
 2567 0088 89C0     		movl	%eax, %eax
 2568              		.loc 1 906 12
 2569 008a 483945F0 		cmpq	%rax, -16(%rbp)
 2570 008e 730B     		jnb	.L186
 907:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->beyondMax = 1;
 2571              		.loc 1 907 29
 2572 0090 488B45E0 		movq	-32(%rbp), %rax
 2573 0094 C7401C01 		movl	$1, 28(%rax)
 2573      000000
 2574              	.L186:
 2575              	.LBE9:
 908:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 909:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 910:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 911:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->number64 += (SecUnsignedInt64)((SecUnsignedInt)ch - SECUREC_CHAR('0'));
 2576              		.loc 1 911 20
 2577 009b 488B45E0 		movq	-32(%rbp), %rax
 2578 009f 488B00   		movq	(%rax), %rax
 2579              		.loc 1 911 61
 2580 00a2 8B55EC   		movl	-20(%rbp), %edx
 2581 00a5 83EA30   		subl	$48, %edx
 2582              		.loc 1 911 23
 2583 00a8 89D2     		movl	%edx, %edx
 2584              		.loc 1 911 20
 2585 00aa 4801C2   		addq	%rax, %rdx
 2586 00ad 488B45E0 		movq	-32(%rbp), %rax
 2587 00b1 488910   		movq	%rdx, (%rax)
GAS LISTING /tmp/cc1ytava.s 			page 68


 912:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 2588              		.loc 1 912 1
 2589 00b4 90       		nop
 2590 00b5 488B45F8 		movq	-8(%rbp), %rax
 2591 00b9 64483304 		xorq	%fs:40, %rax
 2591      25280000 
 2591      00
 2592 00c2 7405     		je	.L187
 2593 00c4 E8000000 		call	__stack_chk_fail@PLT
 2593      00
 2594              	.L187:
 2595 00c9 C9       		leave
 2596              	.LCFI74:
 2597              		.cfi_def_cfa 7, 8
 2598 00ca C3       		ret
 2599              		.cfi_endproc
 2600              	.LFE30:
 2602              		.section	.text.SecDecodeNumber64Hex,"ax",@progbits
 2604              	SecDecodeNumber64Hex:
 2605              	.LFB31:
 913:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 914:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 915:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * Parse Hex character to integer for 64bit .
 916:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 917:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecDecodeNumber64Hex(SecInt ch, SecScanSpec *spec)
 918:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 2606              		.loc 1 918 1
 2607              		.cfi_startproc
 2608 0000 F30F1EFA 		endbr64
 2609 0004 55       		pushq	%rbp
 2610              	.LCFI75:
 2611              		.cfi_def_cfa_offset 16
 2612              		.cfi_offset 6, -16
 2613 0005 4889E5   		movq	%rsp, %rbp
 2614              	.LCFI76:
 2615              		.cfi_def_cfa_register 6
 2616 0008 4883EC20 		subq	$32, %rsp
 2617 000c 897DEC   		movl	%edi, -20(%rbp)
 2618 000f 488975E0 		movq	%rsi, -32(%rbp)
 2619              		.loc 1 918 1
 2620 0013 64488B04 		movq	%fs:40, %rax
 2620      25280000 
 2620      00
 2621 001c 488945F8 		movq	%rax, -8(%rbp)
 2622 0020 31C0     		xorl	%eax, %eax
 919:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if (defined(SECUREC_COMPATIBLE_LINUX_FORMAT) && !(defined(SECUREC_ON_UNIX)))
 920:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (SECUREC_QWORD_HEX_BEYOND_MAX(spec->number64)) {
 2623              		.loc 1 920 9
 2624 0022 488B45E0 		movq	-32(%rbp), %rax
 2625 0026 488B00   		movq	(%rax), %rax
 2626 0029 48C1E83C 		shrq	$60, %rax
 2627              		.loc 1 920 8
 2628 002d 4885C0   		testq	%rax, %rax
 2629 0030 740B     		je	.L189
 921:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->beyondMax = 1;
 2630              		.loc 1 921 25
 2631 0032 488B45E0 		movq	-32(%rbp), %rax
GAS LISTING /tmp/cc1ytava.s 			page 69


 2632 0036 C7401C01 		movl	$1, 28(%rax)
 2632      000000
 2633              	.L189:
 922:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 923:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 924:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->number64 = SECUREC_MUL_SIXTEEN(spec->number64);
 2634              		.loc 1 924 22
 2635 003d 488B45E0 		movq	-32(%rbp), %rax
 2636 0041 488B00   		movq	(%rax), %rax
 2637 0044 48C1E004 		salq	$4, %rax
 2638 0048 4889C2   		movq	%rax, %rdx
 2639              		.loc 1 924 20
 2640 004b 488B45E0 		movq	-32(%rbp), %rax
 2641 004f 488910   		movq	%rdx, (%rax)
 925:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->number64 += (SecUnsignedInt64)(unsigned int)SecHexValueOfChar(ch);
 2642              		.loc 1 925 55
 2643 0052 8B45EC   		movl	-20(%rbp), %eax
 2644 0055 89C7     		movl	%eax, %edi
 2645 0057 E8000000 		call	SecHexValueOfChar
 2645      00
 2646              		.loc 1 925 23
 2647 005c 89C2     		movl	%eax, %edx
 2648              		.loc 1 925 20
 2649 005e 488B45E0 		movq	-32(%rbp), %rax
 2650 0062 488B00   		movq	(%rax), %rax
 2651 0065 4801C2   		addq	%rax, %rdx
 2652 0068 488B45E0 		movq	-32(%rbp), %rax
 2653 006c 488910   		movq	%rdx, (%rax)
 926:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 927:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 2654              		.loc 1 927 1
 2655 006f 90       		nop
 2656 0070 488B45F8 		movq	-8(%rbp), %rax
 2657 0074 64483304 		xorq	%fs:40, %rax
 2657      25280000 
 2657      00
 2658 007d 7405     		je	.L190
 2659 007f E8000000 		call	__stack_chk_fail@PLT
 2659      00
 2660              	.L190:
 2661 0084 C9       		leave
 2662              	.LCFI77:
 2663              		.cfi_def_cfa 7, 8
 2664 0085 C3       		ret
 2665              		.cfi_endproc
 2666              	.LFE31:
 2668              		.section	.text.SecDecodeNumber64Octal,"ax",@progbits
 2670              	SecDecodeNumber64Octal:
 2671              	.LFB32:
 928:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 929:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 930:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * Parse Octal character to integer for 64bit .
 931:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 932:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecDecodeNumber64Octal(SecInt ch, SecScanSpec *spec)
 933:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 2672              		.loc 1 933 1
 2673              		.cfi_startproc
GAS LISTING /tmp/cc1ytava.s 			page 70


 2674 0000 F30F1EFA 		endbr64
 2675 0004 55       		pushq	%rbp
 2676              	.LCFI78:
 2677              		.cfi_def_cfa_offset 16
 2678              		.cfi_offset 6, -16
 2679 0005 4889E5   		movq	%rsp, %rbp
 2680              	.LCFI79:
 2681              		.cfi_def_cfa_register 6
 2682 0008 4883EC20 		subq	$32, %rsp
 2683 000c 897DEC   		movl	%edi, -20(%rbp)
 2684 000f 488975E0 		movq	%rsi, -32(%rbp)
 2685              		.loc 1 933 1
 2686 0013 64488B04 		movq	%fs:40, %rax
 2686      25280000 
 2686      00
 2687 001c 488945F8 		movq	%rax, -8(%rbp)
 2688 0020 31C0     		xorl	%eax, %eax
 934:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if (defined(SECUREC_COMPATIBLE_LINUX_FORMAT) && !(defined(SECUREC_ON_UNIX)))
 935:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (SECUREC_QWORD_OCTAL_BEYOND_MAX(spec->number64)) {
 2689              		.loc 1 935 9
 2690 0022 488B45E0 		movq	-32(%rbp), %rax
 2691 0026 488B00   		movq	(%rax), %rax
 2692 0029 48C1E83D 		shrq	$61, %rax
 2693              		.loc 1 935 8
 2694 002d 4885C0   		testq	%rax, %rax
 2695 0030 740B     		je	.L192
 936:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->beyondMax = 1;
 2696              		.loc 1 936 25
 2697 0032 488B45E0 		movq	-32(%rbp), %rax
 2698 0036 C7401C01 		movl	$1, 28(%rax)
 2698      000000
 2699              	.L192:
 937:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 938:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 939:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->number64 = SECUREC_MUL_EIGHT(spec->number64);
 2700              		.loc 1 939 22
 2701 003d 488B45E0 		movq	-32(%rbp), %rax
 2702 0041 488B00   		movq	(%rax), %rax
 2703 0044 488D14C5 		leaq	0(,%rax,8), %rdx
 2703      00000000 
 2704              		.loc 1 939 20
 2705 004c 488B45E0 		movq	-32(%rbp), %rax
 2706 0050 488910   		movq	%rdx, (%rax)
 940:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->number64 += (SecUnsignedInt64)((SecUnsignedInt)ch - SECUREC_CHAR('0'));
 2707              		.loc 1 940 20
 2708 0053 488B45E0 		movq	-32(%rbp), %rax
 2709 0057 488B00   		movq	(%rax), %rax
 2710              		.loc 1 940 61
 2711 005a 8B55EC   		movl	-20(%rbp), %edx
 2712 005d 83EA30   		subl	$48, %edx
 2713              		.loc 1 940 23
 2714 0060 89D2     		movl	%edx, %edx
 2715              		.loc 1 940 20
 2716 0062 4801C2   		addq	%rax, %rdx
 2717 0065 488B45E0 		movq	-32(%rbp), %rax
 2718 0069 488910   		movq	%rdx, (%rax)
 941:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
GAS LISTING /tmp/cc1ytava.s 			page 71


 2719              		.loc 1 941 1
 2720 006c 90       		nop
 2721 006d 488B45F8 		movq	-8(%rbp), %rax
 2722 0071 64483304 		xorq	%fs:40, %rax
 2722      25280000 
 2722      00
 2723 007a 7405     		je	.L193
 2724 007c E8000000 		call	__stack_chk_fail@PLT
 2724      00
 2725              	.L193:
 2726 0081 C9       		leave
 2727              	.LCFI80:
 2728              		.cfi_def_cfa 7, 8
 2729 0082 C3       		ret
 2730              		.cfi_endproc
 2731              	.LFE32:
 2733              		.section	.data.rel.local.g_secDecodeNumberHex,"aw"
 2734              		.align 16
 2737              	g_secDecodeNumberHex:
 2738 0000 00000000 		.quad	SecDecodeNumberHex
 2738      00000000 
 2739 0008 00000000 		.quad	SecDecodeNumber64Hex
 2739      00000000 
 2740              		.section	.data.rel.local.g_secDecodeNumberOctal,"aw"
 2741              		.align 16
 2744              	g_secDecodeNumberOctal:
 2745 0000 00000000 		.quad	SecDecodeNumberOctal
 2745      00000000 
 2746 0008 00000000 		.quad	SecDecodeNumber64Octal
 2746      00000000 
 2747              		.section	.data.rel.local.g_secDecodeNumberDecimal,"aw"
 2748              		.align 16
 2751              	g_secDecodeNumberDecimal:
 2752 0000 00000000 		.quad	SecDecodeNumberDecimal
 2752      00000000 
 2753 0008 00000000 		.quad	SecDecodeNumber64Decimal
 2753      00000000 
 2754              		.section	.text.SecDecodeNumber,"ax",@progbits
 2756              	SecDecodeNumber:
 2757              	.LFB33:
 942:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 943:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECUREC_DECODE_NUMBER_FUNC_NUM 2
 944:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /* Function name cannot add address symbol, causing 546 alarm */
 945:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void (*g_secDecodeNumberHex[SECUREC_DECODE_NUMBER_FUNC_NUM])(SecInt ch, SecScanSpec *spec) =
 946:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     { SecDecodeNumberHex, SecDecodeNumber64Hex };
 947:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void (*g_secDecodeNumberOctal[SECUREC_DECODE_NUMBER_FUNC_NUM])(SecInt ch, SecScanSpec *spec)
 948:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     { SecDecodeNumberOctal, SecDecodeNumber64Octal };
 949:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void (*g_secDecodeNumberDecimal[SECUREC_DECODE_NUMBER_FUNC_NUM])(SecInt ch, SecScanSpec *spe
 950:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     { SecDecodeNumberDecimal, SecDecodeNumber64Decimal };
 951:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 952:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 953:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * Parse 64-bit integer formatted input, return 0 when ch is a number.
 954:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 955:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static int SecDecodeNumber(SecInt ch, SecScanSpec *spec)
 956:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 2758              		.loc 1 956 1
 2759              		.cfi_startproc
GAS LISTING /tmp/cc1ytava.s 			page 72


 2760 0000 F30F1EFA 		endbr64
 2761 0004 55       		pushq	%rbp
 2762              	.LCFI81:
 2763              		.cfi_def_cfa_offset 16
 2764              		.cfi_offset 6, -16
 2765 0005 4889E5   		movq	%rsp, %rbp
 2766              	.LCFI82:
 2767              		.cfi_def_cfa_register 6
 2768 0008 4883EC20 		subq	$32, %rsp
 2769 000c 897DEC   		movl	%edi, -20(%rbp)
 2770 000f 488975E0 		movq	%rsi, -32(%rbp)
 2771              		.loc 1 956 1
 2772 0013 64488B04 		movq	%fs:40, %rax
 2772      25280000 
 2772      00
 2773 001c 488945F8 		movq	%rax, -8(%rbp)
 2774 0020 31C0     		xorl	%eax, %eax
 957:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (spec->comChr == SECUREC_CHAR('x') || spec->comChr == SECUREC_CHAR('p')) {
 2775              		.loc 1 957 13
 2776 0022 488B45E0 		movq	-32(%rbp), %rax
 2777 0026 8B4038   		movl	56(%rax), %eax
 2778              		.loc 1 957 8
 2779 0029 83F878   		cmpl	$120, %eax
 2780 002c 740C     		je	.L195
 2781              		.loc 1 957 50 discriminator 1
 2782 002e 488B45E0 		movq	-32(%rbp), %rax
 2783 0032 8B4038   		movl	56(%rax), %eax
 2784              		.loc 1 957 43 discriminator 1
 2785 0035 83F870   		cmpl	$112, %eax
 2786 0038 7570     		jne	.L196
 2787              	.L195:
 958:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (SECUREC_IS_XDIGIT(ch)) {
 2788              		.loc 1 958 13
 2789 003a 8B45EC   		movl	-20(%rbp), %eax
 2790 003d 2500FF00 		andl	$65280, %eax
 2790      00
 2791              		.loc 1 958 12
 2792 0042 85C0     		testl	%eax, %eax
 2793 0044 755A     		jne	.L197
 2794              		.loc 1 958 13 discriminator 1
 2795 0046 E8000000 		call	__ctype_b_loc@PLT
 2795      00
 2796 004b 488B00   		movq	(%rax), %rax
 2797 004e 8B55EC   		movl	-20(%rbp), %edx
 2798 0051 4863D2   		movslq	%edx, %rdx
 2799 0054 0FB6D2   		movzbl	%dl, %edx
 2800 0057 4801D2   		addq	%rdx, %rdx
 2801 005a 4801D0   		addq	%rdx, %rax
 2802 005d 0FB700   		movzwl	(%rax), %eax
 2803 0060 0FB7C0   		movzwl	%ax, %eax
 2804 0063 25001000 		andl	$4096, %eax
 2804      00
 2805 0068 85C0     		testl	%eax, %eax
 2806 006a 7434     		je	.L197
 959:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             (*g_secDecodeNumberHex[spec->isInt64Arg])(ch, spec);
 2807              		.loc 1 959 40
 2808 006c 488B45E0 		movq	-32(%rbp), %rax
GAS LISTING /tmp/cc1ytava.s 			page 73


 2809 0070 8B4014   		movl	20(%rax), %eax
 2810              		.loc 1 959 14
 2811 0073 4898     		cltq
 2812 0075 488D14C5 		leaq	0(,%rax,8), %rdx
 2812      00000000 
 2813 007d 488D0500 		leaq	g_secDecodeNumberHex(%rip), %rax
 2813      000000
 2814 0084 488B0C02 		movq	(%rdx,%rax), %rcx
 2815 0088 488B55E0 		movq	-32(%rbp), %rdx
 2816 008c 8B45EC   		movl	-20(%rbp), %eax
 2817 008f 4889D6   		movq	%rdx, %rsi
 2818 0092 89C7     		movl	%eax, %edi
 2819 0094 FFD1     		call	*%rcx
 2820              	.LVL0:
 960:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         } else {
 961:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             return -1;
 962:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 963:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return 0;
 2821              		.loc 1 963 16
 2822 0096 B8000000 		movl	$0, %eax
 2822      00
 2823 009b E9B70000 		jmp	.L198
 2823      00
 2824              	.L197:
 961:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 2825              		.loc 1 961 20
 2826 00a0 B8FFFFFF 		movl	$-1, %eax
 2826      FF
 2827 00a5 E9AD0000 		jmp	.L198
 2827      00
 2828              	.L196:
 964:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 965:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (!(SECUREC_IS_DIGIT(ch))) {
 2829              		.loc 1 965 11
 2830 00aa 8B45EC   		movl	-20(%rbp), %eax
 2831 00ad 2500FF00 		andl	$65280, %eax
 2831      00
 2832              		.loc 1 965 8
 2833 00b2 85C0     		testl	%eax, %eax
 2834 00b4 7526     		jne	.L199
 2835              		.loc 1 965 11 discriminator 1
 2836 00b6 E8000000 		call	__ctype_b_loc@PLT
 2836      00
 2837 00bb 488B00   		movq	(%rax), %rax
 2838 00be 8B55EC   		movl	-20(%rbp), %edx
 2839 00c1 4863D2   		movslq	%edx, %rdx
 2840 00c4 0FB6D2   		movzbl	%dl, %edx
 2841 00c7 4801D2   		addq	%rdx, %rdx
 2842 00ca 4801D0   		addq	%rdx, %rax
 2843 00cd 0FB700   		movzwl	(%rax), %eax
 2844 00d0 0FB7C0   		movzwl	%ax, %eax
 2845 00d3 25000800 		andl	$2048, %eax
 2845      00
 2846              		.loc 1 965 9 discriminator 1
 2847 00d8 85C0     		testl	%eax, %eax
 2848 00da 7507     		jne	.L200
 2849              	.L199:
GAS LISTING /tmp/cc1ytava.s 			page 74


 966:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return -1;
 2850              		.loc 1 966 16
 2851 00dc B8FFFFFF 		movl	$-1, %eax
 2851      FF
 2852 00e1 EB74     		jmp	.L198
 2853              	.L200:
 967:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 968:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (spec->comChr == SECUREC_CHAR('o')) {
 2854              		.loc 1 968 13
 2855 00e3 488B45E0 		movq	-32(%rbp), %rax
 2856 00e7 8B4038   		movl	56(%rax), %eax
 2857              		.loc 1 968 8
 2858 00ea 83F86F   		cmpl	$111, %eax
 2859 00ed 7539     		jne	.L201
 969:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (ch < SECUREC_CHAR('8')) {
 2860              		.loc 1 969 12
 2861 00ef 837DEC37 		cmpl	$55, -20(%rbp)
 2862 00f3 772C     		ja	.L202
 970:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             (*g_secDecodeNumberOctal[spec->isInt64Arg])(ch, spec);
 2863              		.loc 1 970 42
 2864 00f5 488B45E0 		movq	-32(%rbp), %rax
 2865 00f9 8B4014   		movl	20(%rax), %eax
 2866              		.loc 1 970 14
 2867 00fc 4898     		cltq
 2868 00fe 488D14C5 		leaq	0(,%rax,8), %rdx
 2868      00000000 
 2869 0106 488D0500 		leaq	g_secDecodeNumberOctal(%rip), %rax
 2869      000000
 2870 010d 488B0C02 		movq	(%rdx,%rax), %rcx
 2871 0111 488B55E0 		movq	-32(%rbp), %rdx
 2872 0115 8B45EC   		movl	-20(%rbp), %eax
 2873 0118 4889D6   		movq	%rdx, %rsi
 2874 011b 89C7     		movl	%eax, %edi
 2875 011d FFD1     		call	*%rcx
 2876              	.LVL1:
 2877 011f EB31     		jmp	.L203
 2878              	.L202:
 971:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         } else {
 972:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             return -1;
 2879              		.loc 1 972 20
 2880 0121 B8FFFFFF 		movl	$-1, %eax
 2880      FF
 2881 0126 EB2F     		jmp	.L198
 2882              	.L201:
 973:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 974:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else { /* comChr is 'd' */
 975:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         (*g_secDecodeNumberDecimal[spec->isInt64Arg])(ch, spec);
 2883              		.loc 1 975 40
 2884 0128 488B45E0 		movq	-32(%rbp), %rax
 2885 012c 8B4014   		movl	20(%rax), %eax
 2886              		.loc 1 975 10
 2887 012f 4898     		cltq
 2888 0131 488D14C5 		leaq	0(,%rax,8), %rdx
 2888      00000000 
 2889 0139 488D0500 		leaq	g_secDecodeNumberDecimal(%rip), %rax
 2889      000000
 2890 0140 488B0C02 		movq	(%rdx,%rax), %rcx
GAS LISTING /tmp/cc1ytava.s 			page 75


 2891 0144 488B55E0 		movq	-32(%rbp), %rdx
 2892 0148 8B45EC   		movl	-20(%rbp), %eax
 2893 014b 4889D6   		movq	%rdx, %rsi
 2894 014e 89C7     		movl	%eax, %edi
 2895 0150 FFD1     		call	*%rcx
 2896              	.LVL2:
 2897              	.L203:
 976:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
 977:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return 0;
 2898              		.loc 1 977 12
 2899 0152 B8000000 		movl	$0, %eax
 2899      00
 2900              	.L198:
 978:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 2901              		.loc 1 978 1
 2902 0157 488B75F8 		movq	-8(%rbp), %rsi
 2903 015b 64483334 		xorq	%fs:40, %rsi
 2903      25280000 
 2903      00
 2904 0164 7405     		je	.L204
 2905 0166 E8000000 		call	__stack_chk_fail@PLT
 2905      00
 2906              	.L204:
 2907 016b C9       		leave
 2908              	.LCFI83:
 2909              		.cfi_def_cfa 7, 8
 2910 016c C3       		ret
 2911              		.cfi_endproc
 2912              	.LFE33:
 2914              		.section	.text.SecFinishNumber,"ax",@progbits
 2916              	SecFinishNumber:
 2917              	.LFB34:
 979:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 980:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
 981:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
 982:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * Complete the final 32-bit integer formatted input
 983:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
 984:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecFinishNumber(SecScanSpec *spec)
 985:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 2918              		.loc 1 985 1
 2919              		.cfi_startproc
 2920 0000 F30F1EFA 		endbr64
 2921 0004 55       		pushq	%rbp
 2922              	.LCFI84:
 2923              		.cfi_def_cfa_offset 16
 2924              		.cfi_offset 6, -16
 2925 0005 4889E5   		movq	%rsp, %rbp
 2926              	.LCFI85:
 2927              		.cfi_def_cfa_register 6
 2928 0008 4883EC20 		subq	$32, %rsp
 2929 000c 48897DE8 		movq	%rdi, -24(%rbp)
 2930              		.loc 1 985 1
 2931 0010 64488B04 		movq	%fs:40, %rax
 2931      25280000 
 2931      00
 2932 0019 488945F8 		movq	%rax, -8(%rbp)
 2933 001d 31C0     		xorl	%eax, %eax
GAS LISTING /tmp/cc1ytava.s 			page 76


 986:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if (defined(SECUREC_COMPATIBLE_LINUX_FORMAT) && !(defined(SECUREC_ON_UNIX)))
 987:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (spec->negative != 0) {
 2934              		.loc 1 987 13
 2935 001f 488B45E8 		movq	-24(%rbp), %rax
 2936 0023 8B4018   		movl	24(%rax), %eax
 2937              		.loc 1 987 8
 2938 0026 85C0     		testl	%eax, %eax
 2939 0028 7440     		je	.L206
 988:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec->numberWidth == SECUREC_NUM_WIDTH_INT) {
 2940              		.loc 1 988 17
 2941 002a 488B45E8 		movq	-24(%rbp), %rax
 2942 002e 8B4010   		movl	16(%rax), %eax
 2943              		.loc 1 988 12
 2944 0031 83F801   		cmpl	$1, %eax
 2945 0034 7517     		jne	.L207
 989:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SecFinishNumberNegativeInt(spec->oriComChr, spec);
 2946              		.loc 1 989 13
 2947 0036 488B45E8 		movq	-24(%rbp), %rax
 2948 003a 8B403C   		movl	60(%rax), %eax
 2949 003d 488B55E8 		movq	-24(%rbp), %rdx
 2950 0041 4889D6   		movq	%rdx, %rsi
 2951 0044 89C7     		movl	%eax, %edi
 2952 0046 E8000000 		call	SecFinishNumberNegativeInt
 2952      00
 990:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         } else {
 991:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SecFinishNumberNegativeOther(spec->oriComChr, spec->numberWidth, spec);
 992:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 993:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else {
 994:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec->numberWidth == SECUREC_NUM_WIDTH_INT) {
 995:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SecFinishNumberPositiveInt(spec->oriComChr, spec);
 996:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         } else {
 997:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SecFinishNumberPositiveOther(spec->oriComChr, spec->numberWidth, spec);
 998:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 999:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1000:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
1001:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (spec->negative != 0) {
1002:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if defined(__hpux)
1003:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec->oriComChr != SECUREC_CHAR('p')) {
1004:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->number = (unsigned long)(-(long)spec->number);
1005:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1006:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
1007:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->number = (unsigned long)(-(long)spec->number);
1008:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1009:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1010:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1011:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return;
 2953              		.loc 1 1011 5
 2954 004b EB5C     		jmp	.L205
 2955              	.L207:
 991:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 2956              		.loc 1 991 13
 2957 004d 488B45E8 		movq	-24(%rbp), %rax
 2958 0051 8B4810   		movl	16(%rax), %ecx
 2959 0054 488B45E8 		movq	-24(%rbp), %rax
 2960 0058 8B403C   		movl	60(%rax), %eax
 2961 005b 488B55E8 		movq	-24(%rbp), %rdx
 2962 005f 89CE     		movl	%ecx, %esi
GAS LISTING /tmp/cc1ytava.s 			page 77


 2963 0061 89C7     		movl	%eax, %edi
 2964 0063 E8000000 		call	SecFinishNumberNegativeOther
 2964      00
 2965              		.loc 1 1011 5
 2966 0068 EB3F     		jmp	.L205
 2967              	.L206:
 994:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SecFinishNumberPositiveInt(spec->oriComChr, spec);
 2968              		.loc 1 994 17
 2969 006a 488B45E8 		movq	-24(%rbp), %rax
 2970 006e 8B4010   		movl	16(%rax), %eax
 994:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SecFinishNumberPositiveInt(spec->oriComChr, spec);
 2971              		.loc 1 994 12
 2972 0071 83F801   		cmpl	$1, %eax
 2973 0074 7517     		jne	.L209
 995:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         } else {
 2974              		.loc 1 995 13
 2975 0076 488B45E8 		movq	-24(%rbp), %rax
 2976 007a 8B403C   		movl	60(%rax), %eax
 2977 007d 488B55E8 		movq	-24(%rbp), %rdx
 2978 0081 4889D6   		movq	%rdx, %rsi
 2979 0084 89C7     		movl	%eax, %edi
 2980 0086 E8000000 		call	SecFinishNumberPositiveInt
 2980      00
 2981              		.loc 1 1011 5
 2982 008b EB1C     		jmp	.L205
 2983              	.L209:
 997:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
 2984              		.loc 1 997 13
 2985 008d 488B45E8 		movq	-24(%rbp), %rax
 2986 0091 8B4810   		movl	16(%rax), %ecx
 2987 0094 488B45E8 		movq	-24(%rbp), %rax
 2988 0098 8B403C   		movl	60(%rax), %eax
 2989 009b 488B55E8 		movq	-24(%rbp), %rdx
 2990 009f 89CE     		movl	%ecx, %esi
 2991 00a1 89C7     		movl	%eax, %edi
 2992 00a3 E8000000 		call	SecFinishNumberPositiveOther
 2992      00
 2993              		.loc 1 1011 5
 2994 00a8 90       		nop
 2995              	.L205:
1012:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 2996              		.loc 1 1012 1
 2997 00a9 488B45F8 		movq	-8(%rbp), %rax
 2998 00ad 64483304 		xorq	%fs:40, %rax
 2998      25280000 
 2998      00
 2999 00b6 7405     		je	.L211
 3000 00b8 E8000000 		call	__stack_chk_fail@PLT
 3000      00
 3001              	.L211:
 3002 00bd C9       		leave
 3003              	.LCFI86:
 3004              		.cfi_def_cfa 7, 8
 3005 00be C3       		ret
 3006              		.cfi_endproc
 3007              	.LFE34:
 3009              		.section	.text.SecFinishNumber64,"ax",@progbits
GAS LISTING /tmp/cc1ytava.s 			page 78


 3011              	SecFinishNumber64:
 3012              	.LFB35:
1013:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1014:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
1015:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * Complete the final 64-bit integer formatted input
1016:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
1017:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecFinishNumber64(SecScanSpec *spec)
1018:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 3013              		.loc 1 1018 1
 3014              		.cfi_startproc
 3015 0000 F30F1EFA 		endbr64
 3016 0004 55       		pushq	%rbp
 3017              	.LCFI87:
 3018              		.cfi_def_cfa_offset 16
 3019              		.cfi_offset 6, -16
 3020 0005 4889E5   		movq	%rsp, %rbp
 3021              	.LCFI88:
 3022              		.cfi_def_cfa_register 6
 3023 0008 4883EC20 		subq	$32, %rsp
 3024 000c 48897DE8 		movq	%rdi, -24(%rbp)
 3025              		.loc 1 1018 1
 3026 0010 64488B04 		movq	%fs:40, %rax
 3026      25280000 
 3026      00
 3027 0019 488945F8 		movq	%rax, -8(%rbp)
 3028 001d 31C0     		xorl	%eax, %eax
1019:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if (defined(SECUREC_COMPATIBLE_LINUX_FORMAT) && !(defined(SECUREC_ON_UNIX)))
1020:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (spec->negative != 0) {
 3029              		.loc 1 1020 13
 3030 001f 488B45E8 		movq	-24(%rbp), %rax
 3031 0023 8B4018   		movl	24(%rax), %eax
 3032              		.loc 1 1020 8
 3033 0026 85C0     		testl	%eax, %eax
 3034 0028 0F84A600 		je	.L213
 3034      0000
1021:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec->oriComChr == (SECUREC_CHAR('d')) || (spec->oriComChr == SECUREC_CHAR('i'))) {
 3035              		.loc 1 1021 17
 3036 002e 488B45E8 		movq	-24(%rbp), %rax
 3037 0032 8B403C   		movl	60(%rax), %eax
 3038              		.loc 1 1021 12
 3039 0035 83F864   		cmpl	$100, %eax
 3040 0038 740C     		je	.L214
 3041              		.loc 1 1021 60 discriminator 1
 3042 003a 488B45E8 		movq	-24(%rbp), %rax
 3043 003e 8B403C   		movl	60(%rax), %eax
 3044              		.loc 1 1021 52 discriminator 1
 3045 0041 83F869   		cmpl	$105, %eax
 3046 0044 7562     		jne	.L215
 3047              	.L214:
1022:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (spec->number64 > SECUREC_MIN_64BITS_NEG_VALUE) {
 3048              		.loc 1 1022 21
 3049 0046 488B45E8 		movq	-24(%rbp), %rax
 3050 004a 488B00   		movq	(%rax), %rax
 3051              		.loc 1 1022 16
 3052 004d 48BA0000 		movabsq	$-9223372036854775808, %rdx
 3052      00000000 
 3052      0080
GAS LISTING /tmp/cc1ytava.s 			page 79


 3053 0057 4839D0   		cmpq	%rdx, %rax
 3054 005a 7613     		jbe	.L216
1023:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number64 = SECUREC_MIN_64BITS_NEG_VALUE;
 3055              		.loc 1 1023 32
 3056 005c 488B45E8 		movq	-24(%rbp), %rax
 3057 0060 48B90000 		movabsq	$-9223372036854775808, %rcx
 3057      00000000 
 3057      0080
 3058 006a 488908   		movq	%rcx, (%rax)
 3059 006d EB14     		jmp	.L217
 3060              	.L216:
1024:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             } else {
1025:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number64 = (SecUnsignedInt64)(-(SecInt64)spec->number64);
 3061              		.loc 1 1025 68
 3062 006f 488B45E8 		movq	-24(%rbp), %rax
 3063 0073 488B00   		movq	(%rax), %rax
 3064              		.loc 1 1025 53
 3065 0076 48F7D8   		negq	%rax
 3066              		.loc 1 1025 34
 3067 0079 4889C2   		movq	%rax, %rdx
 3068              		.loc 1 1025 32
 3069 007c 488B45E8 		movq	-24(%rbp), %rax
 3070 0080 488910   		movq	%rdx, (%rax)
 3071              	.L217:
1026:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1027:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (spec->beyondMax != 0) {
 3072              		.loc 1 1027 21
 3073 0083 488B45E8 		movq	-24(%rbp), %rax
 3074 0087 8B401C   		movl	28(%rax), %eax
 3075              		.loc 1 1027 16
 3076 008a 85C0     		testl	%eax, %eax
 3077 008c 0F84AB00 		je	.L220
 3077      0000
1028:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number64 = SECUREC_MIN_64BITS_NEG_VALUE;
 3078              		.loc 1 1028 32
 3079 0092 488B45E8 		movq	-24(%rbp), %rax
 3080 0096 48BE0000 		movabsq	$-9223372036854775808, %rsi
 3080      00000000 
 3080      0080
 3081 00a0 488930   		movq	%rsi, (%rax)
1027:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number64 = SECUREC_MIN_64BITS_NEG_VALUE;
 3082              		.loc 1 1027 16
 3083 00a3 E9950000 		jmp	.L220
 3083      00
 3084              	.L215:
1029:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1030:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         } else {                /* o, u, x, X, p */
1031:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->number64 = (SecUnsignedInt64)(-(SecInt64)spec->number64);
 3085              		.loc 1 1031 64
 3086 00a8 488B45E8 		movq	-24(%rbp), %rax
 3087 00ac 488B00   		movq	(%rax), %rax
 3088              		.loc 1 1031 49
 3089 00af 48F7D8   		negq	%rax
 3090              		.loc 1 1031 30
 3091 00b2 4889C2   		movq	%rax, %rdx
 3092              		.loc 1 1031 28
 3093 00b5 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/cc1ytava.s 			page 80


 3094 00b9 488910   		movq	%rdx, (%rax)
1032:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (spec->beyondMax != 0) {
 3095              		.loc 1 1032 21
 3096 00bc 488B45E8 		movq	-24(%rbp), %rax
 3097 00c0 8B401C   		movl	28(%rax), %eax
 3098              		.loc 1 1032 16
 3099 00c3 85C0     		testl	%eax, %eax
 3100 00c5 7477     		je	.L227
1033:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number64 = SECUREC_MAX_64BITS_VALUE;
 3101              		.loc 1 1033 32
 3102 00c7 488B45E8 		movq	-24(%rbp), %rax
 3103 00cb 48C700FF 		movq	$-1, (%rax)
 3103      FFFFFF
1034:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1035:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1036:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else {
1037:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if ((spec->oriComChr == SECUREC_CHAR('d')) || (spec->oriComChr == SECUREC_CHAR('i'))) {
1038:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (spec->number64 > SECUREC_MAX_64BITS_POS_VALUE) {
1039:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number64 = SECUREC_MAX_64BITS_POS_VALUE;
1040:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1041:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (spec->beyondMax != 0) {
1042:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number64 = SECUREC_MAX_64BITS_POS_VALUE;
1043:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1044:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         } else {
1045:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (spec->beyondMax != 0) {
1046:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number64 = SECUREC_MAX_64BITS_VALUE;
1047:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1048:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1049:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1050:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
1051:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (spec->negative != 0) {
1052:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if defined(__hpux)
1053:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec->oriComChr != SECUREC_CHAR('p')) {
1054:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->number64 = (SecUnsignedInt64)(-(SecInt64)spec->number64);
1055:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1056:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
1057:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->number64 = (SecUnsignedInt64)(-(SecInt64)spec->number64);
1058:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1059:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1060:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1061:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return;
 3104              		.loc 1 1061 5
 3105 00d2 EB6A     		jmp	.L227
 3106              	.L213:
1037:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (spec->number64 > SECUREC_MAX_64BITS_POS_VALUE) {
 3107              		.loc 1 1037 18
 3108 00d4 488B45E8 		movq	-24(%rbp), %rax
 3109 00d8 8B403C   		movl	60(%rax), %eax
1037:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (spec->number64 > SECUREC_MAX_64BITS_POS_VALUE) {
 3110              		.loc 1 1037 12
 3111 00db 83F864   		cmpl	$100, %eax
 3112 00de 740C     		je	.L221
1037:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (spec->number64 > SECUREC_MAX_64BITS_POS_VALUE) {
 3113              		.loc 1 1037 60 discriminator 1
 3114 00e0 488B45E8 		movq	-24(%rbp), %rax
 3115 00e4 8B403C   		movl	60(%rax), %eax
1037:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (spec->number64 > SECUREC_MAX_64BITS_POS_VALUE) {
GAS LISTING /tmp/cc1ytava.s 			page 81


 3116              		.loc 1 1037 52 discriminator 1
 3117 00e7 83F869   		cmpl	$105, %eax
 3118 00ea 753B     		jne	.L222
 3119              	.L221:
1038:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number64 = SECUREC_MAX_64BITS_POS_VALUE;
 3120              		.loc 1 1038 21
 3121 00ec 488B45E8 		movq	-24(%rbp), %rax
 3122 00f0 488B00   		movq	(%rax), %rax
1038:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number64 = SECUREC_MAX_64BITS_POS_VALUE;
 3123              		.loc 1 1038 16
 3124 00f3 4885C0   		testq	%rax, %rax
 3125 00f6 7911     		jns	.L223
1039:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
 3126              		.loc 1 1039 32
 3127 00f8 488B45E8 		movq	-24(%rbp), %rax
 3128 00fc 48BFFFFF 		movabsq	$9223372036854775807, %rdi
 3128      FFFFFFFF 
 3128      FF7F
 3129 0106 488938   		movq	%rdi, (%rax)
 3130              	.L223:
1041:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number64 = SECUREC_MAX_64BITS_POS_VALUE;
 3131              		.loc 1 1041 21
 3132 0109 488B45E8 		movq	-24(%rbp), %rax
 3133 010d 8B401C   		movl	28(%rax), %eax
1041:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number64 = SECUREC_MAX_64BITS_POS_VALUE;
 3134              		.loc 1 1041 16
 3135 0110 85C0     		testl	%eax, %eax
 3136 0112 7429     		je	.L220
1042:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
 3137              		.loc 1 1042 32
 3138 0114 488B45E8 		movq	-24(%rbp), %rax
 3139 0118 48B9FFFF 		movabsq	$9223372036854775807, %rcx
 3139      FFFFFFFF 
 3139      FF7F
 3140 0122 488908   		movq	%rcx, (%rax)
1041:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number64 = SECUREC_MAX_64BITS_POS_VALUE;
 3141              		.loc 1 1041 16
 3142 0125 EB16     		jmp	.L220
 3143              	.L222:
1045:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number64 = SECUREC_MAX_64BITS_VALUE;
 3144              		.loc 1 1045 21
 3145 0127 488B45E8 		movq	-24(%rbp), %rax
 3146 012b 8B401C   		movl	28(%rax), %eax
1045:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->number64 = SECUREC_MAX_64BITS_VALUE;
 3147              		.loc 1 1045 16
 3148 012e 85C0     		testl	%eax, %eax
 3149 0130 740C     		je	.L227
1046:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
 3150              		.loc 1 1046 32
 3151 0132 488B45E8 		movq	-24(%rbp), %rax
 3152 0136 48C700FF 		movq	$-1, (%rax)
 3152      FFFFFF
 3153              	.L220:
 3154              		.loc 1 1061 5 discriminator 2
 3155 013d 90       		nop
 3156              	.L227:
 3157              		.loc 1 1061 5 is_stmt 0
GAS LISTING /tmp/cc1ytava.s 			page 82


 3158 013e 90       		nop
1062:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 3159              		.loc 1 1062 1 is_stmt 1
 3160 013f 488B45F8 		movq	-8(%rbp), %rax
 3161 0143 64483304 		xorq	%fs:40, %rax
 3161      25280000 
 3161      00
 3162 014c 7405     		je	.L226
 3163 014e E8000000 		call	__stack_chk_fail@PLT
 3163      00
 3164              	.L226:
 3165 0153 C9       		leave
 3166              	.LCFI89:
 3167              		.cfi_def_cfa 7, 8
 3168 0154 C3       		ret
 3169              		.cfi_endproc
 3170              	.LFE35:
 3172              		.section	.data.rel.local.g_secFinishNumber,"aw"
 3173              		.align 16
 3176              	g_secFinishNumber:
 3177 0000 00000000 		.quad	SecFinishNumber
 3177      00000000 
 3178 0008 00000000 		.quad	SecFinishNumber64
 3178      00000000 
 3179              		.section	.text.SecSeekStream,"ax",@progbits
 3181              	SecSeekStream:
 3182              	.LFB36:
1063:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void (*g_secFinishNumber[SECUREC_DECODE_NUMBER_FUNC_NUM])(SecScanSpec *spec) = \
1064:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     { SecFinishNumber, SecFinishNumber64 };
1065:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1066:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if SECUREC_ENABLE_SCANF_FILE
1067:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1068:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
1069:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  *  Adjust the pointer position of the file stream
1070:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
1071:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecSeekStream(SecFileStream *stream)
1072:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 3183              		.loc 1 1072 1
 3184              		.cfi_startproc
 3185 0000 F30F1EFA 		endbr64
 3186 0004 55       		pushq	%rbp
 3187              	.LCFI90:
 3188              		.cfi_def_cfa_offset 16
 3189              		.cfi_offset 6, -16
 3190 0005 4889E5   		movq	%rsp, %rbp
 3191              	.LCFI91:
 3192              		.cfi_def_cfa_register 6
 3193 0008 4883EC20 		subq	$32, %rsp
 3194 000c 48897DE8 		movq	%rdi, -24(%rbp)
 3195              		.loc 1 1072 1
 3196 0010 64488B04 		movq	%fs:40, %rax
 3196      25280000 
 3196      00
 3197 0019 488945F8 		movq	%rax, -8(%rbp)
 3198 001d 31C0     		xorl	%eax, %eax
1073:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if ((stream->count == 0) && feof(stream->pf)) {
 3199              		.loc 1 1073 16
GAS LISTING /tmp/cc1ytava.s 			page 83


 3200 001f 488B45E8 		movq	-24(%rbp), %rax
 3201 0023 8B4004   		movl	4(%rax), %eax
 3202              		.loc 1 1073 8
 3203 0026 85C0     		testl	%eax, %eax
 3204 0028 7521     		jne	.L229
 3205              		.loc 1 1073 33 discriminator 1
 3206 002a 488B45E8 		movq	-24(%rbp), %rax
 3207 002e 488B4018 		movq	24(%rax), %rax
 3208 0032 4889C7   		movq	%rax, %rdi
 3209 0035 E8000000 		call	feof@PLT
 3209      00
 3210              		.loc 1 1073 30 discriminator 1
 3211 003a 85C0     		testl	%eax, %eax
 3212 003c 740D     		je	.L229
1074:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* file pointer at the end of file, don't need to seek back */
1075:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         stream->base[0] = '\0';
 3213              		.loc 1 1075 15
 3214 003e 488B45E8 		movq	-24(%rbp), %rax
 3215 0042 488B4010 		movq	16(%rax), %rax
 3216              		.loc 1 1075 25
 3217 0046 C60000   		movb	$0, (%rax)
1076:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return;
 3218              		.loc 1 1076 9
 3219 0049 EB7B     		jmp	.L228
 3220              	.L229:
1077:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1078:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     /* LSD seek to original position, bug fix 2014 1 21 */
1079:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (fseek(stream->pf, stream->oriFilePos, SEEK_SET)) {
 3221              		.loc 1 1079 9
 3222 004b 488B45E8 		movq	-24(%rbp), %rax
 3223 004f 488B4820 		movq	32(%rax), %rcx
 3224 0053 488B45E8 		movq	-24(%rbp), %rax
 3225 0057 488B4018 		movq	24(%rax), %rax
 3226 005b BA000000 		movl	$0, %edx
 3226      00
 3227 0060 4889CE   		movq	%rcx, %rsi
 3228 0063 4889C7   		movq	%rax, %rdi
 3229 0066 E8000000 		call	fseek@PLT
 3229      00
 3230              		.loc 1 1079 8
 3231 006b 85C0     		testl	%eax, %eax
 3232 006d 740E     		je	.L231
1080:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* seek failed, ignore it */
1081:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         stream->oriFilePos = 0;
 3233              		.loc 1 1081 28
 3234 006f 488B45E8 		movq	-24(%rbp), %rax
 3235 0073 48C74020 		movq	$0, 32(%rax)
 3235      00000000 
1082:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return;
 3236              		.loc 1 1082 9
 3237 007b EB49     		jmp	.L228
 3238              	.L231:
1083:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1084:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1085:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (stream->fileRealRead > 0) { /* LSD bug fix. when file reach to EOF, don't seek back */
 3239              		.loc 1 1085 15
 3240 007d 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/cc1ytava.s 			page 84


 3241 0081 8B4028   		movl	40(%rax), %eax
 3242              		.loc 1 1085 8
 3243 0084 85C0     		testl	%eax, %eax
 3244 0086 7E3D     		jle	.L234
1086:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if (defined(SECUREC_COMPATIBLE_WIN_FORMAT))
1087:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         int loops;
1088:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         for (loops = 0; loops < (stream->fileRealRead / SECUREC_BUFFERED_BLOK_SIZE); ++loops) {
1089:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (fread(stream->base, (size_t)1, (size_t)SECUREC_BUFFERED_BLOK_SIZE,
1090:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 stream->pf) != SECUREC_BUFFERED_BLOK_SIZE) {
1091:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 break;
1092:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1093:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1094:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if ((stream->fileRealRead % SECUREC_BUFFERED_BLOK_SIZE) != 0) {
1095:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             size_t ret = fread(stream->base, (size_t)((unsigned int)stream->fileRealRead % SECUREC_
1096:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                                (size_t)1, stream->pf);
1097:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if ((ret == 1 || ret == 0) && (ftell(stream->pf) < stream->oriFilePos + stream->fileRea
1098:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 (void)fseek(stream->pf, stream->oriFilePos + stream->fileRealRead, SEEK_SET);
1099:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1100:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1101:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1102:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
1103:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* in linux like system */
1104:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (fseek(stream->pf, stream->oriFilePos + stream->fileRealRead, SEEK_SET)) {
 3245              		.loc 1 1104 37
 3246 0088 488B45E8 		movq	-24(%rbp), %rax
 3247 008c 488B5020 		movq	32(%rax), %rdx
 3248              		.loc 1 1104 58
 3249 0090 488B45E8 		movq	-24(%rbp), %rax
 3250 0094 8B4028   		movl	40(%rax), %eax
 3251 0097 4898     		cltq
 3252              		.loc 1 1104 13
 3253 0099 488D0C02 		leaq	(%rdx,%rax), %rcx
 3254 009d 488B45E8 		movq	-24(%rbp), %rax
 3255 00a1 488B4018 		movq	24(%rax), %rax
 3256 00a5 BA000000 		movl	$0, %edx
 3256      00
 3257 00aa 4889CE   		movq	%rcx, %rsi
 3258 00ad 4889C7   		movq	%rax, %rdi
 3259 00b0 E8000000 		call	fseek@PLT
 3259      00
 3260              		.loc 1 1104 12
 3261 00b5 85C0     		testl	%eax, %eax
 3262 00b7 740C     		je	.L234
1105:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             /* seek failed, ignore it */
1106:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             stream->oriFilePos = 0;
 3263              		.loc 1 1106 32
 3264 00b9 488B45E8 		movq	-24(%rbp), %rax
 3265 00bd 48C74020 		movq	$0, 32(%rax)
 3265      00000000 
 3266              	.L234:
1107:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1108:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1109:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1110:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1111:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return;
 3267              		.loc 1 1111 5
 3268 00c5 90       		nop
GAS LISTING /tmp/cc1ytava.s 			page 85


 3269              	.L228:
1112:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 3270              		.loc 1 1112 1
 3271 00c6 488B45F8 		movq	-8(%rbp), %rax
 3272 00ca 64483304 		xorq	%fs:40, %rax
 3272      25280000 
 3272      00
 3273 00d3 7405     		je	.L233
 3274 00d5 E8000000 		call	__stack_chk_fail@PLT
 3274      00
 3275              	.L233:
 3276 00da C9       		leave
 3277              	.LCFI92:
 3278              		.cfi_def_cfa 7, 8
 3279 00db C3       		ret
 3280              		.cfi_endproc
 3281              	.LFE36:
 3283              		.section	.text.SecAdjustStream,"ax",@progbits
 3285              	SecAdjustStream:
 3286              	.LFB37:
1113:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1114:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
1115:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  *  Adjust the pointer position of the file stream and free memory
1116:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
1117:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecAdjustStream(SecFileStream *stream)
1118:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 3287              		.loc 1 1118 1
 3288              		.cfi_startproc
 3289 0000 F30F1EFA 		endbr64
 3290 0004 55       		pushq	%rbp
 3291              	.LCFI93:
 3292              		.cfi_def_cfa_offset 16
 3293              		.cfi_offset 6, -16
 3294 0005 4889E5   		movq	%rsp, %rbp
 3295              	.LCFI94:
 3296              		.cfi_def_cfa_register 6
 3297 0008 4883EC20 		subq	$32, %rsp
 3298 000c 48897DE8 		movq	%rdi, -24(%rbp)
 3299              		.loc 1 1118 1
 3300 0010 64488B04 		movq	%fs:40, %rax
 3300      25280000 
 3300      00
 3301 0019 488945F8 		movq	%rax, -8(%rbp)
 3302 001d 31C0     		xorl	%eax, %eax
1119:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (stream != NULL && (stream->flag & SECUREC_FILE_STREAM_FLAG) && stream->base != NULL) {
 3303              		.loc 1 1119 8
 3304 001f 48837DE8 		cmpq	$0, -24(%rbp)
 3304      00
 3305 0024 7443     		je	.L239
 3306              		.loc 1 1119 34 discriminator 1
 3307 0026 488B45E8 		movq	-24(%rbp), %rax
 3308 002a 8B00     		movl	(%rax), %eax
 3309              		.loc 1 1119 41 discriminator 1
 3310 002c 83E002   		andl	$2, %eax
 3311              		.loc 1 1119 24 discriminator 1
 3312 002f 85C0     		testl	%eax, %eax
 3313 0031 7436     		je	.L239
GAS LISTING /tmp/cc1ytava.s 			page 86


 3314              		.loc 1 1119 78 discriminator 2
 3315 0033 488B45E8 		movq	-24(%rbp), %rax
 3316 0037 488B4010 		movq	16(%rax), %rax
 3317              		.loc 1 1119 69 discriminator 2
 3318 003b 4885C0   		testq	%rax, %rax
 3319 003e 7429     		je	.L239
1120:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SecSeekStream(stream);
 3320              		.loc 1 1120 9
 3321 0040 488B45E8 		movq	-24(%rbp), %rax
 3322 0044 4889C7   		movq	%rax, %rdi
 3323 0047 E8000000 		call	SecSeekStream
 3323      00
1121:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SECUREC_FREE(stream->base);
 3324              		.loc 1 1121 9
 3325 004c 488B45E8 		movq	-24(%rbp), %rax
 3326 0050 488B4010 		movq	16(%rax), %rax
 3327 0054 4889C7   		movq	%rax, %rdi
 3328 0057 E8000000 		call	free@PLT
 3328      00
1122:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         stream->base = NULL;
 3329              		.loc 1 1122 22
 3330 005c 488B45E8 		movq	-24(%rbp), %rax
 3331 0060 48C74010 		movq	$0, 16(%rax)
 3331      00000000 
1123:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1124:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return;
 3332              		.loc 1 1124 5
 3333 0068 90       		nop
 3334              	.L239:
 3335 0069 90       		nop
1125:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 3336              		.loc 1 1125 1
 3337 006a 488B45F8 		movq	-8(%rbp), %rax
 3338 006e 64483304 		xorq	%fs:40, %rax
 3338      25280000 
 3338      00
 3339 0077 7405     		je	.L238
 3340 0079 E8000000 		call	__stack_chk_fail@PLT
 3340      00
 3341              	.L238:
 3342 007e C9       		leave
 3343              	.LCFI95:
 3344              		.cfi_def_cfa 7, 8
 3345 007f C3       		ret
 3346              		.cfi_endproc
 3347              	.LFE37:
 3349              		.section	.text.SecSkipSpaceFormat,"ax",@progbits
 3351              	SecSkipSpaceFormat:
 3352              	.LFB38:
1126:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1127:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1128:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecSkipSpaceFormat(const SecUnsignedChar **format)
1129:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 3353              		.loc 1 1129 1
 3354              		.cfi_startproc
 3355 0000 F30F1EFA 		endbr64
 3356 0004 55       		pushq	%rbp
GAS LISTING /tmp/cc1ytava.s 			page 87


 3357              	.LCFI96:
 3358              		.cfi_def_cfa_offset 16
 3359              		.cfi_offset 6, -16
 3360 0005 4889E5   		movq	%rsp, %rbp
 3361              	.LCFI97:
 3362              		.cfi_def_cfa_register 6
 3363 0008 4883EC20 		subq	$32, %rsp
 3364 000c 48897DE8 		movq	%rdi, -24(%rbp)
 3365              		.loc 1 1129 1
 3366 0010 64488B04 		movq	%fs:40, %rax
 3366      25280000 
 3366      00
 3367 0019 488945F8 		movq	%rax, -8(%rbp)
 3368 001d 31C0     		xorl	%eax, %eax
1130:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     const SecUnsignedChar *fmt = *format;
 3369              		.loc 1 1130 28
 3370 001f 488B45E8 		movq	-24(%rbp), %rax
 3371 0023 488B00   		movq	(%rax), %rax
 3372 0026 488945F0 		movq	%rax, -16(%rbp)
1131:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     while (SECUREC_IS_SPACE(*fmt)) {
 3373              		.loc 1 1131 11
 3374 002a EB05     		jmp	.L241
 3375              	.L242:
1132:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ++fmt;
 3376              		.loc 1 1132 9
 3377 002c 488345F0 		addq	$4, -16(%rbp)
 3377      04
 3378              	.L241:
1131:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     while (SECUREC_IS_SPACE(*fmt)) {
 3379              		.loc 1 1131 12
 3380 0031 488B45F0 		movq	-16(%rbp), %rax
 3381 0035 8B00     		movl	(%rax), %eax
 3382 0037 89C7     		movl	%eax, %edi
 3383 0039 E8000000 		call	iswspace@PLT
 3383      00
1131:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     while (SECUREC_IS_SPACE(*fmt)) {
 3384              		.loc 1 1131 11
 3385 003e 85C0     		testl	%eax, %eax
 3386 0040 75EA     		jne	.L242
1133:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1134:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     *format = fmt;
 3387              		.loc 1 1134 13
 3388 0042 488B45E8 		movq	-24(%rbp), %rax
 3389 0046 488B55F0 		movq	-16(%rbp), %rdx
 3390 004a 488910   		movq	%rdx, (%rax)
1135:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 3391              		.loc 1 1135 1
 3392 004d 90       		nop
 3393 004e 488B45F8 		movq	-8(%rbp), %rax
 3394 0052 64483304 		xorq	%fs:40, %rax
 3394      25280000 
 3394      00
 3395 005b 7405     		je	.L243
 3396 005d E8000000 		call	__stack_chk_fail@PLT
 3396      00
 3397              	.L243:
 3398 0062 C9       		leave
GAS LISTING /tmp/cc1ytava.s 			page 88


 3399              	.LCFI98:
 3400              		.cfi_def_cfa 7, 8
 3401 0063 C3       		ret
 3402              		.cfi_endproc
 3403              	.LFE38:
 3405              		.section	.text.SecSetupBracketTable,"ax",@progbits
 3407              	SecSetupBracketTable:
 3408              	.LFB39:
1136:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifndef SECUREC_FOR_WCHAR
1137:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
1138:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * Handling multi-character characters
1139:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
1140:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static int SecDecodeLeadByte(SecInt ch, const SecUnsignedChar **format, SecFileStream *stream, int 
1141:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
1142:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if SECUREC_HAVE_MBTOWC
1143:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     char temp[SECUREC_MULTI_BYTE_MAX_LEN];
1144:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     const SecUnsignedChar *fmt = *format;
1145:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     wchar_t tempWChar = L'\0';
1146:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     int ch2 = SecGetChar(stream, counter);
1147:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (*fmt == SECUREC_CHAR('\0') || (int)(*fmt) != (ch2)) {
1148:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* LSD in console mode, ungetc twice may cause problem */
1149:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SecUnGetChar(ch2, stream, counter);
1150:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SecUnGetChar(ch, stream, counter);
1151:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return -1;
1152:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1153:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     ++fmt;
1154:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (MB_CUR_MAX >= SECUREC_UTF8_BOM_HEADER_SIZE &&
1155:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         (((unsigned char)ch & SECUREC_UTF8_LEAD_1ST) == SECUREC_UTF8_LEAD_1ST) &&
1156:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         (((unsigned char)ch2 & SECUREC_UTF8_LEAD_2ND) == SECUREC_UTF8_LEAD_2ND)) {
1157:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* this char is very likely to be a UTF-8 char */
1158:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         int ch3 = SecGetChar(stream, counter);
1159:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         temp[0] = (char)ch;
1160:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         temp[1] = (char)ch2; /* 1 index of second character */
1161:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         temp[2] = (char)ch3; /* 2 index of third character */
1162:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         temp[3] = '\0';      /* 3 of string terminator position */
1163:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1164:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (mbtowc(&tempWChar, temp, sizeof(temp)) > 0) {
1165:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             /* succeed */
1166:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (*fmt == SECUREC_CHAR('\0') || (int)(*fmt) != (int)ch3) {
1167:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 SecUnGetChar(ch3, stream, counter);
1168:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 return -1;
1169:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1170:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             ++fmt;
1171:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             *counter = *counter - 1;
1172:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         } else {
1173:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SecUnGetChar(ch3, stream, counter);
1174:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1175:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1176:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     *counter = *counter - 1;    /* only count as one character read */
1177:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     *format = fmt;
1178:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return 0;
1179:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
1180:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecUnGetChar(ch, stream, counter);
1181:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     (void)format;
1182:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return -1;
1183:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1184:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
GAS LISTING /tmp/cc1ytava.s 			page 89


1185:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1186:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1187:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1188:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1189:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
1190:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  *  Resolving sequence of characters from %[ format
1191:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
1192:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static int SecSetupBracketTable(const SecUnsignedChar **format, SecBracketTable *bracketTable)
1193:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 3409              		.loc 1 1193 1
 3410              		.cfi_startproc
 3411 0000 F30F1EFA 		endbr64
 3412 0004 55       		pushq	%rbp
 3413              	.LCFI99:
 3414              		.cfi_def_cfa_offset 16
 3415              		.cfi_offset 6, -16
 3416 0005 4889E5   		movq	%rsp, %rbp
 3417              	.LCFI100:
 3418              		.cfi_def_cfa_register 6
 3419 0008 4883EC60 		subq	$96, %rsp
 3420 000c 48897DA8 		movq	%rdi, -88(%rbp)
 3421 0010 488975A0 		movq	%rsi, -96(%rbp)
 3422              		.loc 1 1193 1
 3423 0014 64488B04 		movq	%fs:40, %rax
 3423      25280000 
 3423      00
 3424 001d 488945F8 		movq	%rax, -8(%rbp)
 3425 0021 31C0     		xorl	%eax, %eax
1194:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     const SecUnsignedChar *fmt = *format;
 3426              		.loc 1 1194 28
 3427 0023 488B45A8 		movq	-88(%rbp), %rax
 3428 0027 488B00   		movq	(%rax), %rax
 3429 002a 488945F0 		movq	%rax, -16(%rbp)
1195:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecUnsignedChar prevChar = 0;
 3430              		.loc 1 1195 21
 3431 002e C745B400 		movl	$0, -76(%rbp)
 3431      000000
1196:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecUnsignedChar expCh;
1197:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecUnsignedChar last = 0;
 3432              		.loc 1 1197 21
 3433 0035 C745BC00 		movl	$0, -68(%rbp)
 3433      000000
1198:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if !(defined(SECUREC_COMPATIBLE_WIN_FORMAT))
1199:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (*fmt == SECUREC_CHAR('{')) {
 3434              		.loc 1 1199 9
 3435 003c 488B45F0 		movq	-16(%rbp), %rax
 3436 0040 8B00     		movl	(%rax), %eax
 3437              		.loc 1 1199 8
 3438 0042 83F87B   		cmpl	$123, %eax
 3439 0045 750A     		jne	.L245
1200:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return -1;
 3440              		.loc 1 1200 16
 3441 0047 B8FFFFFF 		movl	$-1, %eax
 3441      FF
 3442 004c E9890200 		jmp	.L246
 3442      00
 3443              	.L245:
GAS LISTING /tmp/cc1ytava.s 			page 90


1201:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1202:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1203:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     /* for building "table" data */
1204:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     ++fmt; /* skip [ */
 3444              		.loc 1 1204 5
 3445 0051 488345F0 		addq	$4, -16(%rbp)
 3445      04
1205:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     bracketTable->mask = 0;
 3446              		.loc 1 1205 24
 3447 0056 488B45A0 		movq	-96(%rbp), %rax
 3448 005a C6400800 		movb	$0, 8(%rax)
1206:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (*fmt == SECUREC_CHAR('^')) {
 3449              		.loc 1 1206 9
 3450 005e 488B45F0 		movq	-16(%rbp), %rax
 3451 0062 8B00     		movl	(%rax), %eax
 3452              		.loc 1 1206 8
 3453 0064 83F85E   		cmpl	$94, %eax
 3454 0067 750D     		jne	.L247
1207:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ++fmt;
 3455              		.loc 1 1207 9
 3456 0069 488345F0 		addq	$4, -16(%rbp)
 3456      04
1208:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         bracketTable->mask = (unsigned char)0xff;
 3457              		.loc 1 1208 28
 3458 006e 488B45A0 		movq	-96(%rbp), %rax
 3459 0072 C64008FF 		movb	$-1, 8(%rax)
 3460              	.L247:
1209:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1210:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (*fmt == SECUREC_CHAR(']')) {
 3461              		.loc 1 1210 9
 3462 0076 488B45F0 		movq	-16(%rbp), %rax
 3463 007a 8B00     		movl	(%rax), %eax
 3464              		.loc 1 1210 8
 3465 007c 83F85D   		cmpl	$93, %eax
 3466 007f 0F852C02 		jne	.L249
 3466      0000
1211:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         prevChar = SECUREC_CHAR(']');
 3467              		.loc 1 1211 18
 3468 0085 C745B45D 		movl	$93, -76(%rbp)
 3468      000000
1212:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ++fmt;
 3469              		.loc 1 1212 9
 3470 008c 488345F0 		addq	$4, -16(%rbp)
 3470      04
 3471              	.LBB10:
1213:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SECUREC_BRACKET_SET_BIT(bracketTable->table, SECUREC_CHAR(']'));
 3472              		.loc 1 1213 9
 3473 0091 C745C00B 		movl	$11, -64(%rbp)
 3473      000000
 3474 0098 C745C420 		movl	$32, -60(%rbp)
 3474      000000
 3475 009f 488B45A0 		movq	-96(%rbp), %rax
 3476 00a3 488B10   		movq	(%rax), %rdx
 3477 00a6 8B45C0   		movl	-64(%rbp), %eax
 3478 00a9 4801D0   		addq	%rdx, %rax
 3479 00ac 0FB608   		movzbl	(%rax), %ecx
 3480 00af 8B45C4   		movl	-60(%rbp), %eax
GAS LISTING /tmp/cc1ytava.s 			page 91


 3481 00b2 89C6     		movl	%eax, %esi
 3482 00b4 488B45A0 		movq	-96(%rbp), %rax
 3483 00b8 488B10   		movq	(%rax), %rdx
 3484 00bb 8B45C0   		movl	-64(%rbp), %eax
 3485 00be 4801D0   		addq	%rdx, %rax
 3486 00c1 09F1     		orl	%esi, %ecx
 3487 00c3 89CA     		movl	%ecx, %edx
 3488 00c5 8810     		movb	%dl, (%rax)
 3489              	.LBE10:
1214:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1215:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     while (*fmt != SECUREC_CHAR('\0') && *fmt != SECUREC_CHAR(']')) {
 3490              		.loc 1 1215 11
 3491 00c7 E9E50100 		jmp	.L249
 3491      00
 3492              	.L257:
1216:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         expCh = *fmt++;
 3493              		.loc 1 1216 21
 3494 00cc 488B45F0 		movq	-16(%rbp), %rax
 3495 00d0 488D5004 		leaq	4(%rax), %rdx
 3496 00d4 488955F0 		movq	%rdx, -16(%rbp)
 3497              		.loc 1 1216 15
 3498 00d8 8B00     		movl	(%rax), %eax
 3499 00da 8945B8   		movl	%eax, -72(%rbp)
1217:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (expCh != SECUREC_CHAR('-') || prevChar == 0 || *fmt == SECUREC_CHAR(']')) {
 3500              		.loc 1 1217 12
 3501 00dd 837DB82D 		cmpl	$45, -72(%rbp)
 3502 00e1 7511     		jne	.L250
 3503              		.loc 1 1217 40 discriminator 1
 3504 00e3 837DB400 		cmpl	$0, -76(%rbp)
 3505 00e7 740B     		je	.L250
 3506              		.loc 1 1217 60 discriminator 2
 3507 00e9 488B45F0 		movq	-16(%rbp), %rax
 3508 00ed 8B00     		movl	(%rax), %eax
 3509              		.loc 1 1217 57 discriminator 2
 3510 00ef 83F85D   		cmpl	$93, %eax
 3511 00f2 7558     		jne	.L251
 3512              	.L250:
1218:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             /* normal character */
1219:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             prevChar = expCh;
 3513              		.loc 1 1219 22
 3514 00f4 8B45B8   		movl	-72(%rbp), %eax
 3515 00f7 8945B4   		movl	%eax, -76(%rbp)
 3516              	.LBB11:
1220:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SECUREC_BRACKET_SET_BIT(bracketTable->table, expCh);
 3517              		.loc 1 1220 13
 3518 00fa 8B45B8   		movl	-72(%rbp), %eax
 3519 00fd C1E803   		shrl	$3, %eax
 3520 0100 25FF1F00 		andl	$8191, %eax
 3520      00
 3521 0105 8945E8   		movl	%eax, -24(%rbp)
 3522 0108 8B45B8   		movl	-72(%rbp), %eax
 3523 010b 83E007   		andl	$7, %eax
 3524 010e BA010000 		movl	$1, %edx
 3524      00
 3525 0113 89C1     		movl	%eax, %ecx
 3526 0115 D3E2     		sall	%cl, %edx
 3527 0117 89D0     		movl	%edx, %eax
GAS LISTING /tmp/cc1ytava.s 			page 92


 3528 0119 0FB6C0   		movzbl	%al, %eax
 3529 011c 8945EC   		movl	%eax, -20(%rbp)
 3530 011f 488B45A0 		movq	-96(%rbp), %rax
 3531 0123 488B10   		movq	(%rax), %rdx
 3532 0126 8B45E8   		movl	-24(%rbp), %eax
 3533 0129 4801D0   		addq	%rdx, %rax
 3534 012c 0FB608   		movzbl	(%rax), %ecx
 3535 012f 8B45EC   		movl	-20(%rbp), %eax
 3536 0132 89C6     		movl	%eax, %esi
 3537 0134 488B45A0 		movq	-96(%rbp), %rax
 3538 0138 488B10   		movq	(%rax), %rdx
 3539 013b 8B45E8   		movl	-24(%rbp), %eax
 3540 013e 4801D0   		addq	%rdx, %rax
 3541 0141 09F1     		orl	%esi, %ecx
 3542 0143 89CA     		movl	%ecx, %edx
 3543 0145 8810     		movb	%dl, (%rax)
 3544              	.LBE11:
 3545 0147 E9650100 		jmp	.L249
 3545      00
 3546              	.L251:
1221:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         } else {
1222:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             /* for %[a-z] */
1223:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             expCh = *fmt++;   /* get end of range */
 3547              		.loc 1 1223 25
 3548 014c 488B45F0 		movq	-16(%rbp), %rax
 3549 0150 488D5004 		leaq	4(%rax), %rdx
 3550 0154 488955F0 		movq	%rdx, -16(%rbp)
 3551              		.loc 1 1223 19
 3552 0158 8B00     		movl	(%rax), %eax
 3553 015a 8945B8   		movl	%eax, -72(%rbp)
1224:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (prevChar < expCh) { /* %[a-z] */
 3554              		.loc 1 1224 16
 3555 015d 8B45B4   		movl	-76(%rbp), %eax
 3556 0160 3B45B8   		cmpl	-72(%rbp), %eax
 3557 0163 7D11     		jge	.L252
1225:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 last = expCh;
 3558              		.loc 1 1225 22
 3559 0165 8B45B8   		movl	-72(%rbp), %eax
 3560 0168 8945BC   		movl	%eax, -68(%rbp)
1226:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             } else {
1227:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 prevChar = expCh;
1228:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if (defined(SECUREC_COMPATIBLE_WIN_FORMAT))
1229:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 /* %[z-a] */
1230:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 last = prevChar;
1231:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1232:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
1233:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 SECUREC_BRACKET_SET_BIT(bracketTable->table, SECUREC_CHAR('-'));
1234:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 SECUREC_BRACKET_SET_BIT(bracketTable->table, expCh);
1235:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 continue;
1236:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1237:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1238:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             /* format %[a-\xff] last is 0xFF, condition (rnch <= last) cause dead loop */
1239:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             for (expCh = prevChar; expCh < last; ++expCh) {
 3561              		.loc 1 1239 24
 3562 016b 8B45B4   		movl	-76(%rbp), %eax
 3563 016e 8945B8   		movl	%eax, -72(%rbp)
 3564              		.loc 1 1239 13
GAS LISTING /tmp/cc1ytava.s 			page 93


 3565 0171 E9DF0000 		jmp	.L254
 3565      00
 3566              	.L252:
1227:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if (defined(SECUREC_COMPATIBLE_WIN_FORMAT))
 3567              		.loc 1 1227 26
 3568 0176 8B45B8   		movl	-72(%rbp), %eax
 3569 0179 8945B4   		movl	%eax, -76(%rbp)
 3570              	.LBB12:
1233:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 SECUREC_BRACKET_SET_BIT(bracketTable->table, expCh);
 3571              		.loc 1 1233 17
 3572 017c C745C805 		movl	$5, -56(%rbp)
 3572      000000
 3573 0183 C745CC20 		movl	$32, -52(%rbp)
 3573      000000
 3574 018a 488B45A0 		movq	-96(%rbp), %rax
 3575 018e 488B10   		movq	(%rax), %rdx
 3576 0191 8B45C8   		movl	-56(%rbp), %eax
 3577 0194 4801D0   		addq	%rdx, %rax
 3578 0197 0FB608   		movzbl	(%rax), %ecx
 3579 019a 8B45CC   		movl	-52(%rbp), %eax
 3580 019d 89C6     		movl	%eax, %esi
 3581 019f 488B45A0 		movq	-96(%rbp), %rax
 3582 01a3 488B10   		movq	(%rax), %rdx
 3583 01a6 8B45C8   		movl	-56(%rbp), %eax
 3584 01a9 4801D0   		addq	%rdx, %rax
 3585 01ac 09F1     		orl	%esi, %ecx
 3586 01ae 89CA     		movl	%ecx, %edx
 3587 01b0 8810     		movb	%dl, (%rax)
 3588              	.LBE12:
 3589              	.LBB13:
1234:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 continue;
 3590              		.loc 1 1234 17
 3591 01b2 8B45B8   		movl	-72(%rbp), %eax
 3592 01b5 C1E803   		shrl	$3, %eax
 3593 01b8 25FF1F00 		andl	$8191, %eax
 3593      00
 3594 01bd 8945D0   		movl	%eax, -48(%rbp)
 3595 01c0 8B45B8   		movl	-72(%rbp), %eax
 3596 01c3 83E007   		andl	$7, %eax
 3597 01c6 BA010000 		movl	$1, %edx
 3597      00
 3598 01cb 89C1     		movl	%eax, %ecx
 3599 01cd D3E2     		sall	%cl, %edx
 3600 01cf 89D0     		movl	%edx, %eax
 3601 01d1 0FB6C0   		movzbl	%al, %eax
 3602 01d4 8945D4   		movl	%eax, -44(%rbp)
 3603 01d7 488B45A0 		movq	-96(%rbp), %rax
 3604 01db 488B10   		movq	(%rax), %rdx
 3605 01de 8B45D0   		movl	-48(%rbp), %eax
 3606 01e1 4801D0   		addq	%rdx, %rax
 3607 01e4 0FB608   		movzbl	(%rax), %ecx
 3608 01e7 8B45D4   		movl	-44(%rbp), %eax
 3609 01ea 89C6     		movl	%eax, %esi
 3610 01ec 488B45A0 		movq	-96(%rbp), %rax
 3611 01f0 488B10   		movq	(%rax), %rdx
 3612 01f3 8B45D0   		movl	-48(%rbp), %eax
 3613 01f6 4801D0   		addq	%rdx, %rax
GAS LISTING /tmp/cc1ytava.s 			page 94


 3614 01f9 09F1     		orl	%esi, %ecx
 3615 01fb 89CA     		movl	%ecx, %edx
 3616 01fd 8810     		movb	%dl, (%rax)
 3617              	.LBE13:
1235:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
 3618              		.loc 1 1235 17
 3619 01ff E9AD0000 		jmp	.L249
 3619      00
 3620              	.L255:
 3621              	.LBB14:
1240:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 SECUREC_BRACKET_SET_BIT(bracketTable->table, expCh);
 3622              		.loc 1 1240 17 discriminator 3
 3623 0204 8B45B8   		movl	-72(%rbp), %eax
 3624 0207 C1E803   		shrl	$3, %eax
 3625 020a 25FF1F00 		andl	$8191, %eax
 3625      00
 3626 020f 8945E0   		movl	%eax, -32(%rbp)
 3627 0212 8B45B8   		movl	-72(%rbp), %eax
 3628 0215 83E007   		andl	$7, %eax
 3629 0218 BA010000 		movl	$1, %edx
 3629      00
 3630 021d 89C1     		movl	%eax, %ecx
 3631 021f D3E2     		sall	%cl, %edx
 3632 0221 89D0     		movl	%edx, %eax
 3633 0223 0FB6C0   		movzbl	%al, %eax
 3634 0226 8945E4   		movl	%eax, -28(%rbp)
 3635 0229 488B45A0 		movq	-96(%rbp), %rax
 3636 022d 488B10   		movq	(%rax), %rdx
 3637 0230 8B45E0   		movl	-32(%rbp), %eax
 3638 0233 4801D0   		addq	%rdx, %rax
 3639 0236 0FB608   		movzbl	(%rax), %ecx
 3640 0239 8B45E4   		movl	-28(%rbp), %eax
 3641 023c 89C6     		movl	%eax, %esi
 3642 023e 488B45A0 		movq	-96(%rbp), %rax
 3643 0242 488B10   		movq	(%rax), %rdx
 3644 0245 8B45E0   		movl	-32(%rbp), %eax
 3645 0248 4801D0   		addq	%rdx, %rax
 3646 024b 09F1     		orl	%esi, %ecx
 3647 024d 89CA     		movl	%ecx, %edx
 3648 024f 8810     		movb	%dl, (%rax)
 3649              	.LBE14:
1239:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 SECUREC_BRACKET_SET_BIT(bracketTable->table, expCh);
 3650              		.loc 1 1239 50 discriminator 3
 3651 0251 8345B801 		addl	$1, -72(%rbp)
 3652              	.L254:
1239:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 SECUREC_BRACKET_SET_BIT(bracketTable->table, expCh);
 3653              		.loc 1 1239 13 discriminator 1
 3654 0255 8B45B8   		movl	-72(%rbp), %eax
 3655 0258 3B45BC   		cmpl	-68(%rbp), %eax
 3656 025b 7CA7     		jl	.L255
 3657              	.LBB15:
1241:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1242:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SECUREC_BRACKET_SET_BIT(bracketTable->table, last);
 3658              		.loc 1 1242 13
 3659 025d 8B45BC   		movl	-68(%rbp), %eax
 3660 0260 C1E803   		shrl	$3, %eax
 3661 0263 25FF1F00 		andl	$8191, %eax
GAS LISTING /tmp/cc1ytava.s 			page 95


 3661      00
 3662 0268 8945D8   		movl	%eax, -40(%rbp)
 3663 026b 8B45BC   		movl	-68(%rbp), %eax
 3664 026e 83E007   		andl	$7, %eax
 3665 0271 BA010000 		movl	$1, %edx
 3665      00
 3666 0276 89C1     		movl	%eax, %ecx
 3667 0278 D3E2     		sall	%cl, %edx
 3668 027a 89D0     		movl	%edx, %eax
 3669 027c 0FB6C0   		movzbl	%al, %eax
 3670 027f 8945DC   		movl	%eax, -36(%rbp)
 3671 0282 488B45A0 		movq	-96(%rbp), %rax
 3672 0286 488B10   		movq	(%rax), %rdx
 3673 0289 8B45D8   		movl	-40(%rbp), %eax
 3674 028c 4801D0   		addq	%rdx, %rax
 3675 028f 0FB608   		movzbl	(%rax), %ecx
 3676 0292 8B45DC   		movl	-36(%rbp), %eax
 3677 0295 89C6     		movl	%eax, %esi
 3678 0297 488B45A0 		movq	-96(%rbp), %rax
 3679 029b 488B10   		movq	(%rax), %rdx
 3680 029e 8B45D8   		movl	-40(%rbp), %eax
 3681 02a1 4801D0   		addq	%rdx, %rax
 3682 02a4 09F1     		orl	%esi, %ecx
 3683 02a6 89CA     		movl	%ecx, %edx
 3684 02a8 8810     		movb	%dl, (%rax)
 3685              	.LBE15:
1243:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             prevChar = 0;
 3686              		.loc 1 1243 22
 3687 02aa C745B400 		movl	$0, -76(%rbp)
 3687      000000
 3688              	.L249:
1215:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         expCh = *fmt++;
 3689              		.loc 1 1215 12
 3690 02b1 488B45F0 		movq	-16(%rbp), %rax
 3691 02b5 8B00     		movl	(%rax), %eax
1215:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         expCh = *fmt++;
 3692              		.loc 1 1215 11
 3693 02b7 85C0     		testl	%eax, %eax
 3694 02b9 740F     		je	.L256
1215:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         expCh = *fmt++;
 3695              		.loc 1 1215 42 discriminator 1
 3696 02bb 488B45F0 		movq	-16(%rbp), %rax
 3697 02bf 8B00     		movl	(%rax), %eax
1215:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         expCh = *fmt++;
 3698              		.loc 1 1215 39 discriminator 1
 3699 02c1 83F85D   		cmpl	$93, %eax
 3700 02c4 0F8502FE 		jne	.L257
 3700      FFFF
 3701              	.L256:
1244:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1245:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1246:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     *format = fmt;
 3702              		.loc 1 1246 13
 3703 02ca 488B45A8 		movq	-88(%rbp), %rax
 3704 02ce 488B55F0 		movq	-16(%rbp), %rdx
 3705 02d2 488910   		movq	%rdx, (%rax)
1247:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return 0;
GAS LISTING /tmp/cc1ytava.s 			page 96


 3706              		.loc 1 1247 12
 3707 02d5 B8000000 		movl	$0, %eax
 3707      00
 3708              	.L246:
1248:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 3709              		.loc 1 1248 1
 3710 02da 488B7DF8 		movq	-8(%rbp), %rdi
 3711 02de 6448333C 		xorq	%fs:40, %rdi
 3711      25280000 
 3711      00
 3712 02e7 7405     		je	.L258
 3713 02e9 E8000000 		call	__stack_chk_fail@PLT
 3713      00
 3714              	.L258:
 3715 02ee C9       		leave
 3716              	.LCFI101:
 3717              		.cfi_def_cfa 7, 8
 3718 02ef C3       		ret
 3719              		.cfi_endproc
 3720              	.LFE39:
 3722              		.section	.text.SecInputForWchar,"ax",@progbits
 3724              	SecInputForWchar:
 3725              	.LFB40:
1249:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1250:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1251:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_FOR_WCHAR
1252:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static int SecInputForWchar(SecInt ch, SecScanSpec *spec)
1253:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 3726              		.loc 1 1253 1
 3727              		.cfi_startproc
 3728 0000 F30F1EFA 		endbr64
 3729 0004 55       		pushq	%rbp
 3730              	.LCFI102:
 3731              		.cfi_def_cfa_offset 16
 3732              		.cfi_offset 6, -16
 3733 0005 4889E5   		movq	%rsp, %rbp
 3734              	.LCFI103:
 3735              		.cfi_def_cfa_register 6
 3736 0008 4883EC40 		subq	$64, %rsp
 3737 000c 897DCC   		movl	%edi, -52(%rbp)
 3738 000f 488975C0 		movq	%rsi, -64(%rbp)
 3739              		.loc 1 1253 1
 3740 0013 64488B04 		movq	%fs:40, %rax
 3740      25280000 
 3740      00
 3741 001c 488945F8 		movq	%rax, -8(%rbp)
 3742 0020 31C0     		xorl	%eax, %eax
1254:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     void *endPtr = spec->argPtr;
 3743              		.loc 1 1254 11
 3744 0022 488B45C0 		movq	-64(%rbp), %rax
 3745 0026 488B4020 		movq	32(%rax), %rax
 3746 002a 488945D8 		movq	%rax, -40(%rbp)
1255:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (spec->isWChar > 0) {
 3747              		.loc 1 1255 13
 3748 002e 488B45C0 		movq	-64(%rbp), %rax
 3749 0032 0FB64040 		movzbl	64(%rax), %eax
 3750              		.loc 1 1255 8
GAS LISTING /tmp/cc1ytava.s 			page 97


 3751 0036 84C0     		testb	%al, %al
 3752 0038 7E27     		jle	.L260
1256:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         *(wchar_t UNALIGNED *)endPtr = (wchar_t)ch;
 3753              		.loc 1 1256 40
 3754 003a 8B55CC   		movl	-52(%rbp), %edx
 3755              		.loc 1 1256 38
 3756 003d 488B45D8 		movq	-40(%rbp), %rax
 3757 0041 8910     		movl	%edx, (%rax)
1257:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         endPtr = (wchar_t *)endPtr + 1;
 3758              		.loc 1 1257 16
 3759 0043 488345D8 		addq	$4, -40(%rbp)
 3759      04
1258:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         --spec->arrayWidth;
 3760              		.loc 1 1258 15
 3761 0048 488B45C0 		movq	-64(%rbp), %rax
 3762 004c 488B4028 		movq	40(%rax), %rax
 3763              		.loc 1 1258 9
 3764 0050 488D50FF 		leaq	-1(%rax), %rdx
 3765 0054 488B45C0 		movq	-64(%rbp), %rax
 3766 0058 48895028 		movq	%rdx, 40(%rax)
 3767 005c E98E0000 		jmp	.L261
 3767      00
 3768              	.L260:
 3769              	.LBB16:
1259:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else {
1260:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if SECUREC_HAVE_WCTOMB
1261:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         int temp;
1262:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         char tmpBuf[SECUREC_MB_LEN + 1];
1263:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SECUREC_MASK_MSVC_CRT_WARNING temp = wctomb(tmpBuf, (wchar_t)ch);
 3770              		.loc 1 1263 46
 3771 0061 8B55CC   		movl	-52(%rbp), %edx
 3772 0064 488D45E0 		leaq	-32(%rbp), %rax
 3773 0068 89D6     		movl	%edx, %esi
 3774 006a 4889C7   		movq	%rax, %rdi
 3775 006d E8000000 		call	wctomb@PLT
 3775      00
 3776 0072 8945D4   		movl	%eax, -44(%rbp)
1264:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SECUREC_END_MASK_MSVC_CRT_WARNING
1265:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (temp <= 0 || ((size_t)(unsigned int)temp) > sizeof(tmpBuf)) {
 3777              		.loc 1 1265 12
 3778 0075 837DD400 		cmpl	$0, -44(%rbp)
 3779 0079 7E08     		jle	.L262
 3780              		.loc 1 1265 55 discriminator 1
 3781 007b 8B45D4   		movl	-44(%rbp), %eax
 3782              		.loc 1 1265 23 discriminator 1
 3783 007e 83F811   		cmpl	$17, %eax
 3784 0081 7607     		jbe	.L263
 3785              	.L262:
1266:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             /* if wctomb  error, then ignore character */
1267:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             return 0;
 3786              		.loc 1 1267 20
 3787 0083 B8000000 		movl	$0, %eax
 3787      00
 3788 0088 EB76     		jmp	.L267
 3789              	.L263:
1268:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1269:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (((size_t)(unsigned int)temp) > spec->arrayWidth) {
GAS LISTING /tmp/cc1ytava.s 			page 98


 3790              		.loc 1 1269 22
 3791 008a 8B45D4   		movl	-44(%rbp), %eax
 3792              		.loc 1 1269 14
 3793 008d 89C2     		movl	%eax, %edx
 3794              		.loc 1 1269 48
 3795 008f 488B45C0 		movq	-64(%rbp), %rax
 3796 0093 488B4028 		movq	40(%rax), %rax
 3797              		.loc 1 1269 12
 3798 0097 4839C2   		cmpq	%rax, %rdx
 3799 009a 7607     		jbe	.L265
1270:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             return -1;
 3800              		.loc 1 1270 20
 3801 009c B8FFFFFF 		movl	$-1, %eax
 3801      FF
 3802 00a1 EB5D     		jmp	.L267
 3803              	.L265:
1271:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1272:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (memcpy_s(endPtr, spec->arrayWidth, tmpBuf, (size_t)(unsigned int)temp) != EOK) {
 3804              		.loc 1 1272 64
 3805 00a3 8B45D4   		movl	-44(%rbp), %eax
 3806              		.loc 1 1272 13
 3807 00a6 89C1     		movl	%eax, %ecx
 3808 00a8 488B45C0 		movq	-64(%rbp), %rax
 3809 00ac 488B7028 		movq	40(%rax), %rsi
 3810 00b0 488D55E0 		leaq	-32(%rbp), %rdx
 3811 00b4 488B45D8 		movq	-40(%rbp), %rax
 3812 00b8 4889C7   		movq	%rax, %rdi
 3813 00bb E8000000 		call	memcpy_s@PLT
 3813      00
 3814              		.loc 1 1272 12
 3815 00c0 85C0     		testl	%eax, %eax
 3816 00c2 7407     		je	.L266
1273:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             return -1;
 3817              		.loc 1 1273 20
 3818 00c4 B8FFFFFF 		movl	$-1, %eax
 3818      FF
 3819 00c9 EB35     		jmp	.L267
 3820              	.L266:
1274:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1275:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         endPtr = (char *)endPtr + temp;
 3821              		.loc 1 1275 33
 3822 00cb 8B45D4   		movl	-44(%rbp), %eax
 3823 00ce 4898     		cltq
 3824              		.loc 1 1275 16
 3825 00d0 480145D8 		addq	%rax, -40(%rbp)
1276:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->arrayWidth -= (size_t)(unsigned int)temp;
 3826              		.loc 1 1276 26
 3827 00d4 488B45C0 		movq	-64(%rbp), %rax
 3828 00d8 488B4028 		movq	40(%rax), %rax
 3829              		.loc 1 1276 37
 3830 00dc 8B55D4   		movl	-44(%rbp), %edx
 3831              		.loc 1 1276 29
 3832 00df 89D2     		movl	%edx, %edx
 3833              		.loc 1 1276 26
 3834 00e1 4829D0   		subq	%rdx, %rax
 3835 00e4 4889C2   		movq	%rax, %rdx
 3836 00e7 488B45C0 		movq	-64(%rbp), %rax
GAS LISTING /tmp/cc1ytava.s 			page 99


 3837 00eb 48895028 		movq	%rdx, 40(%rax)
 3838              	.L261:
 3839              	.LBE16:
1277:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
1278:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return -1;
1279:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1280:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1281:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->argPtr = endPtr;
 3840              		.loc 1 1281 18
 3841 00ef 488B45C0 		movq	-64(%rbp), %rax
 3842 00f3 488B55D8 		movq	-40(%rbp), %rdx
 3843 00f7 48895020 		movq	%rdx, 32(%rax)
1282:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return 0;
 3844              		.loc 1 1282 12
 3845 00fb B8000000 		movl	$0, %eax
 3845      00
 3846              	.L267:
1283:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 3847              		.loc 1 1283 1
 3848 0100 488B4DF8 		movq	-8(%rbp), %rcx
 3849 0104 6448330C 		xorq	%fs:40, %rcx
 3849      25280000 
 3849      00
 3850 010d 7405     		je	.L268
 3851 010f E8000000 		call	__stack_chk_fail@PLT
 3851      00
 3852              	.L268:
 3853 0114 C9       		leave
 3854              	.LCFI104:
 3855              		.cfi_def_cfa 7, 8
 3856 0115 C3       		ret
 3857              		.cfi_endproc
 3858              	.LFE40:
 3860              		.section	.text.SecInitFloatSpec,"ax",@progbits
 3862              	SecInitFloatSpec:
 3863              	.LFB41:
1284:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1285:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1286:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1287:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifndef SECUREC_FOR_WCHAR
1288:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static int SecInputForChar(SecInt ch, SecScanSpec *spec, SecFileStream *stream, int *charCount)
1289:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
1290:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     void *endPtr = spec->argPtr;
1291:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (spec->isWChar > 0) {
1292:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         wchar_t tempWChar = L'?';   /* set default char as ? */
1293:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if SECUREC_HAVE_MBTOWC
1294:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         char temp[SECUREC_MULTI_BYTE_MAX_LEN + 1];
1295:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         temp[0] = (char)ch;
1296:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         temp[1] = '\0';
1297:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if defined(SECUREC_COMPATIBLE_WIN_FORMAT)
1298:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (SecIsLeadByte(ch)) {
1299:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             temp[1] = (char)SecGetChar(stream, charCount);
1300:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             temp[2] = '\0'; /* 2 of string terminator position */
1301:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1302:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (mbtowc(&tempWChar, temp, sizeof(temp)) <= 0) {
1303:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             /* no string termination error for tool */
1304:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             tempWChar = L'?';
GAS LISTING /tmp/cc1ytava.s 			page 100


1305:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1306:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
1307:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (SecIsLeadByte(ch)) {
1308:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             int convRes = 0;
1309:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             int di = 1;
1310:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             /* in Linux like system, the string is encoded in UTF-8 */
1311:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             while (convRes <= 0 && di < (int)MB_CUR_MAX && di < SECUREC_MULTI_BYTE_MAX_LEN) {
1312:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 temp[di++] = (char)SecGetChar(stream, charCount);
1313:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 temp[di] = '\0';
1314:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 convRes = mbtowc(&tempWChar, temp, sizeof(temp));
1315:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1316:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (convRes <= 0) {
1317:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 tempWChar = L'?';
1318:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1319:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         } else {
1320:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (mbtowc(&tempWChar, temp, sizeof(temp)) <= 0) {
1321:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 /* no string termination error for tool */
1322:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 tempWChar = L'?';
1323:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1324:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1325:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1326:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif /* SECUREC_HAVE_MBTOWC */
1327:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         *(wchar_t UNALIGNED *)endPtr = tempWChar;
1328:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* just copy L'?' if mbtowc fails, errno is set by mbtowc */
1329:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         endPtr = (wchar_t *)endPtr + 1;
1330:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         --spec->arrayWidth;
1331:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         (void)charCount;
1332:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         (void)stream;
1333:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else {
1334:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         *(char *)endPtr = (char)ch;
1335:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         endPtr = (char *)endPtr + 1;
1336:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         --spec->arrayWidth;
1337:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1338:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     spec->argPtr = endPtr;
1339:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return 0;
1340:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
1341:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1342:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1343:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1344:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if SECUREC_ENABLE_SCANF_FLOAT
1345:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1346:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /* no not use localeconv()->decimal_pointif  onlay support  '.' */
1347:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #define SECURE_IS_FLOAT_DECIMAL(ch) ((ch) == SECUREC_CHAR('.'))
1348:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
1349:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * init SecFloatSpec befor parse format
1350:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
1351:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecInitFloatSpec(SecFloatSpec *floatSpec)
1352:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 3864              		.loc 1 1352 1
 3865              		.cfi_startproc
 3866 0000 F30F1EFA 		endbr64
 3867 0004 55       		pushq	%rbp
 3868              	.LCFI105:
 3869              		.cfi_def_cfa_offset 16
 3870              		.cfi_offset 6, -16
 3871 0005 4889E5   		movq	%rsp, %rbp
 3872              	.LCFI106:
GAS LISTING /tmp/cc1ytava.s 			page 101


 3873              		.cfi_def_cfa_register 6
 3874 0008 4883EC20 		subq	$32, %rsp
 3875 000c 48897DE8 		movq	%rdi, -24(%rbp)
 3876              		.loc 1 1352 1
 3877 0010 64488B04 		movq	%fs:40, %rax
 3877      25280000 
 3877      00
 3878 0019 488945F8 		movq	%rax, -8(%rbp)
 3879 001d 31C0     		xorl	%eax, %eax
1353:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     floatSpec->floatStr = floatSpec->buffer;
 3880              		.loc 1 1353 27
 3881 001f 488B45E8 		movq	-24(%rbp), %rax
 3882 0023 488D5010 		leaq	16(%rax), %rdx
 3883              		.loc 1 1353 25
 3884 0027 488B45E8 		movq	-24(%rbp), %rax
 3885 002b 48899088 		movq	%rdx, 1416(%rax)
 3885      050000
1354:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     floatSpec->allocatedFloatStr = NULL;
 3886              		.loc 1 1354 34
 3887 0032 488B45E8 		movq	-24(%rbp), %rax
 3888 0036 48C78090 		movq	$0, 1424(%rax)
 3888      05000000 
 3888      000000
1355:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     floatSpec->floatStrSize = sizeof(floatSpec->buffer) / sizeof(floatSpec->buffer[0]);
 3889              		.loc 1 1355 29
 3890 0041 488B45E8 		movq	-24(%rbp), %rax
 3891 0045 48C7005E 		movq	$350, (%rax)
 3891      010000
1356:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     floatSpec->floatStr = floatSpec->buffer;
 3892              		.loc 1 1356 27
 3893 004c 488B45E8 		movq	-24(%rbp), %rax
 3894 0050 488D5010 		leaq	16(%rax), %rdx
 3895              		.loc 1 1356 25
 3896 0054 488B45E8 		movq	-24(%rbp), %rax
 3897 0058 48899088 		movq	%rdx, 1416(%rax)
 3897      050000
1357:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     floatSpec->floatStrUsedLen = 0;
 3898              		.loc 1 1357 32
 3899 005f 488B45E8 		movq	-24(%rbp), %rax
 3900 0063 48C74008 		movq	$0, 8(%rax)
 3900      00000000 
1358:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 3901              		.loc 1 1358 1
 3902 006b 90       		nop
 3903 006c 488B45F8 		movq	-8(%rbp), %rax
 3904 0070 64483304 		xorq	%fs:40, %rax
 3904      25280000 
 3904      00
 3905 0079 7405     		je	.L270
 3906 007b E8000000 		call	__stack_chk_fail@PLT
 3906      00
 3907              	.L270:
 3908 0080 C9       		leave
 3909              	.LCFI107:
 3910              		.cfi_def_cfa 7, 8
 3911 0081 C3       		ret
 3912              		.cfi_endproc
GAS LISTING /tmp/cc1ytava.s 			page 102


 3913              	.LFE41:
 3915              		.section	.text.SecClearFloatSpec,"ax",@progbits
 3917              	SecClearFloatSpec:
 3918              	.LFB42:
1359:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1360:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecClearFloatSpec(SecFloatSpec *floatSpec, int *doneCount)
1361:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 3919              		.loc 1 1361 1
 3920              		.cfi_startproc
 3921 0000 F30F1EFA 		endbr64
 3922 0004 55       		pushq	%rbp
 3923              	.LCFI108:
 3924              		.cfi_def_cfa_offset 16
 3925              		.cfi_offset 6, -16
 3926 0005 4889E5   		movq	%rsp, %rbp
 3927              	.LCFI109:
 3928              		.cfi_def_cfa_register 6
 3929 0008 4883EC20 		subq	$32, %rsp
 3930 000c 48897DE8 		movq	%rdi, -24(%rbp)
 3931 0010 488975E0 		movq	%rsi, -32(%rbp)
 3932              		.loc 1 1361 1
 3933 0014 64488B04 		movq	%fs:40, %rax
 3933      25280000 
 3933      00
 3934 001d 488945F8 		movq	%rax, -8(%rbp)
 3935 0021 31C0     		xorl	%eax, %eax
1362:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****      /* LSD 2014.3.6 add, clear the stack data */
1363:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (memset_s(floatSpec->buffer, sizeof(floatSpec->buffer), 0,
 3936              		.loc 1 1363 27
 3937 0023 488B45E8 		movq	-24(%rbp), %rax
 3938 0027 4883C010 		addq	$16, %rax
 3939              		.loc 1 1363 9
 3940 002b B9780500 		movl	$1400, %ecx
 3940      00
 3941 0030 BA000000 		movl	$0, %edx
 3941      00
 3942 0035 BE780500 		movl	$1400, %esi
 3942      00
 3943 003a 4889C7   		movq	%rax, %rdi
 3944 003d E8000000 		call	memset_s@PLT
 3944      00
 3945              		.loc 1 1363 8
 3946 0042 85C0     		testl	%eax, %eax
 3947 0044 740A     		je	.L272
1364:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         sizeof(floatSpec->buffer)) != EOK) {
1365:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         *doneCount = 0;  /* This is a dead code, just to meet the coding requirements */
 3948              		.loc 1 1365 20
 3949 0046 488B45E0 		movq	-32(%rbp), %rax
 3950 004a C7000000 		movl	$0, (%rax)
 3950      0000
 3951              	.L272:
1366:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1367:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (floatSpec->allocatedFloatStr != NULL) {
 3952              		.loc 1 1367 18
 3953 0050 488B45E8 		movq	-24(%rbp), %rax
 3954 0054 488B8090 		movq	1424(%rax), %rax
 3954      050000
GAS LISTING /tmp/cc1ytava.s 			page 103


 3955              		.loc 1 1367 8
 3956 005b 4885C0   		testq	%rax, %rax
 3957 005e 7478     		je	.L276
1368:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* pFloatStr can be alloced in SecUpdateFloatString function, clear and free it */
1369:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (memset_s(floatSpec->allocatedFloatStr, floatSpec->floatStrSize * sizeof(SecChar), 0,
1370:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             floatSpec->floatStrSize * sizeof(SecChar)) != EOK) {
 3958              		.loc 1 1370 22
 3959 0060 488B45E8 		movq	-24(%rbp), %rax
 3960 0064 488B00   		movq	(%rax), %rax
1369:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             floatSpec->floatStrSize * sizeof(SecChar)) != EOK) {
 3961              		.loc 1 1369 13
 3962 0067 488D1485 		leaq	0(,%rax,4), %rdx
 3962      00000000 
1369:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             floatSpec->floatStrSize * sizeof(SecChar)) != EOK) {
 3963              		.loc 1 1369 61
 3964 006f 488B45E8 		movq	-24(%rbp), %rax
 3965 0073 488B00   		movq	(%rax), %rax
1369:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             floatSpec->floatStrSize * sizeof(SecChar)) != EOK) {
 3966              		.loc 1 1369 13
 3967 0076 488D3485 		leaq	0(,%rax,4), %rsi
 3967      00000000 
1369:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             floatSpec->floatStrSize * sizeof(SecChar)) != EOK) {
 3968              		.loc 1 1369 31
 3969 007e 488B45E8 		movq	-24(%rbp), %rax
 3970 0082 488B8090 		movq	1424(%rax), %rax
 3970      050000
1369:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             floatSpec->floatStrSize * sizeof(SecChar)) != EOK) {
 3971              		.loc 1 1369 13
 3972 0089 4889D1   		movq	%rdx, %rcx
 3973 008c BA000000 		movl	$0, %edx
 3973      00
 3974 0091 4889C7   		movq	%rax, %rdi
 3975 0094 E8000000 		call	memset_s@PLT
 3975      00
1369:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             floatSpec->floatStrSize * sizeof(SecChar)) != EOK) {
 3976              		.loc 1 1369 12
 3977 0099 85C0     		testl	%eax, %eax
 3978 009b 740A     		je	.L274
1371:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             *doneCount = 0; /* This is a dead code, just to meet the coding requirements */
 3979              		.loc 1 1371 24
 3980 009d 488B45E0 		movq	-32(%rbp), %rax
 3981 00a1 C7000000 		movl	$0, (%rax)
 3981      0000
 3982              	.L274:
1372:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1373:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SECUREC_FREE(floatSpec->allocatedFloatStr);
 3983              		.loc 1 1373 9
 3984 00a7 488B45E8 		movq	-24(%rbp), %rax
 3985 00ab 488B8090 		movq	1424(%rax), %rax
 3985      050000
 3986 00b2 4889C7   		movq	%rax, %rdi
 3987 00b5 E8000000 		call	free@PLT
 3987      00
1374:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         floatSpec->allocatedFloatStr = NULL;
 3988              		.loc 1 1374 38
 3989 00ba 488B45E8 		movq	-24(%rbp), %rax
 3990 00be 48C78090 		movq	$0, 1424(%rax)
GAS LISTING /tmp/cc1ytava.s 			page 104


 3990      05000000 
 3990      000000
1375:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         floatSpec->floatStr = NULL;
 3991              		.loc 1 1375 29
 3992 00c9 488B45E8 		movq	-24(%rbp), %rax
 3993 00cd 48C78088 		movq	$0, 1416(%rax)
 3993      05000000 
 3993      000000
 3994              	.L276:
1376:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1377:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 3995              		.loc 1 1377 1
 3996 00d8 90       		nop
 3997 00d9 488B45F8 		movq	-8(%rbp), %rax
 3998 00dd 64483304 		xorq	%fs:40, %rax
 3998      25280000 
 3998      00
 3999 00e6 7405     		je	.L275
 4000 00e8 E8000000 		call	__stack_chk_fail@PLT
 4000      00
 4001              	.L275:
 4002 00ed C9       		leave
 4003              	.LCFI110:
 4004              		.cfi_def_cfa 7, 8
 4005 00ee C3       		ret
 4006              		.cfi_endproc
 4007              	.LFE42:
 4009              		.section	.text.SecInputFloatE,"ax",@progbits
 4011              	SecInputFloatE:
 4012              	.LFB43:
1378:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1379:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1380:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
1381:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * scan value of exponent.
1382:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * return 0 OK
1383:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
1384:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static int SecInputFloatE(SecFileStream *stream, SecScanSpec *spec, SecFloatSpec *floatSpec, int *c
1385:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 4013              		.loc 1 1385 1
 4014              		.cfi_startproc
 4015 0000 F30F1EFA 		endbr64
 4016 0004 55       		pushq	%rbp
 4017              	.LCFI111:
 4018              		.cfi_def_cfa_offset 16
 4019              		.cfi_offset 6, -16
 4020 0005 4889E5   		movq	%rsp, %rbp
 4021              	.LCFI112:
 4022              		.cfi_def_cfa_register 6
 4023 0008 4883EC30 		subq	$48, %rsp
 4024 000c 48897DE8 		movq	%rdi, -24(%rbp)
 4025 0010 488975E0 		movq	%rsi, -32(%rbp)
 4026 0014 488955D8 		movq	%rdx, -40(%rbp)
 4027 0018 48894DD0 		movq	%rcx, -48(%rbp)
 4028              		.loc 1 1385 1
 4029 001c 64488B04 		movq	%fs:40, %rax
 4029      25280000 
 4029      00
GAS LISTING /tmp/cc1ytava.s 			page 105


 4030 0025 488945F8 		movq	%rax, -8(%rbp)
 4031 0029 31C0     		xorl	%eax, %eax
1386:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecInt ch = SecGetChar(stream, charCount);
 4032              		.loc 1 1386 17
 4033 002b 488B55D0 		movq	-48(%rbp), %rdx
 4034 002f 488B45E8 		movq	-24(%rbp), %rax
 4035 0033 4889D6   		movq	%rdx, %rsi
 4036 0036 4889C7   		movq	%rax, %rdi
 4037 0039 E8000000 		call	SecGetChar
 4037      00
 4038 003e 8945F4   		movl	%eax, -12(%rbp)
1387:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (ch == SECUREC_CHAR('+') || ch == SECUREC_CHAR('-')) {
 4039              		.loc 1 1387 8
 4040 0041 837DF42B 		cmpl	$43, -12(%rbp)
 4041 0045 740A     		je	.L278
 4042              		.loc 1 1387 33 discriminator 1
 4043 0047 837DF42D 		cmpl	$45, -12(%rbp)
 4044 004b 0F858B00 		jne	.L282
 4044      0000
 4045              	.L278:
1388:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (ch == SECUREC_CHAR('-') && SecUpdateFloatString((SecChar)'-', floatSpec) != 0) {
 4046              		.loc 1 1388 12
 4047 0051 837DF42D 		cmpl	$45, -12(%rbp)
 4048 0055 751F     		jne	.L280
 4049              		.loc 1 1388 40 discriminator 1
 4050 0057 488B45D8 		movq	-40(%rbp), %rax
 4051 005b 4889C6   		movq	%rax, %rsi
 4052 005e BF2D0000 		movl	$45, %edi
 4052      00
 4053 0063 E8000000 		call	SecUpdateFloatString
 4053      00
 4054              		.loc 1 1388 37 discriminator 1
 4055 0068 85C0     		testl	%eax, %eax
 4056 006a 740A     		je	.L280
1389:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             return -1;
 4057              		.loc 1 1389 20
 4058 006c B8FFFFFF 		movl	$-1, %eax
 4058      FF
 4059 0071 E9B20000 		jmp	.L281
 4059      00
 4060              	.L280:
1390:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1391:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec->width != 0) {
 4061              		.loc 1 1391 17
 4062 0076 488B45E0 		movq	-32(%rbp), %rax
 4063 007a 8B4030   		movl	48(%rax), %eax
 4064              		.loc 1 1391 12
 4065 007d 85C0     		testl	%eax, %eax
 4066 007f 745B     		je	.L282
1392:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             ch = SecGetChar(stream, charCount);
 4067              		.loc 1 1392 18
 4068 0081 488B55D0 		movq	-48(%rbp), %rdx
 4069 0085 488B45E8 		movq	-24(%rbp), %rax
 4070 0089 4889D6   		movq	%rdx, %rsi
 4071 008c 4889C7   		movq	%rax, %rdi
 4072 008f E8000000 		call	SecGetChar
 4072      00
GAS LISTING /tmp/cc1ytava.s 			page 106


 4073 0094 8945F4   		movl	%eax, -12(%rbp)
1393:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             --spec->width;
 4074              		.loc 1 1393 19
 4075 0097 488B45E0 		movq	-32(%rbp), %rax
 4076 009b 8B4030   		movl	48(%rax), %eax
 4077              		.loc 1 1393 13
 4078 009e 8D50FF   		leal	-1(%rax), %edx
 4079 00a1 488B45E0 		movq	-32(%rbp), %rax
 4080 00a5 895030   		movl	%edx, 48(%rax)
1394:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1395:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1396:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1397:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     while (SECUREC_IS_DIGIT(ch) && spec->width-- != 0) {
 4081              		.loc 1 1397 11
 4082 00a8 EB32     		jmp	.L282
 4083              	.L285:
1398:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (SecUpdateFloatString((SecChar)ch, floatSpec) != 0) {
 4084              		.loc 1 1398 13
 4085 00aa 8B45F4   		movl	-12(%rbp), %eax
 4086 00ad 488B55D8 		movq	-40(%rbp), %rdx
 4087 00b1 4889D6   		movq	%rdx, %rsi
 4088 00b4 89C7     		movl	%eax, %edi
 4089 00b6 E8000000 		call	SecUpdateFloatString
 4089      00
 4090              		.loc 1 1398 12
 4091 00bb 85C0     		testl	%eax, %eax
 4092 00bd 7407     		je	.L283
1399:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             return -1;
 4093              		.loc 1 1399 20
 4094 00bf B8FFFFFF 		movl	$-1, %eax
 4094      FF
 4095 00c4 EB62     		jmp	.L281
 4096              	.L283:
1400:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1401:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ch = SecGetChar(stream, charCount);
 4097              		.loc 1 1401 14
 4098 00c6 488B55D0 		movq	-48(%rbp), %rdx
 4099 00ca 488B45E8 		movq	-24(%rbp), %rax
 4100 00ce 4889D6   		movq	%rdx, %rsi
 4101 00d1 4889C7   		movq	%rax, %rdi
 4102 00d4 E8000000 		call	SecGetChar
 4102      00
 4103 00d9 8945F4   		movl	%eax, -12(%rbp)
 4104              	.L282:
1397:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (SecUpdateFloatString((SecChar)ch, floatSpec) != 0) {
 4105              		.loc 1 1397 12
 4106 00dc 8B45F4   		movl	-12(%rbp), %eax
 4107 00df 2500FF00 		andl	$65280, %eax
 4107      00
1397:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (SecUpdateFloatString((SecChar)ch, floatSpec) != 0) {
 4108              		.loc 1 1397 11
 4109 00e4 85C0     		testl	%eax, %eax
 4110 00e6 753B     		jne	.L284
1397:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (SecUpdateFloatString((SecChar)ch, floatSpec) != 0) {
 4111              		.loc 1 1397 12 discriminator 1
 4112 00e8 E8000000 		call	__ctype_b_loc@PLT
 4112      00
GAS LISTING /tmp/cc1ytava.s 			page 107


 4113 00ed 488B00   		movq	(%rax), %rax
 4114 00f0 8B55F4   		movl	-12(%rbp), %edx
 4115 00f3 4863D2   		movslq	%edx, %rdx
 4116 00f6 0FB6D2   		movzbl	%dl, %edx
 4117 00f9 4801D2   		addq	%rdx, %rdx
 4118 00fc 4801D0   		addq	%rdx, %rax
 4119 00ff 0FB700   		movzwl	(%rax), %eax
 4120 0102 0FB7C0   		movzwl	%ax, %eax
 4121 0105 25000800 		andl	$2048, %eax
 4121      00
 4122 010a 85C0     		testl	%eax, %eax
 4123 010c 7415     		je	.L284
1397:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (SecUpdateFloatString((SecChar)ch, floatSpec) != 0) {
 4124              		.loc 1 1397 40 discriminator 2
 4125 010e 488B45E0 		movq	-32(%rbp), %rax
 4126 0112 8B4030   		movl	48(%rax), %eax
1397:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (SecUpdateFloatString((SecChar)ch, floatSpec) != 0) {
 4127              		.loc 1 1397 47 discriminator 2
 4128 0115 8D48FF   		leal	-1(%rax), %ecx
 4129 0118 488B55E0 		movq	-32(%rbp), %rdx
 4130 011c 894A30   		movl	%ecx, 48(%rdx)
1397:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (SecUpdateFloatString((SecChar)ch, floatSpec) != 0) {
 4131              		.loc 1 1397 33 discriminator 2
 4132 011f 85C0     		testl	%eax, %eax
 4133 0121 7587     		jne	.L285
 4134              	.L284:
1402:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1403:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return 0;
 4135              		.loc 1 1403 12
 4136 0123 B8000000 		movl	$0, %eax
 4136      00
 4137              	.L281:
1404:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 4138              		.loc 1 1404 1
 4139 0128 488B4DF8 		movq	-8(%rbp), %rcx
 4140 012c 6448330C 		xorq	%fs:40, %rcx
 4140      25280000 
 4140      00
 4141 0135 7405     		je	.L286
 4142 0137 E8000000 		call	__stack_chk_fail@PLT
 4142      00
 4143              	.L286:
 4144 013c C9       		leave
 4145              	.LCFI113:
 4146              		.cfi_def_cfa 7, 8
 4147 013d C3       		ret
 4148              		.cfi_endproc
 4149              	.LFE43:
 4151              		.section	.text.SecInputFloat,"ax",@progbits
 4153              	SecInputFloat:
 4154              	.LFB44:
1405:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1406:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
1407:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * scan %f.
1408:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * return 0 OK
1409:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
1410:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static int SecInputFloat(SecFileStream *stream, SecScanSpec *spec, SecFloatSpec *floatSpec, int *ch
GAS LISTING /tmp/cc1ytava.s 			page 108


1411:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 4155              		.loc 1 1411 1
 4156              		.cfi_startproc
 4157 0000 F30F1EFA 		endbr64
 4158 0004 55       		pushq	%rbp
 4159              	.LCFI114:
 4160              		.cfi_def_cfa_offset 16
 4161              		.cfi_offset 6, -16
 4162 0005 4889E5   		movq	%rsp, %rbp
 4163              	.LCFI115:
 4164              		.cfi_def_cfa_register 6
 4165 0008 4883EC30 		subq	$48, %rsp
 4166 000c 48897DE8 		movq	%rdi, -24(%rbp)
 4167 0010 488975E0 		movq	%rsi, -32(%rbp)
 4168 0014 488955D8 		movq	%rdx, -40(%rbp)
 4169 0018 48894DD0 		movq	%rcx, -48(%rbp)
 4170              		.loc 1 1411 1
 4171 001c 64488B04 		movq	%fs:40, %rax
 4171      25280000 
 4171      00
 4172 0025 488945F8 		movq	%rax, -8(%rbp)
 4173 0029 31C0     		xorl	%eax, %eax
1412:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     int started = -1;
 4174              		.loc 1 1412 9
 4175 002b C745F0FF 		movl	$-1, -16(%rbp)
 4175      FFFFFF
1413:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecInt ch = SecGetChar(stream, charCount);
 4176              		.loc 1 1413 17
 4177 0032 488B55D0 		movq	-48(%rbp), %rdx
 4178 0036 488B45E8 		movq	-24(%rbp), %rax
 4179 003a 4889D6   		movq	%rdx, %rsi
 4180 003d 4889C7   		movq	%rax, %rdi
 4181 0040 E8000000 		call	SecGetChar
 4181      00
 4182 0045 8945F4   		movl	%eax, -12(%rbp)
1414:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1415:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     floatSpec->floatStrUsedLen = 0;
 4183              		.loc 1 1415 32
 4184 0048 488B45D8 		movq	-40(%rbp), %rax
 4185 004c 48C74008 		movq	$0, 8(%rax)
 4185      00000000 
1416:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (ch == SECUREC_CHAR('-')) {
 4186              		.loc 1 1416 8
 4187 0054 837DF42D 		cmpl	$45, -12(%rbp)
 4188 0058 7555     		jne	.L288
1417:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         floatSpec->floatStr[floatSpec->floatStrUsedLen++] = SECUREC_CHAR('-');
 4189              		.loc 1 1417 18
 4190 005a 488B45D8 		movq	-40(%rbp), %rax
 4191 005e 488BB088 		movq	1416(%rax), %rsi
 4191      050000
 4192              		.loc 1 1417 38
 4193 0065 488B45D8 		movq	-40(%rbp), %rax
 4194 0069 488B4008 		movq	8(%rax), %rax
 4195              		.loc 1 1417 55
 4196 006d 488D4801 		leaq	1(%rax), %rcx
 4197 0071 488B55D8 		movq	-40(%rbp), %rdx
 4198 0075 48894A08 		movq	%rcx, 8(%rdx)
GAS LISTING /tmp/cc1ytava.s 			page 109


 4199              		.loc 1 1417 28
 4200 0079 48C1E002 		salq	$2, %rax
 4201 007d 4801F0   		addq	%rsi, %rax
 4202              		.loc 1 1417 59
 4203 0080 C7002D00 		movl	$45, (%rax)
 4203      0000
1418:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         --spec->width;
 4204              		.loc 1 1418 15
 4205 0086 488B45E0 		movq	-32(%rbp), %rax
 4206 008a 8B4030   		movl	48(%rax), %eax
 4207              		.loc 1 1418 9
 4208 008d 8D50FF   		leal	-1(%rax), %edx
 4209 0090 488B45E0 		movq	-32(%rbp), %rax
 4210 0094 895030   		movl	%edx, 48(%rax)
1419:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ch = SecGetChar(stream, charCount);
 4211              		.loc 1 1419 14
 4212 0097 488B55D0 		movq	-48(%rbp), %rdx
 4213 009b 488B45E8 		movq	-24(%rbp), %rax
 4214 009f 4889D6   		movq	%rdx, %rsi
 4215 00a2 4889C7   		movq	%rax, %rdi
 4216 00a5 E8000000 		call	SecGetChar
 4216      00
 4217 00aa 8945F4   		movl	%eax, -12(%rbp)
 4218 00ad EB2D     		jmp	.L289
 4219              	.L288:
1420:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else if (ch == SECUREC_CHAR('+')) {
 4220              		.loc 1 1420 15
 4221 00af 837DF42B 		cmpl	$43, -12(%rbp)
 4222 00b3 7527     		jne	.L289
1421:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         --spec->width;
 4223              		.loc 1 1421 15
 4224 00b5 488B45E0 		movq	-32(%rbp), %rax
 4225 00b9 8B4030   		movl	48(%rax), %eax
 4226              		.loc 1 1421 9
 4227 00bc 8D50FF   		leal	-1(%rax), %edx
 4228 00bf 488B45E0 		movq	-32(%rbp), %rax
 4229 00c3 895030   		movl	%edx, 48(%rax)
1422:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ch = SecGetChar(stream, charCount);
 4230              		.loc 1 1422 14
 4231 00c6 488B55D0 		movq	-48(%rbp), %rdx
 4232 00ca 488B45E8 		movq	-24(%rbp), %rax
 4233 00ce 4889D6   		movq	%rdx, %rsi
 4234 00d1 4889C7   		movq	%rax, %rdi
 4235 00d4 E8000000 		call	SecGetChar
 4235      00
 4236 00d9 8945F4   		movl	%eax, -12(%rbp)
 4237              	.L289:
1423:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1424:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1425:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (spec->widthSet == 0) {    /* must care width */
 4238              		.loc 1 1425 13
 4239 00dc 488B45E0 		movq	-32(%rbp), %rax
 4240 00e0 8B4034   		movl	52(%rax), %eax
 4241              		.loc 1 1425 8
 4242 00e3 85C0     		testl	%eax, %eax
 4243 00e5 7549     		jne	.L291
1426:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->width = -1; /* -1 is unlimited */
GAS LISTING /tmp/cc1ytava.s 			page 110


 4244              		.loc 1 1426 21
 4245 00e7 488B45E0 		movq	-32(%rbp), %rax
 4246 00eb C74030FF 		movl	$-1, 48(%rax)
 4246      FFFFFF
1427:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1428:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1429:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     /* now get integral part */
1430:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     while (SECUREC_IS_DIGIT(ch) && spec->width-- != 0) {
 4247              		.loc 1 1430 11
 4248 00f2 EB3C     		jmp	.L291
 4249              	.L295:
1431:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         started = 0;
 4250              		.loc 1 1431 17
 4251 00f4 C745F000 		movl	$0, -16(%rbp)
 4251      000000
1432:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* ch must be '0' - '9' */
1433:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (SecUpdateFloatString((SecChar)ch, floatSpec) != 0) {
 4252              		.loc 1 1433 13
 4253 00fb 8B45F4   		movl	-12(%rbp), %eax
 4254 00fe 488B55D8 		movq	-40(%rbp), %rdx
 4255 0102 4889D6   		movq	%rdx, %rsi
 4256 0105 89C7     		movl	%eax, %edi
 4257 0107 E8000000 		call	SecUpdateFloatString
 4257      00
 4258              		.loc 1 1433 12
 4259 010c 85C0     		testl	%eax, %eax
 4260 010e 740A     		je	.L292
1434:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             return -1;
 4261              		.loc 1 1434 20
 4262 0110 B8FFFFFF 		movl	$-1, %eax
 4262      FF
 4263 0115 E9E00100 		jmp	.L293
 4263      00
 4264              	.L292:
1435:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1436:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ch = SecGetChar(stream, charCount);
 4265              		.loc 1 1436 14
 4266 011a 488B55D0 		movq	-48(%rbp), %rdx
 4267 011e 488B45E8 		movq	-24(%rbp), %rax
 4268 0122 4889D6   		movq	%rdx, %rsi
 4269 0125 4889C7   		movq	%rax, %rdi
 4270 0128 E8000000 		call	SecGetChar
 4270      00
 4271 012d 8945F4   		movl	%eax, -12(%rbp)
 4272              	.L291:
1430:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         started = 0;
 4273              		.loc 1 1430 12
 4274 0130 8B45F4   		movl	-12(%rbp), %eax
 4275 0133 2500FF00 		andl	$65280, %eax
 4275      00
1430:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         started = 0;
 4276              		.loc 1 1430 11
 4277 0138 85C0     		testl	%eax, %eax
 4278 013a 753F     		jne	.L294
1430:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         started = 0;
 4279              		.loc 1 1430 12 discriminator 1
 4280 013c E8000000 		call	__ctype_b_loc@PLT
GAS LISTING /tmp/cc1ytava.s 			page 111


 4280      00
 4281 0141 488B00   		movq	(%rax), %rax
 4282 0144 8B55F4   		movl	-12(%rbp), %edx
 4283 0147 4863D2   		movslq	%edx, %rdx
 4284 014a 0FB6D2   		movzbl	%dl, %edx
 4285 014d 4801D2   		addq	%rdx, %rdx
 4286 0150 4801D0   		addq	%rdx, %rax
 4287 0153 0FB700   		movzwl	(%rax), %eax
 4288 0156 0FB7C0   		movzwl	%ax, %eax
 4289 0159 25000800 		andl	$2048, %eax
 4289      00
 4290 015e 85C0     		testl	%eax, %eax
 4291 0160 7419     		je	.L294
1430:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         started = 0;
 4292              		.loc 1 1430 40 discriminator 2
 4293 0162 488B45E0 		movq	-32(%rbp), %rax
 4294 0166 8B4030   		movl	48(%rax), %eax
1430:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         started = 0;
 4295              		.loc 1 1430 47 discriminator 2
 4296 0169 8D48FF   		leal	-1(%rax), %ecx
 4297 016c 488B55E0 		movq	-32(%rbp), %rdx
 4298 0170 894A30   		movl	%ecx, 48(%rdx)
1430:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         started = 0;
 4299              		.loc 1 1430 33 discriminator 2
 4300 0173 85C0     		testl	%eax, %eax
 4301 0175 0F8579FF 		jne	.L295
 4301      FFFF
 4302              	.L294:
1437:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1438:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1439:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     /* now get fractional part */
1440:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (SECURE_IS_FLOAT_DECIMAL((SecChar)ch) && spec->width-- != 0) {
 4303              		.loc 1 1440 8
 4304 017b 837DF42E 		cmpl	$46, -12(%rbp)
 4305 017f 0F85D700 		jne	.L296
 4305      0000
 4306              		.loc 1 1440 53 discriminator 1
 4307 0185 488B45E0 		movq	-32(%rbp), %rax
 4308 0189 8B4030   		movl	48(%rax), %eax
 4309              		.loc 1 1440 60 discriminator 1
 4310 018c 8D48FF   		leal	-1(%rax), %ecx
 4311 018f 488B55E0 		movq	-32(%rbp), %rdx
 4312 0193 894A30   		movl	%ecx, 48(%rdx)
 4313              		.loc 1 1440 46 discriminator 1
 4314 0196 85C0     		testl	%eax, %eax
 4315 0198 0F84BE00 		je	.L296
 4315      0000
1441:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* now check for decimal */
1442:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (SecUpdateFloatString((SecChar)ch, floatSpec) != 0) {
 4316              		.loc 1 1442 13
 4317 019e 8B45F4   		movl	-12(%rbp), %eax
 4318 01a1 488B55D8 		movq	-40(%rbp), %rdx
 4319 01a5 4889D6   		movq	%rdx, %rsi
 4320 01a8 89C7     		movl	%eax, %edi
 4321 01aa E8000000 		call	SecUpdateFloatString
 4321      00
 4322              		.loc 1 1442 12
GAS LISTING /tmp/cc1ytava.s 			page 112


 4323 01af 85C0     		testl	%eax, %eax
 4324 01b1 740A     		je	.L297
1443:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             return -1;
 4325              		.loc 1 1443 20
 4326 01b3 B8FFFFFF 		movl	$-1, %eax
 4326      FF
 4327 01b8 E93D0100 		jmp	.L293
 4327      00
 4328              	.L297:
1444:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1445:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ch = SecGetChar(stream, charCount);
 4329              		.loc 1 1445 14
 4330 01bd 488B55D0 		movq	-48(%rbp), %rdx
 4331 01c1 488B45E8 		movq	-24(%rbp), %rax
 4332 01c5 4889D6   		movq	%rdx, %rsi
 4333 01c8 4889C7   		movq	%rax, %rdi
 4334 01cb E8000000 		call	SecGetChar
 4334      00
 4335 01d0 8945F4   		movl	%eax, -12(%rbp)
1446:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         while (SECUREC_IS_DIGIT(ch) && spec->width-- != 0) {
 4336              		.loc 1 1446 15
 4337 01d3 EB3C     		jmp	.L298
 4338              	.L300:
1447:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             started = 0;
 4339              		.loc 1 1447 21
 4340 01d5 C745F000 		movl	$0, -16(%rbp)
 4340      000000
1448:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (SecUpdateFloatString((SecChar)ch, floatSpec) != 0) {
 4341              		.loc 1 1448 17
 4342 01dc 8B45F4   		movl	-12(%rbp), %eax
 4343 01df 488B55D8 		movq	-40(%rbp), %rdx
 4344 01e3 4889D6   		movq	%rdx, %rsi
 4345 01e6 89C7     		movl	%eax, %edi
 4346 01e8 E8000000 		call	SecUpdateFloatString
 4346      00
 4347              		.loc 1 1448 16
 4348 01ed 85C0     		testl	%eax, %eax
 4349 01ef 740A     		je	.L299
1449:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 return -1;
 4350              		.loc 1 1449 24
 4351 01f1 B8FFFFFF 		movl	$-1, %eax
 4351      FF
 4352 01f6 E9FF0000 		jmp	.L293
 4352      00
 4353              	.L299:
1450:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1451:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             ch = SecGetChar(stream, charCount);
 4354              		.loc 1 1451 18
 4355 01fb 488B55D0 		movq	-48(%rbp), %rdx
 4356 01ff 488B45E8 		movq	-24(%rbp), %rax
 4357 0203 4889D6   		movq	%rdx, %rsi
 4358 0206 4889C7   		movq	%rax, %rdi
 4359 0209 E8000000 		call	SecGetChar
 4359      00
 4360 020e 8945F4   		movl	%eax, -12(%rbp)
 4361              	.L298:
1446:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             started = 0;
GAS LISTING /tmp/cc1ytava.s 			page 113


 4362              		.loc 1 1446 16
 4363 0211 8B45F4   		movl	-12(%rbp), %eax
 4364 0214 2500FF00 		andl	$65280, %eax
 4364      00
1446:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             started = 0;
 4365              		.loc 1 1446 15
 4366 0219 85C0     		testl	%eax, %eax
 4367 021b 753F     		jne	.L296
1446:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             started = 0;
 4368              		.loc 1 1446 16 discriminator 1
 4369 021d E8000000 		call	__ctype_b_loc@PLT
 4369      00
 4370 0222 488B00   		movq	(%rax), %rax
 4371 0225 8B55F4   		movl	-12(%rbp), %edx
 4372 0228 4863D2   		movslq	%edx, %rdx
 4373 022b 0FB6D2   		movzbl	%dl, %edx
 4374 022e 4801D2   		addq	%rdx, %rdx
 4375 0231 4801D0   		addq	%rdx, %rax
 4376 0234 0FB700   		movzwl	(%rax), %eax
 4377 0237 0FB7C0   		movzwl	%ax, %eax
 4378 023a 25000800 		andl	$2048, %eax
 4378      00
 4379 023f 85C0     		testl	%eax, %eax
 4380 0241 7419     		je	.L296
1446:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             started = 0;
 4381              		.loc 1 1446 44 discriminator 2
 4382 0243 488B45E0 		movq	-32(%rbp), %rax
 4383 0247 8B4030   		movl	48(%rax), %eax
1446:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             started = 0;
 4384              		.loc 1 1446 51 discriminator 2
 4385 024a 8D48FF   		leal	-1(%rax), %ecx
 4386 024d 488B55E0 		movq	-32(%rbp), %rdx
 4387 0251 894A30   		movl	%ecx, 48(%rdx)
1446:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             started = 0;
 4388              		.loc 1 1446 37 discriminator 2
 4389 0254 85C0     		testl	%eax, %eax
 4390 0256 0F8579FF 		jne	.L300
 4390      FFFF
 4391              	.L296:
1452:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1453:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1454:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1455:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     /* now get exponent part */
1456:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (started == 0 && (ch == SECUREC_CHAR('e') || ch == SECUREC_CHAR('E')) && spec->width-- != 0)
 4392              		.loc 1 1456 8
 4393 025c 837DF000 		cmpl	$0, -16(%rbp)
 4394 0260 7560     		jne	.L301
 4395              		.loc 1 1456 22 discriminator 1
 4396 0262 837DF465 		cmpl	$101, -12(%rbp)
 4397 0266 7406     		je	.L302
 4398              		.loc 1 1456 50 discriminator 3
 4399 0268 837DF445 		cmpl	$69, -12(%rbp)
 4400 026c 7554     		jne	.L301
 4401              	.L302:
 4402              		.loc 1 1456 85 discriminator 4
 4403 026e 488B45E0 		movq	-32(%rbp), %rax
 4404 0272 8B4030   		movl	48(%rax), %eax
GAS LISTING /tmp/cc1ytava.s 			page 114


 4405              		.loc 1 1456 92 discriminator 4
 4406 0275 8D48FF   		leal	-1(%rax), %ecx
 4407 0278 488B55E0 		movq	-32(%rbp), %rdx
 4408 027c 894A30   		movl	%ecx, 48(%rdx)
 4409              		.loc 1 1456 78 discriminator 4
 4410 027f 85C0     		testl	%eax, %eax
 4411 0281 743F     		je	.L301
1457:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (SecUpdateFloatString((SecChar)'e', floatSpec) != 0) {
 4412              		.loc 1 1457 13
 4413 0283 488B45D8 		movq	-40(%rbp), %rax
 4414 0287 4889C6   		movq	%rax, %rsi
 4415 028a BF650000 		movl	$101, %edi
 4415      00
 4416 028f E8000000 		call	SecUpdateFloatString
 4416      00
 4417              		.loc 1 1457 12
 4418 0294 85C0     		testl	%eax, %eax
 4419 0296 7407     		je	.L303
1458:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             return -1;
 4420              		.loc 1 1458 20
 4421 0298 B8FFFFFF 		movl	$-1, %eax
 4421      FF
 4422 029d EB5B     		jmp	.L293
 4423              	.L303:
1459:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1460:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (SecInputFloatE(stream, spec, floatSpec, charCount) != 0) {
 4424              		.loc 1 1460 13
 4425 029f 488B4DD0 		movq	-48(%rbp), %rcx
 4426 02a3 488B55D8 		movq	-40(%rbp), %rdx
 4427 02a7 488B75E0 		movq	-32(%rbp), %rsi
 4428 02ab 488B45E8 		movq	-24(%rbp), %rax
 4429 02af 4889C7   		movq	%rax, %rdi
 4430 02b2 E8000000 		call	SecInputFloatE
 4430      00
 4431              		.loc 1 1460 12
 4432 02b7 85C0     		testl	%eax, %eax
 4433 02b9 7407     		je	.L301
1461:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             return -1;
 4434              		.loc 1 1461 20
 4435 02bb B8FFFFFF 		movl	$-1, %eax
 4435      FF
 4436 02c0 EB38     		jmp	.L293
 4437              	.L301:
1462:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1463:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1464:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     /* un set the last character that is not a floating point number */
1465:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecUnGetChar(ch, stream, charCount);
 4438              		.loc 1 1465 5
 4439 02c2 488B55D0 		movq	-48(%rbp), %rdx
 4440 02c6 488B4DE8 		movq	-24(%rbp), %rcx
 4441 02ca 8B45F4   		movl	-12(%rbp), %eax
 4442 02cd 4889CE   		movq	%rcx, %rsi
 4443 02d0 89C7     		movl	%eax, %edi
 4444 02d2 E8000000 		call	SecUnGetChar
 4444      00
1466:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     /* Make sure  have a string terminator, buffer is large enough */
1467:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     floatSpec->floatStr[floatSpec->floatStrUsedLen] = SECUREC_CHAR('\0');
GAS LISTING /tmp/cc1ytava.s 			page 115


 4445              		.loc 1 1467 14
 4446 02d7 488B45D8 		movq	-40(%rbp), %rax
 4447 02db 488B9088 		movq	1416(%rax), %rdx
 4447      050000
 4448              		.loc 1 1467 34
 4449 02e2 488B45D8 		movq	-40(%rbp), %rax
 4450 02e6 488B4008 		movq	8(%rax), %rax
 4451              		.loc 1 1467 24
 4452 02ea 48C1E002 		salq	$2, %rax
 4453 02ee 4801D0   		addq	%rdx, %rax
 4454              		.loc 1 1467 53
 4455 02f1 C7000000 		movl	$0, (%rax)
 4455      0000
1468:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return started;
 4456              		.loc 1 1468 12
 4457 02f7 8B45F0   		movl	-16(%rbp), %eax
 4458              	.L293:
1469:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1470:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 4459              		.loc 1 1470 1
 4460 02fa 488B7DF8 		movq	-8(%rbp), %rdi
 4461 02fe 6448333C 		xorq	%fs:40, %rdi
 4461      25280000 
 4461      00
 4462 0307 7405     		je	.L304
 4463 0309 E8000000 		call	__stack_chk_fail@PLT
 4463      00
 4464              	.L304:
 4465 030e C9       		leave
 4466              	.LCFI116:
 4467              		.cfi_def_cfa 7, 8
 4468 030f C3       		ret
 4469              		.cfi_endproc
 4470              	.LFE44:
 4472              		.section	.text.SecInputNumberDigital,"ax",@progbits
 4474              	SecInputNumberDigital:
 4475              	.LFB45:
1471:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1472:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1473:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
1474:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * scan digital part of %d %i %o %u %x %p.
1475:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * return 0 OK
1476:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
1477:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static int SecInputNumberDigital(SecInt firstCh, SecFileStream *stream, SecScanSpec *spec, int *cha
1478:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 4476              		.loc 1 1478 1
 4477              		.cfi_startproc
 4478 0000 F30F1EFA 		endbr64
 4479 0004 55       		pushq	%rbp
 4480              	.LCFI117:
 4481              		.cfi_def_cfa_offset 16
 4482              		.cfi_offset 6, -16
 4483 0005 4889E5   		movq	%rsp, %rbp
 4484              	.LCFI118:
 4485              		.cfi_def_cfa_register 6
 4486 0008 4883EC40 		subq	$64, %rsp
 4487 000c 897DDC   		movl	%edi, -36(%rbp)
GAS LISTING /tmp/cc1ytava.s 			page 116


 4488 000f 488975D0 		movq	%rsi, -48(%rbp)
 4489 0013 488955C8 		movq	%rdx, -56(%rbp)
 4490 0017 48894DC0 		movq	%rcx, -64(%rbp)
 4491              		.loc 1 1478 1
 4492 001b 64488B04 		movq	%fs:40, %rax
 4492      25280000 
 4492      00
 4493 0024 488945F8 		movq	%rax, -8(%rbp)
 4494 0028 31C0     		xorl	%eax, %eax
1479:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecInt ch = firstCh;
 4495              		.loc 1 1479 12
 4496 002a 8B45DC   		movl	-36(%rbp), %eax
 4497 002d 8945EC   		movl	%eax, -20(%rbp)
1480:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     int loopFlag = 0;
 4498              		.loc 1 1480 9
 4499 0030 C745F000 		movl	$0, -16(%rbp)
 4499      000000
1481:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     int started = -1;
 4500              		.loc 1 1481 9
 4501 0037 C745F4FF 		movl	$-1, -12(%rbp)
 4501      FFFFFF
1482:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     while (loopFlag == 0) {
 4502              		.loc 1 1482 11
 4503 003e EB7E     		jmp	.L306
 4504              	.L310:
1483:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* decode ch to number */
1484:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         loopFlag = SecDecodeNumber(ch, spec);
 4505              		.loc 1 1484 20
 4506 0040 488B55C8 		movq	-56(%rbp), %rdx
 4507 0044 8B45EC   		movl	-20(%rbp), %eax
 4508 0047 4889D6   		movq	%rdx, %rsi
 4509 004a 89C7     		movl	%eax, %edi
 4510 004c E8000000 		call	SecDecodeNumber
 4510      00
 4511 0051 8945F0   		movl	%eax, -16(%rbp)
1485:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (loopFlag == 0) {
 4512              		.loc 1 1485 12
 4513 0054 837DF000 		cmpl	$0, -16(%rbp)
 4514 0058 754F     		jne	.L307
1486:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             started = 0;
 4515              		.loc 1 1486 21
 4516 005a C745F400 		movl	$0, -12(%rbp)
 4516      000000
1487:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (spec->widthSet != 0 && --spec->width == 0) {
 4517              		.loc 1 1487 21
 4518 0061 488B45C8 		movq	-56(%rbp), %rax
 4519 0065 8B4034   		movl	52(%rax), %eax
 4520              		.loc 1 1487 16
 4521 0068 85C0     		testl	%eax, %eax
 4522 006a 7425     		je	.L308
 4523              		.loc 1 1487 46 discriminator 1
 4524 006c 488B45C8 		movq	-56(%rbp), %rax
 4525 0070 8B4030   		movl	48(%rax), %eax
 4526              		.loc 1 1487 40 discriminator 1
 4527 0073 8D50FF   		leal	-1(%rax), %edx
 4528              		.loc 1 1487 37 discriminator 1
 4529 0076 488B45C8 		movq	-56(%rbp), %rax
GAS LISTING /tmp/cc1ytava.s 			page 117


 4530 007a 895030   		movl	%edx, 48(%rax)
 4531              		.loc 1 1487 46 discriminator 1
 4532 007d 488B45C8 		movq	-56(%rbp), %rax
 4533 0081 8B4030   		movl	48(%rax), %eax
 4534              		.loc 1 1487 37 discriminator 1
 4535 0084 85C0     		testl	%eax, %eax
 4536 0086 7509     		jne	.L308
1488:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 loopFlag = 1;
 4537              		.loc 1 1488 26
 4538 0088 C745F001 		movl	$1, -16(%rbp)
 4538      000000
 4539 008f EB2D     		jmp	.L306
 4540              	.L308:
1489:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             } else {
1490:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 ch = SecGetChar(stream, charCount);
 4541              		.loc 1 1490 22
 4542 0091 488B55C0 		movq	-64(%rbp), %rdx
 4543 0095 488B45D0 		movq	-48(%rbp), %rax
 4544 0099 4889D6   		movq	%rdx, %rsi
 4545 009c 4889C7   		movq	%rax, %rdi
 4546 009f E8000000 		call	SecGetChar
 4546      00
 4547 00a4 8945EC   		movl	%eax, -20(%rbp)
 4548 00a7 EB15     		jmp	.L306
 4549              	.L307:
1491:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1492:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         } else {
1493:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SecUnGetChar(ch, stream, charCount);
 4550              		.loc 1 1493 13
 4551 00a9 488B55C0 		movq	-64(%rbp), %rdx
 4552 00ad 488B4DD0 		movq	-48(%rbp), %rcx
 4553 00b1 8B45EC   		movl	-20(%rbp), %eax
 4554 00b4 4889CE   		movq	%rcx, %rsi
 4555 00b7 89C7     		movl	%eax, %edi
 4556 00b9 E8000000 		call	SecUnGetChar
 4556      00
 4557              	.L306:
1482:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* decode ch to number */
 4558              		.loc 1 1482 11
 4559 00be 837DF000 		cmpl	$0, -16(%rbp)
 4560 00c2 0F8478FF 		je	.L310
 4560      FFFF
1494:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1495:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1496:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1497:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     /* Handling integer negative numbers and beyond max */
1498:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     (*g_secFinishNumber[spec->isInt64Arg])(spec);
 4561              		.loc 1 1498 29
 4562 00c8 488B45C8 		movq	-56(%rbp), %rax
 4563 00cc 8B4014   		movl	20(%rax), %eax
 4564              		.loc 1 1498 6
 4565 00cf 4898     		cltq
 4566 00d1 488D14C5 		leaq	0(,%rax,8), %rdx
 4566      00000000 
 4567 00d9 488D0500 		leaq	g_secFinishNumber(%rip), %rax
 4567      000000
 4568 00e0 488B1402 		movq	(%rdx,%rax), %rdx
GAS LISTING /tmp/cc1ytava.s 			page 118


 4569 00e4 488B45C8 		movq	-56(%rbp), %rax
 4570 00e8 4889C7   		movq	%rax, %rdi
 4571 00eb FFD2     		call	*%rdx
 4572              	.LVL3:
1499:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return started;
 4573              		.loc 1 1499 12
 4574 00ed 8B45F4   		movl	-12(%rbp), %eax
1500:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1501:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 4575              		.loc 1 1501 1
 4576 00f0 488B4DF8 		movq	-8(%rbp), %rcx
 4577 00f4 6448330C 		xorq	%fs:40, %rcx
 4577      25280000 
 4577      00
 4578 00fd 7405     		je	.L312
 4579 00ff E8000000 		call	__stack_chk_fail@PLT
 4579      00
 4580              	.L312:
 4581 0104 C9       		leave
 4582              	.LCFI119:
 4583              		.cfi_def_cfa 7, 8
 4584 0105 C3       		ret
 4585              		.cfi_endproc
 4586              	.LFE45:
 4588              		.section	.text.SecInputNumber,"ax",@progbits
 4590              	SecInputNumber:
 4591              	.LFB46:
1502:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1503:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
1504:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * scan %d %i %o %u %x %p.
1505:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * return 0 OK
1506:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
1507:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static int SecInputNumber(SecFileStream *stream, SecScanSpec *spec, int *charCount)
1508:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 4592              		.loc 1 1508 1
 4593              		.cfi_startproc
 4594 0000 F30F1EFA 		endbr64
 4595 0004 55       		pushq	%rbp
 4596              	.LCFI120:
 4597              		.cfi_def_cfa_offset 16
 4598              		.cfi_offset 6, -16
 4599 0005 4889E5   		movq	%rsp, %rbp
 4600              	.LCFI121:
 4601              		.cfi_def_cfa_register 6
 4602 0008 4883EC30 		subq	$48, %rsp
 4603 000c 48897DE8 		movq	%rdi, -24(%rbp)
 4604 0010 488975E0 		movq	%rsi, -32(%rbp)
 4605 0014 488955D8 		movq	%rdx, -40(%rbp)
 4606              		.loc 1 1508 1
 4607 0018 64488B04 		movq	%fs:40, %rax
 4607      25280000 
 4607      00
 4608 0021 488945F8 		movq	%rax, -8(%rbp)
 4609 0025 31C0     		xorl	%eax, %eax
1509:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecInt ch = SecGetChar(stream, charCount);
 4610              		.loc 1 1509 17
 4611 0027 488B55D8 		movq	-40(%rbp), %rdx
GAS LISTING /tmp/cc1ytava.s 			page 119


 4612 002b 488B45E8 		movq	-24(%rbp), %rax
 4613 002f 4889D6   		movq	%rdx, %rsi
 4614 0032 4889C7   		movq	%rax, %rdi
 4615 0035 E8000000 		call	SecGetChar
 4615      00
 4616 003a 8945F4   		movl	%eax, -12(%rbp)
1510:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1511:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (ch == SECUREC_CHAR('+') || ch == SECUREC_CHAR('-')) {
 4617              		.loc 1 1511 8
 4618 003d 837DF42B 		cmpl	$43, -12(%rbp)
 4619 0041 7406     		je	.L314
 4620              		.loc 1 1511 33 discriminator 1
 4621 0043 837DF42D 		cmpl	$45, -12(%rbp)
 4622 0047 7558     		jne	.L315
 4623              	.L314:
1512:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (ch == SECUREC_CHAR('-')) {
 4624              		.loc 1 1512 12
 4625 0049 837DF42D 		cmpl	$45, -12(%rbp)
 4626 004d 750B     		jne	.L316
1513:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->negative = 1;
 4627              		.loc 1 1513 28
 4628 004f 488B45E0 		movq	-32(%rbp), %rax
 4629 0053 C7401801 		movl	$1, 24(%rax)
 4629      000000
 4630              	.L316:
1514:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1515:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec->widthSet != 0 && --spec->width == 0) {
 4631              		.loc 1 1515 17
 4632 005a 488B45E0 		movq	-32(%rbp), %rax
 4633 005e 8B4034   		movl	52(%rax), %eax
 4634              		.loc 1 1515 12
 4635 0061 85C0     		testl	%eax, %eax
 4636 0063 7426     		je	.L317
 4637              		.loc 1 1515 42 discriminator 1
 4638 0065 488B45E0 		movq	-32(%rbp), %rax
 4639 0069 8B4030   		movl	48(%rax), %eax
 4640              		.loc 1 1515 36 discriminator 1
 4641 006c 8D50FF   		leal	-1(%rax), %edx
 4642              		.loc 1 1515 33 discriminator 1
 4643 006f 488B45E0 		movq	-32(%rbp), %rax
 4644 0073 895030   		movl	%edx, 48(%rax)
 4645              		.loc 1 1515 42 discriminator 1
 4646 0076 488B45E0 		movq	-32(%rbp), %rax
 4647 007a 8B4030   		movl	48(%rax), %eax
 4648              		.loc 1 1515 33 discriminator 1
 4649 007d 85C0     		testl	%eax, %eax
 4650 007f 750A     		jne	.L317
1516:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             return -1;
 4651              		.loc 1 1516 20
 4652 0081 B8FFFFFF 		movl	$-1, %eax
 4652      FF
 4653 0086 E9270100 		jmp	.L318
 4653      00
 4654              	.L317:
1517:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         } else {
1518:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             ch = SecGetChar(stream, charCount);
 4655              		.loc 1 1518 18
GAS LISTING /tmp/cc1ytava.s 			page 120


 4656 008b 488B55D8 		movq	-40(%rbp), %rdx
 4657 008f 488B45E8 		movq	-24(%rbp), %rax
 4658 0093 4889D6   		movq	%rdx, %rsi
 4659 0096 4889C7   		movq	%rax, %rdi
 4660 0099 E8000000 		call	SecGetChar
 4660      00
 4661 009e 8945F4   		movl	%eax, -12(%rbp)
 4662              	.L315:
1519:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1520:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1521:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1522:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (spec->oriComChr == SECUREC_CHAR('i')) {
 4663              		.loc 1 1522 13
 4664 00a1 488B45E0 		movq	-32(%rbp), %rax
 4665 00a5 8B403C   		movl	60(%rax), %eax
 4666              		.loc 1 1522 8
 4667 00a8 83F869   		cmpl	$105, %eax
 4668 00ab 750B     		jne	.L319
1523:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* i could be d, o, or x, use d as default */
1524:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec->comChr = SECUREC_CHAR('d');
 4669              		.loc 1 1524 22
 4670 00ad 488B45E0 		movq	-32(%rbp), %rax
 4671 00b1 C7403864 		movl	$100, 56(%rax)
 4671      000000
 4672              	.L319:
1525:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1526:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1527:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (spec->oriComChr == SECUREC_CHAR('x') || spec->oriComChr == SECUREC_CHAR('i')) {
 4673              		.loc 1 1527 13
 4674 00b8 488B45E0 		movq	-32(%rbp), %rax
 4675 00bc 8B403C   		movl	60(%rax), %eax
 4676              		.loc 1 1527 8
 4677 00bf 83F878   		cmpl	$120, %eax
 4678 00c2 7410     		je	.L320
 4679              		.loc 1 1527 53 discriminator 1
 4680 00c4 488B45E0 		movq	-32(%rbp), %rax
 4681 00c8 8B403C   		movl	60(%rax), %eax
 4682              		.loc 1 1527 46 discriminator 1
 4683 00cb 83F869   		cmpl	$105, %eax
 4684 00ce 0F85C800 		jne	.L321
 4684      0000
 4685              	.L320:
1528:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (ch != SECUREC_CHAR('0')) {
 4686              		.loc 1 1528 12
 4687 00d4 837DF430 		cmpl	$48, -12(%rbp)
 4688 00d8 741B     		je	.L322
1529:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             /* scan number */
1530:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             return SecInputNumberDigital(ch, stream, spec, charCount);
 4689              		.loc 1 1530 20
 4690 00da 488B4DD8 		movq	-40(%rbp), %rcx
 4691 00de 488B55E0 		movq	-32(%rbp), %rdx
 4692 00e2 488B75E8 		movq	-24(%rbp), %rsi
 4693 00e6 8B45F4   		movl	-12(%rbp), %eax
 4694 00e9 89C7     		movl	%eax, %edi
 4695 00eb E8000000 		call	SecInputNumberDigital
 4695      00
 4696 00f0 E9BD0000 		jmp	.L318
GAS LISTING /tmp/cc1ytava.s 			page 121


 4696      00
 4697              	.L322:
1531:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1532:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* now input string may be 0x123 or 0X123 or just 0 */
1533:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* get next char */
1534:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ch = SecGetChar(stream, charCount);
 4698              		.loc 1 1534 14
 4699 00f5 488B55D8 		movq	-40(%rbp), %rdx
 4700 00f9 488B45E8 		movq	-24(%rbp), %rax
 4701 00fd 4889D6   		movq	%rdx, %rsi
 4702 0100 4889C7   		movq	%rax, %rdi
 4703 0103 E8000000 		call	SecGetChar
 4703      00
 4704 0108 8945F4   		movl	%eax, -12(%rbp)
1535:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if ((SecChar)(ch) == SECUREC_CHAR('x') || (SecChar)ch == SECUREC_CHAR('X')) {
 4705              		.loc 1 1535 12
 4706 010b 837DF478 		cmpl	$120, -12(%rbp)
 4707 010f 7406     		je	.L323
 4708              		.loc 1 1535 48 discriminator 1
 4709 0111 837DF458 		cmpl	$88, -12(%rbp)
 4710 0115 7552     		jne	.L324
 4711              	.L323:
1536:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->comChr = SECUREC_CHAR('x');
 4712              		.loc 1 1536 26
 4713 0117 488B45E0 		movq	-32(%rbp), %rax
 4714 011b C7403878 		movl	$120, 56(%rax)
 4714      000000
1537:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             ch = SecGetChar(stream, charCount);
 4715              		.loc 1 1537 18
 4716 0122 488B55D8 		movq	-40(%rbp), %rdx
 4717 0126 488B45E8 		movq	-24(%rbp), %rax
 4718 012a 4889D6   		movq	%rdx, %rsi
 4719 012d 4889C7   		movq	%rax, %rdi
 4720 0130 E8000000 		call	SecGetChar
 4720      00
 4721 0135 8945F4   		movl	%eax, -12(%rbp)
1538:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             /* length of 0x is 2 */
1539:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (spec->widthSet != 0 && spec->width <= (1 + 1)) {
 4722              		.loc 1 1539 21
 4723 0138 488B45E0 		movq	-32(%rbp), %rax
 4724 013c 8B4034   		movl	52(%rax), %eax
 4725              		.loc 1 1539 16
 4726 013f 85C0     		testl	%eax, %eax
 4727 0141 7413     		je	.L325
 4728              		.loc 1 1539 44 discriminator 1
 4729 0143 488B45E0 		movq	-32(%rbp), %rax
 4730 0147 8B4030   		movl	48(%rax), %eax
 4731              		.loc 1 1539 37 discriminator 1
 4732 014a 83F802   		cmpl	$2, %eax
 4733 014d 7F07     		jg	.L325
1540:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 /* length not enough for "0x" */
1541:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 return -1;
 4734              		.loc 1 1541 24
 4735 014f B8FFFFFF 		movl	$-1, %eax
 4735      FF
 4736 0154 EB5C     		jmp	.L318
 4737              	.L325:
GAS LISTING /tmp/cc1ytava.s 			page 122


1542:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1543:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             spec->width -= 2; /* Subtract 2 for the length of "0x" */
 4738              		.loc 1 1543 25
 4739 0156 488B45E0 		movq	-32(%rbp), %rax
 4740 015a 8B4030   		movl	48(%rax), %eax
 4741 015d 8D50FE   		leal	-2(%rax), %edx
 4742 0160 488B45E0 		movq	-32(%rbp), %rax
 4743 0164 895030   		movl	%edx, 48(%rax)
 4744 0167 EB33     		jmp	.L321
 4745              	.L324:
1544:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         } else {
1545:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (spec->oriComChr != SECUREC_CHAR('x')) {
 4746              		.loc 1 1545 21
 4747 0169 488B45E0 		movq	-32(%rbp), %rax
 4748 016d 8B403C   		movl	60(%rax), %eax
 4749              		.loc 1 1545 16
 4750 0170 83F878   		cmpl	$120, %eax
 4751 0173 740B     		je	.L326
1546:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec->comChr = SECUREC_CHAR('o');
 4752              		.loc 1 1546 30
 4753 0175 488B45E0 		movq	-32(%rbp), %rax
 4754 0179 C740386F 		movl	$111, 56(%rax)
 4754      000000
 4755              	.L326:
1547:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1548:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             /* unset the character after 0 back to stream, input only '0' result is OK */
1549:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SecUnGetChar(ch, stream, charCount);
 4756              		.loc 1 1549 13
 4757 0180 488B55D8 		movq	-40(%rbp), %rdx
 4758 0184 488B4DE8 		movq	-24(%rbp), %rcx
 4759 0188 8B45F4   		movl	-12(%rbp), %eax
 4760 018b 4889CE   		movq	%rcx, %rsi
 4761 018e 89C7     		movl	%eax, %edi
 4762 0190 E8000000 		call	SecUnGetChar
 4762      00
1550:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             ch = SECUREC_CHAR('0');
 4763              		.loc 1 1550 16
 4764 0195 C745F430 		movl	$48, -12(%rbp)
 4764      000000
 4765              	.L321:
1551:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1552:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1553:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     /* scan number */
1554:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return SecInputNumberDigital(ch, stream, spec, charCount);
 4766              		.loc 1 1554 12
 4767 019c 488B4DD8 		movq	-40(%rbp), %rcx
 4768 01a0 488B55E0 		movq	-32(%rbp), %rdx
 4769 01a4 488B75E8 		movq	-24(%rbp), %rsi
 4770 01a8 8B45F4   		movl	-12(%rbp), %eax
 4771 01ab 89C7     		movl	%eax, %edi
 4772 01ad E8000000 		call	SecInputNumberDigital
 4772      00
 4773              	.L318:
1555:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 4774              		.loc 1 1555 1
 4775 01b2 488B4DF8 		movq	-8(%rbp), %rcx
 4776 01b6 6448330C 		xorq	%fs:40, %rcx
GAS LISTING /tmp/cc1ytava.s 			page 123


 4776      25280000 
 4776      00
 4777 01bf 7405     		je	.L327
 4778 01c1 E8000000 		call	__stack_chk_fail@PLT
 4778      00
 4779              	.L327:
 4780 01c6 C9       		leave
 4781              	.LCFI122:
 4782              		.cfi_def_cfa 7, 8
 4783 01c7 C3       		ret
 4784              		.cfi_endproc
 4785              	.LFE46:
 4787              		.section	.text.SecInputString,"ax",@progbits
 4789              	SecInputString:
 4790              	.LFB47:
1556:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
1557:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * scan %c %s %[
1558:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * return 0 OK
1559:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
1560:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static int SecInputString(SecFileStream *stream, SecScanSpec *spec,
1561:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     const SecBracketTable *bracketTable, int *charCount, int *doneCount)
1562:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 4791              		.loc 1 1562 1
 4792              		.cfi_startproc
 4793 0000 F30F1EFA 		endbr64
 4794 0004 55       		pushq	%rbp
 4795              	.LCFI123:
 4796              		.cfi_def_cfa_offset 16
 4797              		.cfi_offset 6, -16
 4798 0005 4889E5   		movq	%rsp, %rbp
 4799              	.LCFI124:
 4800              		.cfi_def_cfa_register 6
 4801 0008 4883EC50 		subq	$80, %rsp
 4802 000c 48897DD8 		movq	%rdi, -40(%rbp)
 4803 0010 488975D0 		movq	%rsi, -48(%rbp)
 4804 0014 488955C8 		movq	%rdx, -56(%rbp)
 4805 0018 48894DC0 		movq	%rcx, -64(%rbp)
 4806 001c 4C8945B8 		movq	%r8, -72(%rbp)
 4807              		.loc 1 1562 1
 4808 0020 64488B04 		movq	%fs:40, %rax
 4808      25280000 
 4808      00
 4809 0029 488945F8 		movq	%rax, -8(%rbp)
 4810 002d 31C0     		xorl	%eax, %eax
1563:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     void *startPtr = spec->argPtr;
 4811              		.loc 1 1563 11
 4812 002f 488B45D0 		movq	-48(%rbp), %rax
 4813 0033 488B4020 		movq	32(%rax), %rax
 4814 0037 488945F0 		movq	%rax, -16(%rbp)
1564:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     int suppressed= 0;
 4815              		.loc 1 1564 9
 4816 003b C745E400 		movl	$0, -28(%rbp)
 4816      000000
1565:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     int errNoMem = 0;
 4817              		.loc 1 1565 9
 4818 0042 C745E800 		movl	$0, -24(%rbp)
 4818      000000
GAS LISTING /tmp/cc1ytava.s 			page 124


1566:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1567:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     while (spec->widthSet == 0 || spec->width-- != 0) {
 4819              		.loc 1 1567 11
 4820 0049 E9030100 		jmp	.L329
 4820      00
 4821              	.L338:
 4822              	.LBB17:
1568:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SecInt ch = SecGetChar(stream, charCount);
 4823              		.loc 1 1568 21
 4824 004e 488B55C0 		movq	-64(%rbp), %rdx
 4825 0052 488B45D8 		movq	-40(%rbp), %rax
 4826 0056 4889D6   		movq	%rdx, %rsi
 4827 0059 4889C7   		movq	%rax, %rdi
 4828 005c E8000000 		call	SecGetChar
 4828      00
 4829 0061 8945EC   		movl	%eax, -20(%rbp)
1569:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* char  condition or string condition and bracket condition.
1570:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****          * only supports  wide characters with a maximum length of two bytes
1571:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****          */
1572:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if ((ch != SECUREC_EOF) && (spec->comChr == SECUREC_CHAR('c') ||
 4830              		.loc 1 1572 12
 4831 0064 837DECFF 		cmpl	$-1, -20(%rbp)
 4832 0068 0F84CC00 		je	.L330
 4832      0000
 4833              		.loc 1 1572 41 discriminator 1
 4834 006e 488B45D0 		movq	-48(%rbp), %rax
 4835 0072 8B4038   		movl	56(%rax), %eax
 4836              		.loc 1 1572 33 discriminator 1
 4837 0075 83F863   		cmpl	$99, %eax
 4838 0078 7479     		je	.L331
1573:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SECUREC_SCANF_STRING_CONDITION(spec->comChr, ch) ||
 4839              		.loc 1 1573 13 discriminator 2
 4840 007a 488B45D0 		movq	-48(%rbp), %rax
 4841 007e 8B4038   		movl	56(%rax), %eax
1572:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SECUREC_SCANF_STRING_CONDITION(spec->comChr, ch) ||
 4842              		.loc 1 1572 71 discriminator 2
 4843 0081 83F873   		cmpl	$115, %eax
 4844 0084 7512     		jne	.L332
 4845              		.loc 1 1573 13
 4846 0086 837DEC08 		cmpl	$8, -20(%rbp)
 4847 008a 7606     		jbe	.L333
 4848              		.loc 1 1573 13 is_stmt 0 discriminator 2
 4849 008c 837DEC0D 		cmpl	$13, -20(%rbp)
 4850 0090 7606     		jbe	.L332
 4851              	.L333:
 4852              		.loc 1 1573 13 discriminator 3
 4853 0092 837DEC20 		cmpl	$32, -20(%rbp)
 4854 0096 755B     		jne	.L331
 4855              	.L332:
1574:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SECUREC_SCANF_BRACKET_CONDITION(spec->comChr, ch, bracketTable->table, bracketTable->ma
 4856              		.loc 1 1574 13 is_stmt 1 discriminator 5
 4857 0098 488B45D0 		movq	-48(%rbp), %rax
 4858 009c 8B4038   		movl	56(%rax), %eax
1573:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SECUREC_SCANF_STRING_CONDITION(spec->comChr, ch) ||
 4859              		.loc 1 1573 62 discriminator 5
 4860 009f 83F87B   		cmpl	$123, %eax
 4861 00a2 0F859200 		jne	.L330
GAS LISTING /tmp/cc1ytava.s 			page 125


 4861      0000
 4862              		.loc 1 1574 13
 4863 00a8 488B45C8 		movq	-56(%rbp), %rax
 4864 00ac 488B00   		movq	(%rax), %rax
 4865 00af 4885C0   		testq	%rax, %rax
 4866 00b2 0F848200 		je	.L330
 4866      0000
 4867              		.loc 1 1574 13 is_stmt 0 discriminator 1
 4868 00b8 488B45C8 		movq	-56(%rbp), %rax
 4869 00bc 488B00   		movq	(%rax), %rax
 4870 00bf 8B55EC   		movl	-20(%rbp), %edx
 4871 00c2 C1EA03   		shrl	$3, %edx
 4872 00c5 89D2     		movl	%edx, %edx
 4873 00c7 81E2FF1F 		andl	$8191, %edx
 4873      0000
 4874 00cd 4801D0   		addq	%rdx, %rax
 4875 00d0 0FB610   		movzbl	(%rax), %edx
 4876 00d3 488B45C8 		movq	-56(%rbp), %rax
 4877 00d7 0FB64008 		movzbl	8(%rax), %eax
 4878 00db 31D0     		xorl	%edx, %eax
 4879 00dd 0FB6D0   		movzbl	%al, %edx
 4880 00e0 8B45EC   		movl	-20(%rbp), %eax
 4881 00e3 83E007   		andl	$7, %eax
 4882 00e6 89C1     		movl	%eax, %ecx
 4883 00e8 D3FA     		sarl	%cl, %edx
 4884 00ea 89D0     		movl	%edx, %eax
 4885 00ec 83E001   		andl	$1, %eax
 4886 00ef 85C0     		testl	%eax, %eax
 4887 00f1 7447     		je	.L330
 4888              	.L331:
1575:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (spec->suppress != 0) {
 4889              		.loc 1 1575 21 is_stmt 1
 4890 00f3 488B45D0 		movq	-48(%rbp), %rax
 4891 00f7 0FB64041 		movzbl	65(%rax), %eax
 4892              		.loc 1 1575 16
 4893 00fb 84C0     		testb	%al, %al
 4894 00fd 7409     		je	.L334
1576:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 /* Used to identify processed data for %*
1577:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                  * use endPtr to identify will cause 613, so use suppressed
1578:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                  */
1579:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 suppressed = 1;
 4895              		.loc 1 1579 28
 4896 00ff C745E401 		movl	$1, -28(%rbp)
 4896      000000
1580:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 continue;
 4897              		.loc 1 1580 17
 4898 0106 EB49     		jmp	.L329
 4899              	.L334:
1581:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1582:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             /* now suppress is not set */
1583:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (spec->arrayWidth == 0) {
 4900              		.loc 1 1583 21
 4901 0108 488B45D0 		movq	-48(%rbp), %rax
 4902 010c 488B4028 		movq	40(%rax), %rax
 4903              		.loc 1 1583 16
 4904 0110 4885C0   		testq	%rax, %rax
 4905 0113 7509     		jne	.L335
GAS LISTING /tmp/cc1ytava.s 			page 126


1584:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 errNoMem = 1; /* We have exhausted the user's buffer */
 4906              		.loc 1 1584 26
 4907 0115 C745E801 		movl	$1, -24(%rbp)
 4907      000000
1585:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 break;
 4908              		.loc 1 1585 17
 4909 011c EB5E     		jmp	.L336
 4910              	.L335:
1586:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1587:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_FOR_WCHAR
1588:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             errNoMem = SecInputForWchar(ch, spec);
 4911              		.loc 1 1588 24
 4912 011e 488B55D0 		movq	-48(%rbp), %rdx
 4913 0122 8B45EC   		movl	-20(%rbp), %eax
 4914 0125 4889D6   		movq	%rdx, %rsi
 4915 0128 89C7     		movl	%eax, %edi
 4916 012a E8000000 		call	SecInputForWchar
 4916      00
 4917 012f 8945E8   		movl	%eax, -24(%rbp)
1589:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
1590:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             errNoMem = SecInputForChar(ch, spec, stream, charCount);
1591:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1592:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (errNoMem != 0) {
 4918              		.loc 1 1592 16
 4919 0132 837DE800 		cmpl	$0, -24(%rbp)
 4920 0136 7543     		jne	.L348
 4921 0138 EB17     		jmp	.L329
 4922              	.L330:
1593:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 break;
1594:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1595:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         } else {
1596:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SecUnGetChar(ch, stream, charCount);
 4923              		.loc 1 1596 13
 4924 013a 488B55C0 		movq	-64(%rbp), %rdx
 4925 013e 488B4DD8 		movq	-40(%rbp), %rcx
 4926 0142 8B45EC   		movl	-20(%rbp), %eax
 4927 0145 4889CE   		movq	%rcx, %rsi
 4928 0148 89C7     		movl	%eax, %edi
 4929 014a E8000000 		call	SecUnGetChar
 4929      00
1597:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             break;
 4930              		.loc 1 1597 13
 4931 014f EB2B     		jmp	.L336
 4932              	.L329:
 4933              	.LBE17:
1567:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SecInt ch = SecGetChar(stream, charCount);
 4934              		.loc 1 1567 16
 4935 0151 488B45D0 		movq	-48(%rbp), %rax
 4936 0155 8B4034   		movl	52(%rax), %eax
1567:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SecInt ch = SecGetChar(stream, charCount);
 4937              		.loc 1 1567 11
 4938 0158 85C0     		testl	%eax, %eax
 4939 015a 0F84EEFE 		je	.L338
 4939      FFFF
1567:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SecInt ch = SecGetChar(stream, charCount);
 4940              		.loc 1 1567 39 discriminator 1
 4941 0160 488B45D0 		movq	-48(%rbp), %rax
GAS LISTING /tmp/cc1ytava.s 			page 127


 4942 0164 8B4030   		movl	48(%rax), %eax
1567:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SecInt ch = SecGetChar(stream, charCount);
 4943              		.loc 1 1567 46 discriminator 1
 4944 0167 8D48FF   		leal	-1(%rax), %ecx
 4945 016a 488B55D0 		movq	-48(%rbp), %rdx
 4946 016e 894A30   		movl	%ecx, 48(%rdx)
1567:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SecInt ch = SecGetChar(stream, charCount);
 4947              		.loc 1 1567 32 discriminator 1
 4948 0171 85C0     		testl	%eax, %eax
 4949 0173 0F85D5FE 		jne	.L338
 4949      FFFF
 4950 0179 EB01     		jmp	.L336
 4951              	.L348:
 4952              	.LBB18:
1593:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 break;
 4953              		.loc 1 1593 17
 4954 017b 90       		nop
 4955              	.L336:
 4956              	.LBE18:
1598:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1599:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1600:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1601:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (errNoMem != 0) {
 4957              		.loc 1 1601 8
 4958 017c 837DE800 		cmpl	$0, -24(%rbp)
 4959 0180 7426     		je	.L339
1602:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* In case of error, blank out the input buffer */
1603:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec->suppress == 0) {
 4960              		.loc 1 1603 17
 4961 0182 488B45D0 		movq	-48(%rbp), %rax
 4962 0186 0FB64041 		movzbl	65(%rax), %eax
 4963              		.loc 1 1603 12
 4964 018a 84C0     		testb	%al, %al
 4965 018c 7513     		jne	.L340
1604:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SecAddEndingZero(startPtr, spec);
 4966              		.loc 1 1604 13
 4967 018e 488B55D0 		movq	-48(%rbp), %rdx
 4968 0192 488B45F0 		movq	-16(%rbp), %rax
 4969 0196 4889D6   		movq	%rdx, %rsi
 4970 0199 4889C7   		movq	%rax, %rdi
 4971 019c E8000000 		call	SecAddEndingZero
 4971      00
 4972              	.L340:
1605:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1606:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return -1;
 4973              		.loc 1 1606 16
 4974 01a1 B8FFFFFF 		movl	$-1, %eax
 4974      FF
 4975 01a6 EB76     		jmp	.L341
 4976              	.L339:
1607:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1608:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1609:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     /* No input was scanned */
1610:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if ((spec->suppress != 0 && suppressed == 0) ||
 4977              		.loc 1 1610 14
 4978 01a8 488B45D0 		movq	-48(%rbp), %rax
 4979 01ac 0FB64041 		movzbl	65(%rax), %eax
GAS LISTING /tmp/cc1ytava.s 			page 128


 4980              		.loc 1 1610 8
 4981 01b0 84C0     		testb	%al, %al
 4982 01b2 7406     		je	.L342
 4983              		.loc 1 1610 30 discriminator 1
 4984 01b4 837DE400 		cmpl	$0, -28(%rbp)
 4985 01b8 741A     		je	.L343
 4986              	.L342:
1611:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         (spec->suppress == 0 && startPtr == spec->argPtr)) {
 4987              		.loc 1 1611 14 discriminator 3
 4988 01ba 488B45D0 		movq	-48(%rbp), %rax
 4989 01be 0FB64041 		movzbl	65(%rax), %eax
1610:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         (spec->suppress == 0 && startPtr == spec->argPtr)) {
 4990              		.loc 1 1610 50 discriminator 3
 4991 01c2 84C0     		testb	%al, %al
 4992 01c4 7515     		jne	.L344
 4993              		.loc 1 1611 49
 4994 01c6 488B45D0 		movq	-48(%rbp), %rax
 4995 01ca 488B4020 		movq	32(%rax), %rax
 4996              		.loc 1 1611 30
 4997 01ce 483945F0 		cmpq	%rax, -16(%rbp)
 4998 01d2 7507     		jne	.L344
 4999              	.L343:
1612:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return -1;
 5000              		.loc 1 1612 16
 5001 01d4 B8FFFFFF 		movl	$-1, %eax
 5001      FF
 5002 01d9 EB43     		jmp	.L341
 5003              	.L344:
1613:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1614:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1615:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (spec->suppress == 0) {
 5004              		.loc 1 1615 13
 5005 01db 488B45D0 		movq	-48(%rbp), %rax
 5006 01df 0FB64041 		movzbl	65(%rax), %eax
 5007              		.loc 1 1615 8
 5008 01e3 84C0     		testb	%al, %al
 5009 01e5 7532     		jne	.L345
1616:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec->comChr != 'c') {
 5010              		.loc 1 1616 17
 5011 01e7 488B45D0 		movq	-48(%rbp), %rax
 5012 01eb 8B4038   		movl	56(%rax), %eax
 5013              		.loc 1 1616 12
 5014 01ee 83F863   		cmpl	$99, %eax
 5015 01f1 7417     		je	.L346
1617:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             /* null-terminate strings */
1618:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SecAddEndingZero(spec->argPtr, spec);
 5016              		.loc 1 1618 13
 5017 01f3 488B45D0 		movq	-48(%rbp), %rax
 5018 01f7 488B4020 		movq	32(%rax), %rax
 5019 01fb 488B55D0 		movq	-48(%rbp), %rdx
 5020 01ff 4889D6   		movq	%rdx, %rsi
 5021 0202 4889C7   		movq	%rax, %rdi
 5022 0205 E8000000 		call	SecAddEndingZero
 5022      00
 5023              	.L346:
1619:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1620:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         *doneCount = *doneCount + 1;
GAS LISTING /tmp/cc1ytava.s 			page 129


 5024              		.loc 1 1620 22
 5025 020a 488B45B8 		movq	-72(%rbp), %rax
 5026 020e 8B00     		movl	(%rax), %eax
 5027              		.loc 1 1620 33
 5028 0210 8D5001   		leal	1(%rax), %edx
 5029              		.loc 1 1620 20
 5030 0213 488B45B8 		movq	-72(%rbp), %rax
 5031 0217 8910     		movl	%edx, (%rax)
 5032              	.L345:
1621:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1622:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return 0;
 5033              		.loc 1 1622 12
 5034 0219 B8000000 		movl	$0, %eax
 5034      00
 5035              	.L341:
1623:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 5036              		.loc 1 1623 1
 5037 021e 488B75F8 		movq	-8(%rbp), %rsi
 5038 0222 64483334 		xorq	%fs:40, %rsi
 5038      25280000 
 5038      00
 5039 022b 7405     		je	.L347
 5040 022d E8000000 		call	__stack_chk_fail@PLT
 5040      00
 5041              	.L347:
 5042 0232 C9       		leave
 5043              	.LCFI125:
 5044              		.cfi_def_cfa 7, 8
 5045 0233 C3       		ret
 5046              		.cfi_endproc
 5047              	.LFE47:
 5049              		.section	.text.SecAllocBracketTable,"ax",@progbits
 5051              	SecAllocBracketTable:
 5052              	.LFB48:
1624:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1625:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_FOR_WCHAR
1626:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
1627:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * alloce buffer for wchar version of %[.
1628:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * return 0 OK
1629:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
1630:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static int SecAllocBracketTable(SecBracketTable *bracketTable)
1631:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 5053              		.loc 1 1631 1
 5054              		.cfi_startproc
 5055 0000 F30F1EFA 		endbr64
 5056 0004 55       		pushq	%rbp
 5057              	.LCFI126:
 5058              		.cfi_def_cfa_offset 16
 5059              		.cfi_offset 6, -16
 5060 0005 4889E5   		movq	%rsp, %rbp
 5061              	.LCFI127:
 5062              		.cfi_def_cfa_register 6
 5063 0008 4883EC20 		subq	$32, %rsp
 5064 000c 48897DE8 		movq	%rdi, -24(%rbp)
 5065              		.loc 1 1631 1
 5066 0010 64488B04 		movq	%fs:40, %rax
 5066      25280000 
GAS LISTING /tmp/cc1ytava.s 			page 130


 5066      00
 5067 0019 488945F8 		movq	%rax, -8(%rbp)
 5068 001d 31C0     		xorl	%eax, %eax
1632:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (bracketTable->table == NULL) {
 5069              		.loc 1 1632 21
 5070 001f 488B45E8 		movq	-24(%rbp), %rax
 5071 0023 488B00   		movq	(%rax), %rax
 5072              		.loc 1 1632 8
 5073 0026 4885C0   		testq	%rax, %rax
 5074 0029 7527     		jne	.L350
1633:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* table should be freed after use */
1634:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         bracketTable->table = (unsigned char *)SECUREC_MALLOC(SECUREC_BRACKET_TABLE_SIZE);
 5075              		.loc 1 1634 48
 5076 002b BF002000 		movl	$8192, %edi
 5076      00
 5077 0030 E8000000 		call	malloc@PLT
 5077      00
 5078 0035 4889C2   		movq	%rax, %rdx
 5079              		.loc 1 1634 29
 5080 0038 488B45E8 		movq	-24(%rbp), %rax
 5081 003c 488910   		movq	%rdx, (%rax)
1635:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (bracketTable->table == NULL) {
 5082              		.loc 1 1635 25
 5083 003f 488B45E8 		movq	-24(%rbp), %rax
 5084 0043 488B00   		movq	(%rax), %rax
 5085              		.loc 1 1635 12
 5086 0046 4885C0   		testq	%rax, %rax
 5087 0049 7507     		jne	.L350
1636:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             return -1;
 5088              		.loc 1 1636 20
 5089 004b B8FFFFFF 		movl	$-1, %eax
 5089      FF
 5090 0050 EB05     		jmp	.L351
 5091              	.L350:
1637:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1638:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1639:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return 0;
 5092              		.loc 1 1639 12
 5093 0052 B8000000 		movl	$0, %eax
 5093      00
 5094              	.L351:
1640:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 5095              		.loc 1 1640 1
 5096 0057 488B4DF8 		movq	-8(%rbp), %rcx
 5097 005b 6448330C 		xorq	%fs:40, %rcx
 5097      25280000 
 5097      00
 5098 0064 7405     		je	.L352
 5099 0066 E8000000 		call	__stack_chk_fail@PLT
 5099      00
 5100              	.L352:
 5101 006b C9       		leave
 5102              	.LCFI128:
 5103              		.cfi_def_cfa 7, 8
 5104 006c C3       		ret
 5105              		.cfi_endproc
 5106              	.LFE48:
GAS LISTING /tmp/cc1ytava.s 			page 131


 5108              		.section	.text.SecFreeBracketTable,"ax",@progbits
 5110              	SecFreeBracketTable:
 5111              	.LFB49:
1641:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1642:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
1643:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * free buffer for wchar version of %[
1644:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
1645:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecFreeBracketTable(SecBracketTable *bracketTable)
1646:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 5112              		.loc 1 1646 1
 5113              		.cfi_startproc
 5114 0000 F30F1EFA 		endbr64
 5115 0004 55       		pushq	%rbp
 5116              	.LCFI129:
 5117              		.cfi_def_cfa_offset 16
 5118              		.cfi_offset 6, -16
 5119 0005 4889E5   		movq	%rsp, %rbp
 5120              	.LCFI130:
 5121              		.cfi_def_cfa_register 6
 5122 0008 4883EC20 		subq	$32, %rsp
 5123 000c 48897DE8 		movq	%rdi, -24(%rbp)
 5124              		.loc 1 1646 1
 5125 0010 64488B04 		movq	%fs:40, %rax
 5125      25280000 
 5125      00
 5126 0019 488945F8 		movq	%rax, -8(%rbp)
 5127 001d 31C0     		xorl	%eax, %eax
1647:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (bracketTable->table != NULL) {
 5128              		.loc 1 1647 21
 5129 001f 488B45E8 		movq	-24(%rbp), %rax
 5130 0023 488B00   		movq	(%rax), %rax
 5131              		.loc 1 1647 8
 5132 0026 4885C0   		testq	%rax, %rax
 5133 0029 741A     		je	.L356
1648:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SECUREC_FREE(bracketTable->table);
 5134              		.loc 1 1648 9
 5135 002b 488B45E8 		movq	-24(%rbp), %rax
 5136 002f 488B00   		movq	(%rax), %rax
 5137 0032 4889C7   		movq	%rax, %rdi
 5138 0035 E8000000 		call	free@PLT
 5138      00
1649:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         bracketTable->table = NULL;
 5139              		.loc 1 1649 29
 5140 003a 488B45E8 		movq	-24(%rbp), %rax
 5141 003e 48C70000 		movq	$0, (%rax)
 5141      000000
 5142              	.L356:
1650:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1651:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 5143              		.loc 1 1651 1
 5144 0045 90       		nop
 5145 0046 488B45F8 		movq	-8(%rbp), %rax
 5146 004a 64483304 		xorq	%fs:40, %rax
 5146      25280000 
 5146      00
 5147 0053 7405     		je	.L355
 5148 0055 E8000000 		call	__stack_chk_fail@PLT
GAS LISTING /tmp/cc1ytava.s 			page 132


 5148      00
 5149              	.L355:
 5150 005a C9       		leave
 5151              	.LCFI131:
 5152              		.cfi_def_cfa 7, 8
 5153 005b C3       		ret
 5154              		.cfi_endproc
 5155              	.LFE49:
 5157              		.section	.text.SecInputSW,"ax",@progbits
 5158              		.globl	SecInputSW
 5160              	SecInputSW:
 5161              	.LFB50:
1652:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1653:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1654:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_FOR_WCHAR
1655:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
1656:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  *  Formatting input core functions for wchar version.Called by a function such as vsscanf_s
1657:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
1658:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** int SecInputSW(SecFileStream *stream, const wchar_t *cFormat, va_list argList)
1659:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
1660:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
1661:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  * Formatting input core functions for char version.Called by a function such as vswscanf_s
1662:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
1663:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** int SecInputS(SecFileStream *stream, const char *cFormat, va_list argList)
1664:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1665:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 5162              		.loc 1 1665 1
 5163              		.cfi_startproc
 5164 0000 F30F1EFA 		endbr64
 5165 0004 55       		pushq	%rbp
 5166              	.LCFI132:
 5167              		.cfi_def_cfa_offset 16
 5168              		.cfi_offset 6, -16
 5169 0005 4889E5   		movq	%rsp, %rbp
 5170              	.LCFI133:
 5171              		.cfi_def_cfa_register 6
 5172 0008 4881EC50 		subq	$1616, %rsp
 5172      060000
 5173 000f 4889BDC8 		movq	%rdi, -1592(%rbp)
 5173      F9FFFF
 5174 0016 4889B5C0 		movq	%rsi, -1600(%rbp)
 5174      F9FFFF
 5175 001d 488995B8 		movq	%rdx, -1608(%rbp)
 5175      F9FFFF
 5176              		.loc 1 1665 1
 5177 0024 64488B04 		movq	%fs:40, %rax
 5177      25280000 
 5177      00
 5178 002d 488945F8 		movq	%rax, -8(%rbp)
 5179 0031 31C0     		xorl	%eax, %eax
1666:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     const SecUnsignedChar *format = (const SecUnsignedChar *)cFormat;
 5180              		.loc 1 1666 28
 5181 0033 488B85C0 		movq	-1600(%rbp), %rax
 5181      F9FFFF
 5182 003a 488985F8 		movq	%rax, -1544(%rbp)
 5182      F9FFFF
1667:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecBracketTable bracketTable = SECUREC_INIT_BRACKET_TABLE;
GAS LISTING /tmp/cc1ytava.s 			page 133


 5183              		.loc 1 1667 21
 5184 0041 48C78500 		movq	$0, -1536(%rbp)
 5184      FAFFFF00 
 5184      000000
 5185 004c C68508FA 		movb	$0, -1528(%rbp)
 5185      FFFF00
1668:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecScanSpec spec;
1669:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecInt ch = 0;
 5186              		.loc 1 1669 12
 5187 0053 C785E0F9 		movl	$0, -1568(%rbp)
 5187      FFFF0000 
 5187      0000
1670:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     int charCount = 0;
 5188              		.loc 1 1670 9
 5189 005d C785D8F9 		movl	$0, -1576(%rbp)
 5189      FFFF0000 
 5189      0000
1671:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     int doneCount = 0;
 5190              		.loc 1 1671 9
 5191 0067 C785DCF9 		movl	$0, -1572(%rbp)
 5191      FFFF0000 
 5191      0000
1672:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     int formatError = 0;
 5192              		.loc 1 1672 9
 5193 0071 C785E4F9 		movl	$0, -1564(%rbp)
 5193      FFFF0000 
 5193      0000
1673:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     int paraIsNull = 0;
 5194              		.loc 1 1673 9
 5195 007b C785E8F9 		movl	$0, -1560(%rbp)
 5195      FFFF0000 
 5195      0000
1674:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if SECUREC_ENABLE_SCANF_FLOAT
1675:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecFloatSpec floatSpec;
1676:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1677:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     int match = 0;
 5196              		.loc 1 1677 9
 5197 0085 C785ECF9 		movl	$0, -1556(%rbp)
 5197      FFFF0000 
 5197      0000
1678:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     int errRet = 0;
 5198              		.loc 1 1678 9
 5199 008f C785F0F9 		movl	$0, -1552(%rbp)
 5199      FFFF0000 
 5199      0000
1679:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if SECUREC_ENABLE_SCANF_FLOAT
1680:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecInitFloatSpec(&floatSpec);
 5200              		.loc 1 1680 5
 5201 0099 488D8560 		leaq	-1440(%rbp), %rax
 5201      FAFFFF
 5202 00a0 4889C7   		movq	%rax, %rdi
 5203 00a3 E8000000 		call	SecInitFloatSpec
 5203      00
1681:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1682:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     /* format must not NULL */
1683:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     /* use err < 1 to claer 845 */
1684:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     while (errRet < 1 && *format != SECUREC_CHAR('\0')) {
GAS LISTING /tmp/cc1ytava.s 			page 134


 5204              		.loc 1 1684 11
 5205 00a8 E9AA0800 		jmp	.L358
 5205      00
 5206              	.L409:
1685:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* skip space in format and space in input */
1686:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (SECUREC_IS_SPACE(*format)) {
 5207              		.loc 1 1686 13
 5208 00ad 488B85F8 		movq	-1544(%rbp), %rax
 5208      F9FFFF
 5209 00b4 8B00     		movl	(%rax), %eax
 5210 00b6 89C7     		movl	%eax, %edi
 5211 00b8 E8000000 		call	iswspace@PLT
 5211      00
 5212              		.loc 1 1686 12
 5213 00bd 85C0     		testl	%eax, %eax
 5214 00bf 7451     		je	.L359
 5215              	.LBB19:
1687:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SecInt nonSpaceChar = SecSkipSpaceChar(stream, &charCount);
 5216              		.loc 1 1687 35
 5217 00c1 488D95D8 		leaq	-1576(%rbp), %rdx
 5217      F9FFFF
 5218 00c8 488B85C8 		movq	-1592(%rbp), %rax
 5218      F9FFFF
 5219 00cf 4889D6   		movq	%rdx, %rsi
 5220 00d2 4889C7   		movq	%rax, %rdi
 5221 00d5 E8000000 		call	SecSkipSpaceChar
 5221      00
 5222 00da 8985F4F9 		movl	%eax, -1548(%rbp)
 5222      FFFF
1688:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             /* eat all space chars and put fist no space char backup */
1689:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SecUnGetChar(nonSpaceChar, stream, &charCount);
 5223              		.loc 1 1689 13
 5224 00e0 488D95D8 		leaq	-1576(%rbp), %rdx
 5224      F9FFFF
 5225 00e7 488B8DC8 		movq	-1592(%rbp), %rcx
 5225      F9FFFF
 5226 00ee 8B85F4F9 		movl	-1548(%rbp), %eax
 5226      FFFF
 5227 00f4 4889CE   		movq	%rcx, %rsi
 5228 00f7 89C7     		movl	%eax, %edi
 5229 00f9 E8000000 		call	SecUnGetChar
 5229      00
1690:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SecSkipSpaceFormat(&format);
 5230              		.loc 1 1690 13
 5231 00fe 488D85F8 		leaq	-1544(%rbp), %rax
 5231      F9FFFF
 5232 0105 4889C7   		movq	%rax, %rdi
 5233 0108 E8000000 		call	SecSkipSpaceFormat
 5233      00
1691:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             continue;
 5234              		.loc 1 1691 13
 5235 010d E9450800 		jmp	.L358
 5235      00
 5236              	.L359:
 5237              	.LBE19:
1692:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1693:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
GAS LISTING /tmp/cc1ytava.s 			page 135


1694:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (*format != SECUREC_CHAR('%')) {
 5238              		.loc 1 1694 13
 5239 0112 488B85F8 		movq	-1544(%rbp), %rax
 5239      F9FFFF
 5240 0119 8B00     		movl	(%rax), %eax
 5241              		.loc 1 1694 12
 5242 011b 83F825   		cmpl	$37, %eax
 5243 011e 0F84A100 		je	.L360
 5243      0000
1695:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             ch = SecGetChar(stream, &charCount);
 5244              		.loc 1 1695 18
 5245 0124 488D95D8 		leaq	-1576(%rbp), %rdx
 5245      F9FFFF
 5246 012b 488B85C8 		movq	-1592(%rbp), %rax
 5246      F9FFFF
 5247 0132 4889D6   		movq	%rdx, %rsi
 5248 0135 4889C7   		movq	%rax, %rdi
 5249 0138 E8000000 		call	SecGetChar
 5249      00
 5250 013d 8985E0F9 		movl	%eax, -1568(%rbp)
 5250      FFFF
1696:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if ((int)(*format++) != (int)(ch)) {
 5251              		.loc 1 1696 30
 5252 0143 488B85F8 		movq	-1544(%rbp), %rax
 5252      F9FFFF
 5253 014a 488D5004 		leaq	4(%rax), %rdx
 5254 014e 488995F8 		movq	%rdx, -1544(%rbp)
 5254      F9FFFF
 5255              		.loc 1 1696 23
 5256 0155 8B10     		movl	(%rax), %edx
 5257              		.loc 1 1696 34
 5258 0157 8B85E0F9 		movl	-1568(%rbp), %eax
 5258      FFFF
 5259              		.loc 1 1696 16
 5260 015d 39C2     		cmpl	%eax, %edx
 5261 015f 742A     		je	.L361
1697:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 SecUnGetChar(ch, stream, &charCount);
 5262              		.loc 1 1697 17
 5263 0161 488D95D8 		leaq	-1576(%rbp), %rdx
 5263      F9FFFF
 5264 0168 488B8DC8 		movq	-1592(%rbp), %rcx
 5264      F9FFFF
 5265 016f 8B85E0F9 		movl	-1568(%rbp), %eax
 5265      FFFF
 5266 0175 4889CE   		movq	%rcx, %rsi
 5267 0178 89C7     		movl	%eax, %edi
 5268 017a E8000000 		call	SecUnGetChar
 5268      00
1698:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 ++errRet; /* use plus to clear 845 */
 5269              		.loc 1 1698 17
 5270 017f 8385F0F9 		addl	$1, -1552(%rbp)
 5270      FFFF01
1699:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 continue;
 5271              		.loc 1 1699 17
 5272 0186 E9CC0700 		jmp	.L358
 5272      00
 5273              	.L361:
GAS LISTING /tmp/cc1ytava.s 			page 136


1700:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1701:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifndef SECUREC_FOR_WCHAR
1702:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (SecIsLeadByte(ch) && SecDecodeLeadByte(ch, &format, stream, &charCount) != 0) {
1703:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 ++errRet;
1704:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 continue;
1705:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1706:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1707:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             /* for next %n */
1708:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if ((ch == SECUREC_EOF) && ((*format != SECUREC_CHAR('%')) || (*(format + 1) != SECUREC
 5274              		.loc 1 1708 16
 5275 018b 83BDE0F9 		cmpl	$-1, -1568(%rbp)
 5275      FFFFFF
 5276 0192 0F85BF07 		jne	.L358
 5276      0000
 5277              		.loc 1 1708 42 discriminator 1
 5278 0198 488B85F8 		movq	-1544(%rbp), %rax
 5278      F9FFFF
 5279 019f 8B00     		movl	(%rax), %eax
 5280              		.loc 1 1708 37 discriminator 1
 5281 01a1 83F825   		cmpl	$37, %eax
 5282 01a4 0F85C707 		jne	.L363
 5282      0000
 5283              		.loc 1 1708 85 discriminator 2
 5284 01aa 488B85F8 		movq	-1544(%rbp), %rax
 5284      F9FFFF
 5285 01b1 4883C004 		addq	$4, %rax
 5286              		.loc 1 1708 76 discriminator 2
 5287 01b5 8B00     		movl	(%rax), %eax
 5288              		.loc 1 1708 72 discriminator 2
 5289 01b7 83F86E   		cmpl	$110, %eax
 5290 01ba 0F85B107 		jne	.L363
 5290      0000
1709:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 break;
1710:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1711:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             continue;
 5291              		.loc 1 1711 13
 5292 01c0 E9920700 		jmp	.L358
 5292      00
 5293              	.L360:
1712:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1713:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1714:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* now *format is % */
1715:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* set default value for each % */
1716:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SecSetDefaultScanSpec(&spec);
 5294              		.loc 1 1716 9
 5295 01c5 488D8510 		leaq	-1520(%rbp), %rax
 5295      FAFFFF
 5296 01cc 4889C7   		movq	%rax, %rdi
 5297 01cf E8000000 		call	SecSetDefaultScanSpec
 5297      00
1717:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (SecDecodeScanFlag(&format, &spec) != 0) {
 5298              		.loc 1 1717 13
 5299 01d4 488D9510 		leaq	-1520(%rbp), %rdx
 5299      FAFFFF
 5300 01db 488D85F8 		leaq	-1544(%rbp), %rax
 5300      F9FFFF
 5301 01e2 4889D6   		movq	%rdx, %rsi
GAS LISTING /tmp/cc1ytava.s 			page 137


 5302 01e5 4889C7   		movq	%rax, %rdi
 5303 01e8 E8000000 		call	SecDecodeScanFlag
 5303      00
 5304              		.loc 1 1717 12
 5305 01ed 85C0     		testl	%eax, %eax
 5306 01ef 7416     		je	.L364
1718:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             formatError = 1;
 5307              		.loc 1 1718 25
 5308 01f1 C785E4F9 		movl	$1, -1564(%rbp)
 5308      FFFF0100 
 5308      0000
1719:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             ++errRet;
 5309              		.loc 1 1719 13
 5310 01fb 8385F0F9 		addl	$1, -1552(%rbp)
 5310      FFFF01
1720:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             continue;
 5311              		.loc 1 1720 13
 5312 0202 E9500700 		jmp	.L358
 5312      00
 5313              	.L364:
1721:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1722:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* update wchar flag for %S %C */
1723:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SecUpdateWcharFlagByType(*format, &spec);
 5314              		.loc 1 1723 9
 5315 0207 488B85F8 		movq	-1544(%rbp), %rax
 5315      F9FFFF
 5316 020e 8B00     		movl	(%rax), %eax
 5317 0210 488D9510 		leaq	-1520(%rbp), %rdx
 5317      FAFFFF
 5318 0217 4889D6   		movq	%rdx, %rsi
 5319 021a 89C7     		movl	%eax, %edi
 5320 021c E8000000 		call	SecUpdateWcharFlagByType
 5320      00
1724:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1725:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if SECUREC_HAVE_WCHART == 0
1726:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* in kernel not support wide char */
1727:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec.isWChar > 0) {
1728:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             formatError = 1;
1729:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             ++errRet;
1730:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             continue;
1731:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1732:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1733:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec.widthSet != 0 && spec.width == 0) {
 5321              		.loc 1 1733 17
 5322 0221 8B8544FA 		movl	-1468(%rbp), %eax
 5322      FFFF
 5323              		.loc 1 1733 12
 5324 0227 85C0     		testl	%eax, %eax
 5325 0229 7416     		je	.L365
 5326              		.loc 1 1733 39 discriminator 1
 5327 022b 8B8540FA 		movl	-1472(%rbp), %eax
 5327      FFFF
 5328              		.loc 1 1733 32 discriminator 1
 5329 0231 85C0     		testl	%eax, %eax
 5330 0233 750C     		jne	.L365
1734:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             /* 0 width in format */
1735:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             ++errRet;
GAS LISTING /tmp/cc1ytava.s 			page 138


 5331              		.loc 1 1735 13
 5332 0235 8385F0F9 		addl	$1, -1552(%rbp)
 5332      FFFF01
1736:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             continue;
 5333              		.loc 1 1736 13
 5334 023c E9160700 		jmp	.L358
 5334      00
 5335              	.L365:
1737:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1738:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1739:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec.comChr = (unsigned char)(*format) | (SECUREC_CHAR('a') - SECUREC_CHAR('A')); /* to low
 5336              		.loc 1 1739 39
 5337 0241 488B85F8 		movq	-1544(%rbp), %rax
 5337      F9FFFF
 5338 0248 8B00     		movl	(%rax), %eax
 5339              		.loc 1 1739 48
 5340 024a 83C820   		orl	$32, %eax
 5341 024d 0FB6C0   		movzbl	%al, %eax
 5342              		.loc 1 1739 21
 5343 0250 898548FA 		movl	%eax, -1464(%rbp)
 5343      FFFF
1740:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         spec.oriComChr = spec.comChr;
 5344              		.loc 1 1740 30
 5345 0256 8B8548FA 		movl	-1464(%rbp), %eax
 5345      FFFF
 5346              		.loc 1 1740 24
 5347 025c 89854CFA 		movl	%eax, -1460(%rbp)
 5347      FFFF
1741:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1742:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (spec.comChr != SECUREC_CHAR('n')) {
 5348              		.loc 1 1742 17
 5349 0262 8B8548FA 		movl	-1464(%rbp), %eax
 5349      FFFF
 5350              		.loc 1 1742 12
 5351 0268 83F86E   		cmpl	$110, %eax
 5352 026b 746B     		je	.L366
1743:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (spec.comChr != SECUREC_CHAR('c') && spec.comChr != SECUREC_BRACE) {
 5353              		.loc 1 1743 21
 5354 026d 8B8548FA 		movl	-1464(%rbp), %eax
 5354      FFFF
 5355              		.loc 1 1743 16
 5356 0273 83F863   		cmpl	$99, %eax
 5357 0276 742C     		je	.L367
 5358              		.loc 1 1743 57 discriminator 1
 5359 0278 8B8548FA 		movl	-1464(%rbp), %eax
 5359      FFFF
 5360              		.loc 1 1743 50 discriminator 1
 5361 027e 83F87B   		cmpl	$123, %eax
 5362 0281 7421     		je	.L367
1744:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 ch = SecSkipSpaceChar(stream, &charCount);
 5363              		.loc 1 1744 22
 5364 0283 488D95D8 		leaq	-1576(%rbp), %rdx
 5364      F9FFFF
 5365 028a 488B85C8 		movq	-1592(%rbp), %rax
 5365      F9FFFF
 5366 0291 4889D6   		movq	%rdx, %rsi
 5367 0294 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/cc1ytava.s 			page 139


 5368 0297 E8000000 		call	SecSkipSpaceChar
 5368      00
 5369 029c 8985E0F9 		movl	%eax, -1568(%rbp)
 5369      FFFF
 5370              		.loc 1 1744 20
 5371 02a2 EB1F     		jmp	.L368
 5372              	.L367:
1745:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             } else {
1746:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 ch = SecGetChar(stream, &charCount);
 5373              		.loc 1 1746 22
 5374 02a4 488D95D8 		leaq	-1576(%rbp), %rdx
 5374      F9FFFF
 5375 02ab 488B85C8 		movq	-1592(%rbp), %rax
 5375      F9FFFF
 5376 02b2 4889D6   		movq	%rdx, %rsi
 5377 02b5 4889C7   		movq	%rax, %rdi
 5378 02b8 E8000000 		call	SecGetChar
 5378      00
 5379 02bd 8985E0F9 		movl	%eax, -1568(%rbp)
 5379      FFFF
 5380              	.L368:
1747:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1748:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (ch == SECUREC_EOF) {
 5381              		.loc 1 1748 16
 5382 02c3 83BDE0F9 		cmpl	$-1, -1568(%rbp)
 5382      FFFFFF
 5383 02ca 750C     		jne	.L366
1749:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 ++errRet;
 5384              		.loc 1 1749 17
 5385 02cc 8385F0F9 		addl	$1, -1552(%rbp)
 5385      FFFF01
1750:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 continue;
 5386              		.loc 1 1750 17
 5387 02d3 E97F0600 		jmp	.L358
 5387      00
 5388              	.L366:
1751:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1752:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1753:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1754:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* now no 0 width in format and get one char from input */
1755:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         switch (spec.comChr) {
 5389              		.loc 1 1755 21
 5390 02d8 8B8548FA 		movl	-1464(%rbp), %eax
 5390      FFFF
 5391 02de 83E863   		subl	$99, %eax
 5392 02e1 83F818   		cmpl	$24, %eax
 5393 02e4 0F87D405 		ja	.L369
 5393      0000
 5394 02ea 89C0     		movl	%eax, %eax
 5395 02ec 488D1485 		leaq	0(,%rax,4), %rdx
 5395      00000000 
 5396 02f4 488D0500 		leaq	.L371(%rip), %rax
 5396      000000
 5397 02fb 8B0402   		movl	(%rdx,%rax), %eax
 5398 02fe 4898     		cltq
 5399 0300 488D1500 		leaq	.L371(%rip), %rdx
 5399      000000
GAS LISTING /tmp/cc1ytava.s 			page 140


 5400 0307 4801D0   		addq	%rdx, %rax
 5401 030a 3EFFE0   		notrack jmp	*%rax
 5402              		.section	.rodata.SecInputSW,"a",@progbits
 5403              		.align 4
 5404              		.align 4
 5405              	.L371:
 5406 0000 00000000 		.long	.L370-.L371
 5407 0004 00000000 		.long	.L372-.L371
 5408 0008 00000000 		.long	.L375-.L371
 5409 000c 00000000 		.long	.L375-.L371
 5410 0010 00000000 		.long	.L375-.L371
 5411 0014 00000000 		.long	.L369-.L371
 5412 0018 00000000 		.long	.L372-.L371
 5413 001c 00000000 		.long	.L369-.L371
 5414 0020 00000000 		.long	.L369-.L371
 5415 0024 00000000 		.long	.L369-.L371
 5416 0028 00000000 		.long	.L369-.L371
 5417 002c 00000000 		.long	.L374-.L371
 5418 0030 00000000 		.long	.L372-.L371
 5419 0034 00000000 		.long	.L373-.L371
 5420 0038 00000000 		.long	.L369-.L371
 5421 003c 00000000 		.long	.L369-.L371
 5422 0040 00000000 		.long	.L370-.L371
 5423 0044 00000000 		.long	.L369-.L371
 5424 0048 00000000 		.long	.L372-.L371
 5425 004c 00000000 		.long	.L369-.L371
 5426 0050 00000000 		.long	.L369-.L371
 5427 0054 00000000 		.long	.L372-.L371
 5428 0058 00000000 		.long	.L369-.L371
 5429 005c 00000000 		.long	.L369-.L371
 5430 0060 00000000 		.long	.L370-.L371
 5431              		.section	.text.SecInputSW
 5432              	.L370:
1756:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             case SECUREC_CHAR('c'): /* also 'C' */
1757:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 /* fall-through */ /* FALLTHRU */
1758:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             case SECUREC_CHAR('s'): /* also 'S': */
1759:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 /* fall-through */ /* FALLTHRU */
1760:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             case SECUREC_BRACE:
1761:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 /* check dest buffer and size */
1762:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 if (spec.suppress == 0) {
 5433              		.loc 1 1762 25
 5434 030d 0FB68551 		movzbl	-1455(%rbp), %eax
 5434      FAFFFF
 5435              		.loc 1 1762 20
 5436 0314 84C0     		testb	%al, %al
 5437 0316 0F855501 		jne	.L376
 5437      0000
1763:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     spec.argPtr = (void *)va_arg(argList, void *);
 5438              		.loc 1 1763 35
 5439 031c 488B85B8 		movq	-1608(%rbp), %rax
 5439      F9FFFF
 5440 0323 8B00     		movl	(%rax), %eax
 5441 0325 83F82F   		cmpl	$47, %eax
 5442 0328 7730     		ja	.L377
 5443 032a 488B85B8 		movq	-1608(%rbp), %rax
 5443      F9FFFF
 5444 0331 488B5010 		movq	16(%rax), %rdx
GAS LISTING /tmp/cc1ytava.s 			page 141


 5445 0335 488B85B8 		movq	-1608(%rbp), %rax
 5445      F9FFFF
 5446 033c 8B00     		movl	(%rax), %eax
 5447 033e 89C0     		movl	%eax, %eax
 5448 0340 4801D0   		addq	%rdx, %rax
 5449 0343 488B95B8 		movq	-1608(%rbp), %rdx
 5449      F9FFFF
 5450 034a 8B12     		movl	(%rdx), %edx
 5451 034c 8D4A08   		leal	8(%rdx), %ecx
 5452 034f 488B95B8 		movq	-1608(%rbp), %rdx
 5452      F9FFFF
 5453 0356 890A     		movl	%ecx, (%rdx)
 5454 0358 EB1A     		jmp	.L378
 5455              	.L377:
 5456 035a 488B85B8 		movq	-1608(%rbp), %rax
 5456      F9FFFF
 5457 0361 488B4008 		movq	8(%rax), %rax
 5458 0365 488D4808 		leaq	8(%rax), %rcx
 5459 0369 488B95B8 		movq	-1608(%rbp), %rdx
 5459      F9FFFF
 5460 0370 48894A08 		movq	%rcx, 8(%rdx)
 5461              	.L378:
 5462 0374 488B00   		movq	(%rax), %rax
 5463              		.loc 1 1763 33
 5464 0377 48898530 		movq	%rax, -1488(%rbp)
 5464      FAFFFF
1764:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     if (spec.argPtr == NULL) {
 5465              		.loc 1 1764 29
 5466 037e 488B8530 		movq	-1488(%rbp), %rax
 5466      FAFFFF
 5467              		.loc 1 1764 24
 5468 0385 4885C0   		testq	%rax, %rax
 5469 0388 7516     		jne	.L379
1765:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         paraIsNull = 1;
 5470              		.loc 1 1765 36
 5471 038a C785E8F9 		movl	$1, -1560(%rbp)
 5471      FFFF0100 
 5471      0000
1766:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         ++errRet;
 5472              		.loc 1 1766 25
 5473 0394 8385F0F9 		addl	$1, -1552(%rbp)
 5473      FFFF01
1767:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         continue;
 5474              		.loc 1 1767 25
 5475 039b E9B70500 		jmp	.L358
 5475      00
 5476              	.L379:
1768:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     }
1769:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     /* Get the next argument - size of the array in characters */
1770:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_ON_64BITS
1771:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     spec.arrayWidth = ((size_t)(va_arg(argList, size_t))) & 0xFFFFFFFFUL;
 5477              		.loc 1 1771 49
 5478 03a0 488B85B8 		movq	-1608(%rbp), %rax
 5478      F9FFFF
 5479 03a7 8B00     		movl	(%rax), %eax
 5480 03a9 83F82F   		cmpl	$47, %eax
 5481 03ac 7730     		ja	.L380
GAS LISTING /tmp/cc1ytava.s 			page 142


 5482 03ae 488B85B8 		movq	-1608(%rbp), %rax
 5482      F9FFFF
 5483 03b5 488B5010 		movq	16(%rax), %rdx
 5484 03b9 488B85B8 		movq	-1608(%rbp), %rax
 5484      F9FFFF
 5485 03c0 8B00     		movl	(%rax), %eax
 5486 03c2 89C0     		movl	%eax, %eax
 5487 03c4 4801D0   		addq	%rdx, %rax
 5488 03c7 488B95B8 		movq	-1608(%rbp), %rdx
 5488      F9FFFF
 5489 03ce 8B12     		movl	(%rdx), %edx
 5490 03d0 8D4A08   		leal	8(%rdx), %ecx
 5491 03d3 488B95B8 		movq	-1608(%rbp), %rdx
 5491      F9FFFF
 5492 03da 890A     		movl	%ecx, (%rdx)
 5493 03dc EB1A     		jmp	.L381
 5494              	.L380:
 5495 03de 488B85B8 		movq	-1608(%rbp), %rax
 5495      F9FFFF
 5496 03e5 488B4008 		movq	8(%rax), %rax
 5497 03e9 488D4808 		leaq	8(%rax), %rcx
 5498 03ed 488B95B8 		movq	-1608(%rbp), %rdx
 5498      F9FFFF
 5499 03f4 48894A08 		movq	%rcx, 8(%rdx)
 5500              	.L381:
 5501 03f8 488B00   		movq	(%rax), %rax
 5502              		.loc 1 1771 75
 5503 03fb 89C0     		movl	%eax, %eax
 5504              		.loc 1 1771 37
 5505 03fd 48898538 		movq	%rax, -1480(%rbp)
 5505      FAFFFF
1772:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else /* !SECUREC_ON_64BITS */
1773:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     spec.arrayWidth = (size_t)va_arg(argList, size_t);
1774:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1775:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     if (spec.arrayWidth == 0 || (spec.isWChar <= 0 && spec.arrayWidth > SECUREC_STR
 5506              		.loc 1 1775 29
 5507 0404 488B8538 		movq	-1480(%rbp), %rax
 5507      FAFFFF
 5508              		.loc 1 1775 24
 5509 040b 4885C0   		testq	%rax, %rax
 5510 040e 7436     		je	.L382
 5511              		.loc 1 1775 54 discriminator 1
 5512 0410 0FB68550 		movzbl	-1456(%rbp), %eax
 5512      FAFFFF
 5513              		.loc 1 1775 46 discriminator 1
 5514 0417 84C0     		testb	%al, %al
 5515 0419 7F11     		jg	.L383
 5516              		.loc 1 1775 75 discriminator 2
 5517 041b 488B8538 		movq	-1480(%rbp), %rax
 5517      FAFFFF
 5518              		.loc 1 1775 68 discriminator 2
 5519 0422 BA000000 		movl	$2147483648, %edx
 5519      80
 5520 0427 4839D0   		cmpq	%rdx, %rax
 5521 042a 731A     		jnb	.L382
 5522              	.L383:
1776:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         (spec.isWChar > 0 && spec.arrayWidth > SECUREC_WCHAR_STRING_MAX_LEN)) {
GAS LISTING /tmp/cc1ytava.s 			page 143


 5523              		.loc 1 1776 30 discriminator 4
 5524 042c 0FB68550 		movzbl	-1456(%rbp), %eax
 5524      FAFFFF
1775:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         (spec.isWChar > 0 && spec.arrayWidth > SECUREC_WCHAR_STRING_MAX_LEN)) {
 5525              		.loc 1 1775 113 discriminator 4
 5526 0433 84C0     		testb	%al, %al
 5527 0435 7E1B     		jle	.L384
 5528              		.loc 1 1776 50
 5529 0437 488B8538 		movq	-1480(%rbp), %rax
 5529      FAFFFF
 5530              		.loc 1 1776 43
 5531 043e 483DFFFF 		cmpq	$536870911, %rax
 5531      FF1F
 5532 0444 760C     		jbe	.L384
 5533              	.L382:
1777:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         /* do not clear buffer just go error */
1778:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         ++errRet;
 5534              		.loc 1 1778 25
 5535 0446 8385F0F9 		addl	$1, -1552(%rbp)
 5535      FFFF01
1779:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         continue;
 5536              		.loc 1 1779 25
 5537 044d E9050500 		jmp	.L358
 5537      00
 5538              	.L384:
1780:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     }
1781:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     /* One element is needed for '\0' for %s and %[ */
1782:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     if (spec.comChr != SECUREC_CHAR('c')) {
 5539              		.loc 1 1782 29
 5540 0452 8B8548FA 		movl	-1464(%rbp), %eax
 5540      FFFF
 5541              		.loc 1 1782 24
 5542 0458 83F863   		cmpl	$99, %eax
 5543 045b 741F     		je	.L385
1783:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         --spec.arrayWidth;
 5544              		.loc 1 1783 31
 5545 045d 488B8538 		movq	-1480(%rbp), %rax
 5545      FAFFFF
 5546              		.loc 1 1783 25
 5547 0464 4883E801 		subq	$1, %rax
 5548 0468 48898538 		movq	%rax, -1480(%rbp)
 5548      FAFFFF
 5549 046f EB0B     		jmp	.L385
 5550              	.L376:
1784:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     }
1785:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 } else {
1786:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     /*  Set argPtr to  NULL  is necessary, in supress mode we don't use argPtr to s
1787:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     spec.argPtr = NULL;
 5551              		.loc 1 1787 33
 5552 0471 48C78530 		movq	$0, -1488(%rbp)
 5552      FAFFFF00 
 5552      000000
 5553              	.L385:
1788:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 }
1789:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1790:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 if (spec.comChr == 'c') {
 5554              		.loc 1 1790 25
GAS LISTING /tmp/cc1ytava.s 			page 144


 5555 047c 8B8548FA 		movl	-1464(%rbp), %eax
 5555      FFFF
 5556              		.loc 1 1790 20
 5557 0482 83F863   		cmpl	$99, %eax
 5558 0485 7527     		jne	.L386
1791:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     if (spec.widthSet == 0) {
 5559              		.loc 1 1791 29
 5560 0487 8B8544FA 		movl	-1468(%rbp), %eax
 5560      FFFF
 5561              		.loc 1 1791 24
 5562 048d 85C0     		testl	%eax, %eax
 5563 048f 0F85D200 		jne	.L387
 5563      0000
1792:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         spec.widthSet = 1;
 5564              		.loc 1 1792 39
 5565 0495 C78544FA 		movl	$1, -1468(%rbp)
 5565      FFFF0100 
 5565      0000
1793:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         spec.width = 1;
 5566              		.loc 1 1793 36
 5567 049f C78540FA 		movl	$1, -1472(%rbp)
 5567      FFFF0100 
 5567      0000
 5568 04a9 E9B90000 		jmp	.L387
 5568      00
 5569              	.L386:
1794:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     }
1795:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 } else if (spec.comChr == SECUREC_BRACE) {
 5570              		.loc 1 1795 32
 5571 04ae 8B8548FA 		movl	-1464(%rbp), %eax
 5571      FFFF
 5572              		.loc 1 1795 27
 5573 04b4 83F87B   		cmpl	$123, %eax
 5574 04b7 0F85AA00 		jne	.L387
 5574      0000
1796:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     /* malloc  when  first %[ is meet  for wchar version */
1797:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_FOR_WCHAR
1798:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     if (SecAllocBracketTable(&bracketTable) != 0) {
 5575              		.loc 1 1798 25
 5576 04bd 488D8500 		leaq	-1536(%rbp), %rax
 5576      FAFFFF
 5577 04c4 4889C7   		movq	%rax, %rdi
 5578 04c7 E8000000 		call	SecAllocBracketTable
 5578      00
 5579              		.loc 1 1798 24
 5580 04cc 85C0     		testl	%eax, %eax
 5581 04ce 740C     		je	.L388
1799:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         ++errRet;
 5582              		.loc 1 1799 25
 5583 04d0 8385F0F9 		addl	$1, -1552(%rbp)
 5583      FFFF01
1800:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         continue;
 5584              		.loc 1 1800 25
 5585 04d7 E97B0400 		jmp	.L358
 5585      00
 5586              	.L388:
1801:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     }
GAS LISTING /tmp/cc1ytava.s 			page 145


1802:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1803:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1804:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     (void)memset(bracketTable.table, 0, (size_t)SECUREC_BRACKET_TABLE_SIZE);
 5587              		.loc 1 1804 46
 5588 04dc 488B8500 		movq	-1536(%rbp), %rax
 5588      FAFFFF
 5589              		.loc 1 1804 27
 5590 04e3 BA002000 		movl	$8192, %edx
 5590      00
 5591 04e8 BE000000 		movl	$0, %esi
 5591      00
 5592 04ed 4889C7   		movq	%rax, %rdi
 5593 04f0 E8000000 		call	memset@PLT
 5593      00
1805:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     if (SecSetupBracketTable(&format, &bracketTable) != 0) {
 5594              		.loc 1 1805 25
 5595 04f5 488D9500 		leaq	-1536(%rbp), %rdx
 5595      FAFFFF
 5596 04fc 488D85F8 		leaq	-1544(%rbp), %rax
 5596      F9FFFF
 5597 0503 4889D6   		movq	%rdx, %rsi
 5598 0506 4889C7   		movq	%rax, %rdi
 5599 0509 E8000000 		call	SecSetupBracketTable
 5599      00
 5600              		.loc 1 1805 24
 5601 050e 85C0     		testl	%eax, %eax
 5602 0510 740C     		je	.L389
1806:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         ++errRet;
 5603              		.loc 1 1806 25
 5604 0512 8385F0F9 		addl	$1, -1552(%rbp)
 5604      FFFF01
1807:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         continue;
 5605              		.loc 1 1807 25
 5606 0519 E9390400 		jmp	.L358
 5606      00
 5607              	.L389:
1808:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     }
1809:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1810:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     if (*format == SECUREC_CHAR('\0')) {
 5608              		.loc 1 1810 25
 5609 051e 488B85F8 		movq	-1544(%rbp), %rax
 5609      F9FFFF
 5610 0525 8B00     		movl	(%rax), %eax
 5611              		.loc 1 1810 24
 5612 0527 85C0     		testl	%eax, %eax
 5613 0529 753C     		jne	.L387
1811:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         if (spec.suppress == 0 && spec.arrayWidth > 0) {
 5614              		.loc 1 1811 33
 5615 052b 0FB68551 		movzbl	-1455(%rbp), %eax
 5615      FAFFFF
 5616              		.loc 1 1811 28
 5617 0532 84C0     		testb	%al, %al
 5618 0534 7525     		jne	.L390
 5619              		.loc 1 1811 55 discriminator 1
 5620 0536 488B8538 		movq	-1480(%rbp), %rax
 5620      FAFFFF
 5621              		.loc 1 1811 48 discriminator 1
GAS LISTING /tmp/cc1ytava.s 			page 146


 5622 053d 4885C0   		testq	%rax, %rax
 5623 0540 7419     		je	.L390
1812:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                             SecAddEndingZero(spec.argPtr, &spec);
 5624              		.loc 1 1812 29
 5625 0542 488B8530 		movq	-1488(%rbp), %rax
 5625      FAFFFF
 5626 0549 488D9510 		leaq	-1520(%rbp), %rdx
 5626      FAFFFF
 5627 0550 4889D6   		movq	%rdx, %rsi
 5628 0553 4889C7   		movq	%rax, %rdi
 5629 0556 E8000000 		call	SecAddEndingZero
 5629      00
 5630              	.L390:
1813:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         }
1814:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         ++errRet;
 5631              		.loc 1 1814 25
 5632 055b 8385F0F9 		addl	$1, -1552(%rbp)
 5632      FFFF01
1815:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         /* truncated format */
1816:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         continue;
 5633              		.loc 1 1816 25
 5634 0562 E9F00300 		jmp	.L358
 5634      00
 5635              	.L387:
1817:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     }
1818:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1819:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 }
1820:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 /* un set last char to stream */
1821:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 SecUnGetChar(ch, stream, &charCount);
 5636              		.loc 1 1821 17
 5637 0567 488D95D8 		leaq	-1576(%rbp), %rdx
 5637      F9FFFF
 5638 056e 488B8DC8 		movq	-1592(%rbp), %rcx
 5638      F9FFFF
 5639 0575 8B85E0F9 		movl	-1568(%rbp), %eax
 5639      FFFF
 5640 057b 4889CE   		movq	%rcx, %rsi
 5641 057e 89C7     		movl	%eax, %edi
 5642 0580 E8000000 		call	SecUnGetChar
 5642      00
1822:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 /* scanset completed.  Now read string */
1823:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 if (SecInputString(stream, &spec, &bracketTable, &charCount, &doneCount) != 0) {
 5643              		.loc 1 1823 21
 5644 0585 488DBDDC 		leaq	-1572(%rbp), %rdi
 5644      F9FFFF
 5645 058c 488D8DD8 		leaq	-1576(%rbp), %rcx
 5645      F9FFFF
 5646 0593 488D9500 		leaq	-1536(%rbp), %rdx
 5646      FAFFFF
 5647 059a 488DB510 		leaq	-1520(%rbp), %rsi
 5647      FAFFFF
 5648 05a1 488B85C8 		movq	-1592(%rbp), %rax
 5648      F9FFFF
 5649 05a8 4989F8   		movq	%rdi, %r8
 5650 05ab 4889C7   		movq	%rax, %rdi
 5651 05ae E8000000 		call	SecInputString
 5651      00
GAS LISTING /tmp/cc1ytava.s 			page 147


 5652              		.loc 1 1823 20
 5653 05b3 85C0     		testl	%eax, %eax
 5654 05b5 0F845003 		je	.L419
 5654      0000
1824:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     ++errRet;
 5655              		.loc 1 1824 21
 5656 05bb 8385F0F9 		addl	$1, -1552(%rbp)
 5656      FFFF01
1825:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     continue;
 5657              		.loc 1 1825 21
 5658 05c2 E9900300 		jmp	.L358
 5658      00
 5659              	.L373:
1826:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 }
1827:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 break;
1828:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             case SECUREC_CHAR('p'):
1829:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 /* make %hp same as %p */
1830:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec.numberWidth = SECUREC_NUM_WIDTH_INT;
 5660              		.loc 1 1830 34
 5661 05c7 C78520FA 		movl	$1, -1504(%rbp)
 5661      FFFF0100 
 5661      0000
1831:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_ON_64BITS
1832:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 spec.isInt64Arg = 1;
 5662              		.loc 1 1832 33
 5663 05d1 C78524FA 		movl	$1, -1500(%rbp)
 5663      FFFF0100 
 5663      0000
 5664              	.L372:
1833:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1834:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 /* fall-through */ /* FALLTHRU */
1835:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             case SECUREC_CHAR('o'):    /* fall-through */ /* FALLTHRU */
1836:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             case SECUREC_CHAR('u'):    /* fall-through */ /* FALLTHRU */
1837:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             case SECUREC_CHAR('d'):    /* fall-through */ /* FALLTHRU */
1838:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             case SECUREC_CHAR('i'):    /* fall-through */ /* FALLTHRU */
1839:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             case SECUREC_CHAR('x'):
1840:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 /* un set last char to stream */
1841:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 SecUnGetChar(ch, stream, &charCount);
 5665              		.loc 1 1841 17
 5666 05db 488D95D8 		leaq	-1576(%rbp), %rdx
 5666      F9FFFF
 5667 05e2 488B8DC8 		movq	-1592(%rbp), %rcx
 5667      F9FFFF
 5668 05e9 8B85E0F9 		movl	-1568(%rbp), %eax
 5668      FFFF
 5669 05ef 4889CE   		movq	%rcx, %rsi
 5670 05f2 89C7     		movl	%eax, %edi
 5671 05f4 E8000000 		call	SecUnGetChar
 5671      00
1842:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 if (SecInputNumber(stream, &spec, &charCount) != 0) {
 5672              		.loc 1 1842 21
 5673 05f9 488D95D8 		leaq	-1576(%rbp), %rdx
 5673      F9FFFF
 5674 0600 488D8D10 		leaq	-1520(%rbp), %rcx
 5674      FAFFFF
 5675 0607 488B85C8 		movq	-1592(%rbp), %rax
 5675      F9FFFF
GAS LISTING /tmp/cc1ytava.s 			page 148


 5676 060e 4889CE   		movq	%rcx, %rsi
 5677 0611 4889C7   		movq	%rax, %rdi
 5678 0614 E8000000 		call	SecInputNumber
 5678      00
 5679              		.loc 1 1842 20
 5680 0619 85C0     		testl	%eax, %eax
 5681 061b 740C     		je	.L393
1843:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     ++errRet;
 5682              		.loc 1 1843 21
 5683 061d 8385F0F9 		addl	$1, -1552(%rbp)
 5683      FFFF01
1844:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     continue;
 5684              		.loc 1 1844 21
 5685 0624 E92E0300 		jmp	.L358
 5685      00
 5686              	.L393:
1845:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 }
1846:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 if (spec.suppress == 0) {
 5687              		.loc 1 1846 25
 5688 0629 0FB68551 		movzbl	-1455(%rbp), %eax
 5688      FAFFFF
 5689              		.loc 1 1846 20
 5690 0630 84C0     		testb	%al, %al
 5691 0632 0F85D602 		jne	.L420
 5691      0000
1847:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     spec.argPtr = (void *)va_arg(argList, void *);
 5692              		.loc 1 1847 35
 5693 0638 488B85B8 		movq	-1608(%rbp), %rax
 5693      F9FFFF
 5694 063f 8B00     		movl	(%rax), %eax
 5695 0641 83F82F   		cmpl	$47, %eax
 5696 0644 7730     		ja	.L395
 5697 0646 488B85B8 		movq	-1608(%rbp), %rax
 5697      F9FFFF
 5698 064d 488B5010 		movq	16(%rax), %rdx
 5699 0651 488B85B8 		movq	-1608(%rbp), %rax
 5699      F9FFFF
 5700 0658 8B00     		movl	(%rax), %eax
 5701 065a 89C0     		movl	%eax, %eax
 5702 065c 4801D0   		addq	%rdx, %rax
 5703 065f 488B95B8 		movq	-1608(%rbp), %rdx
 5703      F9FFFF
 5704 0666 8B12     		movl	(%rdx), %edx
 5705 0668 8D4A08   		leal	8(%rdx), %ecx
 5706 066b 488B95B8 		movq	-1608(%rbp), %rdx
 5706      F9FFFF
 5707 0672 890A     		movl	%ecx, (%rdx)
 5708 0674 EB1A     		jmp	.L396
 5709              	.L395:
 5710 0676 488B85B8 		movq	-1608(%rbp), %rax
 5710      F9FFFF
 5711 067d 488B4008 		movq	8(%rax), %rax
 5712 0681 488D4808 		leaq	8(%rax), %rcx
 5713 0685 488B95B8 		movq	-1608(%rbp), %rdx
 5713      F9FFFF
 5714 068c 48894A08 		movq	%rcx, 8(%rdx)
 5715              	.L396:
GAS LISTING /tmp/cc1ytava.s 			page 149


 5716 0690 488B00   		movq	(%rax), %rax
 5717              		.loc 1 1847 33
 5718 0693 48898530 		movq	%rax, -1488(%rbp)
 5718      FAFFFF
1848:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     if (spec.argPtr == NULL) {
 5719              		.loc 1 1848 29
 5720 069a 488B8530 		movq	-1488(%rbp), %rax
 5720      FAFFFF
 5721              		.loc 1 1848 24
 5722 06a1 4885C0   		testq	%rax, %rax
 5723 06a4 7516     		jne	.L397
1849:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         paraIsNull = 1;
 5724              		.loc 1 1849 36
 5725 06a6 C785E8F9 		movl	$1, -1560(%rbp)
 5725      FFFF0100 
 5725      0000
1850:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         ++errRet;
 5726              		.loc 1 1850 25
 5727 06b0 8385F0F9 		addl	$1, -1552(%rbp)
 5727      FFFF01
1851:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         continue;
 5728              		.loc 1 1851 25
 5729 06b7 E99B0200 		jmp	.L358
 5729      00
 5730              	.L397:
1852:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     }
1853:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     SecAssignNumber(&spec);
 5731              		.loc 1 1853 21
 5732 06bc 488D8510 		leaq	-1520(%rbp), %rax
 5732      FAFFFF
 5733 06c3 4889C7   		movq	%rax, %rdi
 5734 06c6 E8000000 		call	SecAssignNumber
 5734      00
1854:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     ++doneCount;
 5735              		.loc 1 1854 21
 5736 06cb 8B85DCF9 		movl	-1572(%rbp), %eax
 5736      FFFF
 5737 06d1 83C001   		addl	$1, %eax
 5738 06d4 8985DCF9 		movl	%eax, -1572(%rbp)
 5738      FFFF
1855:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 }
1856:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 break;
 5739              		.loc 1 1856 17
 5740 06da E92F0200 		jmp	.L420
 5740      00
 5741              	.L374:
1857:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             case SECUREC_CHAR('n'):    /* char count */
1858:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 if (spec.suppress == 0) {
 5742              		.loc 1 1858 25
 5743 06df 0FB68551 		movzbl	-1455(%rbp), %eax
 5743      FAFFFF
 5744              		.loc 1 1858 20
 5745 06e6 84C0     		testb	%al, %al
 5746 06e8 0F852302 		jne	.L421
 5746      0000
1859:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     spec.argPtr = (void *)va_arg(argList, void *);
 5747              		.loc 1 1859 35
GAS LISTING /tmp/cc1ytava.s 			page 150


 5748 06ee 488B85B8 		movq	-1608(%rbp), %rax
 5748      F9FFFF
 5749 06f5 8B00     		movl	(%rax), %eax
 5750 06f7 83F82F   		cmpl	$47, %eax
 5751 06fa 7730     		ja	.L399
 5752 06fc 488B85B8 		movq	-1608(%rbp), %rax
 5752      F9FFFF
 5753 0703 488B5010 		movq	16(%rax), %rdx
 5754 0707 488B85B8 		movq	-1608(%rbp), %rax
 5754      F9FFFF
 5755 070e 8B00     		movl	(%rax), %eax
 5756 0710 89C0     		movl	%eax, %eax
 5757 0712 4801D0   		addq	%rdx, %rax
 5758 0715 488B95B8 		movq	-1608(%rbp), %rdx
 5758      F9FFFF
 5759 071c 8B12     		movl	(%rdx), %edx
 5760 071e 8D4A08   		leal	8(%rdx), %ecx
 5761 0721 488B95B8 		movq	-1608(%rbp), %rdx
 5761      F9FFFF
 5762 0728 890A     		movl	%ecx, (%rdx)
 5763 072a EB1A     		jmp	.L400
 5764              	.L399:
 5765 072c 488B85B8 		movq	-1608(%rbp), %rax
 5765      F9FFFF
 5766 0733 488B4008 		movq	8(%rax), %rax
 5767 0737 488D4808 		leaq	8(%rax), %rcx
 5768 073b 488B95B8 		movq	-1608(%rbp), %rdx
 5768      F9FFFF
 5769 0742 48894A08 		movq	%rcx, 8(%rdx)
 5770              	.L400:
 5771 0746 488B00   		movq	(%rax), %rax
 5772              		.loc 1 1859 33
 5773 0749 48898530 		movq	%rax, -1488(%rbp)
 5773      FAFFFF
1860:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     if (spec.argPtr == NULL) {
 5774              		.loc 1 1860 29
 5775 0750 488B8530 		movq	-1488(%rbp), %rax
 5775      FAFFFF
 5776              		.loc 1 1860 24
 5777 0757 4885C0   		testq	%rax, %rax
 5778 075a 7516     		jne	.L401
1861:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         paraIsNull = 1;
 5779              		.loc 1 1861 36
 5780 075c C785E8F9 		movl	$1, -1560(%rbp)
 5780      FFFF0100 
 5780      0000
1862:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         ++errRet;
 5781              		.loc 1 1862 25
 5782 0766 8385F0F9 		addl	$1, -1552(%rbp)
 5782      FFFF01
1863:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         continue;
 5783              		.loc 1 1863 25
 5784 076d E9E50100 		jmp	.L358
 5784      00
 5785              	.L401:
1864:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     }
1865:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     spec.number = (unsigned long)(unsigned int)charCount;
GAS LISTING /tmp/cc1ytava.s 			page 151


 5786              		.loc 1 1865 50
 5787 0772 8B85D8F9 		movl	-1576(%rbp), %eax
 5787      FFFF
 5788              		.loc 1 1865 35
 5789 0778 89C0     		movl	%eax, %eax
 5790              		.loc 1 1865 33
 5791 077a 48898518 		movq	%rax, -1512(%rbp)
 5791      FAFFFF
1866:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     spec.isInt64Arg = 0;
 5792              		.loc 1 1866 37
 5793 0781 C78524FA 		movl	$0, -1500(%rbp)
 5793      FFFF0000 
 5793      0000
1867:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     SecAssignNumber(&spec);
 5794              		.loc 1 1867 21
 5795 078b 488D8510 		leaq	-1520(%rbp), %rax
 5795      FAFFFF
 5796 0792 4889C7   		movq	%rax, %rdi
 5797 0795 E8000000 		call	SecAssignNumber
 5797      00
1868:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 }
1869:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 break;
 5798              		.loc 1 1869 17
 5799 079a E9720100 		jmp	.L421
 5799      00
 5800              	.L375:
1870:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             case SECUREC_CHAR('e'):    /* fall-through */ /* FALLTHRU */
1871:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             case SECUREC_CHAR('f'):    /* fall-through */ /* FALLTHRU */
1872:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             case SECUREC_CHAR('g'):    /* scan a float */
1873:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if SECUREC_ENABLE_SCANF_FLOAT
1874:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 /* un set last char to stream */
1875:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 SecUnGetChar(ch, stream, &charCount);
 5801              		.loc 1 1875 17
 5802 079f 488D95D8 		leaq	-1576(%rbp), %rdx
 5802      F9FFFF
 5803 07a6 488B8DC8 		movq	-1592(%rbp), %rcx
 5803      F9FFFF
 5804 07ad 8B85E0F9 		movl	-1568(%rbp), %eax
 5804      FFFF
 5805 07b3 4889CE   		movq	%rcx, %rsi
 5806 07b6 89C7     		movl	%eax, %edi
 5807 07b8 E8000000 		call	SecUnGetChar
 5807      00
1876:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 if (SecInputFloat(stream, &spec, &floatSpec, &charCount) != 0) {
 5808              		.loc 1 1876 21
 5809 07bd 488D8DD8 		leaq	-1576(%rbp), %rcx
 5809      F9FFFF
 5810 07c4 488D9560 		leaq	-1440(%rbp), %rdx
 5810      FAFFFF
 5811 07cb 488DB510 		leaq	-1520(%rbp), %rsi
 5811      FAFFFF
 5812 07d2 488B85C8 		movq	-1592(%rbp), %rax
 5812      F9FFFF
 5813 07d9 4889C7   		movq	%rax, %rdi
 5814 07dc E8000000 		call	SecInputFloat
 5814      00
 5815              		.loc 1 1876 20
GAS LISTING /tmp/cc1ytava.s 			page 152


 5816 07e1 85C0     		testl	%eax, %eax
 5817 07e3 740C     		je	.L402
1877:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     ++errRet;
 5818              		.loc 1 1877 21
 5819 07e5 8385F0F9 		addl	$1, -1552(%rbp)
 5819      FFFF01
1878:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     continue;
 5820              		.loc 1 1878 21
 5821 07ec E9660100 		jmp	.L358
 5821      00
 5822              	.L402:
1879:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 }
1880:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 if (spec.suppress == 0) {
 5823              		.loc 1 1880 25
 5824 07f1 0FB68551 		movzbl	-1455(%rbp), %eax
 5824      FAFFFF
 5825              		.loc 1 1880 20
 5826 07f8 84C0     		testb	%al, %al
 5827 07fa 0F851401 		jne	.L422
 5827      0000
1881:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     spec.argPtr = (void *)va_arg(argList, void *);
 5828              		.loc 1 1881 35
 5829 0800 488B85B8 		movq	-1608(%rbp), %rax
 5829      F9FFFF
 5830 0807 8B00     		movl	(%rax), %eax
 5831 0809 83F82F   		cmpl	$47, %eax
 5832 080c 7730     		ja	.L404
 5833 080e 488B85B8 		movq	-1608(%rbp), %rax
 5833      F9FFFF
 5834 0815 488B5010 		movq	16(%rax), %rdx
 5835 0819 488B85B8 		movq	-1608(%rbp), %rax
 5835      F9FFFF
 5836 0820 8B00     		movl	(%rax), %eax
 5837 0822 89C0     		movl	%eax, %eax
 5838 0824 4801D0   		addq	%rdx, %rax
 5839 0827 488B95B8 		movq	-1608(%rbp), %rdx
 5839      F9FFFF
 5840 082e 8B12     		movl	(%rdx), %edx
 5841 0830 8D4A08   		leal	8(%rdx), %ecx
 5842 0833 488B95B8 		movq	-1608(%rbp), %rdx
 5842      F9FFFF
 5843 083a 890A     		movl	%ecx, (%rdx)
 5844 083c EB1A     		jmp	.L405
 5845              	.L404:
 5846 083e 488B85B8 		movq	-1608(%rbp), %rax
 5846      F9FFFF
 5847 0845 488B4008 		movq	8(%rax), %rax
 5848 0849 488D4808 		leaq	8(%rax), %rcx
 5849 084d 488B95B8 		movq	-1608(%rbp), %rdx
 5849      F9FFFF
 5850 0854 48894A08 		movq	%rcx, 8(%rdx)
 5851              	.L405:
 5852 0858 488B00   		movq	(%rax), %rax
 5853              		.loc 1 1881 33
 5854 085b 48898530 		movq	%rax, -1488(%rbp)
 5854      FAFFFF
1882:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     if (spec.argPtr == NULL) {
GAS LISTING /tmp/cc1ytava.s 			page 153


 5855              		.loc 1 1882 29
 5856 0862 488B8530 		movq	-1488(%rbp), %rax
 5856      FAFFFF
 5857              		.loc 1 1882 24
 5858 0869 4885C0   		testq	%rax, %rax
 5859 086c 7516     		jne	.L406
1883:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         ++errRet;
 5860              		.loc 1 1883 25
 5861 086e 8385F0F9 		addl	$1, -1552(%rbp)
 5861      FFFF01
1884:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         paraIsNull = 1;
 5862              		.loc 1 1884 36
 5863 0875 C785E8F9 		movl	$1, -1560(%rbp)
 5863      FFFF0100 
 5863      0000
1885:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         continue;
 5864              		.loc 1 1885 25
 5865 087f E9D30000 		jmp	.L358
 5865      00
 5866              	.L406:
1886:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     }
1887:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_FOR_WCHAR
1888:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     if (SecAssignFloatW(&floatSpec, &spec) != 0) {
 5867              		.loc 1 1888 25
 5868 0884 488D9510 		leaq	-1520(%rbp), %rdx
 5868      FAFFFF
 5869 088b 488D8560 		leaq	-1440(%rbp), %rax
 5869      FAFFFF
 5870 0892 4889D6   		movq	%rdx, %rsi
 5871 0895 4889C7   		movq	%rax, %rdi
 5872 0898 E8000000 		call	SecAssignFloatW
 5872      00
 5873              		.loc 1 1888 24
 5874 089d 85C0     		testl	%eax, %eax
 5875 089f 740C     		je	.L407
1889:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         ++errRet;
 5876              		.loc 1 1889 25
 5877 08a1 8385F0F9 		addl	$1, -1552(%rbp)
 5877      FFFF01
1890:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                         continue;
 5878              		.loc 1 1890 25
 5879 08a8 E9AA0000 		jmp	.L358
 5879      00
 5880              	.L407:
1891:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     }
1892:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
1893:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     SecAssignFloat(floatSpec.floatStr, spec.numberWidth, spec.argPtr);
1894:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1895:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     ++doneCount;
 5881              		.loc 1 1895 21
 5882 08ad 8B85DCF9 		movl	-1572(%rbp), %eax
 5882      FFFF
 5883 08b3 83C001   		addl	$1, %eax
 5884 08b6 8985DCF9 		movl	%eax, -1572(%rbp)
 5884      FFFF
1896:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 }
1897:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
GAS LISTING /tmp/cc1ytava.s 			page 154


1898:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 break;
 5885              		.loc 1 1898 17
 5886 08bc EB56     		jmp	.L422
 5887              	.L369:
1899:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else /* SECUREC_ENABLE_SCANF_FLOAT */
1900:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 ++errRet;
1901:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 continue;
1902:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1903:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             default:
1904:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 if ((int)(*format) != (int)ch) {
 5888              		.loc 1 1904 27
 5889 08be 488B85F8 		movq	-1544(%rbp), %rax
 5889      F9FFFF
 5890 08c5 8B10     		movl	(%rax), %edx
 5891              		.loc 1 1904 36
 5892 08c7 8B85E0F9 		movl	-1568(%rbp), %eax
 5892      FFFF
 5893              		.loc 1 1904 20
 5894 08cd 39C2     		cmpl	%eax, %edx
 5895 08cf 7431     		je	.L408
1905:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     SecUnGetChar(ch, stream, &charCount);
 5896              		.loc 1 1905 21
 5897 08d1 488D95D8 		leaq	-1576(%rbp), %rdx
 5897      F9FFFF
 5898 08d8 488B8DC8 		movq	-1592(%rbp), %rcx
 5898      F9FFFF
 5899 08df 8B85E0F9 		movl	-1568(%rbp), %eax
 5899      FFFF
 5900 08e5 4889CE   		movq	%rcx, %rsi
 5901 08e8 89C7     		movl	%eax, %edi
 5902 08ea E8000000 		call	SecUnGetChar
 5902      00
1906:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     formatError = 1;
 5903              		.loc 1 1906 33
 5904 08ef C785E4F9 		movl	$1, -1564(%rbp)
 5904      FFFF0100 
 5904      0000
1907:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     ++errRet;
 5905              		.loc 1 1907 21
 5906 08f9 8385F0F9 		addl	$1, -1552(%rbp)
 5906      FFFF01
1908:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     continue;
 5907              		.loc 1 1908 21
 5908 0900 EB55     		jmp	.L358
 5909              	.L408:
1909:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 } else {
1910:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                     --match;
 5910              		.loc 1 1910 21
 5911 0902 83ADECF9 		subl	$1, -1556(%rbp)
 5911      FFFF01
 5912 0909 EB0A     		jmp	.L392
 5913              	.L419:
1827:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             case SECUREC_CHAR('p'):
 5914              		.loc 1 1827 17
 5915 090b 90       		nop
 5916 090c EB07     		jmp	.L392
 5917              	.L420:
GAS LISTING /tmp/cc1ytava.s 			page 155


1856:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             case SECUREC_CHAR('n'):    /* char count */
 5918              		.loc 1 1856 17
 5919 090e 90       		nop
 5920 090f EB04     		jmp	.L392
 5921              	.L421:
1869:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             case SECUREC_CHAR('e'):    /* fall-through */ /* FALLTHRU */
 5922              		.loc 1 1869 17
 5923 0911 90       		nop
 5924 0912 EB01     		jmp	.L392
 5925              	.L422:
1898:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else /* SECUREC_ENABLE_SCANF_FLOAT */
 5926              		.loc 1 1898 17
 5927 0914 90       		nop
 5928              	.L392:
1911:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 }
1912:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1913:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1914:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ++match;
 5929              		.loc 1 1914 9
 5930 0915 8385ECF9 		addl	$1, -1556(%rbp)
 5930      FFFF01
1915:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ++format;
 5931              		.loc 1 1915 9
 5932 091c 488B85F8 		movq	-1544(%rbp), %rax
 5932      F9FFFF
 5933 0923 4883C004 		addq	$4, %rax
 5934 0927 488985F8 		movq	%rax, -1544(%rbp)
 5934      F9FFFF
1916:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if ((ch == SECUREC_EOF) && ((*format != SECUREC_CHAR('%')) || (*(format + 1) != SECUREC_CHA
 5935              		.loc 1 1916 12
 5936 092e 83BDE0F9 		cmpl	$-1, -1568(%rbp)
 5936      FFFFFF
 5937 0935 7520     		jne	.L358
 5938              		.loc 1 1916 38 discriminator 1
 5939 0937 488B85F8 		movq	-1544(%rbp), %rax
 5939      F9FFFF
 5940 093e 8B00     		movl	(%rax), %eax
 5941              		.loc 1 1916 33 discriminator 1
 5942 0940 83F825   		cmpl	$37, %eax
 5943 0943 752C     		jne	.L363
 5944              		.loc 1 1916 81 discriminator 2
 5945 0945 488B85F8 		movq	-1544(%rbp), %rax
 5945      F9FFFF
 5946 094c 4883C004 		addq	$4, %rax
 5947              		.loc 1 1916 72 discriminator 2
 5948 0950 8B00     		movl	(%rax), %eax
 5949              		.loc 1 1916 68 discriminator 2
 5950 0952 83F86E   		cmpl	$110, %eax
 5951 0955 751A     		jne	.L363
 5952              	.L358:
1684:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* skip space in format and space in input */
 5953              		.loc 1 1684 11
 5954 0957 83BDF0F9 		cmpl	$0, -1552(%rbp)
 5954      FFFF00
 5955 095e 7F11     		jg	.L363
1684:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* skip space in format and space in input */
 5956              		.loc 1 1684 26 discriminator 1
GAS LISTING /tmp/cc1ytava.s 			page 156


 5957 0960 488B85F8 		movq	-1544(%rbp), %rax
 5957      F9FFFF
 5958 0967 8B00     		movl	(%rax), %eax
1684:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* skip space in format and space in input */
 5959              		.loc 1 1684 23 discriminator 1
 5960 0969 85C0     		testl	%eax, %eax
 5961 096b 0F853CF7 		jne	.L409
 5961      FFFF
 5962              	.L363:
1917:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             break;
1918:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1919:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1920:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1921:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_FOR_WCHAR
1922:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecFreeBracketTable(&bracketTable);
 5963              		.loc 1 1922 5
 5964 0971 488D8500 		leaq	-1536(%rbp), %rax
 5964      FAFFFF
 5965 0978 4889C7   		movq	%rax, %rdi
 5966 097b E8000000 		call	SecFreeBracketTable
 5966      00
1923:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1924:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1925:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if SECUREC_ENABLE_SCANF_FLOAT
1926:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecClearFloatSpec(&floatSpec, &doneCount);
 5967              		.loc 1 1926 5
 5968 0980 488D95DC 		leaq	-1572(%rbp), %rdx
 5968      F9FFFF
 5969 0987 488D8560 		leaq	-1440(%rbp), %rax
 5969      FAFFFF
 5970 098e 4889D6   		movq	%rdx, %rsi
 5971 0991 4889C7   		movq	%rax, %rdi
 5972 0994 E8000000 		call	SecClearFloatSpec
 5972      00
1927:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1928:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1929:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if SECUREC_ENABLE_SCANF_FILE
1930:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecAdjustStream(stream);
 5973              		.loc 1 1930 5
 5974 0999 488B85C8 		movq	-1592(%rbp), %rax
 5974      F9FFFF
 5975 09a0 4889C7   		movq	%rax, %rdi
 5976 09a3 E8000000 		call	SecAdjustStream
 5976      00
1931:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1932:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1933:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (ch == SECUREC_EOF) {
 5977              		.loc 1 1933 8
 5978 09a8 83BDE0F9 		cmpl	$-1, -1568(%rbp)
 5978      FFFFFF
 5979 09af 7522     		jne	.L410
1934:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return ((doneCount || match) ? doneCount : SECUREC_SCANF_EINVAL);
 5980              		.loc 1 1934 18
 5981 09b1 8B85DCF9 		movl	-1572(%rbp), %eax
 5981      FFFF
 5982              		.loc 1 1934 50
 5983 09b7 85C0     		testl	%eax, %eax
GAS LISTING /tmp/cc1ytava.s 			page 157


 5984 09b9 7509     		jne	.L411
 5985              		.loc 1 1934 28 discriminator 2
 5986 09bb 83BDECF9 		cmpl	$0, -1556(%rbp)
 5986      FFFF00
 5987 09c2 7408     		je	.L412
 5988              	.L411:
 5989              		.loc 1 1934 50 discriminator 3
 5990 09c4 8B85DCF9 		movl	-1572(%rbp), %eax
 5990      FFFF
 5991 09ca EB26     		jmp	.L417
 5992              	.L412:
 5993              		.loc 1 1934 50 is_stmt 0 discriminator 4
 5994 09cc B8FFFFFF 		movl	$-1, %eax
 5994      FF
 5995 09d1 EB1F     		jmp	.L417
 5996              	.L410:
1935:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else if (formatError != 0 || paraIsNull != 0) {
 5997              		.loc 1 1935 15 is_stmt 1
 5998 09d3 83BDE4F9 		cmpl	$0, -1564(%rbp)
 5998      FFFF00
 5999 09da 7509     		jne	.L415
 6000              		.loc 1 1935 33 discriminator 1
 6001 09dc 83BDE8F9 		cmpl	$0, -1560(%rbp)
 6001      FFFF00
 6002 09e3 7407     		je	.L416
 6003              	.L415:
1936:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* Invalid Input Format or parameter */
1937:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         return SECUREC_SCANF_ERROR_PARA;
 6004              		.loc 1 1937 16
 6005 09e5 B8FEFFFF 		movl	$-2, %eax
 6005      FF
 6006 09ea EB06     		jmp	.L417
 6007              	.L416:
1938:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1939:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1940:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return doneCount;
 6008              		.loc 1 1940 12
 6009 09ec 8B85DCF9 		movl	-1572(%rbp), %eax
 6009      FFFF
 6010              	.L417:
1941:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 6011              		.loc 1 1941 1 discriminator 1
 6012 09f2 488B75F8 		movq	-8(%rbp), %rsi
 6013 09f6 64483334 		xorq	%fs:40, %rsi
 6013      25280000 
 6013      00
 6014 09ff 7405     		je	.L418
 6015              		.loc 1 1941 1 is_stmt 0
 6016 0a01 E8000000 		call	__stack_chk_fail@PLT
 6016      00
 6017              	.L418:
 6018 0a06 C9       		leave
 6019              	.LCFI134:
 6020              		.cfi_def_cfa 7, 8
 6021 0a07 C3       		ret
 6022              		.cfi_endproc
 6023              	.LFE50:
GAS LISTING /tmp/cc1ytava.s 			page 158


 6025              		.section	.text.SecGetCharFromStdin,"ax",@progbits
 6027              	SecGetCharFromStdin:
 6028              	.LFB51:
1942:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1943:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if SECUREC_ENABLE_SCANF_FILE
1944:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1945:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if defined(SECUREC_NO_STD_UNGETC)
1946:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
1947:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  *  Get char  from stdin or buffer
1948:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
1949:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static SecInt SecGetCharFromStdin(SecFileStream *stream)
1950:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
1951:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecInt ch;
1952:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (stream->fUnget == 1) {
1953:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ch = (SecInt) stream->lastChar;
1954:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         stream->fUnget = 0;
1955:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else {
1956:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ch = SECUREC_GETC(stream->pf);
1957:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         stream->lastChar = (unsigned int)ch;
1958:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1959:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return ch;
1960:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
1961:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
1962:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
1963:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  *  Get char  from stdin or buffer use std function
1964:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
1965:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static SecInt SecGetCharFromStdin(const SecFileStream *stream)
1966:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 6029              		.loc 1 1966 1 is_stmt 1
 6030              		.cfi_startproc
 6031 0000 F30F1EFA 		endbr64
 6032 0004 55       		pushq	%rbp
 6033              	.LCFI135:
 6034              		.cfi_def_cfa_offset 16
 6035              		.cfi_offset 6, -16
 6036 0005 4889E5   		movq	%rsp, %rbp
 6037              	.LCFI136:
 6038              		.cfi_def_cfa_register 6
 6039 0008 4883EC20 		subq	$32, %rsp
 6040 000c 48897DE8 		movq	%rdi, -24(%rbp)
 6041              		.loc 1 1966 1
 6042 0010 64488B04 		movq	%fs:40, %rax
 6042      25280000 
 6042      00
 6043 0019 488945F8 		movq	%rax, -8(%rbp)
 6044 001d 31C0     		xorl	%eax, %eax
1967:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecInt ch;
1968:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     ch = SECUREC_GETC(stream->pf);
 6045              		.loc 1 1968 29
 6046 001f 488B45E8 		movq	-24(%rbp), %rax
 6047 0023 488B4018 		movq	24(%rax), %rax
 6048              		.loc 1 1968 10
 6049 0027 4889C7   		movq	%rax, %rdi
 6050 002a E8000000 		call	fgetwc@PLT
 6050      00
 6051 002f 8945F4   		movl	%eax, -12(%rbp)
1969:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return ch;
GAS LISTING /tmp/cc1ytava.s 			page 159


 6052              		.loc 1 1969 12
 6053 0032 8B45F4   		movl	-12(%rbp), %eax
1970:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 6054              		.loc 1 1970 1
 6055 0035 488B55F8 		movq	-8(%rbp), %rdx
 6056 0039 64483314 		xorq	%fs:40, %rdx
 6056      25280000 
 6056      00
 6057 0042 7405     		je	.L425
 6058 0044 E8000000 		call	__stack_chk_fail@PLT
 6058      00
 6059              	.L425:
 6060 0049 C9       		leave
 6061              	.LCFI137:
 6062              		.cfi_def_cfa 7, 8
 6063 004a C3       		ret
 6064              		.cfi_endproc
 6065              	.LFE51:
 6067              		.section	.text.SecSkipBomHeader,"ax",@progbits
 6069              	SecSkipBomHeader:
 6070              	.LFB52:
1971:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
1972:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1973:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecSkipBomHeader(SecFileStream *stream)
1974:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 6071              		.loc 1 1974 1
 6072              		.cfi_startproc
 6073 0000 F30F1EFA 		endbr64
 6074 0004 55       		pushq	%rbp
 6075              	.LCFI138:
 6076              		.cfi_def_cfa_offset 16
 6077              		.cfi_offset 6, -16
 6078 0005 4889E5   		movq	%rsp, %rbp
 6079              	.LCFI139:
 6080              		.cfi_def_cfa_register 6
 6081 0008 4883EC20 		subq	$32, %rsp
 6082 000c 48897DE8 		movq	%rdi, -24(%rbp)
 6083              		.loc 1 1974 1
 6084 0010 64488B04 		movq	%fs:40, %rax
 6084      25280000 
 6084      00
 6085 0019 488945F8 		movq	%rax, -8(%rbp)
 6086 001d 31C0     		xorl	%eax, %eax
1975:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #ifdef SECUREC_FOR_WCHAR
1976:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (stream->count >= SECUREC_BOM_HEADER_SIZE &&
 6087              		.loc 1 1976 15
 6088 001f 488B45E8 		movq	-24(%rbp), %rax
 6089 0023 8B4004   		movl	4(%rax), %eax
 6090              		.loc 1 1976 8
 6091 0026 83F801   		cmpl	$1, %eax
 6092 0029 0F8ED700 		jle	.L432
 6092      0000
1977:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         (((unsigned char)(stream->base[0]) == SECUREC_BOM_HEADER_LE_1ST &&
 6093              		.loc 1 1977 33 discriminator 1
 6094 002f 488B45E8 		movq	-24(%rbp), %rax
 6095 0033 488B4010 		movq	16(%rax), %rax
 6096              		.loc 1 1977 39 discriminator 1
GAS LISTING /tmp/cc1ytava.s 			page 160


 6097 0037 0FB600   		movzbl	(%rax), %eax
1976:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         (((unsigned char)(stream->base[0]) == SECUREC_BOM_HEADER_LE_1ST &&
 6098              		.loc 1 1976 50 discriminator 1
 6099 003a 3CFF     		cmpb	$-1, %al
 6100 003c 7513     		jne	.L428
1978:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         (unsigned char)(stream->base[1]) == SECUREC_BOM_HEADER_LE_2ST) ||
 6101              		.loc 1 1978 31
 6102 003e 488B45E8 		movq	-24(%rbp), %rax
 6103 0042 488B4010 		movq	16(%rax), %rax
 6104              		.loc 1 1978 37
 6105 0046 4883C001 		addq	$1, %rax
 6106 004a 0FB600   		movzbl	(%rax), %eax
1977:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         (((unsigned char)(stream->base[0]) == SECUREC_BOM_HEADER_LE_1ST &&
 6107              		.loc 1 1977 73
 6108 004d 3CFE     		cmpb	$-2, %al
 6109 004f 742A     		je	.L429
 6110              	.L428:
1979:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ((unsigned char)(stream->base[0]) == SECUREC_BOM_HEADER_BE_1ST &&
 6111              		.loc 1 1979 32
 6112 0051 488B45E8 		movq	-24(%rbp), %rax
 6113 0055 488B4010 		movq	16(%rax), %rax
 6114              		.loc 1 1979 38
 6115 0059 0FB600   		movzbl	(%rax), %eax
1978:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         (unsigned char)(stream->base[1]) == SECUREC_BOM_HEADER_LE_2ST) ||
 6116              		.loc 1 1978 72
 6117 005c 3CFE     		cmpb	$-2, %al
 6118 005e 0F85A200 		jne	.L432
 6118      0000
1980:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         (unsigned char)(stream->base[1]) == SECUREC_BOM_HEADER_BE_2ST))) {
 6119              		.loc 1 1980 31
 6120 0064 488B45E8 		movq	-24(%rbp), %rax
 6121 0068 488B4010 		movq	16(%rax), %rax
 6122              		.loc 1 1980 37
 6123 006c 4883C001 		addq	$1, %rax
 6124 0070 0FB600   		movzbl	(%rax), %eax
1979:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ((unsigned char)(stream->base[0]) == SECUREC_BOM_HEADER_BE_1ST &&
 6125              		.loc 1 1979 72
 6126 0073 3CFF     		cmpb	$-1, %al
 6127 0075 0F858B00 		jne	.L432
 6127      0000
 6128              	.L429:
1981:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
1982:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* the stream->count must be a  multiple of  sizeof(SecChar),
1983:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****          * otherwise this function will return SECUREC_EOF when read the last character
1984:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****          */
1985:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if ((stream->count - SECUREC_BOM_HEADER_SIZE) % (int)sizeof(SecChar) != 0) {
 6129              		.loc 1 1985 20
 6130 007b 488B45E8 		movq	-24(%rbp), %rax
 6131 007f 8B4004   		movl	4(%rax), %eax
 6132              		.loc 1 1985 28
 6133 0082 83E802   		subl	$2, %eax
 6134              		.loc 1 1985 78
 6135 0085 83E003   		andl	$3, %eax
 6136              		.loc 1 1985 12
 6137 0088 85C0     		testl	%eax, %eax
 6138 008a 7455     		je	.L430
 6139              	.LBB20:
GAS LISTING /tmp/cc1ytava.s 			page 161


1986:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             int ret = (int)fread(stream->base + stream->count, (size_t)1,
 6140              		.loc 1 1986 28
 6141 008c 488B45E8 		movq	-24(%rbp), %rax
 6142 0090 488B4018 		movq	24(%rax), %rax
 6143              		.loc 1 1986 40
 6144 0094 488B55E8 		movq	-24(%rbp), %rdx
 6145 0098 488B4A10 		movq	16(%rdx), %rcx
 6146              		.loc 1 1986 55
 6147 009c 488B55E8 		movq	-24(%rbp), %rdx
 6148 00a0 8B5204   		movl	4(%rdx), %edx
 6149 00a3 4863D2   		movslq	%edx, %rdx
 6150              		.loc 1 1986 47
 6151 00a6 488D3C11 		leaq	(%rcx,%rdx), %rdi
 6152              		.loc 1 1986 28
 6153 00aa 4889C1   		movq	%rax, %rcx
 6154 00ad BA020000 		movl	$2, %edx
 6154      00
 6155 00b2 BE010000 		movl	$1, %esi
 6155      00
 6156 00b7 E8000000 		call	fread@PLT
 6156      00
 6157              		.loc 1 1986 17
 6158 00bc 8945F4   		movl	%eax, -12(%rbp)
1987:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                                  (size_t)SECUREC_BOM_HEADER_SIZE, stream->pf);
1988:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (ret > 0 && ret <= SECUREC_BUFFERED_BLOK_SIZE) {
 6159              		.loc 1 1988 16
 6160 00bf 837DF400 		cmpl	$0, -12(%rbp)
 6161 00c3 7E1C     		jle	.L430
 6162              		.loc 1 1988 25 discriminator 1
 6163 00c5 817DF400 		cmpl	$1024, -12(%rbp)
 6163      040000
 6164 00cc 7F13     		jg	.L430
1989:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 stream->count += ret;
 6165              		.loc 1 1989 31
 6166 00ce 488B45E8 		movq	-24(%rbp), %rax
 6167 00d2 8B5004   		movl	4(%rax), %edx
 6168 00d5 8B45F4   		movl	-12(%rbp), %eax
 6169 00d8 01C2     		addl	%eax, %edx
 6170 00da 488B45E8 		movq	-24(%rbp), %rax
 6171 00de 895004   		movl	%edx, 4(%rax)
 6172              	.L430:
 6173              	.LBE20:
1990:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
1991:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
1992:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* it's BOM header, skip */
1993:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         stream->count -= SECUREC_BOM_HEADER_SIZE;
 6174              		.loc 1 1993 23
 6175 00e1 488B45E8 		movq	-24(%rbp), %rax
 6176 00e5 8B4004   		movl	4(%rax), %eax
 6177 00e8 8D50FE   		leal	-2(%rax), %edx
 6178 00eb 488B45E8 		movq	-24(%rbp), %rax
 6179 00ef 895004   		movl	%edx, 4(%rax)
1994:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         stream->cur += SECUREC_BOM_HEADER_SIZE;
 6180              		.loc 1 1994 21
 6181 00f2 488B45E8 		movq	-24(%rbp), %rax
 6182 00f6 488B4008 		movq	8(%rax), %rax
 6183 00fa 488D5002 		leaq	2(%rax), %rdx
GAS LISTING /tmp/cc1ytava.s 			page 162


 6184 00fe 488B45E8 		movq	-24(%rbp), %rax
 6185 0102 48895008 		movq	%rdx, 8(%rax)
 6186              	.L432:
1995:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
1996:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
1997:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (stream->count >= SECUREC_UTF8_BOM_HEADER_SIZE &&
1998:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         (unsigned char)(stream->base[0]) == SECUREC_UTF8_BOM_HEADER_1ST &&
1999:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         (unsigned char)(stream->base[1]) == SECUREC_UTF8_BOM_HEADER_2ND &&
2000:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         (unsigned char)(stream->base[2]) == SECUREC_UTF8_BOM_HEADER_3RD) { /* 2 offset of third hea
2001:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* it's BOM header, skip */
2002:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         stream->count -= SECUREC_UTF8_BOM_HEADER_SIZE;
2003:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         stream->cur += SECUREC_UTF8_BOM_HEADER_SIZE;
2004:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
2005:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
2006:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 6187              		.loc 1 2006 1
 6188 0106 90       		nop
 6189 0107 488B45F8 		movq	-8(%rbp), %rax
 6190 010b 64483304 		xorq	%fs:40, %rax
 6190      25280000 
 6190      00
 6191 0114 7405     		je	.L431
 6192 0116 E8000000 		call	__stack_chk_fail@PLT
 6192      00
 6193              	.L431:
 6194 011b C9       		leave
 6195              	.LCFI140:
 6196              		.cfi_def_cfa 7, 8
 6197 011c C3       		ret
 6198              		.cfi_endproc
 6199              	.LFE52:
 6201              		.section	.text.SecGetCharFromFile,"ax",@progbits
 6203              	SecGetCharFromFile:
 6204              	.LFB53:
2007:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
2008:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  *  Get char  from file stream or buffer
2009:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
2010:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static SecInt SecGetCharFromFile(SecFileStream *stream)
2011:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 6205              		.loc 1 2011 1
 6206              		.cfi_startproc
 6207 0000 F30F1EFA 		endbr64
 6208 0004 55       		pushq	%rbp
 6209              	.LCFI141:
 6210              		.cfi_def_cfa_offset 16
 6211              		.cfi_offset 6, -16
 6212 0005 4889E5   		movq	%rsp, %rbp
 6213              	.LCFI142:
 6214              		.cfi_def_cfa_register 6
 6215 0008 4883EC20 		subq	$32, %rsp
 6216 000c 48897DE8 		movq	%rdi, -24(%rbp)
 6217              		.loc 1 2011 1
 6218 0010 64488B04 		movq	%fs:40, %rax
 6218      25280000 
 6218      00
 6219 0019 488945F8 		movq	%rax, -8(%rbp)
 6220 001d 31C0     		xorl	%eax, %eax
GAS LISTING /tmp/cc1ytava.s 			page 163


2012:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecInt ch;
2013:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (stream->count == 0) {
 6221              		.loc 1 2013 15
 6222 001f 488B45E8 		movq	-24(%rbp), %rax
 6223 0023 8B4004   		movl	4(%rax), %eax
 6224              		.loc 1 2013 8
 6225 0026 85C0     		testl	%eax, %eax
 6226 0028 0F851301 		jne	.L434
 6226      0000
 6227              	.LBB21:
2014:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         int firstReadOnFile = 0;
 6228              		.loc 1 2014 13
 6229 002e C745F000 		movl	$0, -16(%rbp)
 6229      000000
2015:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* load file to buffer */
2016:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (stream->base == NULL) {
 6230              		.loc 1 2016 19
 6231 0035 488B45E8 		movq	-24(%rbp), %rax
 6232 0039 488B4010 		movq	16(%rax), %rax
 6233              		.loc 1 2016 12
 6234 003d 4885C0   		testq	%rax, %rax
 6235 0040 753D     		jne	.L435
2017:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             stream->base = (char *)SECUREC_MALLOC(SECUREC_BUFFERED_BLOK_SIZE + 1);
 6236              		.loc 1 2017 36
 6237 0042 BF010400 		movl	$1025, %edi
 6237      00
 6238 0047 E8000000 		call	malloc@PLT
 6238      00
 6239 004c 4889C2   		movq	%rax, %rdx
 6240              		.loc 1 2017 26
 6241 004f 488B45E8 		movq	-24(%rbp), %rax
 6242 0053 48895010 		movq	%rdx, 16(%rax)
2018:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             if (stream->base == NULL) {
 6243              		.loc 1 2018 23
 6244 0057 488B45E8 		movq	-24(%rbp), %rax
 6245 005b 488B4010 		movq	16(%rax), %rax
 6246              		.loc 1 2018 16
 6247 005f 4885C0   		testq	%rax, %rax
 6248 0062 750A     		jne	.L436
2019:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                 return SECUREC_EOF;
 6249              		.loc 1 2019 24
 6250 0064 B8FFFFFF 		movl	$-1, %eax
 6250      FF
 6251 0069 E9410100 		jmp	.L437
 6251      00
 6252              	.L436:
2020:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             }
2021:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             stream->base[SECUREC_BUFFERED_BLOK_SIZE] = '\0';   /* for tool Warning string null */
 6253              		.loc 1 2021 19
 6254 006e 488B45E8 		movq	-24(%rbp), %rax
 6255 0072 488B4010 		movq	16(%rax), %rax
 6256              		.loc 1 2021 25
 6257 0076 48050004 		addq	$1024, %rax
 6257      0000
 6258              		.loc 1 2021 54
 6259 007c C60000   		movb	$0, (%rax)
 6260              	.L435:
GAS LISTING /tmp/cc1ytava.s 			page 164


2022:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
2023:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* LSD add 2014.3.21 */
2024:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (stream->oriFilePos == SECUREC_UNINITIALIZED_FILE_POS) {
 6261              		.loc 1 2024 19
 6262 007f 488B45E8 		movq	-24(%rbp), %rax
 6263 0083 488B4020 		movq	32(%rax), %rax
 6264              		.loc 1 2024 12
 6265 0087 4883F8FF 		cmpq	$-1, %rax
 6266 008b 751F     		jne	.L438
2025:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             stream->oriFilePos = ftell(stream->pf);   /* save original file read position */
 6267              		.loc 1 2025 34
 6268 008d 488B45E8 		movq	-24(%rbp), %rax
 6269 0091 488B4018 		movq	24(%rax), %rax
 6270 0095 4889C7   		movq	%rax, %rdi
 6271 0098 E8000000 		call	ftell@PLT
 6271      00
 6272              		.loc 1 2025 32
 6273 009d 488B55E8 		movq	-24(%rbp), %rdx
 6274 00a1 48894220 		movq	%rax, 32(%rdx)
2026:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             firstReadOnFile = 1;
 6275              		.loc 1 2026 29
 6276 00a5 C745F001 		movl	$1, -16(%rbp)
 6276      000000
 6277              	.L438:
2027:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
2028:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         stream->count = (int)fread(stream->base, (size_t)1, (size_t)SECUREC_BUFFERED_BLOK_SIZE, str
 6278              		.loc 1 2028 30
 6279 00ac 488B45E8 		movq	-24(%rbp), %rax
 6280 00b0 488B5018 		movq	24(%rax), %rdx
 6281              		.loc 1 2028 42
 6282 00b4 488B45E8 		movq	-24(%rbp), %rax
 6283 00b8 488B4010 		movq	16(%rax), %rax
 6284              		.loc 1 2028 30
 6285 00bc 4889D1   		movq	%rdx, %rcx
 6286 00bf BA000400 		movl	$1024, %edx
 6286      00
 6287 00c4 BE010000 		movl	$1, %esi
 6287      00
 6288 00c9 4889C7   		movq	%rax, %rdi
 6289 00cc E8000000 		call	fread@PLT
 6289      00
 6290              		.loc 1 2028 25
 6291 00d1 89C2     		movl	%eax, %edx
 6292              		.loc 1 2028 23
 6293 00d3 488B45E8 		movq	-24(%rbp), %rax
 6294 00d7 895004   		movl	%edx, 4(%rax)
2029:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         stream->base[SECUREC_BUFFERED_BLOK_SIZE] = '\0';   /* for tool Warning string null */
 6295              		.loc 1 2029 15
 6296 00da 488B45E8 		movq	-24(%rbp), %rax
 6297 00de 488B4010 		movq	16(%rax), %rax
 6298              		.loc 1 2029 21
 6299 00e2 48050004 		addq	$1024, %rax
 6299      0000
 6300              		.loc 1 2029 50
 6301 00e8 C60000   		movb	$0, (%rax)
2030:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (stream->count == 0 || stream->count > SECUREC_BUFFERED_BLOK_SIZE) {
 6302              		.loc 1 2030 19
GAS LISTING /tmp/cc1ytava.s 			page 165


 6303 00eb 488B45E8 		movq	-24(%rbp), %rax
 6304 00ef 8B4004   		movl	4(%rax), %eax
 6305              		.loc 1 2030 12
 6306 00f2 85C0     		testl	%eax, %eax
 6307 00f4 740E     		je	.L439
 6308              		.loc 1 2030 41 discriminator 1
 6309 00f6 488B45E8 		movq	-24(%rbp), %rax
 6310 00fa 8B4004   		movl	4(%rax), %eax
 6311              		.loc 1 2030 32 discriminator 1
 6312 00fd 3D000400 		cmpl	$1024, %eax
 6312      00
 6313 0102 7E0A     		jle	.L440
 6314              	.L439:
2031:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             return SECUREC_EOF;
 6315              		.loc 1 2031 20
 6316 0104 B8FFFFFF 		movl	$-1, %eax
 6316      FF
 6317 0109 E9A10000 		jmp	.L437
 6317      00
 6318              	.L440:
2032:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
2033:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         stream->cur = stream->base;
 6319              		.loc 1 2033 29
 6320 010e 488B45E8 		movq	-24(%rbp), %rax
 6321 0112 488B5010 		movq	16(%rax), %rdx
 6322              		.loc 1 2033 21
 6323 0116 488B45E8 		movq	-24(%rbp), %rax
 6324 011a 48895008 		movq	%rdx, 8(%rax)
2034:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         stream->flag |= SECUREC_LOAD_FILE_TO_MEM_FLAG;
 6325              		.loc 1 2034 22
 6326 011e 488B45E8 		movq	-24(%rbp), %rax
 6327 0122 8B00     		movl	(%rax), %eax
 6328 0124 83C808   		orl	$8, %eax
 6329 0127 89C2     		movl	%eax, %edx
 6330 0129 488B45E8 		movq	-24(%rbp), %rax
 6331 012d 8910     		movl	%edx, (%rax)
2035:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (firstReadOnFile != 0) {
 6332              		.loc 1 2035 12
 6333 012f 837DF000 		cmpl	$0, -16(%rbp)
 6334 0133 740C     		je	.L434
2036:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             SecSkipBomHeader(stream);
 6335              		.loc 1 2036 13
 6336 0135 488B45E8 		movq	-24(%rbp), %rax
 6337 0139 4889C7   		movq	%rax, %rdi
 6338 013c E8000000 		call	SecSkipBomHeader
 6338      00
 6339              	.L434:
 6340              	.LBE21:
2037:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
2038:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
2039:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     /* according  wchar_t has two bytes */
2040:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     ch = (SecInt)((stream->count -= (int)sizeof(SecChar)) >= 0 ? \
 6341              		.loc 1 2040 34
 6342 0141 488B45E8 		movq	-24(%rbp), %rax
 6343 0145 8B4004   		movl	4(%rax), %eax
 6344 0148 8D50FC   		leal	-4(%rax), %edx
 6345 014b 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/cc1ytava.s 			page 166


 6346 014f 895004   		movl	%edx, 4(%rax)
 6347 0152 488B45E8 		movq	-24(%rbp), %rax
 6348 0156 8B4004   		movl	4(%rax), %eax
 6349              		.loc 1 2040 10
 6350 0159 85C0     		testl	%eax, %eax
 6351 015b 780F     		js	.L441
2041:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                   (SecInt)(SECUREC_CHAR_MASK & \
2042:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                   (unsigned int)(int)(*((const SecChar *)(const void *)stream->cur))) : SECUREC_EOF
 6352              		.loc 1 2042 78 discriminator 1
 6353 015d 488B45E8 		movq	-24(%rbp), %rax
 6354 0161 488B4008 		movq	8(%rax), %rax
 6355              		.loc 1 2042 39 discriminator 1
 6356 0165 8B00     		movl	(%rax), %eax
2040:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                   (SecInt)(SECUREC_CHAR_MASK & \
 6357              		.loc 1 2040 10 discriminator 1
 6358 0167 0FB7C0   		movzwl	%ax, %eax
 6359 016a EB05     		jmp	.L442
 6360              	.L441:
2040:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                   (SecInt)(SECUREC_CHAR_MASK & \
 6361              		.loc 1 2040 10 is_stmt 0 discriminator 2
 6362 016c B8FFFFFF 		movl	$-1, %eax
 6362      FF
 6363              	.L442:
2040:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                   (SecInt)(SECUREC_CHAR_MASK & \
 6364              		.loc 1 2040 8 is_stmt 1 discriminator 4
 6365 0171 8945F4   		movl	%eax, -12(%rbp)
2043:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     stream->cur += sizeof(SecChar);
 6366              		.loc 1 2043 17 discriminator 4
 6367 0174 488B45E8 		movq	-24(%rbp), %rax
 6368 0178 488B4008 		movq	8(%rax), %rax
 6369 017c 488D5004 		leaq	4(%rax), %rdx
 6370 0180 488B45E8 		movq	-24(%rbp), %rax
 6371 0184 48895008 		movq	%rdx, 8(%rax)
2044:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
2045:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (ch != SECUREC_EOF && stream->base != NULL) {
 6372              		.loc 1 2045 8 discriminator 4
 6373 0188 837DF4FF 		cmpl	$-1, -12(%rbp)
 6374 018c 741E     		je	.L443
 6375              		.loc 1 2045 36 discriminator 1
 6376 018e 488B45E8 		movq	-24(%rbp), %rax
 6377 0192 488B4010 		movq	16(%rax), %rax
 6378              		.loc 1 2045 27 discriminator 1
 6379 0196 4885C0   		testq	%rax, %rax
 6380 0199 7411     		je	.L443
2046:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         stream->fileRealRead += (int)sizeof(SecChar);
 6381              		.loc 1 2046 30
 6382 019b 488B45E8 		movq	-24(%rbp), %rax
 6383 019f 8B4028   		movl	40(%rax), %eax
 6384 01a2 8D5004   		leal	4(%rax), %edx
 6385 01a5 488B45E8 		movq	-24(%rbp), %rax
 6386 01a9 895028   		movl	%edx, 40(%rax)
 6387              	.L443:
2047:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
2048:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return ch;
 6388              		.loc 1 2048 12
 6389 01ac 8B45F4   		movl	-12(%rbp), %eax
 6390              	.L437:
GAS LISTING /tmp/cc1ytava.s 			page 167


2049:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 6391              		.loc 1 2049 1
 6392 01af 488B4DF8 		movq	-8(%rbp), %rcx
 6393 01b3 6448330C 		xorq	%fs:40, %rcx
 6393      25280000 
 6393      00
 6394 01bc 7405     		je	.L444
 6395 01be E8000000 		call	__stack_chk_fail@PLT
 6395      00
 6396              	.L444:
 6397 01c3 C9       		leave
 6398              	.LCFI143:
 6399              		.cfi_def_cfa 7, 8
 6400 01c4 C3       		ret
 6401              		.cfi_endproc
 6402              	.LFE53:
 6404              		.section	.text.SecGetChar,"ax",@progbits
 6406              	SecGetChar:
 6407              	.LFB54:
2050:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
2051:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
2052:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
2053:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  *  Get char  for wchar version
2054:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
2055:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static SecInt SecGetChar(SecFileStream *stream, int *counter)
2056:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 6408              		.loc 1 2056 1
 6409              		.cfi_startproc
 6410 0000 F30F1EFA 		endbr64
 6411 0004 55       		pushq	%rbp
 6412              	.LCFI144:
 6413              		.cfi_def_cfa_offset 16
 6414              		.cfi_offset 6, -16
 6415 0005 4889E5   		movq	%rsp, %rbp
 6416              	.LCFI145:
 6417              		.cfi_def_cfa_register 6
 6418 0008 4883EC20 		subq	$32, %rsp
 6419 000c 48897DE8 		movq	%rdi, -24(%rbp)
 6420 0010 488975E0 		movq	%rsi, -32(%rbp)
 6421              		.loc 1 2056 1
 6422 0014 64488B04 		movq	%fs:40, %rax
 6422      25280000 
 6422      00
 6423 001d 488945F8 		movq	%rax, -8(%rbp)
 6424 0021 31C0     		xorl	%eax, %eax
2057:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecInt ch = SECUREC_EOF;
 6425              		.loc 1 2057 12
 6426 0023 C745F4FF 		movl	$-1, -12(%rbp)
 6426      FFFFFF
2058:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if SECUREC_ENABLE_SCANF_FILE
2059:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if ((stream->flag & SECUREC_FROM_STDIN_FLAG) > 0) {
 6427              		.loc 1 2059 16
 6428 002a 488B45E8 		movq	-24(%rbp), %rax
 6429 002e 8B00     		movl	(%rax), %eax
 6430              		.loc 1 2059 23
 6431 0030 83E004   		andl	$4, %eax
 6432              		.loc 1 2059 8
GAS LISTING /tmp/cc1ytava.s 			page 168


 6433 0033 85C0     		testl	%eax, %eax
 6434 0035 7411     		je	.L446
2060:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ch = SecGetCharFromStdin(stream);
 6435              		.loc 1 2060 14
 6436 0037 488B45E8 		movq	-24(%rbp), %rax
 6437 003b 4889C7   		movq	%rax, %rdi
 6438 003e E8000000 		call	SecGetCharFromStdin
 6438      00
 6439 0043 8945F4   		movl	%eax, -12(%rbp)
 6440 0046 EB1C     		jmp	.L447
 6441              	.L446:
2061:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else if ((stream->flag & SECUREC_FILE_STREAM_FLAG) > 0) {
 6442              		.loc 1 2061 23
 6443 0048 488B45E8 		movq	-24(%rbp), %rax
 6444 004c 8B00     		movl	(%rax), %eax
 6445              		.loc 1 2061 30
 6446 004e 83E002   		andl	$2, %eax
 6447              		.loc 1 2061 15
 6448 0051 85C0     		testl	%eax, %eax
 6449 0053 740F     		je	.L447
2062:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ch = SecGetCharFromFile(stream);
 6450              		.loc 1 2062 14
 6451 0055 488B45E8 		movq	-24(%rbp), %rax
 6452 0059 4889C7   		movq	%rax, %rdi
 6453 005c E8000000 		call	SecGetCharFromFile
 6453      00
 6454 0061 8945F4   		movl	%eax, -12(%rbp)
 6455              	.L447:
2063:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
2064:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
2065:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if ((stream->flag & SECUREC_MEM_STR_FLAG) > 0) {
 6456              		.loc 1 2065 16
 6457 0064 488B45E8 		movq	-24(%rbp), %rax
 6458 0068 8B00     		movl	(%rax), %eax
 6459              		.loc 1 2065 23
 6460 006a 83E001   		andl	$1, %eax
 6461              		.loc 1 2065 8
 6462 006d 85C0     		testl	%eax, %eax
 6463 006f 7447     		je	.L448
2066:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         /* according  wchar_t has two bytes */
2067:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ch = (SecInt)((stream->count -= (int)sizeof(SecChar)) >= 0 ? \
 6464              		.loc 1 2067 38
 6465 0071 488B45E8 		movq	-24(%rbp), %rax
 6466 0075 8B4004   		movl	4(%rax), %eax
 6467 0078 8D50FC   		leal	-4(%rax), %edx
 6468 007b 488B45E8 		movq	-24(%rbp), %rax
 6469 007f 895004   		movl	%edx, 4(%rax)
 6470 0082 488B45E8 		movq	-24(%rbp), %rax
 6471 0086 8B4004   		movl	4(%rax), %eax
 6472              		.loc 1 2067 14
 6473 0089 85C0     		testl	%eax, %eax
 6474 008b 780F     		js	.L449
2068:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                       (SecInt)(SECUREC_CHAR_MASK & \
2069:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                       (unsigned int)(int)(*((const SecChar *)(const void *)stream->cur))) : SECUREC
 6475              		.loc 1 2069 82 discriminator 1
 6476 008d 488B45E8 		movq	-24(%rbp), %rax
 6477 0091 488B4008 		movq	8(%rax), %rax
GAS LISTING /tmp/cc1ytava.s 			page 169


 6478              		.loc 1 2069 43 discriminator 1
 6479 0095 8B00     		movl	(%rax), %eax
2067:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                       (SecInt)(SECUREC_CHAR_MASK & \
 6480              		.loc 1 2067 14 discriminator 1
 6481 0097 0FB7C0   		movzwl	%ax, %eax
 6482 009a EB05     		jmp	.L450
 6483              	.L449:
2067:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                       (SecInt)(SECUREC_CHAR_MASK & \
 6484              		.loc 1 2067 14 is_stmt 0 discriminator 2
 6485 009c B8FFFFFF 		movl	$-1, %eax
 6485      FF
 6486              	.L450:
2067:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****                       (SecInt)(SECUREC_CHAR_MASK & \
 6487              		.loc 1 2067 12 is_stmt 1 discriminator 4
 6488 00a1 8945F4   		movl	%eax, -12(%rbp)
2070:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         stream->cur += sizeof(SecChar);
 6489              		.loc 1 2070 21 discriminator 4
 6490 00a4 488B45E8 		movq	-24(%rbp), %rax
 6491 00a8 488B4008 		movq	8(%rax), %rax
 6492 00ac 488D5004 		leaq	4(%rax), %rdx
 6493 00b0 488B45E8 		movq	-24(%rbp), %rax
 6494 00b4 48895008 		movq	%rdx, 8(%rax)
 6495              	.L448:
2071:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
2072:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     *counter = *counter + 1;
 6496              		.loc 1 2072 16
 6497 00b8 488B45E0 		movq	-32(%rbp), %rax
 6498 00bc 8B00     		movl	(%rax), %eax
 6499              		.loc 1 2072 25
 6500 00be 8D5001   		leal	1(%rax), %edx
 6501              		.loc 1 2072 14
 6502 00c1 488B45E0 		movq	-32(%rbp), %rax
 6503 00c5 8910     		movl	%edx, (%rax)
2073:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return ch;
 6504              		.loc 1 2073 12
 6505 00c7 8B45F4   		movl	-12(%rbp), %eax
2074:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 6506              		.loc 1 2074 1
 6507 00ca 488B4DF8 		movq	-8(%rbp), %rcx
 6508 00ce 6448330C 		xorq	%fs:40, %rcx
 6508      25280000 
 6508      00
 6509 00d7 7405     		je	.L452
 6510 00d9 E8000000 		call	__stack_chk_fail@PLT
 6510      00
 6511              	.L452:
 6512 00de C9       		leave
 6513              	.LCFI146:
 6514              		.cfi_def_cfa 7, 8
 6515 00df C3       		ret
 6516              		.cfi_endproc
 6517              	.LFE54:
 6519              		.section	.text.SecUnGetCharImpl,"ax",@progbits
 6521              	SecUnGetCharImpl:
 6522              	.LFB55:
2075:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
2076:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
GAS LISTING /tmp/cc1ytava.s 			page 170


2077:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  *  Unget Public realizatio char  for wchar and char version
2078:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
2079:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecUnGetCharImpl(SecInt ch, SecFileStream *stream)
2080:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 6523              		.loc 1 2080 1
 6524              		.cfi_startproc
 6525 0000 F30F1EFA 		endbr64
 6526 0004 55       		pushq	%rbp
 6527              	.LCFI147:
 6528              		.cfi_def_cfa_offset 16
 6529              		.cfi_offset 6, -16
 6530 0005 4889E5   		movq	%rsp, %rbp
 6531              	.LCFI148:
 6532              		.cfi_def_cfa_register 6
 6533 0008 4883EC20 		subq	$32, %rsp
 6534 000c 897DEC   		movl	%edi, -20(%rbp)
 6535 000f 488975E0 		movq	%rsi, -32(%rbp)
 6536              		.loc 1 2080 1
 6537 0013 64488B04 		movq	%fs:40, %rax
 6537      25280000 
 6537      00
 6538 001c 488945F8 		movq	%rax, -8(%rbp)
 6539 0020 31C0     		xorl	%eax, %eax
2081:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if ((stream->flag & SECUREC_FROM_STDIN_FLAG) > 0) {
 6540              		.loc 1 2081 16
 6541 0022 488B45E0 		movq	-32(%rbp), %rax
 6542 0026 8B00     		movl	(%rax), %eax
 6543              		.loc 1 2081 23
 6544 0028 83E004   		andl	$4, %eax
 6545              		.loc 1 2081 8
 6546 002b 85C0     		testl	%eax, %eax
 6547 002d 7417     		je	.L454
2082:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if SECUREC_ENABLE_SCANF_FILE
2083:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if defined(SECUREC_NO_STD_UNGETC)
2084:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         stream->lastChar = (unsigned int)ch;
2085:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         stream->fUnget = 1;
2086:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
2087:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         (void)SECUREC_UN_GETC(ch, stream->pf);
 6548              		.loc 1 2087 41
 6549 002f 488B45E0 		movq	-32(%rbp), %rax
 6550 0033 488B5018 		movq	24(%rax), %rdx
 6551              		.loc 1 2087 15
 6552 0037 8B45EC   		movl	-20(%rbp), %eax
 6553 003a 4889D6   		movq	%rdx, %rsi
 6554 003d 89C7     		movl	%eax, %edi
 6555 003f E8000000 		call	ungetwc@PLT
 6555      00
 6556 0044 EB54     		jmp	.L455
 6557              	.L454:
2088:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
2089:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #else
2090:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         (void)ch; /* to clear e438 last value assigned not used , the compiler will optimize this c
2091:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
2092:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } else if ((stream->flag & SECUREC_MEM_STR_FLAG) || (stream->flag & SECUREC_LOAD_FILE_TO_MEM_FL
 6558              		.loc 1 2092 23
 6559 0046 488B45E0 		movq	-32(%rbp), %rax
 6560 004a 8B00     		movl	(%rax), %eax
GAS LISTING /tmp/cc1ytava.s 			page 171


 6561              		.loc 1 2092 30
 6562 004c 83E001   		andl	$1, %eax
 6563              		.loc 1 2092 15
 6564 004f 85C0     		testl	%eax, %eax
 6565 0051 750D     		jne	.L456
 6566              		.loc 1 2092 64 discriminator 1
 6567 0053 488B45E0 		movq	-32(%rbp), %rax
 6568 0057 8B00     		movl	(%rax), %eax
 6569              		.loc 1 2092 71 discriminator 1
 6570 0059 83E008   		andl	$8, %eax
 6571              		.loc 1 2092 54 discriminator 1
 6572 005c 85C0     		testl	%eax, %eax
 6573 005e 743A     		je	.L455
 6574              	.L456:
2093:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         if (stream->cur > stream->base) {
 6575              		.loc 1 2093 19
 6576 0060 488B45E0 		movq	-32(%rbp), %rax
 6577 0064 488B5008 		movq	8(%rax), %rdx
 6578              		.loc 1 2093 33
 6579 0068 488B45E0 		movq	-32(%rbp), %rax
 6580 006c 488B4010 		movq	16(%rax), %rax
 6581              		.loc 1 2093 12
 6582 0070 4839C2   		cmpq	%rax, %rdx
 6583 0073 7625     		jbe	.L455
2094:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             stream->cur -= sizeof(SecChar);
 6584              		.loc 1 2094 25
 6585 0075 488B45E0 		movq	-32(%rbp), %rax
 6586 0079 488B4008 		movq	8(%rax), %rax
 6587 007d 488D50FC 		leaq	-4(%rax), %rdx
 6588 0081 488B45E0 		movq	-32(%rbp), %rax
 6589 0085 48895008 		movq	%rdx, 8(%rax)
2095:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****             stream->count += (int)sizeof(SecChar);
 6590              		.loc 1 2095 27
 6591 0089 488B45E0 		movq	-32(%rbp), %rax
 6592 008d 8B4004   		movl	4(%rax), %eax
 6593 0090 8D5004   		leal	4(%rax), %edx
 6594 0093 488B45E0 		movq	-32(%rbp), %rax
 6595 0097 895004   		movl	%edx, 4(%rax)
 6596              	.L455:
2096:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         }
2097:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
2098:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #if SECUREC_ENABLE_SCANF_FILE
2099:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if ((stream->flag & SECUREC_FILE_STREAM_FLAG) > 0 && stream->base) {
 6597              		.loc 1 2099 16
 6598 009a 488B45E0 		movq	-32(%rbp), %rax
 6599 009e 8B00     		movl	(%rax), %eax
 6600              		.loc 1 2099 23
 6601 00a0 83E002   		andl	$2, %eax
 6602              		.loc 1 2099 8
 6603 00a3 85C0     		testl	%eax, %eax
 6604 00a5 741E     		je	.L459
 6605              		.loc 1 2099 64 discriminator 1
 6606 00a7 488B45E0 		movq	-32(%rbp), %rax
 6607 00ab 488B4010 		movq	16(%rax), %rax
 6608              		.loc 1 2099 55 discriminator 1
 6609 00af 4885C0   		testq	%rax, %rax
 6610 00b2 7411     		je	.L459
GAS LISTING /tmp/cc1ytava.s 			page 172


2100:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         stream->fileRealRead -= (int)sizeof(SecChar);
 6611              		.loc 1 2100 30
 6612 00b4 488B45E0 		movq	-32(%rbp), %rax
 6613 00b8 8B4028   		movl	40(%rax), %eax
 6614 00bb 8D50FC   		leal	-4(%rax), %edx
 6615 00be 488B45E0 		movq	-32(%rbp), %rax
 6616 00c2 895028   		movl	%edx, 40(%rax)
 6617              	.L459:
2101:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
2102:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** #endif
2103:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 6618              		.loc 1 2103 1
 6619 00c5 90       		nop
 6620 00c6 488B45F8 		movq	-8(%rbp), %rax
 6621 00ca 64483304 		xorq	%fs:40, %rax
 6621      25280000 
 6621      00
 6622 00d3 7405     		je	.L458
 6623 00d5 E8000000 		call	__stack_chk_fail@PLT
 6623      00
 6624              	.L458:
 6625 00da C9       		leave
 6626              	.LCFI149:
 6627              		.cfi_def_cfa 7, 8
 6628 00db C3       		ret
 6629              		.cfi_endproc
 6630              	.LFE55:
 6632              		.section	.text.SecUnGetChar,"ax",@progbits
 6634              	SecUnGetChar:
 6635              	.LFB56:
2104:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
2105:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
2106:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  *  Unget char  for char version
2107:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
2108:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static void SecUnGetChar(SecInt ch, SecFileStream *stream, int *counter)
2109:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 6636              		.loc 1 2109 1
 6637              		.cfi_startproc
 6638 0000 F30F1EFA 		endbr64
 6639 0004 55       		pushq	%rbp
 6640              	.LCFI150:
 6641              		.cfi_def_cfa_offset 16
 6642              		.cfi_offset 6, -16
 6643 0005 4889E5   		movq	%rsp, %rbp
 6644              	.LCFI151:
 6645              		.cfi_def_cfa_register 6
 6646 0008 4883EC30 		subq	$48, %rsp
 6647 000c 897DEC   		movl	%edi, -20(%rbp)
 6648 000f 488975E0 		movq	%rsi, -32(%rbp)
 6649 0013 488955D8 		movq	%rdx, -40(%rbp)
 6650              		.loc 1 2109 1
 6651 0017 64488B04 		movq	%fs:40, %rax
 6651      25280000 
 6651      00
 6652 0020 488945F8 		movq	%rax, -8(%rbp)
 6653 0024 31C0     		xorl	%eax, %eax
2110:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     if (ch != SECUREC_EOF) {
GAS LISTING /tmp/cc1ytava.s 			page 173


 6654              		.loc 1 2110 8
 6655 0026 837DECFF 		cmpl	$-1, -20(%rbp)
 6656 002a 7411     		je	.L461
2111:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         SecUnGetCharImpl(ch, stream);
 6657              		.loc 1 2111 9
 6658 002c 488B55E0 		movq	-32(%rbp), %rdx
 6659 0030 8B45EC   		movl	-20(%rbp), %eax
 6660 0033 4889D6   		movq	%rdx, %rsi
 6661 0036 89C7     		movl	%eax, %edi
 6662 0038 E8000000 		call	SecUnGetCharImpl
 6662      00
 6663              	.L461:
2112:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     }
2113:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     *counter = *counter - 1;
 6664              		.loc 1 2113 16
 6665 003d 488B45D8 		movq	-40(%rbp), %rax
 6666 0041 8B00     		movl	(%rax), %eax
 6667              		.loc 1 2113 25
 6668 0043 8D50FF   		leal	-1(%rax), %edx
 6669              		.loc 1 2113 14
 6670 0046 488B45D8 		movq	-40(%rbp), %rax
 6671 004a 8910     		movl	%edx, (%rax)
2114:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 6672              		.loc 1 2114 1
 6673 004c 90       		nop
 6674 004d 488B45F8 		movq	-8(%rbp), %rax
 6675 0051 64483304 		xorq	%fs:40, %rax
 6675      25280000 
 6675      00
 6676 005a 7405     		je	.L462
 6677 005c E8000000 		call	__stack_chk_fail@PLT
 6677      00
 6678              	.L462:
 6679 0061 C9       		leave
 6680              	.LCFI152:
 6681              		.cfi_def_cfa 7, 8
 6682 0062 C3       		ret
 6683              		.cfi_endproc
 6684              	.LFE56:
 6686              		.section	.text.SecSkipSpaceChar,"ax",@progbits
 6688              	SecSkipSpaceChar:
 6689              	.LFB57:
2115:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** 
2116:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** /*
2117:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  *  Skip space char by isspace
2118:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****  */
2119:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** static SecInt SecSkipSpaceChar(SecFileStream *stream, int *counter)
2120:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** {
 6690              		.loc 1 2120 1
 6691              		.cfi_startproc
 6692 0000 F30F1EFA 		endbr64
 6693 0004 55       		pushq	%rbp
 6694              	.LCFI153:
 6695              		.cfi_def_cfa_offset 16
 6696              		.cfi_offset 6, -16
 6697 0005 4889E5   		movq	%rsp, %rbp
 6698              	.LCFI154:
GAS LISTING /tmp/cc1ytava.s 			page 174


 6699              		.cfi_def_cfa_register 6
 6700 0008 4883EC20 		subq	$32, %rsp
 6701 000c 48897DE8 		movq	%rdi, -24(%rbp)
 6702 0010 488975E0 		movq	%rsi, -32(%rbp)
 6703              		.loc 1 2120 1
 6704 0014 64488B04 		movq	%fs:40, %rax
 6704      25280000 
 6704      00
 6705 001d 488945F8 		movq	%rax, -8(%rbp)
 6706 0021 31C0     		xorl	%eax, %eax
 6707              	.L465:
2121:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     SecInt ch;
2122:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     do {
2123:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****         ch = SecGetChar(stream, counter);
 6708              		.loc 1 2123 14 discriminator 2
 6709 0023 488B55E0 		movq	-32(%rbp), %rdx
 6710 0027 488B45E8 		movq	-24(%rbp), %rax
 6711 002b 4889D6   		movq	%rdx, %rsi
 6712 002e 4889C7   		movq	%rax, %rdi
 6713 0031 E8000000 		call	SecGetChar
 6713      00
 6714 0036 8945F4   		movl	%eax, -12(%rbp)
2124:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     } while (ch != SECUREC_EOF && SECUREC_IS_SPACE(ch));
 6715              		.loc 1 2124 5 discriminator 2
 6716 0039 837DF4FF 		cmpl	$-1, -12(%rbp)
 6717 003d 740E     		je	.L464
 6718              		.loc 1 2124 35 discriminator 1
 6719 003f 8B45F4   		movl	-12(%rbp), %eax
 6720 0042 89C7     		movl	%eax, %edi
 6721 0044 E8000000 		call	iswspace@PLT
 6721      00
 6722              		.loc 1 2124 32 discriminator 1
 6723 0049 85C0     		testl	%eax, %eax
 6724 004b 75D6     		jne	.L465
 6725              	.L464:
2125:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl ****     return ch;
 6726              		.loc 1 2125 12
 6727 004d 8B45F4   		movl	-12(%rbp), %eax
2126:/home/xingli/share/LiteOS_Lab/secure_c/src/input.inl **** }
 6728              		.loc 1 2126 1
 6729 0050 488B4DF8 		movq	-8(%rbp), %rcx
 6730 0054 6448330C 		xorq	%fs:40, %rcx
 6730      25280000 
 6730      00
 6731 005d 7405     		je	.L467
 6732 005f E8000000 		call	__stack_chk_fail@PLT
 6732      00
 6733              	.L467:
 6734 0064 C9       		leave
 6735              	.LCFI155:
 6736              		.cfi_def_cfa 7, 8
 6737 0065 C3       		ret
 6738              		.cfi_endproc
 6739              	.LFE57:
 6741              		.text
 6742              	.Letext0:
 6743              		.file 2 "/usr/lib/gcc/x86_64-linux-gnu/9/include/stddef.h"
GAS LISTING /tmp/cc1ytava.s 			page 175


 6744              		.file 3 "/usr/lib/gcc/x86_64-linux-gnu/9/include/stdarg.h"
 6745              		.file 4 "<built-in>"
 6746              		.file 5 "/usr/include/x86_64-linux-gnu/bits/types/wint_t.h"
 6747              		.file 6 "/usr/include/x86_64-linux-gnu/bits/types/struct_FILE.h"
 6748              		.file 7 "/usr/include/x86_64-linux-gnu/bits/types/FILE.h"
 6749              		.file 8 "/usr/include/x86_64-linux-gnu/bits/types.h"
 6750              		.file 9 "/usr/include/stdio.h"
 6751              		.file 10 "/usr/include/x86_64-linux-gnu/bits/sys_errlist.h"
 6752              		.file 11 "/home/xingli/share/LiteOS_Lab/secure_c/src/securecutil.h"
 6753              		.file 12 "/home/xingli/share/LiteOS_Lab/secure_c/src/secinput.h"
 6754              		.file 13 "/usr/include/ctype.h"
 12753              		.section	.note.gnu.property,"a"
 12754              		.align 8
 12755 0000 04000000 		.long	 1f - 0f
 12756 0004 10000000 		.long	 4f - 1f
 12757 0008 05000000 		.long	 5
 12758              	0:
 12759 000c 474E5500 		.string	 "GNU"
 12760              	1:
 12761              		.align 8
 12762 0010 020000C0 		.long	 0xc0000002
 12763 0014 04000000 		.long	 3f - 2f
 12764              	2:
 12765 0018 03000000 		.long	 0x3
 12766              	3:
 12767 001c 00000000 		.align 8
 12768              	4:
GAS LISTING /tmp/cc1ytava.s 			page 176


DEFINED SYMBOLS
                            *ABS*:0000000000000000 secureinput_w.c
     /tmp/cc1ytava.s:6      .text.SecIs64BitPtr:0000000000000000 SecIs64BitPtr
     /tmp/cc1ytava.s:53     .text.SecAssignFloat:0000000000000000 SecAssignFloat
     /tmp/cc1ytava.s:131    .text.SecAssignFloatW:0000000000000000 SecAssignFloatW
     /tmp/cc1ytava.s:233    .text.SecUpdateFloatString:0000000000000000 SecUpdateFloatString
     /tmp/cc1ytava.s:464    .text.SecUpdateWcharFlagByType:0000000000000000 SecUpdateWcharFlagByType
     /tmp/cc1ytava.s:530    .text.SecDecodeScanQualifierL:0000000000000000 SecDecodeScanQualifierL
     /tmp/cc1ytava.s:601    .text.SecDecodeScanQualifierI:0000000000000000 SecDecodeScanQualifierI
     /tmp/cc1ytava.s:755    .text.SecDecodeScanWidth:0000000000000000 SecDecodeScanWidth
     /tmp/cc1ytava.s:862    .text.SecSetDefaultScanSpec:0000000000000000 SecSetDefaultScanSpec
     /tmp/cc1ytava.s:935    .text.SecDecodeScanQualifier:0000000000000000 SecDecodeScanQualifier
     /tmp/cc1ytava.s:1156   .text.SecDecodeScanFlag:0000000000000000 SecDecodeScanFlag
     /tmp/cc1ytava.s:1235   .text.SecDecodeClearFormat:0000000000000000 SecDecodeClearFormat
     /tmp/cc1ytava.s:1361   .text.SecAddEndingZero:0000000000000000 SecAddEndingZero
     /tmp/cc1ytava.s:1410   .text.SecClearDestBufW:0000000000000000 SecClearDestBufW
     /tmp/cc1ytava.s:1628   .text.SecAssignNumber:0000000000000000 SecAssignNumber
     /tmp/cc1ytava.s:1739   .text.SecIsLongBitEqual:0000000000000000 SecIsLongBitEqual
     /tmp/cc1ytava.s:1776   .text.SecHexValueOfChar:0000000000000000 SecHexValueOfChar
     /tmp/cc1ytava.s:1831   .text.SecDecodeNumberDecimal:0000000000000000 SecDecodeNumberDecimal
     /tmp/cc1ytava.s:1943   .text.SecDecodeNumberHex:0000000000000000 SecDecodeNumberHex
     /tmp/cc1ytava.s:2009   .text.SecDecodeNumberOctal:0000000000000000 SecDecodeNumberOctal
     /tmp/cc1ytava.s:2074   .text.SecFinishNumberNegativeOther:0000000000000000 SecFinishNumberNegativeOther
     /tmp/cc1ytava.s:2191   .text.SecFinishNumberNegativeInt:0000000000000000 SecFinishNumberNegativeInt
     /tmp/cc1ytava.s:2319   .text.SecFinishNumberPositiveOther:0000000000000000 SecFinishNumberPositiveOther
     /tmp/cc1ytava.s:2417   .text.SecFinishNumberPositiveInt:0000000000000000 SecFinishNumberPositiveInt
     /tmp/cc1ytava.s:2509   .text.SecDecodeNumber64Decimal:0000000000000000 SecDecodeNumber64Decimal
     /tmp/cc1ytava.s:2604   .text.SecDecodeNumber64Hex:0000000000000000 SecDecodeNumber64Hex
     /tmp/cc1ytava.s:2670   .text.SecDecodeNumber64Octal:0000000000000000 SecDecodeNumber64Octal
     /tmp/cc1ytava.s:2737   .data.rel.local.g_secDecodeNumberHex:0000000000000000 g_secDecodeNumberHex
     /tmp/cc1ytava.s:2744   .data.rel.local.g_secDecodeNumberOctal:0000000000000000 g_secDecodeNumberOctal
     /tmp/cc1ytava.s:2751   .data.rel.local.g_secDecodeNumberDecimal:0000000000000000 g_secDecodeNumberDecimal
     /tmp/cc1ytava.s:2756   .text.SecDecodeNumber:0000000000000000 SecDecodeNumber
     /tmp/cc1ytava.s:2916   .text.SecFinishNumber:0000000000000000 SecFinishNumber
     /tmp/cc1ytava.s:3011   .text.SecFinishNumber64:0000000000000000 SecFinishNumber64
     /tmp/cc1ytava.s:3176   .data.rel.local.g_secFinishNumber:0000000000000000 g_secFinishNumber
     /tmp/cc1ytava.s:3181   .text.SecSeekStream:0000000000000000 SecSeekStream
     /tmp/cc1ytava.s:3285   .text.SecAdjustStream:0000000000000000 SecAdjustStream
     /tmp/cc1ytava.s:3351   .text.SecSkipSpaceFormat:0000000000000000 SecSkipSpaceFormat
     /tmp/cc1ytava.s:3407   .text.SecSetupBracketTable:0000000000000000 SecSetupBracketTable
     /tmp/cc1ytava.s:3724   .text.SecInputForWchar:0000000000000000 SecInputForWchar
     /tmp/cc1ytava.s:3862   .text.SecInitFloatSpec:0000000000000000 SecInitFloatSpec
     /tmp/cc1ytava.s:3917   .text.SecClearFloatSpec:0000000000000000 SecClearFloatSpec
     /tmp/cc1ytava.s:4011   .text.SecInputFloatE:0000000000000000 SecInputFloatE
     /tmp/cc1ytava.s:6406   .text.SecGetChar:0000000000000000 SecGetChar
     /tmp/cc1ytava.s:4153   .text.SecInputFloat:0000000000000000 SecInputFloat
     /tmp/cc1ytava.s:6634   .text.SecUnGetChar:0000000000000000 SecUnGetChar
     /tmp/cc1ytava.s:4474   .text.SecInputNumberDigital:0000000000000000 SecInputNumberDigital
     /tmp/cc1ytava.s:4590   .text.SecInputNumber:0000000000000000 SecInputNumber
     /tmp/cc1ytava.s:4789   .text.SecInputString:0000000000000000 SecInputString
     /tmp/cc1ytava.s:5051   .text.SecAllocBracketTable:0000000000000000 SecAllocBracketTable
     /tmp/cc1ytava.s:5110   .text.SecFreeBracketTable:0000000000000000 SecFreeBracketTable
     /tmp/cc1ytava.s:5160   .text.SecInputSW:0000000000000000 SecInputSW
     /tmp/cc1ytava.s:6688   .text.SecSkipSpaceChar:0000000000000000 SecSkipSpaceChar
     /tmp/cc1ytava.s:6027   .text.SecGetCharFromStdin:0000000000000000 SecGetCharFromStdin
     /tmp/cc1ytava.s:6069   .text.SecSkipBomHeader:0000000000000000 SecSkipBomHeader
     /tmp/cc1ytava.s:6203   .text.SecGetCharFromFile:0000000000000000 SecGetCharFromFile
GAS LISTING /tmp/cc1ytava.s 			page 177


     /tmp/cc1ytava.s:6521   .text.SecUnGetCharImpl:0000000000000000 SecUnGetCharImpl

UNDEFINED SYMBOLS
_GLOBAL_OFFSET_TABLE_
__stack_chk_fail
strtold
strtod
malloc
wcstombs
free
memcpy_s
memset_s
__ctype_b_loc
memset
feof
fseek
iswspace
wctomb
fgetwc
fread
ftell
ungetwc
