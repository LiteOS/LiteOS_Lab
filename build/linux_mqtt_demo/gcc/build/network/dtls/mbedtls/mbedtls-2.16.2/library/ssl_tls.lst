GAS LISTING /tmp/ccEn8xFO.s 			page 1


   1              		.file	"ssl_tls.c"
   2              		.text
   3              	.Ltext0:
   4              		.section	.text.mbedtls_pk_ec,"ax",@progbits
   6              	mbedtls_pk_ec:
   7              	.LFB7:
   8              		.file 1 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h"
   1:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /**
   2:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * \file pk.h
   3:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *
   4:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * \brief Public Key abstraction layer
   5:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  */
   6:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /*
   7:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  Copyright (C) 2006-2015, ARM Limited, All Rights Reserved
   8:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  SPDX-License-Identifier: Apache-2.0
   9:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *
  10:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  Licensed under the Apache License, Version 2.0 (the "License"); you may
  11:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  not use this file except in compliance with the License.
  12:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  You may obtain a copy of the License at
  13:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *
  14:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  http://www.apache.org/licenses/LICENSE-2.0
  15:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *
  16:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  Unless required by applicable law or agreed to in writing, software
  17:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  18:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  19:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  See the License for the specific language governing permissions and
  20:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  limitations under the License.
  21:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *
  22:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  This file is part of mbed TLS (https://tls.mbed.org)
  23:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  */
  24:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  25:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #ifndef MBEDTLS_PK_H
  26:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_PK_H
  27:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  28:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #if !defined(MBEDTLS_CONFIG_FILE)
  29:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #include "config.h"
  30:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #else
  31:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #include MBEDTLS_CONFIG_FILE
  32:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #endif
  33:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  34:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #include "md.h"
  35:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  36:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #if defined(MBEDTLS_RSA_C)
  37:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #include "rsa.h"
  38:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #endif
  39:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  40:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #if defined(MBEDTLS_ECP_C)
  41:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #include "ecp.h"
  42:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #endif
  43:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  44:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #if defined(MBEDTLS_ECDSA_C)
  45:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #include "ecdsa.h"
  46:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #endif
  47:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  48:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #if ( defined(__ARMCC_VERSION) || defined(_MSC_VER) ) && \
  49:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     !defined(inline) && !defined(__cplusplus)
  50:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define inline __inline
GAS LISTING /tmp/ccEn8xFO.s 			page 2


  51:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #endif
  52:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  53:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_ALLOC_FAILED        -0x3F80  /**< Memory allocation failed. */
  54:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_TYPE_MISMATCH       -0x3F00  /**< Type mismatch, eg attempt to encrypt with 
  55:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_BAD_INPUT_DATA      -0x3E80  /**< Bad input parameters to function. */
  56:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_FILE_IO_ERROR       -0x3E00  /**< Read/write of file failed. */
  57:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_KEY_INVALID_VERSION -0x3D80  /**< Unsupported key version */
  58:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_KEY_INVALID_FORMAT  -0x3D00  /**< Invalid key tag or value. */
  59:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_UNKNOWN_PK_ALG      -0x3C80  /**< Key algorithm is unsupported (only RSA and
  60:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_PASSWORD_REQUIRED   -0x3C00  /**< Private key password can't be empty. */
  61:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_PASSWORD_MISMATCH   -0x3B80  /**< Given private key password does not allow 
  62:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_INVALID_PUBKEY      -0x3B00  /**< The pubkey tag or value is invalid (only R
  63:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_INVALID_ALG         -0x3A80  /**< The algorithm tag or value is invalid. */
  64:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_UNKNOWN_NAMED_CURVE -0x3A00  /**< Elliptic curve is unsupported (only NIST c
  65:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_FEATURE_UNAVAILABLE -0x3980  /**< Unavailable feature, e.g. RSA disabled for
  66:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_SIG_LEN_MISMATCH    -0x3900  /**< The buffer contains a valid signature foll
  67:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  68:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /* MBEDTLS_ERR_PK_HW_ACCEL_FAILED is deprecated and should not be used. */
  69:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_HW_ACCEL_FAILED     -0x3880  /**< PK hardware accelerator failed. */
  70:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  71:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #ifdef __cplusplus
  72:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** extern "C" {
  73:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #endif
  74:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  75:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /**
  76:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * \brief          Public key types
  77:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  */
  78:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** typedef enum {
  79:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     MBEDTLS_PK_NONE=0,
  80:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     MBEDTLS_PK_RSA,
  81:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     MBEDTLS_PK_ECKEY,
  82:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     MBEDTLS_PK_ECKEY_DH,
  83:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     MBEDTLS_PK_ECDSA,
  84:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     MBEDTLS_PK_RSA_ALT,
  85:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     MBEDTLS_PK_RSASSA_PSS,
  86:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** } mbedtls_pk_type_t;
  87:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  88:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /**
  89:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * \brief           Options for RSASSA-PSS signature verification.
  90:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *                  See \c mbedtls_rsa_rsassa_pss_verify_ext()
  91:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  */
  92:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** typedef struct mbedtls_pk_rsassa_pss_options
  93:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** {
  94:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     mbedtls_md_type_t mgf1_hash_id;
  95:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     int expected_salt_len;
  96:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  97:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** } mbedtls_pk_rsassa_pss_options;
  98:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  99:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /**
 100:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * \brief           Types for interfacing with the debug module
 101:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  */
 102:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** typedef enum
 103:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** {
 104:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     MBEDTLS_PK_DEBUG_NONE = 0,
 105:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     MBEDTLS_PK_DEBUG_MPI,
 106:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     MBEDTLS_PK_DEBUG_ECP,
 107:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** } mbedtls_pk_debug_type;
GAS LISTING /tmp/ccEn8xFO.s 			page 3


 108:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
 109:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /**
 110:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * \brief           Item to send to the debug module
 111:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  */
 112:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** typedef struct mbedtls_pk_debug_item
 113:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** {
 114:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     mbedtls_pk_debug_type type;
 115:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     const char *name;
 116:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     void *value;
 117:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** } mbedtls_pk_debug_item;
 118:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
 119:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /** Maximum number of item send for debugging, plus 1 */
 120:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_PK_DEBUG_MAX_ITEMS 3
 121:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
 122:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /**
 123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * \brief           Public key information and operations
 124:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  */
 125:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** typedef struct mbedtls_pk_info_t mbedtls_pk_info_t;
 126:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
 127:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /**
 128:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * \brief           Public key container
 129:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  */
 130:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** typedef struct mbedtls_pk_context
 131:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** {
 132:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     const mbedtls_pk_info_t *   pk_info; /**< Public key information         */
 133:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     void *                      pk_ctx;  /**< Underlying public key context  */
 134:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** } mbedtls_pk_context;
 135:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
 136:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #if defined(MBEDTLS_ECDSA_C) && defined(MBEDTLS_ECP_RESTARTABLE)
 137:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /**
 138:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * \brief           Context for resuming operations
 139:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  */
 140:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** typedef struct
 141:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** {
 142:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     const mbedtls_pk_info_t *   pk_info; /**< Public key information         */
 143:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     void *                      rs_ctx;  /**< Underlying restart context     */
 144:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** } mbedtls_pk_restart_ctx;
 145:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #else /* MBEDTLS_ECDSA_C && MBEDTLS_ECP_RESTARTABLE */
 146:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /* Now we can declare functions that take a pointer to that */
 147:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** typedef void mbedtls_pk_restart_ctx;
 148:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #endif /* MBEDTLS_ECDSA_C && MBEDTLS_ECP_RESTARTABLE */
 149:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
 150:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #if defined(MBEDTLS_RSA_C)
 151:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /**
 152:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * Quick access to an RSA context inside a PK context.
 153:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *
 154:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * \warning You must make sure the PK context actually holds an RSA context
 155:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * before using this function!
 156:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  */
 157:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** static inline mbedtls_rsa_context *mbedtls_pk_rsa( const mbedtls_pk_context pk )
 158:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** {
 159:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     return( (mbedtls_rsa_context *) (pk).pk_ctx );
 160:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** }
 161:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #endif /* MBEDTLS_RSA_C */
 162:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
 163:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #if defined(MBEDTLS_ECP_C)
 164:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /**
GAS LISTING /tmp/ccEn8xFO.s 			page 4


 165:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * Quick access to an EC context inside a PK context.
 166:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *
 167:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * \warning You must make sure the PK context actually holds an EC context
 168:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * before using this function!
 169:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  */
 170:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** static inline mbedtls_ecp_keypair *mbedtls_pk_ec( const mbedtls_pk_context pk )
 171:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** {
   9              		.loc 1 171 1
  10              		.cfi_startproc
  11 0000 55       		pushq	%rbp
  12              	.LCFI0:
  13              		.cfi_def_cfa_offset 16
  14              		.cfi_offset 6, -16
  15 0001 4889E5   		movq	%rsp, %rbp
  16              	.LCFI1:
  17              		.cfi_def_cfa_register 6
  18 0004 4883EC20 		subq	$32, %rsp
  19 0008 4889F8   		movq	%rdi, %rax
  20 000b 4889F1   		movq	%rsi, %rcx
  21 000e 4889CA   		movq	%rcx, %rdx
  22 0011 488945E0 		movq	%rax, -32(%rbp)
  23 0015 488955E8 		movq	%rdx, -24(%rbp)
  24              		.loc 1 171 1
  25 0019 64488B04 		movq	%fs:40, %rax
  25      25280000 
  25      00
  26 0022 488945F8 		movq	%rax, -8(%rbp)
  27 0026 31C0     		xorl	%eax, %eax
 172:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     return( (mbedtls_ecp_keypair *) (pk).pk_ctx );
  28              		.loc 1 172 13
  29 0028 488B45E8 		movq	-24(%rbp), %rax
 173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** }
  30              		.loc 1 173 1
  31 002c 488B55F8 		movq	-8(%rbp), %rdx
  32 0030 64483314 		xorq	%fs:40, %rdx
  32      25280000 
  32      00
  33 0039 7405     		je	.L3
  34 003b E8000000 		call	__stack_chk_fail@PLT
  34      00
  35              	.L3:
  36 0040 C9       		leave
  37              	.LCFI2:
  38              		.cfi_def_cfa 7, 8
  39 0041 C3       		ret
  40              		.cfi_endproc
  41              	.LFE7:
  43              		.section	.text.mbedtls_cipher_get_block_size,"ax",@progbits
  45              	mbedtls_cipher_get_block_size:
  46              	.LFB9:
  47              		.file 2 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h"
   1:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** /**
   2:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \file cipher.h
   3:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
   4:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \brief This file contains an abstraction interface for use with the cipher
   5:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * primitives provided by the library. It provides a common interface to all of
   6:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * the available cipher operations.
GAS LISTING /tmp/ccEn8xFO.s 			page 5


   7:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
   8:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \author Adriaan de Jong <dejong@fox-it.com>
   9:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  */
  10:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** /*
  11:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *  Copyright (C) 2006-2018, Arm Limited (or its affiliates), All Rights Reserved
  12:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *  SPDX-License-Identifier: Apache-2.0
  13:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
  14:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *  Licensed under the Apache License, Version 2.0 (the "License"); you may
  15:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *  not use this file except in compliance with the License.
  16:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *  You may obtain a copy of the License at
  17:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
  18:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *  http://www.apache.org/licenses/LICENSE-2.0
  19:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
  20:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *  Unless required by applicable law or agreed to in writing, software
  21:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  22:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  23:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *  See the License for the specific language governing permissions and
  24:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *  limitations under the License.
  25:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
  26:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *  This file is part of Mbed TLS (https://tls.mbed.org)
  27:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  */
  28:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
  29:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #ifndef MBEDTLS_CIPHER_H
  30:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #define MBEDTLS_CIPHER_H
  31:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
  32:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #if !defined(MBEDTLS_CONFIG_FILE)
  33:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #include "config.h"
  34:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #else
  35:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #include MBEDTLS_CONFIG_FILE
  36:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #endif
  37:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
  38:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #include <stddef.h>
  39:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #include "platform_util.h"
  40:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
  41:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #if defined(MBEDTLS_GCM_C) || defined(MBEDTLS_CCM_C) || defined(MBEDTLS_CHACHAPOLY_C)
  42:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #define MBEDTLS_CIPHER_MODE_AEAD
  43:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #endif
  44:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
  45:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #if defined(MBEDTLS_CIPHER_MODE_CBC)
  46:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #define MBEDTLS_CIPHER_MODE_WITH_PADDING
  47:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #endif
  48:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
  49:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #if defined(MBEDTLS_ARC4_C) || defined(MBEDTLS_CIPHER_NULL_CIPHER) || \
  50:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     defined(MBEDTLS_CHACHA20_C)
  51:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #define MBEDTLS_CIPHER_MODE_STREAM
  52:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #endif
  53:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
  54:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #if ( defined(__ARMCC_VERSION) || defined(_MSC_VER) ) && \
  55:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     !defined(inline) && !defined(__cplusplus)
  56:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #define inline __inline
  57:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #endif
  58:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
  59:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #define MBEDTLS_ERR_CIPHER_FEATURE_UNAVAILABLE  -0x6080  /**< The selected feature is not available
  60:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #define MBEDTLS_ERR_CIPHER_BAD_INPUT_DATA       -0x6100  /**< Bad input parameters. */
  61:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #define MBEDTLS_ERR_CIPHER_ALLOC_FAILED         -0x6180  /**< Failed to allocate memory. */
  62:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #define MBEDTLS_ERR_CIPHER_INVALID_PADDING      -0x6200  /**< Input data contains invalid padding a
  63:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #define MBEDTLS_ERR_CIPHER_FULL_BLOCK_EXPECTED  -0x6280  /**< Decryption of block requires a full b
GAS LISTING /tmp/ccEn8xFO.s 			page 6


  64:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #define MBEDTLS_ERR_CIPHER_AUTH_FAILED          -0x6300  /**< Authentication failed (for AEAD modes
  65:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #define MBEDTLS_ERR_CIPHER_INVALID_CONTEXT      -0x6380  /**< The context is invalid. For example, 
  66:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
  67:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** /* MBEDTLS_ERR_CIPHER_HW_ACCEL_FAILED is deprecated and should not be used. */
  68:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #define MBEDTLS_ERR_CIPHER_HW_ACCEL_FAILED      -0x6400  /**< Cipher hardware accelerator failed. *
  69:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
  70:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #define MBEDTLS_CIPHER_VARIABLE_IV_LEN     0x01    /**< Cipher accepts IVs of variable length. */
  71:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #define MBEDTLS_CIPHER_VARIABLE_KEY_LEN    0x02    /**< Cipher accepts keys of variable length. */
  72:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
  73:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #ifdef __cplusplus
  74:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** extern "C" {
  75:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #endif
  76:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
  77:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** /**
  78:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \brief     Supported cipher types.
  79:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
  80:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \warning   RC4 and DES are considered weak ciphers and their use
  81:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *            constitutes a security risk. Arm recommends considering stronger
  82:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *            ciphers instead.
  83:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  */
  84:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** typedef enum {
  85:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ID_NONE = 0,  /**< Placeholder to mark the end of cipher ID lists. */
  86:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ID_NULL,      /**< The identity cipher, treated as a stream cipher. */
  87:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ID_AES,       /**< The AES cipher. */
  88:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ID_DES,       /**< The DES cipher. */
  89:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ID_3DES,      /**< The Triple DES cipher. */
  90:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ID_CAMELLIA,  /**< The Camellia cipher. */
  91:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ID_BLOWFISH,  /**< The Blowfish cipher. */
  92:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ID_ARC4,      /**< The RC4 cipher. */
  93:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ID_ARIA,      /**< The Aria cipher. */
  94:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ID_CHACHA20,  /**< The ChaCha20 cipher. */
  95:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** } mbedtls_cipher_id_t;
  96:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
  97:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** /**
  98:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \brief     Supported {cipher type, cipher mode} pairs.
  99:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
 100:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \warning   RC4 and DES are considered weak ciphers and their use
 101:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *            constitutes a security risk. Arm recommends considering stronger
 102:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *            ciphers instead.
 103:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  */
 104:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** typedef enum {
 105:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_NONE = 0,             /**< Placeholder to mark the end of cipher-pair lists. */
 106:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_NULL,                 /**< The identity stream cipher. */
 107:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_AES_128_ECB,          /**< AES cipher with 128-bit ECB mode. */
 108:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_AES_192_ECB,          /**< AES cipher with 192-bit ECB mode. */
 109:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_AES_256_ECB,          /**< AES cipher with 256-bit ECB mode. */
 110:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_AES_128_CBC,          /**< AES cipher with 128-bit CBC mode. */
 111:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_AES_192_CBC,          /**< AES cipher with 192-bit CBC mode. */
 112:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_AES_256_CBC,          /**< AES cipher with 256-bit CBC mode. */
 113:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_AES_128_CFB128,       /**< AES cipher with 128-bit CFB128 mode. */
 114:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_AES_192_CFB128,       /**< AES cipher with 192-bit CFB128 mode. */
 115:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_AES_256_CFB128,       /**< AES cipher with 256-bit CFB128 mode. */
 116:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_AES_128_CTR,          /**< AES cipher with 128-bit CTR mode. */
 117:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_AES_192_CTR,          /**< AES cipher with 192-bit CTR mode. */
 118:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_AES_256_CTR,          /**< AES cipher with 256-bit CTR mode. */
 119:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_AES_128_GCM,          /**< AES cipher with 128-bit GCM mode. */
 120:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_AES_192_GCM,          /**< AES cipher with 192-bit GCM mode. */
GAS LISTING /tmp/ccEn8xFO.s 			page 7


 121:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_AES_256_GCM,          /**< AES cipher with 256-bit GCM mode. */
 122:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_128_ECB,     /**< Camellia cipher with 128-bit ECB mode. */
 123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_192_ECB,     /**< Camellia cipher with 192-bit ECB mode. */
 124:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_256_ECB,     /**< Camellia cipher with 256-bit ECB mode. */
 125:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_128_CBC,     /**< Camellia cipher with 128-bit CBC mode. */
 126:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_192_CBC,     /**< Camellia cipher with 192-bit CBC mode. */
 127:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_256_CBC,     /**< Camellia cipher with 256-bit CBC mode. */
 128:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_128_CFB128,  /**< Camellia cipher with 128-bit CFB128 mode. */
 129:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_192_CFB128,  /**< Camellia cipher with 192-bit CFB128 mode. */
 130:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_256_CFB128,  /**< Camellia cipher with 256-bit CFB128 mode. */
 131:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_128_CTR,     /**< Camellia cipher with 128-bit CTR mode. */
 132:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_192_CTR,     /**< Camellia cipher with 192-bit CTR mode. */
 133:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_256_CTR,     /**< Camellia cipher with 256-bit CTR mode. */
 134:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_128_GCM,     /**< Camellia cipher with 128-bit GCM mode. */
 135:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_192_GCM,     /**< Camellia cipher with 192-bit GCM mode. */
 136:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_256_GCM,     /**< Camellia cipher with 256-bit GCM mode. */
 137:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_DES_ECB,              /**< DES cipher with ECB mode. */
 138:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_DES_CBC,              /**< DES cipher with CBC mode. */
 139:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_DES_EDE_ECB,          /**< DES cipher with EDE ECB mode. */
 140:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_DES_EDE_CBC,          /**< DES cipher with EDE CBC mode. */
 141:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_DES_EDE3_ECB,         /**< DES cipher with EDE3 ECB mode. */
 142:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_DES_EDE3_CBC,         /**< DES cipher with EDE3 CBC mode. */
 143:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_BLOWFISH_ECB,         /**< Blowfish cipher with ECB mode. */
 144:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_BLOWFISH_CBC,         /**< Blowfish cipher with CBC mode. */
 145:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_BLOWFISH_CFB64,       /**< Blowfish cipher with CFB64 mode. */
 146:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_BLOWFISH_CTR,         /**< Blowfish cipher with CTR mode. */
 147:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ARC4_128,             /**< RC4 cipher with 128-bit mode. */
 148:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_AES_128_CCM,          /**< AES cipher with 128-bit CCM mode. */
 149:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_AES_192_CCM,          /**< AES cipher with 192-bit CCM mode. */
 150:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_AES_256_CCM,          /**< AES cipher with 256-bit CCM mode. */
 151:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_128_CCM,     /**< Camellia cipher with 128-bit CCM mode. */
 152:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_192_CCM,     /**< Camellia cipher with 192-bit CCM mode. */
 153:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_256_CCM,     /**< Camellia cipher with 256-bit CCM mode. */
 154:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ARIA_128_ECB,         /**< Aria cipher with 128-bit key and ECB mode. */
 155:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ARIA_192_ECB,         /**< Aria cipher with 192-bit key and ECB mode. */
 156:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ARIA_256_ECB,         /**< Aria cipher with 256-bit key and ECB mode. */
 157:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ARIA_128_CBC,         /**< Aria cipher with 128-bit key and CBC mode. */
 158:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ARIA_192_CBC,         /**< Aria cipher with 192-bit key and CBC mode. */
 159:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ARIA_256_CBC,         /**< Aria cipher with 256-bit key and CBC mode. */
 160:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ARIA_128_CFB128,      /**< Aria cipher with 128-bit key and CFB-128 mode. */
 161:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ARIA_192_CFB128,      /**< Aria cipher with 192-bit key and CFB-128 mode. */
 162:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ARIA_256_CFB128,      /**< Aria cipher with 256-bit key and CFB-128 mode. */
 163:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ARIA_128_CTR,         /**< Aria cipher with 128-bit key and CTR mode. */
 164:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ARIA_192_CTR,         /**< Aria cipher with 192-bit key and CTR mode. */
 165:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ARIA_256_CTR,         /**< Aria cipher with 256-bit key and CTR mode. */
 166:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ARIA_128_GCM,         /**< Aria cipher with 128-bit key and GCM mode. */
 167:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ARIA_192_GCM,         /**< Aria cipher with 192-bit key and GCM mode. */
 168:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ARIA_256_GCM,         /**< Aria cipher with 256-bit key and GCM mode. */
 169:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ARIA_128_CCM,         /**< Aria cipher with 128-bit key and CCM mode. */
 170:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ARIA_192_CCM,         /**< Aria cipher with 192-bit key and CCM mode. */
 171:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_ARIA_256_CCM,         /**< Aria cipher with 256-bit key and CCM mode. */
 172:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_AES_128_OFB,          /**< AES 128-bit cipher in OFB mode. */
 173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_AES_192_OFB,          /**< AES 192-bit cipher in OFB mode. */
 174:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_AES_256_OFB,          /**< AES 256-bit cipher in OFB mode. */
 175:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_AES_128_XTS,          /**< AES 128-bit cipher in XTS block mode. */
 176:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_AES_256_XTS,          /**< AES 256-bit cipher in XTS block mode. */
 177:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_CHACHA20,             /**< ChaCha20 stream cipher. */
GAS LISTING /tmp/ccEn8xFO.s 			page 8


 178:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_CIPHER_CHACHA20_POLY1305,    /**< ChaCha20-Poly1305 AEAD cipher. */
 179:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** } mbedtls_cipher_type_t;
 180:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 181:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** /** Supported cipher modes. */
 182:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** typedef enum {
 183:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_MODE_NONE = 0,               /**< None. */
 184:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_MODE_ECB,                    /**< The ECB cipher mode. */
 185:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_MODE_CBC,                    /**< The CBC cipher mode. */
 186:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_MODE_CFB,                    /**< The CFB cipher mode. */
 187:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_MODE_OFB,                    /**< The OFB cipher mode. */
 188:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_MODE_CTR,                    /**< The CTR cipher mode. */
 189:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_MODE_GCM,                    /**< The GCM cipher mode. */
 190:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_MODE_STREAM,                 /**< The stream cipher mode. */
 191:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_MODE_CCM,                    /**< The CCM cipher mode. */
 192:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_MODE_XTS,                    /**< The XTS cipher mode. */
 193:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_MODE_CHACHAPOLY,             /**< The ChaCha-Poly cipher mode. */
 194:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** } mbedtls_cipher_mode_t;
 195:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 196:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** /** Supported cipher padding types. */
 197:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** typedef enum {
 198:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_PADDING_PKCS7 = 0,     /**< PKCS7 padding (default).        */
 199:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_PADDING_ONE_AND_ZEROS, /**< ISO/IEC 7816-4 padding.         */
 200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_PADDING_ZEROS_AND_LEN, /**< ANSI X.923 padding.             */
 201:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_PADDING_ZEROS,         /**< Zero padding (not reversible). */
 202:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_PADDING_NONE,          /**< Never pad (full blocks only).   */
 203:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** } mbedtls_cipher_padding_t;
 204:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 205:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** /** Type of operation. */
 206:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** typedef enum {
 207:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_OPERATION_NONE = -1,
 208:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_DECRYPT = 0,
 209:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_ENCRYPT,
 210:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** } mbedtls_operation_t;
 211:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 212:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** enum {
 213:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     /** Undefined key length. */
 214:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_KEY_LENGTH_NONE = 0,
 215:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     /** Key length, in bits (including parity), for DES keys. */
 216:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_KEY_LENGTH_DES  = 64,
 217:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     /** Key length in bits, including parity, for DES in two-key EDE. */
 218:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_KEY_LENGTH_DES_EDE = 128,
 219:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     /** Key length in bits, including parity, for DES in three-key EDE. */
 220:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_KEY_LENGTH_DES_EDE3 = 192,
 221:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** };
 222:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 223:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** /** Maximum length of any IV, in Bytes. */
 224:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #define MBEDTLS_MAX_IV_LENGTH      16
 225:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** /** Maximum block size of any cipher, in Bytes. */
 226:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #define MBEDTLS_MAX_BLOCK_LENGTH   16
 227:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 228:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** /**
 229:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * Base cipher information (opaque struct).
 230:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  */
 231:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** typedef struct mbedtls_cipher_base_t mbedtls_cipher_base_t;
 232:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 233:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** /**
 234:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * CMAC context (opaque struct).
GAS LISTING /tmp/ccEn8xFO.s 			page 9


 235:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  */
 236:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** typedef struct mbedtls_cmac_context_t mbedtls_cmac_context_t;
 237:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 238:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** /**
 239:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * Cipher information. Allows calling cipher functions
 240:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * in a generic way.
 241:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  */
 242:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** typedef struct mbedtls_cipher_info_t
 243:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** {
 244:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     /** Full cipher identifier. For example,
 245:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****      * MBEDTLS_CIPHER_AES_256_CBC.
 246:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****      */
 247:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     mbedtls_cipher_type_t type;
 248:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 249:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     /** The cipher mode. For example, MBEDTLS_MODE_CBC. */
 250:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     mbedtls_cipher_mode_t mode;
 251:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 252:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     /** The cipher key length, in bits. This is the
 253:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****      * default length for variable sized ciphers.
 254:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****      * Includes parity bits for ciphers like DES.
 255:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****      */
 256:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     unsigned int key_bitlen;
 257:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 258:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     /** Name of the cipher. */
 259:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     const char * name;
 260:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 261:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     /** IV or nonce size, in Bytes.
 262:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****      * For ciphers that accept variable IV sizes,
 263:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****      * this is the recommended size.
 264:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****      */
 265:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     unsigned int iv_size;
 266:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 267:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     /** Bitflag comprised of MBEDTLS_CIPHER_VARIABLE_IV_LEN and
 268:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****      *  MBEDTLS_CIPHER_VARIABLE_KEY_LEN indicating whether the
 269:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****      *  cipher supports variable IV or variable key sizes, respectively.
 270:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****      */
 271:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     int flags;
 272:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 273:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     /** The block size, in Bytes. */
 274:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     unsigned int block_size;
 275:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 276:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     /** Struct for base cipher information and functions. */
 277:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     const mbedtls_cipher_base_t *base;
 278:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 279:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** } mbedtls_cipher_info_t;
 280:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 281:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** /**
 282:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * Generic cipher context.
 283:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  */
 284:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** typedef struct mbedtls_cipher_context_t
 285:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** {
 286:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     /** Information about the associated cipher. */
 287:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     const mbedtls_cipher_info_t *cipher_info;
 288:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 289:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     /** Key length to use. */
 290:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     int key_bitlen;
 291:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 10


 292:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     /** Operation that the key of the context has been
 293:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****      * initialized for.
 294:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****      */
 295:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     mbedtls_operation_t operation;
 296:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 297:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #if defined(MBEDTLS_CIPHER_MODE_WITH_PADDING)
 298:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     /** Padding functions to use, if relevant for
 299:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****      * the specific cipher mode.
 300:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****      */
 301:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     void (*add_padding)( unsigned char *output, size_t olen, size_t data_len );
 302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     int (*get_padding)( unsigned char *input, size_t ilen, size_t *data_len );
 303:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #endif
 304:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 305:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     /** Buffer for input that has not been processed yet. */
 306:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     unsigned char unprocessed_data[MBEDTLS_MAX_BLOCK_LENGTH];
 307:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 308:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     /** Number of Bytes that have not been processed yet. */
 309:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     size_t unprocessed_len;
 310:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 311:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     /** Current IV or NONCE_COUNTER for CTR-mode, data unit (or sector) number
 312:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****      * for XTS-mode. */
 313:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     unsigned char iv[MBEDTLS_MAX_IV_LENGTH];
 314:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 315:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     /** IV size in Bytes, for ciphers with variable-length IVs. */
 316:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     size_t iv_size;
 317:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 318:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     /** The cipher-specific context. */
 319:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     void *cipher_ctx;
 320:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 321:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #if defined(MBEDTLS_CMAC_C)
 322:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     /** CMAC-specific context. */
 323:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     mbedtls_cmac_context_t *cmac_ctx;
 324:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** #endif
 325:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** } mbedtls_cipher_context_t;
 326:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 327:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** /**
 328:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \brief This function retrieves the list of ciphers supported by the generic
 329:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * cipher module.
 330:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
 331:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \return      A statically-allocated array of ciphers. The last entry
 332:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *              is zero.
 333:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  */
 334:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** const int *mbedtls_cipher_list( void );
 335:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 336:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** /**
 337:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \brief               This function retrieves the cipher-information
 338:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *                      structure associated with the given cipher name.
 339:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
 340:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \param cipher_name   Name of the cipher to search for. This must not be
 341:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *                      \c NULL.
 342:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
 343:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \return              The cipher information structure associated with the
 344:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *                      given \p cipher_name.
 345:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \return              \c NULL if the associated cipher information is not found.
 346:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  */
 347:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** const mbedtls_cipher_info_t *mbedtls_cipher_info_from_string( const char *cipher_name );
 348:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 11


 349:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** /**
 350:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \brief               This function retrieves the cipher-information
 351:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *                      structure associated with the given cipher type.
 352:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
 353:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \param cipher_type   Type of the cipher to search for.
 354:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
 355:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \return              The cipher information structure associated with the
 356:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *                      given \p cipher_type.
 357:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \return              \c NULL if the associated cipher information is not found.
 358:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  */
 359:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** const mbedtls_cipher_info_t *mbedtls_cipher_info_from_type( const mbedtls_cipher_type_t cipher_type
 360:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 361:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** /**
 362:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \brief               This function retrieves the cipher-information
 363:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *                      structure associated with the given cipher ID,
 364:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *                      key size and mode.
 365:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
 366:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \param cipher_id     The ID of the cipher to search for. For example,
 367:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *                      #MBEDTLS_CIPHER_ID_AES.
 368:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \param key_bitlen    The length of the key in bits.
 369:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \param mode          The cipher mode. For example, #MBEDTLS_MODE_CBC.
 370:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
 371:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \return              The cipher information structure associated with the
 372:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *                      given \p cipher_id.
 373:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \return              \c NULL if the associated cipher information is not found.
 374:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  */
 375:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** const mbedtls_cipher_info_t *mbedtls_cipher_info_from_values( const mbedtls_cipher_id_t cipher_id,
 376:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****                                               int key_bitlen,
 377:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****                                               const mbedtls_cipher_mode_t mode );
 378:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 379:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** /**
 380:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \brief               This function initializes a \p cipher_context as NONE.
 381:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
 382:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \param ctx           The context to be initialized. This must not be \c NULL.
 383:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  */
 384:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** void mbedtls_cipher_init( mbedtls_cipher_context_t *ctx );
 385:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 386:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** /**
 387:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \brief               This function frees and clears the cipher-specific
 388:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *                      context of \p ctx. Freeing \p ctx itself remains the
 389:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *                      responsibility of the caller.
 390:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
 391:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \param ctx           The context to be freed. If this is \c NULL, the
 392:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *                      function has no effect, otherwise this must point to an
 393:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *                      initialized context.
 394:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  */
 395:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** void mbedtls_cipher_free( mbedtls_cipher_context_t *ctx );
 396:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 397:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 398:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** /**
 399:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \brief               This function initializes and fills the cipher-context
 400:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *                      structure with the appropriate values. It also clears
 401:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *                      the structure.
 402:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
 403:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \param ctx           The context to initialize. This must be initialized.
 404:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \param cipher_info   The cipher to use.
 405:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
GAS LISTING /tmp/ccEn8xFO.s 			page 12


 406:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \return              \c 0 on success.
 407:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \return              #MBEDTLS_ERR_CIPHER_BAD_INPUT_DATA on
 408:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *                      parameter-verification failure.
 409:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \return              #MBEDTLS_ERR_CIPHER_ALLOC_FAILED if allocation of the
 410:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *                      cipher-specific context fails.
 411:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
 412:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \internal Currently, the function also clears the structure.
 413:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * In future versions, the caller will be required to call
 414:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * mbedtls_cipher_init() on the structure first.
 415:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  */
 416:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** int mbedtls_cipher_setup( mbedtls_cipher_context_t *ctx,
 417:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****                           const mbedtls_cipher_info_t *cipher_info );
 418:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 419:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** /**
 420:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \brief        This function returns the block size of the given cipher.
 421:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
 422:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \param ctx    The context of the cipher. This must be initialized.
 423:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
 424:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \return       The block size of the underlying cipher.
 425:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \return       \c 0 if \p ctx has not been initialized.
 426:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  */
 427:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** static inline unsigned int mbedtls_cipher_get_block_size(
 428:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     const mbedtls_cipher_context_t *ctx )
 429:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** {
  48              		.loc 2 429 1
  49              		.cfi_startproc
  50 0000 55       		pushq	%rbp
  51              	.LCFI3:
  52              		.cfi_def_cfa_offset 16
  53              		.cfi_offset 6, -16
  54 0001 4889E5   		movq	%rsp, %rbp
  55              	.LCFI4:
  56              		.cfi_def_cfa_register 6
  57 0004 4883EC20 		subq	$32, %rsp
  58 0008 48897DE8 		movq	%rdi, -24(%rbp)
  59              		.loc 2 429 1
  60 000c 64488B04 		movq	%fs:40, %rax
  60      25280000 
  60      00
  61 0015 488945F8 		movq	%rax, -8(%rbp)
  62 0019 31C0     		xorl	%eax, %eax
 430:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_INTERNAL_VALIDATE_RET( ctx != NULL, 0 );
 431:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     if( ctx->cipher_info == NULL )
  63              		.loc 2 431 12
  64 001b 488B45E8 		movq	-24(%rbp), %rax
  65 001f 488B00   		movq	(%rax), %rax
  66              		.loc 2 431 7
  67 0022 4885C0   		testq	%rax, %rax
  68 0025 7507     		jne	.L5
 432:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****         return 0;
  69              		.loc 2 432 16
  70 0027 B8000000 		movl	$0, %eax
  70      00
  71 002c EB0A     		jmp	.L6
  72              	.L5:
 433:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 434:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     return ctx->cipher_info->block_size;
GAS LISTING /tmp/ccEn8xFO.s 			page 13


  73              		.loc 2 434 15
  74 002e 488B45E8 		movq	-24(%rbp), %rax
  75 0032 488B00   		movq	(%rax), %rax
  76              		.loc 2 434 28
  77 0035 8B4020   		movl	32(%rax), %eax
  78              	.L6:
 435:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** }
  79              		.loc 2 435 1
  80 0038 488B55F8 		movq	-8(%rbp), %rdx
  81 003c 64483314 		xorq	%fs:40, %rdx
  81      25280000 
  81      00
  82 0045 7405     		je	.L7
  83 0047 E8000000 		call	__stack_chk_fail@PLT
  83      00
  84              	.L7:
  85 004c C9       		leave
  86              	.LCFI5:
  87              		.cfi_def_cfa 7, 8
  88 004d C3       		ret
  89              		.cfi_endproc
  90              	.LFE9:
  92              		.section	.text.mbedtls_cipher_get_cipher_mode,"ax",@progbits
  94              	mbedtls_cipher_get_cipher_mode:
  95              	.LFB10:
 436:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 437:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** /**
 438:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \brief        This function returns the mode of operation for
 439:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *               the cipher. For example, MBEDTLS_MODE_CBC.
 440:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
 441:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \param ctx    The context of the cipher. This must be initialized.
 442:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  *
 443:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \return       The mode of operation.
 444:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  * \return       #MBEDTLS_MODE_NONE if \p ctx has not been initialized.
 445:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****  */
 446:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** static inline mbedtls_cipher_mode_t mbedtls_cipher_get_cipher_mode(
 447:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     const mbedtls_cipher_context_t *ctx )
 448:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** {
  96              		.loc 2 448 1
  97              		.cfi_startproc
  98 0000 55       		pushq	%rbp
  99              	.LCFI6:
 100              		.cfi_def_cfa_offset 16
 101              		.cfi_offset 6, -16
 102 0001 4889E5   		movq	%rsp, %rbp
 103              	.LCFI7:
 104              		.cfi_def_cfa_register 6
 105 0004 4883EC20 		subq	$32, %rsp
 106 0008 48897DE8 		movq	%rdi, -24(%rbp)
 107              		.loc 2 448 1
 108 000c 64488B04 		movq	%fs:40, %rax
 108      25280000 
 108      00
 109 0015 488945F8 		movq	%rax, -8(%rbp)
 110 0019 31C0     		xorl	%eax, %eax
 449:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     MBEDTLS_INTERNAL_VALIDATE_RET( ctx != NULL, MBEDTLS_MODE_NONE );
 450:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     if( ctx->cipher_info == NULL )
GAS LISTING /tmp/ccEn8xFO.s 			page 14


 111              		.loc 2 450 12
 112 001b 488B45E8 		movq	-24(%rbp), %rax
 113 001f 488B00   		movq	(%rax), %rax
 114              		.loc 2 450 7
 115 0022 4885C0   		testq	%rax, %rax
 116 0025 7507     		jne	.L9
 451:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****         return MBEDTLS_MODE_NONE;
 117              		.loc 2 451 16
 118 0027 B8000000 		movl	$0, %eax
 118      00
 119 002c EB0A     		jmp	.L10
 120              	.L9:
 452:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** 
 453:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h ****     return ctx->cipher_info->mode;
 121              		.loc 2 453 15
 122 002e 488B45E8 		movq	-24(%rbp), %rax
 123 0032 488B00   		movq	(%rax), %rax
 124              		.loc 2 453 28
 125 0035 8B4004   		movl	4(%rax), %eax
 126              	.L10:
 454:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h **** }
 127              		.loc 2 454 1
 128 0038 488B55F8 		movq	-8(%rbp), %rdx
 129 003c 64483314 		xorq	%fs:40, %rdx
 129      25280000 
 129      00
 130 0045 7405     		je	.L11
 131 0047 E8000000 		call	__stack_chk_fail@PLT
 131      00
 132              	.L11:
 133 004c C9       		leave
 134              	.LCFI8:
 135              		.cfi_def_cfa 7, 8
 136 004d C3       		ret
 137              		.cfi_endproc
 138              	.LFE10:
 140              		.section	.text.mbedtls_ssl_sig_hash_set_init,"ax",@progbits
 142              	mbedtls_ssl_sig_hash_set_init:
 143              	.LFB21:
 144              		.file 3 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_inter
   1:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /**
   2:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \file ssl_internal.h
   3:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
   4:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \brief Internal functions shared by the SSL modules
   5:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
   6:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /*
   7:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  Copyright (C) 2006-2015, ARM Limited, All Rights Reserved
   8:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  SPDX-License-Identifier: Apache-2.0
   9:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
  10:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  Licensed under the Apache License, Version 2.0 (the "License"); you may
  11:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  not use this file except in compliance with the License.
  12:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  You may obtain a copy of the License at
  13:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
  14:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  http://www.apache.org/licenses/LICENSE-2.0
  15:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
  16:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  Unless required by applicable law or agreed to in writing, software
  17:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
GAS LISTING /tmp/ccEn8xFO.s 			page 15


  18:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  19:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  See the License for the specific language governing permissions and
  20:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  limitations under the License.
  21:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
  22:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  This file is part of mbed TLS (https://tls.mbed.org)
  23:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
  24:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #ifndef MBEDTLS_SSL_INTERNAL_H
  25:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_INTERNAL_H
  26:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  27:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if !defined(MBEDTLS_CONFIG_FILE)
  28:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #include "config.h"
  29:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
  30:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #include MBEDTLS_CONFIG_FILE
  31:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
  32:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  33:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #include "ssl.h"
  34:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #include "cipher.h"
  35:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  36:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_MD5_C)
  37:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #include "md5.h"
  38:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
  39:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  40:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SHA1_C)
  41:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #include "sha1.h"
  42:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
  43:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  44:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SHA256_C)
  45:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #include "sha256.h"
  46:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
  47:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  48:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SHA512_C)
  49:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #include "sha512.h"
  50:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
  51:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  52:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
  53:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #include "ecjpake.h"
  54:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
  55:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  56:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if ( defined(__ARMCC_VERSION) || defined(_MSC_VER) ) && \
  57:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     !defined(inline) && !defined(__cplusplus)
  58:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define inline __inline
  59:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
  60:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  61:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Determine minimum supported version */
  62:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MIN_MAJOR_VERSION           MBEDTLS_SSL_MAJOR_VERSION_3
  63:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  64:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
  65:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MIN_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_0
  66:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
  67:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1)
  68:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MIN_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_1
  69:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
  70:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_1)
  71:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MIN_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_2
  72:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
  73:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
  74:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MIN_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_3
GAS LISTING /tmp/ccEn8xFO.s 			page 16


  75:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
  76:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1_1 */
  77:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1   */
  78:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_SSL3   */
  79:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  80:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MIN_VALID_MINOR_VERSION MBEDTLS_SSL_MINOR_VERSION_1
  81:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MIN_VALID_MAJOR_VERSION MBEDTLS_SSL_MAJOR_VERSION_3
  82:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  83:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Determine maximum supported version */
  84:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MAX_MAJOR_VERSION           MBEDTLS_SSL_MAJOR_VERSION_3
  85:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  86:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
  87:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MAX_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_3
  88:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
  89:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_1)
  90:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MAX_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_2
  91:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
  92:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1)
  93:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MAX_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_1
  94:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
  95:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
  96:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MAX_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_0
  97:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_SSL3   */
  98:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1   */
  99:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1_1 */
 100:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
 101:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 102:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Shorthand for restartable ECC */
 103:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_ECP_RESTARTABLE) && \
 104:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     defined(MBEDTLS_SSL_CLI_C) && \
 105:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     defined(MBEDTLS_SSL_PROTO_TLS1_2) && \
 106:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     defined(MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED)
 107:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL__ECP_RESTARTABLE
 108:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 109:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 110:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_INITIAL_HANDSHAKE           0
 111:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_RENEGOTIATION_IN_PROGRESS   1   /* In progress */
 112:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_RENEGOTIATION_DONE          2   /* Done or aborted */
 113:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_RENEGOTIATION_PENDING       3   /* Requested (server only) */
 114:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 115:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /*
 116:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * DTLS retransmission states, see RFC 6347 4.2.4
 117:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 118:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * The SENDING state is merged in PREPARING for initial sends,
 119:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * but is distinct for resends.
 120:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 121:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * Note: initial state is wrong for server, but is not used anyway.
 122:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_RETRANS_PREPARING       0
 124:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_RETRANS_SENDING         1
 125:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_RETRANS_WAITING         2
 126:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_RETRANS_FINISHED        3
 127:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 128:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /*
 129:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * Allow extra bytes for record, authentication and encryption overhead:
 130:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * counter (8) + header (5) + IV(16) + MAC (16-48) + padding (0-256)
 131:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * and allow for a maximum of 1024 of compression expansion if
GAS LISTING /tmp/ccEn8xFO.s 			page 17


 132:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * enabled.
 133:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 134:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_ZLIB_SUPPORT)
 135:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_COMPRESSION_ADD          1024
 136:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
 137:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_COMPRESSION_ADD             0
 138:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 139:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 140:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_ARC4_C) || defined(MBEDTLS_CIPHER_MODE_CBC)
 141:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Ciphersuites using HMAC */
 142:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SHA512_C)
 143:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MAC_ADD                 48  /* SHA-384 used for HMAC */
 144:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #elif defined(MBEDTLS_SHA256_C)
 145:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MAC_ADD                 32  /* SHA-256 used for HMAC */
 146:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
 147:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MAC_ADD                 20  /* SHA-1   used for HMAC */
 148:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 149:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
 150:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* AEAD ciphersuites: GCM and CCM use a 128 bits tag */
 151:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MAC_ADD                 16
 152:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 153:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 154:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_CIPHER_MODE_CBC)
 155:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_PADDING_ADD            256
 156:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
 157:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_PADDING_ADD              0
 158:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 159:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 160:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_PAYLOAD_OVERHEAD ( MBEDTLS_SSL_COMPRESSION_ADD +    \
 161:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                        MBEDTLS_MAX_IV_LENGTH +          \
 162:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                        MBEDTLS_SSL_MAC_ADD +            \
 163:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                        MBEDTLS_SSL_PADDING_ADD          \
 164:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                        )
 165:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 166:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_IN_PAYLOAD_LEN ( MBEDTLS_SSL_PAYLOAD_OVERHEAD + \
 167:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                      ( MBEDTLS_SSL_IN_CONTENT_LEN ) )
 168:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 169:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_OUT_PAYLOAD_LEN ( MBEDTLS_SSL_PAYLOAD_OVERHEAD + \
 170:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                       ( MBEDTLS_SSL_OUT_CONTENT_LEN ) )
 171:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 172:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* The maximum number of buffered handshake messages. */
 173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MAX_BUFFERED_HS 4
 174:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 175:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Maximum length we can advertise as our max content length for
 176:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****    RFC 6066 max_fragment_length extension negotiation purposes
 177:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****    (the lesser of both sizes, if they are unequal.)
 178:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 179:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_TLS_EXT_ADV_CONTENT_LEN (                            \
 180:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         (MBEDTLS_SSL_IN_CONTENT_LEN > MBEDTLS_SSL_OUT_CONTENT_LEN)   \
 181:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         ? ( MBEDTLS_SSL_OUT_CONTENT_LEN )                            \
 182:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         : ( MBEDTLS_SSL_IN_CONTENT_LEN )                             \
 183:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         )
 184:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 185:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /*
 186:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * Check that we obey the standard's message size bounds
 187:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 188:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 18


 189:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if MBEDTLS_SSL_MAX_CONTENT_LEN > 16384
 190:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #error "Bad configuration - record content too large."
 191:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 192:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 193:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if MBEDTLS_SSL_IN_CONTENT_LEN > MBEDTLS_SSL_MAX_CONTENT_LEN
 194:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #error "Bad configuration - incoming record content should not be larger than MBEDTLS_SSL_MAX_CONTE
 195:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 196:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 197:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if MBEDTLS_SSL_OUT_CONTENT_LEN > MBEDTLS_SSL_MAX_CONTENT_LEN
 198:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #error "Bad configuration - outgoing record content should not be larger than MBEDTLS_SSL_MAX_CONTE
 199:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 201:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if MBEDTLS_SSL_IN_PAYLOAD_LEN > MBEDTLS_SSL_MAX_CONTENT_LEN + 2048
 202:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #error "Bad configuration - incoming protected record payload too large."
 203:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 204:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 205:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if MBEDTLS_SSL_OUT_PAYLOAD_LEN > MBEDTLS_SSL_MAX_CONTENT_LEN + 2048
 206:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #error "Bad configuration - outgoing protected record payload too large."
 207:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 208:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 209:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Calculate buffer sizes */
 210:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 211:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Note: Even though the TLS record header is only 5 bytes
 212:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****    long, we're internally using 8 bytes to store the
 213:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****    implicit sequence number. */
 214:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_HEADER_LEN 13
 215:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 216:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_IN_BUFFER_LEN  \
 217:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     ( ( MBEDTLS_SSL_HEADER_LEN ) + ( MBEDTLS_SSL_IN_PAYLOAD_LEN ) )
 218:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 219:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_OUT_BUFFER_LEN  \
 220:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     ( ( MBEDTLS_SSL_HEADER_LEN ) + ( MBEDTLS_SSL_OUT_PAYLOAD_LEN ) )
 221:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 222:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #ifdef MBEDTLS_ZLIB_SUPPORT
 223:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Compression buffer holds both IN and OUT buffers, so should be size of the larger */
 224:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_COMPRESS_BUFFER_LEN (                               \
 225:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         ( MBEDTLS_SSL_IN_BUFFER_LEN > MBEDTLS_SSL_OUT_BUFFER_LEN )      \
 226:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         ? MBEDTLS_SSL_IN_BUFFER_LEN                                     \
 227:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         : MBEDTLS_SSL_OUT_BUFFER_LEN                                    \
 228:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         )
 229:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 230:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 231:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /*
 232:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * TLS extension flags (for extensions with outgoing ServerHello content
 233:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * that need it (e.g. for RENEGOTIATION_INFO the server already knows because
 234:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * of state of the renegotiation flag, so no indicator is required)
 235:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 236:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_TLS_EXT_SUPPORTED_POINT_FORMATS_PRESENT (1 << 0)
 237:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_TLS_EXT_ECJPAKE_KKPP_OK                 (1 << 1)
 238:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 239:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #ifdef __cplusplus
 240:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** extern "C" {
 241:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 242:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 243:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2) && \
 244:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
 245:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /*
GAS LISTING /tmp/ccEn8xFO.s 			page 19


 246:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * Abstraction for a grid of allowed signature-hash-algorithm pairs.
 247:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 248:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** struct mbedtls_ssl_sig_hash_set_t
 249:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** {
 250:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     /* At the moment, we only need to remember a single suitable
 251:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * hash algorithm per signature algorithm. As long as that's
 252:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * the case - and we don't need a general lookup function -
 253:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * we can implement the sig-hash-set as a map from signatures
 254:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * to hash algorithms. */
 255:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_md_type_t rsa;
 256:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_md_type_t ecdsa;
 257:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** };
 258:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 &&
 259:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****           MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED */
 260:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 261:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /*
 262:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * This structure contains the parameters only needed during handshake.
 263:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 264:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** struct mbedtls_ssl_handshake_params
 265:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** {
 266:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     /*
 267:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * Handshake specific crypto variables
 268:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      */
 269:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 270:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2) && \
 271:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
 272:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ssl_sig_hash_set_t hash_algs;             /*!<  Set of suitable sig-hash pairs */
 273:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 274:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_DHM_C)
 275:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_dhm_context dhm_ctx;                /*!<  DHM key exchange        */
 276:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 277:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_ECDH_C)
 278:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ecdh_context ecdh_ctx;              /*!<  ECDH key exchange       */
 279:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 280:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
 281:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ecjpake_context ecjpake_ctx;        /*!< EC J-PAKE key exchange */
 282:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_CLI_C)
 283:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char *ecjpake_cache;               /*!< Cache for ClientHello ext */
 284:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     size_t ecjpake_cache_len;                   /*!< Length of cached data */
 285:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 286:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED */
 287:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_ECDH_C) || defined(MBEDTLS_ECDSA_C) || \
 288:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
 289:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     const mbedtls_ecp_curve_info **curves;      /*!<  Supported elliptic curves */
 290:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 291:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED)
 292:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char *psk;                 /*!<  PSK from the callback         */
 293:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     size_t psk_len;                     /*!<  Length of PSK from callback   */
 294:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 295:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
 296:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ssl_key_cert *key_cert;     /*!< chosen key/cert pair (server)  */
 297:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_SERVER_NAME_INDICATION)
 298:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     int sni_authmode;                   /*!< authmode from SNI callback     */
 299:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ssl_key_cert *sni_key_cert; /*!< key/cert list from SNI         */
 300:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_x509_crt *sni_ca_chain;     /*!< trusted CAs from SNI callback  */
 301:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_x509_crl *sni_ca_crl;       /*!< trusted CAs CRLs from SNI      */
 302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_SERVER_NAME_INDICATION */
GAS LISTING /tmp/ccEn8xFO.s 			page 20


 303:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
 304:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL__ECP_RESTARTABLE)
 305:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     int ecrs_enabled;                   /*!< Handshake supports EC restart? */
 306:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_x509_crt_restart_ctx ecrs_ctx;  /*!< restart context            */
 307:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     enum { /* this complements ssl->state with info on intra-state operations */
 308:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         ssl_ecrs_none = 0,              /*!< nothing going on (yet)         */
 309:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         ssl_ecrs_crt_verify,            /*!< Certificate: crt_verify()      */
 310:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         ssl_ecrs_ske_start_processing,  /*!< ServerKeyExchange: pk_verify() */
 311:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         ssl_ecrs_cke_ecdh_calc_secret,  /*!< ClientKeyExchange: ECDH step 2 */
 312:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         ssl_ecrs_crt_vrfy_sign,         /*!< CertificateVerify: pk_sign()   */
 313:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     } ecrs_state;                       /*!< current (or last) operation    */
 314:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     size_t ecrs_n;                      /*!< place for saving a length      */
 315:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 316:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 317:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned int out_msg_seq;           /*!<  Outgoing handshake sequence number */
 318:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned int in_msg_seq;            /*!<  Incoming handshake sequence number */
 319:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 320:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char *verify_cookie;       /*!<  Cli: HelloVerifyRequest cookie
 321:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                               Srv: unused                    */
 322:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char verify_cookie_len;    /*!<  Cli: cookie length
 323:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                               Srv: flag for sending a cookie */
 324:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 325:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     uint32_t retransmit_timeout;        /*!<  Current value of timeout       */
 326:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char retransmit_state;     /*!<  Retransmission state           */
 327:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ssl_flight_item *flight;    /*!<  Current outgoing flight        */
 328:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ssl_flight_item *cur_msg;   /*!<  Current message in flight      */
 329:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char *cur_msg_p;           /*!<  Position in current message    */
 330:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned int in_flight_start_seq;   /*!<  Minimum message sequence in the
 331:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                               flight being received          */
 332:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ssl_transform *alt_transform_out;   /*!<  Alternative transform for
 333:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                               resending messages             */
 334:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char alt_out_ctr[8];       /*!<  Alternative record epoch/counter
 335:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                               for resending messages         */
 336:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 337:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     struct
 338:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     {
 339:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         size_t total_bytes_buffered; /*!< Cumulative size of heap allocated
 340:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                       *   buffers used for message buffering. */
 341:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 342:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         uint8_t seen_ccs;               /*!< Indicates if a CCS message has
 343:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                          *   been seen in the current flight. */
 344:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 345:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         struct mbedtls_ssl_hs_buffer
 346:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         {
 347:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****             unsigned is_valid      : 1;
 348:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****             unsigned is_fragmented : 1;
 349:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****             unsigned is_complete   : 1;
 350:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****             unsigned char *data;
 351:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****             size_t data_len;
 352:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         } hs[MBEDTLS_SSL_MAX_BUFFERED_HS];
 353:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 354:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         struct
 355:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         {
 356:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****             unsigned char *data;
 357:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****             size_t len;
 358:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****             unsigned epoch;
 359:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         } future_record;
GAS LISTING /tmp/ccEn8xFO.s 			page 21


 360:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 361:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     } buffering;
 362:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 363:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     uint16_t mtu;                       /*!<  Handshake mtu, used to fragment outgoing messages */
 364:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
 365:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 366:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     /*
 367:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * Checksum contexts
 368:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      */
 369:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1) || \
 370:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     defined(MBEDTLS_SSL_PROTO_TLS1_1)
 371:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****        mbedtls_md5_context fin_md5;
 372:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****       mbedtls_sha1_context fin_sha1;
 373:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 374:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
 375:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SHA256_C)
 376:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_sha256_context fin_sha256;
 377:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 378:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SHA512_C)
 379:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_sha512_context fin_sha512;
 380:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 381:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
 382:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 383:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     void (*update_checksum)(mbedtls_ssl_context *, const unsigned char *, size_t);
 384:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     void (*calc_verify)(mbedtls_ssl_context *, unsigned char *);
 385:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     void (*calc_finished)(mbedtls_ssl_context *, unsigned char *, int);
 386:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     int  (*tls_prf)(const unsigned char *, size_t, const char *,
 387:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                     const unsigned char *, size_t,
 388:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                     unsigned char *, size_t);
 389:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 390:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     size_t pmslen;                      /*!<  premaster length        */
 391:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 392:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char randbytes[64];        /*!<  random bytes            */
 393:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char premaster[MBEDTLS_PREMASTER_SIZE];
 394:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                         /*!<  premaster secret        */
 395:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 396:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     int resume;                         /*!<  session resume indicator*/
 397:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     int max_major_ver;                  /*!< max. major version client*/
 398:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     int max_minor_ver;                  /*!< max. minor version client*/
 399:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     int cli_exts;                       /*!< client extension presence*/
 400:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 401:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_SESSION_TICKETS)
 402:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     int new_session_ticket;             /*!< use NewSessionTicket?    */
 403:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_SESSION_TICKETS */
 404:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_EXTENDED_MASTER_SECRET)
 405:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     int extended_ms;                    /*!< use Extended Master Secret? */
 406:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 407:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 408:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_ASYNC_PRIVATE)
 409:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned int async_in_progress : 1; /*!< an asynchronous operation is in progress */
 410:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_ASYNC_PRIVATE */
 411:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 412:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_ASYNC_PRIVATE)
 413:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     /** Asynchronous operation context. This field is meant for use by the
 414:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * asynchronous operation callbacks (mbedtls_ssl_config::f_async_sign_start,
 415:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * mbedtls_ssl_config::f_async_decrypt_start,
 416:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * mbedtls_ssl_config::f_async_resume, mbedtls_ssl_config::f_async_cancel).
GAS LISTING /tmp/ccEn8xFO.s 			page 22


 417:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * The library does not use it internally. */
 418:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     void *user_async_ctx;
 419:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_ASYNC_PRIVATE */
 420:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** };
 421:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 422:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** typedef struct mbedtls_ssl_hs_buffer mbedtls_ssl_hs_buffer;
 423:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 424:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /*
 425:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * This structure contains a full set of runtime transform parameters
 426:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * either in negotiation or active.
 427:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 428:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** struct mbedtls_ssl_transform
 429:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** {
 430:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     /*
 431:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * Session specific crypto layer
 432:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      */
 433:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     const mbedtls_ssl_ciphersuite_t *ciphersuite_info;
 434:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                         /*!<  Chosen cipersuite_info  */
 435:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned int keylen;                /*!<  symmetric key length (bytes)  */
 436:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     size_t minlen;                      /*!<  min. ciphertext length  */
 437:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     size_t ivlen;                       /*!<  IV length               */
 438:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     size_t fixed_ivlen;                 /*!<  Fixed part of IV (AEAD) */
 439:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     size_t maclen;                      /*!<  MAC length              */
 440:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 441:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char iv_enc[16];           /*!<  IV (encryption)         */
 442:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char iv_dec[16];           /*!<  IV (decryption)         */
 443:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 444:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
 445:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     /* Needed only for SSL v3.0 secret */
 446:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char mac_enc[20];          /*!<  SSL v3.0 secret (enc)   */
 447:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char mac_dec[20];          /*!<  SSL v3.0 secret (dec)   */
 448:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_SSL3 */
 449:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 450:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_md_context_t md_ctx_enc;            /*!<  MAC (encryption)        */
 451:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_md_context_t md_ctx_dec;            /*!<  MAC (decryption)        */
 452:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 453:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_cipher_context_t cipher_ctx_enc;    /*!<  encryption context      */
 454:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_cipher_context_t cipher_ctx_dec;    /*!<  decryption context      */
 455:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 456:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     /*
 457:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * Session specific compression layer
 458:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      */
 459:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_ZLIB_SUPPORT)
 460:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     z_stream ctx_deflate;               /*!<  compression context     */
 461:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     z_stream ctx_inflate;               /*!<  decompression context   */
 462:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 463:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** };
 464:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 465:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
 466:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /*
 467:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * List of certificate + private key pairs
 468:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 469:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** struct mbedtls_ssl_key_cert
 470:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** {
 471:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_x509_crt *cert;                 /*!< cert                       */
 472:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_pk_context *key;                /*!< private key                */
 473:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ssl_key_cert *next;             /*!< next key/cert pair         */
GAS LISTING /tmp/ccEn8xFO.s 			page 23


 474:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** };
 475:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
 476:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 477:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 478:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /*
 479:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * List of handshake messages kept around for resending
 480:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 481:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** struct mbedtls_ssl_flight_item
 482:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** {
 483:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char *p;       /*!< message, including handshake headers   */
 484:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     size_t len;             /*!< length of p                            */
 485:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char type;     /*!< type of the message: handshake or CCS  */
 486:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ssl_flight_item *next;  /*!< next handshake message(s)              */
 487:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** };
 488:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
 489:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 490:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2) && \
 491:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
 492:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 493:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Find an entry in a signature-hash set matching a given hash algorithm. */
 494:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** mbedtls_md_type_t mbedtls_ssl_sig_hash_set_find( mbedtls_ssl_sig_hash_set_t *set,
 495:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                                  mbedtls_pk_type_t sig_alg );
 496:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Add a signature-hash-pair to a signature-hash set */
 497:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_sig_hash_set_add( mbedtls_ssl_sig_hash_set_t *set,
 498:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                    mbedtls_pk_type_t sig_alg,
 499:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                    mbedtls_md_type_t md_alg );
 500:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Allow exactly one hash algorithm for each signature. */
 501:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_sig_hash_set_const_hash( mbedtls_ssl_sig_hash_set_t *set,
 502:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                           mbedtls_md_type_t md_alg );
 503:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 504:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Setup an empty signature-hash set */
 505:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** static inline void mbedtls_ssl_sig_hash_set_init( mbedtls_ssl_sig_hash_set_t *set )
 506:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** {
 145              		.loc 3 506 1
 146              		.cfi_startproc
 147 0000 55       		pushq	%rbp
 148              	.LCFI9:
 149              		.cfi_def_cfa_offset 16
 150              		.cfi_offset 6, -16
 151 0001 4889E5   		movq	%rsp, %rbp
 152              	.LCFI10:
 153              		.cfi_def_cfa_register 6
 154 0004 4883EC20 		subq	$32, %rsp
 155 0008 48897DE8 		movq	%rdi, -24(%rbp)
 156              		.loc 3 506 1
 157 000c 64488B04 		movq	%fs:40, %rax
 157      25280000 
 157      00
 158 0015 488945F8 		movq	%rax, -8(%rbp)
 159 0019 31C0     		xorl	%eax, %eax
 507:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ssl_sig_hash_set_const_hash( set, MBEDTLS_MD_NONE );
 160              		.loc 3 507 5
 161 001b 488B45E8 		movq	-24(%rbp), %rax
 162 001f BE000000 		movl	$0, %esi
 162      00
 163 0024 4889C7   		movq	%rax, %rdi
 164 0027 E8000000 		call	mbedtls_ssl_sig_hash_set_const_hash
GAS LISTING /tmp/ccEn8xFO.s 			page 24


 164      00
 508:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** }
 165              		.loc 3 508 1
 166 002c 90       		nop
 167 002d 488B45F8 		movq	-8(%rbp), %rax
 168 0031 64483304 		xorq	%fs:40, %rax
 168      25280000 
 168      00
 169 003a 7405     		je	.L13
 170 003c E8000000 		call	__stack_chk_fail@PLT
 170      00
 171              	.L13:
 172 0041 C9       		leave
 173              	.LCFI11:
 174              		.cfi_def_cfa 7, 8
 175 0042 C3       		ret
 176              		.cfi_endproc
 177              	.LFE21:
 179              		.section	.text.mbedtls_ssl_own_cert,"ax",@progbits
 181              	mbedtls_ssl_own_cert:
 182              	.LFB23:
 509:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 510:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2) &&
 511:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****           MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED */
 512:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 513:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /**
 514:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \brief           Free referenced items in an SSL transform context and clear
 515:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                  memory
 516:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 517:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \param transform SSL transform context
 518:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 519:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_transform_free( mbedtls_ssl_transform *transform );
 520:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 521:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /**
 522:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \brief           Free referenced items in an SSL handshake context and clear
 523:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                  memory
 524:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 525:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \param ssl       SSL context
 526:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 527:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_handshake_free( mbedtls_ssl_context *ssl );
 528:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 529:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_handshake_client_step( mbedtls_ssl_context *ssl );
 530:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_handshake_server_step( mbedtls_ssl_context *ssl );
 531:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_handshake_wrapup( mbedtls_ssl_context *ssl );
 532:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 533:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_send_fatal_handshake_failure( mbedtls_ssl_context *ssl );
 534:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 535:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_reset_checksum( mbedtls_ssl_context *ssl );
 536:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_derive_keys( mbedtls_ssl_context *ssl );
 537:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 538:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_handle_message_type( mbedtls_ssl_context *ssl );
 539:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_prepare_handshake_record( mbedtls_ssl_context *ssl );
 540:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_update_handshake_status( mbedtls_ssl_context *ssl );
 541:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 542:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /**
 543:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \brief       Update record layer
 544:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
GAS LISTING /tmp/ccEn8xFO.s 			page 25


 545:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              This function roughly separates the implementation
 546:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              of the logic of (D)TLS from the implementation
 547:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              of the secure transport.
 548:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 549:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \param  ssl              The SSL context to use.
 550:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \param  update_hs_digest This indicates if the handshake digest
 551:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                          should be automatically updated in case
 552:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                          a handshake message is found.
 553:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 554:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \return      0 or non-zero error code.
 555:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 556:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \note        A clarification on what is called 'record layer' here
 557:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              is in order, as many sensible definitions are possible:
 558:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 559:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              The record layer takes as input an untrusted underlying
 560:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              transport (stream or datagram) and transforms it into
 561:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              a serially multiplexed, secure transport, which
 562:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              conceptually provides the following:
 563:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 564:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              (1) Three datagram based, content-agnostic transports
 565:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                  for handshake, alert and CCS messages.
 566:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              (2) One stream- or datagram-based transport
 567:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                  for application data.
 568:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              (3) Functionality for changing the underlying transform
 569:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                  securing the contents.
 570:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 571:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              The interface to this functionality is given as follows:
 572:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 573:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              a Updating
 574:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                [Currently implemented by mbedtls_ssl_read_record]
 575:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 576:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                Check if and on which of the four 'ports' data is pending:
 577:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                Nothing, a controlling datagram of type (1), or application
 578:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                data (2). In any case data is present, internal buffers
 579:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                provide access to the data for the user to process it.
 580:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                Consumption of type (1) datagrams is done automatically
 581:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                on the next update, invalidating that the internal buffers
 582:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                for previous datagrams, while consumption of application
 583:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                data (2) is user-controlled.
 584:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 585:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              b Reading of application data
 586:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                [Currently manual adaption of ssl->in_offt pointer]
 587:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 588:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                As mentioned in the last paragraph, consumption of data
 589:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                is different from the automatic consumption of control
 590:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                datagrams (1) because application data is treated as a stream.
 591:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 592:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              c Tracking availability of application data
 593:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                [Currently manually through decreasing ssl->in_msglen]
 594:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 595:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                For efficiency and to retain datagram semantics for
 596:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                application data in case of DTLS, the record layer
 597:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                provides functionality for checking how much application
 598:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                data is still available in the internal buffer.
 599:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 600:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              d Changing the transformation securing the communication.
 601:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
GAS LISTING /tmp/ccEn8xFO.s 			page 26


 602:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              Given an opaque implementation of the record layer in the
 603:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              above sense, it should be possible to implement the logic
 604:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              of (D)TLS on top of it without the need to know anything
 605:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              about the record layer's internals. This is done e.g.
 606:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              in all the handshake handling functions, and in the
 607:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              application data reading function mbedtls_ssl_read.
 608:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 609:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \note        The above tries to give a conceptual picture of the
 610:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              record layer, but the current implementation deviates
 611:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              from it in some places. For example, our implementation of
 612:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              the update functionality through mbedtls_ssl_read_record
 613:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              discards datagrams depending on the current state, which
 614:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              wouldn't fall under the record layer's responsibility
 615:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              following the above definition.
 616:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 617:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 618:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_read_record( mbedtls_ssl_context *ssl,
 619:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                              unsigned update_hs_digest );
 620:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_fetch_input( mbedtls_ssl_context *ssl, size_t nb_want );
 621:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 622:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_write_handshake_msg( mbedtls_ssl_context *ssl );
 623:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_write_record( mbedtls_ssl_context *ssl, uint8_t force_flush );
 624:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_flush_output( mbedtls_ssl_context *ssl );
 625:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 626:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_parse_certificate( mbedtls_ssl_context *ssl );
 627:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_write_certificate( mbedtls_ssl_context *ssl );
 628:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 629:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_parse_change_cipher_spec( mbedtls_ssl_context *ssl );
 630:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_write_change_cipher_spec( mbedtls_ssl_context *ssl );
 631:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 632:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_parse_finished( mbedtls_ssl_context *ssl );
 633:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_write_finished( mbedtls_ssl_context *ssl );
 634:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 635:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_optimize_checksum( mbedtls_ssl_context *ssl,
 636:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                             const mbedtls_ssl_ciphersuite_t *ciphersuite_info );
 637:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 638:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED)
 639:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_psk_derive_premaster( mbedtls_ssl_context *ssl, mbedtls_key_exchange_type_t key_ex 
 640:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 641:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 642:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_PK_C)
 643:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** unsigned char mbedtls_ssl_sig_from_pk( mbedtls_pk_context *pk );
 644:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** unsigned char mbedtls_ssl_sig_from_pk_alg( mbedtls_pk_type_t type );
 645:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** mbedtls_pk_type_t mbedtls_ssl_pk_alg_from_sig( unsigned char sig );
 646:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 647:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 648:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** mbedtls_md_type_t mbedtls_ssl_md_alg_from_hash( unsigned char hash );
 649:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** unsigned char mbedtls_ssl_hash_from_md_alg( int md );
 650:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_set_calc_verify_md( mbedtls_ssl_context *ssl, int md );
 651:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 652:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_ECP_C)
 653:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_check_curve( const mbedtls_ssl_context *ssl, mbedtls_ecp_group_id grp_id );
 654:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 655:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 656:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
 657:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_check_sig_hash( const mbedtls_ssl_context *ssl,
 658:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                 mbedtls_md_type_t md );
GAS LISTING /tmp/ccEn8xFO.s 			page 27


 659:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 660:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 661:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
 662:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** static inline mbedtls_pk_context *mbedtls_ssl_own_key( mbedtls_ssl_context *ssl )
 663:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** {
 664:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ssl_key_cert *key_cert;
 665:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 666:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     if( ssl->handshake != NULL && ssl->handshake->key_cert != NULL )
 667:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         key_cert = ssl->handshake->key_cert;
 668:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     else
 669:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         key_cert = ssl->conf->key_cert;
 670:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 671:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     return( key_cert == NULL ? NULL : key_cert->key );
 672:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** }
 673:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 674:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** static inline mbedtls_x509_crt *mbedtls_ssl_own_cert( mbedtls_ssl_context *ssl )
 675:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** {
 183              		.loc 3 675 1
 184              		.cfi_startproc
 185 0000 55       		pushq	%rbp
 186              	.LCFI12:
 187              		.cfi_def_cfa_offset 16
 188              		.cfi_offset 6, -16
 189 0001 4889E5   		movq	%rsp, %rbp
 190              	.LCFI13:
 191              		.cfi_def_cfa_register 6
 192 0004 4883EC20 		subq	$32, %rsp
 193 0008 48897DE8 		movq	%rdi, -24(%rbp)
 194              		.loc 3 675 1
 195 000c 64488B04 		movq	%fs:40, %rax
 195      25280000 
 195      00
 196 0015 488945F8 		movq	%rax, -8(%rbp)
 197 0019 31C0     		xorl	%eax, %eax
 676:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ssl_key_cert *key_cert;
 677:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 678:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     if( ssl->handshake != NULL && ssl->handshake->key_cert != NULL )
 198              		.loc 3 678 12
 199 001b 488B45E8 		movq	-24(%rbp), %rax
 200 001f 488B4060 		movq	96(%rax), %rax
 201              		.loc 3 678 7
 202 0023 4885C0   		testq	%rax, %rax
 203 0026 7429     		je	.L15
 204              		.loc 3 678 38 discriminator 1
 205 0028 488B45E8 		movq	-24(%rbp), %rax
 206 002c 488B4060 		movq	96(%rax), %rax
 207              		.loc 3 678 49 discriminator 1
 208 0030 488B8078 		movq	632(%rax), %rax
 208      020000
 209              		.loc 3 678 32 discriminator 1
 210 0037 4885C0   		testq	%rax, %rax
 211 003a 7415     		je	.L15
 679:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         key_cert = ssl->handshake->key_cert;
 212              		.loc 3 679 23
 213 003c 488B45E8 		movq	-24(%rbp), %rax
 214 0040 488B4060 		movq	96(%rax), %rax
 215              		.loc 3 679 18
GAS LISTING /tmp/ccEn8xFO.s 			page 28


 216 0044 488B8078 		movq	632(%rax), %rax
 216      020000
 217 004b 488945F0 		movq	%rax, -16(%rbp)
 218 004f EB12     		jmp	.L16
 219              	.L15:
 680:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     else
 681:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         key_cert = ssl->conf->key_cert;
 220              		.loc 3 681 23
 221 0051 488B45E8 		movq	-24(%rbp), %rax
 222 0055 488B00   		movq	(%rax), %rax
 223              		.loc 3 681 18
 224 0058 488B8080 		movq	128(%rax), %rax
 224      000000
 225 005f 488945F0 		movq	%rax, -16(%rbp)
 226              	.L16:
 682:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 683:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     return( key_cert == NULL ? NULL : key_cert->cert );
 227              		.loc 3 683 37
 228 0063 48837DF0 		cmpq	$0, -16(%rbp)
 228      00
 229 0068 7409     		je	.L17
 230              		.loc 3 683 37 is_stmt 0 discriminator 1
 231 006a 488B45F0 		movq	-16(%rbp), %rax
 232 006e 488B00   		movq	(%rax), %rax
 233 0071 EB05     		jmp	.L19
 234              	.L17:
 235              		.loc 3 683 37 discriminator 2
 236 0073 B8000000 		movl	$0, %eax
 236      00
 237              	.L19:
 684:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** }
 238              		.loc 3 684 1 is_stmt 1 discriminator 5
 239 0078 488B55F8 		movq	-8(%rbp), %rdx
 240 007c 64483314 		xorq	%fs:40, %rdx
 240      25280000 
 240      00
 241 0085 7405     		je	.L20
 242              		.loc 3 684 1 is_stmt 0
 243 0087 E8000000 		call	__stack_chk_fail@PLT
 243      00
 244              	.L20:
 245 008c C9       		leave
 246              	.LCFI14:
 247              		.cfi_def_cfa 7, 8
 248 008d C3       		ret
 249              		.cfi_endproc
 250              	.LFE23:
 252              		.section	.text.mbedtls_ssl_hdr_len,"ax",@progbits
 254              	mbedtls_ssl_hdr_len:
 255              	.LFB24:
 685:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 686:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /*
 687:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * Check usage of a certificate wrt extensions:
 688:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * keyUsage, extendedKeyUsage (later), and nSCertType (later).
 689:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 690:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * Warning: cert_endpoint is the endpoint of the cert (ie, of our peer when we
 691:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * check a cert we received from them)!
GAS LISTING /tmp/ccEn8xFO.s 			page 29


 692:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 693:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * Return 0 if everything is OK, -1 if not.
 694:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 695:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_check_cert_usage( const mbedtls_x509_crt *cert,
 696:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                           const mbedtls_ssl_ciphersuite_t *ciphersuite,
 697:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                           int cert_endpoint,
 698:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                           uint32_t *flags );
 699:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
 700:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 701:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_write_version( int major, int minor, int transport,
 702:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                         unsigned char ver[2] );
 703:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_read_version( int *major, int *minor, int transport,
 704:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                        const unsigned char ver[2] );
 705:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 706:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** static inline size_t mbedtls_ssl_hdr_len( const mbedtls_ssl_context *ssl )
 707:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** {
 256              		.loc 3 707 1 is_stmt 1
 257              		.cfi_startproc
 258 0000 55       		pushq	%rbp
 259              	.LCFI15:
 260              		.cfi_def_cfa_offset 16
 261              		.cfi_offset 6, -16
 262 0001 4889E5   		movq	%rsp, %rbp
 263              	.LCFI16:
 264              		.cfi_def_cfa_register 6
 265 0004 4883EC20 		subq	$32, %rsp
 266 0008 48897DE8 		movq	%rdi, -24(%rbp)
 267              		.loc 3 707 1
 268 000c 64488B04 		movq	%fs:40, %rax
 268      25280000 
 268      00
 269 0015 488945F8 		movq	%rax, -8(%rbp)
 270 0019 31C0     		xorl	%eax, %eax
 708:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 709:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
 710:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         return( 13 );
 711:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
 712:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     ((void) ssl);
 713:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 714:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     return( 5 );
 271              		.loc 3 714 11
 272 001b B8050000 		movl	$5, %eax
 272      00
 715:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** }
 273              		.loc 3 715 1
 274 0020 488B55F8 		movq	-8(%rbp), %rdx
 275 0024 64483314 		xorq	%fs:40, %rdx
 275      25280000 
 275      00
 276 002d 7405     		je	.L23
 277 002f E8000000 		call	__stack_chk_fail@PLT
 277      00
 278              	.L23:
 279 0034 C9       		leave
 280              	.LCFI17:
 281              		.cfi_def_cfa 7, 8
 282 0035 C3       		ret
GAS LISTING /tmp/ccEn8xFO.s 			page 30


 283              		.cfi_endproc
 284              	.LFE24:
 286              		.section	.text.mbedtls_ssl_hs_hdr_len,"ax",@progbits
 288              	mbedtls_ssl_hs_hdr_len:
 289              	.LFB25:
 716:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 717:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** static inline size_t mbedtls_ssl_hs_hdr_len( const mbedtls_ssl_context *ssl )
 718:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** {
 290              		.loc 3 718 1
 291              		.cfi_startproc
 292 0000 55       		pushq	%rbp
 293              	.LCFI18:
 294              		.cfi_def_cfa_offset 16
 295              		.cfi_offset 6, -16
 296 0001 4889E5   		movq	%rsp, %rbp
 297              	.LCFI19:
 298              		.cfi_def_cfa_register 6
 299 0004 4883EC20 		subq	$32, %rsp
 300 0008 48897DE8 		movq	%rdi, -24(%rbp)
 301              		.loc 3 718 1
 302 000c 64488B04 		movq	%fs:40, %rax
 302      25280000 
 302      00
 303 0015 488945F8 		movq	%rax, -8(%rbp)
 304 0019 31C0     		xorl	%eax, %eax
 719:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 720:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
 721:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         return( 12 );
 722:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
 723:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     ((void) ssl);
 724:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 725:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     return( 4 );
 305              		.loc 3 725 11
 306 001b B8040000 		movl	$4, %eax
 306      00
 726:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** }
 307              		.loc 3 726 1
 308 0020 488B55F8 		movq	-8(%rbp), %rdx
 309 0024 64483314 		xorq	%fs:40, %rdx
 309      25280000 
 309      00
 310 002d 7405     		je	.L26
 311 002f E8000000 		call	__stack_chk_fail@PLT
 311      00
 312              	.L26:
 313 0034 C9       		leave
 314              	.LCFI20:
 315              		.cfi_def_cfa 7, 8
 316 0035 C3       		ret
 317              		.cfi_endproc
 318              	.LFE25:
 320              		.section	.text.mbedtls_ssl_safer_memcmp,"ax",@progbits
 322              	mbedtls_ssl_safer_memcmp:
 323              	.LFB26:
 727:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 728:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 729:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_send_flight_completed( mbedtls_ssl_context *ssl );
GAS LISTING /tmp/ccEn8xFO.s 			page 31


 730:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_recv_flight_completed( mbedtls_ssl_context *ssl );
 731:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_resend( mbedtls_ssl_context *ssl );
 732:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_flight_transmit( mbedtls_ssl_context *ssl );
 733:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 734:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 735:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Visible for testing purposes only */
 736:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_DTLS_ANTI_REPLAY)
 737:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_dtls_replay_check( mbedtls_ssl_context *ssl );
 738:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_dtls_replay_update( mbedtls_ssl_context *ssl );
 739:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 740:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 741:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* constant-time buffer comparison */
 742:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** static inline int mbedtls_ssl_safer_memcmp( const void *a, const void *b, size_t n )
 743:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** {
 324              		.loc 3 743 1
 325              		.cfi_startproc
 326 0000 55       		pushq	%rbp
 327              	.LCFI21:
 328              		.cfi_def_cfa_offset 16
 329              		.cfi_offset 6, -16
 330 0001 4889E5   		movq	%rsp, %rbp
 331              	.LCFI22:
 332              		.cfi_def_cfa_register 6
 333 0004 4883EC50 		subq	$80, %rsp
 334 0008 48897DC8 		movq	%rdi, -56(%rbp)
 335 000c 488975C0 		movq	%rsi, -64(%rbp)
 336 0010 488955B8 		movq	%rdx, -72(%rbp)
 337              		.loc 3 743 1
 338 0014 64488B04 		movq	%fs:40, %rax
 338      25280000 
 338      00
 339 001d 488945F8 		movq	%rax, -8(%rbp)
 340 0021 31C0     		xorl	%eax, %eax
 744:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     size_t i;
 745:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     volatile const unsigned char *A = (volatile const unsigned char *) a;
 341              		.loc 3 745 35
 342 0023 488B45C8 		movq	-56(%rbp), %rax
 343 0027 488945E8 		movq	%rax, -24(%rbp)
 746:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     volatile const unsigned char *B = (volatile const unsigned char *) b;
 344              		.loc 3 746 35
 345 002b 488B45C0 		movq	-64(%rbp), %rax
 346 002f 488945F0 		movq	%rax, -16(%rbp)
 747:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     volatile unsigned char diff = 0;
 347              		.loc 3 747 28
 348 0033 C645DD00 		movb	$0, -35(%rbp)
 748:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 749:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     for( i = 0; i < n; i++ )
 349              		.loc 3 749 12
 350 0037 48C745E0 		movq	$0, -32(%rbp)
 350      00000000 
 351              		.loc 3 749 5
 352 003f EB39     		jmp	.L28
 353              	.L29:
 354              	.LBB2:
 750:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     {
 751:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         /* Read volatile data in order before computing diff.
 752:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****          * This avoids IAR compiler warning:
GAS LISTING /tmp/ccEn8xFO.s 			page 32


 753:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****          * 'the order of volatile accesses is undefined ..' */
 754:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         unsigned char x = A[i], y = B[i];
 355              		.loc 3 754 28 discriminator 3
 356 0041 488B55E8 		movq	-24(%rbp), %rdx
 357 0045 488B45E0 		movq	-32(%rbp), %rax
 358 0049 4801D0   		addq	%rdx, %rax
 359              		.loc 3 754 23 discriminator 3
 360 004c 0FB600   		movzbl	(%rax), %eax
 361 004f 8845DE   		movb	%al, -34(%rbp)
 362              		.loc 3 754 38 discriminator 3
 363 0052 488B55F0 		movq	-16(%rbp), %rdx
 364 0056 488B45E0 		movq	-32(%rbp), %rax
 365 005a 4801D0   		addq	%rdx, %rax
 366              		.loc 3 754 33 discriminator 3
 367 005d 0FB600   		movzbl	(%rax), %eax
 368 0060 8845DF   		movb	%al, -33(%rbp)
 755:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         diff |= x ^ y;
 369              		.loc 3 755 14 discriminator 3
 370 0063 0FB645DE 		movzbl	-34(%rbp), %eax
 371 0067 3245DF   		xorb	-33(%rbp), %al
 372 006a 89C2     		movl	%eax, %edx
 373 006c 0FB645DD 		movzbl	-35(%rbp), %eax
 374 0070 09D0     		orl	%edx, %eax
 375 0072 8845DD   		movb	%al, -35(%rbp)
 376              	.LBE2:
 749:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     {
 377              		.loc 3 749 25 discriminator 3
 378 0075 488345E0 		addq	$1, -32(%rbp)
 378      01
 379              	.L28:
 749:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     {
 380              		.loc 3 749 5 discriminator 1
 381 007a 488B45E0 		movq	-32(%rbp), %rax
 382 007e 483B45B8 		cmpq	-72(%rbp), %rax
 383 0082 72BD     		jb	.L29
 756:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     }
 757:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 758:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     return( diff );
 384              		.loc 3 758 11
 385 0084 0FB645DD 		movzbl	-35(%rbp), %eax
 386 0088 0FB6C0   		movzbl	%al, %eax
 759:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** }
 387              		.loc 3 759 1
 388 008b 488B4DF8 		movq	-8(%rbp), %rcx
 389 008f 6448330C 		xorq	%fs:40, %rcx
 389      25280000 
 389      00
 390 0098 7405     		je	.L31
 391 009a E8000000 		call	__stack_chk_fail@PLT
 391      00
 392              	.L31:
 393 009f C9       		leave
 394              	.LCFI23:
 395              		.cfi_def_cfa 7, 8
 396 00a0 C3       		ret
 397              		.cfi_endproc
 398              	.LFE26:
GAS LISTING /tmp/ccEn8xFO.s 			page 33


 400              		.section	.text.ssl_ep_len,"ax",@progbits
 402              	ssl_ep_len:
 403              	.LFB27:
 404              		.file 4 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c"
   1:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
   2:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  SSLv3/TLSv1 shared functions
   3:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
   4:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  Copyright (C) 2006-2015, ARM Limited, All Rights Reserved
   5:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  SPDX-License-Identifier: Apache-2.0
   6:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
   7:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  Licensed under the Apache License, Version 2.0 (the "License"); you may
   8:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  not use this file except in compliance with the License.
   9:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  You may obtain a copy of the License at
  10:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
  11:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  http://www.apache.org/licenses/LICENSE-2.0
  12:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
  13:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  Unless required by applicable law or agreed to in writing, software
  14:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  15:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  16:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  See the License for the specific language governing permissions and
  17:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  limitations under the License.
  18:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
  19:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  This file is part of mbed TLS (https://tls.mbed.org)
  20:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
  21:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
  22:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  The SSL 3.0 specification was drafted by Netscape in 1996,
  23:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  and became an IETF standard in 1999.
  24:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
  25:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  http://wp.netscape.com/eng/ssl3/
  26:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  http://www.ietf.org/rfc/rfc2246.txt
  27:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  http://www.ietf.org/rfc/rfc4346.txt
  28:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
  29:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
  30:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if !defined(MBEDTLS_CONFIG_FILE)
  31:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #include "mbedtls/config.h"
  32:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #else
  33:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #include MBEDTLS_CONFIG_FILE
  34:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
  35:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
  36:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_TLS_C)
  37:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
  38:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_PLATFORM_C)
  39:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #include "mbedtls/platform.h"
  40:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #else
  41:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #include <stdlib.h>
  42:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #define mbedtls_calloc    calloc
  43:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #define mbedtls_free      free
  44:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
  45:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
  46:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #include "mbedtls/debug.h"
  47:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #include "mbedtls/ssl.h"
  48:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #include "mbedtls/ssl_internal.h"
  49:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #include "mbedtls/platform_util.h"
  50:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
  51:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #include <string.h>
  52:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
  53:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
GAS LISTING /tmp/ccEn8xFO.s 			page 34


  54:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #include "mbedtls/oid.h"
  55:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
  56:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
  57:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_reset_in_out_pointers( mbedtls_ssl_context *ssl );
  58:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static uint32_t ssl_get_hs_total_len( mbedtls_ssl_context const *ssl );
  59:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
  60:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /* Length of the "epoch" field in the record header */
  61:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static inline size_t ssl_ep_len( const mbedtls_ssl_context *ssl )
  62:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 405              		.loc 4 62 1
 406              		.cfi_startproc
 407 0000 55       		pushq	%rbp
 408              	.LCFI24:
 409              		.cfi_def_cfa_offset 16
 410              		.cfi_offset 6, -16
 411 0001 4889E5   		movq	%rsp, %rbp
 412              	.LCFI25:
 413              		.cfi_def_cfa_register 6
 414 0004 4883EC20 		subq	$32, %rsp
 415 0008 48897DE8 		movq	%rdi, -24(%rbp)
 416              		.loc 4 62 1
 417 000c 64488B04 		movq	%fs:40, %rax
 417      25280000 
 417      00
 418 0015 488945F8 		movq	%rax, -8(%rbp)
 419 0019 31C0     		xorl	%eax, %eax
  63:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
  64:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
  65:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 2 );
  66:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #else
  67:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ((void) ssl);
  68:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
  69:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 420              		.loc 4 69 11
 421 001b B8000000 		movl	$0, %eax
 421      00
  70:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 422              		.loc 4 70 1
 423 0020 488B55F8 		movq	-8(%rbp), %rdx
 424 0024 64483314 		xorq	%fs:40, %rdx
 424      25280000 
 424      00
 425 002d 7405     		je	.L34
 426 002f E8000000 		call	__stack_chk_fail@PLT
 426      00
 427              	.L34:
 428 0034 C9       		leave
 429              	.LCFI26:
 430              		.cfi_def_cfa 7, 8
 431 0035 C3       		ret
 432              		.cfi_endproc
 433              	.LFE27:
 435              		.section	.text.ssl_set_timer,"ax",@progbits
 437              	ssl_set_timer:
 438              	.LFB28:
  71:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
  72:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
GAS LISTING /tmp/ccEn8xFO.s 			page 35


  73:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Start a timer.
  74:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Passing millisecs = 0 cancels a running timer.
  75:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
  76:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_set_timer( mbedtls_ssl_context *ssl, uint32_t millisecs )
  77:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 439              		.loc 4 77 1
 440              		.cfi_startproc
 441 0000 F30F1EFA 		endbr64
 442 0004 55       		pushq	%rbp
 443              	.LCFI27:
 444              		.cfi_def_cfa_offset 16
 445              		.cfi_offset 6, -16
 446 0005 4889E5   		movq	%rsp, %rbp
 447              	.LCFI28:
 448              		.cfi_def_cfa_register 6
 449 0008 4883EC20 		subq	$32, %rsp
 450 000c 48897DE8 		movq	%rdi, -24(%rbp)
 451 0010 8975E4   		movl	%esi, -28(%rbp)
 452              		.loc 4 77 1
 453 0013 64488B04 		movq	%fs:40, %rax
 453      25280000 
 453      00
 454 001c 488945F8 		movq	%rax, -8(%rbp)
 455 0020 31C0     		xorl	%eax, %eax
  78:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->f_set_timer == NULL )
 456              		.loc 4 78 12
 457 0022 488B45E8 		movq	-24(%rbp), %rax
 458 0026 488B8090 		movq	144(%rax), %rax
 458      000000
 459              		.loc 4 78 7
 460 002d 4885C0   		testq	%rax, %rax
 461 0030 7428     		je	.L39
  79:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return;
  80:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
  81:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "set_timer to %d ms", (int) millisecs ) );
  82:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->f_set_timer( ssl->p_timer, millisecs / 4, millisecs );
 462              		.loc 4 82 8
 463 0032 488B45E8 		movq	-24(%rbp), %rax
 464 0036 488B8890 		movq	144(%rax), %rcx
 464      000000
 465              		.loc 4 82 5
 466 003d 8B45E4   		movl	-28(%rbp), %eax
 467 0040 C1E802   		shrl	$2, %eax
 468 0043 89C6     		movl	%eax, %esi
 469 0045 488B45E8 		movq	-24(%rbp), %rax
 470 0049 488B8088 		movq	136(%rax), %rax
 470      000000
 471 0050 8B55E4   		movl	-28(%rbp), %edx
 472 0053 4889C7   		movq	%rax, %rdi
 473 0056 FFD1     		call	*%rcx
 474              	.LVL0:
 475 0058 EB01     		jmp	.L35
 476              	.L39:
  79:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return;
 477              		.loc 4 79 9
 478 005a 90       		nop
 479              	.L35:
GAS LISTING /tmp/ccEn8xFO.s 			page 36


  83:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 480              		.loc 4 83 1
 481 005b 488B45F8 		movq	-8(%rbp), %rax
 482 005f 64483304 		xorq	%fs:40, %rax
 482      25280000 
 482      00
 483 0068 7405     		je	.L38
 484 006a E8000000 		call	__stack_chk_fail@PLT
 484      00
 485              	.L38:
 486 006f C9       		leave
 487              	.LCFI29:
 488              		.cfi_def_cfa 7, 8
 489 0070 C3       		ret
 490              		.cfi_endproc
 491              	.LFE28:
 493              		.section	.text.ssl_check_timer,"ax",@progbits
 495              	ssl_check_timer:
 496              	.LFB29:
  84:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
  85:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
  86:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Return -1 is timer is expired, 0 if it isn't.
  87:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
  88:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_check_timer( mbedtls_ssl_context *ssl )
  89:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 497              		.loc 4 89 1
 498              		.cfi_startproc
 499 0000 F30F1EFA 		endbr64
 500 0004 55       		pushq	%rbp
 501              	.LCFI30:
 502              		.cfi_def_cfa_offset 16
 503              		.cfi_offset 6, -16
 504 0005 4889E5   		movq	%rsp, %rbp
 505              	.LCFI31:
 506              		.cfi_def_cfa_register 6
 507 0008 4883EC20 		subq	$32, %rsp
 508 000c 48897DE8 		movq	%rdi, -24(%rbp)
 509              		.loc 4 89 1
 510 0010 64488B04 		movq	%fs:40, %rax
 510      25280000 
 510      00
 511 0019 488945F8 		movq	%rax, -8(%rbp)
 512 001d 31C0     		xorl	%eax, %eax
  90:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->f_get_timer == NULL )
 513              		.loc 4 90 12
 514 001f 488B45E8 		movq	-24(%rbp), %rax
 515 0023 488B8098 		movq	152(%rax), %rax
 515      000000
 516              		.loc 4 90 7
 517 002a 4885C0   		testq	%rax, %rax
 518 002d 7507     		jne	.L41
  91:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
 519              		.loc 4 91 15
 520 002f B8000000 		movl	$0, %eax
 520      00
 521 0034 EB2C     		jmp	.L42
 522              	.L41:
GAS LISTING /tmp/ccEn8xFO.s 			page 37


  92:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
  93:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->f_get_timer( ssl->p_timer ) == 2 )
 523              		.loc 4 93 12
 524 0036 488B45E8 		movq	-24(%rbp), %rax
 525 003a 488B9098 		movq	152(%rax), %rdx
 525      000000
 526              		.loc 4 93 9
 527 0041 488B45E8 		movq	-24(%rbp), %rax
 528 0045 488B8088 		movq	136(%rax), %rax
 528      000000
 529 004c 4889C7   		movq	%rax, %rdi
 530 004f FFD2     		call	*%rdx
 531              	.LVL1:
 532              		.loc 4 93 7
 533 0051 83F802   		cmpl	$2, %eax
 534 0054 7507     		jne	.L43
  94:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
  95:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "timer expired" ) );
  96:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( -1 );
 535              		.loc 4 96 15
 536 0056 B8FFFFFF 		movl	$-1, %eax
 536      FF
 537 005b EB05     		jmp	.L42
 538              	.L43:
  97:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
  98:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
  99:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 539              		.loc 4 99 11
 540 005d B8000000 		movl	$0, %eax
 540      00
 541              	.L42:
 100:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 542              		.loc 4 100 1
 543 0062 488B4DF8 		movq	-8(%rbp), %rcx
 544 0066 6448330C 		xorq	%fs:40, %rcx
 544      25280000 
 544      00
 545 006f 7405     		je	.L44
 546 0071 E8000000 		call	__stack_chk_fail@PLT
 546      00
 547              	.L44:
 548 0076 C9       		leave
 549              	.LCFI32:
 550              		.cfi_def_cfa 7, 8
 551 0077 C3       		ret
 552              		.cfi_endproc
 553              	.LFE29:
 555              		.section	.text.ssl_mfl_code_to_length,"ax",@progbits
 557              	ssl_mfl_code_to_length:
 558              	.LFB30:
 101:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 102:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_update_out_pointers( mbedtls_ssl_context *ssl,
 103:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                      mbedtls_ssl_transform *transform );
 104:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_update_in_pointers( mbedtls_ssl_context *ssl,
 105:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     mbedtls_ssl_transform *transform );
 106:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 107:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #define SSL_DONT_FORCE_FLUSH 0
GAS LISTING /tmp/ccEn8xFO.s 			page 38


 108:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #define SSL_FORCE_FLUSH      1
 109:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 110:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 111:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 112:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /* Forward declarations for functions related to message buffering. */
 113:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_buffering_free( mbedtls_ssl_context *ssl );
 114:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_buffering_free_slot( mbedtls_ssl_context *ssl,
 115:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                      uint8_t slot );
 116:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_free_buffered_record( mbedtls_ssl_context *ssl );
 117:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_load_buffered_message( mbedtls_ssl_context *ssl );
 118:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_load_buffered_record( mbedtls_ssl_context *ssl );
 119:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_buffer_message( mbedtls_ssl_context *ssl );
 120:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_buffer_future_record( mbedtls_ssl_context *ssl );
 121:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_next_record_is_in_datagram( mbedtls_ssl_context *ssl );
 122:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static size_t ssl_get_current_mtu( const mbedtls_ssl_context *ssl );
 124:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static size_t ssl_get_maximum_datagram_size( mbedtls_ssl_context const *ssl )
 125:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 126:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t mtu = ssl_get_current_mtu( ssl );
 127:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 128:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( mtu != 0 && mtu < MBEDTLS_SSL_OUT_BUFFER_LEN )
 129:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( mtu );
 130:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 131:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( MBEDTLS_SSL_OUT_BUFFER_LEN );
 132:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 133:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 134:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_get_remaining_space_in_datagram( mbedtls_ssl_context const *ssl )
 135:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 136:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t const bytes_written = ssl->out_left;
 137:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t const mtu           = ssl_get_maximum_datagram_size( ssl );
 138:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 139:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Double-check that the write-index hasn't gone
 140:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * past what we can transmit in a single datagram. */
 141:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( bytes_written > mtu )
 142:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 143:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Should never happen... */
 144:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 145:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 146:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 147:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( (int) ( mtu - bytes_written ) );
 148:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 149:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 150:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_get_remaining_payload_in_datagram( mbedtls_ssl_context const *ssl )
 151:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 152:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
 153:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t remaining, expansion;
 154:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t max_len = MBEDTLS_SSL_OUT_CONTENT_LEN;
 155:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 156:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_MAX_FRAGMENT_LENGTH)
 157:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const size_t mfl = mbedtls_ssl_get_max_frag_len( ssl );
 158:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 159:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( max_len > mfl )
 160:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         max_len = mfl;
 161:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 162:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* By the standard (RFC 6066 Sect. 4), the MFL extension
 163:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * only limits the maximum record payload size, so in theory
 164:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * we would be allowed to pack multiple records of payload size
GAS LISTING /tmp/ccEn8xFO.s 			page 39


 165:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * MFL into a single datagram. However, this would mean that there's
 166:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * no way to explicitly communicate MTU restrictions to the peer.
 167:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *
 168:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * The following reduction of max_len makes sure that we never
 169:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * write datagrams larger than MFL + Record Expansion Overhead.
 170:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
 171:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( max_len <= ssl->out_left )
 172:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
 173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 174:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     max_len -= ssl->out_left;
 175:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
 176:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 177:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ret = ssl_get_remaining_space_in_datagram( ssl );
 178:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ret < 0 )
 179:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 180:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     remaining = (size_t) ret;
 181:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 182:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ret = mbedtls_ssl_get_record_expansion( ssl );
 183:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ret < 0 )
 184:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 185:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     expansion = (size_t) ret;
 186:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 187:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( remaining <= expansion )
 188:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
 189:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 190:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     remaining -= expansion;
 191:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( remaining >= max_len )
 192:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         remaining = max_len;
 193:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 194:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( (int) remaining );
 195:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 196:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 197:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
 198:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Double the retransmit timeout value, within the allowed range,
 199:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * returning -1 if the maximum value has already been reached.
 200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
 201:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_double_retransmit_timeout( mbedtls_ssl_context *ssl )
 202:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 203:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     uint32_t new_timeout;
 204:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 205:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->handshake->retransmit_timeout >= ssl->conf->hs_timeout_max )
 206:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( -1 );
 207:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 208:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Implement the final paragraph of RFC 6347 section 4.1.1.1
 209:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * in the following way: after the initial transmission and a first
 210:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * retransmission, back off to a temporary estimated MTU of 508 bytes.
 211:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * This value is guaranteed to be deliverable (if not guaranteed to be
 212:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * delivered) of any compliant IPv4 (and IPv6) network, and should work
 213:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * on most non-IP stacks too. */
 214:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->handshake->retransmit_timeout != ssl->conf->hs_timeout_min )
 215:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 216:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake->mtu = 508;
 217:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "mtu autoreduction to %d bytes", ssl->handshake->mtu ) );
 218:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 219:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 220:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     new_timeout = 2 * ssl->handshake->retransmit_timeout;
 221:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 40


 222:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Avoid arithmetic overflow and range overflow */
 223:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( new_timeout < ssl->handshake->retransmit_timeout ||
 224:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         new_timeout > ssl->conf->hs_timeout_max )
 225:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 226:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         new_timeout = ssl->conf->hs_timeout_max;
 227:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 228:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 229:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->handshake->retransmit_timeout = new_timeout;
 230:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "update timeout value to %d millisecs",
 231:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         ssl->handshake->retransmit_timeout ) );
 232:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 233:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 234:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 235:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 236:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_reset_retransmit_timeout( mbedtls_ssl_context *ssl )
 237:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 238:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->handshake->retransmit_timeout = ssl->conf->hs_timeout_min;
 239:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "update timeout value to %d millisecs",
 240:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         ssl->handshake->retransmit_timeout ) );
 241:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 242:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
 243:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 244:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_MAX_FRAGMENT_LENGTH)
 245:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
 246:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Convert max_fragment_length codes to length.
 247:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * RFC 6066 says:
 248:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *    enum{
 249:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *        2^9(1), 2^10(2), 2^11(3), 2^12(4), (255)
 250:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *    } MaxFragmentLength;
 251:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * and we add 0 -> extension unused
 252:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
 253:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static unsigned int ssl_mfl_code_to_length( int mfl )
 254:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 559              		.loc 4 254 1
 560              		.cfi_startproc
 561 0000 F30F1EFA 		endbr64
 562 0004 55       		pushq	%rbp
 563              	.LCFI33:
 564              		.cfi_def_cfa_offset 16
 565              		.cfi_offset 6, -16
 566 0005 4889E5   		movq	%rsp, %rbp
 567              	.LCFI34:
 568              		.cfi_def_cfa_register 6
 569 0008 4883EC20 		subq	$32, %rsp
 570 000c 897DEC   		movl	%edi, -20(%rbp)
 571              		.loc 4 254 1
 572 000f 64488B04 		movq	%fs:40, %rax
 572      25280000 
 572      00
 573 0018 488945F8 		movq	%rax, -8(%rbp)
 574 001c 31C0     		xorl	%eax, %eax
 575 001e 837DEC04 		cmpl	$4, -20(%rbp)
 576 0022 7747     		ja	.L46
 577 0024 8B45EC   		movl	-20(%rbp), %eax
 578 0027 488D1485 		leaq	0(,%rax,4), %rdx
 578      00000000 
 579 002f 488D0500 		leaq	.L48(%rip), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 41


 579      000000
 580 0036 8B0402   		movl	(%rdx,%rax), %eax
 581 0039 4898     		cltq
 582 003b 488D1500 		leaq	.L48(%rip), %rdx
 582      000000
 583 0042 4801D0   		addq	%rdx, %rax
 584 0045 3EFFE0   		notrack jmp	*%rax
 585              		.section	.rodata.ssl_mfl_code_to_length,"a",@progbits
 586              		.align 4
 587              		.align 4
 588              	.L48:
 589 0000 00000000 		.long	.L52-.L48
 590 0004 00000000 		.long	.L51-.L48
 591 0008 00000000 		.long	.L50-.L48
 592 000c 00000000 		.long	.L49-.L48
 593 0010 00000000 		.long	.L47-.L48
 594              		.section	.text.ssl_mfl_code_to_length
 595              	.L52:
 255:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     switch( mfl )
 256:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 257:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     case MBEDTLS_SSL_MAX_FRAG_LEN_NONE:
 258:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return ( MBEDTLS_TLS_EXT_ADV_CONTENT_LEN );
 596              		.loc 4 258 16
 597 0048 B8803E00 		movl	$16000, %eax
 597      00
 598 004d EB21     		jmp	.L53
 599              	.L51:
 259:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     case MBEDTLS_SSL_MAX_FRAG_LEN_512:
 260:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return 512;
 600              		.loc 4 260 16
 601 004f B8000200 		movl	$512, %eax
 601      00
 602 0054 EB1A     		jmp	.L53
 603              	.L50:
 261:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     case MBEDTLS_SSL_MAX_FRAG_LEN_1024:
 262:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return 1024;
 604              		.loc 4 262 16
 605 0056 B8000400 		movl	$1024, %eax
 605      00
 606 005b EB13     		jmp	.L53
 607              	.L49:
 263:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     case MBEDTLS_SSL_MAX_FRAG_LEN_2048:
 264:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return 2048;
 608              		.loc 4 264 16
 609 005d B8000800 		movl	$2048, %eax
 609      00
 610 0062 EB0C     		jmp	.L53
 611              	.L47:
 265:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     case MBEDTLS_SSL_MAX_FRAG_LEN_4096:
 266:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return 4096;
 612              		.loc 4 266 16
 613 0064 B8001000 		movl	$4096, %eax
 613      00
 614 0069 EB05     		jmp	.L53
 615              	.L46:
 267:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     default:
 268:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return ( MBEDTLS_TLS_EXT_ADV_CONTENT_LEN );
GAS LISTING /tmp/ccEn8xFO.s 			page 42


 616              		.loc 4 268 16
 617 006b B8803E00 		movl	$16000, %eax
 617      00
 618              	.L53:
 269:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 270:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 619              		.loc 4 270 1
 620 0070 488B4DF8 		movq	-8(%rbp), %rcx
 621 0074 6448330C 		xorq	%fs:40, %rcx
 621      25280000 
 621      00
 622 007d 7405     		je	.L54
 623 007f E8000000 		call	__stack_chk_fail@PLT
 623      00
 624              	.L54:
 625 0084 C9       		leave
 626              	.LCFI35:
 627              		.cfi_def_cfa 7, 8
 628 0085 C3       		ret
 629              		.cfi_endproc
 630              	.LFE30:
 632              		.section	.text.ssl_session_copy,"ax",@progbits
 634              	ssl_session_copy:
 635              	.LFB31:
 271:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_MAX_FRAGMENT_LENGTH */
 272:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 273:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
 274:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_session_copy( mbedtls_ssl_session *dst, const mbedtls_ssl_session *src )
 275:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 636              		.loc 4 275 1
 637              		.cfi_startproc
 638 0000 F30F1EFA 		endbr64
 639 0004 55       		pushq	%rbp
 640              	.LCFI36:
 641              		.cfi_def_cfa_offset 16
 642              		.cfi_offset 6, -16
 643 0005 4889E5   		movq	%rsp, %rbp
 644              	.LCFI37:
 645              		.cfi_def_cfa_register 6
 646 0008 4883EC20 		subq	$32, %rsp
 647 000c 48897DE8 		movq	%rdi, -24(%rbp)
 648 0010 488975E0 		movq	%rsi, -32(%rbp)
 649              		.loc 4 275 1
 650 0014 64488B04 		movq	%fs:40, %rax
 650      25280000 
 650      00
 651 001d 488945F8 		movq	%rax, -8(%rbp)
 652 0021 31C0     		xorl	%eax, %eax
 276:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_session_free( dst );
 653              		.loc 4 276 5
 654 0023 488B45E8 		movq	-24(%rbp), %rax
 655 0027 4889C7   		movq	%rax, %rdi
 656 002a E8000000 		call	mbedtls_ssl_session_free
 656      00
 277:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( dst, src, sizeof( mbedtls_ssl_session ) );
 657              		.loc 4 277 5
 658 002f 488B4DE0 		movq	-32(%rbp), %rcx
GAS LISTING /tmp/ccEn8xFO.s 			page 43


 659 0033 488B45E8 		movq	-24(%rbp), %rax
 660 0037 BA880000 		movl	$136, %edx
 660      00
 661 003c 4889CE   		movq	%rcx, %rsi
 662 003f 4889C7   		movq	%rax, %rdi
 663 0042 E8000000 		call	memcpy@PLT
 663      00
 278:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 279:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
 280:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( src->peer_cert != NULL )
 664              		.loc 4 280 12
 665 0047 488B45E0 		movq	-32(%rbp), %rax
 666 004b 488B4060 		movq	96(%rax), %rax
 667              		.loc 4 280 7
 668 004f 4885C0   		testq	%rax, %rax
 669 0052 0F849300 		je	.L56
 669      0000
 670              	.LBB3:
 281:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 282:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         int ret;
 283:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 284:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         dst->peer_cert = mbedtls_calloc( 1, sizeof(mbedtls_x509_crt) );
 671              		.loc 4 284 26
 672 0058 BE280200 		movl	$552, %esi
 672      00
 673 005d BF010000 		movl	$1, %edi
 673      00
 674 0062 E8000000 		call	mbedtls_calloc@PLT
 674      00
 675              		.loc 4 284 24
 676 0067 488B55E8 		movq	-24(%rbp), %rdx
 677 006b 48894260 		movq	%rax, 96(%rdx)
 285:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( dst->peer_cert == NULL )
 678              		.loc 4 285 16
 679 006f 488B45E8 		movq	-24(%rbp), %rax
 680 0073 488B4060 		movq	96(%rax), %rax
 681              		.loc 4 285 11
 682 0077 4885C0   		testq	%rax, %rax
 683 007a 750A     		jne	.L57
 286:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
 684              		.loc 4 286 19
 685 007c B80081FF 		movl	$-32512, %eax
 685      FF
 686 0081 E9CB0000 		jmp	.L58
 686      00
 687              	.L57:
 287:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 288:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_x509_crt_init( dst->peer_cert );
 688              		.loc 4 288 9
 689 0086 488B45E8 		movq	-24(%rbp), %rax
 690 008a 488B4060 		movq	96(%rax), %rax
 691 008e 4889C7   		movq	%rax, %rdi
 692 0091 E8000000 		call	mbedtls_x509_crt_init@PLT
 692      00
 289:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 290:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_x509_crt_parse_der( dst->peer_cert, src->peer_cert->raw.p,
 291:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         src->peer_cert->raw.len ) ) != 0 )
GAS LISTING /tmp/ccEn8xFO.s 			page 44


 693              		.loc 4 291 44
 694 0096 488B45E0 		movq	-32(%rbp), %rax
 695 009a 488B4060 		movq	96(%rax), %rax
 290:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         src->peer_cert->raw.len ) ) != 0 )
 696              		.loc 4 290 21
 697 009e 488B5008 		movq	8(%rax), %rdx
 290:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         src->peer_cert->raw.len ) ) != 0 )
 698              		.loc 4 290 68
 699 00a2 488B45E0 		movq	-32(%rbp), %rax
 700 00a6 488B4060 		movq	96(%rax), %rax
 290:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         src->peer_cert->raw.len ) ) != 0 )
 701              		.loc 4 290 84
 702 00aa 488B4810 		movq	16(%rax), %rcx
 290:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         src->peer_cert->raw.len ) ) != 0 )
 703              		.loc 4 290 21
 704 00ae 488B45E8 		movq	-24(%rbp), %rax
 705 00b2 488B4060 		movq	96(%rax), %rax
 706 00b6 4889CE   		movq	%rcx, %rsi
 707 00b9 4889C7   		movq	%rax, %rdi
 708 00bc E8000000 		call	mbedtls_x509_crt_parse_der@PLT
 708      00
 709 00c1 8945F4   		movl	%eax, -12(%rbp)
 290:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         src->peer_cert->raw.len ) ) != 0 )
 710              		.loc 4 290 11
 711 00c4 837DF400 		cmpl	$0, -12(%rbp)
 712 00c8 7421     		je	.L56
 292:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
 293:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_free( dst->peer_cert );
 713              		.loc 4 293 30
 714 00ca 488B45E8 		movq	-24(%rbp), %rax
 715 00ce 488B4060 		movq	96(%rax), %rax
 716              		.loc 4 293 13
 717 00d2 4889C7   		movq	%rax, %rdi
 718 00d5 E8000000 		call	mbedtls_free@PLT
 718      00
 294:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             dst->peer_cert = NULL;
 719              		.loc 4 294 28
 720 00da 488B45E8 		movq	-24(%rbp), %rax
 721 00de 48C74060 		movq	$0, 96(%rax)
 721      00000000 
 295:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 722              		.loc 4 295 19
 723 00e6 8B45F4   		movl	-12(%rbp), %eax
 724 00e9 EB66     		jmp	.L58
 725              	.L56:
 726              	.LBE3:
 296:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
 297:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 298:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
 299:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 300:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SESSION_TICKETS) && defined(MBEDTLS_SSL_CLI_C)
 301:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( src->ticket != NULL )
 727              		.loc 4 301 12
 728 00eb 488B45E0 		movq	-32(%rbp), %rax
 729 00ef 488B4070 		movq	112(%rax), %rax
 730              		.loc 4 301 7
 731 00f3 4885C0   		testq	%rax, %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 45


 732 00f6 7454     		je	.L59
 302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 303:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         dst->ticket = mbedtls_calloc( 1, src->ticket_len );
 733              		.loc 4 303 23
 734 00f8 488B45E0 		movq	-32(%rbp), %rax
 735 00fc 488B4078 		movq	120(%rax), %rax
 736 0100 4889C6   		movq	%rax, %rsi
 737 0103 BF010000 		movl	$1, %edi
 737      00
 738 0108 E8000000 		call	mbedtls_calloc@PLT
 738      00
 739              		.loc 4 303 21
 740 010d 488B55E8 		movq	-24(%rbp), %rdx
 741 0111 48894270 		movq	%rax, 112(%rdx)
 304:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( dst->ticket == NULL )
 742              		.loc 4 304 16
 743 0115 488B45E8 		movq	-24(%rbp), %rax
 744 0119 488B4070 		movq	112(%rax), %rax
 745              		.loc 4 304 11
 746 011d 4885C0   		testq	%rax, %rax
 747 0120 7507     		jne	.L60
 305:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
 748              		.loc 4 305 19
 749 0122 B80081FF 		movl	$-32512, %eax
 749      FF
 750 0127 EB28     		jmp	.L58
 751              	.L60:
 306:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 307:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memcpy( dst->ticket, src->ticket, src->ticket_len );
 752              		.loc 4 307 9
 753 0129 488B45E0 		movq	-32(%rbp), %rax
 754 012d 488B5078 		movq	120(%rax), %rdx
 755              		.loc 4 307 33
 756 0131 488B45E0 		movq	-32(%rbp), %rax
 757 0135 488B4870 		movq	112(%rax), %rcx
 758              		.loc 4 307 20
 759 0139 488B45E8 		movq	-24(%rbp), %rax
 760 013d 488B4070 		movq	112(%rax), %rax
 761              		.loc 4 307 9
 762 0141 4889CE   		movq	%rcx, %rsi
 763 0144 4889C7   		movq	%rax, %rdi
 764 0147 E8000000 		call	memcpy@PLT
 764      00
 765              	.L59:
 308:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 309:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_SESSION_TICKETS && MBEDTLS_SSL_CLI_C */
 310:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 311:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 766              		.loc 4 311 11
 767 014c B8000000 		movl	$0, %eax
 767      00
 768              	.L58:
 312:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 769              		.loc 4 312 1
 770 0151 488B4DF8 		movq	-8(%rbp), %rcx
 771 0155 6448330C 		xorq	%fs:40, %rcx
 771      25280000 
GAS LISTING /tmp/ccEn8xFO.s 			page 46


 771      00
 772 015e 7405     		je	.L61
 773 0160 E8000000 		call	__stack_chk_fail@PLT
 773      00
 774              	.L61:
 775 0165 C9       		leave
 776              	.LCFI38:
 777              		.cfi_def_cfa 7, 8
 778 0166 C3       		ret
 779              		.cfi_endproc
 780              	.LFE31:
 782              		.section	.text.tls_prf_generic,"ax",@progbits
 784              	tls_prf_generic:
 785              	.LFB32:
 313:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_CLI_C */
 314:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 315:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_HW_RECORD_ACCEL)
 316:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int (*mbedtls_ssl_hw_record_init)( mbedtls_ssl_context *ssl,
 317:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      const unsigned char *key_enc, const unsigned char *key_dec,
 318:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      size_t keylen,
 319:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      const unsigned char *iv_enc,  const unsigned char *iv_dec,
 320:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      size_t ivlen,
 321:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      const unsigned char *mac_enc, const unsigned char *mac_dec,
 322:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      size_t maclen ) = NULL;
 323:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int (*mbedtls_ssl_hw_record_activate)( mbedtls_ssl_context *ssl, int direction) = NULL;
 324:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int (*mbedtls_ssl_hw_record_reset)( mbedtls_ssl_context *ssl ) = NULL;
 325:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int (*mbedtls_ssl_hw_record_write)( mbedtls_ssl_context *ssl ) = NULL;
 326:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int (*mbedtls_ssl_hw_record_read)( mbedtls_ssl_context *ssl ) = NULL;
 327:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int (*mbedtls_ssl_hw_record_finish)( mbedtls_ssl_context *ssl ) = NULL;
 328:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_HW_RECORD_ACCEL */
 329:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 330:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
 331:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Key material generation
 332:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
 333:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
 334:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl3_prf( const unsigned char *secret, size_t slen,
 335:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      const char *label,
 336:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      const unsigned char *random, size_t rlen,
 337:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      unsigned char *dstbuf, size_t dlen )
 338:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 339:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret = 0;
 340:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t i;
 341:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_context md5;
 342:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_context sha1;
 343:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char padding[16];
 344:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char sha1sum[20];
 345:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ((void)label);
 346:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 347:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_init(  &md5  );
 348:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_init( &sha1 );
 349:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 350:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
 351:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *  SSLv3:
 352:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *    block =
 353:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *      MD5( secret + SHA1( 'A'    + secret + random ) ) +
 354:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *      MD5( secret + SHA1( 'BB'   + secret + random ) ) +
 355:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *      MD5( secret + SHA1( 'CCC'  + secret + random ) ) +
GAS LISTING /tmp/ccEn8xFO.s 			page 47


 356:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *      ...
 357:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
 358:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     for( i = 0; i < dlen / 16; i++ )
 359:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 360:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memset( padding, (unsigned char) ('A' + i), 1 + i );
 361:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 362:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_sha1_starts_ret( &sha1 ) ) != 0 )
 363:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             goto exit;
 364:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_sha1_update_ret( &sha1, padding, 1 + i ) ) != 0 )
 365:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             goto exit;
 366:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_sha1_update_ret( &sha1, secret, slen ) ) != 0 )
 367:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             goto exit;
 368:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_sha1_update_ret( &sha1, random, rlen ) ) != 0 )
 369:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             goto exit;
 370:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_sha1_finish_ret( &sha1, sha1sum ) ) != 0 )
 371:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             goto exit;
 372:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 373:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_md5_starts_ret( &md5 ) ) != 0 )
 374:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             goto exit;
 375:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_md5_update_ret( &md5, secret, slen ) ) != 0 )
 376:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             goto exit;
 377:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_md5_update_ret( &md5, sha1sum, 20 ) ) != 0 )
 378:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             goto exit;
 379:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_md5_finish_ret( &md5, dstbuf + i * 16 ) ) != 0 )
 380:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             goto exit;
 381:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 382:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 383:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** exit:
 384:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_free(  &md5  );
 385:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_free( &sha1 );
 386:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 387:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_platform_zeroize( padding, sizeof( padding ) );
 388:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_platform_zeroize( sha1sum, sizeof( sha1sum ) );
 389:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 390:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ret );
 391:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 392:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 */
 393:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 394:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1)
 395:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int tls1_prf( const unsigned char *secret, size_t slen,
 396:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      const char *label,
 397:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      const unsigned char *random, size_t rlen,
 398:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      unsigned char *dstbuf, size_t dlen )
 399:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 400:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t nb, hs;
 401:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t i, j, k;
 402:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const unsigned char *S1, *S2;
 403:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char tmp[128];
 404:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char h_i[20];
 405:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const mbedtls_md_info_t *md_info;
 406:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_context_t md_ctx;
 407:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
 408:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 409:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_init( &md_ctx );
 410:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 411:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( sizeof( tmp ) < 20 + strlen( label ) + rlen )
 412:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
GAS LISTING /tmp/ccEn8xFO.s 			page 48


 413:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 414:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     hs = ( slen + 1 ) / 2;
 415:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     S1 = secret;
 416:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     S2 = secret + slen - hs;
 417:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 418:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     nb = strlen( label );
 419:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( tmp + 20, label, nb );
 420:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( tmp + 20 + nb, random, rlen );
 421:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     nb += rlen;
 422:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 423:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
 424:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * First compute P_md5(secret,label+random)[0..dlen]
 425:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
 426:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( md_info = mbedtls_md_info_from_type( MBEDTLS_MD_MD5 ) ) == NULL )
 427:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 428:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 429:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_md_setup( &md_ctx, md_info, 1 ) ) != 0 )
 430:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 431:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 432:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_hmac_starts( &md_ctx, S1, hs );
 433:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_hmac_update( &md_ctx, tmp + 20, nb );
 434:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_hmac_finish( &md_ctx, 4 + tmp );
 435:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 436:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     for( i = 0; i < dlen; i += 16 )
 437:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 438:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_md_hmac_reset ( &md_ctx );
 439:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_md_hmac_update( &md_ctx, 4 + tmp, 16 + nb );
 440:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_md_hmac_finish( &md_ctx, h_i );
 441:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 442:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_md_hmac_reset ( &md_ctx );
 443:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_md_hmac_update( &md_ctx, 4 + tmp, 16 );
 444:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_md_hmac_finish( &md_ctx, 4 + tmp );
 445:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 446:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         k = ( i + 16 > dlen ) ? dlen % 16 : 16;
 447:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 448:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         for( j = 0; j < k; j++ )
 449:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             dstbuf[i + j]  = h_i[j];
 450:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 451:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 452:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_free( &md_ctx );
 453:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 454:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
 455:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * XOR out with P_sha1(secret,label+random)[0..dlen]
 456:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
 457:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( md_info = mbedtls_md_info_from_type( MBEDTLS_MD_SHA1 ) ) == NULL )
 458:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 459:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 460:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_md_setup( &md_ctx, md_info, 1 ) ) != 0 )
 461:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 462:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 463:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_hmac_starts( &md_ctx, S2, hs );
 464:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_hmac_update( &md_ctx, tmp + 20, nb );
 465:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_hmac_finish( &md_ctx, tmp );
 466:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 467:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     for( i = 0; i < dlen; i += 20 )
 468:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 469:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_md_hmac_reset ( &md_ctx );
GAS LISTING /tmp/ccEn8xFO.s 			page 49


 470:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_md_hmac_update( &md_ctx, tmp, 20 + nb );
 471:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_md_hmac_finish( &md_ctx, h_i );
 472:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 473:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_md_hmac_reset ( &md_ctx );
 474:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_md_hmac_update( &md_ctx, tmp, 20 );
 475:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_md_hmac_finish( &md_ctx, tmp );
 476:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 477:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         k = ( i + 20 > dlen ) ? dlen % 20 : 20;
 478:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 479:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         for( j = 0; j < k; j++ )
 480:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             dstbuf[i + j] = (unsigned char)( dstbuf[i + j] ^ h_i[j] );
 481:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 482:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 483:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_free( &md_ctx );
 484:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 485:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_platform_zeroize( tmp, sizeof( tmp ) );
 486:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_platform_zeroize( h_i, sizeof( h_i ) );
 487:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 488:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 489:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 490:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1) || MBEDTLS_SSL_PROTO_TLS1_1 */
 491:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 492:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
 493:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int tls_prf_generic( mbedtls_md_type_t md_type,
 494:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             const unsigned char *secret, size_t slen,
 495:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             const char *label,
 496:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             const unsigned char *random, size_t rlen,
 497:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             unsigned char *dstbuf, size_t dlen )
 498:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 786              		.loc 4 498 1
 787              		.cfi_startproc
 788 0000 F30F1EFA 		endbr64
 789 0004 55       		pushq	%rbp
 790              	.LCFI39:
 791              		.cfi_def_cfa_offset 16
 792              		.cfi_offset 6, -16
 793 0005 4889E5   		movq	%rsp, %rbp
 794              	.LCFI40:
 795              		.cfi_def_cfa_register 6
 796 0008 4881EC50 		subq	$336, %rsp
 796      010000
 797 000f 89BDECFE 		movl	%edi, -276(%rbp)
 797      FFFF
 798 0015 4889B5E0 		movq	%rsi, -288(%rbp)
 798      FEFFFF
 799 001c 488995D8 		movq	%rdx, -296(%rbp)
 799      FEFFFF
 800 0023 48898DD0 		movq	%rcx, -304(%rbp)
 800      FEFFFF
 801 002a 4C8985C8 		movq	%r8, -312(%rbp)
 801      FEFFFF
 802 0031 4C898DC0 		movq	%r9, -320(%rbp)
 802      FEFFFF
 803 0038 488B4510 		movq	16(%rbp), %rax
 804 003c 488985B8 		movq	%rax, -328(%rbp)
 804      FEFFFF
 805 0043 488B4518 		movq	24(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 50


 806 0047 488985B0 		movq	%rax, -336(%rbp)
 806      FEFFFF
 807              		.loc 4 498 1
 808 004e 64488B04 		movq	%fs:40, %rax
 808      25280000 
 808      00
 809 0057 488945F8 		movq	%rax, -8(%rbp)
 810 005b 31C0     		xorl	%eax, %eax
 499:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t nb;
 500:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t i, j, k, md_len;
 501:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char tmp[128];
 502:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char h_i[MBEDTLS_MD_MAX_SIZE];
 503:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const mbedtls_md_info_t *md_info;
 504:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_context_t md_ctx;
 505:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
 506:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 507:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_init( &md_ctx );
 811              		.loc 4 507 5
 812 005d 488D8530 		leaq	-208(%rbp), %rax
 812      FFFFFF
 813 0064 4889C7   		movq	%rax, %rdi
 814 0067 E8000000 		call	mbedtls_md_init@PLT
 814      00
 508:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 509:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( md_info = mbedtls_md_info_from_type( md_type ) ) == NULL )
 815              		.loc 4 509 21
 816 006c 8B85ECFE 		movl	-276(%rbp), %eax
 816      FFFF
 817 0072 89C7     		movl	%eax, %edi
 818 0074 E8000000 		call	mbedtls_md_info_from_type@PLT
 818      00
 819 0079 48898510 		movq	%rax, -240(%rbp)
 819      FFFFFF
 820              		.loc 4 509 7
 821 0080 4883BD10 		cmpq	$0, -240(%rbp)
 821      FFFFFF00 
 822 0088 750A     		jne	.L63
 510:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 823              		.loc 4 510 15
 824 008a B80094FF 		movl	$-27648, %eax
 824      FF
 825 008f E90C0300 		jmp	.L73
 825      00
 826              	.L63:
 511:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 512:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     md_len = mbedtls_md_get_size( md_info );
 827              		.loc 4 512 14
 828 0094 488B8510 		movq	-240(%rbp), %rax
 828      FFFFFF
 829 009b 4889C7   		movq	%rax, %rdi
 830 009e E8000000 		call	mbedtls_md_get_size@PLT
 830      00
 831              		.loc 4 512 12
 832 00a3 0FB6C0   		movzbl	%al, %eax
 833 00a6 48898518 		movq	%rax, -232(%rbp)
 833      FFFFFF
 513:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 51


 514:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( sizeof( tmp ) < md_len + strlen( label ) + rlen )
 834              		.loc 4 514 34
 835 00ad 488B85D0 		movq	-304(%rbp), %rax
 835      FEFFFF
 836 00b4 4889C7   		movq	%rax, %rdi
 837 00b7 E8000000 		call	strlen@PLT
 837      00
 838              		.loc 4 514 32
 839 00bc 488B9518 		movq	-232(%rbp), %rdx
 839      FFFFFF
 840 00c3 4801C2   		addq	%rax, %rdx
 841              		.loc 4 514 50
 842 00c6 488B85C0 		movq	-320(%rbp), %rax
 842      FEFFFF
 843 00cd 4801D0   		addq	%rdx, %rax
 844              		.loc 4 514 7
 845 00d0 483D8000 		cmpq	$128, %rax
 845      0000
 846 00d6 760A     		jbe	.L65
 515:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 847              		.loc 4 515 15
 848 00d8 B8008FFF 		movl	$-28928, %eax
 848      FF
 849 00dd E9BE0200 		jmp	.L73
 849      00
 850              	.L65:
 516:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 517:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     nb = strlen( label );
 851              		.loc 4 517 10
 852 00e2 488B85D0 		movq	-304(%rbp), %rax
 852      FEFFFF
 853 00e9 4889C7   		movq	%rax, %rdi
 854 00ec E8000000 		call	strlen@PLT
 854      00
 855 00f1 48898520 		movq	%rax, -224(%rbp)
 855      FFFFFF
 518:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( tmp + md_len, label, nb );
 856              		.loc 4 518 5
 857 00f8 488D9570 		leaq	-144(%rbp), %rdx
 857      FFFFFF
 858 00ff 488B8518 		movq	-232(%rbp), %rax
 858      FFFFFF
 859 0106 488D0C02 		leaq	(%rdx,%rax), %rcx
 860 010a 488B9520 		movq	-224(%rbp), %rdx
 860      FFFFFF
 861 0111 488B85D0 		movq	-304(%rbp), %rax
 861      FEFFFF
 862 0118 4889C6   		movq	%rax, %rsi
 863 011b 4889CF   		movq	%rcx, %rdi
 864 011e E8000000 		call	memcpy@PLT
 864      00
 519:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( tmp + md_len + nb, random, rlen );
 865              		.loc 4 519 26
 866 0123 488B9518 		movq	-232(%rbp), %rdx
 866      FFFFFF
 867 012a 488B8520 		movq	-224(%rbp), %rax
 867      FFFFFF
GAS LISTING /tmp/ccEn8xFO.s 			page 52


 868 0131 4801C2   		addq	%rax, %rdx
 869              		.loc 4 519 5
 870 0134 488D8570 		leaq	-144(%rbp), %rax
 870      FFFFFF
 871 013b 488D0C10 		leaq	(%rax,%rdx), %rcx
 872 013f 488B95C0 		movq	-320(%rbp), %rdx
 872      FEFFFF
 873 0146 488B85C8 		movq	-312(%rbp), %rax
 873      FEFFFF
 874 014d 4889C6   		movq	%rax, %rsi
 875 0150 4889CF   		movq	%rcx, %rdi
 876 0153 E8000000 		call	memcpy@PLT
 876      00
 520:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     nb += rlen;
 877              		.loc 4 520 8
 878 0158 488B85C0 		movq	-320(%rbp), %rax
 878      FEFFFF
 879 015f 48018520 		addq	%rax, -224(%rbp)
 879      FFFFFF
 521:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 522:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
 523:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Compute P_<hash>(secret, label + random)[0..dlen]
 524:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
 525:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if ( ( ret = mbedtls_md_setup( &md_ctx, md_info, 1 ) ) != 0 )
 880              		.loc 4 525 18
 881 0166 488B8D10 		movq	-240(%rbp), %rcx
 881      FFFFFF
 882 016d 488D8530 		leaq	-208(%rbp), %rax
 882      FFFFFF
 883 0174 BA010000 		movl	$1, %edx
 883      00
 884 0179 4889CE   		movq	%rcx, %rsi
 885 017c 4889C7   		movq	%rax, %rdi
 886 017f E8000000 		call	mbedtls_md_setup@PLT
 886      00
 887 0184 8985FCFE 		movl	%eax, -260(%rbp)
 887      FFFF
 888              		.loc 4 525 8
 889 018a 83BDFCFE 		cmpl	$0, -260(%rbp)
 889      FFFF00
 890 0191 740B     		je	.L66
 526:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 891              		.loc 4 526 15
 892 0193 8B85FCFE 		movl	-260(%rbp), %eax
 892      FFFF
 893 0199 E9020200 		jmp	.L73
 893      00
 894              	.L66:
 527:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 528:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_hmac_starts( &md_ctx, secret, slen );
 895              		.loc 4 528 5
 896 019e 488B95D8 		movq	-296(%rbp), %rdx
 896      FEFFFF
 897 01a5 488B8DE0 		movq	-288(%rbp), %rcx
 897      FEFFFF
 898 01ac 488D8530 		leaq	-208(%rbp), %rax
 898      FFFFFF
GAS LISTING /tmp/ccEn8xFO.s 			page 53


 899 01b3 4889CE   		movq	%rcx, %rsi
 900 01b6 4889C7   		movq	%rax, %rdi
 901 01b9 E8000000 		call	mbedtls_md_hmac_starts@PLT
 901      00
 529:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_hmac_update( &md_ctx, tmp + md_len, nb );
 902              		.loc 4 529 5
 903 01be 488D9570 		leaq	-144(%rbp), %rdx
 903      FFFFFF
 904 01c5 488B8518 		movq	-232(%rbp), %rax
 904      FFFFFF
 905 01cc 488D0C02 		leaq	(%rdx,%rax), %rcx
 906 01d0 488B9520 		movq	-224(%rbp), %rdx
 906      FFFFFF
 907 01d7 488D8530 		leaq	-208(%rbp), %rax
 907      FFFFFF
 908 01de 4889CE   		movq	%rcx, %rsi
 909 01e1 4889C7   		movq	%rax, %rdi
 910 01e4 E8000000 		call	mbedtls_md_hmac_update@PLT
 910      00
 530:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_hmac_finish( &md_ctx, tmp );
 911              		.loc 4 530 5
 912 01e9 488D9570 		leaq	-144(%rbp), %rdx
 912      FFFFFF
 913 01f0 488D8530 		leaq	-208(%rbp), %rax
 913      FFFFFF
 914 01f7 4889D6   		movq	%rdx, %rsi
 915 01fa 4889C7   		movq	%rax, %rdi
 916 01fd E8000000 		call	mbedtls_md_hmac_finish@PLT
 916      00
 531:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 532:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     for( i = 0; i < dlen; i += md_len )
 917              		.loc 4 532 12
 918 0202 48C78500 		movq	$0, -256(%rbp)
 918      FFFFFF00 
 918      000000
 919              		.loc 4 532 5
 920 020d E93E0100 		jmp	.L67
 920      00
 921              	.L72:
 533:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 534:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_md_hmac_reset ( &md_ctx );
 922              		.loc 4 534 9
 923 0212 488D8530 		leaq	-208(%rbp), %rax
 923      FFFFFF
 924 0219 4889C7   		movq	%rax, %rdi
 925 021c E8000000 		call	mbedtls_md_hmac_reset@PLT
 925      00
 535:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_md_hmac_update( &md_ctx, tmp, md_len + nb );
 926              		.loc 4 535 9
 927 0221 488B9518 		movq	-232(%rbp), %rdx
 927      FFFFFF
 928 0228 488B8520 		movq	-224(%rbp), %rax
 928      FFFFFF
 929 022f 4801C2   		addq	%rax, %rdx
 930 0232 488D8D70 		leaq	-144(%rbp), %rcx
 930      FFFFFF
 931 0239 488D8530 		leaq	-208(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 54


 931      FFFFFF
 932 0240 4889CE   		movq	%rcx, %rsi
 933 0243 4889C7   		movq	%rax, %rdi
 934 0246 E8000000 		call	mbedtls_md_hmac_update@PLT
 934      00
 536:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_md_hmac_finish( &md_ctx, h_i );
 935              		.loc 4 536 9
 936 024b 488D9550 		leaq	-176(%rbp), %rdx
 936      FFFFFF
 937 0252 488D8530 		leaq	-208(%rbp), %rax
 937      FFFFFF
 938 0259 4889D6   		movq	%rdx, %rsi
 939 025c 4889C7   		movq	%rax, %rdi
 940 025f E8000000 		call	mbedtls_md_hmac_finish@PLT
 940      00
 537:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 538:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_md_hmac_reset ( &md_ctx );
 941              		.loc 4 538 9
 942 0264 488D8530 		leaq	-208(%rbp), %rax
 942      FFFFFF
 943 026b 4889C7   		movq	%rax, %rdi
 944 026e E8000000 		call	mbedtls_md_hmac_reset@PLT
 944      00
 539:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_md_hmac_update( &md_ctx, tmp, md_len );
 945              		.loc 4 539 9
 946 0273 488B9518 		movq	-232(%rbp), %rdx
 946      FFFFFF
 947 027a 488D8D70 		leaq	-144(%rbp), %rcx
 947      FFFFFF
 948 0281 488D8530 		leaq	-208(%rbp), %rax
 948      FFFFFF
 949 0288 4889CE   		movq	%rcx, %rsi
 950 028b 4889C7   		movq	%rax, %rdi
 951 028e E8000000 		call	mbedtls_md_hmac_update@PLT
 951      00
 540:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_md_hmac_finish( &md_ctx, tmp );
 952              		.loc 4 540 9
 953 0293 488D9570 		leaq	-144(%rbp), %rdx
 953      FFFFFF
 954 029a 488D8530 		leaq	-208(%rbp), %rax
 954      FFFFFF
 955 02a1 4889D6   		movq	%rdx, %rsi
 956 02a4 4889C7   		movq	%rax, %rdi
 957 02a7 E8000000 		call	mbedtls_md_hmac_finish@PLT
 957      00
 541:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 542:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         k = ( i + md_len > dlen ) ? dlen % md_len : md_len;
 958              		.loc 4 542 17
 959 02ac 488B9500 		movq	-256(%rbp), %rdx
 959      FFFFFF
 960 02b3 488B8518 		movq	-232(%rbp), %rax
 960      FFFFFF
 961 02ba 4801D0   		addq	%rdx, %rax
 962              		.loc 4 542 51
 963 02bd 483985B0 		cmpq	%rax, -336(%rbp)
 963      FEFFFF
 964 02c4 7318     		jnb	.L68
GAS LISTING /tmp/ccEn8xFO.s 			page 55


 965              		.loc 4 542 51 is_stmt 0 discriminator 1
 966 02c6 488B85B0 		movq	-336(%rbp), %rax
 966      FEFFFF
 967 02cd BA000000 		movl	$0, %edx
 967      00
 968 02d2 48F7B518 		divq	-232(%rbp)
 968      FFFFFF
 969 02d9 4889D0   		movq	%rdx, %rax
 970 02dc EB07     		jmp	.L69
 971              	.L68:
 972              		.loc 4 542 51 discriminator 2
 973 02de 488B8518 		movq	-232(%rbp), %rax
 973      FFFFFF
 974              	.L69:
 975              		.loc 4 542 11 is_stmt 1 discriminator 4
 976 02e5 48898528 		movq	%rax, -216(%rbp)
 976      FFFFFF
 543:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 544:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         for( j = 0; j < k; j++ )
 977              		.loc 4 544 16 discriminator 4
 978 02ec 48C78508 		movq	$0, -248(%rbp)
 978      FFFFFF00 
 978      000000
 979              		.loc 4 544 9 discriminator 4
 980 02f7 EB39     		jmp	.L70
 981              	.L71:
 545:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             dstbuf[i + j]  = h_i[j];
 982              		.loc 4 545 22 discriminator 3
 983 02f9 488B9500 		movq	-256(%rbp), %rdx
 983      FFFFFF
 984 0300 488B8508 		movq	-248(%rbp), %rax
 984      FFFFFF
 985 0307 4801C2   		addq	%rax, %rdx
 986              		.loc 4 545 19 discriminator 3
 987 030a 488B85B8 		movq	-328(%rbp), %rax
 987      FEFFFF
 988 0311 4801C2   		addq	%rax, %rdx
 989              		.loc 4 545 33 discriminator 3
 990 0314 488D8D50 		leaq	-176(%rbp), %rcx
 990      FFFFFF
 991 031b 488B8508 		movq	-248(%rbp), %rax
 991      FFFFFF
 992 0322 4801C8   		addq	%rcx, %rax
 993 0325 0FB600   		movzbl	(%rax), %eax
 994              		.loc 4 545 28 discriminator 3
 995 0328 8802     		movb	%al, (%rdx)
 544:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             dstbuf[i + j]  = h_i[j];
 996              		.loc 4 544 29 discriminator 3
 997 032a 48838508 		addq	$1, -248(%rbp)
 997      FFFFFF01 
 998              	.L70:
 544:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             dstbuf[i + j]  = h_i[j];
 999              		.loc 4 544 9 discriminator 1
 1000 0332 488B8508 		movq	-248(%rbp), %rax
 1000      FFFFFF
 1001 0339 483B8528 		cmpq	-216(%rbp), %rax
 1001      FFFFFF
GAS LISTING /tmp/ccEn8xFO.s 			page 56


 1002 0340 72B7     		jb	.L71
 532:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 1003              		.loc 4 532 29 discriminator 2
 1004 0342 488B8518 		movq	-232(%rbp), %rax
 1004      FFFFFF
 1005 0349 48018500 		addq	%rax, -256(%rbp)
 1005      FFFFFF
 1006              	.L67:
 532:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 1007              		.loc 4 532 5 discriminator 1
 1008 0350 488B8500 		movq	-256(%rbp), %rax
 1008      FFFFFF
 1009 0357 483B85B0 		cmpq	-336(%rbp), %rax
 1009      FEFFFF
 1010 035e 0F82AEFE 		jb	.L72
 1010      FFFF
 546:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 547:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 548:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_free( &md_ctx );
 1011              		.loc 4 548 5
 1012 0364 488D8530 		leaq	-208(%rbp), %rax
 1012      FFFFFF
 1013 036b 4889C7   		movq	%rax, %rdi
 1014 036e E8000000 		call	mbedtls_md_free@PLT
 1014      00
 549:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 550:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_platform_zeroize( tmp, sizeof( tmp ) );
 1015              		.loc 4 550 5
 1016 0373 488D8570 		leaq	-144(%rbp), %rax
 1016      FFFFFF
 1017 037a BE800000 		movl	$128, %esi
 1017      00
 1018 037f 4889C7   		movq	%rax, %rdi
 1019 0382 E8000000 		call	mbedtls_platform_zeroize@PLT
 1019      00
 551:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_platform_zeroize( h_i, sizeof( h_i ) );
 1020              		.loc 4 551 5
 1021 0387 488D8550 		leaq	-176(%rbp), %rax
 1021      FFFFFF
 1022 038e BE200000 		movl	$32, %esi
 1022      00
 1023 0393 4889C7   		movq	%rax, %rdi
 1024 0396 E8000000 		call	mbedtls_platform_zeroize@PLT
 1024      00
 552:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 553:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 1025              		.loc 4 553 11
 1026 039b B8000000 		movl	$0, %eax
 1026      00
 1027              	.L73:
 554:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 1028              		.loc 4 554 1 discriminator 1
 1029 03a0 488B75F8 		movq	-8(%rbp), %rsi
 1030 03a4 64483334 		xorq	%fs:40, %rsi
 1030      25280000 
 1030      00
 1031 03ad 7405     		je	.L74
GAS LISTING /tmp/ccEn8xFO.s 			page 57


 1032              		.loc 4 554 1 is_stmt 0
 1033 03af E8000000 		call	__stack_chk_fail@PLT
 1033      00
 1034              	.L74:
 1035 03b4 C9       		leave
 1036              	.LCFI41:
 1037              		.cfi_def_cfa 7, 8
 1038 03b5 C3       		ret
 1039              		.cfi_endproc
 1040              	.LFE32:
 1042              		.section	.text.tls_prf_sha256,"ax",@progbits
 1044              	tls_prf_sha256:
 1045              	.LFB33:
 555:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 556:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
 557:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int tls_prf_sha256( const unsigned char *secret, size_t slen,
 558:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            const char *label,
 559:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            const unsigned char *random, size_t rlen,
 560:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            unsigned char *dstbuf, size_t dlen )
 561:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 1046              		.loc 4 561 1 is_stmt 1
 1047              		.cfi_startproc
 1048 0000 F30F1EFA 		endbr64
 1049 0004 55       		pushq	%rbp
 1050              	.LCFI42:
 1051              		.cfi_def_cfa_offset 16
 1052              		.cfi_offset 6, -16
 1053 0005 4889E5   		movq	%rsp, %rbp
 1054              	.LCFI43:
 1055              		.cfi_def_cfa_register 6
 1056 0008 4883EC50 		subq	$80, %rsp
 1057 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1058 0010 488975E0 		movq	%rsi, -32(%rbp)
 1059 0014 488955D8 		movq	%rdx, -40(%rbp)
 1060 0018 48894DD0 		movq	%rcx, -48(%rbp)
 1061 001c 4C8945C8 		movq	%r8, -56(%rbp)
 1062 0020 4C894DC0 		movq	%r9, -64(%rbp)
 1063 0024 488B4510 		movq	16(%rbp), %rax
 1064 0028 488945B8 		movq	%rax, -72(%rbp)
 1065              		.loc 4 561 1
 1066 002c 64488B04 		movq	%fs:40, %rax
 1066      25280000 
 1066      00
 1067 0035 488945F8 		movq	%rax, -8(%rbp)
 1068 0039 31C0     		xorl	%eax, %eax
 562:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( tls_prf_generic( MBEDTLS_MD_SHA256, secret, slen,
 1069              		.loc 4 562 13
 1070 003b 488B7DC8 		movq	-56(%rbp), %rdi
 1071 003f 488B75D0 		movq	-48(%rbp), %rsi
 1072 0043 488B4DD8 		movq	-40(%rbp), %rcx
 1073 0047 488B55E0 		movq	-32(%rbp), %rdx
 1074 004b 488B45E8 		movq	-24(%rbp), %rax
 1075 004f FF75B8   		pushq	-72(%rbp)
 1076 0052 FF75C0   		pushq	-64(%rbp)
 1077 0055 4989F9   		movq	%rdi, %r9
 1078 0058 4989F0   		movq	%rsi, %r8
 1079 005b 4889C6   		movq	%rax, %rsi
GAS LISTING /tmp/ccEn8xFO.s 			page 58


 1080 005e BF060000 		movl	$6, %edi
 1080      00
 1081 0063 E8000000 		call	tls_prf_generic
 1081      00
 1082 0068 4883C410 		addq	$16, %rsp
 563:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                              label, random, rlen, dstbuf, dlen ) );
 564:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 1083              		.loc 4 564 1
 1084 006c 488B55F8 		movq	-8(%rbp), %rdx
 1085 0070 64483314 		xorq	%fs:40, %rdx
 1085      25280000 
 1085      00
 1086 0079 7405     		je	.L77
 1087 007b E8000000 		call	__stack_chk_fail@PLT
 1087      00
 1088              	.L77:
 1089 0080 C9       		leave
 1090              	.LCFI44:
 1091              		.cfi_def_cfa 7, 8
 1092 0081 C3       		ret
 1093              		.cfi_endproc
 1094              	.LFE33:
 1096              		.section	.rodata
 1097              	.LC0:
 1098 0000 65787465 		.string	"extended master secret"
 1098      6E646564 
 1098      206D6173 
 1098      74657220 
 1098      73656372 
 1099              	.LC1:
 1100 0017 6D617374 		.string	"master secret"
 1100      65722073 
 1100      65637265 
 1100      7400
 1101              	.LC2:
 1102 0025 6B657920 		.string	"key expansion"
 1102      65787061 
 1102      6E73696F 
 1102      6E00
 1103              		.section	.text.mbedtls_ssl_derive_keys,"ax",@progbits
 1104              		.globl	mbedtls_ssl_derive_keys
 1106              	mbedtls_ssl_derive_keys:
 1107              	.LFB34:
 565:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SHA256_C */
 566:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 567:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
 568:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int tls_prf_sha384( const unsigned char *secret, size_t slen,
 569:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            const char *label,
 570:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            const unsigned char *random, size_t rlen,
 571:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            unsigned char *dstbuf, size_t dlen )
 572:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 573:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( tls_prf_generic( MBEDTLS_MD_SHA384, secret, slen,
 574:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                              label, random, rlen, dstbuf, dlen ) );
 575:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 576:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SHA512_C */
 577:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
 578:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 59


 579:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_update_checksum_start( mbedtls_ssl_context *, const unsigned char *, size_t );
 580:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 581:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1) || \
 582:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_1)
 583:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_update_checksum_md5sha1( mbedtls_ssl_context *, const unsigned char *, size_t );
 584:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
 585:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 586:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
 587:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_calc_verify_ssl( mbedtls_ssl_context *, unsigned char * );
 588:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_calc_finished_ssl( mbedtls_ssl_context *, unsigned char *, int );
 589:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
 590:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 591:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1)
 592:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_calc_verify_tls( mbedtls_ssl_context *, unsigned char * );
 593:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_calc_finished_tls( mbedtls_ssl_context *, unsigned char *, int );
 594:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
 595:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 596:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
 597:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
 598:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_update_checksum_sha256( mbedtls_ssl_context *, const unsigned char *, size_t );
 599:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_calc_verify_tls_sha256( mbedtls_ssl_context *,unsigned char * );
 600:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_calc_finished_tls_sha256( mbedtls_ssl_context *,unsigned char *, int );
 601:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
 602:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 603:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
 604:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_update_checksum_sha384( mbedtls_ssl_context *, const unsigned char *, size_t );
 605:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_calc_verify_tls_sha384( mbedtls_ssl_context *, unsigned char * );
 606:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_calc_finished_tls_sha384( mbedtls_ssl_context *, unsigned char *, int );
 607:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
 608:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
 609:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 610:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_derive_keys( mbedtls_ssl_context *ssl )
 611:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 1108              		.loc 4 611 1
 1109              		.cfi_startproc
 1110 0000 F30F1EFA 		endbr64
 1111 0004 55       		pushq	%rbp
 1112              	.LCFI45:
 1113              		.cfi_def_cfa_offset 16
 1114              		.cfi_offset 6, -16
 1115 0005 4889E5   		movq	%rsp, %rbp
 1116              	.LCFI46:
 1117              		.cfi_def_cfa_register 6
 1118 0008 53       		pushq	%rbx
 1119 0009 4881ECE8 		subq	$488, %rsp
 1119      010000
 1120              		.cfi_offset 3, -24
 1121 0010 4889BD18 		movq	%rdi, -488(%rbp)
 1121      FEFFFF
 1122              		.loc 4 611 1
 1123 0017 64488B04 		movq	%fs:40, %rax
 1123      25280000 
 1123      00
 1124 0020 488945E8 		movq	%rax, -24(%rbp)
 1125 0024 31C0     		xorl	%eax, %eax
 612:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret = 0;
 1126              		.loc 4 612 9
GAS LISTING /tmp/ccEn8xFO.s 			page 60


 1127 0026 C7852CFE 		movl	$0, -468(%rbp)
 1127      FFFF0000 
 1127      0000
 613:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char tmp[64];
 614:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char keyblk[256];
 615:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char *key1;
 616:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char *key2;
 617:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char *mac_enc;
 618:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char *mac_dec;
 619:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t mac_key_len;
 620:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t iv_copy_len;
 621:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const mbedtls_cipher_info_t *cipher_info;
 622:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const mbedtls_md_info_t *md_info;
 623:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 624:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_session *session = ssl->session_negotiate;
 1128              		.loc 4 624 26
 1129 0030 488B8518 		movq	-488(%rbp), %rax
 1129      FEFFFF
 1130 0037 488B4058 		movq	88(%rax), %rax
 1131 003b 48898540 		movq	%rax, -448(%rbp)
 1131      FEFFFF
 625:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_transform *transform = ssl->transform_negotiate;
 1132              		.loc 4 625 28
 1133 0042 488B8518 		movq	-488(%rbp), %rax
 1133      FEFFFF
 1134 0049 488B8080 		movq	128(%rax), %rax
 1134      000000
 1135 0050 48898548 		movq	%rax, -440(%rbp)
 1135      FEFFFF
 626:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_handshake_params *handshake = ssl->handshake;
 1136              		.loc 4 626 35
 1137 0057 488B8518 		movq	-488(%rbp), %rax
 1137      FEFFFF
 1138 005e 488B4060 		movq	96(%rax), %rax
 1139 0062 48898550 		movq	%rax, -432(%rbp)
 1139      FEFFFF
 627:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 628:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> derive keys" ) );
 629:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 630:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     cipher_info = mbedtls_cipher_info_from_type( transform->ciphersuite_info->cipher );
 1140              		.loc 4 630 59
 1141 0069 488B8548 		movq	-440(%rbp), %rax
 1141      FEFFFF
 1142 0070 488B00   		movq	(%rax), %rax
 1143              		.loc 4 630 19
 1144 0073 8B4010   		movl	16(%rax), %eax
 1145 0076 89C7     		movl	%eax, %edi
 1146 0078 E8000000 		call	mbedtls_cipher_info_from_type@PLT
 1146      00
 1147 007d 48898558 		movq	%rax, -424(%rbp)
 1147      FEFFFF
 631:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( cipher_info == NULL )
 1148              		.loc 4 631 7
 1149 0084 4883BD58 		cmpq	$0, -424(%rbp)
 1149      FEFFFF00 
 1150 008c 750A     		jne	.L79
 632:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
GAS LISTING /tmp/ccEn8xFO.s 			page 61


 633:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "cipher info for %d not found",
 634:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             transform->ciphersuite_info->cipher ) );
 635:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 1151              		.loc 4 635 15
 1152 008e B8008FFF 		movl	$-28928, %eax
 1152      FF
 1153 0093 E9890900 		jmp	.L117
 1153      00
 1154              	.L79:
 636:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 637:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 638:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     md_info = mbedtls_md_info_from_type( transform->ciphersuite_info->mac );
 1155              		.loc 4 638 51
 1156 0098 488B8548 		movq	-440(%rbp), %rax
 1156      FEFFFF
 1157 009f 488B00   		movq	(%rax), %rax
 1158              		.loc 4 638 15
 1159 00a2 8B4014   		movl	20(%rax), %eax
 1160 00a5 89C7     		movl	%eax, %edi
 1161 00a7 E8000000 		call	mbedtls_md_info_from_type@PLT
 1161      00
 1162 00ac 48898560 		movq	%rax, -416(%rbp)
 1162      FEFFFF
 639:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( md_info == NULL )
 1163              		.loc 4 639 7
 1164 00b3 4883BD60 		cmpq	$0, -416(%rbp)
 1164      FEFFFF00 
 1165 00bb 750A     		jne	.L81
 640:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 641:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "mbedtls_md info for %d not found",
 642:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             transform->ciphersuite_info->mac ) );
 643:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 1166              		.loc 4 643 15
 1167 00bd B8008FFF 		movl	$-28928, %eax
 1167      FF
 1168 00c2 E95A0900 		jmp	.L117
 1168      00
 1169              	.L81:
 644:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 645:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 646:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
 647:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Set appropriate PRF function and other SSL / TLS / TLS1.2 functions
 648:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
 649:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
 650:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 )
 651:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 652:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         handshake->tls_prf = ssl3_prf;
 653:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         handshake->calc_verify = ssl_calc_verify_ssl;
 654:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         handshake->calc_finished = ssl_calc_finished_ssl;
 655:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 656:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
 657:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
 658:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1)
 659:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->minor_ver < MBEDTLS_SSL_MINOR_VERSION_3 )
 660:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 661:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         handshake->tls_prf = tls1_prf;
 662:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         handshake->calc_verify = ssl_calc_verify_tls;
GAS LISTING /tmp/ccEn8xFO.s 			page 62


 663:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         handshake->calc_finished = ssl_calc_finished_tls;
 664:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 665:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
 666:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
 667:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
 668:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
 669:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_3 &&
 670:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         transform->ciphersuite_info->mac == MBEDTLS_MD_SHA384 )
 671:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 672:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         handshake->tls_prf = tls_prf_sha384;
 673:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         handshake->calc_verify = ssl_calc_verify_tls_sha384;
 674:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         handshake->calc_finished = ssl_calc_finished_tls_sha384;
 675:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 676:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
 677:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
 678:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
 679:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_3 )
 1170              		.loc 4 679 12
 1171 00c7 488B8518 		movq	-488(%rbp), %rax
 1171      FEFFFF
 1172 00ce 8B4018   		movl	24(%rax), %eax
 1173              		.loc 4 679 7
 1174 00d1 83F803   		cmpl	$3, %eax
 1175 00d4 7556     		jne	.L82
 680:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 681:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         handshake->tls_prf = tls_prf_sha256;
 1176              		.loc 4 681 28
 1177 00d6 488B8550 		movq	-432(%rbp), %rax
 1177      FEFFFF
 1178 00dd 488D1500 		leaq	tls_prf_sha256(%rip), %rdx
 1178      000000
 1179 00e4 48899008 		movq	%rdx, 776(%rax)
 1179      030000
 682:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         handshake->calc_verify = ssl_calc_verify_tls_sha256;
 1180              		.loc 4 682 32
 1181 00eb 488B8550 		movq	-432(%rbp), %rax
 1181      FEFFFF
 1182 00f2 488D1500 		leaq	ssl_calc_verify_tls_sha256(%rip), %rdx
 1182      000000
 1183 00f9 488990F8 		movq	%rdx, 760(%rax)
 1183      020000
 683:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         handshake->calc_finished = ssl_calc_finished_tls_sha256;
 1184              		.loc 4 683 34
 1185 0100 488B8550 		movq	-432(%rbp), %rax
 1185      FEFFFF
 1186 0107 488D1500 		leaq	ssl_calc_finished_tls_sha256(%rip), %rdx
 1186      000000
 1187 010e 48899000 		movq	%rdx, 768(%rax)
 1187      030000
 684:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 685:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
 686:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
 687:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
 688:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 689:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
 690:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 691:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
GAS LISTING /tmp/ccEn8xFO.s 			page 63


 692:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 693:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
 694:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * SSLv3:
 695:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *   master =
 696:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     MD5( premaster + SHA1( 'A'   + premaster + randbytes ) ) +
 697:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     MD5( premaster + SHA1( 'BB'  + premaster + randbytes ) ) +
 698:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     MD5( premaster + SHA1( 'CCC' + premaster + randbytes ) )
 699:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *
 700:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * TLSv1+:
 701:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *   master = PRF( premaster, "master secret", randbytes )[0..47]
 702:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
 703:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( handshake->resume == 0 )
 1188              		.loc 4 703 18
 1189 0115 488B8550 		movq	-432(%rbp), %rax
 1189      FEFFFF
 1190 011c 8B809C03 		movl	924(%rax), %eax
 1190      0000
 1191              		.loc 4 703 7
 1192 0122 85C0     		testl	%eax, %eax
 1193 0124 0F858C01 		jne	.L84
 1193      0000
 1194 012a EB0A     		jmp	.L119
 1195              	.L82:
 690:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 1196              		.loc 4 690 15
 1197 012c B80094FF 		movl	$-27648, %eax
 1197      FF
 1198 0131 E9EB0800 		jmp	.L117
 1198      00
 1199              	.L119:
 704:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 705:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 3, "premaster secret", handshake->premaster,
 706:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                        handshake->pmslen );
 707:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 708:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_EXTENDED_MASTER_SECRET)
 709:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->handshake->extended_ms == MBEDTLS_SSL_EXTENDED_MS_ENABLED )
 1200              		.loc 4 709 16
 1201 0136 488B8518 		movq	-488(%rbp), %rax
 1201      FEFFFF
 1202 013d 488B4060 		movq	96(%rax), %rax
 1203              		.loc 4 709 27
 1204 0141 8B80B003 		movl	944(%rax), %eax
 1204      0000
 1205              		.loc 4 709 11
 1206 0147 83F801   		cmpl	$1, %eax
 1207 014a 0F85CC00 		jne	.L85
 1207      0000
 1208              	.LBB4:
 710:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
 711:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             unsigned char session_hash[48];
 712:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             size_t hash_len;
 713:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 714:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "using extended master secret" ) );
 715:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 716:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->handshake->calc_verify( ssl, session_hash );
 1209              		.loc 4 716 16
 1210 0150 488B8518 		movq	-488(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 64


 1210      FEFFFF
 1211 0157 488B4060 		movq	96(%rax), %rax
 1212              		.loc 4 716 27
 1213 015b 488B88F8 		movq	760(%rax), %rcx
 1213      020000
 1214              		.loc 4 716 13
 1215 0162 488D95E0 		leaq	-288(%rbp), %rdx
 1215      FEFFFF
 1216 0169 488B8518 		movq	-488(%rbp), %rax
 1216      FEFFFF
 1217 0170 4889D6   		movq	%rdx, %rsi
 1218 0173 4889C7   		movq	%rax, %rdi
 1219 0176 FFD1     		call	*%rcx
 1220              	.LVL2:
 717:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 718:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
 719:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_3 )
 1221              		.loc 4 719 20
 1222 0178 488B8518 		movq	-488(%rbp), %rax
 1222      FEFFFF
 1223 017f 8B4018   		movl	24(%rax), %eax
 1224              		.loc 4 719 15
 1225 0182 83F803   		cmpl	$3, %eax
 1226 0185 750D     		jne	.L86
 720:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
 721:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
 722:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( ssl->transform_negotiate->ciphersuite_info->mac ==
 723:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     MBEDTLS_MD_SHA384 )
 724:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
 725:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     hash_len = 48;
 726:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
 727:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 else
 728:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
 729:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     hash_len = 32;
 1227              		.loc 4 729 30
 1228 0187 48C78538 		movq	$32, -456(%rbp)
 1228      FEFFFF20 
 1228      000000
 1229 0192 EB0B     		jmp	.L87
 1230              	.L86:
 730:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
 731:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else
 732:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
 733:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 hash_len = 36;
 1231              		.loc 4 733 26
 1232 0194 48C78538 		movq	$36, -456(%rbp)
 1232      FEFFFF24 
 1232      000000
 1233              	.L87:
 734:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 735:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_BUF( 3, "session hash", session_hash, hash_len );
 736:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 737:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ret = handshake->tls_prf( handshake->premaster, handshake->pmslen,
 1234              		.loc 4 737 28
 1235 019f 488B8550 		movq	-432(%rbp), %rax
 1235      FEFFFF
 1236 01a6 4C8B9008 		movq	776(%rax), %r10
GAS LISTING /tmp/ccEn8xFO.s 			page 65


 1236      030000
 738:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                       "extended master secret",
 739:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                       session_hash, hash_len,
 740:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                       session->master, 48 );
 1237              		.loc 4 740 46
 1238 01ad 488B8540 		movq	-448(%rbp), %rax
 1238      FEFFFF
 1239 01b4 488D7030 		leaq	48(%rax), %rsi
 737:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                       "extended master secret",
 1240              		.loc 4 737 19
 1241 01b8 488B8550 		movq	-432(%rbp), %rax
 1241      FEFFFF
 1242 01bf 488B8010 		movq	784(%rax), %rax
 1242      030000
 737:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                       "extended master secret",
 1243              		.loc 4 737 48
 1244 01c6 488B9550 		movq	-432(%rbp), %rdx
 1244      FEFFFF
 1245 01cd 488DBA58 		leaq	856(%rdx), %rdi
 1245      030000
 737:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                       "extended master secret",
 1246              		.loc 4 737 19
 1247 01d4 488B8D38 		movq	-456(%rbp), %rcx
 1247      FEFFFF
 1248 01db 488D95E0 		leaq	-288(%rbp), %rdx
 1248      FEFFFF
 1249 01e2 4883EC08 		subq	$8, %rsp
 1250 01e6 6A30     		pushq	$48
 1251 01e8 4989F1   		movq	%rsi, %r9
 1252 01eb 4989C8   		movq	%rcx, %r8
 1253 01ee 4889D1   		movq	%rdx, %rcx
 1254 01f1 488D1500 		leaq	.LC0(%rip), %rdx
 1254      000000
 1255 01f8 4889C6   		movq	%rax, %rsi
 1256 01fb 41FFD2   		call	*%r10
 1257              	.LVL3:
 1258 01fe 4883C410 		addq	$16, %rsp
 1259 0202 89852CFE 		movl	%eax, -468(%rbp)
 1259      FFFF
 741:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ret != 0 )
 1260              		.loc 4 741 15
 1261 0208 83BD2CFE 		cmpl	$0, -468(%rbp)
 1261      FFFF00
 1262 020f 7477     		je	.L89
 742:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
 743:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_RET( 1, "prf", ret );
 744:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( ret );
 1263              		.loc 4 744 23
 1264 0211 8B852CFE 		movl	-468(%rbp), %eax
 1264      FFFF
 1265 0217 E9050800 		jmp	.L117
 1265      00
 1266              	.L85:
 1267              	.LBE4:
 745:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
 746:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 747:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
GAS LISTING /tmp/ccEn8xFO.s 			page 66


 748:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else
 749:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
 750:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ret = handshake->tls_prf( handshake->premaster, handshake->pmslen,
 1268              		.loc 4 750 24
 1269 021c 488B8550 		movq	-432(%rbp), %rax
 1269      FEFFFF
 1270 0223 4C8B9008 		movq	776(%rax), %r10
 1270      030000
 751:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   "master secret",
 752:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   handshake->randbytes, 64,
 753:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   session->master, 48 );
 1271              		.loc 4 753 42
 1272 022a 488B8540 		movq	-448(%rbp), %rax
 1272      FEFFFF
 1273 0231 488D7030 		leaq	48(%rax), %rsi
 752:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   session->master, 48 );
 1274              		.loc 4 752 44
 1275 0235 488B8550 		movq	-432(%rbp), %rax
 1275      FEFFFF
 1276 023c 488D9018 		leaq	792(%rax), %rdx
 1276      030000
 750:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   "master secret",
 1277              		.loc 4 750 15
 1278 0243 488B8550 		movq	-432(%rbp), %rax
 1278      FEFFFF
 1279 024a 488B8010 		movq	784(%rax), %rax
 1279      030000
 750:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   "master secret",
 1280              		.loc 4 750 44
 1281 0251 488B8D50 		movq	-432(%rbp), %rcx
 1281      FEFFFF
 1282 0258 488DB958 		leaq	856(%rcx), %rdi
 1282      030000
 750:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   "master secret",
 1283              		.loc 4 750 15
 1284 025f 4883EC08 		subq	$8, %rsp
 1285 0263 6A30     		pushq	$48
 1286 0265 4989F1   		movq	%rsi, %r9
 1287 0268 41B84000 		movl	$64, %r8d
 1287      0000
 1288 026e 4889D1   		movq	%rdx, %rcx
 1289 0271 488D1500 		leaq	.LC1(%rip), %rdx
 1289      000000
 1290 0278 4889C6   		movq	%rax, %rsi
 1291 027b 41FFD2   		call	*%r10
 1292              	.LVL4:
 1293 027e 4883C410 		addq	$16, %rsp
 1294 0282 89852CFE 		movl	%eax, -468(%rbp)
 1294      FFFF
 1295              	.L89:
 754:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ret != 0 )
 1296              		.loc 4 754 11
 1297 0288 83BD2CFE 		cmpl	$0, -468(%rbp)
 1297      FFFF00
 1298 028f 740B     		je	.L90
 755:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
 756:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "prf", ret );
GAS LISTING /tmp/ccEn8xFO.s 			page 67


 757:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 1299              		.loc 4 757 19
 1300 0291 8B852CFE 		movl	-468(%rbp), %eax
 1300      FFFF
 1301 0297 E9850700 		jmp	.L117
 1301      00
 1302              	.L90:
 758:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
 759:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 760:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_platform_zeroize( handshake->premaster,
 1303              		.loc 4 760 44
 1304 029c 488B8550 		movq	-432(%rbp), %rax
 1304      FEFFFF
 1305 02a3 48055803 		addq	$856, %rax
 1305      0000
 1306              		.loc 4 760 9
 1307 02a9 BE420000 		movl	$66, %esi
 1307      00
 1308 02ae 4889C7   		movq	%rax, %rdi
 1309 02b1 E8000000 		call	mbedtls_platform_zeroize@PLT
 1309      00
 1310              	.L84:
 761:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   sizeof(handshake->premaster) );
 762:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 763:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
 764:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "no premaster (session resumed)" ) );
 765:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 766:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
 767:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Swap the client and server random values.
 768:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
 769:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( tmp, handshake->randbytes, 64 );
 1311              		.loc 4 769 27
 1312 02b6 488B8550 		movq	-432(%rbp), %rax
 1312      FEFFFF
 1313 02bd 48051803 		addq	$792, %rax
 1313      0000
 1314              		.loc 4 769 5
 1315 02c3 488B08   		movq	(%rax), %rcx
 1316 02c6 488B5808 		movq	8(%rax), %rbx
 1317 02ca 48898DA0 		movq	%rcx, -352(%rbp)
 1317      FEFFFF
 1318 02d1 48899DA8 		movq	%rbx, -344(%rbp)
 1318      FEFFFF
 1319 02d8 488B4810 		movq	16(%rax), %rcx
 1320 02dc 488B5818 		movq	24(%rax), %rbx
 1321 02e0 48898DB0 		movq	%rcx, -336(%rbp)
 1321      FEFFFF
 1322 02e7 48899DB8 		movq	%rbx, -328(%rbp)
 1322      FEFFFF
 1323 02ee 488B4820 		movq	32(%rax), %rcx
 1324 02f2 488B5828 		movq	40(%rax), %rbx
 1325 02f6 48898DC0 		movq	%rcx, -320(%rbp)
 1325      FEFFFF
 1326 02fd 48899DC8 		movq	%rbx, -312(%rbp)
 1326      FEFFFF
 1327 0304 488B5038 		movq	56(%rax), %rdx
 1328 0308 488B4030 		movq	48(%rax), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 68


 1329 030c 488985D0 		movq	%rax, -304(%rbp)
 1329      FEFFFF
 1330 0313 488995D8 		movq	%rdx, -296(%rbp)
 1330      FEFFFF
 770:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( handshake->randbytes, tmp + 32, 32 );
 1331              		.loc 4 770 5
 1332 031a 488D85A0 		leaq	-352(%rbp), %rax
 1332      FEFFFF
 1333 0321 4883C020 		addq	$32, %rax
 1334              		.loc 4 770 22
 1335 0325 488B9550 		movq	-432(%rbp), %rdx
 1335      FEFFFF
 1336 032c 488D8A18 		leaq	792(%rdx), %rcx
 1336      030000
 1337              		.loc 4 770 5
 1338 0333 BA200000 		movl	$32, %edx
 1338      00
 1339 0338 4889C6   		movq	%rax, %rsi
 1340 033b 4889CF   		movq	%rcx, %rdi
 1341 033e E8000000 		call	memcpy@PLT
 1341      00
 771:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( handshake->randbytes + 32, tmp, 32 );
 1342              		.loc 4 771 13
 1343 0343 488B8550 		movq	-432(%rbp), %rax
 1343      FEFFFF
 1344 034a 48051803 		addq	$792, %rax
 1344      0000
 1345              		.loc 4 771 5
 1346 0350 488D4820 		leaq	32(%rax), %rcx
 1347 0354 488D85A0 		leaq	-352(%rbp), %rax
 1347      FEFFFF
 1348 035b BA200000 		movl	$32, %edx
 1348      00
 1349 0360 4889C6   		movq	%rax, %rsi
 1350 0363 4889CF   		movq	%rcx, %rdi
 1351 0366 E8000000 		call	memcpy@PLT
 1351      00
 772:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_platform_zeroize( tmp, sizeof( tmp ) );
 1352              		.loc 4 772 5
 1353 036b 488D85A0 		leaq	-352(%rbp), %rax
 1353      FEFFFF
 1354 0372 BE400000 		movl	$64, %esi
 1354      00
 1355 0377 4889C7   		movq	%rax, %rdi
 1356 037a E8000000 		call	mbedtls_platform_zeroize@PLT
 1356      00
 773:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 774:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
 775:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *  SSLv3:
 776:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *    key block =
 777:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *      MD5( master + SHA1( 'A'    + master + randbytes ) ) +
 778:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *      MD5( master + SHA1( 'BB'   + master + randbytes ) ) +
 779:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *      MD5( master + SHA1( 'CCC'  + master + randbytes ) ) +
 780:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *      MD5( master + SHA1( 'DDDD' + master + randbytes ) ) +
 781:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *      ...
 782:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *
 783:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *  TLSv1:
GAS LISTING /tmp/ccEn8xFO.s 			page 69


 784:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *    key block = PRF( master, "key expansion", randbytes )
 785:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
 786:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ret = handshake->tls_prf( session->master, 48, "key expansion",
 1357              		.loc 4 786 20
 1358 037f 488B8550 		movq	-432(%rbp), %rax
 1358      FEFFFF
 1359 0386 488B8008 		movq	776(%rax), %rax
 1359      030000
 787:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                               handshake->randbytes, 64, keyblk, 256 );
 1360              		.loc 4 787 40
 1361 038d 488B9550 		movq	-432(%rbp), %rdx
 1361      FEFFFF
 1362 0394 4881C218 		addq	$792, %rdx
 1362      030000
 786:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                               handshake->randbytes, 64, keyblk, 256 );
 1363              		.loc 4 786 38
 1364 039b 488B8D40 		movq	-448(%rbp), %rcx
 1364      FEFFFF
 1365 03a2 488D7930 		leaq	48(%rcx), %rdi
 786:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                               handshake->randbytes, 64, keyblk, 256 );
 1366              		.loc 4 786 11
 1367 03a6 488D8DE0 		leaq	-288(%rbp), %rcx
 1367      FEFFFF
 1368 03ad 4883EC08 		subq	$8, %rsp
 1369 03b1 68000100 		pushq	$256
 1369      00
 1370 03b6 4989C9   		movq	%rcx, %r9
 1371 03b9 41B84000 		movl	$64, %r8d
 1371      0000
 1372 03bf 4889D1   		movq	%rdx, %rcx
 1373 03c2 488D1500 		leaq	.LC2(%rip), %rdx
 1373      000000
 1374 03c9 BE300000 		movl	$48, %esi
 1374      00
 1375 03ce FFD0     		call	*%rax
 1376              	.LVL5:
 1377 03d0 4883C410 		addq	$16, %rsp
 1378 03d4 89852CFE 		movl	%eax, -468(%rbp)
 1378      FFFF
 788:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ret != 0 )
 1379              		.loc 4 788 7
 1380 03da 83BD2CFE 		cmpl	$0, -468(%rbp)
 1380      FFFF00
 1381 03e1 740B     		je	.L91
 789:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 790:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "prf", ret );
 791:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 1382              		.loc 4 791 15
 1383 03e3 8B852CFE 		movl	-468(%rbp), %eax
 1383      FFFF
 1384 03e9 E9330600 		jmp	.L117
 1384      00
 1385              	.L91:
 792:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 793:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 794:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "ciphersuite = %s",
 795:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                    mbedtls_ssl_get_ciphersuite_name( session->ciphersuite ) ) );
GAS LISTING /tmp/ccEn8xFO.s 			page 70


 796:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "master secret", session->master, 48 );
 797:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "random bytes", handshake->randbytes, 64 );
 798:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "key block", keyblk, 256 );
 799:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 800:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_platform_zeroize( handshake->randbytes,
 1386              		.loc 4 800 40
 1387 03ee 488B8550 		movq	-432(%rbp), %rax
 1387      FEFFFF
 1388 03f5 48051803 		addq	$792, %rax
 1388      0000
 1389              		.loc 4 800 5
 1390 03fb BE400000 		movl	$64, %esi
 1390      00
 1391 0400 4889C7   		movq	%rax, %rdi
 1392 0403 E8000000 		call	mbedtls_platform_zeroize@PLT
 1392      00
 801:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                               sizeof( handshake->randbytes ) );
 802:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 803:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
 804:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Determine the appropriate key, IV and MAC length.
 805:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
 806:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 807:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     transform->keylen = cipher_info->key_bitlen / 8;
 1393              		.loc 4 807 36
 1394 0408 488B8558 		movq	-424(%rbp), %rax
 1394      FEFFFF
 1395 040f 8B4008   		movl	8(%rax), %eax
 1396              		.loc 4 807 49
 1397 0412 C1E803   		shrl	$3, %eax
 1398 0415 89C2     		movl	%eax, %edx
 1399              		.loc 4 807 23
 1400 0417 488B8548 		movq	-440(%rbp), %rax
 1400      FEFFFF
 1401 041e 895008   		movl	%edx, 8(%rax)
 808:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 809:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( cipher_info->mode == MBEDTLS_MODE_GCM ||
 1402              		.loc 4 809 20
 1403 0421 488B8558 		movq	-424(%rbp), %rax
 1403      FEFFFF
 1404 0428 8B4004   		movl	4(%rax), %eax
 1405              		.loc 4 809 7
 1406 042b 83F806   		cmpl	$6, %eax
 1407 042e 7422     		je	.L92
 810:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         cipher_info->mode == MBEDTLS_MODE_CCM ||
 1408              		.loc 4 810 20 discriminator 1
 1409 0430 488B8558 		movq	-424(%rbp), %rax
 1409      FEFFFF
 1410 0437 8B4004   		movl	4(%rax), %eax
 809:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         cipher_info->mode == MBEDTLS_MODE_CCM ||
 1411              		.loc 4 809 47 discriminator 1
 1412 043a 83F808   		cmpl	$8, %eax
 1413 043d 7413     		je	.L92
 811:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         cipher_info->mode == MBEDTLS_MODE_CHACHAPOLY )
 1414              		.loc 4 811 20
 1415 043f 488B8558 		movq	-424(%rbp), %rax
 1415      FEFFFF
 1416 0446 8B4004   		movl	4(%rax), %eax
GAS LISTING /tmp/ccEn8xFO.s 			page 71


 810:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         cipher_info->mode == MBEDTLS_MODE_CCM ||
 1417              		.loc 4 810 47
 1418 0449 83F80A   		cmpl	$10, %eax
 1419 044c 0F85C700 		jne	.L93
 1419      0000
 1420              	.L92:
 1421              	.LBB5:
 812:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 813:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         size_t taglen, explicit_ivlen;
 814:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 815:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         transform->maclen = 0;
 1422              		.loc 4 815 27
 1423 0452 488B8548 		movq	-440(%rbp), %rax
 1423      FEFFFF
 1424 0459 48C74028 		movq	$0, 40(%rax)
 1424      00000000 
 816:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mac_key_len = 0;
 1425              		.loc 4 816 21
 1426 0461 48C78530 		movq	$0, -464(%rbp)
 1426      FEFFFF00 
 1426      000000
 817:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 818:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* All modes haves 96-bit IVs;
 819:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * GCM and CCM has 4 implicit and 8 explicit bytes
 820:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * ChachaPoly has all 12 bytes implicit
 821:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
 822:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         transform->ivlen = 12;
 1427              		.loc 4 822 26
 1428 046c 488B8548 		movq	-440(%rbp), %rax
 1428      FEFFFF
 1429 0473 48C74018 		movq	$12, 24(%rax)
 1429      0C000000 
 823:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( cipher_info->mode == MBEDTLS_MODE_CHACHAPOLY )
 1430              		.loc 4 823 24
 1431 047b 488B8558 		movq	-424(%rbp), %rax
 1431      FEFFFF
 1432 0482 8B4004   		movl	4(%rax), %eax
 1433              		.loc 4 823 11
 1434 0485 83F80A   		cmpl	$10, %eax
 1435 0488 7511     		jne	.L94
 824:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             transform->fixed_ivlen = 12;
 1436              		.loc 4 824 36
 1437 048a 488B8548 		movq	-440(%rbp), %rax
 1437      FEFFFF
 1438 0491 48C74020 		movq	$12, 32(%rax)
 1438      0C000000 
 1439 0499 EB0F     		jmp	.L95
 1440              	.L94:
 825:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else
 826:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             transform->fixed_ivlen = 4;
 1441              		.loc 4 826 36
 1442 049b 488B8548 		movq	-440(%rbp), %rax
 1442      FEFFFF
 1443 04a2 48C74020 		movq	$4, 32(%rax)
 1443      04000000 
 1444              	.L95:
 827:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 72


 828:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* All modes have 128-bit tags, except CCM_8 (ciphersuite flag) */
 829:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         taglen = transform->ciphersuite_info->flags &
 1445              		.loc 4 829 27
 1446 04aa 488B8548 		movq	-440(%rbp), %rax
 1446      FEFFFF
 1447 04b1 488B00   		movq	(%rax), %rax
 1448              		.loc 4 829 45
 1449 04b4 0FB6402C 		movzbl	44(%rax), %eax
 1450              		.loc 4 829 53
 1451 04b8 0FB6C0   		movzbl	%al, %eax
 1452 04bb 83E002   		andl	$2, %eax
 830:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                   MBEDTLS_CIPHERSUITE_SHORT_TAG ? 8 : 16;
 1453              		.loc 4 830 53
 1454 04be 85C0     		testl	%eax, %eax
 1455 04c0 7407     		je	.L96
 1456              		.loc 4 830 53 is_stmt 0 discriminator 1
 1457 04c2 B8080000 		movl	$8, %eax
 1457      00
 1458 04c7 EB05     		jmp	.L97
 1459              	.L96:
 1460              		.loc 4 830 53 discriminator 2
 1461 04c9 B8100000 		movl	$16, %eax
 1461      00
 1462              	.L97:
 829:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                   MBEDTLS_CIPHERSUITE_SHORT_TAG ? 8 : 16;
 1463              		.loc 4 829 16 is_stmt 1
 1464 04ce 48898568 		movq	%rax, -408(%rbp)
 1464      FEFFFF
 831:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 832:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 833:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Minimum length of encrypted record */
 834:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         explicit_ivlen = transform->ivlen - transform->fixed_ivlen;
 1465              		.loc 4 834 35
 1466 04d5 488B8548 		movq	-440(%rbp), %rax
 1466      FEFFFF
 1467 04dc 488B5018 		movq	24(%rax), %rdx
 1468              		.loc 4 834 54
 1469 04e0 488B8548 		movq	-440(%rbp), %rax
 1469      FEFFFF
 1470 04e7 488B4020 		movq	32(%rax), %rax
 1471              		.loc 4 834 24
 1472 04eb 4829C2   		subq	%rax, %rdx
 1473 04ee 4889D0   		movq	%rdx, %rax
 1474 04f1 48898570 		movq	%rax, -400(%rbp)
 1474      FEFFFF
 835:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         transform->minlen = explicit_ivlen + taglen;
 1475              		.loc 4 835 44
 1476 04f8 488B9570 		movq	-400(%rbp), %rdx
 1476      FEFFFF
 1477 04ff 488B8568 		movq	-408(%rbp), %rax
 1477      FEFFFF
 1478 0506 4801C2   		addq	%rax, %rdx
 1479              		.loc 4 835 27
 1480 0509 488B8548 		movq	-440(%rbp), %rax
 1480      FEFFFF
 1481 0510 48895010 		movq	%rdx, 16(%rax)
 1482              	.LBE5:
GAS LISTING /tmp/ccEn8xFO.s 			page 73


 812:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         size_t taglen, explicit_ivlen;
 1483              		.loc 4 812 5
 1484 0514 E9750100 		jmp	.L98
 1484      00
 1485              	.L93:
 836:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 837:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
 838:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 839:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Initialize HMAC contexts */
 840:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_md_setup( &transform->md_ctx_enc, md_info, 1 ) ) != 0 ||
 1486              		.loc 4 840 21
 1487 0519 488B8548 		movq	-440(%rbp), %rax
 1487      FEFFFF
 1488 0520 488D4850 		leaq	80(%rax), %rcx
 1489 0524 488B8560 		movq	-416(%rbp), %rax
 1489      FEFFFF
 1490 052b BA010000 		movl	$1, %edx
 1490      00
 1491 0530 4889C6   		movq	%rax, %rsi
 1492 0533 4889CF   		movq	%rcx, %rdi
 1493 0536 E8000000 		call	mbedtls_md_setup@PLT
 1493      00
 1494 053b 89852CFE 		movl	%eax, -468(%rbp)
 1494      FFFF
 1495              		.loc 4 840 11
 1496 0541 83BD2CFE 		cmpl	$0, -468(%rbp)
 1496      FFFF00
 1497 0548 7531     		jne	.L99
 841:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ( ret = mbedtls_md_setup( &transform->md_ctx_dec, md_info, 1 ) ) != 0 )
 1498              		.loc 4 841 21 discriminator 1
 1499 054a 488B8548 		movq	-440(%rbp), %rax
 1499      FEFFFF
 1500 0551 488D4868 		leaq	104(%rax), %rcx
 1501 0555 488B8560 		movq	-416(%rbp), %rax
 1501      FEFFFF
 1502 055c BA010000 		movl	$1, %edx
 1502      00
 1503 0561 4889C6   		movq	%rax, %rsi
 1504 0564 4889CF   		movq	%rcx, %rdi
 1505 0567 E8000000 		call	mbedtls_md_setup@PLT
 1505      00
 1506 056c 89852CFE 		movl	%eax, -468(%rbp)
 1506      FFFF
 840:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ( ret = mbedtls_md_setup( &transform->md_ctx_dec, md_info, 1 ) ) != 0 )
 1507              		.loc 4 840 83 discriminator 1
 1508 0572 83BD2CFE 		cmpl	$0, -468(%rbp)
 1508      FFFF00
 1509 0579 740B     		je	.L100
 1510              	.L99:
 842:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
 843:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_md_setup", ret );
 844:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 1511              		.loc 4 844 19
 1512 057b 8B852CFE 		movl	-468(%rbp), %eax
 1512      FFFF
 1513 0581 E99B0400 		jmp	.L117
 1513      00
GAS LISTING /tmp/ccEn8xFO.s 			page 74


 1514              	.L100:
 845:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
 846:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 847:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Get MAC length */
 848:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mac_key_len = mbedtls_md_get_size( md_info );
 1515              		.loc 4 848 23
 1516 0586 488B8560 		movq	-416(%rbp), %rax
 1516      FEFFFF
 1517 058d 4889C7   		movq	%rax, %rdi
 1518 0590 E8000000 		call	mbedtls_md_get_size@PLT
 1518      00
 1519              		.loc 4 848 21
 1520 0595 0FB6C0   		movzbl	%al, %eax
 1521 0598 48898530 		movq	%rax, -464(%rbp)
 1521      FEFFFF
 849:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         transform->maclen = mac_key_len;
 1522              		.loc 4 849 27
 1523 059f 488B8548 		movq	-440(%rbp), %rax
 1523      FEFFFF
 1524 05a6 488B9530 		movq	-464(%rbp), %rdx
 1524      FEFFFF
 1525 05ad 48895028 		movq	%rdx, 40(%rax)
 850:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 851:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_TRUNCATED_HMAC)
 852:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
 853:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * If HMAC is to be truncated, we shall keep the leftmost bytes,
 854:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * (rfc 6066 page 13 or rfc 2104 section 4),
 855:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * so we only need to adjust the length here.
 856:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
 857:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( session->trunc_hmac == MBEDTLS_SSL_TRUNC_HMAC_ENABLED )
 858:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
 859:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             transform->maclen = MBEDTLS_SSL_TRUNCATED_HMAC_LEN;
 860:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 861:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_TRUNCATED_HMAC_COMPAT)
 862:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Fall back to old, non-compliant version of the truncated
 863:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * HMAC implementation which also truncates the key
 864:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * (Mbed TLS versions from 1.3 to 2.6.0) */
 865:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mac_key_len = transform->maclen;
 866:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
 867:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
 868:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_TRUNCATED_HMAC */
 869:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 870:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* IV length */
 871:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         transform->ivlen = cipher_info->iv_size;
 1526              		.loc 4 871 39
 1527 05b1 488B8558 		movq	-424(%rbp), %rax
 1527      FEFFFF
 1528 05b8 8B4018   		movl	24(%rax), %eax
 1529 05bb 89C2     		movl	%eax, %edx
 1530              		.loc 4 871 26
 1531 05bd 488B8548 		movq	-440(%rbp), %rax
 1531      FEFFFF
 1532 05c4 48895018 		movq	%rdx, 24(%rax)
 872:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 873:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Minimum length */
 874:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( cipher_info->mode == MBEDTLS_MODE_STREAM )
 1533              		.loc 4 874 24
GAS LISTING /tmp/ccEn8xFO.s 			page 75


 1534 05c8 488B8558 		movq	-424(%rbp), %rax
 1534      FEFFFF
 1535 05cf 8B4004   		movl	4(%rax), %eax
 1536              		.loc 4 874 11
 1537 05d2 83F807   		cmpl	$7, %eax
 1538 05d5 751B     		jne	.L101
 875:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             transform->minlen = transform->maclen;
 1539              		.loc 4 875 42
 1540 05d7 488B8548 		movq	-440(%rbp), %rax
 1540      FEFFFF
 1541 05de 488B5028 		movq	40(%rax), %rdx
 1542              		.loc 4 875 31
 1543 05e2 488B8548 		movq	-440(%rbp), %rax
 1543      FEFFFF
 1544 05e9 48895010 		movq	%rdx, 16(%rax)
 1545 05ed E99C0000 		jmp	.L98
 1545      00
 1546              	.L101:
 876:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else
 877:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
 878:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /*
 879:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * GenericBlockCipher:
 880:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * 1. if EtM is in use: one block plus MAC
 881:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *    otherwise: * first multiple of blocklen greater than maclen
 882:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * 2. IV except for SSL3 and TLS 1.0
 883:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              */
 884:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_ENCRYPT_THEN_MAC)
 885:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( session->encrypt_then_mac == MBEDTLS_SSL_ETM_ENABLED )
 886:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
 887:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 transform->minlen = transform->maclen
 888:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   + cipher_info->block_size;
 889:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
 890:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else
 891:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
 892:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
 893:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 transform->minlen = transform->maclen
 1547              		.loc 4 893 46
 1548 05f2 488B8548 		movq	-440(%rbp), %rax
 1548      FEFFFF
 1549 05f9 488B5028 		movq	40(%rax), %rdx
 894:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   + cipher_info->block_size
 1550              		.loc 4 894 48
 1551 05fd 488B8558 		movq	-424(%rbp), %rax
 1551      FEFFFF
 1552 0604 8B4020   		movl	32(%rax), %eax
 1553 0607 89C0     		movl	%eax, %eax
 1554              		.loc 4 894 35
 1555 0609 488D0C02 		leaq	(%rdx,%rax), %rcx
 895:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   - transform->maclen % cipher_info->block_size;
 1556              		.loc 4 895 46
 1557 060d 488B8548 		movq	-440(%rbp), %rax
 1557      FEFFFF
 1558 0614 488B4028 		movq	40(%rax), %rax
 1559              		.loc 4 895 68
 1560 0618 488B9558 		movq	-424(%rbp), %rdx
 1560      FEFFFF
 1561 061f 8B5220   		movl	32(%rdx), %edx
GAS LISTING /tmp/ccEn8xFO.s 			page 76


 1562 0622 89D6     		movl	%edx, %esi
 1563              		.loc 4 895 55
 1564 0624 BA000000 		movl	$0, %edx
 1564      00
 1565 0629 48F7F6   		divq	%rsi
 1566 062c 4889D0   		movq	%rdx, %rax
 1567              		.loc 4 895 35
 1568 062f 4829C1   		subq	%rax, %rcx
 1569 0632 4889CA   		movq	%rcx, %rdx
 893:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   + cipher_info->block_size
 1570              		.loc 4 893 35
 1571 0635 488B8548 		movq	-440(%rbp), %rax
 1571      FEFFFF
 1572 063c 48895010 		movq	%rdx, 16(%rax)
 896:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
 897:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 898:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1)
 899:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 ||
 900:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_1 )
 901:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ; /* No need to adjust minlen */
 902:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else
 903:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
 904:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_1) || defined(MBEDTLS_SSL_PROTO_TLS1_2)
 905:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_2 ||
 1573              		.loc 4 905 20
 1574 0640 488B8518 		movq	-488(%rbp), %rax
 1574      FEFFFF
 1575 0647 8B4018   		movl	24(%rax), %eax
 1576              		.loc 4 905 15
 1577 064a 83F802   		cmpl	$2, %eax
 1578 064d 740F     		je	.L102
 906:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_3 )
 1579              		.loc 4 906 20 discriminator 1
 1580 064f 488B8518 		movq	-488(%rbp), %rax
 1580      FEFFFF
 1581 0656 8B4018   		movl	24(%rax), %eax
 905:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_3 )
 1582              		.loc 4 905 63 discriminator 1
 1583 0659 83F803   		cmpl	$3, %eax
 1584 065c 7526     		jne	.L103
 1585              	.L102:
 907:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
 908:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 transform->minlen += transform->ivlen;
 1586              		.loc 4 908 35
 1587 065e 488B8548 		movq	-440(%rbp), %rax
 1587      FEFFFF
 1588 0665 488B5010 		movq	16(%rax), %rdx
 1589              		.loc 4 908 47
 1590 0669 488B8548 		movq	-440(%rbp), %rax
 1590      FEFFFF
 1591 0670 488B4018 		movq	24(%rax), %rax
 1592              		.loc 4 908 35
 1593 0674 4801C2   		addq	%rax, %rdx
 1594 0677 488B8548 		movq	-440(%rbp), %rax
 1594      FEFFFF
 1595 067e 48895010 		movq	%rdx, 16(%rax)
 1596 0682 EB0A     		jmp	.L98
GAS LISTING /tmp/ccEn8xFO.s 			page 77


 1597              	.L103:
 909:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
 910:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else
 911:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
 912:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
 913:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
 914:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 1598              		.loc 4 914 23
 1599 0684 B80094FF 		movl	$-27648, %eax
 1599      FF
 1600 0689 E9930300 		jmp	.L117
 1600      00
 1601              	.L98:
 915:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
 916:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
 917:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 918:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 919:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "keylen: %d, minlen: %d, ivlen: %d, maclen: %d",
 920:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                    transform->keylen, transform->minlen, transform->ivlen,
 921:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                    transform->maclen ) );
 922:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 923:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
 924:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Finally setup the cipher contexts, IVs and MAC secrets.
 925:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
 926:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
 927:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_CLIENT )
 1602              		.loc 4 927 12
 1603 068e 488B8518 		movq	-488(%rbp), %rax
 1603      FEFFFF
 1604 0695 488B00   		movq	(%rax), %rax
 1605              		.loc 4 927 29
 1606 0698 0FB680BC 		movzbl	188(%rax), %eax
 1606      000000
 1607 069f 83E001   		andl	$1, %eax
 1608              		.loc 4 927 7
 1609 06a2 84C0     		testb	%al, %al
 1610 06a4 0F851E01 		jne	.L104
 1610      0000
 928:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 929:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         key1 = keyblk + mac_key_len * 2;
 1611              		.loc 4 929 37
 1612 06aa 488B8530 		movq	-464(%rbp), %rax
 1612      FEFFFF
 1613 06b1 488D1400 		leaq	(%rax,%rax), %rdx
 1614              		.loc 4 929 14
 1615 06b5 488D85E0 		leaq	-288(%rbp), %rax
 1615      FEFFFF
 1616 06bc 4801D0   		addq	%rdx, %rax
 1617 06bf 48898578 		movq	%rax, -392(%rbp)
 1617      FEFFFF
 930:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         key2 = keyblk + mac_key_len * 2 + transform->keylen;
 1618              		.loc 4 930 37
 1619 06c6 488B8530 		movq	-464(%rbp), %rax
 1619      FEFFFF
 1620 06cd 488D1400 		leaq	(%rax,%rax), %rdx
 1621              		.loc 4 930 52
 1622 06d1 488B8548 		movq	-440(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 78


 1622      FEFFFF
 1623 06d8 8B4008   		movl	8(%rax), %eax
 1624 06db 89C0     		movl	%eax, %eax
 1625              		.loc 4 930 41
 1626 06dd 4801C2   		addq	%rax, %rdx
 1627              		.loc 4 930 14
 1628 06e0 488D85E0 		leaq	-288(%rbp), %rax
 1628      FEFFFF
 1629 06e7 4801D0   		addq	%rdx, %rax
 1630 06ea 48898580 		movq	%rax, -384(%rbp)
 1630      FEFFFF
 931:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 932:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mac_enc = keyblk;
 1631              		.loc 4 932 17
 1632 06f1 488D85E0 		leaq	-288(%rbp), %rax
 1632      FEFFFF
 1633 06f8 48898588 		movq	%rax, -376(%rbp)
 1633      FEFFFF
 933:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mac_dec = keyblk + mac_key_len;
 1634              		.loc 4 933 17
 1635 06ff 488D95E0 		leaq	-288(%rbp), %rdx
 1635      FEFFFF
 1636 0706 488B8530 		movq	-464(%rbp), %rax
 1636      FEFFFF
 1637 070d 4801D0   		addq	%rdx, %rax
 1638 0710 48898590 		movq	%rax, -368(%rbp)
 1638      FEFFFF
 934:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 935:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
 936:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * This is not used in TLS v1.1.
 937:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
 938:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         iv_copy_len = ( transform->fixed_ivlen ) ?
 1639              		.loc 4 938 34
 1640 0717 488B8548 		movq	-440(%rbp), %rax
 1640      FEFFFF
 1641 071e 488B4020 		movq	32(%rax), %rax
 939:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             transform->fixed_ivlen : transform->ivlen;
 1642              		.loc 4 939 52
 1643 0722 4885C0   		testq	%rax, %rax
 1644 0725 740D     		je	.L105
 1645              		.loc 4 939 52 is_stmt 0 discriminator 1
 1646 0727 488B8548 		movq	-440(%rbp), %rax
 1646      FEFFFF
 1647 072e 488B4020 		movq	32(%rax), %rax
 1648 0732 EB0B     		jmp	.L106
 1649              	.L105:
 1650              		.loc 4 939 52 discriminator 2
 1651 0734 488B8548 		movq	-440(%rbp), %rax
 1651      FEFFFF
 1652 073b 488B4018 		movq	24(%rax), %rax
 1653              	.L106:
 938:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             transform->fixed_ivlen : transform->ivlen;
 1654              		.loc 4 938 21 is_stmt 1
 1655 073f 48898598 		movq	%rax, -360(%rbp)
 1655      FEFFFF
 940:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memcpy( transform->iv_enc, key2 + transform->keylen,  iv_copy_len );
 1656              		.loc 4 940 52
GAS LISTING /tmp/ccEn8xFO.s 			page 79


 1657 0746 488B8548 		movq	-440(%rbp), %rax
 1657      FEFFFF
 1658 074d 8B4008   		movl	8(%rax), %eax
 1659 0750 89C2     		movl	%eax, %edx
 1660              		.loc 4 940 41
 1661 0752 488B8580 		movq	-384(%rbp), %rax
 1661      FEFFFF
 1662 0759 488D3402 		leaq	(%rdx,%rax), %rsi
 1663              		.loc 4 940 26
 1664 075d 488B8548 		movq	-440(%rbp), %rax
 1664      FEFFFF
 1665 0764 488D4830 		leaq	48(%rax), %rcx
 1666              		.loc 4 940 9
 1667 0768 488B8598 		movq	-360(%rbp), %rax
 1667      FEFFFF
 1668 076f 4889C2   		movq	%rax, %rdx
 1669 0772 4889CF   		movq	%rcx, %rdi
 1670 0775 E8000000 		call	memcpy@PLT
 1670      00
 941:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memcpy( transform->iv_dec, key2 + transform->keylen + iv_copy_len,
 1671              		.loc 4 941 52
 1672 077a 488B8548 		movq	-440(%rbp), %rax
 1672      FEFFFF
 1673 0781 8B4008   		movl	8(%rax), %eax
 1674 0784 89C2     		movl	%eax, %edx
 1675              		.loc 4 941 61
 1676 0786 488B8598 		movq	-360(%rbp), %rax
 1676      FEFFFF
 1677 078d 4801C2   		addq	%rax, %rdx
 1678 0790 488B8580 		movq	-384(%rbp), %rax
 1678      FEFFFF
 1679 0797 488D3402 		leaq	(%rdx,%rax), %rsi
 1680              		.loc 4 941 26
 1681 079b 488B8548 		movq	-440(%rbp), %rax
 1681      FEFFFF
 1682 07a2 488D4840 		leaq	64(%rax), %rcx
 1683              		.loc 4 941 9
 1684 07a6 488B8598 		movq	-360(%rbp), %rax
 1684      FEFFFF
 1685 07ad 4889C2   		movq	%rax, %rdx
 1686 07b0 4889CF   		movq	%rcx, %rdi
 1687 07b3 E8000000 		call	memcpy@PLT
 1687      00
 942:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 iv_copy_len );
 943:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 944:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
 945:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_CLI_C */
 946:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
 947:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER )
 948:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 949:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         key1 = keyblk + mac_key_len * 2 + transform->keylen;
 950:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         key2 = keyblk + mac_key_len * 2;
 951:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 952:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mac_enc = keyblk + mac_key_len;
 953:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mac_dec = keyblk;
 954:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 955:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
GAS LISTING /tmp/ccEn8xFO.s 			page 80


 956:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * This is not used in TLS v1.1.
 957:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
 958:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         iv_copy_len = ( transform->fixed_ivlen ) ?
 959:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             transform->fixed_ivlen : transform->ivlen;
 960:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memcpy( transform->iv_dec, key1 + transform->keylen,  iv_copy_len );
 961:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memcpy( transform->iv_enc, key1 + transform->keylen + iv_copy_len,
 962:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 iv_copy_len );
 963:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 964:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
 965:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_SRV_C */
 966:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 967:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
 968:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 969:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 970:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 971:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
 972:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 )
 973:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 974:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( mac_key_len > sizeof transform->mac_enc )
 975:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
 976:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
 977:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 978:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
 979:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 980:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memcpy( transform->mac_enc, mac_enc, mac_key_len );
 981:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memcpy( transform->mac_dec, mac_dec, mac_key_len );
 982:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 983:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
 984:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 */
 985:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1) || \
 986:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_2)
 987:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_1 )
 1688              		.loc 4 987 12
 1689 07b8 488B8518 		movq	-488(%rbp), %rax
 1689      FEFFFF
 1690 07bf 8B4018   		movl	24(%rax), %eax
 1691              		.loc 4 987 7
 1692 07c2 85C0     		testl	%eax, %eax
 1693 07c4 7E60     		jle	.L108
 1694 07c6 EB0A     		jmp	.L120
 1695              	.L104:
 968:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 1696              		.loc 4 968 15
 1697 07c8 B80094FF 		movl	$-27648, %eax
 1697      FF
 1698 07cd E94F0200 		jmp	.L117
 1698      00
 1699              	.L120:
 988:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 989:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* For HMAC-based ciphersuites, initialize the HMAC transforms.
 990:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****            For AEAD-based ciphersuites, there is nothing to do here. */
 991:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( mac_key_len != 0 )
 1700              		.loc 4 991 11
 1701 07d2 4883BD30 		cmpq	$0, -464(%rbp)
 1701      FEFFFF00 
 1702 07da 7454     		je	.L109
 992:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
GAS LISTING /tmp/ccEn8xFO.s 			page 81


 993:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_starts( &transform->md_ctx_enc, mac_enc, mac_key_len );
 1703              		.loc 4 993 13
 1704 07dc 488B8548 		movq	-440(%rbp), %rax
 1704      FEFFFF
 1705 07e3 488D4850 		leaq	80(%rax), %rcx
 1706 07e7 488B9530 		movq	-464(%rbp), %rdx
 1706      FEFFFF
 1707 07ee 488B8588 		movq	-376(%rbp), %rax
 1707      FEFFFF
 1708 07f5 4889C6   		movq	%rax, %rsi
 1709 07f8 4889CF   		movq	%rcx, %rdi
 1710 07fb E8000000 		call	mbedtls_md_hmac_starts@PLT
 1710      00
 994:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_starts( &transform->md_ctx_dec, mac_dec, mac_key_len );
 1711              		.loc 4 994 13
 1712 0800 488B8548 		movq	-440(%rbp), %rax
 1712      FEFFFF
 1713 0807 488D4868 		leaq	104(%rax), %rcx
 1714 080b 488B9530 		movq	-464(%rbp), %rdx
 1714      FEFFFF
 1715 0812 488B8590 		movq	-368(%rbp), %rax
 1715      FEFFFF
 1716 0819 4889C6   		movq	%rax, %rsi
 1717 081c 4889CF   		movq	%rcx, %rdi
 1718 081f E8000000 		call	mbedtls_md_hmac_starts@PLT
 1718      00
 1719 0824 EB0A     		jmp	.L109
 1720              	.L108:
 995:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
 996:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 997:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
 998:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
 999:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1000:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1001:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 1721              		.loc 4 1001 15
 1722 0826 B80094FF 		movl	$-27648, %eax
 1722      FF
 1723 082b E9F10100 		jmp	.L117
 1723      00
 1724              	.L109:
1002:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1003:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1004:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_HW_RECORD_ACCEL)
1005:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( mbedtls_ssl_hw_record_init != NULL )
1006:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1007:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         int ret = 0;
1008:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1009:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "going for mbedtls_ssl_hw_record_init()" ) );
1010:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1011:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_ssl_hw_record_init( ssl, key1, key2, transform->keylen,
1012:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         transform->iv_enc, transform->iv_dec,
1013:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         iv_copy_len,
1014:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         mac_enc, mac_dec,
1015:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         mac_key_len ) ) != 0 )
1016:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1017:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_hw_record_init", ret );
GAS LISTING /tmp/ccEn8xFO.s 			page 82


1018:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_HW_ACCEL_FAILED );
1019:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1020:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1021:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_HW_RECORD_ACCEL */
1022:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1023:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_EXPORT_KEYS)
1024:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->f_export_keys != NULL )
 1725              		.loc 4 1024 12
 1726 0830 488B8518 		movq	-488(%rbp), %rax
 1726      FEFFFF
 1727 0837 488B00   		movq	(%rax), %rax
 1728              		.loc 4 1024 18
 1729 083a 488B4068 		movq	104(%rax), %rax
 1730              		.loc 4 1024 7
 1731 083e 4885C0   		testq	%rax, %rax
 1732 0841 7452     		je	.L110
1025:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1026:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->conf->f_export_keys( ssl->conf->p_export_keys,
 1733              		.loc 4 1026 12
 1734 0843 488B8518 		movq	-488(%rbp), %rax
 1734      FEFFFF
 1735 084a 488B00   		movq	(%rax), %rax
 1736              		.loc 4 1026 18
 1737 084d 4C8B5068 		movq	104(%rax), %r10
1027:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   session->master, keyblk,
1028:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   mac_key_len, transform->keylen,
 1738              		.loc 4 1028 57
 1739 0851 488B8548 		movq	-440(%rbp), %rax
 1739      FEFFFF
 1740 0858 8B4008   		movl	8(%rax), %eax
1026:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   session->master, keyblk,
 1741              		.loc 4 1026 9
 1742 085b 4189C0   		movl	%eax, %r8d
1027:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   session->master, keyblk,
 1743              		.loc 4 1027 42
 1744 085e 488B8540 		movq	-448(%rbp), %rax
 1744      FEFFFF
 1745 0865 488D7030 		leaq	48(%rax), %rsi
1026:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   session->master, keyblk,
 1746              		.loc 4 1026 38
 1747 0869 488B8518 		movq	-488(%rbp), %rax
 1747      FEFFFF
 1748 0870 488B00   		movq	(%rax), %rax
1026:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   session->master, keyblk,
 1749              		.loc 4 1026 9
 1750 0873 488B4070 		movq	112(%rax), %rax
 1751 0877 488BBD98 		movq	-360(%rbp), %rdi
 1751      FEFFFF
 1752 087e 488B8D30 		movq	-464(%rbp), %rcx
 1752      FEFFFF
 1753 0885 488D95E0 		leaq	-288(%rbp), %rdx
 1753      FEFFFF
 1754 088c 4989F9   		movq	%rdi, %r9
 1755 088f 4889C7   		movq	%rax, %rdi
 1756 0892 41FFD2   		call	*%r10
 1757              	.LVL6:
 1758              	.L110:
GAS LISTING /tmp/ccEn8xFO.s 			page 83


1029:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   iv_copy_len );
1030:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1031:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
1032:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1033:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_cipher_setup( &transform->cipher_ctx_enc,
 1759              		.loc 4 1033 17
 1760 0895 488B8548 		movq	-440(%rbp), %rax
 1760      FEFFFF
 1761 089c 488D9080 		leaq	128(%rax), %rdx
 1761      000000
 1762 08a3 488B8558 		movq	-424(%rbp), %rax
 1762      FEFFFF
 1763 08aa 4889C6   		movq	%rax, %rsi
 1764 08ad 4889D7   		movq	%rdx, %rdi
 1765 08b0 E8000000 		call	mbedtls_cipher_setup@PLT
 1765      00
 1766 08b5 89852CFE 		movl	%eax, -468(%rbp)
 1766      FFFF
 1767              		.loc 4 1033 7
 1768 08bb 83BD2CFE 		cmpl	$0, -468(%rbp)
 1768      FFFF00
 1769 08c2 740B     		je	.L111
1034:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  cipher_info ) ) != 0 )
1035:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1036:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_setup", ret );
1037:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 1770              		.loc 4 1037 15
 1771 08c4 8B852CFE 		movl	-468(%rbp), %eax
 1771      FFFF
 1772 08ca E9520100 		jmp	.L117
 1772      00
 1773              	.L111:
1038:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1039:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1040:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_cipher_setup( &transform->cipher_ctx_dec,
 1774              		.loc 4 1040 17
 1775 08cf 488B8548 		movq	-440(%rbp), %rax
 1775      FEFFFF
 1776 08d6 488D90D8 		leaq	216(%rax), %rdx
 1776      000000
 1777 08dd 488B8558 		movq	-424(%rbp), %rax
 1777      FEFFFF
 1778 08e4 4889C6   		movq	%rax, %rsi
 1779 08e7 4889D7   		movq	%rdx, %rdi
 1780 08ea E8000000 		call	mbedtls_cipher_setup@PLT
 1780      00
 1781 08ef 89852CFE 		movl	%eax, -468(%rbp)
 1781      FFFF
 1782              		.loc 4 1040 7
 1783 08f5 83BD2CFE 		cmpl	$0, -468(%rbp)
 1783      FFFF00
 1784 08fc 740B     		je	.L112
1041:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  cipher_info ) ) != 0 )
1042:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1043:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_setup", ret );
1044:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 1785              		.loc 4 1044 15
GAS LISTING /tmp/ccEn8xFO.s 			page 84


 1786 08fe 8B852CFE 		movl	-468(%rbp), %eax
 1786      FFFF
 1787 0904 E9180100 		jmp	.L117
 1787      00
 1788              	.L112:
1045:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1046:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1047:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_cipher_setkey( &transform->cipher_ctx_enc, key1,
1048:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                cipher_info->key_bitlen,
 1789              		.loc 4 1048 43
 1790 0909 488B8558 		movq	-424(%rbp), %rax
 1790      FEFFFF
 1791 0910 8B4008   		movl	8(%rax), %eax
1047:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                cipher_info->key_bitlen,
 1792              		.loc 4 1047 17
 1793 0913 89C2     		movl	%eax, %edx
 1794 0915 488B8548 		movq	-440(%rbp), %rax
 1794      FEFFFF
 1795 091c 488DB880 		leaq	128(%rax), %rdi
 1795      000000
 1796 0923 488B8578 		movq	-392(%rbp), %rax
 1796      FEFFFF
 1797 092a B9010000 		movl	$1, %ecx
 1797      00
 1798 092f 4889C6   		movq	%rax, %rsi
 1799 0932 E8000000 		call	mbedtls_cipher_setkey@PLT
 1799      00
 1800 0937 89852CFE 		movl	%eax, -468(%rbp)
 1800      FFFF
1047:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                cipher_info->key_bitlen,
 1801              		.loc 4 1047 7
 1802 093d 83BD2CFE 		cmpl	$0, -468(%rbp)
 1802      FFFF00
 1803 0944 740B     		je	.L113
1049:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                MBEDTLS_ENCRYPT ) ) != 0 )
1050:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1051:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_setkey", ret );
1052:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 1804              		.loc 4 1052 15
 1805 0946 8B852CFE 		movl	-468(%rbp), %eax
 1805      FFFF
 1806 094c E9D00000 		jmp	.L117
 1806      00
 1807              	.L113:
1053:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1054:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1055:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_cipher_setkey( &transform->cipher_ctx_dec, key2,
1056:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                cipher_info->key_bitlen,
 1808              		.loc 4 1056 43
 1809 0951 488B8558 		movq	-424(%rbp), %rax
 1809      FEFFFF
 1810 0958 8B4008   		movl	8(%rax), %eax
1055:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                cipher_info->key_bitlen,
 1811              		.loc 4 1055 17
 1812 095b 89C2     		movl	%eax, %edx
 1813 095d 488B8548 		movq	-440(%rbp), %rax
 1813      FEFFFF
GAS LISTING /tmp/ccEn8xFO.s 			page 85


 1814 0964 488DB8D8 		leaq	216(%rax), %rdi
 1814      000000
 1815 096b 488B8580 		movq	-384(%rbp), %rax
 1815      FEFFFF
 1816 0972 B9000000 		movl	$0, %ecx
 1816      00
 1817 0977 4889C6   		movq	%rax, %rsi
 1818 097a E8000000 		call	mbedtls_cipher_setkey@PLT
 1818      00
 1819 097f 89852CFE 		movl	%eax, -468(%rbp)
 1819      FFFF
1055:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                cipher_info->key_bitlen,
 1820              		.loc 4 1055 7
 1821 0985 83BD2CFE 		cmpl	$0, -468(%rbp)
 1821      FFFF00
 1822 098c 740B     		je	.L114
1057:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                MBEDTLS_DECRYPT ) ) != 0 )
1058:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1059:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_setkey", ret );
1060:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 1823              		.loc 4 1060 15
 1824 098e 8B852CFE 		movl	-468(%rbp), %eax
 1824      FFFF
 1825 0994 E9880000 		jmp	.L117
 1825      00
 1826              	.L114:
1061:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1062:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1063:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_CIPHER_MODE_CBC)
1064:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( cipher_info->mode == MBEDTLS_MODE_CBC )
 1827              		.loc 4 1064 20
 1828 0999 488B8558 		movq	-424(%rbp), %rax
 1828      FEFFFF
 1829 09a0 8B4004   		movl	4(%rax), %eax
 1830              		.loc 4 1064 7
 1831 09a3 83F802   		cmpl	$2, %eax
 1832 09a6 7560     		jne	.L115
1065:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1066:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_cipher_set_padding_mode( &transform->cipher_ctx_enc,
 1833              		.loc 4 1066 21
 1834 09a8 488B8548 		movq	-440(%rbp), %rax
 1834      FEFFFF
 1835 09af 4883E880 		subq	$-128, %rax
 1836 09b3 BE040000 		movl	$4, %esi
 1836      00
 1837 09b8 4889C7   		movq	%rax, %rdi
 1838 09bb E8000000 		call	mbedtls_cipher_set_padding_mode@PLT
 1838      00
 1839 09c0 89852CFE 		movl	%eax, -468(%rbp)
 1839      FFFF
 1840              		.loc 4 1066 11
 1841 09c6 83BD2CFE 		cmpl	$0, -468(%rbp)
 1841      FFFF00
 1842 09cd 7408     		je	.L116
1067:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                              MBEDTLS_PADDING_NONE ) ) != 0 )
1068:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1069:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_set_padding_mode", ret );
GAS LISTING /tmp/ccEn8xFO.s 			page 86


1070:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 1843              		.loc 4 1070 19
 1844 09cf 8B852CFE 		movl	-468(%rbp), %eax
 1844      FFFF
 1845 09d5 EB4A     		jmp	.L117
 1846              	.L116:
1071:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1072:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1073:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_cipher_set_padding_mode( &transform->cipher_ctx_dec,
 1847              		.loc 4 1073 21
 1848 09d7 488B8548 		movq	-440(%rbp), %rax
 1848      FEFFFF
 1849 09de 4805D800 		addq	$216, %rax
 1849      0000
 1850 09e4 BE040000 		movl	$4, %esi
 1850      00
 1851 09e9 4889C7   		movq	%rax, %rdi
 1852 09ec E8000000 		call	mbedtls_cipher_set_padding_mode@PLT
 1852      00
 1853 09f1 89852CFE 		movl	%eax, -468(%rbp)
 1853      FFFF
 1854              		.loc 4 1073 11
 1855 09f7 83BD2CFE 		cmpl	$0, -468(%rbp)
 1855      FFFF00
 1856 09fe 7408     		je	.L115
1074:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                              MBEDTLS_PADDING_NONE ) ) != 0 )
1075:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1076:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_set_padding_mode", ret );
1077:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 1857              		.loc 4 1077 19
 1858 0a00 8B852CFE 		movl	-468(%rbp), %eax
 1858      FFFF
 1859 0a06 EB19     		jmp	.L117
 1860              	.L115:
1078:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1079:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1080:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_CIPHER_MODE_CBC */
1081:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1082:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_platform_zeroize( keyblk, sizeof( keyblk ) );
 1861              		.loc 4 1082 5
 1862 0a08 488D85E0 		leaq	-288(%rbp), %rax
 1862      FEFFFF
 1863 0a0f BE000100 		movl	$256, %esi
 1863      00
 1864 0a14 4889C7   		movq	%rax, %rdi
 1865 0a17 E8000000 		call	mbedtls_platform_zeroize@PLT
 1865      00
1083:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1084:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_ZLIB_SUPPORT)
1085:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     // Initialize compression
1086:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     //
1087:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( session->compression == MBEDTLS_SSL_COMPRESS_DEFLATE )
1088:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1089:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->compress_buf == NULL )
1090:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1091:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "Allocating compression buffer" ) );
1092:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->compress_buf = mbedtls_calloc( 1, MBEDTLS_SSL_COMPRESS_BUFFER_LEN );
GAS LISTING /tmp/ccEn8xFO.s 			page 87


1093:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ssl->compress_buf == NULL )
1094:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
1095:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "alloc(%d bytes) failed",
1096:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     MBEDTLS_SSL_COMPRESS_BUFFER_LEN ) );
1097:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
1098:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
1099:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1100:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1101:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "Initializing zlib states" ) );
1102:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1103:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memset( &transform->ctx_deflate, 0, sizeof( transform->ctx_deflate ) );
1104:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memset( &transform->ctx_inflate, 0, sizeof( transform->ctx_inflate ) );
1105:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1106:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( deflateInit( &transform->ctx_deflate,
1107:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                          Z_DEFAULT_COMPRESSION )   != Z_OK ||
1108:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             inflateInit( &transform->ctx_inflate ) != Z_OK )
1109:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1110:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "Failed to initialize compression" ) );
1111:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_COMPRESSION_FAILED );
1112:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1113:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1114:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_ZLIB_SUPPORT */
1115:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1116:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= derive keys" ) );
1117:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1118:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 1866              		.loc 4 1118 11
 1867 0a1c B8000000 		movl	$0, %eax
 1867      00
 1868              	.L117:
1119:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 1869              		.loc 4 1119 1 discriminator 2
 1870 0a21 488B5DE8 		movq	-24(%rbp), %rbx
 1871 0a25 6448331C 		xorq	%fs:40, %rbx
 1871      25280000 
 1871      00
 1872 0a2e 7405     		je	.L118
 1873              		.loc 4 1119 1 is_stmt 0
 1874 0a30 E8000000 		call	__stack_chk_fail@PLT
 1874      00
 1875              	.L118:
 1876 0a35 488B5DF8 		movq	-8(%rbp), %rbx
 1877 0a39 C9       		leave
 1878              	.LCFI47:
 1879              		.cfi_def_cfa 7, 8
 1880 0a3a C3       		ret
 1881              		.cfi_endproc
 1882              	.LFE34:
 1884              		.section	.text.ssl_calc_verify_tls_sha256,"ax",@progbits
 1886              	ssl_calc_verify_tls_sha256:
 1887              	.LFB35:
1120:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1121:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
1122:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void ssl_calc_verify_ssl( mbedtls_ssl_context *ssl, unsigned char hash[36] )
1123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
1124:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_context md5;
1125:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_context sha1;
GAS LISTING /tmp/ccEn8xFO.s 			page 88


1126:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char pad_1[48];
1127:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char pad_2[48];
1128:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1129:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> calc verify ssl" ) );
1130:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1131:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_init( &md5 );
1132:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_init( &sha1 );
1133:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1134:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_clone( &md5, &ssl->handshake->fin_md5 );
1135:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_clone( &sha1, &ssl->handshake->fin_sha1 );
1136:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1137:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memset( pad_1, 0x36, 48 );
1138:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memset( pad_2, 0x5C, 48 );
1139:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1140:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_update_ret( &md5, ssl->session_negotiate->master, 48 );
1141:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_update_ret( &md5, pad_1, 48 );
1142:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_finish_ret( &md5, hash );
1143:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1144:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_starts_ret( &md5 );
1145:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_update_ret( &md5, ssl->session_negotiate->master, 48 );
1146:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_update_ret( &md5, pad_2, 48 );
1147:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_update_ret( &md5, hash,  16 );
1148:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_finish_ret( &md5, hash );
1149:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1150:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_update_ret( &sha1, ssl->session_negotiate->master, 48 );
1151:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_update_ret( &sha1, pad_1, 40 );
1152:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_finish_ret( &sha1, hash + 16 );
1153:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1154:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_starts_ret( &sha1 );
1155:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_update_ret( &sha1, ssl->session_negotiate->master, 48 );
1156:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_update_ret( &sha1, pad_2, 40 );
1157:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_update_ret( &sha1, hash + 16, 20 );
1158:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_finish_ret( &sha1, hash + 16 );
1159:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1160:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "calculated verify result", hash, 36 );
1161:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= calc verify" ) );
1162:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1163:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_free(  &md5  );
1164:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_free( &sha1 );
1165:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1166:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return;
1167:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
1168:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 */
1169:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1170:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1)
1171:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void ssl_calc_verify_tls( mbedtls_ssl_context *ssl, unsigned char hash[36] )
1172:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
1173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_context md5;
1174:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_context sha1;
1175:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1176:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> calc verify tls" ) );
1177:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1178:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_init( &md5 );
1179:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_init( &sha1 );
1180:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1181:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_clone( &md5, &ssl->handshake->fin_md5 );
1182:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_clone( &sha1, &ssl->handshake->fin_sha1 );
GAS LISTING /tmp/ccEn8xFO.s 			page 89


1183:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1184:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      mbedtls_md5_finish_ret( &md5,  hash );
1185:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_finish_ret( &sha1, hash + 16 );
1186:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1187:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "calculated verify result", hash, 36 );
1188:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= calc verify" ) );
1189:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1190:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_free(  &md5  );
1191:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_free( &sha1 );
1192:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1193:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return;
1194:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
1195:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1 || MBEDTLS_SSL_PROTO_TLS1_1 */
1196:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1197:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
1198:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
1199:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void ssl_calc_verify_tls_sha256( mbedtls_ssl_context *ssl, unsigned char hash[32] )
1200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 1888              		.loc 4 1200 1 is_stmt 1
 1889              		.cfi_startproc
 1890 0000 F30F1EFA 		endbr64
 1891 0004 55       		pushq	%rbp
 1892              	.LCFI48:
 1893              		.cfi_def_cfa_offset 16
 1894              		.cfi_offset 6, -16
 1895 0005 4889E5   		movq	%rsp, %rbp
 1896              	.LCFI49:
 1897              		.cfi_def_cfa_register 6
 1898 0008 4881EC90 		subq	$144, %rsp
 1898      000000
 1899 000f 4889BD78 		movq	%rdi, -136(%rbp)
 1899      FFFFFF
 1900 0016 4889B570 		movq	%rsi, -144(%rbp)
 1900      FFFFFF
 1901              		.loc 4 1200 1
 1902 001d 64488B04 		movq	%fs:40, %rax
 1902      25280000 
 1902      00
 1903 0026 488945F8 		movq	%rax, -8(%rbp)
 1904 002a 31C0     		xorl	%eax, %eax
1201:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha256_context sha256;
1202:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1203:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha256_init( &sha256 );
 1905              		.loc 4 1203 5
 1906 002c 488D4580 		leaq	-128(%rbp), %rax
 1907 0030 4889C7   		movq	%rax, %rdi
 1908 0033 E8000000 		call	mbedtls_sha256_init@PLT
 1908      00
1204:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1205:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> calc verify sha256" ) );
1206:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1207:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha256_clone( &sha256, &ssl->handshake->fin_sha256 );
 1909              		.loc 4 1207 40
 1910 0038 488B8578 		movq	-136(%rbp), %rax
 1910      FFFFFF
 1911 003f 488B4060 		movq	96(%rax), %rax
 1912              		.loc 4 1207 36
GAS LISTING /tmp/ccEn8xFO.s 			page 90


 1913 0043 488D9080 		leaq	640(%rax), %rdx
 1913      020000
 1914              		.loc 4 1207 5
 1915 004a 488D4580 		leaq	-128(%rbp), %rax
 1916 004e 4889D6   		movq	%rdx, %rsi
 1917 0051 4889C7   		movq	%rax, %rdi
 1918 0054 E8000000 		call	mbedtls_sha256_clone@PLT
 1918      00
1208:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha256_finish_ret( &sha256, hash );
 1919              		.loc 4 1208 5
 1920 0059 488B9570 		movq	-144(%rbp), %rdx
 1920      FFFFFF
 1921 0060 488D4580 		leaq	-128(%rbp), %rax
 1922 0064 4889D6   		movq	%rdx, %rsi
 1923 0067 4889C7   		movq	%rax, %rdi
 1924 006a E8000000 		call	mbedtls_sha256_finish_ret@PLT
 1924      00
1209:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1210:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "calculated verify result", hash, 32 );
1211:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= calc verify" ) );
1212:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1213:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha256_free( &sha256 );
 1925              		.loc 4 1213 5
 1926 006f 488D4580 		leaq	-128(%rbp), %rax
 1927 0073 4889C7   		movq	%rax, %rdi
 1928 0076 E8000000 		call	mbedtls_sha256_free@PLT
 1928      00
1214:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1215:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return;
 1929              		.loc 4 1215 5
 1930 007b 90       		nop
1216:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 1931              		.loc 4 1216 1
 1932 007c 488B45F8 		movq	-8(%rbp), %rax
 1933 0080 64483304 		xorq	%fs:40, %rax
 1933      25280000 
 1933      00
 1934 0089 7405     		je	.L123
 1935 008b E8000000 		call	__stack_chk_fail@PLT
 1935      00
 1936              	.L123:
 1937 0090 C9       		leave
 1938              	.LCFI50:
 1939              		.cfi_def_cfa 7, 8
 1940 0091 C3       		ret
 1941              		.cfi_endproc
 1942              	.LFE35:
 1944              		.section	.text.ssl_read_memory,"ax",@progbits
 1946              	ssl_read_memory:
 1947              	.LFB36:
1217:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SHA256_C */
1218:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1219:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
1220:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void ssl_calc_verify_tls_sha384( mbedtls_ssl_context *ssl, unsigned char hash[48] )
1221:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
1222:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha512_context sha512;
1223:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 91


1224:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha512_init( &sha512 );
1225:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1226:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> calc verify sha384" ) );
1227:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1228:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha512_clone( &sha512, &ssl->handshake->fin_sha512 );
1229:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha512_finish_ret( &sha512, hash );
1230:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1231:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "calculated verify result", hash, 48 );
1232:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= calc verify" ) );
1233:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1234:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha512_free( &sha512 );
1235:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1236:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return;
1237:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
1238:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SHA512_C */
1239:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
1240:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1241:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED)
1242:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_psk_derive_premaster( mbedtls_ssl_context *ssl, mbedtls_key_exchange_type_t key_ex 
1243:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
1244:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char *p = ssl->handshake->premaster;
1245:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char *end = p + sizeof( ssl->handshake->premaster );
1246:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const unsigned char *psk = ssl->conf->psk;
1247:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t psk_len = ssl->conf->psk_len;
1248:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1249:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* If the psk callback was called, use its result */
1250:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->handshake->psk != NULL )
1251:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1252:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         psk = ssl->handshake->psk;
1253:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         psk_len = ssl->handshake->psk_len;
1254:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1255:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1256:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
1257:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * PMS = struct {
1258:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     opaque other_secret<0..2^16-1>;
1259:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     opaque psk<0..2^16-1>;
1260:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * };
1261:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * with "other_secret" depending on the particular key exchange
1262:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
1263:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE_PSK_ENABLED)
1264:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( key_ex == MBEDTLS_KEY_EXCHANGE_PSK )
1265:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1266:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( end - p < 2 )
1267:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
1268:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1269:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         *(p++) = (unsigned char)( psk_len >> 8 );
1270:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         *(p++) = (unsigned char)( psk_len      );
1271:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1272:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( end < p || (size_t)( end - p ) < psk_len )
1273:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
1274:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1275:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memset( p, 0, psk_len );
1276:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         p += psk_len;
1277:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1278:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
1279:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_KEY_EXCHANGE_PSK_ENABLED */
1280:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE_RSA_PSK_ENABLED)
GAS LISTING /tmp/ccEn8xFO.s 			page 92


1281:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( key_ex == MBEDTLS_KEY_EXCHANGE_RSA_PSK )
1282:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1283:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
1284:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * other_secret already set by the ClientKeyExchange message,
1285:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * and is 48 bytes long
1286:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
1287:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( end - p < 2 )
1288:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
1289:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1290:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         *p++ = 0;
1291:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         *p++ = 48;
1292:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         p += 48;
1293:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1294:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
1295:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_KEY_EXCHANGE_RSA_PSK_ENABLED */
1296:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE_DHE_PSK_ENABLED)
1297:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( key_ex == MBEDTLS_KEY_EXCHANGE_DHE_PSK )
1298:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1299:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         int ret;
1300:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         size_t len;
1301:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Write length only when we know the actual value */
1303:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_dhm_calc_secret( &ssl->handshake->dhm_ctx,
1304:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                       p + 2, end - ( p + 2 ), &len,
1305:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                       ssl->conf->f_rng, ssl->conf->p_rng ) ) != 0 )
1306:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1307:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_dhm_calc_secret", ret );
1308:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
1309:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1310:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         *(p++) = (unsigned char)( len >> 8 );
1311:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         *(p++) = (unsigned char)( len );
1312:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         p += len;
1313:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1314:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MPI( 3, "DHM: K ", &ssl->handshake->dhm_ctx.K  );
1315:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1316:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
1317:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_KEY_EXCHANGE_DHE_PSK_ENABLED */
1318:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE_ECDHE_PSK_ENABLED)
1319:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( key_ex == MBEDTLS_KEY_EXCHANGE_ECDHE_PSK )
1320:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1321:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         int ret;
1322:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         size_t zlen;
1323:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1324:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_ecdh_calc_secret( &ssl->handshake->ecdh_ctx, &zlen,
1325:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                        p + 2, end - ( p + 2 ),
1326:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                        ssl->conf->f_rng, ssl->conf->p_rng ) ) != 0 )
1327:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1328:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ecdh_calc_secret", ret );
1329:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
1330:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1331:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1332:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         *(p++) = (unsigned char)( zlen >> 8 );
1333:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         *(p++) = (unsigned char)( zlen      );
1334:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         p += zlen;
1335:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1336:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_ECDH( 3, &ssl->handshake->ecdh_ctx,
1337:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 MBEDTLS_DEBUG_ECDH_Z );
GAS LISTING /tmp/ccEn8xFO.s 			page 93


1338:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1339:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
1340:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_KEY_EXCHANGE_ECDHE_PSK_ENABLED */
1341:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1342:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1343:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
1344:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1345:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1346:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* opaque psk<0..2^16-1>; */
1347:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( end - p < 2 )
1348:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
1349:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1350:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     *(p++) = (unsigned char)( psk_len >> 8 );
1351:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     *(p++) = (unsigned char)( psk_len      );
1352:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1353:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( end < p || (size_t)( end - p ) < psk_len )
1354:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
1355:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1356:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( p, psk, psk_len );
1357:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     p += psk_len;
1358:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1359:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->handshake->pmslen = p - ssl->handshake->premaster;
1360:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1361:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
1362:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
1363:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED */
1364:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1365:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
1366:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
1367:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * SSLv3.0 MAC functions
1368:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
1369:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #define SSL_MAC_MAX_BYTES   20  /* MD-5 or SHA-1 */
1370:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_mac( mbedtls_md_context_t *md_ctx,
1371:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      const unsigned char *secret,
1372:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      const unsigned char *buf, size_t len,
1373:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      const unsigned char *ctr, int type,
1374:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      unsigned char out[SSL_MAC_MAX_BYTES] )
1375:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
1376:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char header[11];
1377:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char padding[48];
1378:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int padlen;
1379:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int md_size = mbedtls_md_get_size( md_ctx->md_info );
1380:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int md_type = mbedtls_md_get_type( md_ctx->md_info );
1381:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1382:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Only MD5 and SHA-1 supported */
1383:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( md_type == MBEDTLS_MD_MD5 )
1384:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         padlen = 48;
1385:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
1386:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         padlen = 40;
1387:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1388:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( header, ctr, 8 );
1389:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     header[ 8] = (unsigned char)  type;
1390:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     header[ 9] = (unsigned char)( len >> 8 );
1391:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     header[10] = (unsigned char)( len      );
1392:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1393:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memset( padding, 0x36, padlen );
1394:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_starts( md_ctx );
GAS LISTING /tmp/ccEn8xFO.s 			page 94


1395:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_update( md_ctx, secret,  md_size );
1396:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_update( md_ctx, padding, padlen  );
1397:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_update( md_ctx, header,  11      );
1398:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_update( md_ctx, buf,     len     );
1399:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_finish( md_ctx, out              );
1400:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1401:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memset( padding, 0x5C, padlen );
1402:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_starts( md_ctx );
1403:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_update( md_ctx, secret,    md_size );
1404:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_update( md_ctx, padding,   padlen  );
1405:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_update( md_ctx, out,       md_size );
1406:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_finish( md_ctx, out                );
1407:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
1408:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 */
1409:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1410:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_ARC4_C) || defined(MBEDTLS_CIPHER_NULL_CIPHER) ||     \
1411:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ( defined(MBEDTLS_CIPHER_MODE_CBC) &&                                  \
1412:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****       ( defined(MBEDTLS_AES_C) || defined(MBEDTLS_CAMELLIA_C) || defined(MBEDTLS_ARIA_C)) )
1413:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #define SSL_SOME_MODES_USE_MAC
1414:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
1415:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1416:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /* The function below is only used in the Lucky 13 counter-measure in
1417:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * ssl_decrypt_buf(). These are the defines that guard the call site. */
1418:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(SSL_SOME_MODES_USE_MAC) && \
1419:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ( defined(MBEDTLS_SSL_PROTO_TLS1) || \
1420:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****       defined(MBEDTLS_SSL_PROTO_TLS1_1) || \
1421:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****       defined(MBEDTLS_SSL_PROTO_TLS1_2) )
1422:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /* This function makes sure every byte in the memory region is accessed
1423:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * (in ascending addresses order) */
1424:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_read_memory( unsigned char *p, size_t len )
1425:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 1948              		.loc 4 1425 1
 1949              		.cfi_startproc
 1950 0000 F30F1EFA 		endbr64
 1951 0004 55       		pushq	%rbp
 1952              	.LCFI51:
 1953              		.cfi_def_cfa_offset 16
 1954              		.cfi_offset 6, -16
 1955 0005 4889E5   		movq	%rsp, %rbp
 1956              	.LCFI52:
 1957              		.cfi_def_cfa_register 6
 1958 0008 4883EC20 		subq	$32, %rsp
 1959 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1960 0010 488975E0 		movq	%rsi, -32(%rbp)
 1961              		.loc 4 1425 1
 1962 0014 64488B04 		movq	%fs:40, %rax
 1962      25280000 
 1962      00
 1963 001d 488945F8 		movq	%rax, -8(%rbp)
 1964 0021 31C0     		xorl	%eax, %eax
1426:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char acc = 0;
 1965              		.loc 4 1426 19
 1966 0023 C645F700 		movb	$0, -9(%rbp)
1427:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     volatile unsigned char force;
1428:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1429:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     for( ; len != 0; p++, len-- )
 1967              		.loc 4 1429 5
GAS LISTING /tmp/ccEn8xFO.s 			page 95


 1968 0027 EB14     		jmp	.L125
 1969              	.L126:
1430:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         acc ^= *p;
 1970              		.loc 4 1430 16 discriminator 2
 1971 0029 488B45E8 		movq	-24(%rbp), %rax
 1972 002d 0FB600   		movzbl	(%rax), %eax
 1973              		.loc 4 1430 13 discriminator 2
 1974 0030 3045F7   		xorb	%al, -9(%rbp)
1429:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         acc ^= *p;
 1975              		.loc 4 1429 23 discriminator 2
 1976 0033 488345E8 		addq	$1, -24(%rbp)
 1976      01
1429:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         acc ^= *p;
 1977              		.loc 4 1429 30 discriminator 2
 1978 0038 48836DE0 		subq	$1, -32(%rbp)
 1978      01
 1979              	.L125:
1429:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         acc ^= *p;
 1980              		.loc 4 1429 5 discriminator 1
 1981 003d 48837DE0 		cmpq	$0, -32(%rbp)
 1981      00
 1982 0042 75E5     		jne	.L126
1431:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1432:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     force = acc;
 1983              		.loc 4 1432 11
 1984 0044 0FB645F7 		movzbl	-9(%rbp), %eax
 1985 0048 8845F6   		movb	%al, -10(%rbp)
1433:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     (void) force;
 1986              		.loc 4 1433 5
 1987 004b 0FB645F6 		movzbl	-10(%rbp), %eax
1434:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 1988              		.loc 4 1434 1
 1989 004f 90       		nop
 1990 0050 488B45F8 		movq	-8(%rbp), %rax
 1991 0054 64483304 		xorq	%fs:40, %rax
 1991      25280000 
 1991      00
 1992 005d 7405     		je	.L127
 1993 005f E8000000 		call	__stack_chk_fail@PLT
 1993      00
 1994              	.L127:
 1995 0064 C9       		leave
 1996              	.LCFI53:
 1997              		.cfi_def_cfa 7, 8
 1998 0065 C3       		ret
 1999              		.cfi_endproc
 2000              	.LFE36:
 2002              		.section	.text.ssl_encrypt_buf,"ax",@progbits
 2004              	ssl_encrypt_buf:
 2005              	.LFB37:
1435:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* SSL_SOME_MODES_USE_MAC && ( TLS1 || TLS1_1 || TLS1_2 ) */
1436:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1437:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
1438:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Encryption/decryption functions
1439:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
1440:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_encrypt_buf( mbedtls_ssl_context *ssl )
1441:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
GAS LISTING /tmp/ccEn8xFO.s 			page 96


 2006              		.loc 4 1441 1
 2007              		.cfi_startproc
 2008 0000 F30F1EFA 		endbr64
 2009 0004 55       		pushq	%rbp
 2010              	.LCFI54:
 2011              		.cfi_def_cfa_offset 16
 2012              		.cfi_offset 6, -16
 2013 0005 4889E5   		movq	%rsp, %rbp
 2014              	.LCFI55:
 2015              		.cfi_def_cfa_register 6
 2016 0008 4881ECB0 		subq	$176, %rsp
 2016      000000
 2017 000f 4889BD58 		movq	%rdi, -168(%rbp)
 2017      FFFFFF
 2018              		.loc 4 1441 1
 2019 0016 64488B04 		movq	%fs:40, %rax
 2019      25280000 
 2019      00
 2020 001f 488945F8 		movq	%rax, -8(%rbp)
 2021 0023 31C0     		xorl	%eax, %eax
1442:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_cipher_mode_t mode;
1443:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int auth_done = 0;
 2022              		.loc 4 1443 9
 2023 0025 C78568FF 		movl	$0, -152(%rbp)
 2023      FFFF0000 
 2023      0000
1444:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1445:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> encrypt buf" ) );
1446:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1447:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->session_out == NULL || ssl->transform_out == NULL )
 2024              		.loc 4 1447 12
 2025 002f 488B8558 		movq	-168(%rbp), %rax
 2025      FFFFFF
 2026 0036 488B4048 		movq	72(%rax), %rax
 2027              		.loc 4 1447 7
 2028 003a 4885C0   		testq	%rax, %rax
 2029 003d 7410     		je	.L129
 2030              		.loc 4 1447 40 discriminator 1
 2031 003f 488B8558 		movq	-168(%rbp), %rax
 2031      FFFFFF
 2032 0046 488B4070 		movq	112(%rax), %rax
 2033              		.loc 4 1447 34 discriminator 1
 2034 004a 4885C0   		testq	%rax, %rax
 2035 004d 750A     		jne	.L130
 2036              	.L129:
1448:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1449:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1450:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 2037              		.loc 4 1450 15
 2038 004f B80094FF 		movl	$-27648, %eax
 2038      FF
 2039 0054 E9830700 		jmp	.L131
 2039      00
 2040              	.L130:
1451:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1452:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1453:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mode = mbedtls_cipher_get_cipher_mode( &ssl->transform_out->cipher_ctx_enc );
GAS LISTING /tmp/ccEn8xFO.s 			page 97


 2041              		.loc 4 1453 48
 2042 0059 488B8558 		movq	-168(%rbp), %rax
 2042      FFFFFF
 2043 0060 488B4070 		movq	112(%rax), %rax
 2044              		.loc 4 1453 44
 2045 0064 4883E880 		subq	$-128, %rax
 2046              		.loc 4 1453 12
 2047 0068 4889C7   		movq	%rax, %rdi
 2048 006b E8000000 		call	mbedtls_cipher_get_cipher_mode
 2048      00
 2049 0070 89856CFF 		movl	%eax, -148(%rbp)
 2049      FFFF
1454:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1455:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "before encrypt: output payload",
1456:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                       ssl->out_msg, ssl->out_msglen );
1457:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1458:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
1459:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Add MAC before if needed
1460:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
1461:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(SSL_SOME_MODES_USE_MAC)
1462:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( mode == MBEDTLS_MODE_STREAM ||
 2050              		.loc 4 1462 7
 2051 0076 83BD6CFF 		cmpl	$7, -148(%rbp)
 2051      FFFF07
 2052 007d 740D     		je	.L132
 2053              		.loc 4 1462 37 discriminator 1
 2054 007f 83BD6CFF 		cmpl	$2, -148(%rbp)
 2054      FFFF02
 2055 0086 0F858201 		jne	.L133
 2055      0000
 2056              	.L132:
1463:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ( mode == MBEDTLS_MODE_CBC
1464:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_ENCRYPT_THEN_MAC)
1465:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****           && ssl->session_out->encrypt_then_mac == MBEDTLS_SSL_ETM_DISABLED
1466:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
1467:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ) )
1468:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1469:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
1470:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 )
1471:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1472:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             unsigned char mac[SSL_MAC_MAX_BYTES];
1473:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1474:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl_mac( &ssl->transform_out->md_ctx_enc,
1475:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                       ssl->transform_out->mac_enc,
1476:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                       ssl->out_msg, ssl->out_msglen,
1477:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                       ssl->out_ctr, ssl->out_msgtype,
1478:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                       mac );
1479:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1480:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcpy( ssl->out_msg + ssl->out_msglen, mac, ssl->transform_out->maclen );
1481:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1482:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else
1483:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
1484:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1) || \
1485:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         defined(MBEDTLS_SSL_PROTO_TLS1_2)
1486:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_1 )
 2057              		.loc 4 1486 16
 2058 008c 488B8558 		movq	-168(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 98


 2058      FFFFFF
 2059 0093 8B4018   		movl	24(%rax), %eax
 2060              		.loc 4 1486 11
 2061 0096 85C0     		testl	%eax, %eax
 2062 0098 0F8E6601 		jle	.L134
 2062      0000
 2063              	.LBB6:
1487:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1488:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             unsigned char mac[MBEDTLS_SSL_MAC_ADD];
1489:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1490:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_out->md_ctx_enc, ssl->out_ctr, 8 );
 2064              		.loc 4 1490 73
 2065 009e 488B8558 		movq	-168(%rbp), %rax
 2065      FFFFFF
 2066 00a5 488B8008 		movq	264(%rax), %rax
 2066      010000
 2067              		.loc 4 1490 41
 2068 00ac 488B9558 		movq	-168(%rbp), %rdx
 2068      FFFFFF
 2069 00b3 488B5270 		movq	112(%rdx), %rdx
 2070              		.loc 4 1490 13
 2071 00b7 488D4A50 		leaq	80(%rdx), %rcx
 2072 00bb BA080000 		movl	$8, %edx
 2072      00
 2073 00c0 4889C6   		movq	%rax, %rsi
 2074 00c3 4889CF   		movq	%rcx, %rdi
 2075 00c6 E8000000 		call	mbedtls_md_hmac_update@PLT
 2075      00
1491:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_out->md_ctx_enc, ssl->out_hdr, 3 );
 2076              		.loc 4 1491 73
 2077 00cb 488B8558 		movq	-168(%rbp), %rax
 2077      FFFFFF
 2078 00d2 488B8010 		movq	272(%rax), %rax
 2078      010000
 2079              		.loc 4 1491 41
 2080 00d9 488B9558 		movq	-168(%rbp), %rdx
 2080      FFFFFF
 2081 00e0 488B5270 		movq	112(%rdx), %rdx
 2082              		.loc 4 1491 13
 2083 00e4 488D4A50 		leaq	80(%rdx), %rcx
 2084 00e8 BA030000 		movl	$3, %edx
 2084      00
 2085 00ed 4889C6   		movq	%rax, %rsi
 2086 00f0 4889CF   		movq	%rcx, %rdi
 2087 00f3 E8000000 		call	mbedtls_md_hmac_update@PLT
 2087      00
1492:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_out->md_ctx_enc, ssl->out_len, 2 );
 2088              		.loc 4 1492 73
 2089 00f8 488B8558 		movq	-168(%rbp), %rax
 2089      FFFFFF
 2090 00ff 488B8018 		movq	280(%rax), %rax
 2090      010000
 2091              		.loc 4 1492 41
 2092 0106 488B9558 		movq	-168(%rbp), %rdx
 2092      FFFFFF
 2093 010d 488B5270 		movq	112(%rdx), %rdx
 2094              		.loc 4 1492 13
GAS LISTING /tmp/ccEn8xFO.s 			page 99


 2095 0111 488D4A50 		leaq	80(%rdx), %rcx
 2096 0115 BA020000 		movl	$2, %edx
 2096      00
 2097 011a 4889C6   		movq	%rax, %rsi
 2098 011d 4889CF   		movq	%rcx, %rdi
 2099 0120 E8000000 		call	mbedtls_md_hmac_update@PLT
 2099      00
1493:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_out->md_ctx_enc,
 2100              		.loc 4 1493 13
 2101 0125 488B8558 		movq	-168(%rbp), %rax
 2101      FFFFFF
 2102 012c 488B9038 		movq	312(%rax), %rdx
 2102      010000
1494:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                              ssl->out_msg, ssl->out_msglen );
 2103              		.loc 4 1494 33
 2104 0133 488B8558 		movq	-168(%rbp), %rax
 2104      FFFFFF
 2105 013a 488B8028 		movq	296(%rax), %rax
 2105      010000
1493:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_out->md_ctx_enc,
 2106              		.loc 4 1493 41
 2107 0141 488B8D58 		movq	-168(%rbp), %rcx
 2107      FFFFFF
 2108 0148 488B4970 		movq	112(%rcx), %rcx
1493:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_out->md_ctx_enc,
 2109              		.loc 4 1493 13
 2110 014c 4883C150 		addq	$80, %rcx
 2111 0150 4889C6   		movq	%rax, %rsi
 2112 0153 4889CF   		movq	%rcx, %rdi
 2113 0156 E8000000 		call	mbedtls_md_hmac_update@PLT
 2113      00
1495:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_finish( &ssl->transform_out->md_ctx_enc, mac );
 2114              		.loc 4 1495 41
 2115 015b 488B8558 		movq	-168(%rbp), %rax
 2115      FFFFFF
 2116 0162 488B4070 		movq	112(%rax), %rax
 2117              		.loc 4 1495 13
 2118 0166 488D5050 		leaq	80(%rax), %rdx
 2119 016a 488D45D0 		leaq	-48(%rbp), %rax
 2120 016e 4889C6   		movq	%rax, %rsi
 2121 0171 4889D7   		movq	%rdx, %rdi
 2122 0174 E8000000 		call	mbedtls_md_hmac_finish@PLT
 2122      00
1496:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_reset( &ssl->transform_out->md_ctx_enc );
 2123              		.loc 4 1496 40
 2124 0179 488B8558 		movq	-168(%rbp), %rax
 2124      FFFFFF
 2125 0180 488B4070 		movq	112(%rax), %rax
 2126              		.loc 4 1496 13
 2127 0184 4883C050 		addq	$80, %rax
 2128 0188 4889C7   		movq	%rax, %rdi
 2129 018b E8000000 		call	mbedtls_md_hmac_reset@PLT
 2129      00
1497:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1498:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcpy( ssl->out_msg + ssl->out_msglen, mac, ssl->transform_out->maclen );
 2130              		.loc 4 1498 61
 2131 0190 488B8558 		movq	-168(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 100


 2131      FFFFFF
 2132 0197 488B4070 		movq	112(%rax), %rax
 2133              		.loc 4 1498 13
 2134 019b 488B5028 		movq	40(%rax), %rdx
 2135              		.loc 4 1498 24
 2136 019f 488B8558 		movq	-168(%rbp), %rax
 2136      FFFFFF
 2137 01a6 488B8828 		movq	296(%rax), %rcx
 2137      010000
 2138              		.loc 4 1498 39
 2139 01ad 488B8558 		movq	-168(%rbp), %rax
 2139      FFFFFF
 2140 01b4 488B8038 		movq	312(%rax), %rax
 2140      010000
 2141              		.loc 4 1498 34
 2142 01bb 4801C1   		addq	%rax, %rcx
 2143              		.loc 4 1498 13
 2144 01be 488D45D0 		leaq	-48(%rbp), %rax
 2145 01c2 4889C6   		movq	%rax, %rsi
 2146 01c5 4889CF   		movq	%rcx, %rdi
 2147 01c8 E8000000 		call	memcpy@PLT
 2147      00
 2148              	.LBE6:
1499:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1500:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else
1501:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
1502:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1503:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1504:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
1505:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1506:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1507:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "computed mac",
1508:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                        ssl->out_msg + ssl->out_msglen,
1509:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                        ssl->transform_out->maclen );
1510:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1511:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_msglen += ssl->transform_out->maclen;
 2149              		.loc 4 1511 25
 2150 01cd 488B8558 		movq	-168(%rbp), %rax
 2150      FFFFFF
 2151 01d4 488B9038 		movq	312(%rax), %rdx
 2151      010000
 2152              		.loc 4 1511 31
 2153 01db 488B8558 		movq	-168(%rbp), %rax
 2153      FFFFFF
 2154 01e2 488B4070 		movq	112(%rax), %rax
 2155              		.loc 4 1511 46
 2156 01e6 488B4028 		movq	40(%rax), %rax
 2157              		.loc 4 1511 25
 2158 01ea 4801C2   		addq	%rax, %rdx
 2159 01ed 488B8558 		movq	-168(%rbp), %rax
 2159      FFFFFF
 2160 01f4 48899038 		movq	%rdx, 312(%rax)
 2160      010000
1512:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         auth_done++;
 2161              		.loc 4 1512 18
 2162 01fb 838568FF 		addl	$1, -152(%rbp)
 2162      FFFF01
GAS LISTING /tmp/ccEn8xFO.s 			page 101


 2163 0202 EB0A     		jmp	.L133
 2164              	.L134:
1504:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
 2165              		.loc 4 1504 19
 2166 0204 B80094FF 		movl	$-27648, %eax
 2166      FF
 2167 0209 E9CE0500 		jmp	.L131
 2167      00
 2168              	.L133:
1513:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1514:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* AEAD not the only option */
1515:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1516:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
1517:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Encrypt
1518:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
1519:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_ARC4_C) || defined(MBEDTLS_CIPHER_NULL_CIPHER)
1520:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( mode == MBEDTLS_MODE_STREAM )
1521:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1522:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         int ret;
1523:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         size_t olen = 0;
1524:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1525:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "before encrypt: msglen = %d, "
1526:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             "including %d bytes of padding",
1527:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                        ssl->out_msglen, 0 ) );
1528:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1529:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_cipher_crypt( &ssl->transform_out->cipher_ctx_enc,
1530:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->transform_out->iv_enc,
1531:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->transform_out->ivlen,
1532:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->out_msg, ssl->out_msglen,
1533:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->out_msg, &olen ) ) != 0 )
1534:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1535:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_crypt", ret );
1536:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
1537:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1538:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1539:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->out_msglen != olen )
1540:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1541:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1542:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
1543:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1544:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1545:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
1546:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_ARC4_C || MBEDTLS_CIPHER_NULL_CIPHER */
1547:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_GCM_C) || \
1548:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     defined(MBEDTLS_CCM_C) || \
1549:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     defined(MBEDTLS_CHACHAPOLY_C)
1550:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( mode == MBEDTLS_MODE_GCM ||
 2169              		.loc 4 1550 7
 2170 020e 83BD6CFF 		cmpl	$6, -148(%rbp)
 2170      FFFF06
 2171 0215 7416     		je	.L136
 2172              		.loc 4 1550 34 discriminator 1
 2173 0217 83BD6CFF 		cmpl	$8, -148(%rbp)
 2173      FFFF08
 2174 021e 740D     		je	.L136
1551:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mode == MBEDTLS_MODE_CCM ||
 2175              		.loc 4 1551 34
GAS LISTING /tmp/ccEn8xFO.s 			page 102


 2176 0220 83BD6CFF 		cmpl	$10, -148(%rbp)
 2176      FFFF0A
 2177 0227 0F850F03 		jne	.L137
 2177      0000
 2178              	.L136:
 2179              	.LBB7:
1552:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mode == MBEDTLS_MODE_CHACHAPOLY )
1553:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1554:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         int ret;
1555:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         size_t enc_msglen, olen;
1556:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         unsigned char *enc_msg;
1557:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         unsigned char add_data[13];
1558:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         unsigned char iv[12];
1559:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_transform *transform = ssl->transform_out;
 2180              		.loc 4 1559 32
 2181 022d 488B8558 		movq	-168(%rbp), %rax
 2181      FFFFFF
 2182 0234 488B4070 		movq	112(%rax), %rax
 2183 0238 488945A0 		movq	%rax, -96(%rbp)
1560:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         unsigned char taglen = transform->ciphersuite_info->flags &
 2184              		.loc 4 1560 41
 2185 023c 488B45A0 		movq	-96(%rbp), %rax
 2186 0240 488B00   		movq	(%rax), %rax
 2187              		.loc 4 1560 59
 2188 0243 0FB6402C 		movzbl	44(%rax), %eax
 2189              		.loc 4 1560 67
 2190 0247 0FB6C0   		movzbl	%al, %eax
 2191 024a 83E002   		andl	$2, %eax
 2192              		.loc 4 1560 23
 2193 024d 85C0     		testl	%eax, %eax
 2194 024f 7407     		je	.L138
 2195              		.loc 4 1560 23 is_stmt 0 discriminator 1
 2196 0251 B8080000 		movl	$8, %eax
 2196      00
 2197 0256 EB05     		jmp	.L139
 2198              	.L138:
 2199              		.loc 4 1560 23 discriminator 2
 2200 0258 B8100000 		movl	$16, %eax
 2200      00
 2201              	.L139:
 2202              		.loc 4 1560 23 discriminator 4
 2203 025d 888567FF 		movb	%al, -153(%rbp)
 2203      FFFF
1561:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                MBEDTLS_CIPHERSUITE_SHORT_TAG ? 8 : 16;
1562:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         size_t explicit_ivlen = transform->ivlen - transform->fixed_ivlen;
 2204              		.loc 4 1562 42 is_stmt 1 discriminator 4
 2205 0263 488B45A0 		movq	-96(%rbp), %rax
 2206 0267 488B5018 		movq	24(%rax), %rdx
 2207              		.loc 4 1562 61 discriminator 4
 2208 026b 488B45A0 		movq	-96(%rbp), %rax
 2209 026f 488B4020 		movq	32(%rax), %rax
 2210              		.loc 4 1562 16 discriminator 4
 2211 0273 4829C2   		subq	%rax, %rdx
 2212 0276 4889D0   		movq	%rdx, %rax
 2213 0279 488945A8 		movq	%rax, -88(%rbp)
1563:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1564:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
GAS LISTING /tmp/ccEn8xFO.s 			page 103


1565:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Prepare additional authenticated data
1566:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
1567:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memcpy( add_data, ssl->out_ctr, 8 );
 2214              		.loc 4 1567 30 discriminator 4
 2215 027d 488B8558 		movq	-168(%rbp), %rax
 2215      FFFFFF
 2216 0284 488B8008 		movq	264(%rax), %rax
 2216      010000
 2217 028b 488B00   		movq	(%rax), %rax
 2218              		.loc 4 1567 9 discriminator 4
 2219 028e 488945D0 		movq	%rax, -48(%rbp)
1568:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         add_data[8]  = ssl->out_msgtype;
 2220              		.loc 4 1568 27 discriminator 4
 2221 0292 488B8558 		movq	-168(%rbp), %rax
 2221      FFFFFF
 2222 0299 8B803001 		movl	304(%rax), %eax
 2222      0000
 2223              		.loc 4 1568 22 discriminator 4
 2224 029f 8845D8   		movb	%al, -40(%rbp)
1569:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_write_version( ssl->major_ver, ssl->minor_ver,
 2225              		.loc 4 1569 9 discriminator 4
 2226 02a2 488D45D0 		leaq	-48(%rbp), %rax
 2227 02a6 4883C009 		addq	$9, %rax
1570:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            ssl->conf->transport, add_data + 9 );
 2228              		.loc 4 1570 31 discriminator 4
 2229 02aa 488B9558 		movq	-168(%rbp), %rdx
 2229      FFFFFF
 2230 02b1 488B12   		movq	(%rdx), %rdx
 2231              		.loc 4 1570 37 discriminator 4
 2232 02b4 0FB692BC 		movzbl	188(%rdx), %edx
 2232      000000
 2233 02bb D0EA     		shrb	%dl
 2234 02bd 83E201   		andl	$1, %edx
1569:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_write_version( ssl->major_ver, ssl->minor_ver,
 2235              		.loc 4 1569 9 discriminator 4
 2236 02c0 0FB6D2   		movzbl	%dl, %edx
 2237 02c3 488B8D58 		movq	-168(%rbp), %rcx
 2237      FFFFFF
 2238 02ca 8B7118   		movl	24(%rcx), %esi
 2239 02cd 488B8D58 		movq	-168(%rbp), %rcx
 2239      FFFFFF
 2240 02d4 8B7914   		movl	20(%rcx), %edi
 2241 02d7 4889C1   		movq	%rax, %rcx
 2242 02da E8000000 		call	mbedtls_ssl_write_version
 2242      00
1571:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         add_data[11] = ( ssl->out_msglen >> 8 ) & 0xFF;
 2243              		.loc 4 1571 29 discriminator 4
 2244 02df 488B8558 		movq	-168(%rbp), %rax
 2244      FFFFFF
 2245 02e6 488B8038 		movq	312(%rax), %rax
 2245      010000
 2246              		.loc 4 1571 42 discriminator 4
 2247 02ed 48C1E808 		shrq	$8, %rax
 2248              		.loc 4 1571 22 discriminator 4
 2249 02f1 8845DB   		movb	%al, -37(%rbp)
1572:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         add_data[12] = ssl->out_msglen & 0xFF;
 2250              		.loc 4 1572 27 discriminator 4
GAS LISTING /tmp/ccEn8xFO.s 			page 104


 2251 02f4 488B8558 		movq	-168(%rbp), %rax
 2251      FFFFFF
 2252 02fb 488B8038 		movq	312(%rax), %rax
 2252      010000
 2253              		.loc 4 1572 22 discriminator 4
 2254 0302 8845DC   		movb	%al, -36(%rbp)
1573:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1574:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "additional data for AEAD", add_data, 13 );
1575:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1576:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
1577:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Generate IV
1578:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
1579:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( transform->ivlen == 12 && transform->fixed_ivlen == 4 )
 2255              		.loc 4 1579 22 discriminator 4
 2256 0305 488B45A0 		movq	-96(%rbp), %rax
 2257 0309 488B4018 		movq	24(%rax), %rax
 2258              		.loc 4 1579 11 discriminator 4
 2259 030d 4883F80C 		cmpq	$12, %rax
 2260 0311 7577     		jne	.L140
 2261              		.loc 4 1579 48 discriminator 1
 2262 0313 488B45A0 		movq	-96(%rbp), %rax
 2263 0317 488B4020 		movq	32(%rax), %rax
 2264              		.loc 4 1579 36 discriminator 1
 2265 031b 4883F804 		cmpq	$4, %rax
 2266 031f 7569     		jne	.L140
1580:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1581:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* GCM and CCM: fixed || explicit (=seqnum) */
1582:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcpy( iv, transform->iv_enc, transform->fixed_ivlen );
 2267              		.loc 4 1582 13
 2268 0321 488B45A0 		movq	-96(%rbp), %rax
 2269 0325 488B5020 		movq	32(%rax), %rdx
 2270              		.loc 4 1582 34
 2271 0329 488B45A0 		movq	-96(%rbp), %rax
 2272 032d 488D4830 		leaq	48(%rax), %rcx
 2273              		.loc 4 1582 13
 2274 0331 488D45C4 		leaq	-60(%rbp), %rax
 2275 0335 4889CE   		movq	%rcx, %rsi
 2276 0338 4889C7   		movq	%rax, %rdi
 2277 033b E8000000 		call	memcpy@PLT
 2277      00
1583:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcpy( iv + transform->fixed_ivlen, ssl->out_ctr, 8 );
 2278              		.loc 4 1583 53
 2279 0340 488B8558 		movq	-168(%rbp), %rax
 2279      FFFFFF
 2280 0347 488B8008 		movq	264(%rax), %rax
 2280      010000
 2281              		.loc 4 1583 35
 2282 034e 488B55A0 		movq	-96(%rbp), %rdx
 2283 0352 488B5220 		movq	32(%rdx), %rdx
 2284              		.loc 4 1583 13
 2285 0356 488D4DC4 		leaq	-60(%rbp), %rcx
 2286 035a 4801CA   		addq	%rcx, %rdx
 2287 035d 488B00   		movq	(%rax), %rax
 2288 0360 488902   		movq	%rax, (%rdx)
1584:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcpy( ssl->out_iv, ssl->out_ctr, 8 );
 2289              		.loc 4 1584 37
 2290 0363 488B8558 		movq	-168(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 105


 2290      FFFFFF
 2291 036a 488B9008 		movq	264(%rax), %rdx
 2291      010000
 2292              		.loc 4 1584 24
 2293 0371 488B8558 		movq	-168(%rbp), %rax
 2293      FFFFFF
 2294 0378 488B8020 		movq	288(%rax), %rax
 2294      010000
 2295 037f 488B12   		movq	(%rdx), %rdx
 2296              		.loc 4 1584 13
 2297 0382 488910   		movq	%rdx, (%rax)
 2298 0385 E9AF0000 		jmp	.L141
 2298      00
 2299              	.L140:
1585:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1586:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1587:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else if( transform->ivlen == 12 && transform->fixed_ivlen == 12 )
 2300              		.loc 4 1587 27
 2301 038a 488B45A0 		movq	-96(%rbp), %rax
 2302 038e 488B4018 		movq	24(%rax), %rax
 2303              		.loc 4 1587 16
 2304 0392 4883F80C 		cmpq	$12, %rax
 2305 0396 0F859300 		jne	.L142
 2305      0000
 2306              		.loc 4 1587 53 discriminator 1
 2307 039c 488B45A0 		movq	-96(%rbp), %rax
 2308 03a0 488B4020 		movq	32(%rax), %rax
 2309              		.loc 4 1587 41 discriminator 1
 2310 03a4 4883F80C 		cmpq	$12, %rax
 2311 03a8 0F858100 		jne	.L142
 2311      0000
 2312              	.LBB8:
1588:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1589:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* ChachaPoly: fixed XOR sequence number */
1590:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             unsigned char i;
1591:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1592:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcpy( iv, transform->iv_enc, transform->fixed_ivlen );
 2313              		.loc 4 1592 13
 2314 03ae 488B45A0 		movq	-96(%rbp), %rax
 2315 03b2 488B5020 		movq	32(%rax), %rdx
 2316              		.loc 4 1592 34
 2317 03b6 488B45A0 		movq	-96(%rbp), %rax
 2318 03ba 488D4830 		leaq	48(%rax), %rcx
 2319              		.loc 4 1592 13
 2320 03be 488D45C4 		leaq	-60(%rbp), %rax
 2321 03c2 4889CE   		movq	%rcx, %rsi
 2322 03c5 4889C7   		movq	%rax, %rdi
 2323 03c8 E8000000 		call	memcpy@PLT
 2323      00
1593:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1594:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             for( i = 0; i < 8; i++ )
 2324              		.loc 4 1594 20
 2325 03cd C68566FF 		movb	$0, -154(%rbp)
 2325      FFFF00
 2326              		.loc 4 1594 13
 2327 03d4 EB4E     		jmp	.L143
 2328              	.L144:
GAS LISTING /tmp/ccEn8xFO.s 			page 106


1595:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 iv[i+4] ^= ssl->out_ctr[i];
 2329              		.loc 4 1595 25 discriminator 3
 2330 03d6 0FB68566 		movzbl	-154(%rbp), %eax
 2330      FFFFFF
 2331 03dd 83C004   		addl	$4, %eax
 2332 03e0 4898     		cltq
 2333 03e2 0FB64C05 		movzbl	-60(%rbp,%rax), %ecx
 2333      C4
 2334              		.loc 4 1595 31 discriminator 3
 2335 03e7 488B8558 		movq	-168(%rbp), %rax
 2335      FFFFFF
 2336 03ee 488B9008 		movq	264(%rax), %rdx
 2336      010000
 2337              		.loc 4 1595 40 discriminator 3
 2338 03f5 0FB68566 		movzbl	-154(%rbp), %eax
 2338      FFFFFF
 2339 03fc 4801D0   		addq	%rdx, %rax
 2340 03ff 0FB610   		movzbl	(%rax), %edx
 2341              		.loc 4 1595 25 discriminator 3
 2342 0402 0FB68566 		movzbl	-154(%rbp), %eax
 2342      FFFFFF
 2343 0409 83C004   		addl	$4, %eax
 2344 040c 31CA     		xorl	%ecx, %edx
 2345 040e 4898     		cltq
 2346 0410 885405C4 		movb	%dl, -60(%rbp,%rax)
1594:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 iv[i+4] ^= ssl->out_ctr[i];
 2347              		.loc 4 1594 33 discriminator 3
 2348 0414 0FB68566 		movzbl	-154(%rbp), %eax
 2348      FFFFFF
 2349 041b 83C001   		addl	$1, %eax
 2350 041e 888566FF 		movb	%al, -154(%rbp)
 2350      FFFF
 2351              	.L143:
1594:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 iv[i+4] ^= ssl->out_ctr[i];
 2352              		.loc 4 1594 13 discriminator 1
 2353 0424 80BD66FF 		cmpb	$7, -154(%rbp)
 2353      FFFF07
 2354 042b 76A9     		jbe	.L144
 2355              	.LBE8:
1588:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* ChachaPoly: fixed XOR sequence number */
 2356              		.loc 4 1588 9
 2357 042d EB0A     		jmp	.L141
 2358              	.L142:
1596:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1597:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else
1598:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1599:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Reminder if we ever add an AEAD mode with a different size */
1600:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1601:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 2359              		.loc 4 1601 19
 2360 042f B80094FF 		movl	$-27648, %eax
 2360      FF
 2361 0434 E9A30300 		jmp	.L131
 2361      00
 2362              	.L141:
1602:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1603:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 107


1604:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "IV used (internal)",
1605:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   iv, transform->ivlen );
1606:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "IV used (transmitted)",
1607:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   ssl->out_iv, explicit_ivlen );
1608:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1609:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
1610:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Fix message length with added IV
1611:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
1612:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         enc_msg = ssl->out_msg;
 2363              		.loc 4 1612 17
 2364 0439 488B8558 		movq	-168(%rbp), %rax
 2364      FFFFFF
 2365 0440 488B8028 		movq	296(%rax), %rax
 2365      010000
 2366 0447 488945B0 		movq	%rax, -80(%rbp)
1613:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         enc_msglen = ssl->out_msglen;
 2367              		.loc 4 1613 20
 2368 044b 488B8558 		movq	-168(%rbp), %rax
 2368      FFFFFF
 2369 0452 488B8038 		movq	312(%rax), %rax
 2369      010000
 2370 0459 488945B8 		movq	%rax, -72(%rbp)
1614:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_msglen += explicit_ivlen;
 2371              		.loc 4 1614 25
 2372 045d 488B8558 		movq	-168(%rbp), %rax
 2372      FFFFFF
 2373 0464 488B9038 		movq	312(%rax), %rdx
 2373      010000
 2374 046b 488B45A8 		movq	-88(%rbp), %rax
 2375 046f 4801C2   		addq	%rax, %rdx
 2376 0472 488B8558 		movq	-168(%rbp), %rax
 2376      FFFFFF
 2377 0479 48899038 		movq	%rdx, 312(%rax)
 2377      010000
1615:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1616:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "before encrypt: msglen = %d, "
1617:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     "including 0 bytes of padding",
1618:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     ssl->out_msglen ) );
1619:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1620:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
1621:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Encrypt and authenticate
1622:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
1623:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_cipher_auth_encrypt( &transform->cipher_ctx_enc,
 2378              		.loc 4 1623 21
 2379 0480 0FB6B567 		movzbl	-153(%rbp), %esi
 2379      FFFFFF
 2380 0487 488B55B0 		movq	-80(%rbp), %rdx
 2381 048b 488B45B8 		movq	-72(%rbp), %rax
 2382 048f 4C8D0402 		leaq	(%rdx,%rax), %r8
 2383 0493 488B45A0 		movq	-96(%rbp), %rax
 2384 0497 488B5018 		movq	24(%rax), %rdx
 2385 049b 488B45A0 		movq	-96(%rbp), %rax
 2386 049f 488DB880 		leaq	128(%rax), %rdi
 2386      000000
 2387 04a6 4C8B4DB0 		movq	-80(%rbp), %r9
 2388 04aa 488D4DD0 		leaq	-48(%rbp), %rcx
 2389 04ae 488D45C4 		leaq	-60(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 108


 2390 04b2 4883EC08 		subq	$8, %rsp
 2391 04b6 56       		pushq	%rsi
 2392 04b7 4150     		pushq	%r8
 2393 04b9 488DB578 		leaq	-136(%rbp), %rsi
 2393      FFFFFF
 2394 04c0 56       		pushq	%rsi
 2395 04c1 FF75B0   		pushq	-80(%rbp)
 2396 04c4 FF75B8   		pushq	-72(%rbp)
 2397 04c7 41B80D00 		movl	$13, %r8d
 2397      0000
 2398 04cd 4889C6   		movq	%rax, %rsi
 2399 04d0 E8000000 		call	mbedtls_cipher_auth_encrypt@PLT
 2399      00
 2400 04d5 4883C430 		addq	$48, %rsp
 2401 04d9 898574FF 		movl	%eax, -140(%rbp)
 2401      FFFF
 2402              		.loc 4 1623 11
 2403 04df 83BD74FF 		cmpl	$0, -140(%rbp)
 2403      FFFF00
 2404 04e6 740B     		je	.L146
1624:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                          iv, transform->ivlen,
1625:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                          add_data, 13,
1626:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                          enc_msg, enc_msglen,
1627:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                          enc_msg, &olen,
1628:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                          enc_msg + enc_msglen, taglen ) ) != 0 )
1629:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1630:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_auth_encrypt", ret );
1631:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 2405              		.loc 4 1631 19
 2406 04e8 8B8574FF 		movl	-140(%rbp), %eax
 2406      FFFF
 2407 04ee E9E90200 		jmp	.L131
 2407      00
 2408              	.L146:
1632:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1633:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1634:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( olen != enc_msglen )
 2409              		.loc 4 1634 18
 2410 04f3 488B8578 		movq	-136(%rbp), %rax
 2410      FFFFFF
 2411              		.loc 4 1634 11
 2412 04fa 483945B8 		cmpq	%rax, -72(%rbp)
 2413 04fe 740A     		je	.L147
1635:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1636:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1637:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 2414              		.loc 4 1637 19
 2415 0500 B80094FF 		movl	$-27648, %eax
 2415      FF
 2416 0505 E9D20200 		jmp	.L131
 2416      00
 2417              	.L147:
1638:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1639:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1640:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_msglen += taglen;
 2418              		.loc 4 1640 25
 2419 050a 488B8558 		movq	-168(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 109


 2419      FFFFFF
 2420 0511 488B9038 		movq	312(%rax), %rdx
 2420      010000
 2421 0518 0FB68567 		movzbl	-153(%rbp), %eax
 2421      FFFFFF
 2422 051f 4801C2   		addq	%rax, %rdx
 2423 0522 488B8558 		movq	-168(%rbp), %rax
 2423      FFFFFF
 2424 0529 48899038 		movq	%rdx, 312(%rax)
 2424      010000
1641:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         auth_done++;
 2425              		.loc 4 1641 18
 2426 0530 838568FF 		addl	$1, -152(%rbp)
 2426      FFFF01
 2427              	.LBE7:
1553:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         int ret;
 2428              		.loc 4 1553 5
 2429 0537 E98B0200 		jmp	.L148
 2429      00
 2430              	.L137:
1642:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1643:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "after encrypt: tag", enc_msg + enc_msglen, taglen );
1644:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1645:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
1646:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_GCM_C || MBEDTLS_CCM_C */
1647:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_CIPHER_MODE_CBC) &&                                    \
1648:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ( defined(MBEDTLS_AES_C) || defined(MBEDTLS_CAMELLIA_C) || defined(MBEDTLS_ARIA_C) )
1649:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( mode == MBEDTLS_MODE_CBC )
 2431              		.loc 4 1649 7
 2432 053c 83BD6CFF 		cmpl	$2, -148(%rbp)
 2432      FFFF02
 2433 0543 0F857702 		jne	.L149
 2433      0000
 2434              	.LBB9:
1650:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1651:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         int ret;
1652:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         unsigned char *enc_msg;
1653:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         size_t enc_msglen, padlen, olen = 0, i;
 2435              		.loc 4 1653 36
 2436 0549 48C78578 		movq	$0, -136(%rbp)
 2436      FFFFFF00 
 2436      000000
1654:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1655:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         padlen = ssl->transform_out->ivlen - ( ssl->out_msglen + 1 ) %
 2437              		.loc 4 1655 21
 2438 0554 488B8558 		movq	-168(%rbp), %rax
 2438      FFFFFF
 2439 055b 488B4070 		movq	112(%rax), %rax
 2440              		.loc 4 1655 36
 2441 055f 488B4818 		movq	24(%rax), %rcx
 2442              		.loc 4 1655 51
 2443 0563 488B8558 		movq	-168(%rbp), %rax
 2443      FFFFFF
 2444 056a 488B8038 		movq	312(%rax), %rax
 2444      010000
 2445              		.loc 4 1655 64
 2446 0571 488D5001 		leaq	1(%rax), %rdx
GAS LISTING /tmp/ccEn8xFO.s 			page 110


1656:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                  ssl->transform_out->ivlen;
 2447              		.loc 4 1656 21
 2448 0575 488B8558 		movq	-168(%rbp), %rax
 2448      FFFFFF
 2449 057c 488B4070 		movq	112(%rax), %rax
 2450              		.loc 4 1656 36
 2451 0580 488B7018 		movq	24(%rax), %rsi
1655:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                  ssl->transform_out->ivlen;
 2452              		.loc 4 1655 70
 2453 0584 4889D0   		movq	%rdx, %rax
 2454 0587 BA000000 		movl	$0, %edx
 2454      00
 2455 058c 48F7F6   		divq	%rsi
 2456 058f 4889D0   		movq	%rdx, %rax
1655:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                  ssl->transform_out->ivlen;
 2457              		.loc 4 1655 16
 2458 0592 4829C1   		subq	%rax, %rcx
 2459 0595 4889C8   		movq	%rcx, %rax
 2460 0598 48894590 		movq	%rax, -112(%rbp)
1657:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( padlen == ssl->transform_out->ivlen )
 2461              		.loc 4 1657 26
 2462 059c 488B8558 		movq	-168(%rbp), %rax
 2462      FFFFFF
 2463 05a3 488B4070 		movq	112(%rax), %rax
 2464              		.loc 4 1657 41
 2465 05a7 488B4018 		movq	24(%rax), %rax
 2466              		.loc 4 1657 11
 2467 05ab 48394590 		cmpq	%rax, -112(%rbp)
 2468 05af 7508     		jne	.L150
1658:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             padlen = 0;
 2469              		.loc 4 1658 20
 2470 05b1 48C74590 		movq	$0, -112(%rbp)
 2470      00000000 
 2471              	.L150:
1659:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1660:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         for( i = 0; i <= padlen; i++ )
 2472              		.loc 4 1660 16
 2473 05b9 48C74598 		movq	$0, -104(%rbp)
 2473      00000000 
 2474              		.loc 4 1660 9
 2475 05c1 EB31     		jmp	.L151
 2476              	.L152:
1661:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->out_msg[ssl->out_msglen + i] = (unsigned char) padlen;
 2477              		.loc 4 1661 16 discriminator 3
 2478 05c3 488B8558 		movq	-168(%rbp), %rax
 2478      FFFFFF
 2479 05ca 488B9028 		movq	296(%rax), %rdx
 2479      010000
 2480              		.loc 4 1661 29 discriminator 3
 2481 05d1 488B8558 		movq	-168(%rbp), %rax
 2481      FFFFFF
 2482 05d8 488B8838 		movq	312(%rax), %rcx
 2482      010000
 2483              		.loc 4 1661 42 discriminator 3
 2484 05df 488B4598 		movq	-104(%rbp), %rax
 2485 05e3 4801C8   		addq	%rcx, %rax
 2486              		.loc 4 1661 25 discriminator 3
GAS LISTING /tmp/ccEn8xFO.s 			page 111


 2487 05e6 4801D0   		addq	%rdx, %rax
 2488              		.loc 4 1661 49 discriminator 3
 2489 05e9 488B5590 		movq	-112(%rbp), %rdx
 2490              		.loc 4 1661 47 discriminator 3
 2491 05ed 8810     		movb	%dl, (%rax)
1660:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->out_msg[ssl->out_msglen + i] = (unsigned char) padlen;
 2492              		.loc 4 1660 35 discriminator 3
 2493 05ef 48834598 		addq	$1, -104(%rbp)
 2493      01
 2494              	.L151:
1660:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->out_msg[ssl->out_msglen + i] = (unsigned char) padlen;
 2495              		.loc 4 1660 9 discriminator 1
 2496 05f4 488B4598 		movq	-104(%rbp), %rax
 2497 05f8 483B4590 		cmpq	-112(%rbp), %rax
 2498 05fc 76C5     		jbe	.L152
1662:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1663:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_msglen += padlen + 1;
 2499              		.loc 4 1663 25
 2500 05fe 488B8558 		movq	-168(%rbp), %rax
 2500      FFFFFF
 2501 0605 488B9038 		movq	312(%rax), %rdx
 2501      010000
 2502 060c 488B4590 		movq	-112(%rbp), %rax
 2503 0610 4801D0   		addq	%rdx, %rax
 2504 0613 488D5001 		leaq	1(%rax), %rdx
 2505 0617 488B8558 		movq	-168(%rbp), %rax
 2505      FFFFFF
 2506 061e 48899038 		movq	%rdx, 312(%rax)
 2506      010000
1664:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1665:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         enc_msglen = ssl->out_msglen;
 2507              		.loc 4 1665 20
 2508 0625 488B8558 		movq	-168(%rbp), %rax
 2508      FFFFFF
 2509 062c 488B8038 		movq	312(%rax), %rax
 2509      010000
 2510 0633 48894588 		movq	%rax, -120(%rbp)
1666:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         enc_msg = ssl->out_msg;
 2511              		.loc 4 1666 17
 2512 0637 488B8558 		movq	-168(%rbp), %rax
 2512      FFFFFF
 2513 063e 488B8028 		movq	296(%rax), %rax
 2513      010000
 2514 0645 48894580 		movq	%rax, -128(%rbp)
1667:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1668:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_1) || defined(MBEDTLS_SSL_PROTO_TLS1_2)
1669:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
1670:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Prepend per-record IV for block cipher in TLS v1.1 and up as per
1671:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Method 1 (6.2.3.2. in RFC4346 and RFC5246)
1672:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
1673:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_2 )
 2515              		.loc 4 1673 16
 2516 0649 488B8558 		movq	-168(%rbp), %rax
 2516      FFFFFF
 2517 0650 8B4018   		movl	24(%rax), %eax
 2518              		.loc 4 1673 11
 2519 0653 83F801   		cmpl	$1, %eax
GAS LISTING /tmp/ccEn8xFO.s 			page 112


 2520 0656 0F8EE200 		jle	.L153
 2520      0000
1674:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1675:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /*
1676:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * Generate IV
1677:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              */
1678:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ret = ssl->conf->f_rng( ssl->conf->p_rng, ssl->transform_out->iv_enc,
 2521              		.loc 4 1678 22
 2522 065c 488B8558 		movq	-168(%rbp), %rax
 2522      FFFFFF
 2523 0663 488B00   		movq	(%rax), %rax
 2524              		.loc 4 1678 28
 2525 0666 488B4830 		movq	48(%rax), %rcx
1679:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   ssl->transform_out->ivlen );
 2526              		.loc 4 1679 38
 2527 066a 488B8558 		movq	-168(%rbp), %rax
 2527      FFFFFF
 2528 0671 488B4070 		movq	112(%rax), %rax
1678:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   ssl->transform_out->ivlen );
 2529              		.loc 4 1678 19
 2530 0675 488B5018 		movq	24(%rax), %rdx
1678:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   ssl->transform_out->ivlen );
 2531              		.loc 4 1678 58
 2532 0679 488B8558 		movq	-168(%rbp), %rax
 2532      FFFFFF
 2533 0680 488B4070 		movq	112(%rax), %rax
1678:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   ssl->transform_out->ivlen );
 2534              		.loc 4 1678 73
 2535 0684 488D7030 		leaq	48(%rax), %rsi
1678:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   ssl->transform_out->ivlen );
 2536              		.loc 4 1678 40
 2537 0688 488B8558 		movq	-168(%rbp), %rax
 2537      FFFFFF
 2538 068f 488B00   		movq	(%rax), %rax
1678:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   ssl->transform_out->ivlen );
 2539              		.loc 4 1678 19
 2540 0692 488B4038 		movq	56(%rax), %rax
 2541 0696 4889C7   		movq	%rax, %rdi
 2542 0699 FFD1     		call	*%rcx
 2543              	.LVL7:
 2544 069b 898570FF 		movl	%eax, -144(%rbp)
 2544      FFFF
1680:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ret != 0 )
 2545              		.loc 4 1680 15
 2546 06a1 83BD70FF 		cmpl	$0, -144(%rbp)
 2546      FFFF00
 2547 06a8 740B     		je	.L154
1681:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( ret );
 2548              		.loc 4 1681 23
 2549 06aa 8B8570FF 		movl	-144(%rbp), %eax
 2549      FFFF
 2550 06b0 E9270100 		jmp	.L131
 2550      00
 2551              	.L154:
1682:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1683:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcpy( ssl->out_iv, ssl->transform_out->iv_enc,
1684:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ssl->transform_out->ivlen );
GAS LISTING /tmp/ccEn8xFO.s 			page 113


 2552              		.loc 4 1684 24
 2553 06b5 488B8558 		movq	-168(%rbp), %rax
 2553      FFFFFF
 2554 06bc 488B4070 		movq	112(%rax), %rax
1683:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ssl->transform_out->ivlen );
 2555              		.loc 4 1683 13
 2556 06c0 488B5018 		movq	24(%rax), %rdx
1683:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ssl->transform_out->ivlen );
 2557              		.loc 4 1683 37
 2558 06c4 488B8558 		movq	-168(%rbp), %rax
 2558      FFFFFF
 2559 06cb 488B4070 		movq	112(%rax), %rax
1683:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ssl->transform_out->ivlen );
 2560              		.loc 4 1683 52
 2561 06cf 488D4830 		leaq	48(%rax), %rcx
1683:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ssl->transform_out->ivlen );
 2562              		.loc 4 1683 24
 2563 06d3 488B8558 		movq	-168(%rbp), %rax
 2563      FFFFFF
 2564 06da 488B8020 		movq	288(%rax), %rax
 2564      010000
1683:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ssl->transform_out->ivlen );
 2565              		.loc 4 1683 13
 2566 06e1 4889CE   		movq	%rcx, %rsi
 2567 06e4 4889C7   		movq	%rax, %rdi
 2568 06e7 E8000000 		call	memcpy@PLT
 2568      00
1685:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1686:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /*
1687:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * Fix pointer positions and message length with added IV
1688:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              */
1689:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             enc_msg = ssl->out_msg;
 2569              		.loc 4 1689 21
 2570 06ec 488B8558 		movq	-168(%rbp), %rax
 2570      FFFFFF
 2571 06f3 488B8028 		movq	296(%rax), %rax
 2571      010000
 2572 06fa 48894580 		movq	%rax, -128(%rbp)
1690:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             enc_msglen = ssl->out_msglen;
 2573              		.loc 4 1690 24
 2574 06fe 488B8558 		movq	-168(%rbp), %rax
 2574      FFFFFF
 2575 0705 488B8038 		movq	312(%rax), %rax
 2575      010000
 2576 070c 48894588 		movq	%rax, -120(%rbp)
1691:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->out_msglen += ssl->transform_out->ivlen;
 2577              		.loc 4 1691 29
 2578 0710 488B8558 		movq	-168(%rbp), %rax
 2578      FFFFFF
 2579 0717 488B9038 		movq	312(%rax), %rdx
 2579      010000
 2580              		.loc 4 1691 35
 2581 071e 488B8558 		movq	-168(%rbp), %rax
 2581      FFFFFF
 2582 0725 488B4070 		movq	112(%rax), %rax
 2583              		.loc 4 1691 50
 2584 0729 488B4018 		movq	24(%rax), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 114


 2585              		.loc 4 1691 29
 2586 072d 4801C2   		addq	%rax, %rdx
 2587 0730 488B8558 		movq	-168(%rbp), %rax
 2587      FFFFFF
 2588 0737 48899038 		movq	%rdx, 312(%rax)
 2588      010000
 2589              	.L153:
1692:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1693:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_1 || MBEDTLS_SSL_PROTO_TLS1_2 */
1694:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1695:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "before encrypt: msglen = %d, "
1696:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             "including %d bytes of IV and %d bytes of padding",
1697:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             ssl->out_msglen, ssl->transform_out->ivlen,
1698:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             padlen + 1 ) );
1699:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1700:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_cipher_crypt( &ssl->transform_out->cipher_ctx_enc,
1701:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->transform_out->iv_enc,
1702:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->transform_out->ivlen,
 2590              		.loc 4 1702 39
 2591 073e 488B8558 		movq	-168(%rbp), %rax
 2591      FFFFFF
 2592 0745 488B4070 		movq	112(%rax), %rax
1700:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->transform_out->iv_enc,
 2593              		.loc 4 1700 21
 2594 0749 488B4018 		movq	24(%rax), %rax
1701:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->transform_out->ivlen,
 2595              		.loc 4 1701 39
 2596 074d 488B9558 		movq	-168(%rbp), %rdx
 2596      FFFFFF
 2597 0754 488B5270 		movq	112(%rdx), %rdx
1701:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->transform_out->ivlen,
 2598              		.loc 4 1701 54
 2599 0758 488D7230 		leaq	48(%rdx), %rsi
1700:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->transform_out->iv_enc,
 2600              		.loc 4 1700 47
 2601 075c 488B9558 		movq	-168(%rbp), %rdx
 2601      FFFFFF
 2602 0763 488B5270 		movq	112(%rdx), %rdx
1700:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->transform_out->iv_enc,
 2603              		.loc 4 1700 21
 2604 0767 488DBA80 		leaq	128(%rdx), %rdi
 2604      000000
 2605 076e 4C8B4D80 		movq	-128(%rbp), %r9
 2606 0772 4C8B4588 		movq	-120(%rbp), %r8
 2607 0776 488B5580 		movq	-128(%rbp), %rdx
 2608 077a 4883EC08 		subq	$8, %rsp
 2609 077e 488D8D78 		leaq	-136(%rbp), %rcx
 2609      FFFFFF
 2610 0785 51       		pushq	%rcx
 2611 0786 4889D1   		movq	%rdx, %rcx
 2612 0789 4889C2   		movq	%rax, %rdx
 2613 078c E8000000 		call	mbedtls_cipher_crypt@PLT
 2613      00
 2614 0791 4883C410 		addq	$16, %rsp
 2615 0795 898570FF 		movl	%eax, -144(%rbp)
 2615      FFFF
1700:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->transform_out->iv_enc,
GAS LISTING /tmp/ccEn8xFO.s 			page 115


 2616              		.loc 4 1700 11
 2617 079b 83BD70FF 		cmpl	$0, -144(%rbp)
 2617      FFFF00
 2618 07a2 7408     		je	.L156
1703:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    enc_msg, enc_msglen,
1704:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    enc_msg, &olen ) ) != 0 )
1705:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1706:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_crypt", ret );
1707:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 2619              		.loc 4 1707 19
 2620 07a4 8B8570FF 		movl	-144(%rbp), %eax
 2620      FFFF
 2621 07aa EB30     		jmp	.L131
 2622              	.L156:
1708:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1709:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1710:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( enc_msglen != olen )
 2623              		.loc 4 1710 24
 2624 07ac 488B8578 		movq	-136(%rbp), %rax
 2624      FFFFFF
 2625              		.loc 4 1710 11
 2626 07b3 48394588 		cmpq	%rax, -120(%rbp)
 2627 07b7 740E     		je	.L148
1711:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1712:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1713:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 2628              		.loc 4 1713 19
 2629 07b9 B80094FF 		movl	$-27648, %eax
 2629      FF
 2630 07be EB1C     		jmp	.L131
 2631              	.L149:
 2632              	.LBE9:
1714:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1715:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1716:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1)
1717:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->minor_ver < MBEDTLS_SSL_MINOR_VERSION_2 )
1718:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1719:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /*
1720:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * Save IV in SSL3 and TLS1
1721:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              */
1722:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcpy( ssl->transform_out->iv_enc,
1723:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ssl->transform_out->cipher_ctx_enc.iv,
1724:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ssl->transform_out->ivlen );
1725:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1726:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
1727:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1728:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_ENCRYPT_THEN_MAC)
1729:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( auth_done == 0 )
1730:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1731:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             unsigned char mac[MBEDTLS_SSL_MAC_ADD];
1732:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1733:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /*
1734:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * MAC(MAC_write_key, seq_num +
1735:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *     TLSCipherText.type +
1736:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *     TLSCipherText.version +
1737:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *     length_of( (IV +) ENC(...) ) +
1738:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *     IV + // except for TLS 1.0
GAS LISTING /tmp/ccEn8xFO.s 			page 116


1739:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *     ENC(content + padding + padding_length));
1740:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              */
1741:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             unsigned char pseudo_hdr[13];
1742:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1743:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "using encrypt then mac" ) );
1744:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1745:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcpy( pseudo_hdr +  0, ssl->out_ctr, 8 );
1746:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcpy( pseudo_hdr +  8, ssl->out_hdr, 3 );
1747:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             pseudo_hdr[11] = (unsigned char)( ( ssl->out_msglen >> 8 ) & 0xFF );
1748:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             pseudo_hdr[12] = (unsigned char)( ( ssl->out_msglen      ) & 0xFF );
1749:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1750:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_BUF( 4, "MAC'd meta-data", pseudo_hdr, 13 );
1751:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1752:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_out->md_ctx_enc, pseudo_hdr, 13 );
1753:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_out->md_ctx_enc,
1754:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                              ssl->out_iv, ssl->out_msglen );
1755:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_finish( &ssl->transform_out->md_ctx_enc, mac );
1756:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_reset( &ssl->transform_out->md_ctx_enc );
1757:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1758:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcpy( ssl->out_iv + ssl->out_msglen, mac,
1759:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ssl->transform_out->maclen );
1760:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1761:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->out_msglen += ssl->transform_out->maclen;
1762:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             auth_done++;
1763:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1764:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_ENCRYPT_THEN_MAC */
1765:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1766:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
1767:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_CIPHER_MODE_CBC &&
1768:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****           ( MBEDTLS_AES_C || MBEDTLS_CAMELLIA_C || MBEDTLS_ARIA_C ) */
1769:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1770:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1771:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 2633              		.loc 4 1771 15
 2634 07c0 B80094FF 		movl	$-27648, %eax
 2634      FF
 2635 07c5 EB15     		jmp	.L131
 2636              	.L148:
1772:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1773:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1774:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Make extra sure authentication was performed, exactly once */
1775:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( auth_done != 1 )
 2637              		.loc 4 1775 7
 2638 07c7 83BD68FF 		cmpl	$1, -152(%rbp)
 2638      FFFF01
 2639 07ce 7407     		je	.L158
1776:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1777:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1778:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 2640              		.loc 4 1778 15
 2641 07d0 B80094FF 		movl	$-27648, %eax
 2641      FF
 2642 07d5 EB05     		jmp	.L131
 2643              	.L158:
1779:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1780:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1781:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= encrypt buf" ) );
GAS LISTING /tmp/ccEn8xFO.s 			page 117


1782:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1783:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 2644              		.loc 4 1783 11
 2645 07d7 B8000000 		movl	$0, %eax
 2645      00
 2646              	.L131:
1784:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 2647              		.loc 4 1784 1
 2648 07dc 488B7DF8 		movq	-8(%rbp), %rdi
 2649 07e0 6448333C 		xorq	%fs:40, %rdi
 2649      25280000 
 2649      00
 2650 07e9 7405     		je	.L159
 2651 07eb E8000000 		call	__stack_chk_fail@PLT
 2651      00
 2652              	.L159:
 2653 07f0 C9       		leave
 2654              	.LCFI56:
 2655              		.cfi_def_cfa 7, 8
 2656 07f1 C3       		ret
 2657              		.cfi_endproc
 2658              	.LFE37:
 2660              		.section	.text.ssl_decrypt_buf,"ax",@progbits
 2662              	ssl_decrypt_buf:
 2663              	.LFB38:
1785:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1786:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_decrypt_buf( mbedtls_ssl_context *ssl )
1787:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 2664              		.loc 4 1787 1
 2665              		.cfi_startproc
 2666 0000 F30F1EFA 		endbr64
 2667 0004 55       		pushq	%rbp
 2668              	.LCFI57:
 2669              		.cfi_def_cfa_offset 16
 2670              		.cfi_offset 6, -16
 2671 0005 4889E5   		movq	%rsp, %rbp
 2672              	.LCFI58:
 2673              		.cfi_def_cfa_register 6
 2674 0008 53       		pushq	%rbx
 2675 0009 4881EC18 		subq	$280, %rsp
 2675      010000
 2676              		.cfi_offset 3, -24
 2677 0010 4889BDE8 		movq	%rdi, -280(%rbp)
 2677      FEFFFF
 2678              		.loc 4 1787 1
 2679 0017 64488B04 		movq	%fs:40, %rax
 2679      25280000 
 2679      00
 2680 0020 488945E8 		movq	%rax, -24(%rbp)
 2681 0024 31C0     		xorl	%eax, %eax
1788:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_cipher_mode_t mode;
1789:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int auth_done = 0;
 2682              		.loc 4 1789 9
 2683 0026 C78500FF 		movl	$0, -256(%rbp)
 2683      FFFF0000 
 2683      0000
1790:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(SSL_SOME_MODES_USE_MAC)
GAS LISTING /tmp/ccEn8xFO.s 			page 118


1791:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t padlen = 0, correct = 1;
 2684              		.loc 4 1791 12
 2685 0030 48C78518 		movq	$0, -232(%rbp)
 2685      FFFFFF00 
 2685      000000
 2686              		.loc 4 1791 24
 2687 003b 48C78520 		movq	$1, -224(%rbp)
 2687      FFFFFF01 
 2687      000000
1792:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
1793:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1794:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> decrypt buf" ) );
1795:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1796:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->session_in == NULL || ssl->transform_in == NULL )
 2688              		.loc 4 1796 12
 2689 0046 488B85E8 		movq	-280(%rbp), %rax
 2689      FEFFFF
 2690 004d 488B4040 		movq	64(%rax), %rax
 2691              		.loc 4 1796 7
 2692 0051 4885C0   		testq	%rax, %rax
 2693 0054 7410     		je	.L161
 2694              		.loc 4 1796 39 discriminator 1
 2695 0056 488B85E8 		movq	-280(%rbp), %rax
 2695      FEFFFF
 2696 005d 488B4068 		movq	104(%rax), %rax
 2697              		.loc 4 1796 33 discriminator 1
 2698 0061 4885C0   		testq	%rax, %rax
 2699 0064 750A     		jne	.L162
 2700              	.L161:
1797:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1798:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1799:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 2701              		.loc 4 1799 15
 2702 0066 B80094FF 		movl	$-27648, %eax
 2702      FF
 2703 006b E9F90C00 		jmp	.L163
 2703      00
 2704              	.L162:
1800:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1801:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1802:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mode = mbedtls_cipher_get_cipher_mode( &ssl->transform_in->cipher_ctx_dec );
 2705              		.loc 4 1802 48
 2706 0070 488B85E8 		movq	-280(%rbp), %rax
 2706      FEFFFF
 2707 0077 488B4068 		movq	104(%rax), %rax
 2708              		.loc 4 1802 44
 2709 007b 4805D800 		addq	$216, %rax
 2709      0000
 2710              		.loc 4 1802 12
 2711 0081 4889C7   		movq	%rax, %rdi
 2712 0084 E8000000 		call	mbedtls_cipher_get_cipher_mode
 2712      00
 2713 0089 898504FF 		movl	%eax, -252(%rbp)
 2713      FFFF
1803:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1804:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_msglen < ssl->transform_in->minlen )
 2714              		.loc 4 1804 12
GAS LISTING /tmp/ccEn8xFO.s 			page 119


 2715 008f 488B85E8 		movq	-280(%rbp), %rax
 2715      FEFFFF
 2716 0096 488B90E0 		movq	224(%rax), %rdx
 2716      000000
 2717              		.loc 4 1804 29
 2718 009d 488B85E8 		movq	-280(%rbp), %rax
 2718      FEFFFF
 2719 00a4 488B4068 		movq	104(%rax), %rax
 2720              		.loc 4 1804 43
 2721 00a8 488B4010 		movq	16(%rax), %rax
 2722              		.loc 4 1804 7
 2723 00ac 4839C2   		cmpq	%rax, %rdx
 2724 00af 730A     		jnb	.L164
1805:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1806:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "in_msglen (%d) < minlen (%d)",
1807:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                        ssl->in_msglen, ssl->transform_in->minlen ) );
1808:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INVALID_MAC );
 2725              		.loc 4 1808 15
 2726 00b1 B8808EFF 		movl	$-29056, %eax
 2726      FF
 2727 00b6 E9AE0C00 		jmp	.L163
 2727      00
 2728              	.L164:
1809:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1810:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1811:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_ARC4_C) || defined(MBEDTLS_CIPHER_NULL_CIPHER)
1812:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( mode == MBEDTLS_MODE_STREAM )
1813:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1814:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         int ret;
1815:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         size_t olen = 0;
1816:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1817:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         padlen = 0;
1818:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1819:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_cipher_crypt( &ssl->transform_in->cipher_ctx_dec,
1820:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->transform_in->iv_dec,
1821:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->transform_in->ivlen,
1822:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->in_msg, ssl->in_msglen,
1823:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->in_msg, &olen ) ) != 0 )
1824:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1825:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_crypt", ret );
1826:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
1827:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1828:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1829:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_msglen != olen )
1830:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1831:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1832:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
1833:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1834:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1835:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
1836:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_ARC4_C || MBEDTLS_CIPHER_NULL_CIPHER */
1837:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_GCM_C) || \
1838:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     defined(MBEDTLS_CCM_C) || \
1839:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     defined(MBEDTLS_CHACHAPOLY_C)
1840:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( mode == MBEDTLS_MODE_GCM ||
 2729              		.loc 4 1840 7
 2730 00bb 83BD04FF 		cmpl	$6, -252(%rbp)
GAS LISTING /tmp/ccEn8xFO.s 			page 120


 2730      FFFF06
 2731 00c2 7416     		je	.L165
 2732              		.loc 4 1840 34 discriminator 1
 2733 00c4 83BD04FF 		cmpl	$8, -252(%rbp)
 2733      FFFF08
 2734 00cb 740D     		je	.L165
1841:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mode == MBEDTLS_MODE_CCM ||
 2735              		.loc 4 1841 34
 2736 00cd 83BD04FF 		cmpl	$10, -252(%rbp)
 2736      FFFF0A
 2737 00d4 0F855603 		jne	.L166
 2737      0000
 2738              	.L165:
 2739              	.LBB10:
1842:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mode == MBEDTLS_MODE_CHACHAPOLY )
1843:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1844:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         int ret;
1845:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         size_t dec_msglen, olen;
1846:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         unsigned char *dec_msg;
1847:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         unsigned char *dec_msg_result;
1848:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         unsigned char add_data[13];
1849:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         unsigned char iv[12];
1850:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_transform *transform = ssl->transform_in;
 2740              		.loc 4 1850 32
 2741 00da 488B85E8 		movq	-280(%rbp), %rax
 2741      FEFFFF
 2742 00e1 488B4068 		movq	104(%rax), %rax
 2743 00e5 48898570 		movq	%rax, -144(%rbp)
 2743      FFFFFF
1851:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         unsigned char taglen = transform->ciphersuite_info->flags &
 2744              		.loc 4 1851 41
 2745 00ec 488B8570 		movq	-144(%rbp), %rax
 2745      FFFFFF
 2746 00f3 488B00   		movq	(%rax), %rax
 2747              		.loc 4 1851 59
 2748 00f6 0FB6402C 		movzbl	44(%rax), %eax
 2749              		.loc 4 1851 67
 2750 00fa 0FB6C0   		movzbl	%al, %eax
 2751 00fd 83E002   		andl	$2, %eax
 2752              		.loc 4 1851 23
 2753 0100 85C0     		testl	%eax, %eax
 2754 0102 7407     		je	.L167
 2755              		.loc 4 1851 23 is_stmt 0 discriminator 1
 2756 0104 B8080000 		movl	$8, %eax
 2756      00
 2757 0109 EB05     		jmp	.L168
 2758              	.L167:
 2759              		.loc 4 1851 23 discriminator 2
 2760 010b B8100000 		movl	$16, %eax
 2760      00
 2761              	.L168:
 2762              		.loc 4 1851 23 discriminator 4
 2763 0110 8885FFFE 		movb	%al, -257(%rbp)
 2763      FFFF
1852:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                MBEDTLS_CIPHERSUITE_SHORT_TAG ? 8 : 16;
1853:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         size_t explicit_iv_len = transform->ivlen - transform->fixed_ivlen;
 2764              		.loc 4 1853 43 is_stmt 1 discriminator 4
GAS LISTING /tmp/ccEn8xFO.s 			page 121


 2765 0116 488B8570 		movq	-144(%rbp), %rax
 2765      FFFFFF
 2766 011d 488B5018 		movq	24(%rax), %rdx
 2767              		.loc 4 1853 62 discriminator 4
 2768 0121 488B8570 		movq	-144(%rbp), %rax
 2768      FFFFFF
 2769 0128 488B4020 		movq	32(%rax), %rax
 2770              		.loc 4 1853 16 discriminator 4
 2771 012c 4829C2   		subq	%rax, %rdx
 2772 012f 4889D0   		movq	%rdx, %rax
 2773 0132 48898578 		movq	%rax, -136(%rbp)
 2773      FFFFFF
1854:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1855:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
1856:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Compute and update sizes
1857:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
1858:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_msglen < explicit_iv_len + taglen )
 2774              		.loc 4 1858 16 discriminator 4
 2775 0139 488B85E8 		movq	-280(%rbp), %rax
 2775      FEFFFF
 2776 0140 488B80E0 		movq	224(%rax), %rax
 2776      000000
 2777              		.loc 4 1858 46 discriminator 4
 2778 0147 0FB68DFF 		movzbl	-257(%rbp), %ecx
 2778      FEFFFF
 2779 014e 488B9578 		movq	-136(%rbp), %rdx
 2779      FFFFFF
 2780 0155 4801CA   		addq	%rcx, %rdx
 2781              		.loc 4 1858 11 discriminator 4
 2782 0158 4839D0   		cmpq	%rdx, %rax
 2783 015b 730A     		jnb	.L169
1859:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1860:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "msglen (%d) < explicit_iv_len (%d) "
1861:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 "+ taglen (%d)", ssl->in_msglen,
1862:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 explicit_iv_len, taglen ) );
1863:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_MAC );
 2784              		.loc 4 1863 19
 2785 015d B8808EFF 		movl	$-29056, %eax
 2785      FF
 2786 0162 E9020C00 		jmp	.L163
 2786      00
 2787              	.L169:
1864:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1865:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         dec_msglen = ssl->in_msglen - explicit_iv_len - taglen;
 2788              		.loc 4 1865 25
 2789 0167 488B85E8 		movq	-280(%rbp), %rax
 2789      FEFFFF
 2790 016e 488B80E0 		movq	224(%rax), %rax
 2790      000000
 2791              		.loc 4 1865 37
 2792 0175 482B8578 		subq	-136(%rbp), %rax
 2792      FFFFFF
 2793 017c 4889C2   		movq	%rax, %rdx
 2794              		.loc 4 1865 55
 2795 017f 0FB685FF 		movzbl	-257(%rbp), %eax
 2795      FEFFFF
 2796              		.loc 4 1865 20
GAS LISTING /tmp/ccEn8xFO.s 			page 122


 2797 0186 4829C2   		subq	%rax, %rdx
 2798 0189 4889D0   		movq	%rdx, %rax
 2799 018c 48894580 		movq	%rax, -128(%rbp)
1866:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1867:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         dec_msg = ssl->in_msg;
 2800              		.loc 4 1867 17
 2801 0190 488B85E8 		movq	-280(%rbp), %rax
 2801      FEFFFF
 2802 0197 488B80C8 		movq	200(%rax), %rax
 2802      000000
 2803 019e 48894588 		movq	%rax, -120(%rbp)
1868:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         dec_msg_result = ssl->in_msg;
 2804              		.loc 4 1868 24
 2805 01a2 488B85E8 		movq	-280(%rbp), %rax
 2805      FEFFFF
 2806 01a9 488B80C8 		movq	200(%rax), %rax
 2806      000000
 2807 01b0 48894590 		movq	%rax, -112(%rbp)
1869:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_msglen = dec_msglen;
 2808              		.loc 4 1869 24
 2809 01b4 488B85E8 		movq	-280(%rbp), %rax
 2809      FEFFFF
 2810 01bb 488B5580 		movq	-128(%rbp), %rdx
 2811 01bf 488990E0 		movq	%rdx, 224(%rax)
 2811      000000
1870:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1871:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
1872:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Prepare additional authenticated data
1873:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
1874:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memcpy( add_data, ssl->in_ctr, 8 );
 2812              		.loc 4 1874 30
 2813 01c6 488B85E8 		movq	-280(%rbp), %rax
 2813      FEFFFF
 2814 01cd 488B80A8 		movq	168(%rax), %rax
 2814      000000
 2815 01d4 488B00   		movq	(%rax), %rax
 2816              		.loc 4 1874 9
 2817 01d7 488945C0 		movq	%rax, -64(%rbp)
1875:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         add_data[8]  = ssl->in_msgtype;
 2818              		.loc 4 1875 27
 2819 01db 488B85E8 		movq	-280(%rbp), %rax
 2819      FEFFFF
 2820 01e2 8B80D800 		movl	216(%rax), %eax
 2820      0000
 2821              		.loc 4 1875 22
 2822 01e8 8845C8   		movb	%al, -56(%rbp)
1876:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_write_version( ssl->major_ver, ssl->minor_ver,
 2823              		.loc 4 1876 9
 2824 01eb 488D45C0 		leaq	-64(%rbp), %rax
 2825 01ef 4883C009 		addq	$9, %rax
1877:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            ssl->conf->transport, add_data + 9 );
 2826              		.loc 4 1877 31
 2827 01f3 488B95E8 		movq	-280(%rbp), %rdx
 2827      FEFFFF
 2828 01fa 488B12   		movq	(%rdx), %rdx
 2829              		.loc 4 1877 37
 2830 01fd 0FB692BC 		movzbl	188(%rdx), %edx
GAS LISTING /tmp/ccEn8xFO.s 			page 123


 2830      000000
 2831 0204 D0EA     		shrb	%dl
 2832 0206 83E201   		andl	$1, %edx
1876:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_write_version( ssl->major_ver, ssl->minor_ver,
 2833              		.loc 4 1876 9
 2834 0209 0FB6D2   		movzbl	%dl, %edx
 2835 020c 488B8DE8 		movq	-280(%rbp), %rcx
 2835      FEFFFF
 2836 0213 8B7118   		movl	24(%rcx), %esi
 2837 0216 488B8DE8 		movq	-280(%rbp), %rcx
 2837      FEFFFF
 2838 021d 8B7914   		movl	20(%rcx), %edi
 2839 0220 4889C1   		movq	%rax, %rcx
 2840 0223 E8000000 		call	mbedtls_ssl_write_version
 2840      00
1878:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         add_data[11] = ( ssl->in_msglen >> 8 ) & 0xFF;
 2841              		.loc 4 1878 29
 2842 0228 488B85E8 		movq	-280(%rbp), %rax
 2842      FEFFFF
 2843 022f 488B80E0 		movq	224(%rax), %rax
 2843      000000
 2844              		.loc 4 1878 41
 2845 0236 48C1E808 		shrq	$8, %rax
 2846              		.loc 4 1878 22
 2847 023a 8845CB   		movb	%al, -53(%rbp)
1879:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         add_data[12] = ssl->in_msglen & 0xFF;
 2848              		.loc 4 1879 27
 2849 023d 488B85E8 		movq	-280(%rbp), %rax
 2849      FEFFFF
 2850 0244 488B80E0 		movq	224(%rax), %rax
 2850      000000
 2851              		.loc 4 1879 22
 2852 024b 8845CC   		movb	%al, -52(%rbp)
1880:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1881:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "additional data for AEAD", add_data, 13 );
1882:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1883:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
1884:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Prepare IV
1885:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
1886:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( transform->ivlen == 12 && transform->fixed_ivlen == 4 )
 2853              		.loc 4 1886 22
 2854 024e 488B8570 		movq	-144(%rbp), %rax
 2854      FFFFFF
 2855 0255 488B4018 		movq	24(%rax), %rax
 2856              		.loc 4 1886 11
 2857 0259 4883F80C 		cmpq	$12, %rax
 2858 025d 7561     		jne	.L171
 2859              		.loc 4 1886 48 discriminator 1
 2860 025f 488B8570 		movq	-144(%rbp), %rax
 2860      FFFFFF
 2861 0266 488B4020 		movq	32(%rax), %rax
 2862              		.loc 4 1886 36 discriminator 1
 2863 026a 4883F804 		cmpq	$4, %rax
 2864 026e 7550     		jne	.L171
1887:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1888:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* GCM and CCM: fixed || explicit (transmitted) */
1889:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcpy( iv, transform->iv_dec, transform->fixed_ivlen );
GAS LISTING /tmp/ccEn8xFO.s 			page 124


 2865              		.loc 4 1889 13
 2866 0270 488B8570 		movq	-144(%rbp), %rax
 2866      FFFFFF
 2867 0277 488B5020 		movq	32(%rax), %rdx
 2868              		.loc 4 1889 34
 2869 027b 488B8570 		movq	-144(%rbp), %rax
 2869      FFFFFF
 2870 0282 488D4840 		leaq	64(%rax), %rcx
 2871              		.loc 4 1889 13
 2872 0286 488D45B4 		leaq	-76(%rbp), %rax
 2873 028a 4889CE   		movq	%rcx, %rsi
 2874 028d 4889C7   		movq	%rax, %rdi
 2875 0290 E8000000 		call	memcpy@PLT
 2875      00
1890:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcpy( iv + transform->fixed_ivlen, ssl->in_iv, 8 );
 2876              		.loc 4 1890 53
 2877 0295 488B85E8 		movq	-280(%rbp), %rax
 2877      FEFFFF
 2878 029c 488B80C0 		movq	192(%rax), %rax
 2878      000000
 2879              		.loc 4 1890 35
 2880 02a3 488B9570 		movq	-144(%rbp), %rdx
 2880      FFFFFF
 2881 02aa 488B5220 		movq	32(%rdx), %rdx
 2882              		.loc 4 1890 13
 2883 02ae 488D4DB4 		leaq	-76(%rbp), %rcx
 2884 02b2 4801CA   		addq	%rcx, %rdx
 2885 02b5 488B00   		movq	(%rax), %rax
 2886 02b8 488902   		movq	%rax, (%rdx)
 2887 02bb E9BB0000 		jmp	.L172
 2887      00
 2888              	.L171:
1891:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1892:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1893:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else if( transform->ivlen == 12 && transform->fixed_ivlen == 12 )
 2889              		.loc 4 1893 27
 2890 02c0 488B8570 		movq	-144(%rbp), %rax
 2890      FFFFFF
 2891 02c7 488B4018 		movq	24(%rax), %rax
 2892              		.loc 4 1893 16
 2893 02cb 4883F80C 		cmpq	$12, %rax
 2894 02cf 0F859C00 		jne	.L173
 2894      0000
 2895              		.loc 4 1893 53 discriminator 1
 2896 02d5 488B8570 		movq	-144(%rbp), %rax
 2896      FFFFFF
 2897 02dc 488B4020 		movq	32(%rax), %rax
 2898              		.loc 4 1893 41 discriminator 1
 2899 02e0 4883F80C 		cmpq	$12, %rax
 2900 02e4 0F858700 		jne	.L173
 2900      0000
 2901              	.LBB11:
1894:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1895:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* ChachaPoly: fixed XOR sequence number */
1896:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             unsigned char i;
1897:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1898:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcpy( iv, transform->iv_dec, transform->fixed_ivlen );
GAS LISTING /tmp/ccEn8xFO.s 			page 125


 2902              		.loc 4 1898 13
 2903 02ea 488B8570 		movq	-144(%rbp), %rax
 2903      FFFFFF
 2904 02f1 488B5020 		movq	32(%rax), %rdx
 2905              		.loc 4 1898 34
 2906 02f5 488B8570 		movq	-144(%rbp), %rax
 2906      FFFFFF
 2907 02fc 488D4840 		leaq	64(%rax), %rcx
 2908              		.loc 4 1898 13
 2909 0300 488D45B4 		leaq	-76(%rbp), %rax
 2910 0304 4889CE   		movq	%rcx, %rsi
 2911 0307 4889C7   		movq	%rax, %rdi
 2912 030a E8000000 		call	memcpy@PLT
 2912      00
1899:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1900:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             for( i = 0; i < 8; i++ )
 2913              		.loc 4 1900 20
 2914 030f C685FCFE 		movb	$0, -260(%rbp)
 2914      FFFF00
 2915              		.loc 4 1900 13
 2916 0316 EB4E     		jmp	.L174
 2917              	.L175:
1901:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 iv[i+4] ^= ssl->in_ctr[i];
 2918              		.loc 4 1901 25 discriminator 3
 2919 0318 0FB685FC 		movzbl	-260(%rbp), %eax
 2919      FEFFFF
 2920 031f 83C004   		addl	$4, %eax
 2921 0322 4898     		cltq
 2922 0324 0FB64C05 		movzbl	-76(%rbp,%rax), %ecx
 2922      B4
 2923              		.loc 4 1901 31 discriminator 3
 2924 0329 488B85E8 		movq	-280(%rbp), %rax
 2924      FEFFFF
 2925 0330 488B90A8 		movq	168(%rax), %rdx
 2925      000000
 2926              		.loc 4 1901 39 discriminator 3
 2927 0337 0FB685FC 		movzbl	-260(%rbp), %eax
 2927      FEFFFF
 2928 033e 4801D0   		addq	%rdx, %rax
 2929 0341 0FB610   		movzbl	(%rax), %edx
 2930              		.loc 4 1901 25 discriminator 3
 2931 0344 0FB685FC 		movzbl	-260(%rbp), %eax
 2931      FEFFFF
 2932 034b 83C004   		addl	$4, %eax
 2933 034e 31CA     		xorl	%ecx, %edx
 2934 0350 4898     		cltq
 2935 0352 885405B4 		movb	%dl, -76(%rbp,%rax)
1900:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 iv[i+4] ^= ssl->in_ctr[i];
 2936              		.loc 4 1900 33 discriminator 3
 2937 0356 0FB685FC 		movzbl	-260(%rbp), %eax
 2937      FEFFFF
 2938 035d 83C001   		addl	$1, %eax
 2939 0360 8885FCFE 		movb	%al, -260(%rbp)
 2939      FFFF
 2940              	.L174:
1900:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 iv[i+4] ^= ssl->in_ctr[i];
 2941              		.loc 4 1900 13 discriminator 1
GAS LISTING /tmp/ccEn8xFO.s 			page 126


 2942 0366 80BDFCFE 		cmpb	$7, -260(%rbp)
 2942      FFFF07
 2943 036d 76A9     		jbe	.L175
 2944              	.LBE11:
1894:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* ChachaPoly: fixed XOR sequence number */
 2945              		.loc 4 1894 9
 2946 036f EB0A     		jmp	.L172
 2947              	.L173:
1902:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1903:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else
1904:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1905:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Reminder if we ever add an AEAD mode with a different size */
1906:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1907:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 2948              		.loc 4 1907 19
 2949 0371 B80094FF 		movl	$-27648, %eax
 2949      FF
 2950 0376 E9EE0900 		jmp	.L163
 2950      00
 2951              	.L172:
1908:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1909:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1910:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "IV used", iv, transform->ivlen );
1911:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "TAG used", dec_msg + dec_msglen, taglen );
1912:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1913:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
1914:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Decrypt and authenticate
1915:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
1916:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_cipher_auth_decrypt( &ssl->transform_in->cipher_ctx_dec,
 2952              		.loc 4 1916 21
 2953 037b 0FB6B5FF 		movzbl	-257(%rbp), %esi
 2953      FEFFFF
1917:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                          iv, transform->ivlen,
1918:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                          add_data, 13,
1919:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                          dec_msg, dec_msglen,
1920:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                          dec_msg_result, &olen,
1921:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                          dec_msg + dec_msglen, taglen ) ) != 0 )
 2954              		.loc 4 1921 50
 2955 0382 488B5588 		movq	-120(%rbp), %rdx
 2956 0386 488B4580 		movq	-128(%rbp), %rax
 2957 038a 4C8D0402 		leaq	(%rdx,%rax), %r8
1916:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                          iv, transform->ivlen,
 2958              		.loc 4 1916 21
 2959 038e 488B8570 		movq	-144(%rbp), %rax
 2959      FFFFFF
 2960 0395 488B5018 		movq	24(%rax), %rdx
1916:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                          iv, transform->ivlen,
 2961              		.loc 4 1916 54
 2962 0399 488B85E8 		movq	-280(%rbp), %rax
 2962      FEFFFF
 2963 03a0 488B4068 		movq	104(%rax), %rax
1916:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                          iv, transform->ivlen,
 2964              		.loc 4 1916 21
 2965 03a4 488DB8D8 		leaq	216(%rax), %rdi
 2965      000000
 2966 03ab 4C8B4D88 		movq	-120(%rbp), %r9
 2967 03af 488D4DC0 		leaq	-64(%rbp), %rcx
GAS LISTING /tmp/ccEn8xFO.s 			page 127


 2968 03b3 488D45B4 		leaq	-76(%rbp), %rax
 2969 03b7 4883EC08 		subq	$8, %rsp
 2970 03bb 56       		pushq	%rsi
 2971 03bc 4150     		pushq	%r8
 2972 03be 488DB510 		leaq	-240(%rbp), %rsi
 2972      FFFFFF
 2973 03c5 56       		pushq	%rsi
 2974 03c6 FF7590   		pushq	-112(%rbp)
 2975 03c9 FF7580   		pushq	-128(%rbp)
 2976 03cc 41B80D00 		movl	$13, %r8d
 2976      0000
 2977 03d2 4889C6   		movq	%rax, %rsi
 2978 03d5 E8000000 		call	mbedtls_cipher_auth_decrypt@PLT
 2978      00
 2979 03da 4883C430 		addq	$48, %rsp
 2980 03de 89850CFF 		movl	%eax, -244(%rbp)
 2980      FFFF
1916:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                          iv, transform->ivlen,
 2981              		.loc 4 1916 11
 2982 03e4 83BD0CFF 		cmpl	$0, -244(%rbp)
 2982      FFFF00
 2983 03eb 7421     		je	.L176
1922:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1923:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_auth_decrypt", ret );
1924:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1925:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ret == MBEDTLS_ERR_CIPHER_AUTH_FAILED )
 2984              		.loc 4 1925 15
 2985 03ed 81BD0CFF 		cmpl	$-25344, -244(%rbp)
 2985      FFFF009D 
 2985      FFFF
 2986 03f7 750A     		jne	.L177
1926:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_INVALID_MAC );
 2987              		.loc 4 1926 23
 2988 03f9 B8808EFF 		movl	$-29056, %eax
 2988      FF
 2989 03fe E9660900 		jmp	.L163
 2989      00
 2990              	.L177:
1927:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1928:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 2991              		.loc 4 1928 19
 2992 0403 8B850CFF 		movl	-244(%rbp), %eax
 2992      FFFF
 2993 0409 E95B0900 		jmp	.L163
 2993      00
 2994              	.L176:
1929:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1930:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         auth_done++;
 2995              		.loc 4 1930 18
 2996 040e 838500FF 		addl	$1, -256(%rbp)
 2996      FFFF01
1931:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1932:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( olen != dec_msglen )
 2997              		.loc 4 1932 18
 2998 0415 488B8510 		movq	-240(%rbp), %rax
 2998      FFFFFF
 2999              		.loc 4 1932 11
GAS LISTING /tmp/ccEn8xFO.s 			page 128


 3000 041c 48394580 		cmpq	%rax, -128(%rbp)
 3001 0420 0F849D04 		je	.L219
 3001      0000
1933:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1934:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1935:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 3002              		.loc 4 1935 19
 3003 0426 B80094FF 		movl	$-27648, %eax
 3003      FF
 3004 042b E9390900 		jmp	.L163
 3004      00
 3005              	.L166:
 3006              	.LBE10:
1936:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1937:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
1938:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
1939:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_GCM_C || MBEDTLS_CCM_C */
1940:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_CIPHER_MODE_CBC) &&                                    \
1941:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ( defined(MBEDTLS_AES_C) || defined(MBEDTLS_CAMELLIA_C) || defined(MBEDTLS_ARIA_C) )
1942:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( mode == MBEDTLS_MODE_CBC )
 3007              		.loc 4 1942 7
 3008 0430 83BD04FF 		cmpl	$2, -252(%rbp)
 3008      FFFF02
 3009 0437 0F857C04 		jne	.L180
 3009      0000
 3010              	.LBB12:
1943:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
1944:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
1945:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Decrypt and check the padding
1946:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
1947:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         int ret;
1948:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         unsigned char *dec_msg;
1949:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         unsigned char *dec_msg_result;
1950:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         size_t dec_msglen;
1951:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         size_t minlen = 0;
 3011              		.loc 4 1951 16
 3012 043d 48C78530 		movq	$0, -208(%rbp)
 3012      FFFFFF00 
 3012      000000
1952:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         size_t olen = 0;
 3013              		.loc 4 1952 16
 3014 0448 48C78510 		movq	$0, -240(%rbp)
 3014      FFFFFF00 
 3014      000000
1953:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1954:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
1955:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Check immediate ciphertext sanity
1956:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
1957:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_1) || defined(MBEDTLS_SSL_PROTO_TLS1_2)
1958:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_2 )
 3015              		.loc 4 1958 16
 3016 0453 488B85E8 		movq	-280(%rbp), %rax
 3016      FEFFFF
 3017 045a 8B4018   		movl	24(%rax), %eax
 3018              		.loc 4 1958 11
 3019 045d 83F801   		cmpl	$1, %eax
 3020 0460 7E16     		jle	.L181
GAS LISTING /tmp/ccEn8xFO.s 			page 129


1959:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             minlen += ssl->transform_in->ivlen;
 3021              		.loc 4 1959 26
 3022 0462 488B85E8 		movq	-280(%rbp), %rax
 3022      FEFFFF
 3023 0469 488B4068 		movq	104(%rax), %rax
 3024              		.loc 4 1959 40
 3025 046d 488B4018 		movq	24(%rax), %rax
 3026              		.loc 4 1959 20
 3027 0471 48018530 		addq	%rax, -208(%rbp)
 3027      FFFFFF
 3028              	.L181:
1960:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
1961:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1962:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_msglen < minlen + ssl->transform_in->ivlen ||
 3029              		.loc 4 1962 16
 3030 0478 488B85E8 		movq	-280(%rbp), %rax
 3030      FEFFFF
 3031 047f 488B90E0 		movq	224(%rax), %rdx
 3031      000000
 3032              		.loc 4 1962 42
 3033 0486 488B85E8 		movq	-280(%rbp), %rax
 3033      FEFFFF
 3034 048d 488B4068 		movq	104(%rax), %rax
 3035              		.loc 4 1962 56
 3036 0491 488B4818 		movq	24(%rax), %rcx
 3037              		.loc 4 1962 37
 3038 0495 488B8530 		movq	-208(%rbp), %rax
 3038      FFFFFF
 3039 049c 4801C8   		addq	%rcx, %rax
 3040              		.loc 4 1962 11
 3041 049f 4839C2   		cmpq	%rax, %rdx
 3042 04a2 7230     		jb	.L182
1963:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msglen < minlen + ssl->transform_in->maclen + 1 )
 3043              		.loc 4 1963 16 discriminator 1
 3044 04a4 488B85E8 		movq	-280(%rbp), %rax
 3044      FEFFFF
 3045 04ab 488B90E0 		movq	224(%rax), %rdx
 3045      000000
 3046              		.loc 4 1963 42 discriminator 1
 3047 04b2 488B85E8 		movq	-280(%rbp), %rax
 3047      FEFFFF
 3048 04b9 488B4068 		movq	104(%rax), %rax
 3049              		.loc 4 1963 56 discriminator 1
 3050 04bd 488B4828 		movq	40(%rax), %rcx
 3051              		.loc 4 1963 37 discriminator 1
 3052 04c1 488B8530 		movq	-208(%rbp), %rax
 3052      FFFFFF
 3053 04c8 4801C8   		addq	%rcx, %rax
 3054              		.loc 4 1963 65 discriminator 1
 3055 04cb 4883C001 		addq	$1, %rax
1962:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msglen < minlen + ssl->transform_in->maclen + 1 )
 3056              		.loc 4 1962 64 discriminator 1
 3057 04cf 4839C2   		cmpq	%rax, %rdx
 3058 04d2 730A     		jnb	.L183
 3059              	.L182:
1964:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1965:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "msglen (%d) < max( ivlen(%d), maclen (%d) "
GAS LISTING /tmp/ccEn8xFO.s 			page 130


1966:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 "+ 1 ) ( + expl IV )", ssl->in_msglen,
1967:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 ssl->transform_in->ivlen,
1968:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 ssl->transform_in->maclen ) );
1969:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_MAC );
 3060              		.loc 4 1969 19
 3061 04d4 B8808EFF 		movl	$-29056, %eax
 3061      FF
 3062 04d9 E98B0800 		jmp	.L163
 3062      00
 3063              	.L183:
1970:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
1971:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1972:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         dec_msglen = ssl->in_msglen;
 3064              		.loc 4 1972 20
 3065 04de 488B85E8 		movq	-280(%rbp), %rax
 3065      FEFFFF
 3066 04e5 488B80E0 		movq	224(%rax), %rax
 3066      000000
 3067 04ec 48898528 		movq	%rax, -216(%rbp)
 3067      FFFFFF
1973:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         dec_msg = ssl->in_msg;
 3068              		.loc 4 1973 17
 3069 04f3 488B85E8 		movq	-280(%rbp), %rax
 3069      FEFFFF
 3070 04fa 488B80C8 		movq	200(%rax), %rax
 3070      000000
 3071 0501 48898558 		movq	%rax, -168(%rbp)
 3071      FFFFFF
1974:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         dec_msg_result = ssl->in_msg;
 3072              		.loc 4 1974 24
 3073 0508 488B85E8 		movq	-280(%rbp), %rax
 3073      FEFFFF
 3074 050f 488B80C8 		movq	200(%rax), %rax
 3074      000000
 3075 0516 48898560 		movq	%rax, -160(%rbp)
 3075      FFFFFF
1975:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1976:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
1977:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Authenticate before decrypt if enabled
1978:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
1979:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_ENCRYPT_THEN_MAC)
1980:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->session_in->encrypt_then_mac == MBEDTLS_SSL_ETM_ENABLED )
1981:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
1982:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             unsigned char mac_expect[MBEDTLS_SSL_MAC_ADD];
1983:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             unsigned char pseudo_hdr[13];
1984:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1985:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "using encrypt then mac" ) );
1986:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1987:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             dec_msglen -= ssl->transform_in->maclen;
1988:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msglen -= ssl->transform_in->maclen;
1989:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1990:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcpy( pseudo_hdr +  0, ssl->in_ctr, 8 );
1991:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcpy( pseudo_hdr +  8, ssl->in_hdr, 3 );
1992:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             pseudo_hdr[11] = (unsigned char)( ( ssl->in_msglen >> 8 ) & 0xFF );
1993:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             pseudo_hdr[12] = (unsigned char)( ( ssl->in_msglen      ) & 0xFF );
1994:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1995:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_BUF( 4, "MAC'd meta-data", pseudo_hdr, 13 );
GAS LISTING /tmp/ccEn8xFO.s 			page 131


1996:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
1997:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_in->md_ctx_dec, pseudo_hdr, 13 );
1998:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_in->md_ctx_dec,
1999:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                              ssl->in_iv, ssl->in_msglen );
2000:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_finish( &ssl->transform_in->md_ctx_dec, mac_expect );
2001:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_reset( &ssl->transform_in->md_ctx_dec );
2002:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2003:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_BUF( 4, "message  mac", ssl->in_iv + ssl->in_msglen,
2004:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                               ssl->transform_in->maclen );
2005:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_BUF( 4, "expected mac", mac_expect,
2006:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                               ssl->transform_in->maclen );
2007:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2008:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( mbedtls_ssl_safer_memcmp( ssl->in_iv + ssl->in_msglen, mac_expect,
2009:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                           ssl->transform_in->maclen ) != 0 )
2010:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
2011:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "message mac does not match" ) );
2012:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2013:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_INVALID_MAC );
2014:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
2015:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             auth_done++;
2016:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2017:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_ENCRYPT_THEN_MAC */
2018:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2019:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
2020:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Check length sanity
2021:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
2022:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_msglen % ssl->transform_in->ivlen != 0 )
 3076              		.loc 4 2022 16
 3077 051d 488B85E8 		movq	-280(%rbp), %rax
 3077      FEFFFF
 3078 0524 488B80E0 		movq	224(%rax), %rax
 3078      000000
 3079              		.loc 4 2022 33
 3080 052b 488B95E8 		movq	-280(%rbp), %rdx
 3080      FEFFFF
 3081 0532 488B5268 		movq	104(%rdx), %rdx
 3082              		.loc 4 2022 47
 3083 0536 488B4A18 		movq	24(%rdx), %rcx
 3084              		.loc 4 2022 28
 3085 053a BA000000 		movl	$0, %edx
 3085      00
 3086 053f 48F7F1   		divq	%rcx
 3087 0542 4889D0   		movq	%rdx, %rax
 3088              		.loc 4 2022 11
 3089 0545 4885C0   		testq	%rax, %rax
 3090 0548 740A     		je	.L185
2023:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2024:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "msglen (%d) %% ivlen (%d) != 0",
2025:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            ssl->in_msglen, ssl->transform_in->ivlen ) );
2026:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_MAC );
 3091              		.loc 4 2026 19
 3092 054a B8808EFF 		movl	$-29056, %eax
 3092      FF
 3093 054f E9150800 		jmp	.L163
 3093      00
 3094              	.L185:
2027:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
GAS LISTING /tmp/ccEn8xFO.s 			page 132


2028:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2029:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_1) || defined(MBEDTLS_SSL_PROTO_TLS1_2)
2030:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
2031:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Initialize for prepended IV for block cipher in TLS v1.1 and up
2032:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
2033:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_2 )
 3095              		.loc 4 2033 16
 3096 0554 488B85E8 		movq	-280(%rbp), %rax
 3096      FEFFFF
 3097 055b 8B4018   		movl	24(%rax), %eax
 3098              		.loc 4 2033 11
 3099 055e 83F801   		cmpl	$1, %eax
 3100 0561 0F8EAC00 		jle	.L186
 3100      0000
 3101              	.LBB13:
2034:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2035:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             unsigned char i;
2036:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             dec_msglen -= ssl->transform_in->ivlen;
 3102              		.loc 4 2036 30
 3103 0567 488B85E8 		movq	-280(%rbp), %rax
 3103      FEFFFF
 3104 056e 488B4068 		movq	104(%rax), %rax
 3105              		.loc 4 2036 44
 3106 0572 488B4018 		movq	24(%rax), %rax
 3107              		.loc 4 2036 24
 3108 0576 48298528 		subq	%rax, -216(%rbp)
 3108      FFFFFF
2037:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msglen -= ssl->transform_in->ivlen;
 3109              		.loc 4 2037 28
 3110 057d 488B85E8 		movq	-280(%rbp), %rax
 3110      FEFFFF
 3111 0584 488B90E0 		movq	224(%rax), %rdx
 3111      000000
 3112              		.loc 4 2037 34
 3113 058b 488B85E8 		movq	-280(%rbp), %rax
 3113      FEFFFF
 3114 0592 488B4068 		movq	104(%rax), %rax
 3115              		.loc 4 2037 48
 3116 0596 488B4018 		movq	24(%rax), %rax
 3117              		.loc 4 2037 28
 3118 059a 4829C2   		subq	%rax, %rdx
 3119 059d 488B85E8 		movq	-280(%rbp), %rax
 3119      FEFFFF
 3120 05a4 488990E0 		movq	%rdx, 224(%rax)
 3120      000000
2038:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2039:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             for( i = 0; i < ssl->transform_in->ivlen; i++ )
 3121              		.loc 4 2039 20
 3122 05ab C685FDFE 		movb	$0, -259(%rbp)
 3122      FFFF00
 3123              		.loc 4 2039 13
 3124 05b2 EB44     		jmp	.L187
 3125              	.L188:
2040:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->transform_in->iv_dec[i] = ssl->in_iv[i];
 3126              		.loc 4 2040 51 discriminator 3
 3127 05b4 488B85E8 		movq	-280(%rbp), %rax
 3127      FEFFFF
GAS LISTING /tmp/ccEn8xFO.s 			page 133


 3128 05bb 488B90C0 		movq	192(%rax), %rdx
 3128      000000
 3129              		.loc 4 2040 58 discriminator 3
 3130 05c2 0FB685FD 		movzbl	-259(%rbp), %eax
 3130      FEFFFF
 3131 05c9 488D0C02 		leaq	(%rdx,%rax), %rcx
 3132              		.loc 4 2040 20 discriminator 3
 3133 05cd 488B85E8 		movq	-280(%rbp), %rax
 3133      FEFFFF
 3134 05d4 488B5068 		movq	104(%rax), %rdx
 3135              		.loc 4 2040 42 discriminator 3
 3136 05d8 0FB685FD 		movzbl	-259(%rbp), %eax
 3136      FEFFFF
 3137              		.loc 4 2040 58 discriminator 3
 3138 05df 0FB609   		movzbl	(%rcx), %ecx
 3139              		.loc 4 2040 46 discriminator 3
 3140 05e2 4898     		cltq
 3141 05e4 884C0240 		movb	%cl, 64(%rdx,%rax)
2039:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->transform_in->iv_dec[i] = ssl->in_iv[i];
 3142              		.loc 4 2039 56 discriminator 3
 3143 05e8 0FB685FD 		movzbl	-259(%rbp), %eax
 3143      FEFFFF
 3144 05ef 83C001   		addl	$1, %eax
 3145 05f2 8885FDFE 		movb	%al, -259(%rbp)
 3145      FFFF
 3146              	.L187:
2039:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->transform_in->iv_dec[i] = ssl->in_iv[i];
 3147              		.loc 4 2039 27 discriminator 1
 3148 05f8 0FB695FD 		movzbl	-259(%rbp), %edx
 3148      FEFFFF
2039:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->transform_in->iv_dec[i] = ssl->in_iv[i];
 3149              		.loc 4 2039 32 discriminator 1
 3150 05ff 488B85E8 		movq	-280(%rbp), %rax
 3150      FEFFFF
 3151 0606 488B4068 		movq	104(%rax), %rax
2039:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->transform_in->iv_dec[i] = ssl->in_iv[i];
 3152              		.loc 4 2039 46 discriminator 1
 3153 060a 488B4018 		movq	24(%rax), %rax
2039:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->transform_in->iv_dec[i] = ssl->in_iv[i];
 3154              		.loc 4 2039 13 discriminator 1
 3155 060e 4839C2   		cmpq	%rax, %rdx
 3156 0611 72A1     		jb	.L188
 3157              	.L186:
 3158              	.LBE13:
2041:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2042:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_1 || MBEDTLS_SSL_PROTO_TLS1_2 */
2043:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2044:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_cipher_crypt( &ssl->transform_in->cipher_ctx_dec,
2045:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->transform_in->iv_dec,
2046:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->transform_in->ivlen,
 3159              		.loc 4 2046 39
 3160 0613 488B85E8 		movq	-280(%rbp), %rax
 3160      FEFFFF
 3161 061a 488B4068 		movq	104(%rax), %rax
2044:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->transform_in->iv_dec,
 3162              		.loc 4 2044 21
 3163 061e 488B4018 		movq	24(%rax), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 134


2045:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->transform_in->ivlen,
 3164              		.loc 4 2045 39
 3165 0622 488B95E8 		movq	-280(%rbp), %rdx
 3165      FEFFFF
 3166 0629 488B5268 		movq	104(%rdx), %rdx
2045:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->transform_in->ivlen,
 3167              		.loc 4 2045 53
 3168 062d 488D7240 		leaq	64(%rdx), %rsi
2044:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->transform_in->iv_dec,
 3169              		.loc 4 2044 47
 3170 0631 488B95E8 		movq	-280(%rbp), %rdx
 3170      FEFFFF
 3171 0638 488B5268 		movq	104(%rdx), %rdx
2044:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->transform_in->iv_dec,
 3172              		.loc 4 2044 21
 3173 063c 488DBAD8 		leaq	216(%rdx), %rdi
 3173      000000
 3174 0643 4C8B8D60 		movq	-160(%rbp), %r9
 3174      FFFFFF
 3175 064a 4C8B8528 		movq	-216(%rbp), %r8
 3175      FFFFFF
 3176 0651 488B9558 		movq	-168(%rbp), %rdx
 3176      FFFFFF
 3177 0658 4883EC08 		subq	$8, %rsp
 3178 065c 488D8D10 		leaq	-240(%rbp), %rcx
 3178      FFFFFF
 3179 0663 51       		pushq	%rcx
 3180 0664 4889D1   		movq	%rdx, %rcx
 3181 0667 4889C2   		movq	%rax, %rdx
 3182 066a E8000000 		call	mbedtls_cipher_crypt@PLT
 3182      00
 3183 066f 4883C410 		addq	$16, %rsp
 3184 0673 898508FF 		movl	%eax, -248(%rbp)
 3184      FFFF
2044:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->transform_in->iv_dec,
 3185              		.loc 4 2044 11
 3186 0679 83BD08FF 		cmpl	$0, -248(%rbp)
 3186      FFFF00
 3187 0680 740B     		je	.L189
2047:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    dec_msg, dec_msglen,
2048:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    dec_msg_result, &olen ) ) != 0 )
2049:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2050:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_crypt", ret );
2051:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 3188              		.loc 4 2051 19
 3189 0682 8B8508FF 		movl	-248(%rbp), %eax
 3189      FFFF
 3190 0688 E9DC0600 		jmp	.L163
 3190      00
 3191              	.L189:
2052:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2053:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2054:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( dec_msglen != olen )
 3192              		.loc 4 2054 24
 3193 068d 488B8510 		movq	-240(%rbp), %rax
 3193      FFFFFF
 3194              		.loc 4 2054 11
GAS LISTING /tmp/ccEn8xFO.s 			page 135


 3195 0694 48398528 		cmpq	%rax, -216(%rbp)
 3195      FFFFFF
 3196 069b 740A     		je	.L190
2055:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2056:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
2057:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 3197              		.loc 4 2057 19
 3198 069d B80094FF 		movl	$-27648, %eax
 3198      FF
 3199 06a2 E9C20600 		jmp	.L163
 3199      00
 3200              	.L190:
2058:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2059:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2060:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1)
2061:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->minor_ver < MBEDTLS_SSL_MINOR_VERSION_2 )
2062:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2063:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /*
2064:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * Save IV in SSL3 and TLS1
2065:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              */
2066:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcpy( ssl->transform_in->iv_dec,
2067:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ssl->transform_in->cipher_ctx_dec.iv,
2068:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ssl->transform_in->ivlen );
2069:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2070:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
2071:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2072:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         padlen = 1 + ssl->in_msg[ssl->in_msglen - 1];
 3201              		.loc 4 2072 25
 3202 06a7 488B85E8 		movq	-280(%rbp), %rax
 3202      FEFFFF
 3203 06ae 488B90C8 		movq	200(%rax), %rdx
 3203      000000
 3204              		.loc 4 2072 37
 3205 06b5 488B85E8 		movq	-280(%rbp), %rax
 3205      FEFFFF
 3206 06bc 488B80E0 		movq	224(%rax), %rax
 3206      000000
 3207              		.loc 4 2072 33
 3208 06c3 4883E801 		subq	$1, %rax
 3209 06c7 4801D0   		addq	%rdx, %rax
 3210 06ca 0FB600   		movzbl	(%rax), %eax
 3211 06cd 0FB6C0   		movzbl	%al, %eax
 3212              		.loc 4 2072 20
 3213 06d0 83C001   		addl	$1, %eax
 3214              		.loc 4 2072 16
 3215 06d3 4898     		cltq
 3216 06d5 48898518 		movq	%rax, -232(%rbp)
 3216      FFFFFF
2073:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2074:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_msglen < ssl->transform_in->maclen + padlen &&
 3217              		.loc 4 2074 16
 3218 06dc 488B85E8 		movq	-280(%rbp), %rax
 3218      FEFFFF
 3219 06e3 488B90E0 		movq	224(%rax), %rdx
 3219      000000
 3220              		.loc 4 2074 33
 3221 06ea 488B85E8 		movq	-280(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 136


 3221      FEFFFF
 3222 06f1 488B4068 		movq	104(%rax), %rax
 3223              		.loc 4 2074 47
 3224 06f5 488B4828 		movq	40(%rax), %rcx
 3225              		.loc 4 2074 56
 3226 06f9 488B8518 		movq	-232(%rbp), %rax
 3226      FFFFFF
 3227 0700 4801C8   		addq	%rcx, %rax
 3228              		.loc 4 2074 11
 3229 0703 4839C2   		cmpq	%rax, %rdx
 3230 0706 731F     		jnb	.L191
 3231              		.loc 4 2074 65 discriminator 1
 3232 0708 83BD00FF 		cmpl	$0, -256(%rbp)
 3232      FFFF00
 3233 070f 7516     		jne	.L191
2075:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             auth_done == 0 )
2076:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2077:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DEBUG_ALL)
2078:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "msglen (%d) < maclen (%d) + padlen (%d)",
2079:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         ssl->in_msglen, ssl->transform_in->maclen, padlen ) );
2080:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
2081:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             padlen = 0;
 3234              		.loc 4 2081 20
 3235 0711 48C78518 		movq	$0, -232(%rbp)
 3235      FFFFFF00 
 3235      000000
2082:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             correct = 0;
 3236              		.loc 4 2082 21
 3237 071c 48C78520 		movq	$0, -224(%rbp)
 3237      FFFFFF00 
 3237      000000
 3238              	.L191:
2083:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2084:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2085:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
2086:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 )
2087:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2088:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( padlen > ssl->transform_in->ivlen )
2089:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
2090:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DEBUG_ALL)
2091:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad padding length: is %d, "
2092:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     "should be no more than %d",
2093:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                padlen, ssl->transform_in->ivlen ) );
2094:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
2095:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 correct = 0;
2096:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
2097:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2098:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else
2099:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 */
2100:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1) || \
2101:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_2)
2102:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->minor_ver > MBEDTLS_SSL_MINOR_VERSION_0 )
 3239              		.loc 4 2102 16
 3240 0727 488B85E8 		movq	-280(%rbp), %rax
 3240      FEFFFF
 3241 072e 8B4018   		movl	24(%rax), %eax
 3242              		.loc 4 2102 11
GAS LISTING /tmp/ccEn8xFO.s 			page 137


 3243 0731 85C0     		testl	%eax, %eax
 3244 0733 0F8E7601 		jle	.L192
 3244      0000
 3245              	.LBB14:
2103:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2104:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /*
2105:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * TLSv1+: always check the padding up to the first failure
2106:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * and fake check up to 256 bytes of padding
2107:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              */
2108:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             size_t pad_count = 0, real_count = 1;
 3246              		.loc 4 2108 20
 3247 0739 48C78538 		movq	$0, -200(%rbp)
 3247      FFFFFF00 
 3247      000000
 3248              		.loc 4 2108 35
 3249 0744 48C78540 		movq	$1, -192(%rbp)
 3249      FFFFFF01 
 3249      000000
2109:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             size_t padding_idx = ssl->in_msglen - padlen;
 3250              		.loc 4 2109 37
 3251 074f 488B85E8 		movq	-280(%rbp), %rax
 3251      FEFFFF
 3252 0756 488B80E0 		movq	224(%rax), %rax
 3252      000000
 3253              		.loc 4 2109 20
 3254 075d 482B8518 		subq	-232(%rbp), %rax
 3254      FFFFFF
 3255 0764 48898568 		movq	%rax, -152(%rbp)
 3255      FFFFFF
2110:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             size_t i;
2111:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2112:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /*
2113:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * Padding is guaranteed to be incorrect if:
2114:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *   1. padlen > ssl->in_msglen
2115:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *
2116:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *   2. padding_idx > MBEDTLS_SSL_IN_CONTENT_LEN +
2117:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *                     ssl->transform_in->maclen
2118:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *
2119:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * In both cases we reset padding_idx to a safe value (0) to
2120:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * prevent out-of-buffer reads.
2121:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              */
2122:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             correct &= ( padlen <= ssl->in_msglen );
 3256              		.loc 4 2122 39
 3257 076b 488B85E8 		movq	-280(%rbp), %rax
 3257      FEFFFF
 3258 0772 488B80E0 		movq	224(%rax), %rax
 3258      000000
 3259              		.loc 4 2122 33
 3260 0779 48398518 		cmpq	%rax, -232(%rbp)
 3260      FFFFFF
 3261 0780 0F96C0   		setbe	%al
 3262 0783 0FB6C0   		movzbl	%al, %eax
 3263              		.loc 4 2122 21
 3264 0786 48218520 		andq	%rax, -224(%rbp)
 3264      FFFFFF
2123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             correct &= ( padding_idx <= MBEDTLS_SSL_IN_CONTENT_LEN +
2124:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                        ssl->transform_in->maclen );
GAS LISTING /tmp/ccEn8xFO.s 			page 138


 3265              		.loc 4 2124 43
 3266 078d 488B85E8 		movq	-280(%rbp), %rax
 3266      FEFFFF
 3267 0794 488B4068 		movq	104(%rax), %rax
 3268              		.loc 4 2124 57
 3269 0798 488B4028 		movq	40(%rax), %rax
2123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             correct &= ( padding_idx <= MBEDTLS_SSL_IN_CONTENT_LEN +
 3270              		.loc 4 2123 68
 3271 079c 4805803E 		addq	$16000, %rax
 3271      0000
2123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             correct &= ( padding_idx <= MBEDTLS_SSL_IN_CONTENT_LEN +
 3272              		.loc 4 2123 38
 3273 07a2 48398568 		cmpq	%rax, -152(%rbp)
 3273      FFFFFF
 3274 07a9 0F96C0   		setbe	%al
 3275 07ac 0FB6C0   		movzbl	%al, %eax
2123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             correct &= ( padding_idx <= MBEDTLS_SSL_IN_CONTENT_LEN +
 3276              		.loc 4 2123 21
 3277 07af 48218520 		andq	%rax, -224(%rbp)
 3277      FFFFFF
2125:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2126:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             padding_idx *= correct;
 3278              		.loc 4 2126 25
 3279 07b6 488B8568 		movq	-152(%rbp), %rax
 3279      FFFFFF
 3280 07bd 480FAF85 		imulq	-224(%rbp), %rax
 3280      20FFFFFF 
 3281 07c5 48898568 		movq	%rax, -152(%rbp)
 3281      FFFFFF
2127:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2128:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             for( i = 0; i < 256; i++ )
 3282              		.loc 4 2128 20
 3283 07cc 48C78548 		movq	$0, -184(%rbp)
 3283      FFFFFF00 
 3283      000000
 3284              		.loc 4 2128 13
 3285 07d7 EB6E     		jmp	.L193
 3286              	.L194:
2129:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
2130:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 real_count &= ( i < padlen );
 3287              		.loc 4 2130 35 discriminator 3
 3288 07d9 488B8548 		movq	-184(%rbp), %rax
 3288      FFFFFF
 3289 07e0 483B8518 		cmpq	-232(%rbp), %rax
 3289      FFFFFF
 3290 07e7 0F92C0   		setb	%al
 3291 07ea 0FB6C0   		movzbl	%al, %eax
 3292              		.loc 4 2130 28 discriminator 3
 3293 07ed 48218540 		andq	%rax, -192(%rbp)
 3293      FFFFFF
2131:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 pad_count += real_count *
2132:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                              ( ssl->in_msg[padding_idx + i] == padlen - 1 );
 3294              		.loc 4 2132 35 discriminator 3
 3295 07f4 488B85E8 		movq	-280(%rbp), %rax
 3295      FEFFFF
 3296 07fb 488B80C8 		movq	200(%rax), %rax
 3296      000000
GAS LISTING /tmp/ccEn8xFO.s 			page 139


 3297              		.loc 4 2132 56 discriminator 3
 3298 0802 488B8D68 		movq	-152(%rbp), %rcx
 3298      FFFFFF
 3299 0809 488B9548 		movq	-184(%rbp), %rdx
 3299      FFFFFF
 3300 0810 4801CA   		addq	%rcx, %rdx
 3301              		.loc 4 2132 43 discriminator 3
 3302 0813 4801D0   		addq	%rdx, %rax
 3303 0816 0FB600   		movzbl	(%rax), %eax
 3304 0819 0FB6C0   		movzbl	%al, %eax
 3305              		.loc 4 2132 71 discriminator 3
 3306 081c 488B9518 		movq	-232(%rbp), %rdx
 3306      FFFFFF
 3307 0823 4883EA01 		subq	$1, %rdx
 3308              		.loc 4 2132 61 discriminator 3
 3309 0827 4839D0   		cmpq	%rdx, %rax
 3310 082a 0F94C0   		sete	%al
 3311 082d 0FB6C0   		movzbl	%al, %eax
2131:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 pad_count += real_count *
 3312              		.loc 4 2131 41 discriminator 3
 3313 0830 480FAF85 		imulq	-192(%rbp), %rax
 3313      40FFFFFF 
2131:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 pad_count += real_count *
 3314              		.loc 4 2131 27 discriminator 3
 3315 0838 48018538 		addq	%rax, -200(%rbp)
 3315      FFFFFF
2128:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
 3316              		.loc 4 2128 35 discriminator 3
 3317 083f 48838548 		addq	$1, -184(%rbp)
 3317      FFFFFF01 
 3318              	.L193:
2128:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
 3319              		.loc 4 2128 13 discriminator 1
 3320 0847 4881BD48 		cmpq	$255, -184(%rbp)
 3320      FFFFFFFF 
 3320      000000
 3321 0852 7685     		jbe	.L194
2133:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
2134:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2135:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             correct &= ( pad_count == padlen ); /* Only 1 on correct padding */
 3322              		.loc 4 2135 36
 3323 0854 488B8538 		movq	-200(%rbp), %rax
 3323      FFFFFF
 3324 085b 483B8518 		cmpq	-232(%rbp), %rax
 3324      FFFFFF
 3325 0862 0F94C0   		sete	%al
 3326 0865 0FB6C0   		movzbl	%al, %eax
 3327              		.loc 4 2135 21
 3328 0868 48218520 		andq	%rax, -224(%rbp)
 3328      FFFFFF
2136:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2137:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DEBUG_ALL)
2138:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( padlen > 0 && correct == 0 )
2139:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad padding byte detected" ) );
2140:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
2141:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             padlen &= correct * 0x1FF;
 3329              		.loc 4 2141 31
GAS LISTING /tmp/ccEn8xFO.s 			page 140


 3330 086f 488B9520 		movq	-224(%rbp), %rdx
 3330      FFFFFF
 3331 0876 4889D0   		movq	%rdx, %rax
 3332 0879 48C1E009 		salq	$9, %rax
 3333 087d 4829D0   		subq	%rdx, %rax
 3334              		.loc 4 2141 20
 3335 0880 48218518 		andq	%rax, -232(%rbp)
 3335      FFFFFF
 3336              	.LBE14:
2142:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2143:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else
2144:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1 || MBEDTLS_SSL_PROTO_TLS1_1 || \
2145:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****           MBEDTLS_SSL_PROTO_TLS1_2 */
2146:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2147:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
2148:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
2149:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2150:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2151:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_msglen -= padlen;
 3337              		.loc 4 2151 24
 3338 0887 488B85E8 		movq	-280(%rbp), %rax
 3338      FEFFFF
 3339 088e 488B80E0 		movq	224(%rax), %rax
 3339      000000
 3340 0895 482B8518 		subq	-232(%rbp), %rax
 3340      FFFFFF
 3341 089c 4889C2   		movq	%rax, %rdx
 3342 089f 488B85E8 		movq	-280(%rbp), %rax
 3342      FEFFFF
 3343 08a6 488990E0 		movq	%rdx, 224(%rax)
 3343      000000
 3344              	.LBE12:
 3345 08ad EB15     		jmp	.L179
 3346              	.L192:
 3347              	.LBB15:
2148:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
 3348              		.loc 4 2148 19
 3349 08af B80094FF 		movl	$-27648, %eax
 3349      FF
 3350 08b4 E9B00400 		jmp	.L163
 3350      00
 3351              	.L180:
 3352              	.LBE15:
2152:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2153:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
2154:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_CIPHER_MODE_CBC &&
2155:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****           ( MBEDTLS_AES_C || MBEDTLS_CAMELLIA_C || MBEDTLS_ARIA_C ) */
2156:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2157:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
2158:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 3353              		.loc 4 2158 15
 3354 08b9 B80094FF 		movl	$-27648, %eax
 3354      FF
 3355 08be E9A60400 		jmp	.L163
 3355      00
 3356              	.L219:
1843:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         int ret;
GAS LISTING /tmp/ccEn8xFO.s 			page 141


 3357              		.loc 4 1843 5
 3358 08c3 90       		nop
 3359              	.L179:
2159:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2160:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2161:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DEBUG_ALL)
2162:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "raw buffer after decryption",
2163:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                    ssl->in_msg, ssl->in_msglen );
2164:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
2165:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2166:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
2167:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Authenticate if not done yet.
2168:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Compute the MAC regardless of the padding result (RFC4346, CBCTIME).
2169:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
2170:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(SSL_SOME_MODES_USE_MAC)
2171:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( auth_done == 0 )
 3360              		.loc 4 2171 7
 3361 08c4 83BD00FF 		cmpl	$0, -256(%rbp)
 3361      FFFF00
 3362 08cb 0F856003 		jne	.L196
 3362      0000
 3363              	.LBB16:
2172:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         unsigned char mac_expect[MBEDTLS_SSL_MAC_ADD];
2174:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2175:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_msglen -= ssl->transform_in->maclen;
 3364              		.loc 4 2175 24
 3365 08d1 488B85E8 		movq	-280(%rbp), %rax
 3365      FEFFFF
 3366 08d8 488B90E0 		movq	224(%rax), %rdx
 3366      000000
 3367              		.loc 4 2175 30
 3368 08df 488B85E8 		movq	-280(%rbp), %rax
 3368      FEFFFF
 3369 08e6 488B4068 		movq	104(%rax), %rax
 3370              		.loc 4 2175 44
 3371 08ea 488B4028 		movq	40(%rax), %rax
 3372              		.loc 4 2175 24
 3373 08ee 4829C2   		subq	%rax, %rdx
 3374 08f1 488B85E8 		movq	-280(%rbp), %rax
 3374      FEFFFF
 3375 08f8 488990E0 		movq	%rdx, 224(%rax)
 3375      000000
2176:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2177:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_len[0] = (unsigned char)( ssl->in_msglen >> 8 );
 3376              		.loc 4 2177 46
 3377 08ff 488B85E8 		movq	-280(%rbp), %rax
 3377      FEFFFF
 3378 0906 488B80E0 		movq	224(%rax), %rax
 3378      000000
 3379              		.loc 4 2177 58
 3380 090d 48C1E808 		shrq	$8, %rax
 3381 0911 4889C2   		movq	%rax, %rdx
 3382              		.loc 4 2177 12
 3383 0914 488B85E8 		movq	-280(%rbp), %rax
 3383      FEFFFF
 3384 091b 488B80B8 		movq	184(%rax), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 142


 3384      000000
 3385              		.loc 4 2177 24
 3386 0922 8810     		movb	%dl, (%rax)
2178:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_len[1] = (unsigned char)( ssl->in_msglen      );
 3387              		.loc 4 2178 46
 3388 0924 488B85E8 		movq	-280(%rbp), %rax
 3388      FEFFFF
 3389 092b 488B90E0 		movq	224(%rax), %rdx
 3389      000000
 3390              		.loc 4 2178 12
 3391 0932 488B85E8 		movq	-280(%rbp), %rax
 3391      FEFFFF
 3392 0939 488B80B8 		movq	184(%rax), %rax
 3392      000000
 3393              		.loc 4 2178 20
 3394 0940 4883C001 		addq	$1, %rax
 3395              		.loc 4 2178 24
 3396 0944 8810     		movb	%dl, (%rax)
2179:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2180:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
2181:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 )
2182:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2183:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl_mac( &ssl->transform_in->md_ctx_dec,
2184:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                       ssl->transform_in->mac_dec,
2185:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                       ssl->in_msg, ssl->in_msglen,
2186:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                       ssl->in_ctr, ssl->in_msgtype,
2187:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                       mac_expect );
2188:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2189:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else
2190:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 */
2191:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1) || \
2192:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         defined(MBEDTLS_SSL_PROTO_TLS1_2)
2193:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->minor_ver > MBEDTLS_SSL_MINOR_VERSION_0 )
 3397              		.loc 4 2193 16
 3398 0946 488B85E8 		movq	-280(%rbp), %rax
 3398      FEFFFF
 3399 094d 8B4018   		movl	24(%rax), %eax
 3400              		.loc 4 2193 11
 3401 0950 85C0     		testl	%eax, %eax
 3402 0952 0F8EBD02 		jle	.L197
 3402      0000
 3403              	.LBB17:
2194:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2195:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /*
2196:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * Process MAC and always update for padlen afterwards to make
2197:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * total time independent of padlen.
2198:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *
2199:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * Known timing attacks:
2200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *  - Lucky Thirteen (http://www.isg.rhul.ac.uk/tls/TLStiming.pdf)
2201:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *
2202:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * To compensate for different timings for the MAC calculation
2203:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * depending on how much padding was removed (which is determined
2204:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * by padlen), process extra_run more blocks through the hash
2205:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * function.
2206:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *
2207:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * The formula in the paper is
2208:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *   extra_run = ceil( (L1-55) / 64 ) - ceil( (L2-55) / 64 )
GAS LISTING /tmp/ccEn8xFO.s 			page 143


2209:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * where L1 is the size of the header plus the decrypted message
2210:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * plus CBC padding and L2 is the size of the header plus the
2211:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * decrypted message. This is for an underlying hash function
2212:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * with 64-byte blocks.
2213:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * We use ( (Lx+8) / 64 ) to handle 'negative Lx' values
2214:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * correctly. We round down instead of up, so -56 is the correct
2215:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * value for our calculations instead of -55.
2216:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *
2217:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * Repeat the formula rather than defining a block_size variable.
2218:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * This avoids requiring division by a variable at runtime
2219:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * (which would be marginally less efficient and would require
2220:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * linking an extra division function in some builds).
2221:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              */
2222:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             size_t j, extra_run = 0;
 3404              		.loc 4 2222 23
 3405 0958 48C74598 		movq	$0, -104(%rbp)
 3405      00000000 
2223:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2224:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /*
2225:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * The next two sizes are the minimum and maximum values of
2226:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * in_msglen over all padlen values.
2227:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *
2228:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * They're independent of padlen, since we previously did
2229:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * in_msglen -= padlen.
2230:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *
2231:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * Note that max_len + maclen is never more than the buffer
2232:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * length, as we previously did in_msglen -= maclen too.
2233:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              */
2234:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             const size_t max_len = ssl->in_msglen + padlen;
 3406              		.loc 4 2234 39
 3407 0960 488B85E8 		movq	-280(%rbp), %rax
 3407      FEFFFF
 3408 0967 488B90E0 		movq	224(%rax), %rdx
 3408      000000
 3409              		.loc 4 2234 26
 3410 096e 488B8518 		movq	-232(%rbp), %rax
 3410      FFFFFF
 3411 0975 4801D0   		addq	%rdx, %rax
 3412 0978 488945A0 		movq	%rax, -96(%rbp)
2235:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             const size_t min_len = ( max_len > 256 ) ? max_len - 256 : 0;
 3413              		.loc 4 2235 70
 3414 097c B8000100 		movl	$256, %eax
 3414      00
 3415 0981 48817DA0 		cmpq	$256, -96(%rbp)
 3415      00010000 
 3416 0989 480F4345 		cmovnb	-96(%rbp), %rax
 3416      A0
 3417              		.loc 4 2235 26
 3418 098e 482D0001 		subq	$256, %rax
 3418      0000
 3419 0994 488945A8 		movq	%rax, -88(%rbp)
2236:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2237:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             switch( ssl->transform_in->ciphersuite_info->mac )
 3420              		.loc 4 2237 24
 3421 0998 488B85E8 		movq	-280(%rbp), %rax
 3421      FEFFFF
 3422 099f 488B4068 		movq	104(%rax), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 144


 3423              		.loc 4 2237 38
 3424 09a3 488B00   		movq	(%rax), %rax
 3425              		.loc 4 2237 56
 3426 09a6 8B4014   		movl	20(%rax), %eax
 3427              		.loc 4 2237 13
 3428 09a9 83F804   		cmpl	$4, %eax
 3429 09ac 770A     		ja	.L198
 3430 09ae 83F803   		cmpl	$3, %eax
 3431 09b1 730E     		jnb	.L199
 3432 09b3 E97B0100 		jmp	.L200
 3432      00
 3433              	.L198:
 3434 09b8 83F806   		cmpl	$6, %eax
 3435 09bb 0F857201 		jne	.L200
 3435      0000
 3436              	.L199:
2238:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
2239:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_MD5_C) || defined(MBEDTLS_SHA1_C) || \
2240:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     defined(MBEDTLS_SHA256_C)
2241:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 case MBEDTLS_MD_MD5:
2242:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 case MBEDTLS_MD_SHA1:
2243:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 case MBEDTLS_MD_SHA256:
2244:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     /* 8 bytes of message size, 64-byte compression blocks */
2245:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     extra_run = ( 13 + ssl->in_msglen + padlen + 8 ) / 64 -
 3437              		.loc 4 2245 43
 3438 09c1 488B85E8 		movq	-280(%rbp), %rax
 3438      FEFFFF
 3439 09c8 488B90E0 		movq	224(%rax), %rdx
 3439      000000
 3440              		.loc 4 2245 55
 3441 09cf 488B8518 		movq	-232(%rbp), %rax
 3441      FFFFFF
 3442 09d6 4801D0   		addq	%rdx, %rax
 3443              		.loc 4 2245 64
 3444 09d9 4883C015 		addq	$21, %rax
 3445              		.loc 4 2245 70
 3446 09dd 48C1E806 		shrq	$6, %rax
 3447 09e1 4889C2   		movq	%rax, %rdx
2246:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 ( 13 + ssl->in_msglen          + 8 ) / 64;
 3448              		.loc 4 2246 43
 3449 09e4 488B85E8 		movq	-280(%rbp), %rax
 3449      FEFFFF
 3450 09eb 488B80E0 		movq	224(%rax), %rax
 3450      000000
 3451              		.loc 4 2246 64
 3452 09f2 4883C015 		addq	$21, %rax
 3453              		.loc 4 2246 70
 3454 09f6 48C1E806 		shrq	$6, %rax
2245:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 ( 13 + ssl->in_msglen          + 8 ) / 64;
 3455              		.loc 4 2245 31
 3456 09fa 4829C2   		subq	%rax, %rdx
 3457 09fd 4889D0   		movq	%rdx, %rax
 3458 0a00 48894598 		movq	%rax, -104(%rbp)
2247:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     break;
 3459              		.loc 4 2247 21
 3460 0a04 90       		nop
2248:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
GAS LISTING /tmp/ccEn8xFO.s 			page 145


2249:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
2250:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 case MBEDTLS_MD_SHA384:
2251:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     /* 16 bytes of message size, 128-byte compression blocks */
2252:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     extra_run = ( 13 + ssl->in_msglen + padlen + 16 ) / 128 -
2253:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 ( 13 + ssl->in_msglen          + 16 ) / 128;
2254:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     break;
2255:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
2256:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 default:
2257:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
2258:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
2259:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
2260:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2261:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             extra_run &= correct * 0xFF;
 3461              		.loc 4 2261 34
 3462 0a05 488B9520 		movq	-224(%rbp), %rdx
 3462      FFFFFF
 3463 0a0c 4889D0   		movq	%rdx, %rax
 3464 0a0f 48C1E008 		salq	$8, %rax
 3465 0a13 4829D0   		subq	%rdx, %rax
 3466              		.loc 4 2261 23
 3467 0a16 48214598 		andq	%rax, -104(%rbp)
2262:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2263:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_in->md_ctx_dec, ssl->in_ctr, 8 );
 3468              		.loc 4 2263 72
 3469 0a1a 488B85E8 		movq	-280(%rbp), %rax
 3469      FEFFFF
 3470 0a21 488B80A8 		movq	168(%rax), %rax
 3470      000000
 3471              		.loc 4 2263 41
 3472 0a28 488B95E8 		movq	-280(%rbp), %rdx
 3472      FEFFFF
 3473 0a2f 488B5268 		movq	104(%rdx), %rdx
 3474              		.loc 4 2263 13
 3475 0a33 488D4A68 		leaq	104(%rdx), %rcx
 3476 0a37 BA080000 		movl	$8, %edx
 3476      00
 3477 0a3c 4889C6   		movq	%rax, %rsi
 3478 0a3f 4889CF   		movq	%rcx, %rdi
 3479 0a42 E8000000 		call	mbedtls_md_hmac_update@PLT
 3479      00
2264:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_in->md_ctx_dec, ssl->in_hdr, 3 );
 3480              		.loc 4 2264 72
 3481 0a47 488B85E8 		movq	-280(%rbp), %rax
 3481      FEFFFF
 3482 0a4e 488B80B0 		movq	176(%rax), %rax
 3482      000000
 3483              		.loc 4 2264 41
 3484 0a55 488B95E8 		movq	-280(%rbp), %rdx
 3484      FEFFFF
 3485 0a5c 488B5268 		movq	104(%rdx), %rdx
 3486              		.loc 4 2264 13
 3487 0a60 488D4A68 		leaq	104(%rdx), %rcx
 3488 0a64 BA030000 		movl	$3, %edx
 3488      00
 3489 0a69 4889C6   		movq	%rax, %rsi
 3490 0a6c 4889CF   		movq	%rcx, %rdi
 3491 0a6f E8000000 		call	mbedtls_md_hmac_update@PLT
GAS LISTING /tmp/ccEn8xFO.s 			page 146


 3491      00
2265:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_in->md_ctx_dec, ssl->in_len, 2 );
 3492              		.loc 4 2265 72
 3493 0a74 488B85E8 		movq	-280(%rbp), %rax
 3493      FEFFFF
 3494 0a7b 488B80B8 		movq	184(%rax), %rax
 3494      000000
 3495              		.loc 4 2265 41
 3496 0a82 488B95E8 		movq	-280(%rbp), %rdx
 3496      FEFFFF
 3497 0a89 488B5268 		movq	104(%rdx), %rdx
 3498              		.loc 4 2265 13
 3499 0a8d 488D4A68 		leaq	104(%rdx), %rcx
 3500 0a91 BA020000 		movl	$2, %edx
 3500      00
 3501 0a96 4889C6   		movq	%rax, %rsi
 3502 0a99 4889CF   		movq	%rcx, %rdi
 3503 0a9c E8000000 		call	mbedtls_md_hmac_update@PLT
 3503      00
2266:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_in->md_ctx_dec, ssl->in_msg,
 3504              		.loc 4 2266 13
 3505 0aa1 488B85E8 		movq	-280(%rbp), %rax
 3505      FEFFFF
 3506 0aa8 488B90E0 		movq	224(%rax), %rdx
 3506      000000
 3507              		.loc 4 2266 72
 3508 0aaf 488B85E8 		movq	-280(%rbp), %rax
 3508      FEFFFF
 3509 0ab6 488B80C8 		movq	200(%rax), %rax
 3509      000000
 3510              		.loc 4 2266 41
 3511 0abd 488B8DE8 		movq	-280(%rbp), %rcx
 3511      FEFFFF
 3512 0ac4 488B4968 		movq	104(%rcx), %rcx
 3513              		.loc 4 2266 13
 3514 0ac8 4883C168 		addq	$104, %rcx
 3515 0acc 4889C6   		movq	%rax, %rsi
 3516 0acf 4889CF   		movq	%rcx, %rdi
 3517 0ad2 E8000000 		call	mbedtls_md_hmac_update@PLT
 3517      00
2267:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                              ssl->in_msglen );
2268:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Make sure we access everything even when padlen > 0. This
2269:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * makes the synchronisation requirements for just-in-time
2270:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * Prime+Probe attacks much tighter and hopefully impractical. */
2271:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl_read_memory( ssl->in_msg + ssl->in_msglen, padlen );
 3518              		.loc 4 2271 33
 3519 0ad7 488B85E8 		movq	-280(%rbp), %rax
 3519      FEFFFF
 3520 0ade 488B90C8 		movq	200(%rax), %rdx
 3520      000000
 3521              		.loc 4 2271 47
 3522 0ae5 488B85E8 		movq	-280(%rbp), %rax
 3522      FEFFFF
 3523 0aec 488B80E0 		movq	224(%rax), %rax
 3523      000000
 3524              		.loc 4 2271 13
 3525 0af3 4801C2   		addq	%rax, %rdx
GAS LISTING /tmp/ccEn8xFO.s 			page 147


 3526 0af6 488B8518 		movq	-232(%rbp), %rax
 3526      FFFFFF
 3527 0afd 4889C6   		movq	%rax, %rsi
 3528 0b00 4889D7   		movq	%rdx, %rdi
 3529 0b03 E8000000 		call	ssl_read_memory
 3529      00
2272:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_finish( &ssl->transform_in->md_ctx_dec, mac_expect );
 3530              		.loc 4 2272 41
 3531 0b08 488B85E8 		movq	-280(%rbp), %rax
 3531      FEFFFF
 3532 0b0f 488B4068 		movq	104(%rax), %rax
 3533              		.loc 4 2272 13
 3534 0b13 488D5068 		leaq	104(%rax), %rdx
 3535 0b17 488D45C0 		leaq	-64(%rbp), %rax
 3536 0b1b 4889C6   		movq	%rax, %rsi
 3537 0b1e 4889D7   		movq	%rdx, %rdi
 3538 0b21 E8000000 		call	mbedtls_md_hmac_finish@PLT
 3538      00
2273:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2274:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Call mbedtls_md_process at least once due to cache attacks
2275:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * that observe whether md_process() was called of not */
2276:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             for( j = 0; j < extra_run + 1; j++ )
 3539              		.loc 4 2276 20
 3540 0b26 48C78550 		movq	$0, -176(%rbp)
 3540      FFFFFF00 
 3540      000000
 3541              		.loc 4 2276 13
 3542 0b31 EB3A     		jmp	.L203
 3543              	.L200:
2258:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
 3544              		.loc 4 2258 27
 3545 0b33 B80094FF 		movl	$-27648, %eax
 3545      FF
 3546 0b38 E92C0200 		jmp	.L163
 3546      00
 3547              	.L204:
2277:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 mbedtls_md_process( &ssl->transform_in->md_ctx_dec, ssl->in_msg );
 3548              		.loc 4 2277 72 discriminator 3
 3549 0b3d 488B85E8 		movq	-280(%rbp), %rax
 3549      FEFFFF
 3550 0b44 488B80C8 		movq	200(%rax), %rax
 3550      000000
 3551              		.loc 4 2277 41 discriminator 3
 3552 0b4b 488B95E8 		movq	-280(%rbp), %rdx
 3552      FEFFFF
 3553 0b52 488B5268 		movq	104(%rdx), %rdx
 3554              		.loc 4 2277 17 discriminator 3
 3555 0b56 4883C268 		addq	$104, %rdx
 3556 0b5a 4889C6   		movq	%rax, %rsi
 3557 0b5d 4889D7   		movq	%rdx, %rdi
 3558 0b60 E8000000 		call	mbedtls_md_process@PLT
 3558      00
2276:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 mbedtls_md_process( &ssl->transform_in->md_ctx_dec, ssl->in_msg );
 3559              		.loc 4 2276 45 discriminator 3
 3560 0b65 48838550 		addq	$1, -176(%rbp)
 3560      FFFFFF01 
 3561              	.L203:
GAS LISTING /tmp/ccEn8xFO.s 			page 148


2276:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 mbedtls_md_process( &ssl->transform_in->md_ctx_dec, ssl->in_msg );
 3562              		.loc 4 2276 39 discriminator 1
 3563 0b6d 488B4598 		movq	-104(%rbp), %rax
 3564 0b71 4883C001 		addq	$1, %rax
2276:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 mbedtls_md_process( &ssl->transform_in->md_ctx_dec, ssl->in_msg );
 3565              		.loc 4 2276 13 discriminator 1
 3566 0b75 48398550 		cmpq	%rax, -176(%rbp)
 3566      FFFFFF
 3567 0b7c 72BF     		jb	.L204
2278:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2279:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_md_hmac_reset( &ssl->transform_in->md_ctx_dec );
 3568              		.loc 4 2279 40
 3569 0b7e 488B85E8 		movq	-280(%rbp), %rax
 3569      FEFFFF
 3570 0b85 488B4068 		movq	104(%rax), %rax
 3571              		.loc 4 2279 13
 3572 0b89 4883C068 		addq	$104, %rax
 3573 0b8d 4889C7   		movq	%rax, %rdi
 3574 0b90 E8000000 		call	mbedtls_md_hmac_reset@PLT
 3574      00
2280:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2281:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Make sure we access all the memory that could contain the MAC,
2282:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * before we check it in the next code block. This makes the
2283:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * synchronisation requirements for just-in-time Prime+Probe
2284:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * attacks much tighter and hopefully impractical. */
2285:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl_read_memory( ssl->in_msg + min_len,
2286:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  max_len - min_len + ssl->transform_in->maclen );
 3575              		.loc 4 2286 42
 3576 0b95 488B45A0 		movq	-96(%rbp), %rax
 3577 0b99 482B45A8 		subq	-88(%rbp), %rax
 3578 0b9d 4889C2   		movq	%rax, %rdx
 3579              		.loc 4 2286 57
 3580 0ba0 488B85E8 		movq	-280(%rbp), %rax
 3580      FEFFFF
 3581 0ba7 488B4068 		movq	104(%rax), %rax
 3582              		.loc 4 2286 71
 3583 0bab 488B4028 		movq	40(%rax), %rax
2285:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  max_len - min_len + ssl->transform_in->maclen );
 3584              		.loc 4 2285 13
 3585 0baf 4801C2   		addq	%rax, %rdx
2285:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  max_len - min_len + ssl->transform_in->maclen );
 3586              		.loc 4 2285 33
 3587 0bb2 488B85E8 		movq	-280(%rbp), %rax
 3587      FEFFFF
 3588 0bb9 488B88C8 		movq	200(%rax), %rcx
 3588      000000
2285:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  max_len - min_len + ssl->transform_in->maclen );
 3589              		.loc 4 2285 13
 3590 0bc0 488B45A8 		movq	-88(%rbp), %rax
 3591 0bc4 4801C8   		addq	%rcx, %rax
 3592 0bc7 4889D6   		movq	%rdx, %rsi
 3593 0bca 4889C7   		movq	%rax, %rdi
 3594 0bcd E8000000 		call	ssl_read_memory
 3594      00
 3595              	.LBE17:
2287:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2288:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else
GAS LISTING /tmp/ccEn8xFO.s 			page 149


2289:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1 || MBEDTLS_SSL_PROTO_TLS1_1 || \
2290:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****               MBEDTLS_SSL_PROTO_TLS1_2 */
2291:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2292:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
2293:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
2294:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2295:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2296:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DEBUG_ALL)
2297:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "expected mac", mac_expect, ssl->transform_in->maclen );
2298:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "message  mac", ssl->in_msg + ssl->in_msglen,
2299:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                ssl->transform_in->maclen );
2300:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
2301:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( mbedtls_ssl_safer_memcmp( ssl->in_msg + ssl->in_msglen, mac_expect,
2303:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                       ssl->transform_in->maclen ) != 0 )
 3596              		.loc 4 2303 42
 3597 0bd2 488B85E8 		movq	-280(%rbp), %rax
 3597      FEFFFF
 3598 0bd9 488B4068 		movq	104(%rax), %rax
2302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                       ssl->transform_in->maclen ) != 0 )
 3599              		.loc 4 2302 13
 3600 0bdd 488B5028 		movq	40(%rax), %rdx
2302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                       ssl->transform_in->maclen ) != 0 )
 3601              		.loc 4 2302 42
 3602 0be1 488B85E8 		movq	-280(%rbp), %rax
 3602      FEFFFF
 3603 0be8 488B88C8 		movq	200(%rax), %rcx
 3603      000000
2302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                       ssl->transform_in->maclen ) != 0 )
 3604              		.loc 4 2302 56
 3605 0bef 488B85E8 		movq	-280(%rbp), %rax
 3605      FEFFFF
 3606 0bf6 488B80E0 		movq	224(%rax), %rax
 3606      000000
2302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                       ssl->transform_in->maclen ) != 0 )
 3607              		.loc 4 2302 51
 3608 0bfd 4801C1   		addq	%rax, %rcx
2302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                       ssl->transform_in->maclen ) != 0 )
 3609              		.loc 4 2302 13
 3610 0c00 488D45C0 		leaq	-64(%rbp), %rax
 3611 0c04 4889C6   		movq	%rax, %rsi
 3612 0c07 4889CF   		movq	%rcx, %rdi
 3613 0c0a E8000000 		call	mbedtls_ssl_safer_memcmp
 3613      00
2302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                       ssl->transform_in->maclen ) != 0 )
 3614              		.loc 4 2302 11
 3615 0c0f 85C0     		testl	%eax, %eax
 3616 0c11 7417     		je	.L206
 3617 0c13 EB0A     		jmp	.L218
 3618              	.L197:
2293:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
 3619              		.loc 4 2293 19
 3620 0c15 B80094FF 		movl	$-27648, %eax
 3620      FF
 3621 0c1a E94A0100 		jmp	.L163
 3621      00
 3622              	.L218:
GAS LISTING /tmp/ccEn8xFO.s 			page 150


2304:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2305:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DEBUG_ALL)
2306:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "message mac does not match" ) );
2307:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
2308:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             correct = 0;
 3623              		.loc 4 2308 21
 3624 0c1f 48C78520 		movq	$0, -224(%rbp)
 3624      FFFFFF00 
 3624      000000
 3625              	.L206:
2309:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2310:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         auth_done++;
 3626              		.loc 4 2310 18
 3627 0c2a 838500FF 		addl	$1, -256(%rbp)
 3627      FFFF01
 3628              	.L196:
 3629              	.LBE16:
2311:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2312:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2313:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
2314:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Finally check the correct flag
2315:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
2316:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( correct == 0 )
 3630              		.loc 4 2316 7
 3631 0c31 4883BD20 		cmpq	$0, -224(%rbp)
 3631      FFFFFF00 
 3632 0c39 750A     		jne	.L207
2317:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INVALID_MAC );
 3633              		.loc 4 2317 15
 3634 0c3b B8808EFF 		movl	$-29056, %eax
 3634      FF
 3635 0c40 E9240100 		jmp	.L163
 3635      00
 3636              	.L207:
2318:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* SSL_SOME_MODES_USE_MAC */
2319:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2320:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Make extra sure authentication was performed, exactly once */
2321:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( auth_done != 1 )
 3637              		.loc 4 2321 7
 3638 0c45 83BD00FF 		cmpl	$1, -256(%rbp)
 3638      FFFF01
 3639 0c4c 740A     		je	.L208
2322:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2323:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
2324:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 3640              		.loc 4 2324 15
 3641 0c4e B80094FF 		movl	$-27648, %eax
 3641      FF
 3642 0c53 E9110100 		jmp	.L163
 3642      00
 3643              	.L208:
2325:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2326:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2327:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_msglen == 0 )
 3644              		.loc 4 2327 12
 3645 0c58 488B85E8 		movq	-280(%rbp), %rax
 3645      FEFFFF
GAS LISTING /tmp/ccEn8xFO.s 			page 151


 3646 0c5f 488B80E0 		movq	224(%rax), %rax
 3646      000000
 3647              		.loc 4 2327 7
 3648 0c66 4885C0   		testq	%rax, %rax
 3649 0c69 7564     		jne	.L209
2328:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2329:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
2330:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_3
 3650              		.loc 4 2330 16
 3651 0c6b 488B85E8 		movq	-280(%rbp), %rax
 3651      FEFFFF
 3652 0c72 8B4018   		movl	24(%rax), %eax
 3653              		.loc 4 2330 11
 3654 0c75 83F803   		cmpl	$3, %eax
 3655 0c78 751C     		jne	.L210
2331:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             && ssl->in_msgtype != MBEDTLS_SSL_MSG_APPLICATION_DATA )
 3656              		.loc 4 2331 19
 3657 0c7a 488B85E8 		movq	-280(%rbp), %rax
 3657      FEFFFF
 3658 0c81 8B80D800 		movl	216(%rax), %eax
 3658      0000
 3659              		.loc 4 2331 13
 3660 0c87 83F817   		cmpl	$23, %eax
 3661 0c8a 740A     		je	.L210
2332:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2333:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* TLS v1.2 explicitly disallows zero-length messages which are not application data */
2334:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "invalid zero-length message type: %d", ssl->in_msgtype ) )
2335:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_RECORD );
 3662              		.loc 4 2335 19
 3663 0c8c B8008EFF 		movl	$-29184, %eax
 3663      FF
 3664 0c91 E9D30000 		jmp	.L163
 3664      00
 3665              	.L210:
2336:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2337:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
2338:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2339:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->nb_zero++;
 3666              		.loc 4 2339 12
 3667 0c96 488B85E8 		movq	-280(%rbp), %rax
 3667      FEFFFF
 3668 0c9d 8B80F800 		movl	248(%rax), %eax
 3668      0000
 3669              		.loc 4 2339 21
 3670 0ca3 8D5001   		leal	1(%rax), %edx
 3671 0ca6 488B85E8 		movq	-280(%rbp), %rax
 3671      FEFFFF
 3672 0cad 8990F800 		movl	%edx, 248(%rax)
 3672      0000
2340:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2341:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
2342:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Three or more empty messages may be a DoS attack
2343:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * (excessive CPU consumption).
2344:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
2345:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->nb_zero > 3 )
 3673              		.loc 4 2345 16
 3674 0cb3 488B85E8 		movq	-280(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 152


 3674      FEFFFF
 3675 0cba 8B80F800 		movl	248(%rax), %eax
 3675      0000
 3676              		.loc 4 2345 11
 3677 0cc0 83F803   		cmpl	$3, %eax
 3678 0cc3 7E1B     		jle	.L211
2346:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2347:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "received four consecutive empty "
2348:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 "messages, possible DoS attack" ) );
2349:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_MAC );
 3679              		.loc 4 2349 19
 3680 0cc5 B8808EFF 		movl	$-29056, %eax
 3680      FF
 3681 0cca E99A0000 		jmp	.L163
 3681      00
 3682              	.L209:
2350:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2351:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2352:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
2353:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->nb_zero = 0;
 3683              		.loc 4 2353 22
 3684 0ccf 488B85E8 		movq	-280(%rbp), %rax
 3684      FEFFFF
 3685 0cd6 C780F800 		movl	$0, 248(%rax)
 3685      00000000 
 3685      0000
 3686              	.L211:
 3687              	.LBB18:
2354:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2355:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
2356:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
2357:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2358:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ; /* in_ctr read from peer, not maintained internally */
2359:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2360:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
2361:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
2362:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2363:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         unsigned char i;
2364:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         for( i = 8; i > ssl_ep_len( ssl ); i-- )
 3688              		.loc 4 2364 16
 3689 0ce0 C685FEFE 		movb	$8, -258(%rbp)
 3689      FFFF08
 3690              		.loc 4 2364 9
 3691 0ce7 EB3B     		jmp	.L212
 3692              	.L215:
2365:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ++ssl->in_ctr[i - 1] != 0 )
 3693              		.loc 4 2365 22
 3694 0ce9 488B85E8 		movq	-280(%rbp), %rax
 3694      FEFFFF
 3695 0cf0 488B80A8 		movq	168(%rax), %rax
 3695      000000
 3696              		.loc 4 2365 30
 3697 0cf7 0FB695FE 		movzbl	-258(%rbp), %edx
 3697      FEFFFF
 3698 0cfe 4883EA01 		subq	$1, %rdx
 3699 0d02 4801D0   		addq	%rdx, %rax
 3700 0d05 0FB610   		movzbl	(%rax), %edx
GAS LISTING /tmp/ccEn8xFO.s 			page 153


 3701              		.loc 4 2365 17
 3702 0d08 83C201   		addl	$1, %edx
 3703              		.loc 4 2365 15
 3704 0d0b 8810     		movb	%dl, (%rax)
 3705              		.loc 4 2365 30
 3706 0d0d 0FB600   		movzbl	(%rax), %eax
 3707              		.loc 4 2365 15
 3708 0d10 84C0     		testb	%al, %al
 3709 0d12 752D     		jne	.L220
2364:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ++ssl->in_ctr[i - 1] != 0 )
 3710              		.loc 4 2364 45 discriminator 2
 3711 0d14 0FB685FE 		movzbl	-258(%rbp), %eax
 3711      FEFFFF
 3712 0d1b 83E801   		subl	$1, %eax
 3713 0d1e 8885FEFE 		movb	%al, -258(%rbp)
 3713      FFFF
 3714              	.L212:
2364:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ++ssl->in_ctr[i - 1] != 0 )
 3715              		.loc 4 2364 23 discriminator 1
 3716 0d24 0FB69DFE 		movzbl	-258(%rbp), %ebx
 3716      FEFFFF
2364:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ++ssl->in_ctr[i - 1] != 0 )
 3717              		.loc 4 2364 25 discriminator 1
 3718 0d2b 488B85E8 		movq	-280(%rbp), %rax
 3718      FEFFFF
 3719 0d32 4889C7   		movq	%rax, %rdi
 3720 0d35 E8000000 		call	ssl_ep_len
 3720      00
2364:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ++ssl->in_ctr[i - 1] != 0 )
 3721              		.loc 4 2364 9 discriminator 1
 3722 0d3a 4839C3   		cmpq	%rax, %rbx
 3723 0d3d 77AA     		ja	.L215
 3724 0d3f EB01     		jmp	.L214
 3725              	.L220:
2366:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 break;
 3726              		.loc 4 2366 17
 3727 0d41 90       		nop
 3728              	.L214:
2367:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2368:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* The loop goes to its end iff the counter is wrapping */
2369:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( i == ssl_ep_len( ssl ) )
 3729              		.loc 4 2369 15
 3730 0d42 0FB69DFE 		movzbl	-258(%rbp), %ebx
 3730      FEFFFF
 3731              		.loc 4 2369 18
 3732 0d49 488B85E8 		movq	-280(%rbp), %rax
 3732      FEFFFF
 3733 0d50 4889C7   		movq	%rax, %rdi
 3734 0d53 E8000000 		call	ssl_ep_len
 3734      00
 3735              		.loc 4 2369 11
 3736 0d58 4839C3   		cmpq	%rax, %rbx
 3737 0d5b 7507     		jne	.L216
2370:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2371:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "incoming message counter would wrap" ) );
2372:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_COUNTER_WRAPPING );
 3738              		.loc 4 2372 19
GAS LISTING /tmp/ccEn8xFO.s 			page 154


 3739 0d5d B88094FF 		movl	$-27520, %eax
 3739      FF
 3740 0d62 EB05     		jmp	.L163
 3741              	.L216:
 3742              	.LBE18:
2373:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2374:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2375:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2376:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= decrypt buf" ) );
2377:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2378:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 3743              		.loc 4 2378 11
 3744 0d64 B8000000 		movl	$0, %eax
 3744      00
 3745              	.L163:
2379:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 3746              		.loc 4 2379 1
 3747 0d69 488B5DE8 		movq	-24(%rbp), %rbx
 3748 0d6d 6448331C 		xorq	%fs:40, %rbx
 3748      25280000 
 3748      00
 3749 0d76 7405     		je	.L217
 3750 0d78 E8000000 		call	__stack_chk_fail@PLT
 3750      00
 3751              	.L217:
 3752 0d7d 488B5DF8 		movq	-8(%rbp), %rbx
 3753 0d81 C9       		leave
 3754              	.LCFI59:
 3755              		.cfi_def_cfa 7, 8
 3756 0d82 C3       		ret
 3757              		.cfi_endproc
 3758              	.LFE38:
 3760              		.section	.text.mbedtls_ssl_fetch_input,"ax",@progbits
 3761              		.globl	mbedtls_ssl_fetch_input
 3763              	mbedtls_ssl_fetch_input:
 3764              	.LFB39:
2380:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2381:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #undef MAC_NONE
2382:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #undef MAC_PLAINTEXT
2383:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #undef MAC_CIPHERTEXT
2384:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2385:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_ZLIB_SUPPORT)
2386:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
2387:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Compression/decompression functions
2388:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
2389:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_compress_buf( mbedtls_ssl_context *ssl )
2390:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
2391:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
2392:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char *msg_post = ssl->out_msg;
2393:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ptrdiff_t bytes_written = ssl->out_msg - ssl->out_buf;
2394:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t len_pre = ssl->out_msglen;
2395:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char *msg_pre = ssl->compress_buf;
2396:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2397:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> compress buf" ) );
2398:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2399:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( len_pre == 0 )
2400:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
GAS LISTING /tmp/ccEn8xFO.s 			page 155


2401:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2402:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( msg_pre, ssl->out_msg, len_pre );
2403:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2404:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "before compression: msglen = %d, ",
2405:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                    ssl->out_msglen ) );
2406:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2407:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "before compression: output payload",
2408:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                    ssl->out_msg, ssl->out_msglen );
2409:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2410:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->transform_out->ctx_deflate.next_in = msg_pre;
2411:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->transform_out->ctx_deflate.avail_in = len_pre;
2412:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->transform_out->ctx_deflate.next_out = msg_post;
2413:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->transform_out->ctx_deflate.avail_out = MBEDTLS_SSL_OUT_BUFFER_LEN - bytes_written;
2414:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2415:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ret = deflate( &ssl->transform_out->ctx_deflate, Z_SYNC_FLUSH );
2416:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ret != Z_OK )
2417:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2418:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "failed to perform compression (%d)", ret ) );
2419:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_COMPRESSION_FAILED );
2420:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2421:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2422:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_msglen = MBEDTLS_SSL_OUT_BUFFER_LEN -
2423:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                       ssl->transform_out->ctx_deflate.avail_out - bytes_written;
2424:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2425:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "after compression: msglen = %d, ",
2426:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                    ssl->out_msglen ) );
2427:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2428:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "after compression: output payload",
2429:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                    ssl->out_msg, ssl->out_msglen );
2430:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2431:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= compress buf" ) );
2432:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2433:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
2434:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
2435:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2436:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_decompress_buf( mbedtls_ssl_context *ssl )
2437:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
2438:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
2439:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char *msg_post = ssl->in_msg;
2440:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ptrdiff_t header_bytes = ssl->in_msg - ssl->in_buf;
2441:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t len_pre = ssl->in_msglen;
2442:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char *msg_pre = ssl->compress_buf;
2443:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2444:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> decompress buf" ) );
2445:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2446:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( len_pre == 0 )
2447:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
2448:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2449:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( msg_pre, ssl->in_msg, len_pre );
2450:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2451:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "before decompression: msglen = %d, ",
2452:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                    ssl->in_msglen ) );
2453:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2454:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "before decompression: input payload",
2455:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                    ssl->in_msg, ssl->in_msglen );
2456:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2457:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->transform_in->ctx_inflate.next_in = msg_pre;
GAS LISTING /tmp/ccEn8xFO.s 			page 156


2458:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->transform_in->ctx_inflate.avail_in = len_pre;
2459:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->transform_in->ctx_inflate.next_out = msg_post;
2460:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->transform_in->ctx_inflate.avail_out = MBEDTLS_SSL_IN_BUFFER_LEN -
2461:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                                header_bytes;
2462:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2463:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ret = inflate( &ssl->transform_in->ctx_inflate, Z_SYNC_FLUSH );
2464:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ret != Z_OK )
2465:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2466:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "failed to perform decompression (%d)", ret ) );
2467:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_COMPRESSION_FAILED );
2468:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2469:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2470:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->in_msglen = MBEDTLS_SSL_IN_BUFFER_LEN -
2471:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      ssl->transform_in->ctx_inflate.avail_out - header_bytes;
2472:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2473:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "after decompression: msglen = %d, ",
2474:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                    ssl->in_msglen ) );
2475:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2476:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "after decompression: input payload",
2477:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                    ssl->in_msg, ssl->in_msglen );
2478:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2479:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= decompress buf" ) );
2480:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2481:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
2482:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
2483:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_ZLIB_SUPPORT */
2484:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2485:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C) && defined(MBEDTLS_SSL_RENEGOTIATION)
2486:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_write_hello_request( mbedtls_ssl_context *ssl );
2487:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2488:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
2489:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_resend_hello_request( mbedtls_ssl_context *ssl )
2490:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
2491:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* If renegotiation is not enforced, retransmit until we would reach max
2492:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * timeout if we were using the usual handshake doubling scheme */
2493:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->renego_max_records < 0 )
2494:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2495:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         uint32_t ratio = ssl->conf->hs_timeout_max / ssl->conf->hs_timeout_min + 1;
2496:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         unsigned char doublings = 1;
2497:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2498:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         while( ratio != 0 )
2499:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2500:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ++doublings;
2501:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ratio >>= 1;
2502:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2503:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2504:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ++ssl->renego_records_seen > doublings )
2505:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2506:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "no longer retransmitting hello request" ) );
2507:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( 0 );
2508:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2509:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2510:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2511:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ssl_write_hello_request( ssl ) );
2512:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
2513:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
2514:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_SRV_C && MBEDTLS_SSL_RENEGOTIATION */
GAS LISTING /tmp/ccEn8xFO.s 			page 157


2515:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2516:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
2517:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Fill the input message buffer by appending data to it.
2518:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * The amount of data already fetched is in ssl->in_left.
2519:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
2520:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * If we return 0, is it guaranteed that (at least) nb_want bytes are
2521:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * available (from this read and/or a previous one). Otherwise, an error code
2522:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * is returned (possibly EOF or WANT_READ).
2523:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
2524:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * With stream transport (TLS) on success ssl->in_left == nb_want, but
2525:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * with datagram transport (DTLS) on success ssl->in_left >= nb_want,
2526:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * since we always read a whole datagram at once.
2527:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
2528:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * For DTLS, it is up to the caller to set ssl->next_record_offset when
2529:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * they're done reading a record.
2530:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
2531:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_fetch_input( mbedtls_ssl_context *ssl, size_t nb_want )
2532:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 3765              		.loc 4 2532 1
 3766              		.cfi_startproc
 3767 0000 F30F1EFA 		endbr64
 3768 0004 55       		pushq	%rbp
 3769              	.LCFI60:
 3770              		.cfi_def_cfa_offset 16
 3771              		.cfi_offset 6, -16
 3772 0005 4889E5   		movq	%rsp, %rbp
 3773              	.LCFI61:
 3774              		.cfi_def_cfa_register 6
 3775 0008 4883EC30 		subq	$48, %rsp
 3776 000c 48897DD8 		movq	%rdi, -40(%rbp)
 3777 0010 488975D0 		movq	%rsi, -48(%rbp)
 3778              		.loc 4 2532 1
 3779 0014 64488B04 		movq	%fs:40, %rax
 3779      25280000 
 3779      00
 3780 001d 488945F8 		movq	%rax, -8(%rbp)
 3781 0021 31C0     		xorl	%eax, %eax
2533:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
2534:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t len;
2535:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2536:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> fetch input" ) );
2537:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2538:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->f_recv == NULL && ssl->f_recv_timeout == NULL )
 3782              		.loc 4 2538 12
 3783 0023 488B45D8 		movq	-40(%rbp), %rax
 3784 0027 488B4028 		movq	40(%rax), %rax
 3785              		.loc 4 2538 7
 3786 002b 4885C0   		testq	%rax, %rax
 3787 002e 7517     		jne	.L222
 3788              		.loc 4 2538 35 discriminator 1
 3789 0030 488B45D8 		movq	-40(%rbp), %rax
 3790 0034 488B4030 		movq	48(%rax), %rax
 3791              		.loc 4 2538 29 discriminator 1
 3792 0038 4885C0   		testq	%rax, %rax
 3793 003b 750A     		jne	.L222
2539:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2540:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "Bad usage of mbedtls_ssl_set_bio() "
GAS LISTING /tmp/ccEn8xFO.s 			page 158


2541:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             "or mbedtls_ssl_set_bio()" ) );
2542:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 3794              		.loc 4 2542 15
 3795 003d B8008FFF 		movl	$-28928, %eax
 3795      FF
 3796 0042 E95B0100 		jmp	.L223
 3796      00
 3797              	.L222:
2543:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2544:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2545:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( nb_want > MBEDTLS_SSL_IN_BUFFER_LEN - (size_t)( ssl->in_hdr - ssl->in_buf ) )
 3798              		.loc 4 2545 60
 3799 0047 488B45D8 		movq	-40(%rbp), %rax
 3800 004b 488B90B0 		movq	176(%rax), %rdx
 3800      000000
 3801              		.loc 4 2545 74
 3802 0052 488B45D8 		movq	-40(%rbp), %rax
 3803 0056 488B80A0 		movq	160(%rax), %rax
 3803      000000
 3804              		.loc 4 2545 69
 3805 005d 4829C2   		subq	%rax, %rdx
 3806 0060 4889D0   		movq	%rdx, %rax
 3807              		.loc 4 2545 45
 3808 0063 BABD3F00 		movl	$16317, %edx
 3808      00
 3809 0068 4829C2   		subq	%rax, %rdx
 3810 006b 4889D0   		movq	%rdx, %rax
 3811              		.loc 4 2545 7
 3812 006e 483945D0 		cmpq	%rax, -48(%rbp)
 3813 0072 0F861001 		jbe	.L225
 3813      0000
2546:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2547:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "requesting more data than fits" ) );
2548:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 3814              		.loc 4 2548 15
 3815 0078 B8008FFF 		movl	$-28928, %eax
 3815      FF
 3816 007d E9200100 		jmp	.L223
 3816      00
 3817              	.L232:
2549:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2550:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2551:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
2552:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
2553:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2554:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         uint32_t timeout;
2555:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2556:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Just to be sure */
2557:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->f_set_timer == NULL || ssl->f_get_timer == NULL )
2558:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2559:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "You must use "
2560:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         "mbedtls_ssl_set_timer_cb() for DTLS" ) );
2561:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
2562:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2563:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2564:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
2565:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * The point is, we need to always read a full datagram at once, so we
GAS LISTING /tmp/ccEn8xFO.s 			page 159


2566:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * sometimes read more then requested, and handle the additional data.
2567:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * It could be the rest of the current record (while fetching the
2568:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * header) and/or some other records in the same datagram.
2569:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
2570:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2571:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
2572:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Move to the next record in the already read datagram if applicable
2573:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
2574:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->next_record_offset != 0 )
2575:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2576:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ssl->in_left < ssl->next_record_offset )
2577:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
2578:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
2579:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
2580:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
2581:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2582:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_left -= ssl->next_record_offset;
2583:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2584:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ssl->in_left != 0 )
2585:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
2586:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 2, ( "next record in same datagram, offset: %d",
2587:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     ssl->next_record_offset ) );
2588:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 memmove( ssl->in_hdr,
2589:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                          ssl->in_hdr + ssl->next_record_offset,
2590:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                          ssl->in_left );
2591:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
2592:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2593:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->next_record_offset = 0;
2594:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2595:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2596:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "in_left: %d, nb_want: %d",
2597:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                        ssl->in_left, nb_want ) );
2598:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2599:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
2600:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Done if we already have enough data.
2601:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
2602:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( nb_want <= ssl->in_left)
2603:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2604:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= fetch input" ) );
2605:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( 0 );
2606:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2607:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2608:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
2609:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * A record can't be split accross datagrams. If we need to read but
2610:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * are not at the beginning of a new record, the caller did something
2611:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * wrong.
2612:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
2613:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_left != 0 )
2614:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2615:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
2616:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
2617:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2618:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2619:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
2620:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Don't even try to read if time's out already.
2621:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * This avoids by-passing the timer when repeatedly receiving messages
2622:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * that will end up being dropped.
GAS LISTING /tmp/ccEn8xFO.s 			page 160


2623:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
2624:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl_check_timer( ssl ) != 0 )
2625:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2626:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "timer has expired" ) );
2627:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ret = MBEDTLS_ERR_SSL_TIMEOUT;
2628:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2629:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else
2630:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2631:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             len = MBEDTLS_SSL_IN_BUFFER_LEN - ( ssl->in_hdr - ssl->in_buf );
2632:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2633:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ssl->state != MBEDTLS_SSL_HANDSHAKE_OVER )
2634:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 timeout = ssl->handshake->retransmit_timeout;
2635:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else
2636:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 timeout = ssl->conf->read_timeout;
2637:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2638:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "f_recv_timeout: %u ms", timeout ) );
2639:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2640:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ssl->f_recv_timeout != NULL )
2641:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ret = ssl->f_recv_timeout( ssl->p_bio, ssl->in_hdr, len,
2642:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                                                     timeout );
2643:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else
2644:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ret = ssl->f_recv( ssl->p_bio, ssl->in_hdr, len );
2645:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2646:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 2, "ssl->f_recv(_timeout)", ret );
2647:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2648:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ret == 0 )
2649:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_CONN_EOF );
2650:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2651:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2652:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ret == MBEDTLS_ERR_SSL_TIMEOUT )
2653:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2654:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "timeout" ) );
2655:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl_set_timer( ssl, 0 );
2656:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2657:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ssl->state != MBEDTLS_SSL_HANDSHAKE_OVER )
2658:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
2659:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( ssl_double_retransmit_timeout( ssl ) != 0 )
2660:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
2661:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_MSG( 1, ( "handshake timeout" ) );
2662:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     return( MBEDTLS_ERR_SSL_TIMEOUT );
2663:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
2664:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2665:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( ( ret = mbedtls_ssl_resend( ssl ) ) != 0 )
2666:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
2667:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_resend", ret );
2668:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     return( ret );
2669:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
2670:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2671:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_WANT_READ );
2672:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
2673:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C) && defined(MBEDTLS_SSL_RENEGOTIATION)
2674:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER &&
2675:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      ssl->renego_status == MBEDTLS_SSL_RENEGOTIATION_PENDING )
2676:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
2677:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( ( ret = ssl_resend_hello_request( ssl ) ) != 0 )
2678:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
2679:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_RET( 1, "ssl_resend_hello_request", ret );
GAS LISTING /tmp/ccEn8xFO.s 			page 161


2680:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     return( ret );
2681:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
2682:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2683:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_WANT_READ );
2684:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
2685:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_SRV_C && MBEDTLS_SSL_RENEGOTIATION */
2686:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2687:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2688:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ret < 0 )
2689:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
2690:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2691:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_left = ret;
2692:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2693:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
2694:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
2695:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2696:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "in_left: %d, nb_want: %d",
2697:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                        ssl->in_left, nb_want ) );
2698:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2699:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         while( ssl->in_left < nb_want )
2700:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2701:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             len = nb_want - ssl->in_left;
 3818              		.loc 4 2701 32
 3819 0082 488B45D8 		movq	-40(%rbp), %rax
 3820 0086 488B80E8 		movq	232(%rax), %rax
 3820      000000
 3821              		.loc 4 2701 17
 3822 008d 488B55D0 		movq	-48(%rbp), %rdx
 3823 0091 4829C2   		subq	%rax, %rdx
 3824 0094 4889D0   		movq	%rdx, %rax
 3825 0097 488945F0 		movq	%rax, -16(%rbp)
2702:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2703:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ssl_check_timer( ssl ) != 0 )
 3826              		.loc 4 2703 17
 3827 009b 488B45D8 		movq	-40(%rbp), %rax
 3828 009f 4889C7   		movq	%rax, %rdi
 3829 00a2 E8000000 		call	ssl_check_timer
 3829      00
 3830              		.loc 4 2703 15
 3831 00a7 85C0     		testl	%eax, %eax
 3832 00a9 740C     		je	.L226
2704:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ret = MBEDTLS_ERR_SSL_TIMEOUT;
 3833              		.loc 4 2704 21
 3834 00ab C745EC00 		movl	$-26624, -20(%rbp)
 3834      98FFFF
 3835 00b2 E9890000 		jmp	.L227
 3835      00
 3836              	.L226:
2705:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else
2706:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
2707:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( ssl->f_recv_timeout != NULL )
 3837              		.loc 4 2707 24
 3838 00b7 488B45D8 		movq	-40(%rbp), %rax
 3839 00bb 488B4030 		movq	48(%rax), %rax
 3840              		.loc 4 2707 19
 3841 00bf 4885C0   		testq	%rax, %rax
 3842 00c2 7446     		je	.L228
GAS LISTING /tmp/ccEn8xFO.s 			page 162


2708:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
2709:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ret = ssl->f_recv_timeout( ssl->p_bio,
 3843              		.loc 4 2709 30
 3844 00c4 488B45D8 		movq	-40(%rbp), %rax
 3845 00c8 4C8B4030 		movq	48(%rax), %r8
2710:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                                ssl->in_hdr + ssl->in_left, len,
2711:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                                ssl->conf->read_timeout );
 3846              		.loc 4 2711 51
 3847 00cc 488B45D8 		movq	-40(%rbp), %rax
 3848 00d0 488B00   		movq	(%rax), %rax
2709:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                                ssl->in_hdr + ssl->in_left, len,
 3849              		.loc 4 2709 27
 3850 00d3 8B88A800 		movl	168(%rax), %ecx
 3850      0000
2710:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                                ssl->in_hdr + ssl->in_left, len,
 3851              		.loc 4 2710 51
 3852 00d9 488B45D8 		movq	-40(%rbp), %rax
 3853 00dd 488B90B0 		movq	176(%rax), %rdx
 3853      000000
2710:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                                ssl->in_hdr + ssl->in_left, len,
 3854              		.loc 4 2710 65
 3855 00e4 488B45D8 		movq	-40(%rbp), %rax
 3856 00e8 488B80E8 		movq	232(%rax), %rax
 3856      000000
2709:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                                ssl->in_hdr + ssl->in_left, len,
 3857              		.loc 4 2709 27
 3858 00ef 488D3402 		leaq	(%rdx,%rax), %rsi
 3859 00f3 488B45D8 		movq	-40(%rbp), %rax
 3860 00f7 488B4038 		movq	56(%rax), %rax
 3861 00fb 488B55F0 		movq	-16(%rbp), %rdx
 3862 00ff 4889C7   		movq	%rax, %rdi
 3863 0102 41FFD0   		call	*%r8
 3864              	.LVL8:
 3865 0105 8945EC   		movl	%eax, -20(%rbp)
 3866 0108 EB36     		jmp	.L227
 3867              	.L228:
2712:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
2713:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 else
2714:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
2715:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ret = ssl->f_recv( ssl->p_bio,
 3868              		.loc 4 2715 30
 3869 010a 488B45D8 		movq	-40(%rbp), %rax
 3870 010e 488B4828 		movq	40(%rax), %rcx
2716:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                        ssl->in_hdr + ssl->in_left, len );
 3871              		.loc 4 2716 43
 3872 0112 488B45D8 		movq	-40(%rbp), %rax
 3873 0116 488B90B0 		movq	176(%rax), %rdx
 3873      000000
 3874              		.loc 4 2716 57
 3875 011d 488B45D8 		movq	-40(%rbp), %rax
 3876 0121 488B80E8 		movq	232(%rax), %rax
 3876      000000
2715:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                        ssl->in_hdr + ssl->in_left, len );
 3877              		.loc 4 2715 27
 3878 0128 488D3402 		leaq	(%rdx,%rax), %rsi
 3879 012c 488B45D8 		movq	-40(%rbp), %rax
 3880 0130 488B4038 		movq	56(%rax), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 163


 3881 0134 488B55F0 		movq	-16(%rbp), %rdx
 3882 0138 4889C7   		movq	%rax, %rdi
 3883 013b FFD1     		call	*%rcx
 3884              	.LVL9:
 3885 013d 8945EC   		movl	%eax, -20(%rbp)
 3886              	.L227:
2717:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
2718:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
2719:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2720:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "in_left: %d, nb_want: %d",
2721:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         ssl->in_left, nb_want ) );
2722:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 2, "ssl->f_recv(_timeout)", ret );
2723:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2724:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ret == 0 )
 3887              		.loc 4 2724 15
 3888 0140 837DEC00 		cmpl	$0, -20(%rbp)
 3889 0144 7507     		jne	.L229
2725:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_CONN_EOF );
 3890              		.loc 4 2725 23
 3891 0146 B8808DFF 		movl	$-29312, %eax
 3891      FF
 3892 014b EB55     		jmp	.L223
 3893              	.L229:
2726:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2727:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ret < 0 )
 3894              		.loc 4 2727 15
 3895 014d 837DEC00 		cmpl	$0, -20(%rbp)
 3896 0151 7905     		jns	.L230
2728:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( ret );
 3897              		.loc 4 2728 23
 3898 0153 8B45EC   		movl	-20(%rbp), %eax
 3899 0156 EB4A     		jmp	.L223
 3900              	.L230:
2729:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2730:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if ( (size_t)ret > len || ( INT_MAX > SIZE_MAX && ret > SIZE_MAX ) )
 3901              		.loc 4 2730 18
 3902 0158 8B45EC   		movl	-20(%rbp), %eax
 3903 015b 4898     		cltq
 3904              		.loc 4 2730 16
 3905 015d 483945F0 		cmpq	%rax, -16(%rbp)
 3906 0161 7307     		jnb	.L231
2731:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
2732:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1,
2733:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ( "f_recv returned %d bytes but only %lu were requested",
2734:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ret, (unsigned long)len ) );
2735:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 3907              		.loc 4 2735 23
 3908 0163 B80094FF 		movl	$-27648, %eax
 3908      FF
 3909 0168 EB38     		jmp	.L223
 3910              	.L231:
2736:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
2737:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2738:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_left += ret;
 3911              		.loc 4 2738 26
 3912 016a 488B45D8 		movq	-40(%rbp), %rax
 3913 016e 488B90E8 		movq	232(%rax), %rdx
GAS LISTING /tmp/ccEn8xFO.s 			page 164


 3913      000000
 3914 0175 8B45EC   		movl	-20(%rbp), %eax
 3915 0178 4898     		cltq
 3916 017a 4801C2   		addq	%rax, %rdx
 3917 017d 488B45D8 		movq	-40(%rbp), %rax
 3918 0181 488990E8 		movq	%rdx, 232(%rax)
 3918      000000
 3919              	.L225:
2699:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
 3920              		.loc 4 2699 19
 3921 0188 488B45D8 		movq	-40(%rbp), %rax
 3922 018c 488B80E8 		movq	232(%rax), %rax
 3922      000000
2699:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
 3923              		.loc 4 2699 14
 3924 0193 483945D0 		cmpq	%rax, -48(%rbp)
 3925 0197 0F87E5FE 		ja	.L232
 3925      FFFF
2739:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2740:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2741:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2742:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= fetch input" ) );
2743:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2744:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 3926              		.loc 4 2744 11
 3927 019d B8000000 		movl	$0, %eax
 3927      00
 3928              	.L223:
2745:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 3929              		.loc 4 2745 1
 3930 01a2 488B7DF8 		movq	-8(%rbp), %rdi
 3931 01a6 6448333C 		xorq	%fs:40, %rdi
 3931      25280000 
 3931      00
 3932 01af 7405     		je	.L233
 3933 01b1 E8000000 		call	__stack_chk_fail@PLT
 3933      00
 3934              	.L233:
 3935 01b6 C9       		leave
 3936              	.LCFI62:
 3937              		.cfi_def_cfa 7, 8
 3938 01b7 C3       		ret
 3939              		.cfi_endproc
 3940              	.LFE39:
 3942              		.section	.text.mbedtls_ssl_flush_output,"ax",@progbits
 3943              		.globl	mbedtls_ssl_flush_output
 3945              	mbedtls_ssl_flush_output:
 3946              	.LFB40:
2746:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2747:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
2748:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Flush any data not yet written
2749:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
2750:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_flush_output( mbedtls_ssl_context *ssl )
2751:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 3947              		.loc 4 2751 1
 3948              		.cfi_startproc
 3949 0000 F30F1EFA 		endbr64
GAS LISTING /tmp/ccEn8xFO.s 			page 165


 3950 0004 55       		pushq	%rbp
 3951              	.LCFI63:
 3952              		.cfi_def_cfa_offset 16
 3953              		.cfi_offset 6, -16
 3954 0005 4889E5   		movq	%rsp, %rbp
 3955              	.LCFI64:
 3956              		.cfi_def_cfa_register 6
 3957 0008 4883EC30 		subq	$48, %rsp
 3958 000c 48897DD8 		movq	%rdi, -40(%rbp)
 3959              		.loc 4 2751 1
 3960 0010 64488B04 		movq	%fs:40, %rax
 3960      25280000 
 3960      00
 3961 0019 488945F8 		movq	%rax, -8(%rbp)
 3962 001d 31C0     		xorl	%eax, %eax
2752:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
2753:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char *buf;
2754:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2755:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> flush output" ) );
2756:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2757:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->f_send == NULL )
 3963              		.loc 4 2757 12
 3964 001f 488B45D8 		movq	-40(%rbp), %rax
 3965 0023 488B4020 		movq	32(%rax), %rax
 3966              		.loc 4 2757 7
 3967 0027 4885C0   		testq	%rax, %rax
 3968 002a 750A     		jne	.L235
2758:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2759:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "Bad usage of mbedtls_ssl_set_bio() "
2760:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             "or mbedtls_ssl_set_bio()" ) );
2761:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 3969              		.loc 4 2761 15
 3970 002c B8008FFF 		movl	$-28928, %eax
 3970      FF
 3971 0031 E9FC0000 		jmp	.L236
 3971      00
 3972              	.L235:
2762:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2763:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2764:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Avoid incrementing counter if data is flushed */
2765:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->out_left == 0 )
 3973              		.loc 4 2765 12
 3974 0036 488B45D8 		movq	-40(%rbp), %rax
 3975 003a 488B8040 		movq	320(%rax), %rax
 3975      010000
 3976              		.loc 4 2765 7
 3977 0041 4885C0   		testq	%rax, %rax
 3978 0044 0F859E00 		jne	.L238
 3978      0000
2766:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2767:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= flush output" ) );
2768:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
 3979              		.loc 4 2768 15
 3980 004a B8000000 		movl	$0, %eax
 3980      00
 3981 004f E9DE0000 		jmp	.L236
 3981      00
GAS LISTING /tmp/ccEn8xFO.s 			page 166


 3982              	.L241:
2769:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2770:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2771:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     while( ssl->out_left > 0 )
2772:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2773:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "message length: %d, out_left: %d",
2774:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                        mbedtls_ssl_hdr_len( ssl ) + ssl->out_msglen, ssl->out_left ) );
2775:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2776:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         buf = ssl->out_hdr - ssl->out_left;
 3983              		.loc 4 2776 18
 3984 0054 488B45D8 		movq	-40(%rbp), %rax
 3985 0058 488B9010 		movq	272(%rax), %rdx
 3985      010000
 3986              		.loc 4 2776 33
 3987 005f 488B45D8 		movq	-40(%rbp), %rax
 3988 0063 488B8040 		movq	320(%rax), %rax
 3988      010000
 3989              		.loc 4 2776 28
 3990 006a 48F7D8   		negq	%rax
 3991              		.loc 4 2776 13
 3992 006d 4801D0   		addq	%rdx, %rax
 3993 0070 488945F0 		movq	%rax, -16(%rbp)
2777:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ret = ssl->f_send( ssl->p_bio, buf, ssl->out_left );
 3994              		.loc 4 2777 18
 3995 0074 488B45D8 		movq	-40(%rbp), %rax
 3996 0078 4C8B4020 		movq	32(%rax), %r8
 3997              		.loc 4 2777 15
 3998 007c 488B45D8 		movq	-40(%rbp), %rax
 3999 0080 488B9040 		movq	320(%rax), %rdx
 3999      010000
 4000 0087 488B45D8 		movq	-40(%rbp), %rax
 4001 008b 488B4038 		movq	56(%rax), %rax
 4002 008f 488B4DF0 		movq	-16(%rbp), %rcx
 4003 0093 4889CE   		movq	%rcx, %rsi
 4004 0096 4889C7   		movq	%rax, %rdi
 4005 0099 41FFD0   		call	*%r8
 4006              	.LVL10:
 4007 009c 8945EC   		movl	%eax, -20(%rbp)
2778:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2779:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 2, "ssl->f_send", ret );
2780:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2781:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ret <= 0 )
 4008              		.loc 4 2781 11
 4009 009f 837DEC00 		cmpl	$0, -20(%rbp)
 4010 00a3 7F08     		jg	.L239
2782:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 4011              		.loc 4 2782 19
 4012 00a5 8B45EC   		movl	-20(%rbp), %eax
 4013 00a8 E9850000 		jmp	.L236
 4013      00
 4014              	.L239:
2783:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2784:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( (size_t)ret > ssl->out_left || ( INT_MAX > SIZE_MAX && ret > SIZE_MAX ) )
 4015              		.loc 4 2784 13
 4016 00ad 8B45EC   		movl	-20(%rbp), %eax
 4017 00b0 4863D0   		movslq	%eax, %rdx
 4018              		.loc 4 2784 30
GAS LISTING /tmp/ccEn8xFO.s 			page 167


 4019 00b3 488B45D8 		movq	-40(%rbp), %rax
 4020 00b7 488B8040 		movq	320(%rax), %rax
 4020      010000
 4021              		.loc 4 2784 11
 4022 00be 4839C2   		cmpq	%rax, %rdx
 4023 00c1 7607     		jbe	.L240
2785:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2786:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1,
2787:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ( "f_send returned %d bytes but only %lu bytes were sent",
2788:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ret, (unsigned long)ssl->out_left ) );
2789:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 4024              		.loc 4 2789 19
 4025 00c3 B80094FF 		movl	$-27648, %eax
 4025      FF
 4026 00c8 EB68     		jmp	.L236
 4027              	.L240:
2790:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2791:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2792:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_left -= ret;
 4028              		.loc 4 2792 23
 4029 00ca 488B45D8 		movq	-40(%rbp), %rax
 4030 00ce 488B9040 		movq	320(%rax), %rdx
 4030      010000
 4031 00d5 8B45EC   		movl	-20(%rbp), %eax
 4032 00d8 4898     		cltq
 4033 00da 4829C2   		subq	%rax, %rdx
 4034 00dd 488B45D8 		movq	-40(%rbp), %rax
 4035 00e1 48899040 		movq	%rdx, 320(%rax)
 4035      010000
 4036              	.L238:
2771:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 4037              		.loc 4 2771 15
 4038 00e8 488B45D8 		movq	-40(%rbp), %rax
 4039 00ec 488B8040 		movq	320(%rax), %rax
 4039      010000
2771:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 4040              		.loc 4 2771 10
 4041 00f3 4885C0   		testq	%rax, %rax
 4042 00f6 0F8558FF 		jne	.L241
 4042      FFFF
2793:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2794:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2795:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
2796:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
2797:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2798:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_hdr = ssl->out_buf;
2799:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2800:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
2801:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
2802:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2803:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_hdr = ssl->out_buf + 8;
 4043              		.loc 4 2803 27
 4044 00fc 488B45D8 		movq	-40(%rbp), %rax
 4045 0100 488B8000 		movq	256(%rax), %rax
 4045      010000
 4046              		.loc 4 2803 37
 4047 0107 488D5008 		leaq	8(%rax), %rdx
GAS LISTING /tmp/ccEn8xFO.s 			page 168


 4048              		.loc 4 2803 22
 4049 010b 488B45D8 		movq	-40(%rbp), %rax
 4050 010f 48899010 		movq	%rdx, 272(%rax)
 4050      010000
2804:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2805:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_update_out_pointers( ssl, ssl->transform_out );
 4051              		.loc 4 2805 5
 4052 0116 488B45D8 		movq	-40(%rbp), %rax
 4053 011a 488B5070 		movq	112(%rax), %rdx
 4054 011e 488B45D8 		movq	-40(%rbp), %rax
 4055 0122 4889D6   		movq	%rdx, %rsi
 4056 0125 4889C7   		movq	%rax, %rdi
 4057 0128 E8000000 		call	ssl_update_out_pointers
 4057      00
2806:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2807:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= flush output" ) );
2808:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2809:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 4058              		.loc 4 2809 11
 4059 012d B8000000 		movl	$0, %eax
 4059      00
 4060              	.L236:
2810:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 4061              		.loc 4 2810 1
 4062 0132 488B4DF8 		movq	-8(%rbp), %rcx
 4063 0136 6448330C 		xorq	%fs:40, %rcx
 4063      25280000 
 4063      00
 4064 013f 7405     		je	.L242
 4065 0141 E8000000 		call	__stack_chk_fail@PLT
 4065      00
 4066              	.L242:
 4067 0146 C9       		leave
 4068              	.LCFI65:
 4069              		.cfi_def_cfa 7, 8
 4070 0147 C3       		ret
 4071              		.cfi_endproc
 4072              	.LFE40:
 4074              		.section	.text.mbedtls_ssl_write_handshake_msg,"ax",@progbits
 4075              		.globl	mbedtls_ssl_write_handshake_msg
 4077              	mbedtls_ssl_write_handshake_msg:
 4078              	.LFB41:
2811:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2812:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
2813:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Functions to handle the DTLS retransmission state machine
2814:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
2815:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
2816:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
2817:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Append current handshake message to current outgoing flight
2818:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
2819:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_flight_append( mbedtls_ssl_context *ssl )
2820:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
2821:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_flight_item *msg;
2822:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> ssl_flight_append" ) );
2823:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "message appended to flight",
2824:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            ssl->out_msg, ssl->out_msglen );
2825:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 169


2826:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Allocate space for current message */
2827:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( msg = mbedtls_calloc( 1, sizeof(  mbedtls_ssl_flight_item ) ) ) == NULL )
2828:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2829:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "alloc %d bytes failed",
2830:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             sizeof( mbedtls_ssl_flight_item ) ) );
2831:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
2832:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2833:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2834:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( msg->p = mbedtls_calloc( 1, ssl->out_msglen ) ) == NULL )
2835:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2836:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "alloc %d bytes failed", ssl->out_msglen ) );
2837:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( msg );
2838:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
2839:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2840:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2841:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Copy current handshake message with headers */
2842:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( msg->p, ssl->out_msg, ssl->out_msglen );
2843:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     msg->len = ssl->out_msglen;
2844:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     msg->type = ssl->out_msgtype;
2845:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     msg->next = NULL;
2846:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2847:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Append to the current flight */
2848:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->handshake->flight == NULL )
2849:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake->flight = msg;
2850:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
2851:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2852:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_flight_item *cur = ssl->handshake->flight;
2853:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         while( cur->next != NULL )
2854:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             cur = cur->next;
2855:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         cur->next = msg;
2856:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2857:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2858:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= ssl_flight_append" ) );
2859:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
2860:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
2861:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2862:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
2863:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Free the current flight of handshake messages
2864:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
2865:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_flight_free( mbedtls_ssl_flight_item *flight )
2866:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
2867:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_flight_item *cur = flight;
2868:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_flight_item *next;
2869:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2870:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     while( cur != NULL )
2871:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2872:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         next = cur->next;
2873:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2874:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( cur->p );
2875:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( cur );
2876:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2877:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         cur = next;
2878:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2879:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
2880:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2881:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_ANTI_REPLAY)
2882:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_dtls_replay_reset( mbedtls_ssl_context *ssl );
GAS LISTING /tmp/ccEn8xFO.s 			page 170


2883:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
2884:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2885:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
2886:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Swap transform_out and out_ctr with the alternative ones
2887:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
2888:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_swap_epochs( mbedtls_ssl_context *ssl )
2889:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
2890:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_transform *tmp_transform;
2891:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char tmp_out_ctr[8];
2892:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2893:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->transform_out == ssl->handshake->alt_transform_out )
2894:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2895:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "skip swap epochs" ) );
2896:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return;
2897:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2898:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2899:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "swap epochs" ) );
2900:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2901:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Swap transforms */
2902:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     tmp_transform                     = ssl->transform_out;
2903:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->transform_out                = ssl->handshake->alt_transform_out;
2904:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->handshake->alt_transform_out = tmp_transform;
2905:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2906:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Swap epoch + sequence_number */
2907:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( tmp_out_ctr,                 ssl->cur_out_ctr,            8 );
2908:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( ssl->cur_out_ctr,            ssl->handshake->alt_out_ctr, 8 );
2909:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( ssl->handshake->alt_out_ctr, tmp_out_ctr,                 8 );
2910:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2911:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Adjust to the newly activated transform */
2912:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_update_out_pointers( ssl, ssl->transform_out );
2913:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2914:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_HW_RECORD_ACCEL)
2915:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( mbedtls_ssl_hw_record_activate != NULL )
2916:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2917:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_ssl_hw_record_activate( ssl, MBEDTLS_SSL_CHANNEL_OUTBOUND ) ) != 0 )
2918:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2919:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_hw_record_activate", ret );
2920:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_HW_ACCEL_FAILED );
2921:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2922:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2923:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
2924:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
2925:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2926:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
2927:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Retransmit the current flight of messages.
2928:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
2929:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_resend( mbedtls_ssl_context *ssl )
2930:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
2931:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret = 0;
2932:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2933:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> mbedtls_ssl_resend" ) );
2934:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2935:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ret = mbedtls_ssl_flight_transmit( ssl );
2936:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2937:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= mbedtls_ssl_resend" ) );
2938:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2939:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ret );
GAS LISTING /tmp/ccEn8xFO.s 			page 171


2940:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
2941:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2942:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
2943:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Transmit or retransmit the current flight of messages.
2944:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
2945:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Need to remember the current message in case flush_output returns
2946:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * WANT_WRITE, causing us to exit this function and come back later.
2947:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * This function must be called until state is no longer SENDING.
2948:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
2949:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_flight_transmit( mbedtls_ssl_context *ssl )
2950:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
2951:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
2952:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> mbedtls_ssl_flight_transmit" ) );
2953:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2954:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->handshake->retransmit_state != MBEDTLS_SSL_RETRANS_SENDING )
2955:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2956:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "initialise flight transmission" ) );
2957:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2958:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake->cur_msg = ssl->handshake->flight;
2959:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake->cur_msg_p = ssl->handshake->flight->p + 12;
2960:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl_swap_epochs( ssl );
2961:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2962:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake->retransmit_state = MBEDTLS_SSL_RETRANS_SENDING;
2963:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
2964:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2965:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     while( ssl->handshake->cur_msg != NULL )
2966:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
2967:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         size_t max_frag_len;
2968:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         const mbedtls_ssl_flight_item * const cur = ssl->handshake->cur_msg;
2969:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2970:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         int const is_finished =
2971:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ( cur->type == MBEDTLS_SSL_MSG_HANDSHAKE &&
2972:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****               cur->p[0] == MBEDTLS_SSL_HS_FINISHED );
2973:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2974:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         uint8_t const force_flush = ssl->disable_datagram_packing == 1 ?
2975:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             SSL_FORCE_FLUSH : SSL_DONT_FORCE_FLUSH;
2976:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2977:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Swap epochs before sending Finished: we can't do it after
2978:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * sending ChangeCipherSpec, in case write returns WANT_READ.
2979:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Must be done before copying, may change out_msg pointer */
2980:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( is_finished && ssl->handshake->cur_msg_p == ( cur->p + 12 ) )
2981:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2982:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "swap epochs to send finished message" ) );
2983:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl_swap_epochs( ssl );
2984:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
2985:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2986:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ret = ssl_get_remaining_payload_in_datagram( ssl );
2987:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ret < 0 )
2988:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
2989:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         max_frag_len = (size_t) ret;
2990:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2991:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* CCS is copied as is, while HS messages may need fragmentation */
2992:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( cur->type == MBEDTLS_SSL_MSG_CHANGE_CIPHER_SPEC )
2993:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
2994:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( max_frag_len == 0 )
2995:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
2996:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( ( ret = mbedtls_ssl_flush_output( ssl ) ) != 0 )
GAS LISTING /tmp/ccEn8xFO.s 			page 172


2997:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     return( ret );
2998:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
2999:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 continue;
3000:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
3001:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3002:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcpy( ssl->out_msg, cur->p, cur->len );
3003:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->out_msglen  = cur->len;
3004:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->out_msgtype = cur->type;
3005:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3006:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Update position inside current message */
3007:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->handshake->cur_msg_p += cur->len;
3008:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
3009:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else
3010:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
3011:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             const unsigned char * const p = ssl->handshake->cur_msg_p;
3012:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             const size_t hs_len = cur->len - 12;
3013:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             const size_t frag_off = p - ( cur->p + 12 );
3014:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             const size_t rem_len = hs_len - frag_off;
3015:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             size_t cur_hs_frag_len, max_hs_frag_len;
3016:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3017:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ( max_frag_len < 12 ) || ( max_frag_len == 12 && hs_len != 0 ) )
3018:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
3019:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( is_finished )
3020:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ssl_swap_epochs( ssl );
3021:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3022:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( ( ret = mbedtls_ssl_flush_output( ssl ) ) != 0 )
3023:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     return( ret );
3024:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3025:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 continue;
3026:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
3027:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             max_hs_frag_len = max_frag_len - 12;
3028:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3029:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             cur_hs_frag_len = rem_len > max_hs_frag_len ?
3030:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 max_hs_frag_len : rem_len;
3031:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3032:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( frag_off == 0 && cur_hs_frag_len != hs_len )
3033:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
3034:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 2, ( "fragmenting handshake message (%u > %u)",
3035:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                             (unsigned) cur_hs_frag_len,
3036:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                             (unsigned) max_hs_frag_len ) );
3037:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
3038:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3039:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Messages are stored with handshake headers as if not fragmented,
3040:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * copy beginning of headers then fill fragmentation fields.
3041:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * Handshake headers: type(1) len(3) seq(2) f_off(3) f_len(3) */
3042:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcpy( ssl->out_msg, cur->p, 6 );
3043:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3044:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->out_msg[6] = ( ( frag_off >> 16 ) & 0xff );
3045:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->out_msg[7] = ( ( frag_off >>  8 ) & 0xff );
3046:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->out_msg[8] = ( ( frag_off       ) & 0xff );
3047:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3048:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->out_msg[ 9] = ( ( cur_hs_frag_len >> 16 ) & 0xff );
3049:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->out_msg[10] = ( ( cur_hs_frag_len >>  8 ) & 0xff );
3050:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->out_msg[11] = ( ( cur_hs_frag_len       ) & 0xff );
3051:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3052:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_BUF( 3, "handshake header", ssl->out_msg, 12 );
3053:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 173


3054:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Copy the handshake message content and set records fields */
3055:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcpy( ssl->out_msg + 12, p, cur_hs_frag_len );
3056:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->out_msglen = cur_hs_frag_len + 12;
3057:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->out_msgtype = cur->type;
3058:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3059:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Update position inside current message */
3060:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->handshake->cur_msg_p += cur_hs_frag_len;
3061:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
3062:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3063:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* If done with the current message move to the next one if any */
3064:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->handshake->cur_msg_p >= cur->p + cur->len )
3065:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
3066:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( cur->next != NULL )
3067:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
3068:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->handshake->cur_msg = cur->next;
3069:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->handshake->cur_msg_p = cur->next->p + 12;
3070:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
3071:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else
3072:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
3073:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->handshake->cur_msg = NULL;
3074:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->handshake->cur_msg_p = NULL;
3075:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
3076:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
3077:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3078:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Actually send the message out */
3079:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_ssl_write_record( ssl, force_flush ) ) != 0 )
3080:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
3081:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_write_record", ret );
3082:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
3083:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
3084:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3085:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3086:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_ssl_flush_output( ssl ) ) != 0 )
3087:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
3088:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3089:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Update state and set timer */
3090:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->state == MBEDTLS_SSL_HANDSHAKE_OVER )
3091:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake->retransmit_state = MBEDTLS_SSL_RETRANS_FINISHED;
3092:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
3093:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3094:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake->retransmit_state = MBEDTLS_SSL_RETRANS_WAITING;
3095:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl_set_timer( ssl, ssl->handshake->retransmit_timeout );
3096:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3097:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3098:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= mbedtls_ssl_flight_transmit" ) );
3099:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3100:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
3101:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
3102:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3103:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
3104:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * To be called when the last message of an incoming flight is received.
3105:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
3106:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_recv_flight_completed( mbedtls_ssl_context *ssl )
3107:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
3108:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* We won't need to resend that one any more */
3109:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_flight_free( ssl->handshake->flight );
3110:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->handshake->flight = NULL;
GAS LISTING /tmp/ccEn8xFO.s 			page 174


3111:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->handshake->cur_msg = NULL;
3112:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3113:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* The next incoming flight will start with this msg_seq */
3114:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->handshake->in_flight_start_seq = ssl->handshake->in_msg_seq;
3115:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3116:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* We don't want to remember CCS's across flight boundaries. */
3117:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->handshake->buffering.seen_ccs = 0;
3118:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3119:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Clear future message buffering structure. */
3120:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_buffering_free( ssl );
3121:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3122:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Cancel timer */
3123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_set_timer( ssl, 0 );
3124:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3125:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_msgtype == MBEDTLS_SSL_MSG_HANDSHAKE &&
3126:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_msg[0] == MBEDTLS_SSL_HS_FINISHED )
3127:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3128:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake->retransmit_state = MBEDTLS_SSL_RETRANS_FINISHED;
3129:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3130:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
3131:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake->retransmit_state = MBEDTLS_SSL_RETRANS_PREPARING;
3132:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
3133:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3134:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
3135:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * To be called when the last message of an outgoing flight is send.
3136:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
3137:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_send_flight_completed( mbedtls_ssl_context *ssl )
3138:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
3139:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_reset_retransmit_timeout( ssl );
3140:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_set_timer( ssl, ssl->handshake->retransmit_timeout );
3141:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3142:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_msgtype == MBEDTLS_SSL_MSG_HANDSHAKE &&
3143:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_msg[0] == MBEDTLS_SSL_HS_FINISHED )
3144:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3145:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake->retransmit_state = MBEDTLS_SSL_RETRANS_FINISHED;
3146:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3147:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
3148:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake->retransmit_state = MBEDTLS_SSL_RETRANS_WAITING;
3149:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
3150:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
3151:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3152:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
3153:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Handshake layer functions
3154:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
3155:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3156:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
3157:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Write (DTLS: or queue) current handshake (including CCS) message.
3158:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
3159:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  - fill in handshake headers
3160:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  - update handshake checksum
3161:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  - DTLS: save message for resending
3162:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  - then pass to the record layer
3163:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
3164:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * DTLS: except for HelloRequest, messages are only queued, and will only be
3165:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * actually sent when calling flight_transmit() or resend().
3166:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
3167:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Inputs:
GAS LISTING /tmp/ccEn8xFO.s 			page 175


3168:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  - ssl->out_msglen: 4 + actual handshake message len
3169:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *      (4 is the size of handshake headers for TLS)
3170:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  - ssl->out_msg[0]: the handshake type (ClientHello, ServerHello, etc)
3171:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  - ssl->out_msg + 4: the handshake message body
3172:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
3173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Outputs, ie state before passing to flight_append() or write_record():
3174:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *   - ssl->out_msglen: the length of the record contents
3175:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *      (including handshake headers but excluding record headers)
3176:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *   - ssl->out_msg: the record contents (handshake headers + content)
3177:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
3178:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_write_handshake_msg( mbedtls_ssl_context *ssl )
3179:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 4079              		.loc 4 3179 1
 4080              		.cfi_startproc
 4081 0000 F30F1EFA 		endbr64
 4082 0004 55       		pushq	%rbp
 4083              	.LCFI66:
 4084              		.cfi_def_cfa_offset 16
 4085              		.cfi_offset 6, -16
 4086 0005 4889E5   		movq	%rsp, %rbp
 4087              	.LCFI67:
 4088              		.cfi_def_cfa_register 6
 4089 0008 4883EC30 		subq	$48, %rsp
 4090 000c 48897DD8 		movq	%rdi, -40(%rbp)
 4091              		.loc 4 3179 1
 4092 0010 64488B04 		movq	%fs:40, %rax
 4092      25280000 
 4092      00
 4093 0019 488945F8 		movq	%rax, -8(%rbp)
 4094 001d 31C0     		xorl	%eax, %eax
3180:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
3181:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const size_t hs_len = ssl->out_msglen - 4;
 4095              		.loc 4 3181 30
 4096 001f 488B45D8 		movq	-40(%rbp), %rax
 4097 0023 488B8038 		movq	312(%rax), %rax
 4097      010000
 4098              		.loc 4 3181 18
 4099 002a 4883E804 		subq	$4, %rax
 4100 002e 488945F0 		movq	%rax, -16(%rbp)
3182:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const unsigned char hs_type = ssl->out_msg[0];
 4101              		.loc 4 3182 38
 4102 0032 488B45D8 		movq	-40(%rbp), %rax
 4103 0036 488B8028 		movq	296(%rax), %rax
 4103      010000
 4104              		.loc 4 3182 25
 4105 003d 0FB600   		movzbl	(%rax), %eax
 4106 0040 8845EB   		movb	%al, -21(%rbp)
3183:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3184:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> write handshake message" ) );
3185:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3186:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
3187:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Sanity checks
3188:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
3189:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->out_msgtype != MBEDTLS_SSL_MSG_HANDSHAKE          &&
 4107              		.loc 4 3189 12
 4108 0043 488B45D8 		movq	-40(%rbp), %rax
 4109 0047 8B803001 		movl	304(%rax), %eax
GAS LISTING /tmp/ccEn8xFO.s 			page 176


 4109      0000
 4110              		.loc 4 3189 7
 4111 004d 83F816   		cmpl	$22, %eax
 4112 0050 7419     		je	.L244
3190:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_msgtype != MBEDTLS_SSL_MSG_CHANGE_CIPHER_SPEC )
 4113              		.loc 4 3190 12 discriminator 1
 4114 0052 488B45D8 		movq	-40(%rbp), %rax
 4115 0056 8B803001 		movl	304(%rax), %eax
 4115      0000
3189:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_msgtype != MBEDTLS_SSL_MSG_CHANGE_CIPHER_SPEC )
 4116              		.loc 4 3189 64 discriminator 1
 4117 005c 83F814   		cmpl	$20, %eax
 4118 005f 740A     		je	.L244
3191:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3192:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* In SSLv3, the client might send a NoCertificate alert. */
3193:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) && defined(MBEDTLS_SSL_CLI_C)
3194:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ! ( ssl->minor_ver      == MBEDTLS_SSL_MINOR_VERSION_0 &&
3195:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->out_msgtype    == MBEDTLS_SSL_MSG_ALERT       &&
3196:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->conf->endpoint == MBEDTLS_SSL_IS_CLIENT ) )
3197:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 && MBEDTLS_SSL_SRV_C */
3198:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
3199:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
3200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 4119              		.loc 4 3200 19
 4120 0061 B80094FF 		movl	$-27648, %eax
 4120      FF
 4121 0066 E9050100 		jmp	.L245
 4121      00
 4122              	.L244:
3201:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
3202:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3203:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3204:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Whenever we send anything different from a
3205:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * HelloRequest we should be in a handshake - double check. */
3206:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ! ( ssl->out_msgtype == MBEDTLS_SSL_MSG_HANDSHAKE &&
 4123              		.loc 4 3206 16
 4124 006b 488B45D8 		movq	-40(%rbp), %rax
 4125 006f 8B803001 		movl	304(%rax), %eax
 4125      0000
 4126              		.loc 4 3206 7
 4127 0075 83F816   		cmpl	$22, %eax
 4128 0078 7506     		jne	.L246
 4129              		.loc 4 3206 9 discriminator 1
 4130 007a 807DEB00 		cmpb	$0, -21(%rbp)
 4131 007e 7417     		je	.L247
 4132              	.L246:
3207:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             hs_type          == MBEDTLS_SSL_HS_HELLO_REQUEST ) &&
3208:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake == NULL )
 4133              		.loc 4 3208 12
 4134 0080 488B45D8 		movq	-40(%rbp), %rax
 4135 0084 488B4060 		movq	96(%rax), %rax
3207:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             hs_type          == MBEDTLS_SSL_HS_HELLO_REQUEST ) &&
 4136              		.loc 4 3207 64
 4137 0088 4885C0   		testq	%rax, %rax
 4138 008b 750A     		jne	.L247
3209:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3210:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
GAS LISTING /tmp/ccEn8xFO.s 			page 177


3211:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 4139              		.loc 4 3211 15
 4140 008d B80094FF 		movl	$-27648, %eax
 4140      FF
 4141 0092 E9D90000 		jmp	.L245
 4141      00
 4142              	.L247:
3212:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3213:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3214:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
3215:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
3216:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake != NULL &&
3217:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake->retransmit_state == MBEDTLS_SSL_RETRANS_SENDING )
3218:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3219:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
3220:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
3221:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3222:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
3223:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3224:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Double-check that we did not exceed the bounds
3225:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * of the outgoing record buffer.
3226:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * This should never fail as the various message
3227:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * writing functions must obey the bounds of the
3228:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * outgoing record buffer, but better be safe.
3229:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *
3230:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Note: We deliberately do not check for the MTU or MFL here.
3231:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
3232:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->out_msglen > MBEDTLS_SSL_OUT_CONTENT_LEN )
 4143              		.loc 4 3232 12
 4144 0097 488B45D8 		movq	-40(%rbp), %rax
 4145 009b 488B8038 		movq	312(%rax), %rax
 4145      010000
 4146              		.loc 4 3232 7
 4147 00a2 483D803E 		cmpq	$16000, %rax
 4147      0000
 4148 00a8 760A     		jbe	.L248
3233:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3234:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "Record too large: "
3235:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     "size %u, maximum %u",
3236:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     (unsigned) ssl->out_msglen,
3237:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     (unsigned) MBEDTLS_SSL_OUT_CONTENT_LEN ) );
3238:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 4149              		.loc 4 3238 15
 4150 00aa B80094FF 		movl	$-27648, %eax
 4150      FF
 4151 00af E9BC0000 		jmp	.L245
 4151      00
 4152              	.L248:
3239:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3240:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3241:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
3242:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Fill handshake headers
3243:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
3244:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->out_msgtype == MBEDTLS_SSL_MSG_HANDSHAKE )
 4153              		.loc 4 3244 12
 4154 00b4 488B45D8 		movq	-40(%rbp), %rax
 4155 00b8 8B803001 		movl	304(%rax), %eax
GAS LISTING /tmp/ccEn8xFO.s 			page 178


 4155      0000
 4156              		.loc 4 3244 7
 4157 00be 83F816   		cmpl	$22, %eax
 4158 00c1 0F858500 		jne	.L249
 4158      0000
3245:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3246:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_msg[1] = (unsigned char)( hs_len >> 16 );
 4159              		.loc 4 3246 51
 4160 00c7 488B45F0 		movq	-16(%rbp), %rax
 4161 00cb 48C1E810 		shrq	$16, %rax
 4162 00cf 4889C2   		movq	%rax, %rdx
 4163              		.loc 4 3246 12
 4164 00d2 488B45D8 		movq	-40(%rbp), %rax
 4165 00d6 488B8028 		movq	296(%rax), %rax
 4165      010000
 4166              		.loc 4 3246 21
 4167 00dd 4883C001 		addq	$1, %rax
 4168              		.loc 4 3246 25
 4169 00e1 8810     		movb	%dl, (%rax)
3247:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_msg[2] = (unsigned char)( hs_len >>  8 );
 4170              		.loc 4 3247 51
 4171 00e3 488B45F0 		movq	-16(%rbp), %rax
 4172 00e7 48C1E808 		shrq	$8, %rax
 4173 00eb 4889C2   		movq	%rax, %rdx
 4174              		.loc 4 3247 12
 4175 00ee 488B45D8 		movq	-40(%rbp), %rax
 4176 00f2 488B8028 		movq	296(%rax), %rax
 4176      010000
 4177              		.loc 4 3247 21
 4178 00f9 4883C002 		addq	$2, %rax
 4179              		.loc 4 3247 25
 4180 00fd 8810     		movb	%dl, (%rax)
3248:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_msg[3] = (unsigned char)( hs_len       );
 4181              		.loc 4 3248 12
 4182 00ff 488B45D8 		movq	-40(%rbp), %rax
 4183 0103 488B8028 		movq	296(%rax), %rax
 4183      010000
 4184              		.loc 4 3248 21
 4185 010a 4883C003 		addq	$3, %rax
 4186              		.loc 4 3248 27
 4187 010e 488B55F0 		movq	-16(%rbp), %rdx
 4188              		.loc 4 3248 25
 4189 0112 8810     		movb	%dl, (%rax)
3249:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3250:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
3251:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * DTLS has additional fields in the Handshake layer,
3252:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * between the length field and the actual payload:
3253:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          *      uint16 message_seq;
3254:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          *      uint24 fragment_offset;
3255:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          *      uint24 fragment_length;
3256:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
3257:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
3258:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
3259:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
3260:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Make room for the additional DTLS fields */
3261:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( MBEDTLS_SSL_OUT_CONTENT_LEN - ssl->out_msglen < 8 )
3262:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
GAS LISTING /tmp/ccEn8xFO.s 			page 179


3263:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "DTLS handshake message too large: "
3264:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                               "size %u, maximum %u",
3265:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                (unsigned) ( hs_len ),
3266:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                (unsigned) ( MBEDTLS_SSL_OUT_CONTENT_LEN - 12 ) ) );
3267:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
3268:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
3269:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3270:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memmove( ssl->out_msg + 12, ssl->out_msg + 4, hs_len );
3271:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->out_msglen += 8;
3272:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3273:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Write message_seq and update it, except for HelloRequest */
3274:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( hs_type != MBEDTLS_SSL_HS_HELLO_REQUEST )
3275:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
3276:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->out_msg[4] = ( ssl->handshake->out_msg_seq >> 8 ) & 0xFF;
3277:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->out_msg[5] = ( ssl->handshake->out_msg_seq      ) & 0xFF;
3278:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ++( ssl->handshake->out_msg_seq );
3279:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
3280:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else
3281:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
3282:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->out_msg[4] = 0;
3283:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->out_msg[5] = 0;
3284:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
3285:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3286:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Handshake hashes are computed without fragmentation,
3287:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * so set frag_offset = 0 and frag_len = hs_len for now */
3288:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memset( ssl->out_msg + 6, 0x00, 3 );
3289:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcpy( ssl->out_msg + 9, ssl->out_msg + 1, 3 );
3290:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
3291:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
3292:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3293:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Update running hashes of handshake messages seen */
3294:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( hs_type != MBEDTLS_SSL_HS_HELLO_REQUEST )
 4190              		.loc 4 3294 11
 4191 0114 807DEB00 		cmpb	$0, -21(%rbp)
 4192 0118 7432     		je	.L249
3295:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->handshake->update_checksum( ssl, ssl->out_msg, ssl->out_msglen );
 4193              		.loc 4 3295 16
 4194 011a 488B45D8 		movq	-40(%rbp), %rax
 4195 011e 488B4060 		movq	96(%rax), %rax
 4196              		.loc 4 3295 27
 4197 0122 4C8B80F0 		movq	752(%rax), %r8
 4197      020000
 4198              		.loc 4 3295 13
 4199 0129 488B45D8 		movq	-40(%rbp), %rax
 4200 012d 488B9038 		movq	312(%rax), %rdx
 4200      010000
 4201              		.loc 4 3295 54
 4202 0134 488B45D8 		movq	-40(%rbp), %rax
 4203 0138 488B8828 		movq	296(%rax), %rcx
 4203      010000
 4204              		.loc 4 3295 13
 4205 013f 488B45D8 		movq	-40(%rbp), %rax
 4206 0143 4889CE   		movq	%rcx, %rsi
 4207 0146 4889C7   		movq	%rax, %rdi
 4208 0149 41FFD0   		call	*%r8
 4209              	.LVL11:
 4210              	.L249:
GAS LISTING /tmp/ccEn8xFO.s 			page 180


3296:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3297:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3298:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Either send now, or just save to be sent (and resent) later */
3299:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
3300:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
3301:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ! ( ssl->out_msgtype == MBEDTLS_SSL_MSG_HANDSHAKE &&
3302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             hs_type          == MBEDTLS_SSL_HS_HELLO_REQUEST ) )
3303:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3304:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = ssl_flight_append( ssl ) ) != 0 )
3305:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
3306:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "ssl_flight_append", ret );
3307:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
3308:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
3309:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3310:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
3311:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
3312:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3313:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_ssl_write_record( ssl, SSL_FORCE_FLUSH ) ) != 0 )
 4211              		.loc 4 3313 21
 4212 014c 488B45D8 		movq	-40(%rbp), %rax
 4213 0150 BE010000 		movl	$1, %esi
 4213      00
 4214 0155 4889C7   		movq	%rax, %rdi
 4215 0158 E8000000 		call	mbedtls_ssl_write_record
 4215      00
 4216 015d 8945EC   		movl	%eax, -20(%rbp)
 4217              		.loc 4 3313 11
 4218 0160 837DEC00 		cmpl	$0, -20(%rbp)
 4219 0164 7405     		je	.L250
3314:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
3315:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "ssl_write_record", ret );
3316:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 4220              		.loc 4 3316 19
 4221 0166 8B45EC   		movl	-20(%rbp), %eax
 4222 0169 EB05     		jmp	.L245
 4223              	.L250:
3317:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
3318:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3319:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3320:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= write handshake message" ) );
3321:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3322:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 4224              		.loc 4 3322 11
 4225 016b B8000000 		movl	$0, %eax
 4225      00
 4226              	.L245:
3323:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 4227              		.loc 4 3323 1
 4228 0170 488B4DF8 		movq	-8(%rbp), %rcx
 4229 0174 6448330C 		xorq	%fs:40, %rcx
 4229      25280000 
 4229      00
 4230 017d 7405     		je	.L251
 4231 017f E8000000 		call	__stack_chk_fail@PLT
 4231      00
 4232              	.L251:
 4233 0184 C9       		leave
GAS LISTING /tmp/ccEn8xFO.s 			page 181


 4234              	.LCFI68:
 4235              		.cfi_def_cfa 7, 8
 4236 0185 C3       		ret
 4237              		.cfi_endproc
 4238              	.LFE41:
 4240              		.section	.text.mbedtls_ssl_write_record,"ax",@progbits
 4241              		.globl	mbedtls_ssl_write_record
 4243              	mbedtls_ssl_write_record:
 4244              	.LFB42:
3324:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3325:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
3326:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Record layer functions
3327:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
3328:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3329:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
3330:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Write current record.
3331:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
3332:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Uses:
3333:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  - ssl->out_msgtype: type of the message (AppData, Handshake, Alert, CCS)
3334:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  - ssl->out_msglen: length of the record content (excl headers)
3335:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *  - ssl->out_msg: record content
3336:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
3337:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_write_record( mbedtls_ssl_context *ssl, uint8_t force_flush )
3338:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 4245              		.loc 4 3338 1
 4246              		.cfi_startproc
 4247 0000 F30F1EFA 		endbr64
 4248 0004 55       		pushq	%rbp
 4249              	.LCFI69:
 4250              		.cfi_def_cfa_offset 16
 4251              		.cfi_offset 6, -16
 4252 0005 4889E5   		movq	%rsp, %rbp
 4253              	.LCFI70:
 4254              		.cfi_def_cfa_register 6
 4255 0008 53       		pushq	%rbx
 4256 0009 4883EC48 		subq	$72, %rsp
 4257              		.cfi_offset 3, -24
 4258 000d 48897DB8 		movq	%rdi, -72(%rbp)
 4259 0011 89F0     		movl	%esi, %eax
 4260 0013 8845B4   		movb	%al, -76(%rbp)
 4261              		.loc 4 3338 1
 4262 0016 64488B04 		movq	%fs:40, %rax
 4262      25280000 
 4262      00
 4263 001f 488945E8 		movq	%rax, -24(%rbp)
 4264 0023 31C0     		xorl	%eax, %eax
3339:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret, done = 0;
 4265              		.loc 4 3339 14
 4266 0025 C745D000 		movl	$0, -48(%rbp)
 4266      000000
3340:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t len = ssl->out_msglen;
 4267              		.loc 4 3340 12
 4268 002c 488B45B8 		movq	-72(%rbp), %rax
 4269 0030 488B8038 		movq	312(%rax), %rax
 4269      010000
 4270 0037 488945D8 		movq	%rax, -40(%rbp)
3341:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     uint8_t flush = force_flush;
GAS LISTING /tmp/ccEn8xFO.s 			page 182


 4271              		.loc 4 3341 13
 4272 003b 0FB645B4 		movzbl	-76(%rbp), %eax
 4273 003f 8845CB   		movb	%al, -53(%rbp)
3342:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3343:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> write record" ) );
3344:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3345:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_ZLIB_SUPPORT)
3346:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->transform_out != NULL &&
3347:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->session_out->compression == MBEDTLS_SSL_COMPRESS_DEFLATE )
3348:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3349:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = ssl_compress_buf( ssl ) ) != 0 )
3350:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
3351:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "ssl_compress_buf", ret );
3352:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
3353:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
3354:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3355:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         len = ssl->out_msglen;
3356:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3357:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /*MBEDTLS_ZLIB_SUPPORT */
3358:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3359:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_HW_RECORD_ACCEL)
3360:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( mbedtls_ssl_hw_record_write != NULL )
3361:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3362:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "going for mbedtls_ssl_hw_record_write()" ) );
3363:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3364:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ret = mbedtls_ssl_hw_record_write( ssl );
3365:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ret != 0 && ret != MBEDTLS_ERR_SSL_HW_ACCEL_FALLTHROUGH )
3366:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
3367:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_hw_record_write", ret );
3368:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_HW_ACCEL_FAILED );
3369:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
3370:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3371:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ret == 0 )
3372:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             done = 1;
3373:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3374:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_HW_RECORD_ACCEL */
3375:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( !done )
 4274              		.loc 4 3375 7
 4275 0042 837DD000 		cmpl	$0, -48(%rbp)
 4276 0046 0F85DD01 		jne	.L253
 4276      0000
 4277              	.LBB19:
3376:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3377:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         unsigned i;
3378:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         size_t protected_record_size;
3379:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3380:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_hdr[0] = (unsigned char) ssl->out_msgtype;
 4278              		.loc 4 3380 46
 4279 004c 488B45B8 		movq	-72(%rbp), %rax
 4280 0050 8B903001 		movl	304(%rax), %edx
 4280      0000
 4281              		.loc 4 3380 12
 4282 0056 488B45B8 		movq	-72(%rbp), %rax
 4283 005a 488B8010 		movq	272(%rax), %rax
 4283      010000
 4284              		.loc 4 3380 25
 4285 0061 8810     		movb	%dl, (%rax)
GAS LISTING /tmp/ccEn8xFO.s 			page 183


3381:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_write_version( ssl->major_ver, ssl->minor_ver,
3382:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            ssl->conf->transport, ssl->out_hdr + 1 );
 4286              		.loc 4 3382 53
 4287 0063 488B45B8 		movq	-72(%rbp), %rax
 4288 0067 488B8010 		movq	272(%rax), %rax
 4288      010000
3381:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_write_version( ssl->major_ver, ssl->minor_ver,
 4289              		.loc 4 3381 9
 4290 006e 488D4801 		leaq	1(%rax), %rcx
 4291              		.loc 4 3382 31
 4292 0072 488B45B8 		movq	-72(%rbp), %rax
 4293 0076 488B00   		movq	(%rax), %rax
 4294              		.loc 4 3382 37
 4295 0079 0FB680BC 		movzbl	188(%rax), %eax
 4295      000000
 4296 0080 D0E8     		shrb	%al
 4297 0082 83E001   		andl	$1, %eax
3381:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_write_version( ssl->major_ver, ssl->minor_ver,
 4298              		.loc 4 3381 9
 4299 0085 0FB6D0   		movzbl	%al, %edx
 4300 0088 488B45B8 		movq	-72(%rbp), %rax
 4301 008c 8B7018   		movl	24(%rax), %esi
 4302 008f 488B45B8 		movq	-72(%rbp), %rax
 4303 0093 8B4014   		movl	20(%rax), %eax
 4304 0096 89C7     		movl	%eax, %edi
 4305 0098 E8000000 		call	mbedtls_ssl_write_version
 4305      00
3383:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3384:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memcpy( ssl->out_ctr, ssl->cur_out_ctr, 8 );
 4306              		.loc 4 3384 34
 4307 009d 488B45B8 		movq	-72(%rbp), %rax
 4308 00a1 488D9048 		leaq	328(%rax), %rdx
 4308      010000
 4309              		.loc 4 3384 20
 4310 00a8 488B45B8 		movq	-72(%rbp), %rax
 4311 00ac 488B8008 		movq	264(%rax), %rax
 4311      010000
 4312 00b3 488B12   		movq	(%rdx), %rdx
 4313              		.loc 4 3384 9
 4314 00b6 488910   		movq	%rdx, (%rax)
3385:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_len[0] = (unsigned char)( len >> 8 );
 4315              		.loc 4 3385 48
 4316 00b9 488B45D8 		movq	-40(%rbp), %rax
 4317 00bd 48C1E808 		shrq	$8, %rax
 4318 00c1 4889C2   		movq	%rax, %rdx
 4319              		.loc 4 3385 12
 4320 00c4 488B45B8 		movq	-72(%rbp), %rax
 4321 00c8 488B8018 		movq	280(%rax), %rax
 4321      010000
 4322              		.loc 4 3385 25
 4323 00cf 8810     		movb	%dl, (%rax)
3386:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_len[1] = (unsigned char)( len      );
 4324              		.loc 4 3386 12
 4325 00d1 488B45B8 		movq	-72(%rbp), %rax
 4326 00d5 488B8018 		movq	280(%rax), %rax
 4326      010000
 4327              		.loc 4 3386 21
GAS LISTING /tmp/ccEn8xFO.s 			page 184


 4328 00dc 4883C001 		addq	$1, %rax
 4329              		.loc 4 3386 27
 4330 00e0 488B55D8 		movq	-40(%rbp), %rdx
 4331              		.loc 4 3386 25
 4332 00e4 8810     		movb	%dl, (%rax)
3387:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3388:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->transform_out != NULL )
 4333              		.loc 4 3388 16
 4334 00e6 488B45B8 		movq	-72(%rbp), %rax
 4335 00ea 488B4070 		movq	112(%rax), %rax
 4336              		.loc 4 3388 11
 4337 00ee 4885C0   		testq	%rax, %rax
 4338 00f1 7459     		je	.L254
3389:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
3390:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ( ret = ssl_encrypt_buf( ssl ) ) != 0 )
 4339              		.loc 4 3390 25
 4340 00f3 488B45B8 		movq	-72(%rbp), %rax
 4341 00f7 4889C7   		movq	%rax, %rdi
 4342 00fa E8000000 		call	ssl_encrypt_buf
 4342      00
 4343 00ff 8945D4   		movl	%eax, -44(%rbp)
 4344              		.loc 4 3390 15
 4345 0102 837DD400 		cmpl	$0, -44(%rbp)
 4346 0106 7408     		je	.L255
3391:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
3392:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_RET( 1, "ssl_encrypt_buf", ret );
3393:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( ret );
 4347              		.loc 4 3393 23
 4348 0108 8B45D4   		movl	-44(%rbp), %eax
 4349 010b E93E0100 		jmp	.L256
 4349      00
 4350              	.L255:
3394:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
3395:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3396:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             len = ssl->out_msglen;
 4351              		.loc 4 3396 17
 4352 0110 488B45B8 		movq	-72(%rbp), %rax
 4353 0114 488B8038 		movq	312(%rax), %rax
 4353      010000
 4354 011b 488945D8 		movq	%rax, -40(%rbp)
3397:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->out_len[0] = (unsigned char)( len >> 8 );
 4355              		.loc 4 3397 52
 4356 011f 488B45D8 		movq	-40(%rbp), %rax
 4357 0123 48C1E808 		shrq	$8, %rax
 4358 0127 4889C2   		movq	%rax, %rdx
 4359              		.loc 4 3397 16
 4360 012a 488B45B8 		movq	-72(%rbp), %rax
 4361 012e 488B8018 		movq	280(%rax), %rax
 4361      010000
 4362              		.loc 4 3397 29
 4363 0135 8810     		movb	%dl, (%rax)
3398:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->out_len[1] = (unsigned char)( len      );
 4364              		.loc 4 3398 16
 4365 0137 488B45B8 		movq	-72(%rbp), %rax
 4366 013b 488B8018 		movq	280(%rax), %rax
 4366      010000
 4367              		.loc 4 3398 25
GAS LISTING /tmp/ccEn8xFO.s 			page 185


 4368 0142 4883C001 		addq	$1, %rax
 4369              		.loc 4 3398 31
 4370 0146 488B55D8 		movq	-40(%rbp), %rdx
 4371              		.loc 4 3398 29
 4372 014a 8810     		movb	%dl, (%rax)
 4373              	.L254:
3399:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
3400:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3401:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         protected_record_size = len + mbedtls_ssl_hdr_len( ssl );
 4374              		.loc 4 3401 39
 4375 014c 488B45B8 		movq	-72(%rbp), %rax
 4376 0150 4889C7   		movq	%rax, %rdi
 4377 0153 E8000000 		call	mbedtls_ssl_hdr_len
 4377      00
 4378              		.loc 4 3401 31
 4379 0158 488B55D8 		movq	-40(%rbp), %rdx
 4380 015c 4801D0   		addq	%rdx, %rax
 4381 015f 488945E0 		movq	%rax, -32(%rbp)
3402:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3403:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
3404:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* In case of DTLS, double-check that we don't exceed
3405:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * the remaining space in the datagram. */
3406:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
3407:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
3408:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ret = ssl_get_remaining_space_in_datagram( ssl );
3409:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ret < 0 )
3410:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( ret );
3411:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3412:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( protected_record_size > (size_t) ret )
3413:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
3414:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 /* Should never happen */
3415:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
3416:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
3417:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
3418:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
3419:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3420:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "output record: msgtype = %d, "
3421:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     "version = [%d:%d], msglen = %d",
3422:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     ssl->out_hdr[0], ssl->out_hdr[1],
3423:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     ssl->out_hdr[2], len ) );
3424:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3425:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "output record sent to network",
3426:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                ssl->out_hdr, protected_record_size );
3427:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3428:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_left += protected_record_size;
 4382              		.loc 4 3428 23
 4383 0163 488B45B8 		movq	-72(%rbp), %rax
 4384 0167 488B9040 		movq	320(%rax), %rdx
 4384      010000
 4385 016e 488B45E0 		movq	-32(%rbp), %rax
 4386 0172 4801C2   		addq	%rax, %rdx
 4387 0175 488B45B8 		movq	-72(%rbp), %rax
 4388 0179 48899040 		movq	%rdx, 320(%rax)
 4388      010000
3429:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_hdr  += protected_record_size;
 4389              		.loc 4 3429 23
 4390 0180 488B45B8 		movq	-72(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 186


 4391 0184 488B9010 		movq	272(%rax), %rdx
 4391      010000
 4392 018b 488B45E0 		movq	-32(%rbp), %rax
 4393 018f 4801C2   		addq	%rax, %rdx
 4394 0192 488B45B8 		movq	-72(%rbp), %rax
 4395 0196 48899010 		movq	%rdx, 272(%rax)
 4395      010000
3430:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl_update_out_pointers( ssl, ssl->transform_out );
 4396              		.loc 4 3430 9
 4397 019d 488B45B8 		movq	-72(%rbp), %rax
 4398 01a1 488B5070 		movq	112(%rax), %rdx
 4399 01a5 488B45B8 		movq	-72(%rbp), %rax
 4400 01a9 4889D6   		movq	%rdx, %rsi
 4401 01ac 4889C7   		movq	%rax, %rdi
 4402 01af E8000000 		call	ssl_update_out_pointers
 4402      00
3431:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3432:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         for( i = 8; i > ssl_ep_len( ssl ); i-- )
 4403              		.loc 4 3432 16
 4404 01b4 C745CC08 		movl	$8, -52(%rbp)
 4404      000000
 4405              		.loc 4 3432 9
 4406 01bb EB3A     		jmp	.L257
 4407              	.L260:
3433:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ++ssl->cur_out_ctr[i - 1] != 0 )
 4408              		.loc 4 3433 38
 4409 01bd 8B45CC   		movl	-52(%rbp), %eax
 4410 01c0 8D50FF   		leal	-1(%rax), %edx
 4411              		.loc 4 3433 35
 4412 01c3 488B45B8 		movq	-72(%rbp), %rax
 4413 01c7 89D1     		movl	%edx, %ecx
 4414 01c9 0FB68408 		movzbl	328(%rax,%rcx), %eax
 4414      48010000 
 4415              		.loc 4 3433 17
 4416 01d1 8D4801   		leal	1(%rax), %ecx
 4417              		.loc 4 3433 15
 4418 01d4 488B45B8 		movq	-72(%rbp), %rax
 4419 01d8 89D6     		movl	%edx, %esi
 4420 01da 888C3048 		movb	%cl, 328(%rax,%rsi)
 4420      010000
 4421              		.loc 4 3433 35
 4422 01e1 488B45B8 		movq	-72(%rbp), %rax
 4423 01e5 89D2     		movl	%edx, %edx
 4424 01e7 0FB68410 		movzbl	328(%rax,%rdx), %eax
 4424      48010000 
 4425              		.loc 4 3433 15
 4426 01ef 84C0     		testb	%al, %al
 4427 01f1 751A     		jne	.L263
3432:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ++ssl->cur_out_ctr[i - 1] != 0 )
 4428              		.loc 4 3432 45 discriminator 2
 4429 01f3 836DCC01 		subl	$1, -52(%rbp)
 4430              	.L257:
3432:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ++ssl->cur_out_ctr[i - 1] != 0 )
 4431              		.loc 4 3432 23 discriminator 1
 4432 01f7 8B5DCC   		movl	-52(%rbp), %ebx
3432:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ++ssl->cur_out_ctr[i - 1] != 0 )
 4433              		.loc 4 3432 25 discriminator 1
GAS LISTING /tmp/ccEn8xFO.s 			page 187


 4434 01fa 488B45B8 		movq	-72(%rbp), %rax
 4435 01fe 4889C7   		movq	%rax, %rdi
 4436 0201 E8000000 		call	ssl_ep_len
 4436      00
3432:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ++ssl->cur_out_ctr[i - 1] != 0 )
 4437              		.loc 4 3432 9 discriminator 1
 4438 0206 4839C3   		cmpq	%rax, %rbx
 4439 0209 77B2     		ja	.L260
 4440 020b EB01     		jmp	.L259
 4441              	.L263:
3434:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 break;
 4442              		.loc 4 3434 17
 4443 020d 90       		nop
 4444              	.L259:
3435:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3436:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* The loop goes to its end iff the counter is wrapping */
3437:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( i == ssl_ep_len( ssl ) )
 4445              		.loc 4 3437 15
 4446 020e 8B5DCC   		movl	-52(%rbp), %ebx
 4447              		.loc 4 3437 18
 4448 0211 488B45B8 		movq	-72(%rbp), %rax
 4449 0215 4889C7   		movq	%rax, %rdi
 4450 0218 E8000000 		call	ssl_ep_len
 4450      00
 4451              		.loc 4 3437 11
 4452 021d 4839C3   		cmpq	%rax, %rbx
 4453 0220 7507     		jne	.L253
3438:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
3439:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "outgoing message counter would wrap" ) );
3440:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_COUNTER_WRAPPING );
 4454              		.loc 4 3440 19
 4455 0222 B88094FF 		movl	$-27520, %eax
 4455      FF
 4456 0227 EB25     		jmp	.L256
 4457              	.L253:
 4458              	.LBE19:
3441:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
3442:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3443:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3444:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
3445:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
3446:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         flush == SSL_DONT_FORCE_FLUSH )
3447:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3448:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         size_t remaining;
3449:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ret = ssl_get_remaining_payload_in_datagram( ssl );
3450:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ret < 0 )
3451:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
3452:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "ssl_get_remaining_payload_in_datagram",
3453:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ret );
3454:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
3455:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
3456:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3457:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         remaining = (size_t) ret;
3458:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( remaining == 0 )
3459:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
3460:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             flush = SSL_FORCE_FLUSH;
3461:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
GAS LISTING /tmp/ccEn8xFO.s 			page 188


3462:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else
3463:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
3464:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "Still %u bytes available in current datagram", (unsigned) 
3465:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
3466:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3467:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
3468:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3469:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( flush == SSL_FORCE_FLUSH ) &&
 4459              		.loc 4 3469 7
 4460 0229 807DCB01 		cmpb	$1, -53(%rbp)
 4461 022d 751A     		jne	.L261
3470:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ( ret = mbedtls_ssl_flush_output( ssl ) ) != 0 )
 4462              		.loc 4 3470 17 discriminator 1
 4463 022f 488B45B8 		movq	-72(%rbp), %rax
 4464 0233 4889C7   		movq	%rax, %rdi
 4465 0236 E8000000 		call	mbedtls_ssl_flush_output
 4465      00
 4466 023b 8945D4   		movl	%eax, -44(%rbp)
3469:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ( ret = mbedtls_ssl_flush_output( ssl ) ) != 0 )
 4467              		.loc 4 3469 38 discriminator 1
 4468 023e 837DD400 		cmpl	$0, -44(%rbp)
 4469 0242 7405     		je	.L261
3471:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3472:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_flush_output", ret );
3473:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 4470              		.loc 4 3473 15
 4471 0244 8B45D4   		movl	-44(%rbp), %eax
 4472 0247 EB05     		jmp	.L256
 4473              	.L261:
3474:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3475:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3476:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= write record" ) );
3477:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3478:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 4474              		.loc 4 3478 11
 4475 0249 B8000000 		movl	$0, %eax
 4475      00
 4476              	.L256:
3479:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 4477              		.loc 4 3479 1
 4478 024e 488B5DE8 		movq	-24(%rbp), %rbx
 4479 0252 6448331C 		xorq	%fs:40, %rbx
 4479      25280000 
 4479      00
 4480 025b 7405     		je	.L262
 4481 025d E8000000 		call	__stack_chk_fail@PLT
 4481      00
 4482              	.L262:
 4483 0262 4883C448 		addq	$72, %rsp
 4484 0266 5B       		popq	%rbx
 4485 0267 5D       		popq	%rbp
 4486              	.LCFI71:
 4487              		.cfi_def_cfa 7, 8
 4488 0268 C3       		ret
 4489              		.cfi_endproc
 4490              	.LFE42:
 4492              		.section	.text.ssl_get_hs_total_len,"ax",@progbits
GAS LISTING /tmp/ccEn8xFO.s 			page 189


 4494              	ssl_get_hs_total_len:
 4495              	.LFB43:
3480:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3481:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
3482:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3483:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_hs_is_proper_fragment( mbedtls_ssl_context *ssl )
3484:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
3485:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_msglen < ssl->in_hslen ||
3486:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memcmp( ssl->in_msg + 6, "\0\0\0",        3 ) != 0 ||
3487:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memcmp( ssl->in_msg + 9, ssl->in_msg + 1, 3 ) != 0 )
3488:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3489:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 1 );
3490:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3491:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
3492:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
3493:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3494:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static uint32_t ssl_get_hs_frag_len( mbedtls_ssl_context const *ssl )
3495:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
3496:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ( ssl->in_msg[9] << 16  ) |
3497:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ( ssl->in_msg[10] << 8  ) |
3498:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****               ssl->in_msg[11] );
3499:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
3500:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3501:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static uint32_t ssl_get_hs_frag_off( mbedtls_ssl_context const *ssl )
3502:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
3503:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ( ssl->in_msg[6] << 16 ) |
3504:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ( ssl->in_msg[7] << 8  ) |
3505:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****               ssl->in_msg[8] );
3506:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
3507:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3508:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_check_hs_header( mbedtls_ssl_context const *ssl )
3509:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
3510:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     uint32_t msg_len, frag_off, frag_len;
3511:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3512:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     msg_len  = ssl_get_hs_total_len( ssl );
3513:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     frag_off = ssl_get_hs_frag_off( ssl );
3514:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     frag_len = ssl_get_hs_frag_len( ssl );
3515:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3516:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( frag_off > msg_len )
3517:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( -1 );
3518:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3519:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( frag_len > msg_len - frag_off )
3520:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( -1 );
3521:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3522:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( frag_len + 12 > ssl->in_msglen )
3523:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( -1 );
3524:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3525:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
3526:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
3527:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3528:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
3529:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Mark bits in bitmask (used for DTLS HS reassembly)
3530:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
3531:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_bitmask_set( unsigned char *mask, size_t offset, size_t len )
3532:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
3533:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned int start_bits, end_bits;
3534:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 190


3535:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     start_bits = 8 - ( offset % 8 );
3536:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( start_bits != 8 )
3537:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3538:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         size_t first_byte_idx = offset / 8;
3539:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3540:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Special case */
3541:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( len <= start_bits )
3542:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
3543:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             for( ; len != 0; len-- )
3544:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 mask[first_byte_idx] |= 1 << ( start_bits - len );
3545:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3546:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Avoid potential issues with offset or len becoming invalid */
3547:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return;
3548:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
3549:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3550:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         offset += start_bits; /* Now offset % 8 == 0 */
3551:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         len -= start_bits;
3552:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3553:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         for( ; start_bits != 0; start_bits-- )
3554:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mask[first_byte_idx] |= 1 << ( start_bits - 1 );
3555:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3556:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3557:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     end_bits = len % 8;
3558:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( end_bits != 0 )
3559:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3560:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         size_t last_byte_idx = ( offset + len ) / 8;
3561:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3562:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         len -= end_bits; /* Now len % 8 == 0 */
3563:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3564:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         for( ; end_bits != 0; end_bits-- )
3565:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mask[last_byte_idx] |= 1 << ( 8 - end_bits );
3566:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3567:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3568:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memset( mask + offset / 8, 0xFF, len / 8 );
3569:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
3570:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3571:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
3572:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Check that bitmask is full
3573:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
3574:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_bitmask_check( unsigned char *mask, size_t len )
3575:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
3576:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t i;
3577:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3578:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     for( i = 0; i < len / 8; i++ )
3579:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( mask[i] != 0xFF )
3580:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( -1 );
3581:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3582:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     for( i = 0; i < len % 8; i++ )
3583:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( mask[len / 8] & ( 1 << ( 7 - i ) ) ) == 0 )
3584:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( -1 );
3585:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3586:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
3587:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
3588:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3589:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /* msg_len does not include the handshake header */
3590:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static size_t ssl_get_reassembly_buffer_size( size_t msg_len,
3591:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                               unsigned add_bitmap )
GAS LISTING /tmp/ccEn8xFO.s 			page 191


3592:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
3593:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t alloc_len;
3594:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3595:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     alloc_len  = 12;                                 /* Handshake header */
3596:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     alloc_len += msg_len;                            /* Content buffer   */
3597:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3598:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( add_bitmap )
3599:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         alloc_len += msg_len / 8 + ( msg_len % 8 != 0 ); /* Bitmap       */
3600:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3601:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( alloc_len );
3602:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
3603:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3604:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
3605:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3606:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static uint32_t ssl_get_hs_total_len( mbedtls_ssl_context const *ssl )
3607:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 4496              		.loc 4 3607 1
 4497              		.cfi_startproc
 4498 0000 F30F1EFA 		endbr64
 4499 0004 55       		pushq	%rbp
 4500              	.LCFI72:
 4501              		.cfi_def_cfa_offset 16
 4502              		.cfi_offset 6, -16
 4503 0005 4889E5   		movq	%rsp, %rbp
 4504              	.LCFI73:
 4505              		.cfi_def_cfa_register 6
 4506 0008 4883EC20 		subq	$32, %rsp
 4507 000c 48897DE8 		movq	%rdi, -24(%rbp)
 4508              		.loc 4 3607 1
 4509 0010 64488B04 		movq	%fs:40, %rax
 4509      25280000 
 4509      00
 4510 0019 488945F8 		movq	%rax, -8(%rbp)
 4511 001d 31C0     		xorl	%eax, %eax
3608:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ( ssl->in_msg[1] << 16 ) |
 4512              		.loc 4 3608 18
 4513 001f 488B45E8 		movq	-24(%rbp), %rax
 4514 0023 488B80C8 		movq	200(%rax), %rax
 4514      000000
 4515              		.loc 4 3608 26
 4516 002a 4883C001 		addq	$1, %rax
 4517 002e 0FB600   		movzbl	(%rax), %eax
 4518 0031 0FB6C0   		movzbl	%al, %eax
 4519              		.loc 4 3608 30
 4520 0034 C1E010   		sall	$16, %eax
 4521 0037 89C2     		movl	%eax, %edx
3609:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ( ssl->in_msg[2] << 8  ) |
 4522              		.loc 4 3609 18
 4523 0039 488B45E8 		movq	-24(%rbp), %rax
 4524 003d 488B80C8 		movq	200(%rax), %rax
 4524      000000
 4525              		.loc 4 3609 26
 4526 0044 4883C002 		addq	$2, %rax
 4527 0048 0FB600   		movzbl	(%rax), %eax
 4528 004b 0FB6C0   		movzbl	%al, %eax
 4529              		.loc 4 3609 30
 4530 004e C1E008   		sall	$8, %eax
GAS LISTING /tmp/ccEn8xFO.s 			page 192


3608:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ( ssl->in_msg[1] << 16 ) |
 4531              		.loc 4 3608 38
 4532 0051 09C2     		orl	%eax, %edx
3610:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****               ssl->in_msg[3] );
 4533              		.loc 4 3610 18
 4534 0053 488B45E8 		movq	-24(%rbp), %rax
 4535 0057 488B80C8 		movq	200(%rax), %rax
 4535      000000
 4536              		.loc 4 3610 26
 4537 005e 4883C003 		addq	$3, %rax
 4538 0062 0FB600   		movzbl	(%rax), %eax
 4539 0065 0FB6C0   		movzbl	%al, %eax
3609:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ( ssl->in_msg[2] << 8  ) |
 4540              		.loc 4 3609 38
 4541 0068 09D0     		orl	%edx, %eax
3611:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 4542              		.loc 4 3611 1
 4543 006a 488B4DF8 		movq	-8(%rbp), %rcx
 4544 006e 6448330C 		xorq	%fs:40, %rcx
 4544      25280000 
 4544      00
 4545 0077 7405     		je	.L266
 4546 0079 E8000000 		call	__stack_chk_fail@PLT
 4546      00
 4547              	.L266:
 4548 007e C9       		leave
 4549              	.LCFI74:
 4550              		.cfi_def_cfa 7, 8
 4551 007f C3       		ret
 4552              		.cfi_endproc
 4553              	.LFE43:
 4555              		.section	.text.mbedtls_ssl_prepare_handshake_record,"ax",@progbits
 4556              		.globl	mbedtls_ssl_prepare_handshake_record
 4558              	mbedtls_ssl_prepare_handshake_record:
 4559              	.LFB44:
3612:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3613:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_prepare_handshake_record( mbedtls_ssl_context *ssl )
3614:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 4560              		.loc 4 3614 1
 4561              		.cfi_startproc
 4562 0000 F30F1EFA 		endbr64
 4563 0004 55       		pushq	%rbp
 4564              	.LCFI75:
 4565              		.cfi_def_cfa_offset 16
 4566              		.cfi_offset 6, -16
 4567 0005 4889E5   		movq	%rsp, %rbp
 4568              	.LCFI76:
 4569              		.cfi_def_cfa_register 6
 4570 0008 53       		pushq	%rbx
 4571 0009 4883EC28 		subq	$40, %rsp
 4572              		.cfi_offset 3, -24
 4573 000d 48897DD8 		movq	%rdi, -40(%rbp)
 4574              		.loc 4 3614 1
 4575 0011 64488B04 		movq	%fs:40, %rax
 4575      25280000 
 4575      00
 4576 001a 488945E8 		movq	%rax, -24(%rbp)
GAS LISTING /tmp/ccEn8xFO.s 			page 193


 4577 001e 31C0     		xorl	%eax, %eax
3615:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_msglen < mbedtls_ssl_hs_hdr_len( ssl ) )
 4578              		.loc 4 3615 12
 4579 0020 488B45D8 		movq	-40(%rbp), %rax
 4580 0024 488B98E0 		movq	224(%rax), %rbx
 4580      000000
 4581              		.loc 4 3615 26
 4582 002b 488B45D8 		movq	-40(%rbp), %rax
 4583 002f 4889C7   		movq	%rax, %rdi
 4584 0032 E8000000 		call	mbedtls_ssl_hs_hdr_len
 4584      00
 4585              		.loc 4 3615 7
 4586 0037 4839C3   		cmpq	%rax, %rbx
 4587 003a 7307     		jnb	.L268
3616:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3617:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "handshake message too short: %d",
3618:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             ssl->in_msglen ) );
3619:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INVALID_RECORD );
 4588              		.loc 4 3619 15
 4589 003c B8008EFF 		movl	$-29184, %eax
 4589      FF
 4590 0041 EB53     		jmp	.L269
 4591              	.L268:
3620:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3621:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3622:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->in_hslen = mbedtls_ssl_hs_hdr_len( ssl ) + ssl_get_hs_total_len( ssl );
 4592              		.loc 4 3622 21
 4593 0043 488B45D8 		movq	-40(%rbp), %rax
 4594 0047 4889C7   		movq	%rax, %rdi
 4595 004a E8000000 		call	mbedtls_ssl_hs_hdr_len
 4595      00
 4596 004f 4889C3   		movq	%rax, %rbx
 4597              		.loc 4 3622 53
 4598 0052 488B45D8 		movq	-40(%rbp), %rax
 4599 0056 4889C7   		movq	%rax, %rdi
 4600 0059 E8000000 		call	ssl_get_hs_total_len
 4600      00
 4601 005e 89C0     		movl	%eax, %eax
 4602              		.loc 4 3622 51
 4603 0060 488D1403 		leaq	(%rbx,%rax), %rdx
 4604              		.loc 4 3622 19
 4605 0064 488B45D8 		movq	-40(%rbp), %rax
 4606 0068 488990F0 		movq	%rdx, 240(%rax)
 4606      000000
3623:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3624:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "handshake message: msglen ="
3625:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         " %d, type = %d, hslen = %d",
3626:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         ssl->in_msglen, ssl->in_msg[0], ssl->in_hslen ) );
3627:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3628:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
3629:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
3630:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3631:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         int ret;
3632:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         unsigned int recv_msg_seq = ( ssl->in_msg[4] << 8 ) | ssl->in_msg[5];
3633:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3634:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl_check_hs_header( ssl ) != 0 )
3635:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
GAS LISTING /tmp/ccEn8xFO.s 			page 194


3636:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "invalid handshake header" ) );
3637:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_RECORD );
3638:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
3639:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3640:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->handshake != NULL &&
3641:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ( ( ssl->state   != MBEDTLS_SSL_HANDSHAKE_OVER &&
3642:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 recv_msg_seq != ssl->handshake->in_msg_seq ) ||
3643:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****               ( ssl->state  == MBEDTLS_SSL_HANDSHAKE_OVER &&
3644:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->in_msg[0] != MBEDTLS_SSL_HS_CLIENT_HELLO ) ) )
3645:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
3646:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( recv_msg_seq > ssl->handshake->in_msg_seq )
3647:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
3648:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 2, ( "received future handshake message of sequence number %
3649:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                             recv_msg_seq,
3650:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                             ssl->handshake->in_msg_seq ) );
3651:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_EARLY_MESSAGE );
3652:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
3653:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3654:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Retransmit only on last message from previous flight, to avoid
3655:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * too many retransmissions.
3656:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * Besides, No sane server ever retransmits HelloVerifyRequest */
3657:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( recv_msg_seq == ssl->handshake->in_flight_start_seq - 1 &&
3658:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->in_msg[0] != MBEDTLS_SSL_HS_HELLO_VERIFY_REQUEST )
3659:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
3660:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 2, ( "received message from last flight, "
3661:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     "message_seq = %d, start_of_flight = %d",
3662:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     recv_msg_seq,
3663:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     ssl->handshake->in_flight_start_seq ) );
3664:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3665:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( ( ret = mbedtls_ssl_resend( ssl ) ) != 0 )
3666:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
3667:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_resend", ret );
3668:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     return( ret );
3669:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
3670:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
3671:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else
3672:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
3673:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 2, ( "dropping out-of-sequence message: "
3674:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     "message_seq = %d, expected = %d",
3675:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     recv_msg_seq,
3676:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     ssl->handshake->in_msg_seq ) );
3677:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
3678:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3679:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_CONTINUE_PROCESSING );
3680:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
3681:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Wait until message completion to increment in_msg_seq */
3682:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3683:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Message reassembly is handled alongside buffering of future
3684:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * messages; the commonality is that both handshake fragments and
3685:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * future messages cannot be forwarded immediately to the
3686:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * handshake logic layer. */
3687:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl_hs_is_proper_fragment( ssl ) == 1 )
3688:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
3689:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "found fragmented DTLS handshake message" ) );
3690:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_EARLY_MESSAGE );
3691:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
3692:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
GAS LISTING /tmp/ccEn8xFO.s 			page 195


3693:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
3694:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
3695:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* With TLS we don't handle fragmentation (for now) */
3696:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_msglen < ssl->in_hslen )
 4607              		.loc 4 3696 12
 4608 006f 488B45D8 		movq	-40(%rbp), %rax
 4609 0073 488B90E0 		movq	224(%rax), %rdx
 4609      000000
 4610              		.loc 4 3696 29
 4611 007a 488B45D8 		movq	-40(%rbp), %rax
 4612 007e 488B80F0 		movq	240(%rax), %rax
 4612      000000
 4613              		.loc 4 3696 7
 4614 0085 4839C2   		cmpq	%rax, %rdx
 4615 0088 7307     		jnb	.L270
3697:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3698:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "TLS handshake fragmentation not supported" ) );
3699:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE );
 4616              		.loc 4 3699 15
 4617 008a B8808FFF 		movl	$-28800, %eax
 4617      FF
 4618 008f EB05     		jmp	.L269
 4619              	.L270:
3700:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3701:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3702:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 4620              		.loc 4 3702 11
 4621 0091 B8000000 		movl	$0, %eax
 4621      00
 4622              	.L269:
3703:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 4623              		.loc 4 3703 1
 4624 0096 488B4DE8 		movq	-24(%rbp), %rcx
 4625 009a 6448330C 		xorq	%fs:40, %rcx
 4625      25280000 
 4625      00
 4626 00a3 7405     		je	.L271
 4627 00a5 E8000000 		call	__stack_chk_fail@PLT
 4627      00
 4628              	.L271:
 4629 00aa 4883C428 		addq	$40, %rsp
 4630 00ae 5B       		popq	%rbx
 4631 00af 5D       		popq	%rbp
 4632              	.LCFI77:
 4633              		.cfi_def_cfa 7, 8
 4634 00b0 C3       		ret
 4635              		.cfi_endproc
 4636              	.LFE44:
 4638              		.section	.text.mbedtls_ssl_update_handshake_status,"ax",@progbits
 4639              		.globl	mbedtls_ssl_update_handshake_status
 4641              	mbedtls_ssl_update_handshake_status:
 4642              	.LFB45:
3704:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3705:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_update_handshake_status( mbedtls_ssl_context *ssl )
3706:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 4643              		.loc 4 3706 1
 4644              		.cfi_startproc
GAS LISTING /tmp/ccEn8xFO.s 			page 196


 4645 0000 F30F1EFA 		endbr64
 4646 0004 55       		pushq	%rbp
 4647              	.LCFI78:
 4648              		.cfi_def_cfa_offset 16
 4649              		.cfi_offset 6, -16
 4650 0005 4889E5   		movq	%rsp, %rbp
 4651              	.LCFI79:
 4652              		.cfi_def_cfa_register 6
 4653 0008 4883EC20 		subq	$32, %rsp
 4654 000c 48897DE8 		movq	%rdi, -24(%rbp)
 4655              		.loc 4 3706 1
 4656 0010 64488B04 		movq	%fs:40, %rax
 4656      25280000 
 4656      00
 4657 0019 488945F8 		movq	%rax, -8(%rbp)
 4658 001d 31C0     		xorl	%eax, %eax
3707:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_handshake_params * const hs = ssl->handshake;
 4659              		.loc 4 3707 42
 4660 001f 488B45E8 		movq	-24(%rbp), %rax
 4661 0023 488B4060 		movq	96(%rax), %rax
 4662 0027 488945F0 		movq	%rax, -16(%rbp)
3708:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3709:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->state != MBEDTLS_SSL_HANDSHAKE_OVER && hs != NULL )
 4663              		.loc 4 3709 12
 4664 002b 488B45E8 		movq	-24(%rbp), %rax
 4665 002f 8B4008   		movl	8(%rax), %eax
 4666              		.loc 4 3709 7
 4667 0032 83F810   		cmpl	$16, %eax
 4668 0035 7439     		je	.L275
 4669              		.loc 4 3709 50 discriminator 1
 4670 0037 48837DF0 		cmpq	$0, -16(%rbp)
 4670      00
 4671 003c 7432     		je	.L275
3710:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3711:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake->update_checksum( ssl, ssl->in_msg, ssl->in_hslen );
 4672              		.loc 4 3711 12
 4673 003e 488B45E8 		movq	-24(%rbp), %rax
 4674 0042 488B4060 		movq	96(%rax), %rax
 4675              		.loc 4 3711 23
 4676 0046 4C8B80F0 		movq	752(%rax), %r8
 4676      020000
 4677              		.loc 4 3711 9
 4678 004d 488B45E8 		movq	-24(%rbp), %rax
 4679 0051 488B90F0 		movq	240(%rax), %rdx
 4679      000000
 4680              		.loc 4 3711 50
 4681 0058 488B45E8 		movq	-24(%rbp), %rax
 4682 005c 488B88C8 		movq	200(%rax), %rcx
 4682      000000
 4683              		.loc 4 3711 9
 4684 0063 488B45E8 		movq	-24(%rbp), %rax
 4685 0067 4889CE   		movq	%rcx, %rsi
 4686 006a 4889C7   		movq	%rax, %rdi
 4687 006d 41FFD0   		call	*%r8
 4688              	.LVL12:
 4689              	.L275:
3712:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
GAS LISTING /tmp/ccEn8xFO.s 			page 197


3713:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3714:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Handshake message is complete, increment counter */
3715:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
3716:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
3717:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake != NULL )
3718:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3719:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         unsigned offset;
3720:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_hs_buffer *hs_buf;
3721:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3722:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Increment handshake sequence number */
3723:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         hs->in_msg_seq++;
3724:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3725:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
3726:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Clear up handshake buffering and reassembly structure.
3727:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
3728:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3729:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Free first entry */
3730:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl_buffering_free_slot( ssl, 0 );
3731:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3732:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Shift all other entries */
3733:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         for( offset = 0, hs_buf = &hs->buffering.hs[0];
3734:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              offset + 1 < MBEDTLS_SSL_MAX_BUFFERED_HS;
3735:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              offset++, hs_buf++ )
3736:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
3737:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             *hs_buf = *(hs_buf + 1);
3738:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
3739:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3740:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Create a fresh last entry */
3741:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memset( hs_buf, 0, sizeof( mbedtls_ssl_hs_buffer ) );
3742:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3743:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
3744:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 4690              		.loc 4 3744 1
 4691 0070 90       		nop
 4692 0071 488B45F8 		movq	-8(%rbp), %rax
 4693 0075 64483304 		xorq	%fs:40, %rax
 4693      25280000 
 4693      00
 4694 007e 7405     		je	.L274
 4695 0080 E8000000 		call	__stack_chk_fail@PLT
 4695      00
 4696              	.L274:
 4697 0085 C9       		leave
 4698              	.LCFI80:
 4699              		.cfi_def_cfa 7, 8
 4700 0086 C3       		ret
 4701              		.cfi_endproc
 4702              	.LFE45:
 4704              		.section	.text.ssl_parse_record_header,"ax",@progbits
 4706              	ssl_parse_record_header:
 4707              	.LFB46:
3745:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3746:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
3747:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * DTLS anti-replay: RFC 6347 4.1.2.6
3748:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
3749:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * in_window is a field of bits numbered from 0 (lsb) to 63 (msb).
3750:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Bit n is set iff record number in_window_top - n has been seen.
GAS LISTING /tmp/ccEn8xFO.s 			page 198


3751:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
3752:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Usually, in_window_top is the last record number seen and the lsb of
3753:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * in_window is set. The only exception is the initial state (record number 0
3754:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * not seen yet).
3755:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
3756:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_ANTI_REPLAY)
3757:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_dtls_replay_reset( mbedtls_ssl_context *ssl )
3758:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
3759:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->in_window_top = 0;
3760:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->in_window = 0;
3761:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
3762:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3763:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static inline uint64_t ssl_load_six_bytes( unsigned char *buf )
3764:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
3765:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ( (uint64_t) buf[0] << 40 ) |
3766:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ( (uint64_t) buf[1] << 32 ) |
3767:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ( (uint64_t) buf[2] << 24 ) |
3768:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ( (uint64_t) buf[3] << 16 ) |
3769:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ( (uint64_t) buf[4] <<  8 ) |
3770:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ( (uint64_t) buf[5]       ) );
3771:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
3772:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3773:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
3774:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Return 0 if sequence number is acceptable, -1 otherwise
3775:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
3776:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_dtls_replay_check( mbedtls_ssl_context *ssl )
3777:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
3778:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     uint64_t rec_seqnum = ssl_load_six_bytes( ssl->in_ctr + 2 );
3779:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     uint64_t bit;
3780:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3781:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->anti_replay == MBEDTLS_SSL_ANTI_REPLAY_DISABLED )
3782:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
3783:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3784:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( rec_seqnum > ssl->in_window_top )
3785:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
3786:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3787:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     bit = ssl->in_window_top - rec_seqnum;
3788:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3789:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( bit >= 64 )
3790:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( -1 );
3791:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3792:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ssl->in_window & ( (uint64_t) 1 << bit ) ) != 0 )
3793:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( -1 );
3794:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3795:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
3796:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
3797:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3798:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
3799:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Update replay window on new validated record
3800:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
3801:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_dtls_replay_update( mbedtls_ssl_context *ssl )
3802:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
3803:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     uint64_t rec_seqnum = ssl_load_six_bytes( ssl->in_ctr + 2 );
3804:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3805:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->anti_replay == MBEDTLS_SSL_ANTI_REPLAY_DISABLED )
3806:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return;
3807:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 199


3808:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( rec_seqnum > ssl->in_window_top )
3809:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3810:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Update window_top and the contents of the window */
3811:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         uint64_t shift = rec_seqnum - ssl->in_window_top;
3812:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3813:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( shift >= 64 )
3814:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_window = 1;
3815:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else
3816:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
3817:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_window <<= shift;
3818:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_window |= 1;
3819:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
3820:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3821:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_window_top = rec_seqnum;
3822:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3823:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
3824:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3825:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Mark that number as seen in the current window */
3826:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         uint64_t bit = ssl->in_window_top - rec_seqnum;
3827:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3828:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( bit < 64 ) /* Always true, but be extra sure */
3829:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_window |= (uint64_t) 1 << bit;
3830:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3831:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
3832:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_DTLS_ANTI_REPLAY */
3833:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3834:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_CLIENT_PORT_REUSE) && defined(MBEDTLS_SSL_SRV_C)
3835:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /* Forward declaration */
3836:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_session_reset_int( mbedtls_ssl_context *ssl, int partial );
3837:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3838:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
3839:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Without any SSL context, check if a datagram looks like a ClientHello with
3840:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * a valid cookie, and if it doesn't, generate a HelloVerifyRequest message.
3841:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Both input and output include full DTLS headers.
3842:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
3843:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * - if cookie is valid, return 0
3844:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * - if ClientHello looks superficially valid but cookie is not,
3845:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *   fill obuf and set olen, then
3846:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *   return MBEDTLS_ERR_SSL_HELLO_VERIFY_REQUIRED
3847:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * - otherwise return a specific error code
3848:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
3849:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_check_dtls_clihlo_cookie(
3850:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            mbedtls_ssl_cookie_write_t *f_cookie_write,
3851:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            mbedtls_ssl_cookie_check_t *f_cookie_check,
3852:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            void *p_cookie,
3853:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            const unsigned char *cli_id, size_t cli_id_len,
3854:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            const unsigned char *in, size_t in_len,
3855:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            unsigned char *obuf, size_t buf_len, size_t *olen )
3856:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
3857:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t sid_len, cookie_len;
3858:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char *p;
3859:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3860:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( f_cookie_write == NULL || f_cookie_check == NULL )
3861:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
3862:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3863:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
3864:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Structure of ClientHello with record and handshake headers,
GAS LISTING /tmp/ccEn8xFO.s 			page 200


3865:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * and expected values. We don't need to check a lot, more checks will be
3866:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * done when actually parsing the ClientHello - skipping those checks
3867:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * avoids code duplication and does not make cookie forging any easier.
3868:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *
3869:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *  0-0  ContentType type;                  copied, must be handshake
3870:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *  1-2  ProtocolVersion version;           copied
3871:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *  3-4  uint16 epoch;                      copied, must be 0
3872:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *  5-10 uint48 sequence_number;            copied
3873:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * 11-12 uint16 length;                     (ignored)
3874:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *
3875:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * 13-13 HandshakeType msg_type;            (ignored)
3876:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * 14-16 uint24 length;                     (ignored)
3877:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * 17-18 uint16 message_seq;                copied
3878:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * 19-21 uint24 fragment_offset;            copied, must be 0
3879:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * 22-24 uint24 fragment_length;            (ignored)
3880:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *
3881:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * 25-26 ProtocolVersion client_version;    (ignored)
3882:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * 27-58 Random random;                     (ignored)
3883:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * 59-xx SessionID session_id;              1 byte len + sid_len content
3884:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * 60+   opaque cookie<0..2^8-1>;           1 byte len + content
3885:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *       ...
3886:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *
3887:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Minimum length is 61 bytes.
3888:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
3889:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( in_len < 61 ||
3890:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         in[0] != MBEDTLS_SSL_MSG_HANDSHAKE ||
3891:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         in[3] != 0 || in[4] != 0 ||
3892:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         in[19] != 0 || in[20] != 0 || in[21] != 0 )
3893:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3894:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_CLIENT_HELLO );
3895:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3896:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3897:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     sid_len = in[59];
3898:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( sid_len > in_len - 61 )
3899:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_CLIENT_HELLO );
3900:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3901:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     cookie_len = in[60 + sid_len];
3902:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( cookie_len > in_len - 60 )
3903:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_CLIENT_HELLO );
3904:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3905:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( f_cookie_check( p_cookie, in + sid_len + 61, cookie_len,
3906:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         cli_id, cli_id_len ) == 0 )
3907:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3908:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Valid cookie */
3909:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
3910:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3911:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3912:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
3913:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * If we get here, we've got an invalid cookie, let's prepare HVR.
3914:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *
3915:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *  0-0  ContentType type;                  copied
3916:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *  1-2  ProtocolVersion version;           copied
3917:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *  3-4  uint16 epoch;                      copied
3918:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *  5-10 uint48 sequence_number;            copied
3919:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * 11-12 uint16 length;                     olen - 13
3920:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *
3921:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * 13-13 HandshakeType msg_type;            hello_verify_request
GAS LISTING /tmp/ccEn8xFO.s 			page 201


3922:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * 14-16 uint24 length;                     olen - 25
3923:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * 17-18 uint16 message_seq;                copied
3924:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * 19-21 uint24 fragment_offset;            copied
3925:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * 22-24 uint24 fragment_length;            olen - 25
3926:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *
3927:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * 25-26 ProtocolVersion server_version;    0xfe 0xff
3928:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * 27-27 opaque cookie<0..2^8-1>;           cookie_len = olen - 27, cookie
3929:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *
3930:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Minimum length is 28.
3931:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
3932:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( buf_len < 28 )
3933:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BUFFER_TOO_SMALL );
3934:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3935:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Copy most fields and adapt others */
3936:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( obuf, in, 25 );
3937:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     obuf[13] = MBEDTLS_SSL_HS_HELLO_VERIFY_REQUEST;
3938:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     obuf[25] = 0xfe;
3939:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     obuf[26] = 0xff;
3940:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3941:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Generate and write actual cookie */
3942:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     p = obuf + 28;
3943:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( f_cookie_write( p_cookie,
3944:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         &p, obuf + buf_len, cli_id, cli_id_len ) != 0 )
3945:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
3946:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
3947:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
3948:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3949:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     *olen = p - obuf;
3950:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3951:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Go back and fill length fields */
3952:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     obuf[27] = (unsigned char)( *olen - 28 );
3953:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3954:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     obuf[14] = obuf[22] = (unsigned char)( ( *olen - 25 ) >> 16 );
3955:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     obuf[15] = obuf[23] = (unsigned char)( ( *olen - 25 ) >>  8 );
3956:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     obuf[16] = obuf[24] = (unsigned char)( ( *olen - 25 )       );
3957:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3958:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     obuf[11] = (unsigned char)( ( *olen - 13 ) >>  8 );
3959:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     obuf[12] = (unsigned char)( ( *olen - 13 )       );
3960:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3961:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( MBEDTLS_ERR_SSL_HELLO_VERIFY_REQUIRED );
3962:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
3963:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3964:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
3965:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Handle possible client reconnect with the same UDP quadruplet
3966:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * (RFC 6347 Section 4.2.8).
3967:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
3968:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Called by ssl_parse_record_header() in case we receive an epoch 0 record
3969:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * that looks like a ClientHello.
3970:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
3971:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * - if the input looks like a ClientHello without cookies,
3972:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *   send back HelloVerifyRequest, then
3973:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *   return MBEDTLS_ERR_SSL_HELLO_VERIFY_REQUIRED
3974:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * - if the input looks like a ClientHello with a valid cookie,
3975:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *   reset the session of the current context, and
3976:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *   return MBEDTLS_ERR_SSL_CLIENT_RECONNECT
3977:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * - if anything goes wrong, return a specific error code
3978:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
GAS LISTING /tmp/ccEn8xFO.s 			page 202


3979:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * mbedtls_ssl_read_record() will ignore the record if anything else than
3980:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * MBEDTLS_ERR_SSL_CLIENT_RECONNECT or 0 is returned, although this function
3981:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * cannot not return 0.
3982:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
3983:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_handle_possible_reconnect( mbedtls_ssl_context *ssl )
3984:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
3985:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
3986:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t len;
3987:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3988:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ret = ssl_check_dtls_clihlo_cookie(
3989:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->conf->f_cookie_write,
3990:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->conf->f_cookie_check,
3991:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->conf->p_cookie,
3992:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->cli_id, ssl->cli_id_len,
3993:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_buf, ssl->in_left,
3994:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->out_buf, MBEDTLS_SSL_OUT_CONTENT_LEN, &len );
3995:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3996:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_RET( 2, "ssl_check_dtls_clihlo_cookie", ret );
3997:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
3998:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ret == MBEDTLS_ERR_SSL_HELLO_VERIFY_REQUIRED )
3999:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4000:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Don't check write errors as we can't do anything here.
4001:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * If the error is permanent we'll catch it later,
4002:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * if it's not, then hopefully it'll work next time. */
4003:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         (void) ssl->f_send( ssl->p_bio, ssl->out_buf, len );
4004:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4005:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_HELLO_VERIFY_REQUIRED );
4006:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4007:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4008:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ret == 0 )
4009:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4010:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Got a valid cookie, partially reset context */
4011:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = ssl_session_reset_int( ssl, 1 ) ) != 0 )
4012:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
4013:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "reset", ret );
4014:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
4015:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
4016:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4017:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_CLIENT_RECONNECT );
4018:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4019:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4020:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ret );
4021:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
4022:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_DTLS_CLIENT_PORT_REUSE && MBEDTLS_SSL_SRV_C */
4023:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4024:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
4025:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * ContentType type;
4026:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * ProtocolVersion version;
4027:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * uint16 epoch;            // DTLS only
4028:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * uint48 sequence_number;  // DTLS only
4029:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * uint16 length;
4030:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
4031:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Return 0 if header looks sane (and, for DTLS, the record is expected)
4032:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * MBEDTLS_ERR_SSL_INVALID_RECORD if the header looks bad,
4033:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * MBEDTLS_ERR_SSL_UNEXPECTED_RECORD (DTLS only) if sane but unexpected.
4034:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
4035:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * With DTLS, mbedtls_ssl_read_record() will:
GAS LISTING /tmp/ccEn8xFO.s 			page 203


4036:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * 1. proceed with the record if this function returns 0
4037:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * 2. drop only the current record if this function returns UNEXPECTED_RECORD
4038:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * 3. return CLIENT_RECONNECT if this function return that value
4039:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * 4. drop the whole datagram if this function returns anything else.
4040:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Point 2 is needed when the peer is resending, and we have already received
4041:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * the first record from a datagram but are still waiting for the others.
4042:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
4043:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_parse_record_header( mbedtls_ssl_context *ssl )
4044:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 4708              		.loc 4 4044 1
 4709              		.cfi_startproc
 4710 0000 F30F1EFA 		endbr64
 4711 0004 55       		pushq	%rbp
 4712              	.LCFI81:
 4713              		.cfi_def_cfa_offset 16
 4714              		.cfi_offset 6, -16
 4715 0005 4889E5   		movq	%rsp, %rbp
 4716              	.LCFI82:
 4717              		.cfi_def_cfa_register 6
 4718 0008 4883EC20 		subq	$32, %rsp
 4719 000c 48897DE8 		movq	%rdi, -24(%rbp)
 4720              		.loc 4 4044 1
 4721 0010 64488B04 		movq	%fs:40, %rax
 4721      25280000 
 4721      00
 4722 0019 488945F8 		movq	%rax, -8(%rbp)
 4723 001d 31C0     		xorl	%eax, %eax
4045:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int major_ver, minor_ver;
4046:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4047:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "input record header", ssl->in_hdr, mbedtls_ssl_hdr_len( ssl ) );
4048:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4049:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->in_msgtype =  ssl->in_hdr[0];
 4724              		.loc 4 4049 27
 4725 001f 488B45E8 		movq	-24(%rbp), %rax
 4726 0023 488B80B0 		movq	176(%rax), %rax
 4726      000000
 4727              		.loc 4 4049 35
 4728 002a 0FB600   		movzbl	(%rax), %eax
 4729 002d 0FB6D0   		movzbl	%al, %edx
 4730              		.loc 4 4049 21
 4731 0030 488B45E8 		movq	-24(%rbp), %rax
 4732 0034 8990D800 		movl	%edx, 216(%rax)
 4732      0000
4050:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->in_msglen = ( ssl->in_len[0] << 8 ) | ssl->in_len[1];
 4733              		.loc 4 4050 27
 4734 003a 488B45E8 		movq	-24(%rbp), %rax
 4735 003e 488B80B8 		movq	184(%rax), %rax
 4735      000000
 4736              		.loc 4 4050 35
 4737 0045 0FB600   		movzbl	(%rax), %eax
 4738 0048 0FB6C0   		movzbl	%al, %eax
 4739              		.loc 4 4050 39
 4740 004b C1E008   		sall	$8, %eax
 4741 004e 89C2     		movl	%eax, %edx
 4742              		.loc 4 4050 51
 4743 0050 488B45E8 		movq	-24(%rbp), %rax
 4744 0054 488B80B8 		movq	184(%rax), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 204


 4744      000000
 4745              		.loc 4 4050 59
 4746 005b 4883C001 		addq	$1, %rax
 4747 005f 0FB600   		movzbl	(%rax), %eax
 4748 0062 0FB6C0   		movzbl	%al, %eax
 4749              		.loc 4 4050 46
 4750 0065 09D0     		orl	%edx, %eax
 4751 0067 4863D0   		movslq	%eax, %rdx
 4752              		.loc 4 4050 20
 4753 006a 488B45E8 		movq	-24(%rbp), %rax
 4754 006e 488990E0 		movq	%rdx, 224(%rax)
 4754      000000
4051:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_read_version( &major_ver, &minor_ver, ssl->conf->transport, ssl->in_hdr + 1 );
 4755              		.loc 4 4051 80
 4756 0075 488B45E8 		movq	-24(%rbp), %rax
 4757 0079 488B80B0 		movq	176(%rax), %rax
 4757      000000
 4758              		.loc 4 4051 89
 4759 0080 488D4801 		leaq	1(%rax), %rcx
 4760              		.loc 4 4051 58
 4761 0084 488B45E8 		movq	-24(%rbp), %rax
 4762 0088 488B00   		movq	(%rax), %rax
 4763              		.loc 4 4051 64
 4764 008b 0FB680BC 		movzbl	188(%rax), %eax
 4764      000000
 4765 0092 D0E8     		shrb	%al
 4766 0094 83E001   		andl	$1, %eax
 4767              		.loc 4 4051 5
 4768 0097 0FB6D0   		movzbl	%al, %edx
 4769 009a 488D75F4 		leaq	-12(%rbp), %rsi
 4770 009e 488D45F0 		leaq	-16(%rbp), %rax
 4771 00a2 4889C7   		movq	%rax, %rdi
 4772 00a5 E8000000 		call	mbedtls_ssl_read_version
 4772      00
4052:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4053:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "input record: msgtype = %d, "
4054:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         "version = [%d:%d], msglen = %d",
4055:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         ssl->in_msgtype,
4056:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         major_ver, minor_ver, ssl->in_msglen ) );
4057:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4058:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Check record type */
4059:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_msgtype != MBEDTLS_SSL_MSG_HANDSHAKE &&
 4773              		.loc 4 4059 12
 4774 00aa 488B45E8 		movq	-24(%rbp), %rax
 4775 00ae 8B80D800 		movl	216(%rax), %eax
 4775      0000
 4776              		.loc 4 4059 7
 4777 00b4 83F816   		cmpl	$22, %eax
 4778 00b7 744D     		je	.L277
4060:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_msgtype != MBEDTLS_SSL_MSG_ALERT &&
 4779              		.loc 4 4060 12 discriminator 1
 4780 00b9 488B45E8 		movq	-24(%rbp), %rax
 4781 00bd 8B80D800 		movl	216(%rax), %eax
 4781      0000
4059:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_msgtype != MBEDTLS_SSL_MSG_ALERT &&
 4782              		.loc 4 4059 54 discriminator 1
 4783 00c3 83F815   		cmpl	$21, %eax
GAS LISTING /tmp/ccEn8xFO.s 			page 205


 4784 00c6 743E     		je	.L277
4061:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_msgtype != MBEDTLS_SSL_MSG_CHANGE_CIPHER_SPEC &&
 4785              		.loc 4 4061 12
 4786 00c8 488B45E8 		movq	-24(%rbp), %rax
 4787 00cc 8B80D800 		movl	216(%rax), %eax
 4787      0000
4060:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_msgtype != MBEDTLS_SSL_MSG_ALERT &&
 4788              		.loc 4 4060 50
 4789 00d2 83F814   		cmpl	$20, %eax
 4790 00d5 742F     		je	.L277
4062:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_msgtype != MBEDTLS_SSL_MSG_APPLICATION_DATA )
 4791              		.loc 4 4062 12
 4792 00d7 488B45E8 		movq	-24(%rbp), %rax
 4793 00db 8B80D800 		movl	216(%rax), %eax
 4793      0000
4061:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_msgtype != MBEDTLS_SSL_MSG_CHANGE_CIPHER_SPEC &&
 4794              		.loc 4 4061 63
 4795 00e1 83F817   		cmpl	$23, %eax
 4796 00e4 7420     		je	.L277
4063:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4064:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "unknown record type" ) );
4065:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4066:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
4067:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Silently ignore invalid DTLS records as recommended by RFC 6347
4068:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Section 4.1.2.7 */
4069:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->conf->transport != MBEDTLS_SSL_TRANSPORT_DATAGRAM )
4070:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
4071:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 4797              		.loc 4 4071 13
 4798 00e6 488B45E8 		movq	-24(%rbp), %rax
 4799 00ea BA0A0000 		movl	$10, %edx
 4799      00
 4800 00ef BE020000 		movl	$2, %esi
 4800      00
 4801 00f4 4889C7   		movq	%rax, %rdi
 4802 00f7 E8000000 		call	mbedtls_ssl_send_alert_message
 4802      00
4072:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     MBEDTLS_SSL_ALERT_MSG_UNEXPECTED_MESSAGE );
4073:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4074:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INVALID_RECORD );
 4803              		.loc 4 4074 15
 4804 00fc B8008EFF 		movl	$-29184, %eax
 4804      FF
 4805 0101 E90E0100 		jmp	.L286
 4805      00
 4806              	.L277:
4075:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4076:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4077:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Check version */
4078:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( major_ver != ssl->major_ver )
 4807              		.loc 4 4078 25
 4808 0106 488B45E8 		movq	-24(%rbp), %rax
 4809 010a 8B5014   		movl	20(%rax), %edx
 4810              		.loc 4 4078 19
 4811 010d 8B45F0   		movl	-16(%rbp), %eax
 4812              		.loc 4 4078 7
 4813 0110 39C2     		cmpl	%eax, %edx
GAS LISTING /tmp/ccEn8xFO.s 			page 206


 4814 0112 740A     		je	.L279
4079:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4080:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "major version mismatch" ) );
4081:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INVALID_RECORD );
 4815              		.loc 4 4081 15
 4816 0114 B8008EFF 		movl	$-29184, %eax
 4816      FF
 4817 0119 E9F60000 		jmp	.L286
 4817      00
 4818              	.L279:
4082:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4083:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4084:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( minor_ver > ssl->conf->max_minor_ver )
 4819              		.loc 4 4084 24
 4820 011e 488B45E8 		movq	-24(%rbp), %rax
 4821 0122 488B00   		movq	(%rax), %rax
 4822              		.loc 4 4084 30
 4823 0125 0FB680B9 		movzbl	185(%rax), %eax
 4823      000000
 4824 012c 0FB6D0   		movzbl	%al, %edx
 4825              		.loc 4 4084 19
 4826 012f 8B45F4   		movl	-12(%rbp), %eax
 4827              		.loc 4 4084 7
 4828 0132 39C2     		cmpl	%eax, %edx
 4829 0134 7D0A     		jge	.L280
4085:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4086:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "minor version mismatch" ) );
4087:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INVALID_RECORD );
 4830              		.loc 4 4087 15
 4831 0136 B8008EFF 		movl	$-29184, %eax
 4831      FF
 4832 013b E9D40000 		jmp	.L286
 4832      00
 4833              	.L280:
4088:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4089:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4090:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Check length against the size of our buffer */
4091:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_msglen > MBEDTLS_SSL_IN_BUFFER_LEN
 4834              		.loc 4 4091 12
 4835 0140 488B45E8 		movq	-24(%rbp), %rax
 4836 0144 488B90E0 		movq	224(%rax), %rdx
 4836      000000
4092:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                          - (size_t)( ssl->in_msg - ssl->in_buf ) )
 4837              		.loc 4 4092 41
 4838 014b 488B45E8 		movq	-24(%rbp), %rax
 4839 014f 488B88C8 		movq	200(%rax), %rcx
 4839      000000
 4840              		.loc 4 4092 55
 4841 0156 488B45E8 		movq	-24(%rbp), %rax
 4842 015a 488B80A0 		movq	160(%rax), %rax
 4842      000000
 4843              		.loc 4 4092 50
 4844 0161 4829C1   		subq	%rax, %rcx
 4845 0164 4889C8   		movq	%rcx, %rax
 4846              		.loc 4 4092 26
 4847 0167 B9BD3F00 		movl	$16317, %ecx
 4847      00
GAS LISTING /tmp/ccEn8xFO.s 			page 207


 4848 016c 4829C1   		subq	%rax, %rcx
 4849 016f 4889C8   		movq	%rcx, %rax
4091:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                          - (size_t)( ssl->in_msg - ssl->in_buf ) )
 4850              		.loc 4 4091 7
 4851 0172 4839C2   		cmpq	%rax, %rdx
 4852 0175 760A     		jbe	.L281
4093:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4094:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad message length" ) );
4095:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INVALID_RECORD );
 4853              		.loc 4 4095 15
 4854 0177 B8008EFF 		movl	$-29184, %eax
 4854      FF
 4855 017c E9930000 		jmp	.L286
 4855      00
 4856              	.L281:
4096:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4097:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4098:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
4099:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * DTLS-related tests.
4100:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Check epoch before checking length constraint because
4101:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * the latter varies with the epoch. E.g., if a ChangeCipherSpec
4102:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * message gets duplicated before the corresponding Finished message,
4103:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * the second ChangeCipherSpec should be discarded because it belongs
4104:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * to an old epoch, but not because its length is shorter than
4105:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * the minimum record length for packets using the new record transform.
4106:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Note that these two kinds of failures are handled differently,
4107:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * as an unexpected record is silently skipped but an invalid
4108:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * record leads to the entire datagram being dropped.
4109:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
4110:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
4111:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
4112:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4113:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         unsigned int rec_epoch = ( ssl->in_ctr[0] << 8 ) | ssl->in_ctr[1];
4114:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4115:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Check epoch (and sequence number) with DTLS */
4116:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( rec_epoch != ssl->in_epoch )
4117:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
4118:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "record from another epoch: "
4119:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         "expected %d, received %d",
4120:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         ssl->in_epoch, rec_epoch ) );
4121:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4122:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_CLIENT_PORT_REUSE) && defined(MBEDTLS_SSL_SRV_C)
4123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /*
4124:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * Check for an epoch 0 ClientHello. We can't use in_msg here to
4125:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * access the first byte of record content (handshake type), as we
4126:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * have an active transform (possibly iv_len != 0), so use the
4127:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * fact that the record header len is 13 instead.
4128:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              */
4129:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER &&
4130:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->state == MBEDTLS_SSL_HANDSHAKE_OVER &&
4131:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 rec_epoch == 0 &&
4132:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->in_msgtype == MBEDTLS_SSL_MSG_HANDSHAKE &&
4133:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->in_left > 13 &&
4134:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->in_buf[13] == MBEDTLS_SSL_HS_CLIENT_HELLO )
4135:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
4136:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "possible client reconnect "
4137:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                             "from the same port" ) );
GAS LISTING /tmp/ccEn8xFO.s 			page 208


4138:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( ssl_handle_possible_reconnect( ssl ) );
4139:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
4140:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else
4141:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_DTLS_CLIENT_PORT_REUSE && MBEDTLS_SSL_SRV_C */
4142:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
4143:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 /* Consider buffering the record. */
4144:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( rec_epoch == (unsigned int) ssl->in_epoch + 1 )
4145:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
4146:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_MSG( 2, ( "Consider record for buffering" ) );
4147:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     return( MBEDTLS_ERR_SSL_EARLY_MESSAGE );
4148:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
4149:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4150:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_UNEXPECTED_RECORD );
4151:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
4152:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
4153:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4154:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_ANTI_REPLAY)
4155:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Replay detection only works for the current epoch */
4156:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( rec_epoch == ssl->in_epoch &&
4157:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_ssl_dtls_replay_check( ssl ) != 0 )
4158:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
4159:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "replayed record" ) );
4160:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_UNEXPECTED_RECORD );
4161:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
4162:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
4163:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4164:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Drop unexpected ApplicationData records,
4165:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * except at the beginning of renegotiations */
4166:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_msgtype == MBEDTLS_SSL_MSG_APPLICATION_DATA &&
4167:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->state != MBEDTLS_SSL_HANDSHAKE_OVER
4168:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
4169:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             && ! ( ssl->renego_status == MBEDTLS_SSL_RENEGOTIATION_IN_PROGRESS &&
4170:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                    ssl->state == MBEDTLS_SSL_SERVER_HELLO )
4171:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
4172:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             )
4173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
4174:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "dropping unexpected ApplicationData" ) );
4175:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_UNEXPECTED_RECORD );
4176:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
4177:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4178:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
4179:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4180:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4181:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Check length against bounds of the current transform and version */
4182:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->transform_in == NULL )
 4857              		.loc 4 4182 12
 4858 0181 488B45E8 		movq	-24(%rbp), %rax
 4859 0185 488B4068 		movq	104(%rax), %rax
 4860              		.loc 4 4182 7
 4861 0189 4885C0   		testq	%rax, %rax
 4862 018c 752A     		jne	.L282
4183:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4184:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_msglen < 1 ||
 4863              		.loc 4 4184 16
 4864 018e 488B45E8 		movq	-24(%rbp), %rax
 4865 0192 488B80E0 		movq	224(%rax), %rax
 4865      000000
GAS LISTING /tmp/ccEn8xFO.s 			page 209


 4866              		.loc 4 4184 11
 4867 0199 4885C0   		testq	%rax, %rax
 4868 019c 7413     		je	.L283
4185:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msglen > MBEDTLS_SSL_IN_CONTENT_LEN )
 4869              		.loc 4 4185 16 discriminator 1
 4870 019e 488B45E8 		movq	-24(%rbp), %rax
 4871 01a2 488B80E0 		movq	224(%rax), %rax
 4871      000000
4184:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msglen > MBEDTLS_SSL_IN_CONTENT_LEN )
 4872              		.loc 4 4184 32 discriminator 1
 4873 01a9 483D803E 		cmpq	$16000, %rax
 4873      0000
 4874 01af 765E     		jbe	.L284
 4875              	.L283:
4186:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
4187:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad message length" ) );
4188:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_RECORD );
 4876              		.loc 4 4188 19
 4877 01b1 B8008EFF 		movl	$-29184, %eax
 4877      FF
 4878 01b6 EB5C     		jmp	.L286
 4879              	.L282:
4189:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
4190:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4191:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
4192:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4193:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_msglen < ssl->transform_in->minlen )
 4880              		.loc 4 4193 16
 4881 01b8 488B45E8 		movq	-24(%rbp), %rax
 4882 01bc 488B90E0 		movq	224(%rax), %rdx
 4882      000000
 4883              		.loc 4 4193 33
 4884 01c3 488B45E8 		movq	-24(%rbp), %rax
 4885 01c7 488B4068 		movq	104(%rax), %rax
 4886              		.loc 4 4193 47
 4887 01cb 488B4010 		movq	16(%rax), %rax
 4888              		.loc 4 4193 11
 4889 01cf 4839C2   		cmpq	%rax, %rdx
 4890 01d2 7307     		jnb	.L285
4194:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
4195:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad message length" ) );
4196:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_RECORD );
 4891              		.loc 4 4196 19
 4892 01d4 B8008EFF 		movl	$-29184, %eax
 4892      FF
 4893 01d9 EB39     		jmp	.L286
 4894              	.L285:
4197:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
4198:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4199:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
4200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 &&
4201:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msglen > ssl->transform_in->minlen + MBEDTLS_SSL_IN_CONTENT_LEN )
4202:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
4203:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad message length" ) );
4204:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_RECORD );
4205:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
4206:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
GAS LISTING /tmp/ccEn8xFO.s 			page 210


4207:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1) || \
4208:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_2)
4209:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
4210:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * TLS encrypted messages can have up to 256 bytes of padding
4211:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
4212:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_1 &&
 4895              		.loc 4 4212 16
 4896 01db 488B45E8 		movq	-24(%rbp), %rax
 4897 01df 8B4018   		movl	24(%rax), %eax
 4898              		.loc 4 4212 11
 4899 01e2 85C0     		testl	%eax, %eax
 4900 01e4 7E29     		jle	.L284
4213:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msglen > ssl->transform_in->minlen +
 4901              		.loc 4 4213 16 discriminator 1
 4902 01e6 488B45E8 		movq	-24(%rbp), %rax
 4903 01ea 488B90E0 		movq	224(%rax), %rdx
 4903      000000
 4904              		.loc 4 4213 33 discriminator 1
 4905 01f1 488B45E8 		movq	-24(%rbp), %rax
 4906 01f5 488B4068 		movq	104(%rax), %rax
 4907              		.loc 4 4213 47 discriminator 1
 4908 01f9 488B4010 		movq	16(%rax), %rax
4214:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                              MBEDTLS_SSL_IN_CONTENT_LEN + 256 )
 4909              		.loc 4 4214 57 discriminator 1
 4910 01fd 4805803F 		addq	$16256, %rax
 4910      0000
4212:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msglen > ssl->transform_in->minlen +
 4911              		.loc 4 4212 59 discriminator 1
 4912 0203 4839C2   		cmpq	%rax, %rdx
 4913 0206 7607     		jbe	.L284
4215:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
4216:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad message length" ) );
4217:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_RECORD );
 4914              		.loc 4 4217 19
 4915 0208 B8008EFF 		movl	$-29184, %eax
 4915      FF
 4916 020d EB05     		jmp	.L286
 4917              	.L284:
4218:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
4219:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
4220:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4221:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4222:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 4918              		.loc 4 4222 11
 4919 020f B8000000 		movl	$0, %eax
 4919      00
 4920              	.L286:
4223:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 4921              		.loc 4 4223 1 discriminator 1
 4922 0214 488B7DF8 		movq	-8(%rbp), %rdi
 4923 0218 6448333C 		xorq	%fs:40, %rdi
 4923      25280000 
 4923      00
 4924 0221 7405     		je	.L287
 4925              		.loc 4 4223 1 is_stmt 0
 4926 0223 E8000000 		call	__stack_chk_fail@PLT
 4926      00
GAS LISTING /tmp/ccEn8xFO.s 			page 211


 4927              	.L287:
 4928 0228 C9       		leave
 4929              	.LCFI83:
 4930              		.cfi_def_cfa 7, 8
 4931 0229 C3       		ret
 4932              		.cfi_endproc
 4933              	.LFE46:
 4935              		.section	.text.ssl_prepare_record_content,"ax",@progbits
 4937              	ssl_prepare_record_content:
 4938              	.LFB47:
4224:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4225:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
4226:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * If applicable, decrypt (and decompress) record content
4227:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
4228:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_prepare_record_content( mbedtls_ssl_context *ssl )
4229:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 4939              		.loc 4 4229 1 is_stmt 1
 4940              		.cfi_startproc
 4941 0000 F30F1EFA 		endbr64
 4942 0004 55       		pushq	%rbp
 4943              	.LCFI84:
 4944              		.cfi_def_cfa_offset 16
 4945              		.cfi_offset 6, -16
 4946 0005 4889E5   		movq	%rsp, %rbp
 4947              	.LCFI85:
 4948              		.cfi_def_cfa_register 6
 4949 0008 4883EC20 		subq	$32, %rsp
 4950 000c 48897DE8 		movq	%rdi, -24(%rbp)
 4951              		.loc 4 4229 1
 4952 0010 64488B04 		movq	%fs:40, %rax
 4952      25280000 
 4952      00
 4953 0019 488945F8 		movq	%rax, -8(%rbp)
 4954 001d 31C0     		xorl	%eax, %eax
4230:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret, done = 0;
 4955              		.loc 4 4230 14
 4956 001f C745F000 		movl	$0, -16(%rbp)
 4956      000000
4231:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4232:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "input record from network",
4233:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                    ssl->in_hdr, mbedtls_ssl_hdr_len( ssl ) + ssl->in_msglen );
4234:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4235:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_HW_RECORD_ACCEL)
4236:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( mbedtls_ssl_hw_record_read != NULL )
4237:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4238:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "going for mbedtls_ssl_hw_record_read()" ) );
4239:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4240:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ret = mbedtls_ssl_hw_record_read( ssl );
4241:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ret != 0 && ret != MBEDTLS_ERR_SSL_HW_ACCEL_FALLTHROUGH )
4242:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
4243:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_hw_record_read", ret );
4244:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_HW_ACCEL_FAILED );
4245:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
4246:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4247:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ret == 0 )
4248:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             done = 1;
4249:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
GAS LISTING /tmp/ccEn8xFO.s 			page 212


4250:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_HW_RECORD_ACCEL */
4251:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( !done && ssl->transform_in != NULL )
 4957              		.loc 4 4251 7
 4958 0026 837DF000 		cmpl	$0, -16(%rbp)
 4959 002a 7541     		jne	.L289
 4960              		.loc 4 4251 21 discriminator 1
 4961 002c 488B45E8 		movq	-24(%rbp), %rax
 4962 0030 488B4068 		movq	104(%rax), %rax
 4963              		.loc 4 4251 15 discriminator 1
 4964 0034 4885C0   		testq	%rax, %rax
 4965 0037 7434     		je	.L289
4252:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4253:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = ssl_decrypt_buf( ssl ) ) != 0 )
 4966              		.loc 4 4253 21
 4967 0039 488B45E8 		movq	-24(%rbp), %rax
 4968 003d 4889C7   		movq	%rax, %rdi
 4969 0040 E8000000 		call	ssl_decrypt_buf
 4969      00
 4970 0045 8945F4   		movl	%eax, -12(%rbp)
 4971              		.loc 4 4253 11
 4972 0048 837DF400 		cmpl	$0, -12(%rbp)
 4973 004c 7405     		je	.L290
4254:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
4255:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "ssl_decrypt_buf", ret );
4256:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 4974              		.loc 4 4256 19
 4975 004e 8B45F4   		movl	-12(%rbp), %eax
 4976 0051 EB1F     		jmp	.L291
 4977              	.L290:
4257:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
4258:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4259:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "input payload after decrypt",
4260:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                        ssl->in_msg, ssl->in_msglen );
4261:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4262:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_msglen > MBEDTLS_SSL_IN_CONTENT_LEN )
 4978              		.loc 4 4262 16
 4979 0053 488B45E8 		movq	-24(%rbp), %rax
 4980 0057 488B80E0 		movq	224(%rax), %rax
 4980      000000
 4981              		.loc 4 4262 11
 4982 005e 483D803E 		cmpq	$16000, %rax
 4982      0000
 4983 0064 7607     		jbe	.L289
4263:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
4264:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad message length" ) );
4265:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_RECORD );
 4984              		.loc 4 4265 19
 4985 0066 B8008EFF 		movl	$-29184, %eax
 4985      FF
 4986 006b EB05     		jmp	.L291
 4987              	.L289:
4266:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
4267:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4268:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4269:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_ZLIB_SUPPORT)
4270:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->transform_in != NULL &&
4271:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->session_in->compression == MBEDTLS_SSL_COMPRESS_DEFLATE )
GAS LISTING /tmp/ccEn8xFO.s 			page 213


4272:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4273:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = ssl_decompress_buf( ssl ) ) != 0 )
4274:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
4275:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "ssl_decompress_buf", ret );
4276:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
4277:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
4278:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4279:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_ZLIB_SUPPORT */
4280:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4281:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_ANTI_REPLAY)
4282:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
4283:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4284:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_dtls_replay_update( ssl );
4285:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4286:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
4287:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4288:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 4988              		.loc 4 4288 11
 4989 006d B8000000 		movl	$0, %eax
 4989      00
 4990              	.L291:
4289:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 4991              		.loc 4 4289 1
 4992 0072 488B55F8 		movq	-8(%rbp), %rdx
 4993 0076 64483314 		xorq	%fs:40, %rdx
 4993      25280000 
 4993      00
 4994 007f 7405     		je	.L292
 4995 0081 E8000000 		call	__stack_chk_fail@PLT
 4995      00
 4996              	.L292:
 4997 0086 C9       		leave
 4998              	.LCFI86:
 4999              		.cfi_def_cfa 7, 8
 5000 0087 C3       		ret
 5001              		.cfi_endproc
 5002              	.LFE47:
 5004              		.section	.text.mbedtls_ssl_read_record,"ax",@progbits
 5005              		.globl	mbedtls_ssl_read_record
 5007              	mbedtls_ssl_read_record:
 5008              	.LFB48:
4290:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4291:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_handshake_wrapup_free_hs_transform( mbedtls_ssl_context *ssl );
4292:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4293:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
4294:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Read a record.
4295:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
4296:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Silently ignore non-fatal alert (and for DTLS, invalid records as well,
4297:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * RFC 6347 4.1.2.7) and continue reading until a valid record is found.
4298:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
4299:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
4300:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4301:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /* Helper functions for mbedtls_ssl_read_record(). */
4302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_consume_current_message( mbedtls_ssl_context *ssl );
4303:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_get_next_record( mbedtls_ssl_context *ssl );
4304:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_record_is_in_progress( mbedtls_ssl_context *ssl );
4305:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 214


4306:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_read_record( mbedtls_ssl_context *ssl,
4307:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                              unsigned update_hs_digest )
4308:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 5009              		.loc 4 4308 1
 5010              		.cfi_startproc
 5011 0000 F30F1EFA 		endbr64
 5012 0004 55       		pushq	%rbp
 5013              	.LCFI87:
 5014              		.cfi_def_cfa_offset 16
 5015              		.cfi_offset 6, -16
 5016 0005 4889E5   		movq	%rsp, %rbp
 5017              	.LCFI88:
 5018              		.cfi_def_cfa_register 6
 5019 0008 4883EC20 		subq	$32, %rsp
 5020 000c 48897DE8 		movq	%rdi, -24(%rbp)
 5021 0010 8975E4   		movl	%esi, -28(%rbp)
 5022              		.loc 4 4308 1
 5023 0013 64488B04 		movq	%fs:40, %rax
 5023      25280000 
 5023      00
 5024 001c 488945F8 		movq	%rax, -8(%rbp)
 5025 0020 31C0     		xorl	%eax, %eax
4309:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
4310:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4311:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> read record" ) );
4312:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4313:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->keep_current_message == 0 )
 5026              		.loc 4 4313 12
 5027 0022 488B45E8 		movq	-24(%rbp), %rax
 5028 0026 8B80FC00 		movl	252(%rax), %eax
 5028      0000
 5029              		.loc 4 4313 7
 5030 002c 85C0     		testl	%eax, %eax
 5031 002e 0F85A200 		jne	.L294
 5031      0000
 5032              	.L300:
4314:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4315:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         do {
4316:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4317:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ret = ssl_consume_current_message( ssl );
 5033              		.loc 4 4317 19
 5034 0034 488B45E8 		movq	-24(%rbp), %rax
 5035 0038 4889C7   		movq	%rax, %rdi
 5036 003b E8000000 		call	ssl_consume_current_message
 5036      00
 5037 0040 8945F4   		movl	%eax, -12(%rbp)
4318:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ret != 0 )
 5038              		.loc 4 4318 15
 5039 0043 837DF400 		cmpl	$0, -12(%rbp)
 5040 0047 7408     		je	.L295
4319:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( ret );
 5041              		.loc 4 4319 23
 5042 0049 8B45F4   		movl	-12(%rbp), %eax
 5043 004c E9980000 		jmp	.L296
 5043      00
 5044              	.L295:
4320:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 215


4321:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ssl_record_is_in_progress( ssl ) == 0 )
 5045              		.loc 4 4321 17
 5046 0051 488B45E8 		movq	-24(%rbp), %rax
 5047 0055 4889C7   		movq	%rax, %rdi
 5048 0058 E8000000 		call	ssl_record_is_in_progress
 5048      00
 5049              		.loc 4 4321 15
 5050 005d 85C0     		testl	%eax, %eax
 5051 005f 7523     		jne	.L297
4322:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
4323:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
4324:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 int have_buffered = 0;
4325:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4326:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 /* We only check for buffered messages if the
4327:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                  * current datagram is fully consumed. */
4328:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
4329:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ssl_next_record_is_in_datagram( ssl ) == 0 )
4330:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
4331:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     if( ssl_load_buffered_message( ssl ) == 0 )
4332:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         have_buffered = 1;
4333:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
4334:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4335:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( have_buffered == 0 )
4336:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
4337:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
4338:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ret = ssl_get_next_record( ssl );
 5052              		.loc 4 4338 27
 5053 0061 488B45E8 		movq	-24(%rbp), %rax
 5054 0065 4889C7   		movq	%rax, %rdi
 5055 0068 E8000000 		call	ssl_get_next_record
 5055      00
 5056 006d 8945F4   		movl	%eax, -12(%rbp)
4339:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     if( ret == MBEDTLS_ERR_SSL_CONTINUE_PROCESSING )
 5057              		.loc 4 4339 23
 5058 0070 817DF480 		cmpl	$-25984, -12(%rbp)
 5058      9AFFFF
 5059 0077 741C     		je	.L304
4340:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         continue;
4341:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4342:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     if( ret != 0 )
 5060              		.loc 4 4342 23
 5061 0079 837DF400 		cmpl	$0, -12(%rbp)
 5062 007d 7405     		je	.L297
4343:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     {
4344:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         MBEDTLS_SSL_DEBUG_RET( 1, ( "ssl_get_next_record" ), ret );
4345:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         return( ret );
 5063              		.loc 4 4345 31
 5064 007f 8B45F4   		movl	-12(%rbp), %eax
 5065 0082 EB65     		jmp	.L296
 5066              	.L297:
4346:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     }
4347:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
4348:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
4349:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4350:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ret = mbedtls_ssl_handle_message_type( ssl );
 5067              		.loc 4 4350 19
 5068 0084 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 216


 5069 0088 4889C7   		movq	%rax, %rdi
 5070 008b E8000000 		call	mbedtls_ssl_handle_message_type
 5070      00
 5071 0090 8945F4   		movl	%eax, -12(%rbp)
 5072 0093 EB01     		jmp	.L299
 5073              	.L304:
4340:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 5074              		.loc 4 4340 25
 5075 0095 90       		nop
 5076              	.L299:
4351:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4352:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
4353:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ret == MBEDTLS_ERR_SSL_EARLY_MESSAGE )
4354:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
4355:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 /* Buffer future message */
4356:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ret = ssl_buffer_message( ssl );
4357:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( ret != 0 )
4358:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     return( ret );
4359:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4360:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ret = MBEDTLS_ERR_SSL_CONTINUE_PROCESSING;
4361:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
4362:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
4363:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4364:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         } while( MBEDTLS_ERR_SSL_NON_FATAL           == ret  ||
4365:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                  MBEDTLS_ERR_SSL_CONTINUE_PROCESSING == ret );
 5077              		.loc 4 4365 18
 5078 0096 817DF480 		cmpl	$-26240, -12(%rbp)
 5078      99FFFF
 5079 009d 7495     		je	.L300
4364:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                  MBEDTLS_ERR_SSL_CONTINUE_PROCESSING == ret );
 5080              		.loc 4 4364 62
 5081 009f 817DF480 		cmpl	$-25984, -12(%rbp)
 5081      9AFFFF
 5082 00a6 748C     		je	.L300
4366:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4367:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( 0 != ret )
 5083              		.loc 4 4367 11
 5084 00a8 837DF400 		cmpl	$0, -12(%rbp)
 5085 00ac 7405     		je	.L301
4368:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
4369:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, ( "mbedtls_ssl_handle_message_type" ), ret );
4370:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 5086              		.loc 4 4370 19
 5087 00ae 8B45F4   		movl	-12(%rbp), %eax
 5088 00b1 EB36     		jmp	.L296
 5089              	.L301:
4371:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
4372:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4373:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_msgtype == MBEDTLS_SSL_MSG_HANDSHAKE &&
 5090              		.loc 4 4373 16
 5091 00b3 488B45E8 		movq	-24(%rbp), %rax
 5092 00b7 8B80D800 		movl	216(%rax), %eax
 5092      0000
 5093              		.loc 4 4373 11
 5094 00bd 83F816   		cmpl	$22, %eax
 5095 00c0 7522     		jne	.L302
 5096              		.loc 4 4373 58 discriminator 1
GAS LISTING /tmp/ccEn8xFO.s 			page 217


 5097 00c2 837DE401 		cmpl	$1, -28(%rbp)
 5098 00c6 751C     		jne	.L302
4374:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             update_hs_digest == 1 )
4375:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
4376:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_ssl_update_handshake_status( ssl );
 5099              		.loc 4 4376 13
 5100 00c8 488B45E8 		movq	-24(%rbp), %rax
 5101 00cc 4889C7   		movq	%rax, %rdi
 5102 00cf E8000000 		call	mbedtls_ssl_update_handshake_status
 5102      00
 5103 00d4 EB0E     		jmp	.L302
 5104              	.L294:
4377:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
4378:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4379:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
4380:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4381:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "reuse previously read message" ) );
4382:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->keep_current_message = 0;
 5105              		.loc 4 4382 35
 5106 00d6 488B45E8 		movq	-24(%rbp), %rax
 5107 00da C780FC00 		movl	$0, 252(%rax)
 5107      00000000 
 5107      0000
 5108              	.L302:
4383:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4384:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4385:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= read record" ) );
4386:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4387:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 5109              		.loc 4 4387 11
 5110 00e4 B8000000 		movl	$0, %eax
 5110      00
 5111              	.L296:
4388:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 5112              		.loc 4 4388 1
 5113 00e9 488B55F8 		movq	-8(%rbp), %rdx
 5114 00ed 64483314 		xorq	%fs:40, %rdx
 5114      25280000 
 5114      00
 5115 00f6 7405     		je	.L303
 5116 00f8 E8000000 		call	__stack_chk_fail@PLT
 5116      00
 5117              	.L303:
 5118 00fd C9       		leave
 5119              	.LCFI89:
 5120              		.cfi_def_cfa 7, 8
 5121 00fe C3       		ret
 5122              		.cfi_endproc
 5123              	.LFE48:
 5125              		.section	.text.ssl_consume_current_message,"ax",@progbits
 5127              	ssl_consume_current_message:
 5128              	.LFB49:
4389:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4390:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
4391:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_next_record_is_in_datagram( mbedtls_ssl_context *ssl )
4392:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
4393:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_left > ssl->next_record_offset )
GAS LISTING /tmp/ccEn8xFO.s 			page 218


4394:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 1 );
4395:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4396:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
4397:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
4398:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4399:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_load_buffered_message( mbedtls_ssl_context *ssl )
4400:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
4401:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_handshake_params * const hs = ssl->handshake;
4402:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_hs_buffer * hs_buf;
4403:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret = 0;
4404:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4405:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( hs == NULL )
4406:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( -1 );
4407:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4408:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> ssl_load_buffered_messsage" ) );
4409:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4410:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->state == MBEDTLS_SSL_CLIENT_CHANGE_CIPHER_SPEC ||
4411:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->state == MBEDTLS_SSL_SERVER_CHANGE_CIPHER_SPEC )
4412:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4413:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Check if we have seen a ChangeCipherSpec before.
4414:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * If yes, synthesize a CCS record. */
4415:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( !hs->buffering.seen_ccs )
4416:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
4417:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "CCS not seen in the current flight" ) );
4418:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ret = -1;
4419:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             goto exit;
4420:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
4421:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4422:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "Injecting buffered CCS message" ) );
4423:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_msgtype = MBEDTLS_SSL_MSG_CHANGE_CIPHER_SPEC;
4424:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_msglen = 1;
4425:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_msg[0] = 1;
4426:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4427:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* As long as they are equal, the exact value doesn't matter. */
4428:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_left            = 0;
4429:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->next_record_offset = 0;
4430:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4431:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         hs->buffering.seen_ccs = 0;
4432:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         goto exit;
4433:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4434:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4435:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_DEBUG_C)
4436:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Debug only */
4437:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4438:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         unsigned offset;
4439:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         for( offset = 1; offset < MBEDTLS_SSL_MAX_BUFFERED_HS; offset++ )
4440:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
4441:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             hs_buf = &hs->buffering.hs[offset];
4442:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( hs_buf->is_valid == 1 )
4443:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
4444:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 2, ( "Future message with sequence number %u %s buffered.",
4445:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             hs->in_msg_seq + offset,
4446:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             hs_buf->is_complete ? "fully" : "partially" ) );
4447:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
4448:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
4449:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4450:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_DEBUG_C */
GAS LISTING /tmp/ccEn8xFO.s 			page 219


4451:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4452:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Check if we have buffered and/or fully reassembled the
4453:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * next handshake message. */
4454:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     hs_buf = &hs->buffering.hs[0];
4455:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( hs_buf->is_valid == 1 ) && ( hs_buf->is_complete == 1 ) )
4456:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4457:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Synthesize a record containing the buffered HS message. */
4458:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         size_t msg_len = ( hs_buf->data[1] << 16 ) |
4459:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                          ( hs_buf->data[2] << 8  ) |
4460:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            hs_buf->data[3];
4461:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4462:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Double-check that we haven't accidentally buffered
4463:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * a message that doesn't fit into the input buffer. */
4464:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( msg_len + 12 > MBEDTLS_SSL_IN_CONTENT_LEN )
4465:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
4466:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
4467:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
4468:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
4469:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4470:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "Next handshake message has been buffered - load" ) );
4471:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 3, "Buffered handshake message (incl. header)",
4472:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                hs_buf->data, msg_len + 12 );
4473:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4474:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_msgtype = MBEDTLS_SSL_MSG_HANDSHAKE;
4475:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_hslen   = msg_len + 12;
4476:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_msglen  = msg_len + 12;
4477:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memcpy( ssl->in_msg, hs_buf->data, ssl->in_hslen );
4478:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4479:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ret = 0;
4480:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         goto exit;
4481:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4482:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
4483:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4484:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "Next handshake message %u not or only partially bufffered",
4485:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     hs->in_msg_seq ) );
4486:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4487:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4488:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ret = -1;
4489:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4490:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** exit:
4491:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4492:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= ssl_load_buffered_message" ) );
4493:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ret );
4494:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
4495:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4496:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_buffer_make_space( mbedtls_ssl_context *ssl,
4497:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   size_t desired )
4498:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
4499:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int offset;
4500:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_handshake_params * const hs = ssl->handshake;
4501:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "Attempt to free buffered messages to have %u bytes available",
4502:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 (unsigned) desired ) );
4503:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4504:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Get rid of future records epoch first, if such exist. */
4505:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_free_buffered_record( ssl );
4506:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4507:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Check if we have enough space available now. */
GAS LISTING /tmp/ccEn8xFO.s 			page 220


4508:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( desired <= ( MBEDTLS_SSL_DTLS_MAX_BUFFERING -
4509:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      hs->buffering.total_bytes_buffered ) )
4510:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4511:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "Enough space available after freeing future epoch record" ) );
4512:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
4513:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4514:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4515:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* We don't have enough space to buffer the next expected handshake
4516:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * message. Remove buffers used for future messages to gain space,
4517:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * starting with the most distant one. */
4518:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     for( offset = MBEDTLS_SSL_MAX_BUFFERED_HS - 1;
4519:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          offset >= 0; offset-- )
4520:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4521:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "Free buffering slot %d to make space for reassembly of next ha
4522:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     offset ) );
4523:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4524:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl_buffering_free_slot( ssl, (uint8_t) offset );
4525:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4526:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Check if we have enough space available now. */
4527:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( desired <= ( MBEDTLS_SSL_DTLS_MAX_BUFFERING -
4528:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                          hs->buffering.total_bytes_buffered ) )
4529:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
4530:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "Enough space available after freeing buffered HS messages"
4531:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( 0 );
4532:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
4533:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4534:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4535:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( -1 );
4536:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
4537:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4538:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_buffer_message( mbedtls_ssl_context *ssl )
4539:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
4540:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret = 0;
4541:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_handshake_params * const hs = ssl->handshake;
4542:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4543:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( hs == NULL )
4544:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
4545:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4546:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> ssl_buffer_message" ) );
4547:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4548:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     switch( ssl->in_msgtype )
4549:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4550:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_SSL_MSG_CHANGE_CIPHER_SPEC:
4551:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "Remember CCS message" ) );
4552:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4553:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             hs->buffering.seen_ccs = 1;
4554:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             break;
4555:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4556:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_SSL_MSG_HANDSHAKE:
4557:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
4558:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             unsigned recv_msg_seq_offset;
4559:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             unsigned recv_msg_seq = ( ssl->in_msg[4] << 8 ) | ssl->in_msg[5];
4560:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_ssl_hs_buffer *hs_buf;
4561:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             size_t msg_len = ssl->in_hslen - 12;
4562:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4563:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* We should never receive an old handshake
4564:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * message - double-check nonetheless. */
GAS LISTING /tmp/ccEn8xFO.s 			page 221


4565:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( recv_msg_seq < ssl->handshake->in_msg_seq )
4566:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
4567:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
4568:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
4569:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
4570:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4571:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             recv_msg_seq_offset = recv_msg_seq - ssl->handshake->in_msg_seq;
4572:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( recv_msg_seq_offset >= MBEDTLS_SSL_MAX_BUFFERED_HS )
4573:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
4574:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 /* Silently ignore -- message too far in the future */
4575:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 2,
4576:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                  ( "Ignore future HS message with sequence number %u, "
4577:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                    "buffering window %u - %u",
4578:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                    recv_msg_seq, ssl->handshake->in_msg_seq,
4579:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                    ssl->handshake->in_msg_seq + MBEDTLS_SSL_MAX_BUFFERED_HS - 1 ) );
4580:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4581:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 goto exit;
4582:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
4583:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4584:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "Buffering HS message with sequence number %u, offset %u ",
4585:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         recv_msg_seq, recv_msg_seq_offset ) );
4586:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4587:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             hs_buf = &hs->buffering.hs[ recv_msg_seq_offset ];
4588:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4589:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Check if the buffering for this seq nr has already commenced. */
4590:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( !hs_buf->is_valid )
4591:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
4592:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 size_t reassembly_buf_sz;
4593:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4594:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 hs_buf->is_fragmented =
4595:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ( ssl_hs_is_proper_fragment( ssl ) == 1 );
4596:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4597:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 /* We copy the message back into the input buffer
4598:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                  * after reassembly, so check that it's not too large.
4599:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                  * This is an implementation-specific limitation
4600:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                  * and not one from the standard, hence it is not
4601:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                  * checked in ssl_check_hs_header(). */
4602:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( msg_len + 12 > MBEDTLS_SSL_IN_CONTENT_LEN )
4603:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
4604:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     /* Ignore message */
4605:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     goto exit;
4606:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
4607:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4608:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 /* Check if we have enough space to buffer the message. */
4609:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( hs->buffering.total_bytes_buffered >
4610:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     MBEDTLS_SSL_DTLS_MAX_BUFFERING )
4611:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
4612:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
4613:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
4614:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
4615:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4616:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 reassembly_buf_sz = ssl_get_reassembly_buffer_size( msg_len,
4617:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                                        hs_buf->is_fragmented );
4618:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4619:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( reassembly_buf_sz > ( MBEDTLS_SSL_DTLS_MAX_BUFFERING -
4620:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                           hs->buffering.total_bytes_buffered ) )
4621:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
GAS LISTING /tmp/ccEn8xFO.s 			page 222


4622:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     if( recv_msg_seq_offset > 0 )
4623:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     {
4624:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         /* If we can't buffer a future message because
4625:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                          * of space limitations -- ignore. */
4626:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         MBEDTLS_SSL_DEBUG_MSG( 2, ( "Buffering of future message of size %u would e
4627:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                              (unsigned) msg_len, MBEDTLS_SSL_DTLS_MAX_BUFFERING,
4628:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                              (unsigned) hs->buffering.total_bytes_buffered ) );
4629:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         goto exit;
4630:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     }
4631:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     else
4632:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     {
4633:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         MBEDTLS_SSL_DEBUG_MSG( 2, ( "Buffering of future message of size %u would e
4634:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                              (unsigned) msg_len, MBEDTLS_SSL_DTLS_MAX_BUFFERING,
4635:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                              (unsigned) hs->buffering.total_bytes_buffered ) );
4636:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     }
4637:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4638:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     if( ssl_buffer_make_space( ssl, reassembly_buf_sz ) != 0 )
4639:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     {
4640:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         MBEDTLS_SSL_DEBUG_MSG( 2, ( "Reassembly of next message of size %u (%u with
4641:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                              (unsigned) msg_len,
4642:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                              (unsigned) reassembly_buf_sz,
4643:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                              MBEDTLS_SSL_DTLS_MAX_BUFFERING,
4644:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                              (unsigned) hs->buffering.total_bytes_buffered ) );
4645:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         ret = MBEDTLS_ERR_SSL_BUFFER_TOO_SMALL;
4646:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         goto exit;
4647:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     }
4648:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
4649:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4650:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 2, ( "initialize reassembly, total length = %d",
4651:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                             msg_len ) );
4652:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4653:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 hs_buf->data = mbedtls_calloc( 1, reassembly_buf_sz );
4654:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( hs_buf->data == NULL )
4655:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
4656:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ret = MBEDTLS_ERR_SSL_ALLOC_FAILED;
4657:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     goto exit;
4658:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
4659:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 hs_buf->data_len = reassembly_buf_sz;
4660:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4661:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 /* Prepare final header: copy msg_type, length and message_seq,
4662:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                  * then add standardised fragment_offset and fragment_length */
4663:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 memcpy( hs_buf->data, ssl->in_msg, 6 );
4664:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 memset( hs_buf->data + 6, 0, 3 );
4665:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 memcpy( hs_buf->data + 9, hs_buf->data + 1, 3 );
4666:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4667:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 hs_buf->is_valid = 1;
4668:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4669:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 hs->buffering.total_bytes_buffered += reassembly_buf_sz;
4670:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
4671:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else
4672:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
4673:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 /* Make sure msg_type and length are consistent */
4674:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( memcmp( hs_buf->data, ssl->in_msg, 4 ) != 0 )
4675:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
4676:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_MSG( 1, ( "Fragment header mismatch - ignore" ) );
4677:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     /* Ignore */
4678:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     goto exit;
GAS LISTING /tmp/ccEn8xFO.s 			page 223


4679:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
4680:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
4681:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4682:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( !hs_buf->is_complete )
4683:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
4684:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 size_t frag_len, frag_off;
4685:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 unsigned char * const msg = hs_buf->data + 12;
4686:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4687:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 /*
4688:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                  * Check and copy current fragment
4689:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                  */
4690:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4691:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 /* Validation of header fields already done in
4692:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                  * mbedtls_ssl_prepare_handshake_record(). */
4693:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 frag_off = ssl_get_hs_frag_off( ssl );
4694:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 frag_len = ssl_get_hs_frag_len( ssl );
4695:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4696:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 2, ( "adding fragment, offset = %d, length = %d",
4697:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                             frag_off, frag_len ) );
4698:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 memcpy( msg + frag_off, ssl->in_msg + 12, frag_len );
4699:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4700:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( hs_buf->is_fragmented )
4701:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
4702:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     unsigned char * const bitmask = msg + msg_len;
4703:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ssl_bitmask_set( bitmask, frag_off, frag_len );
4704:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     hs_buf->is_complete = ( ssl_bitmask_check( bitmask,
4705:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                                                msg_len ) == 0 );
4706:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
4707:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 else
4708:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
4709:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     hs_buf->is_complete = 1;
4710:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
4711:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4712:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 2, ( "message %scomplete",
4713:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    hs_buf->is_complete ? "" : "not yet " ) );
4714:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
4715:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4716:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             break;
4717:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
4718:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4719:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         default:
4720:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* We don't buffer other types of messages. */
4721:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             break;
4722:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4723:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4724:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** exit:
4725:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4726:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= ssl_buffer_message" ) );
4727:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ret );
4728:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
4729:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
4730:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4731:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_consume_current_message( mbedtls_ssl_context *ssl )
4732:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 5129              		.loc 4 4732 1
 5130              		.cfi_startproc
 5131 0000 F30F1EFA 		endbr64
GAS LISTING /tmp/ccEn8xFO.s 			page 224


 5132 0004 55       		pushq	%rbp
 5133              	.LCFI90:
 5134              		.cfi_def_cfa_offset 16
 5135              		.cfi_offset 6, -16
 5136 0005 4889E5   		movq	%rsp, %rbp
 5137              	.LCFI91:
 5138              		.cfi_def_cfa_register 6
 5139 0008 4883EC20 		subq	$32, %rsp
 5140 000c 48897DE8 		movq	%rdi, -24(%rbp)
 5141              		.loc 4 4732 1
 5142 0010 64488B04 		movq	%fs:40, %rax
 5142      25280000 
 5142      00
 5143 0019 488945F8 		movq	%rax, -8(%rbp)
 5144 001d 31C0     		xorl	%eax, %eax
4733:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
4734:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Consume last content-layer message and potentially
4735:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * update in_msglen which keeps track of the contents'
4736:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * consumption state.
4737:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *
4738:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * (1) Handshake messages:
4739:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     Remove last handshake message, move content
4740:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     and adapt in_msglen.
4741:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *
4742:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * (2) Alert messages:
4743:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     Consume whole record content, in_msglen = 0.
4744:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *
4745:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * (3) Change cipher spec:
4746:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     Consume whole record content, in_msglen = 0.
4747:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *
4748:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * (4) Application data:
4749:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     Don't do anything - the record layer provides
4750:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     the application data as a stream transport
4751:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     and consumes through mbedtls_ssl_read only.
4752:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *
4753:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
4754:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4755:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Case (1): Handshake messages */
4756:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_hslen != 0 )
 5145              		.loc 4 4756 12
 5146 001f 488B45E8 		movq	-24(%rbp), %rax
 5147 0023 488B80F0 		movq	240(%rax), %rax
 5147      000000
 5148              		.loc 4 4756 7
 5149 002a 4885C0   		testq	%rax, %rax
 5150 002d 0F84B500 		je	.L306
 5150      0000
4757:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4758:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Hard assertion to be sure that no application data
4759:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * is in flight, as corrupting ssl->in_msglen during
4760:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * ssl->in_offt != NULL is fatal. */
4761:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_offt != NULL )
 5151              		.loc 4 4761 16
 5152 0033 488B45E8 		movq	-24(%rbp), %rax
 5153 0037 488B80D0 		movq	208(%rax), %rax
 5153      000000
 5154              		.loc 4 4761 11
GAS LISTING /tmp/ccEn8xFO.s 			page 225


 5155 003e 4885C0   		testq	%rax, %rax
 5156 0041 740A     		je	.L307
4762:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
4763:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
4764:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 5157              		.loc 4 4764 19
 5158 0043 B80094FF 		movl	$-27648, %eax
 5158      FF
 5159 0048 E9C60000 		jmp	.L308
 5159      00
 5160              	.L307:
4765:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
4766:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4767:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
4768:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Get next Handshake message in the current record
4769:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
4770:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4771:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Notes:
4772:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * (1) in_hslen is not necessarily the size of the
4773:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          *     current handshake content: If DTLS handshake
4774:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          *     fragmentation is used, that's the fragment
4775:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          *     size instead. Using the total handshake message
4776:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          *     size here is faulty and should be changed at
4777:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          *     some point.
4778:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * (2) While it doesn't seem to cause problems, one
4779:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          *     has to be very careful not to assume that in_hslen
4780:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          *     is always <= in_msglen in a sensible communication.
4781:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          *     Again, it's wrong for DTLS handshake fragmentation.
4782:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          *     The following check is therefore mandatory, and
4783:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          *     should not be treated as a silently corrected assertion.
4784:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          *     Additionally, ssl->in_hslen might be arbitrarily out of
4785:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          *     bounds after handling a DTLS message with an unexpected
4786:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          *     sequence number, see mbedtls_ssl_prepare_handshake_record.
4787:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
4788:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_hslen < ssl->in_msglen )
 5161              		.loc 4 4788 16
 5162 004d 488B45E8 		movq	-24(%rbp), %rax
 5163 0051 488B90F0 		movq	240(%rax), %rdx
 5163      000000
 5164              		.loc 4 4788 32
 5165 0058 488B45E8 		movq	-24(%rbp), %rax
 5166 005c 488B80E0 		movq	224(%rax), %rax
 5166      000000
 5167              		.loc 4 4788 11
 5168 0063 4839C2   		cmpq	%rax, %rdx
 5169 0066 7360     		jnb	.L309
4789:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
4790:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msglen -= ssl->in_hslen;
 5170              		.loc 4 4790 28
 5171 0068 488B45E8 		movq	-24(%rbp), %rax
 5172 006c 488B90E0 		movq	224(%rax), %rdx
 5172      000000
 5173              		.loc 4 4790 34
 5174 0073 488B45E8 		movq	-24(%rbp), %rax
 5175 0077 488B80F0 		movq	240(%rax), %rax
 5175      000000
 5176              		.loc 4 4790 28
GAS LISTING /tmp/ccEn8xFO.s 			page 226


 5177 007e 4829C2   		subq	%rax, %rdx
 5178 0081 488B45E8 		movq	-24(%rbp), %rax
 5179 0085 488990E0 		movq	%rdx, 224(%rax)
 5179      000000
4791:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memmove( ssl->in_msg, ssl->in_msg + ssl->in_hslen,
 5180              		.loc 4 4791 13
 5181 008c 488B45E8 		movq	-24(%rbp), %rax
 5182 0090 488B90E0 		movq	224(%rax), %rdx
 5182      000000
 5183              		.loc 4 4791 38
 5184 0097 488B45E8 		movq	-24(%rbp), %rax
 5185 009b 488B88C8 		movq	200(%rax), %rcx
 5185      000000
 5186              		.loc 4 4791 52
 5187 00a2 488B45E8 		movq	-24(%rbp), %rax
 5188 00a6 488B80F0 		movq	240(%rax), %rax
 5188      000000
 5189              		.loc 4 4791 47
 5190 00ad 4801C1   		addq	%rax, %rcx
 5191              		.loc 4 4791 25
 5192 00b0 488B45E8 		movq	-24(%rbp), %rax
 5193 00b4 488B80C8 		movq	200(%rax), %rax
 5193      000000
 5194              		.loc 4 4791 13
 5195 00bb 4889CE   		movq	%rcx, %rsi
 5196 00be 4889C7   		movq	%rax, %rdi
 5197 00c1 E8000000 		call	memmove@PLT
 5197      00
 5198 00c6 EB0F     		jmp	.L310
 5199              	.L309:
4792:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      ssl->in_msglen );
4793:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4794:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_BUF( 4, "remaining content in record",
4795:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl->in_msg, ssl->in_msglen );
4796:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
4797:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else
4798:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
4799:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msglen = 0;
 5200              		.loc 4 4799 28
 5201 00c8 488B45E8 		movq	-24(%rbp), %rax
 5202 00cc 48C780E0 		movq	$0, 224(%rax)
 5202      00000000 
 5202      000000
 5203              	.L310:
4800:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
4801:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4802:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_hslen   = 0;
 5204              		.loc 4 4802 25
 5205 00d7 488B45E8 		movq	-24(%rbp), %rax
 5206 00db 48C780F0 		movq	$0, 240(%rax)
 5206      00000000 
 5206      000000
 5207 00e6 EB26     		jmp	.L311
 5208              	.L306:
4803:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4804:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Case (4): Application data */
4805:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else if( ssl->in_offt != NULL )
GAS LISTING /tmp/ccEn8xFO.s 			page 227


 5209              		.loc 4 4805 17
 5210 00e8 488B45E8 		movq	-24(%rbp), %rax
 5211 00ec 488B80D0 		movq	208(%rax), %rax
 5211      000000
 5212              		.loc 4 4805 12
 5213 00f3 4885C0   		testq	%rax, %rax
 5214 00f6 7407     		je	.L312
4806:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4807:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
 5215              		.loc 4 4807 15
 5216 00f8 B8000000 		movl	$0, %eax
 5216      00
 5217 00fd EB14     		jmp	.L308
 5218              	.L312:
4808:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4809:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Everything else (CCS & Alerts) */
4810:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
4811:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4812:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_msglen = 0;
 5219              		.loc 4 4812 24
 5220 00ff 488B45E8 		movq	-24(%rbp), %rax
 5221 0103 48C780E0 		movq	$0, 224(%rax)
 5221      00000000 
 5221      000000
 5222              	.L311:
4813:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4814:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4815:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 5223              		.loc 4 4815 11
 5224 010e B8000000 		movl	$0, %eax
 5224      00
 5225              	.L308:
4816:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 5226              		.loc 4 4816 1
 5227 0113 488B75F8 		movq	-8(%rbp), %rsi
 5228 0117 64483334 		xorq	%fs:40, %rsi
 5228      25280000 
 5228      00
 5229 0120 7405     		je	.L313
 5230 0122 E8000000 		call	__stack_chk_fail@PLT
 5230      00
 5231              	.L313:
 5232 0127 C9       		leave
 5233              	.LCFI92:
 5234              		.cfi_def_cfa 7, 8
 5235 0128 C3       		ret
 5236              		.cfi_endproc
 5237              	.LFE49:
 5239              		.section	.text.ssl_record_is_in_progress,"ax",@progbits
 5241              	ssl_record_is_in_progress:
 5242              	.LFB50:
4817:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4818:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_record_is_in_progress( mbedtls_ssl_context *ssl )
4819:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 5243              		.loc 4 4819 1
 5244              		.cfi_startproc
 5245 0000 F30F1EFA 		endbr64
GAS LISTING /tmp/ccEn8xFO.s 			page 228


 5246 0004 55       		pushq	%rbp
 5247              	.LCFI93:
 5248              		.cfi_def_cfa_offset 16
 5249              		.cfi_offset 6, -16
 5250 0005 4889E5   		movq	%rsp, %rbp
 5251              	.LCFI94:
 5252              		.cfi_def_cfa_register 6
 5253 0008 4883EC20 		subq	$32, %rsp
 5254 000c 48897DE8 		movq	%rdi, -24(%rbp)
 5255              		.loc 4 4819 1
 5256 0010 64488B04 		movq	%fs:40, %rax
 5256      25280000 
 5256      00
 5257 0019 488945F8 		movq	%rax, -8(%rbp)
 5258 001d 31C0     		xorl	%eax, %eax
4820:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_msglen > 0 )
 5259              		.loc 4 4820 12
 5260 001f 488B45E8 		movq	-24(%rbp), %rax
 5261 0023 488B80E0 		movq	224(%rax), %rax
 5261      000000
 5262              		.loc 4 4820 7
 5263 002a 4885C0   		testq	%rax, %rax
 5264 002d 7407     		je	.L315
4821:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 1 );
 5265              		.loc 4 4821 15
 5266 002f B8010000 		movl	$1, %eax
 5266      00
 5267 0034 EB05     		jmp	.L316
 5268              	.L315:
4822:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4823:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 5269              		.loc 4 4823 11
 5270 0036 B8000000 		movl	$0, %eax
 5270      00
 5271              	.L316:
4824:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 5272              		.loc 4 4824 1
 5273 003b 488B55F8 		movq	-8(%rbp), %rdx
 5274 003f 64483314 		xorq	%fs:40, %rdx
 5274      25280000 
 5274      00
 5275 0048 7405     		je	.L317
 5276 004a E8000000 		call	__stack_chk_fail@PLT
 5276      00
 5277              	.L317:
 5278 004f C9       		leave
 5279              	.LCFI95:
 5280              		.cfi_def_cfa 7, 8
 5281 0050 C3       		ret
 5282              		.cfi_endproc
 5283              	.LFE50:
 5285              		.section	.text.ssl_get_next_record,"ax",@progbits
 5287              	ssl_get_next_record:
 5288              	.LFB51:
4825:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4826:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
4827:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 229


4828:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_free_buffered_record( mbedtls_ssl_context *ssl )
4829:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
4830:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_handshake_params * const hs = ssl->handshake;
4831:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( hs == NULL )
4832:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return;
4833:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4834:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( hs->buffering.future_record.data != NULL )
4835:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4836:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         hs->buffering.total_bytes_buffered -=
4837:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             hs->buffering.future_record.len;
4838:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4839:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( hs->buffering.future_record.data );
4840:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         hs->buffering.future_record.data = NULL;
4841:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4842:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
4843:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4844:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_load_buffered_record( mbedtls_ssl_context *ssl )
4845:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
4846:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_handshake_params * const hs = ssl->handshake;
4847:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char * rec;
4848:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t rec_len;
4849:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned rec_epoch;
4850:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4851:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport != MBEDTLS_SSL_TRANSPORT_DATAGRAM )
4852:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
4853:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4854:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( hs == NULL )
4855:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
4856:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4857:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     rec       = hs->buffering.future_record.data;
4858:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     rec_len   = hs->buffering.future_record.len;
4859:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     rec_epoch = hs->buffering.future_record.epoch;
4860:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4861:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( rec == NULL )
4862:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
4863:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4864:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Only consider loading future records if the
4865:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * input buffer is empty. */
4866:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl_next_record_is_in_datagram( ssl ) == 1 )
4867:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
4868:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4869:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> ssl_load_buffered_record" ) );
4870:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4871:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( rec_epoch != ssl->in_epoch )
4872:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4873:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "Buffered record not from current epoch." ) );
4874:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         goto exit;
4875:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4876:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4877:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "Found buffered record from current epoch - load" ) );
4878:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4879:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Double-check that the record is not too large */
4880:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( rec_len > MBEDTLS_SSL_IN_BUFFER_LEN -
4881:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         (size_t)( ssl->in_hdr - ssl->in_buf ) )
4882:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4883:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
4884:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
GAS LISTING /tmp/ccEn8xFO.s 			page 230


4885:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4886:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4887:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( ssl->in_hdr, rec, rec_len );
4888:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->in_left = rec_len;
4889:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->next_record_offset = 0;
4890:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4891:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_free_buffered_record( ssl );
4892:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4893:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** exit:
4894:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= ssl_load_buffered_record" ) );
4895:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
4896:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
4897:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4898:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_buffer_future_record( mbedtls_ssl_context *ssl )
4899:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
4900:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_handshake_params * const hs = ssl->handshake;
4901:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t const rec_hdr_len = 13;
4902:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t const total_buf_sz = rec_hdr_len + ssl->in_msglen;
4903:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4904:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Don't buffer future records outside handshakes. */
4905:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( hs == NULL )
4906:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
4907:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4908:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Only buffer handshake records (we are only interested
4909:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * in Finished messages). */
4910:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_msgtype != MBEDTLS_SSL_MSG_HANDSHAKE )
4911:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
4912:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4913:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Don't buffer more than one future epoch record. */
4914:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( hs->buffering.future_record.data != NULL )
4915:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
4916:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4917:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Don't buffer record if there's not enough buffering space remaining. */
4918:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( total_buf_sz > ( MBEDTLS_SSL_DTLS_MAX_BUFFERING -
4919:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                          hs->buffering.total_bytes_buffered ) )
4920:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4921:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "Buffering of future epoch record of size %u would exceed the c
4922:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         (unsigned) total_buf_sz, MBEDTLS_SSL_DTLS_MAX_BUFFERING,
4923:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         (unsigned) hs->buffering.total_bytes_buffered ) );
4924:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
4925:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4926:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4927:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Buffer record */
4928:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "Buffer record from epoch %u",
4929:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 ssl->in_epoch + 1 ) );
4930:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "Buffered record", ssl->in_hdr,
4931:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            rec_hdr_len + ssl->in_msglen );
4932:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4933:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* ssl_parse_record_header() only considers records
4934:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * of the next epoch as candidates for buffering. */
4935:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     hs->buffering.future_record.epoch = ssl->in_epoch + 1;
4936:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     hs->buffering.future_record.len   = total_buf_sz;
4937:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4938:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     hs->buffering.future_record.data =
4939:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_calloc( 1, hs->buffering.future_record.len );
4940:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( hs->buffering.future_record.data == NULL )
4941:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
GAS LISTING /tmp/ccEn8xFO.s 			page 231


4942:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* If we run out of RAM trying to buffer a
4943:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * record from the next epoch, just ignore. */
4944:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
4945:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4946:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4947:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( hs->buffering.future_record.data, ssl->in_hdr, total_buf_sz );
4948:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4949:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     hs->buffering.total_bytes_buffered += total_buf_sz;
4950:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
4951:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
4952:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4953:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
4954:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4955:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_get_next_record( mbedtls_ssl_context *ssl )
4956:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 5289              		.loc 4 4956 1
 5290              		.cfi_startproc
 5291 0000 F30F1EFA 		endbr64
 5292 0004 55       		pushq	%rbp
 5293              	.LCFI96:
 5294              		.cfi_def_cfa_offset 16
 5295              		.cfi_offset 6, -16
 5296 0005 4889E5   		movq	%rsp, %rbp
 5297              	.LCFI97:
 5298              		.cfi_def_cfa_register 6
 5299 0008 4883EC20 		subq	$32, %rsp
 5300 000c 48897DE8 		movq	%rdi, -24(%rbp)
 5301              		.loc 4 4956 1
 5302 0010 64488B04 		movq	%fs:40, %rax
 5302      25280000 
 5302      00
 5303 0019 488945F8 		movq	%rax, -8(%rbp)
 5304 001d 31C0     		xorl	%eax, %eax
4957:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
4958:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4959:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
4960:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* We might have buffered a future record; if so,
4961:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * and if the epoch matches now, load it.
4962:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * On success, this call will set ssl->in_left to
4963:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * the length of the buffered record, so that
4964:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * the calls to ssl_fetch_input() below will
4965:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * essentially be no-ops. */
4966:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ret = ssl_load_buffered_record( ssl );
4967:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ret != 0 )
4968:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
4969:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
4970:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4971:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_ssl_fetch_input( ssl, mbedtls_ssl_hdr_len( ssl ) ) ) != 0 )
 5305              		.loc 4 4971 17
 5306 001f 488B45E8 		movq	-24(%rbp), %rax
 5307 0023 4889C7   		movq	%rax, %rdi
 5308 0026 E8000000 		call	mbedtls_ssl_hdr_len
 5308      00
 5309 002b 4889C2   		movq	%rax, %rdx
 5310 002e 488B45E8 		movq	-24(%rbp), %rax
 5311 0032 4889D6   		movq	%rdx, %rsi
 5312 0035 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/ccEn8xFO.s 			page 232


 5313 0038 E8000000 		call	mbedtls_ssl_fetch_input
 5313      00
 5314 003d 8945F4   		movl	%eax, -12(%rbp)
 5315              		.loc 4 4971 7
 5316 0040 837DF400 		cmpl	$0, -12(%rbp)
 5317 0044 7408     		je	.L319
4972:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4973:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_fetch_input", ret );
4974:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 5318              		.loc 4 4974 15
 5319 0046 8B45F4   		movl	-12(%rbp), %eax
 5320 0049 E9A10000 		jmp	.L320
 5320      00
 5321              	.L319:
4975:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
4976:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4977:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = ssl_parse_record_header( ssl ) ) != 0 )
 5322              		.loc 4 4977 17
 5323 004e 488B45E8 		movq	-24(%rbp), %rax
 5324 0052 4889C7   		movq	%rax, %rdi
 5325 0055 E8000000 		call	ssl_parse_record_header
 5325      00
 5326 005a 8945F4   		movl	%eax, -12(%rbp)
 5327              		.loc 4 4977 7
 5328 005d 837DF400 		cmpl	$0, -12(%rbp)
 5329 0061 7408     		je	.L321
4978:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
4979:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
4980:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
4981:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ret != MBEDTLS_ERR_SSL_CLIENT_RECONNECT )
4982:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
4983:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ret == MBEDTLS_ERR_SSL_EARLY_MESSAGE )
4984:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
4985:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ret = ssl_buffer_future_record( ssl );
4986:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( ret != 0 )
4987:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     return( ret );
4988:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4989:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 /* Fall through to handling of unexpected records */
4990:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ret = MBEDTLS_ERR_SSL_UNEXPECTED_RECORD;
4991:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
4992:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4993:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ret == MBEDTLS_ERR_SSL_UNEXPECTED_RECORD )
4994:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
4995:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 /* Skip unexpected record (but not whole datagram) */
4996:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->next_record_offset = ssl->in_msglen
4997:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         + mbedtls_ssl_hdr_len( ssl );
4998:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
4999:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "discarding unexpected record "
5000:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                             "(header)" ) );
5001:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
5002:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else
5003:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
5004:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 /* Skip invalid record and the rest of the datagram */
5005:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->next_record_offset = 0;
5006:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->in_left = 0;
5007:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5008:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "discarding invalid record "
GAS LISTING /tmp/ccEn8xFO.s 			page 233


5009:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                             "(header)" ) );
5010:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
5011:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5012:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Get next record */
5013:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_CONTINUE_PROCESSING );
5014:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5015:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
5016:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 5330              		.loc 4 5016 15
 5331 0063 8B45F4   		movl	-12(%rbp), %eax
 5332 0066 E9840000 		jmp	.L320
 5332      00
 5333              	.L321:
5017:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5018:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5019:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
5020:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Read and optionally decrypt the message contents
5021:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
5022:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_ssl_fetch_input( ssl,
5023:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  mbedtls_ssl_hdr_len( ssl ) + ssl->in_msglen ) ) != 0 )
 5334              		.loc 4 5023 34
 5335 006b 488B45E8 		movq	-24(%rbp), %rax
 5336 006f 4889C7   		movq	%rax, %rdi
 5337 0072 E8000000 		call	mbedtls_ssl_hdr_len
 5337      00
 5338              		.loc 4 5023 66
 5339 0077 488B55E8 		movq	-24(%rbp), %rdx
 5340 007b 488B92E0 		movq	224(%rdx), %rdx
 5340      000000
5022:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  mbedtls_ssl_hdr_len( ssl ) + ssl->in_msglen ) ) != 0 )
 5341              		.loc 4 5022 17
 5342 0082 4801C2   		addq	%rax, %rdx
 5343 0085 488B45E8 		movq	-24(%rbp), %rax
 5344 0089 4889D6   		movq	%rdx, %rsi
 5345 008c 4889C7   		movq	%rax, %rdi
 5346 008f E8000000 		call	mbedtls_ssl_fetch_input
 5346      00
 5347 0094 8945F4   		movl	%eax, -12(%rbp)
5022:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  mbedtls_ssl_hdr_len( ssl ) + ssl->in_msglen ) ) != 0 )
 5348              		.loc 4 5022 7
 5349 0097 837DF400 		cmpl	$0, -12(%rbp)
 5350 009b 7405     		je	.L322
5024:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5025:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_fetch_input", ret );
5026:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 5351              		.loc 4 5026 15
 5352 009d 8B45F4   		movl	-12(%rbp), %eax
 5353 00a0 EB4D     		jmp	.L320
 5354              	.L322:
5027:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5028:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5029:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Done reading this record, get ready for the next one */
5030:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
5031:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
5032:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5033:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->next_record_offset = ssl->in_msglen + mbedtls_ssl_hdr_len( ssl );
5034:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->next_record_offset < ssl->in_left )
GAS LISTING /tmp/ccEn8xFO.s 			page 234


5035:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5036:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "more than one record within datagram" ) );
5037:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5038:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5039:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
5040:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
5041:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_left = 0;
 5355              		.loc 4 5041 22
 5356 00a2 488B45E8 		movq	-24(%rbp), %rax
 5357 00a6 48C780E8 		movq	$0, 232(%rax)
 5357      00000000 
 5357      000000
5042:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5043:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = ssl_prepare_record_content( ssl ) ) != 0 )
 5358              		.loc 4 5043 17
 5359 00b1 488B45E8 		movq	-24(%rbp), %rax
 5360 00b5 4889C7   		movq	%rax, %rdi
 5361 00b8 E8000000 		call	ssl_prepare_record_content
 5361      00
 5362 00bd 8945F4   		movl	%eax, -12(%rbp)
 5363              		.loc 4 5043 7
 5364 00c0 837DF400 		cmpl	$0, -12(%rbp)
 5365 00c4 7424     		je	.L323
5044:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5045:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
5046:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
5047:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5048:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Silently discard invalid records */
5049:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ret == MBEDTLS_ERR_SSL_INVALID_RECORD ||
5050:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ret == MBEDTLS_ERR_SSL_INVALID_MAC )
5051:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
5052:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 /* Except when waiting for Finished as a bad mac here
5053:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                  * probably means something went wrong in the handshake
5054:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                  * (eg wrong psk used, mitm downgrade attempt, etc.) */
5055:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( ssl->state == MBEDTLS_SSL_CLIENT_FINISHED ||
5056:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ssl->state == MBEDTLS_SSL_SERVER_FINISHED )
5057:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
5058:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_ALL_ALERT_MESSAGES)
5059:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     if( ret == MBEDTLS_ERR_SSL_INVALID_MAC )
5060:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     {
5061:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         mbedtls_ssl_send_alert_message( ssl,
5062:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 MBEDTLS_SSL_ALERT_LEVEL_FATAL,
5063:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 MBEDTLS_SSL_ALERT_MSG_BAD_RECORD_MAC );
5064:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     }
5065:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
5066:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     return( ret );
5067:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
5068:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5069:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_BADMAC_LIMIT)
5070:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( ssl->conf->badmac_limit != 0 &&
5071:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ++ssl->badmac_seen >= ssl->conf->badmac_limit )
5072:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
5073:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_MSG( 1, ( "too many records with bad MAC" ) );
5074:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     return( MBEDTLS_ERR_SSL_INVALID_MAC );
5075:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
5076:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
5077:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 235


5078:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 /* As above, invalid records cause
5079:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                  * dismissal of the whole datagram. */
5080:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5081:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->next_record_offset = 0;
5082:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->in_left = 0;
5083:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5084:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "discarding invalid record (mac)" ) );
5085:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_CONTINUE_PROCESSING );
5086:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
5087:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5088:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
5089:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5090:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else
5091:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
5092:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5093:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Error out (and send alert) on invalid records */
5094:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_ALL_ALERT_MESSAGES)
5095:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ret == MBEDTLS_ERR_SSL_INVALID_MAC )
 5366              		.loc 4 5095 15
 5367 00c6 817DF480 		cmpl	$-29056, -12(%rbp)
 5367      8EFFFF
 5368 00cd 7516     		jne	.L324
5096:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
5097:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 mbedtls_ssl_send_alert_message( ssl,
 5369              		.loc 4 5097 17
 5370 00cf 488B45E8 		movq	-24(%rbp), %rax
 5371 00d3 BA140000 		movl	$20, %edx
 5371      00
 5372 00d8 BE020000 		movl	$2, %esi
 5372      00
 5373 00dd 4889C7   		movq	%rax, %rdi
 5374 00e0 E8000000 		call	mbedtls_ssl_send_alert_message
 5374      00
 5375              	.L324:
5098:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         MBEDTLS_SSL_ALERT_LEVEL_FATAL,
5099:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         MBEDTLS_SSL_ALERT_MSG_BAD_RECORD_MAC );
5100:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
5101:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
5102:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 5376              		.loc 4 5102 19
 5377 00e5 8B45F4   		movl	-12(%rbp), %eax
 5378 00e8 EB05     		jmp	.L320
 5379              	.L323:
5103:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5104:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5105:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5106:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 5380              		.loc 4 5106 11
 5381 00ea B8000000 		movl	$0, %eax
 5381      00
 5382              	.L320:
5107:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 5383              		.loc 4 5107 1
 5384 00ef 488B4DF8 		movq	-8(%rbp), %rcx
 5385 00f3 6448330C 		xorq	%fs:40, %rcx
 5385      25280000 
 5385      00
GAS LISTING /tmp/ccEn8xFO.s 			page 236


 5386 00fc 7405     		je	.L325
 5387 00fe E8000000 		call	__stack_chk_fail@PLT
 5387      00
 5388              	.L325:
 5389 0103 C9       		leave
 5390              	.LCFI98:
 5391              		.cfi_def_cfa 7, 8
 5392 0104 C3       		ret
 5393              		.cfi_endproc
 5394              	.LFE51:
 5396              		.section	.text.mbedtls_ssl_handle_message_type,"ax",@progbits
 5397              		.globl	mbedtls_ssl_handle_message_type
 5399              	mbedtls_ssl_handle_message_type:
 5400              	.LFB52:
5108:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5109:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_handle_message_type( mbedtls_ssl_context *ssl )
5110:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 5401              		.loc 4 5110 1
 5402              		.cfi_startproc
 5403 0000 F30F1EFA 		endbr64
 5404 0004 55       		pushq	%rbp
 5405              	.LCFI99:
 5406              		.cfi_def_cfa_offset 16
 5407              		.cfi_offset 6, -16
 5408 0005 4889E5   		movq	%rsp, %rbp
 5409              	.LCFI100:
 5410              		.cfi_def_cfa_register 6
 5411 0008 4883EC20 		subq	$32, %rsp
 5412 000c 48897DE8 		movq	%rdi, -24(%rbp)
 5413              		.loc 4 5110 1
 5414 0010 64488B04 		movq	%fs:40, %rax
 5414      25280000 
 5414      00
 5415 0019 488945F8 		movq	%rax, -8(%rbp)
 5416 001d 31C0     		xorl	%eax, %eax
5111:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
5112:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5113:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
5114:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Handle particular types of records
5115:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
5116:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_msgtype == MBEDTLS_SSL_MSG_HANDSHAKE )
 5417              		.loc 4 5116 12
 5418 001f 488B45E8 		movq	-24(%rbp), %rax
 5419 0023 8B80D800 		movl	216(%rax), %eax
 5419      0000
 5420              		.loc 4 5116 7
 5421 0029 83F816   		cmpl	$22, %eax
 5422 002c 751D     		jne	.L327
5117:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5118:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_ssl_prepare_handshake_record( ssl ) ) != 0 )
 5423              		.loc 4 5118 21
 5424 002e 488B45E8 		movq	-24(%rbp), %rax
 5425 0032 4889C7   		movq	%rax, %rdi
 5426 0035 E8000000 		call	mbedtls_ssl_prepare_handshake_record
 5426      00
 5427 003a 8945F4   		movl	%eax, -12(%rbp)
 5428              		.loc 4 5118 11
GAS LISTING /tmp/ccEn8xFO.s 			page 237


 5429 003d 837DF400 		cmpl	$0, -12(%rbp)
 5430 0041 7408     		je	.L327
5119:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5120:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 5431              		.loc 4 5120 19
 5432 0043 8B45F4   		movl	-12(%rbp), %eax
 5433 0046 E9F70000 		jmp	.L328
 5433      00
 5434              	.L327:
5121:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5122:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5124:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_msgtype == MBEDTLS_SSL_MSG_CHANGE_CIPHER_SPEC )
 5435              		.loc 4 5124 12
 5436 004b 488B45E8 		movq	-24(%rbp), %rax
 5437 004f 8B80D800 		movl	216(%rax), %eax
 5437      0000
 5438              		.loc 4 5124 7
 5439 0055 83F814   		cmpl	$20, %eax
 5440 0058 7537     		jne	.L329
5125:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5126:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_msglen != 1 )
 5441              		.loc 4 5126 16
 5442 005a 488B45E8 		movq	-24(%rbp), %rax
 5443 005e 488B80E0 		movq	224(%rax), %rax
 5443      000000
 5444              		.loc 4 5126 11
 5445 0065 4883F801 		cmpq	$1, %rax
 5446 0069 740A     		je	.L330
5127:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5128:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "invalid CCS message, len: %d",
5129:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            ssl->in_msglen ) );
5130:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_RECORD );
 5447              		.loc 4 5130 19
 5448 006b B8008EFF 		movl	$-29184, %eax
 5448      FF
 5449 0070 E9CD0000 		jmp	.L328
 5449      00
 5450              	.L330:
5131:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5132:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5133:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_msg[0] != 1 )
 5451              		.loc 4 5133 16
 5452 0075 488B45E8 		movq	-24(%rbp), %rax
 5453 0079 488B80C8 		movq	200(%rax), %rax
 5453      000000
 5454              		.loc 4 5133 24
 5455 0080 0FB600   		movzbl	(%rax), %eax
 5456              		.loc 4 5133 11
 5457 0083 3C01     		cmpb	$1, %al
 5458 0085 740A     		je	.L329
5134:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5135:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "invalid CCS message, content: %02x",
5136:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         ssl->in_msg[0] ) );
5137:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_RECORD );
 5459              		.loc 4 5137 19
 5460 0087 B8008EFF 		movl	$-29184, %eax
GAS LISTING /tmp/ccEn8xFO.s 			page 238


 5460      FF
 5461 008c E9B10000 		jmp	.L328
 5461      00
 5462              	.L329:
5138:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5139:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5140:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
5141:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
5142:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->state != MBEDTLS_SSL_CLIENT_CHANGE_CIPHER_SPEC    &&
5143:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->state != MBEDTLS_SSL_SERVER_CHANGE_CIPHER_SPEC )
5144:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5145:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ssl->handshake == NULL )
5146:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
5147:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "dropping ChangeCipherSpec outside handshake" ) );
5148:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_UNEXPECTED_RECORD );
5149:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
5150:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5151:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "received out-of-order ChangeCipherSpec - remember" ) );
5152:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_EARLY_MESSAGE );
5153:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5154:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
5155:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5156:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5157:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_msgtype == MBEDTLS_SSL_MSG_ALERT )
 5463              		.loc 4 5157 12
 5464 0091 488B45E8 		movq	-24(%rbp), %rax
 5465 0095 8B80D800 		movl	216(%rax), %eax
 5465      0000
 5466              		.loc 4 5157 7
 5467 009b 83F815   		cmpl	$21, %eax
 5468 009e 0F859900 		jne	.L331
 5468      0000
5158:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5159:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_msglen != 2 )
 5469              		.loc 4 5159 16
 5470 00a4 488B45E8 		movq	-24(%rbp), %rax
 5471 00a8 488B80E0 		movq	224(%rax), %rax
 5471      000000
 5472              		.loc 4 5159 11
 5473 00af 4883F802 		cmpq	$2, %rax
 5474 00b3 740A     		je	.L332
5160:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5161:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Note: Standard allows for more than one 2 byte alert
5162:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                to be packed in a single message, but Mbed TLS doesn't
5163:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                currently support this. */
5164:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "invalid alert message, len: %d",
5165:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            ssl->in_msglen ) );
5166:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_RECORD );
 5475              		.loc 4 5166 19
 5476 00b5 B8008EFF 		movl	$-29184, %eax
 5476      FF
 5477 00ba E9830000 		jmp	.L328
 5477      00
 5478              	.L332:
5167:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5168:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5169:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "got an alert message, type: [%d:%d]",
GAS LISTING /tmp/ccEn8xFO.s 			page 239


5170:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                        ssl->in_msg[0], ssl->in_msg[1] ) );
5171:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5172:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
5173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Ignore non-fatal alerts, except close_notify and no_renegotiation
5174:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
5175:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_msg[0] == MBEDTLS_SSL_ALERT_LEVEL_FATAL )
 5479              		.loc 4 5175 16
 5480 00bf 488B45E8 		movq	-24(%rbp), %rax
 5481 00c3 488B80C8 		movq	200(%rax), %rax
 5481      000000
 5482              		.loc 4 5175 24
 5483 00ca 0FB600   		movzbl	(%rax), %eax
 5484              		.loc 4 5175 11
 5485 00cd 3C02     		cmpb	$2, %al
 5486 00cf 7507     		jne	.L333
5176:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5177:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "is a fatal alert message (msg %d)",
5178:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            ssl->in_msg[1] ) );
5179:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_FATAL_ALERT_MESSAGE );
 5487              		.loc 4 5179 19
 5488 00d1 B88088FF 		movl	$-30592, %eax
 5488      FF
 5489 00d6 EB6A     		jmp	.L328
 5490              	.L333:
5180:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5181:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5182:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_msg[0] == MBEDTLS_SSL_ALERT_LEVEL_WARNING &&
 5491              		.loc 4 5182 16
 5492 00d8 488B45E8 		movq	-24(%rbp), %rax
 5493 00dc 488B80C8 		movq	200(%rax), %rax
 5493      000000
 5494              		.loc 4 5182 24
 5495 00e3 0FB600   		movzbl	(%rax), %eax
 5496              		.loc 4 5182 11
 5497 00e6 3C01     		cmpb	$1, %al
 5498 00e8 751D     		jne	.L334
5183:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msg[1] == MBEDTLS_SSL_ALERT_MSG_CLOSE_NOTIFY )
 5499              		.loc 4 5183 16 discriminator 1
 5500 00ea 488B45E8 		movq	-24(%rbp), %rax
 5501 00ee 488B80C8 		movq	200(%rax), %rax
 5501      000000
 5502              		.loc 4 5183 24 discriminator 1
 5503 00f5 4883C001 		addq	$1, %rax
 5504 00f9 0FB600   		movzbl	(%rax), %eax
5182:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msg[1] == MBEDTLS_SSL_ALERT_MSG_CLOSE_NOTIFY )
 5505              		.loc 4 5182 63 discriminator 1
 5506 00fc 84C0     		testb	%al, %al
 5507 00fe 7507     		jne	.L334
5184:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5185:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "is a close notify message" ) );
5186:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_PEER_CLOSE_NOTIFY );
 5508              		.loc 4 5186 19
 5509 0100 B88087FF 		movl	$-30848, %eax
 5509      FF
 5510 0105 EB3B     		jmp	.L328
 5511              	.L334:
5187:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
GAS LISTING /tmp/ccEn8xFO.s 			page 240


5188:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5189:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION_ENABLED)
5190:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_msg[0] == MBEDTLS_SSL_ALERT_LEVEL_WARNING &&
 5512              		.loc 4 5190 16
 5513 0107 488B45E8 		movq	-24(%rbp), %rax
 5514 010b 488B80C8 		movq	200(%rax), %rax
 5514      000000
 5515              		.loc 4 5190 24
 5516 0112 0FB600   		movzbl	(%rax), %eax
 5517              		.loc 4 5190 11
 5518 0115 3C01     		cmpb	$1, %al
 5519 0117 751D     		jne	.L335
5191:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msg[1] == MBEDTLS_SSL_ALERT_MSG_NO_RENEGOTIATION )
 5520              		.loc 4 5191 16 discriminator 1
 5521 0119 488B45E8 		movq	-24(%rbp), %rax
 5522 011d 488B80C8 		movq	200(%rax), %rax
 5522      000000
 5523              		.loc 4 5191 24 discriminator 1
 5524 0124 4883C001 		addq	$1, %rax
 5525 0128 0FB600   		movzbl	(%rax), %eax
5190:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msg[1] == MBEDTLS_SSL_ALERT_MSG_NO_RENEGOTIATION )
 5526              		.loc 4 5190 63 discriminator 1
 5527 012b 3C64     		cmpb	$100, %al
 5528 012d 7507     		jne	.L335
5192:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5193:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "is a SSLv3 no renegotiation alert" ) );
5194:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Will be handled when trying to parse ServerHello */
5195:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( 0 );
 5529              		.loc 4 5195 19
 5530 012f B8000000 		movl	$0, %eax
 5530      00
 5531 0134 EB0C     		jmp	.L328
 5532              	.L335:
5196:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5197:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
5198:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5199:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) && defined(MBEDTLS_SSL_SRV_C)
5200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 &&
5201:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER &&
5202:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msg[0] == MBEDTLS_SSL_ALERT_LEVEL_WARNING &&
5203:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msg[1] == MBEDTLS_SSL_ALERT_MSG_NO_CERT )
5204:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5205:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "is a SSLv3 no_cert" ) );
5206:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Will be handled in mbedtls_ssl_parse_certificate() */
5207:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( 0 );
5208:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5209:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 && MBEDTLS_SSL_SRV_C */
5210:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5211:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Silently ignore: fetch new message */
5212:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return MBEDTLS_ERR_SSL_NON_FATAL;
 5533              		.loc 4 5212 16
 5534 0136 B88099FF 		movl	$-26240, %eax
 5534      FF
 5535 013b EB05     		jmp	.L328
 5536              	.L331:
5213:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5214:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 241


5215:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
5216:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
5217:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake != NULL &&
5218:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->state == MBEDTLS_SSL_HANDSHAKE_OVER  )
5219:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5220:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl_handshake_wrapup_free_hs_transform( ssl );
5221:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5222:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
5223:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5224:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 5537              		.loc 4 5224 11
 5538 013d B8000000 		movl	$0, %eax
 5538      00
 5539              	.L328:
5225:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 5540              		.loc 4 5225 1
 5541 0142 488B55F8 		movq	-8(%rbp), %rdx
 5542 0146 64483314 		xorq	%fs:40, %rdx
 5542      25280000 
 5542      00
 5543 014f 7405     		je	.L336
 5544 0151 E8000000 		call	__stack_chk_fail@PLT
 5544      00
 5545              	.L336:
 5546 0156 C9       		leave
 5547              	.LCFI101:
 5548              		.cfi_def_cfa 7, 8
 5549 0157 C3       		ret
 5550              		.cfi_endproc
 5551              	.LFE52:
 5553              		.section	.text.mbedtls_ssl_send_fatal_handshake_failure,"ax",@progbits
 5554              		.globl	mbedtls_ssl_send_fatal_handshake_failure
 5556              	mbedtls_ssl_send_fatal_handshake_failure:
 5557              	.LFB53:
5226:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5227:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_send_fatal_handshake_failure( mbedtls_ssl_context *ssl )
5228:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 5558              		.loc 4 5228 1
 5559              		.cfi_startproc
 5560 0000 F30F1EFA 		endbr64
 5561 0004 55       		pushq	%rbp
 5562              	.LCFI102:
 5563              		.cfi_def_cfa_offset 16
 5564              		.cfi_offset 6, -16
 5565 0005 4889E5   		movq	%rsp, %rbp
 5566              	.LCFI103:
 5567              		.cfi_def_cfa_register 6
 5568 0008 4883EC20 		subq	$32, %rsp
 5569 000c 48897DE8 		movq	%rdi, -24(%rbp)
 5570              		.loc 4 5228 1
 5571 0010 64488B04 		movq	%fs:40, %rax
 5571      25280000 
 5571      00
 5572 0019 488945F8 		movq	%rax, -8(%rbp)
 5573 001d 31C0     		xorl	%eax, %eax
5229:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
5230:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 242


5231:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_ssl_send_alert_message( ssl,
 5574              		.loc 4 5231 17
 5575 001f 488B45E8 		movq	-24(%rbp), %rax
 5576 0023 BA280000 		movl	$40, %edx
 5576      00
 5577 0028 BE020000 		movl	$2, %esi
 5577      00
 5578 002d 4889C7   		movq	%rax, %rdi
 5579 0030 E8000000 		call	mbedtls_ssl_send_alert_message
 5579      00
 5580 0035 8945F4   		movl	%eax, -12(%rbp)
 5581              		.loc 4 5231 7
 5582 0038 837DF400 		cmpl	$0, -12(%rbp)
 5583 003c 7405     		je	.L338
5232:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     MBEDTLS_SSL_ALERT_LEVEL_FATAL,
5233:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     MBEDTLS_SSL_ALERT_MSG_HANDSHAKE_FAILURE ) ) != 0 )
5234:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5235:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 5584              		.loc 4 5235 15
 5585 003e 8B45F4   		movl	-12(%rbp), %eax
 5586 0041 EB05     		jmp	.L339
 5587              	.L338:
5236:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5237:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5238:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 5588              		.loc 4 5238 11
 5589 0043 B8000000 		movl	$0, %eax
 5589      00
 5590              	.L339:
5239:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 5591              		.loc 4 5239 1
 5592 0048 488B4DF8 		movq	-8(%rbp), %rcx
 5593 004c 6448330C 		xorq	%fs:40, %rcx
 5593      25280000 
 5593      00
 5594 0055 7405     		je	.L340
 5595 0057 E8000000 		call	__stack_chk_fail@PLT
 5595      00
 5596              	.L340:
 5597 005c C9       		leave
 5598              	.LCFI104:
 5599              		.cfi_def_cfa 7, 8
 5600 005d C3       		ret
 5601              		.cfi_endproc
 5602              	.LFE53:
 5604              		.section	.text.mbedtls_ssl_send_alert_message,"ax",@progbits
 5605              		.globl	mbedtls_ssl_send_alert_message
 5607              	mbedtls_ssl_send_alert_message:
 5608              	.LFB54:
5240:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5241:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_send_alert_message( mbedtls_ssl_context *ssl,
5242:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             unsigned char level,
5243:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             unsigned char message )
5244:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 5609              		.loc 4 5244 1
 5610              		.cfi_startproc
 5611 0000 F30F1EFA 		endbr64
GAS LISTING /tmp/ccEn8xFO.s 			page 243


 5612 0004 55       		pushq	%rbp
 5613              	.LCFI105:
 5614              		.cfi_def_cfa_offset 16
 5615              		.cfi_offset 6, -16
 5616 0005 4889E5   		movq	%rsp, %rbp
 5617              	.LCFI106:
 5618              		.cfi_def_cfa_register 6
 5619 0008 4883EC20 		subq	$32, %rsp
 5620 000c 48897DE8 		movq	%rdi, -24(%rbp)
 5621 0010 89F1     		movl	%esi, %ecx
 5622 0012 89D0     		movl	%edx, %eax
 5623 0014 89CA     		movl	%ecx, %edx
 5624 0016 8855E4   		movb	%dl, -28(%rbp)
 5625 0019 8845E0   		movb	%al, -32(%rbp)
 5626              		.loc 4 5244 1
 5627 001c 64488B04 		movq	%fs:40, %rax
 5627      25280000 
 5627      00
 5628 0025 488945F8 		movq	%rax, -8(%rbp)
 5629 0029 31C0     		xorl	%eax, %eax
5245:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
5246:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5247:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl == NULL || ssl->conf == NULL )
 5630              		.loc 4 5247 7
 5631 002b 48837DE8 		cmpq	$0, -24(%rbp)
 5631      00
 5632 0030 740C     		je	.L342
 5633              		.loc 4 5247 27 discriminator 1
 5634 0032 488B45E8 		movq	-24(%rbp), %rax
 5635 0036 488B00   		movq	(%rax), %rax
 5636              		.loc 4 5247 21 discriminator 1
 5637 0039 4885C0   		testq	%rax, %rax
 5638 003c 7507     		jne	.L343
 5639              	.L342:
5248:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 5640              		.loc 4 5248 15
 5641 003e B8008FFF 		movl	$-28928, %eax
 5641      FF
 5642 0043 EB67     		jmp	.L344
 5643              	.L343:
5249:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5250:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> send alert message" ) );
5251:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "send alert level=%u message=%u", level, message ));
5252:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5253:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_msgtype = MBEDTLS_SSL_MSG_ALERT;
 5644              		.loc 4 5253 22
 5645 0045 488B45E8 		movq	-24(%rbp), %rax
 5646 0049 C7803001 		movl	$21, 304(%rax)
 5646      00001500 
 5646      0000
5254:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_msglen = 2;
 5647              		.loc 4 5254 21
 5648 0053 488B45E8 		movq	-24(%rbp), %rax
 5649 0057 48C78038 		movq	$2, 312(%rax)
 5649      01000002 
 5649      000000
5255:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_msg[0] = level;
GAS LISTING /tmp/ccEn8xFO.s 			page 244


 5650              		.loc 4 5255 8
 5651 0062 488B45E8 		movq	-24(%rbp), %rax
 5652 0066 488B8028 		movq	296(%rax), %rax
 5652      010000
 5653              		.loc 4 5255 21
 5654 006d 0FB655E4 		movzbl	-28(%rbp), %edx
 5655 0071 8810     		movb	%dl, (%rax)
5256:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_msg[1] = message;
 5656              		.loc 4 5256 8
 5657 0073 488B45E8 		movq	-24(%rbp), %rax
 5658 0077 488B8028 		movq	296(%rax), %rax
 5658      010000
 5659              		.loc 4 5256 17
 5660 007e 488D5001 		leaq	1(%rax), %rdx
 5661              		.loc 4 5256 21
 5662 0082 0FB645E0 		movzbl	-32(%rbp), %eax
 5663 0086 8802     		movb	%al, (%rdx)
5257:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5258:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_ssl_write_record( ssl, SSL_FORCE_FLUSH ) ) != 0 )
 5664              		.loc 4 5258 17
 5665 0088 488B45E8 		movq	-24(%rbp), %rax
 5666 008c BE010000 		movl	$1, %esi
 5666      00
 5667 0091 4889C7   		movq	%rax, %rdi
 5668 0094 E8000000 		call	mbedtls_ssl_write_record
 5668      00
 5669 0099 8945F4   		movl	%eax, -12(%rbp)
 5670              		.loc 4 5258 7
 5671 009c 837DF400 		cmpl	$0, -12(%rbp)
 5672 00a0 7405     		je	.L345
5259:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5260:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_write_record", ret );
5261:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 5673              		.loc 4 5261 15
 5674 00a2 8B45F4   		movl	-12(%rbp), %eax
 5675 00a5 EB05     		jmp	.L344
 5676              	.L345:
5262:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5263:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= send alert message" ) );
5264:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5265:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 5677              		.loc 4 5265 11
 5678 00a7 B8000000 		movl	$0, %eax
 5678      00
 5679              	.L344:
5266:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 5680              		.loc 4 5266 1
 5681 00ac 488B4DF8 		movq	-8(%rbp), %rcx
 5682 00b0 6448330C 		xorq	%fs:40, %rcx
 5682      25280000 
 5682      00
 5683 00b9 7405     		je	.L346
 5684 00bb E8000000 		call	__stack_chk_fail@PLT
 5684      00
 5685              	.L346:
 5686 00c0 C9       		leave
 5687              	.LCFI107:
GAS LISTING /tmp/ccEn8xFO.s 			page 245


 5688              		.cfi_def_cfa 7, 8
 5689 00c1 C3       		ret
 5690              		.cfi_endproc
 5691              	.LFE54:
 5693              		.section	.text.mbedtls_ssl_write_certificate,"ax",@progbits
 5694              		.globl	mbedtls_ssl_write_certificate
 5696              	mbedtls_ssl_write_certificate:
 5697              	.LFB55:
5267:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5268:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
5269:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Handshake functions
5270:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
5271:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if !defined(MBEDTLS_KEY_EXCHANGE_RSA_ENABLED)         && \
5272:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     !defined(MBEDTLS_KEY_EXCHANGE_RSA_PSK_ENABLED)     && \
5273:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     !defined(MBEDTLS_KEY_EXCHANGE_DHE_RSA_ENABLED)     && \
5274:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     !defined(MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED)   && \
5275:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     !defined(MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED) && \
5276:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     !defined(MBEDTLS_KEY_EXCHANGE_ECDH_RSA_ENABLED)    && \
5277:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     !defined(MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA_ENABLED)
5278:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /* No certificate support -> dummy functions */
5279:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_write_certificate( mbedtls_ssl_context *ssl )
5280:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
5281:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const mbedtls_ssl_ciphersuite_t *ciphersuite_info = ssl->transform_negotiate->ciphersuite_info;
5282:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5283:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> write certificate" ) );
5284:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5285:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_PSK ||
5286:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_DHE_PSK ||
5287:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_PSK ||
5288:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECJPAKE )
5289:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5290:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= skip write certificate" ) );
5291:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->state++;
5292:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
5293:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5294:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5295:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
5296:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
5297:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
5298:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5299:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_parse_certificate( mbedtls_ssl_context *ssl )
5300:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
5301:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const mbedtls_ssl_ciphersuite_t *ciphersuite_info = ssl->transform_negotiate->ciphersuite_info;
5302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5303:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> parse certificate" ) );
5304:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5305:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_PSK ||
5306:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_DHE_PSK ||
5307:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_PSK ||
5308:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECJPAKE )
5309:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5310:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= skip parse certificate" ) );
5311:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->state++;
5312:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
5313:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5314:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5315:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
GAS LISTING /tmp/ccEn8xFO.s 			page 246


5316:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
5317:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
5318:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5319:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #else
5320:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /* Some certificate support -> implement write and parse */
5321:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5322:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_write_certificate( mbedtls_ssl_context *ssl )
5323:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 5698              		.loc 4 5323 1
 5699              		.cfi_startproc
 5700 0000 F30F1EFA 		endbr64
 5701 0004 55       		pushq	%rbp
 5702              	.LCFI108:
 5703              		.cfi_def_cfa_offset 16
 5704              		.cfi_offset 6, -16
 5705 0005 4889E5   		movq	%rsp, %rbp
 5706              	.LCFI109:
 5707              		.cfi_def_cfa_register 6
 5708 0008 4883EC40 		subq	$64, %rsp
 5709 000c 48897DC8 		movq	%rdi, -56(%rbp)
 5710              		.loc 4 5323 1
 5711 0010 64488B04 		movq	%fs:40, %rax
 5711      25280000 
 5711      00
 5712 0019 488945F8 		movq	%rax, -8(%rbp)
 5713 001d 31C0     		xorl	%eax, %eax
5324:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret = MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE;
 5714              		.loc 4 5324 9
 5715 001f C745D480 		movl	$-28800, -44(%rbp)
 5715      8FFFFF
5325:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t i, n;
5326:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const mbedtls_x509_crt *crt;
5327:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const mbedtls_ssl_ciphersuite_t *ciphersuite_info = ssl->transform_negotiate->ciphersuite_info;
 5716              		.loc 4 5327 60
 5717 0026 488B45C8 		movq	-56(%rbp), %rax
 5718 002a 488B8080 		movq	128(%rax), %rax
 5718      000000
 5719              		.loc 4 5327 38
 5720 0031 488B00   		movq	(%rax), %rax
 5721 0034 488945E8 		movq	%rax, -24(%rbp)
5328:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5329:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> write certificate" ) );
5330:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5331:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_PSK ||
 5722              		.loc 4 5331 25
 5723 0038 488B45E8 		movq	-24(%rbp), %rax
 5724 003c 8B4018   		movl	24(%rax), %eax
 5725              		.loc 4 5331 7
 5726 003f 83F805   		cmpl	$5, %eax
 5727 0042 7424     		je	.L348
5332:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_DHE_PSK ||
 5728              		.loc 4 5332 25 discriminator 1
 5729 0044 488B45E8 		movq	-24(%rbp), %rax
 5730 0048 8B4018   		movl	24(%rax), %eax
5331:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_DHE_PSK ||
 5731              		.loc 4 5331 68 discriminator 1
 5732 004b 83F806   		cmpl	$6, %eax
GAS LISTING /tmp/ccEn8xFO.s 			page 247


 5733 004e 7418     		je	.L348
5333:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_PSK ||
 5734              		.loc 4 5333 25
 5735 0050 488B45E8 		movq	-24(%rbp), %rax
 5736 0054 8B4018   		movl	24(%rax), %eax
5332:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_DHE_PSK ||
 5737              		.loc 4 5332 72
 5738 0057 83F808   		cmpl	$8, %eax
 5739 005a 740C     		je	.L348
5334:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECJPAKE )
 5740              		.loc 4 5334 25
 5741 005c 488B45E8 		movq	-24(%rbp), %rax
 5742 0060 8B4018   		movl	24(%rax), %eax
5333:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_PSK ||
 5743              		.loc 4 5333 74
 5744 0063 83F80B   		cmpl	$11, %eax
 5745 0066 751B     		jne	.L349
 5746              	.L348:
5335:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5336:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= skip write certificate" ) );
5337:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->state++;
 5747              		.loc 4 5337 12
 5748 0068 488B45C8 		movq	-56(%rbp), %rax
 5749 006c 8B4008   		movl	8(%rax), %eax
 5750              		.loc 4 5337 19
 5751 006f 8D5001   		leal	1(%rax), %edx
 5752 0072 488B45C8 		movq	-56(%rbp), %rax
 5753 0076 895008   		movl	%edx, 8(%rax)
5338:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
 5754              		.loc 4 5338 15
 5755 0079 B8000000 		movl	$0, %eax
 5755      00
 5756 007e E9E50100 		jmp	.L350
 5756      00
 5757              	.L349:
5339:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5340:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5341:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
5342:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_CLIENT )
 5758              		.loc 4 5342 12
 5759 0083 488B45C8 		movq	-56(%rbp), %rax
 5760 0087 488B00   		movq	(%rax), %rax
 5761              		.loc 4 5342 29
 5762 008a 0FB680BC 		movzbl	188(%rax), %eax
 5762      000000
 5763 0091 83E001   		andl	$1, %eax
 5764              		.loc 4 5342 7
 5765 0094 84C0     		testb	%al, %al
 5766 0096 7529     		jne	.L351
5343:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5344:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->client_auth == 0 )
 5767              		.loc 4 5344 16
 5768 0098 488B45C8 		movq	-56(%rbp), %rax
 5769 009c 8B805001 		movl	336(%rax), %eax
 5769      0000
 5770              		.loc 4 5344 11
 5771 00a2 85C0     		testl	%eax, %eax
GAS LISTING /tmp/ccEn8xFO.s 			page 248


 5772 00a4 751B     		jne	.L351
5345:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5346:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= skip write certificate" ) );
5347:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->state++;
 5773              		.loc 4 5347 16
 5774 00a6 488B45C8 		movq	-56(%rbp), %rax
 5775 00aa 8B4008   		movl	8(%rax), %eax
 5776              		.loc 4 5347 23
 5777 00ad 8D5001   		leal	1(%rax), %edx
 5778 00b0 488B45C8 		movq	-56(%rbp), %rax
 5779 00b4 895008   		movl	%edx, 8(%rax)
5348:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( 0 );
 5780              		.loc 4 5348 19
 5781 00b7 B8000000 		movl	$0, %eax
 5781      00
 5782 00bc E9A70100 		jmp	.L350
 5782      00
 5783              	.L351:
5349:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5350:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5351:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
5352:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
5353:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * If using SSLv3 and got no cert, send an Alert message
5354:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * (otherwise an empty Certificate message will be sent).
5355:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
5356:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( mbedtls_ssl_own_cert( ssl )  == NULL &&
5357:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 )
5358:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5359:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->out_msglen  = 2;
5360:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->out_msgtype = MBEDTLS_SSL_MSG_ALERT;
5361:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->out_msg[0]  = MBEDTLS_SSL_ALERT_LEVEL_WARNING;
5362:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->out_msg[1]  = MBEDTLS_SSL_ALERT_MSG_NO_CERT;
5363:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5364:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "got no certificate to send" ) );
5365:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             goto write_msg;
5366:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5367:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 */
5368:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5369:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_CLI_C */
5370:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
5371:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER )
5372:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5373:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( mbedtls_ssl_own_cert( ssl ) == NULL )
5374:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5375:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "got no certificate to send" ) );
5376:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_CERTIFICATE_REQUIRED );
5377:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5378:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5379:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
5380:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5381:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_CRT( 3, "own certificate", mbedtls_ssl_own_cert( ssl ) );
5382:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5383:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
5384:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     0  .  0    handshake type
5385:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     1  .  3    handshake length
5386:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     4  .  6    length of all certs
5387:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     7  .  9    length of cert. 1
GAS LISTING /tmp/ccEn8xFO.s 			page 249


5388:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *    10  . n-1   peer certificate
5389:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     n  . n+2   length of cert. 2
5390:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *    n+3 . ...   upper level cert, etc.
5391:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
5392:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     i = 7;
 5784              		.loc 4 5392 7
 5785 00c1 48C745D8 		movq	$7, -40(%rbp)
 5785      07000000 
5393:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     crt = mbedtls_ssl_own_cert( ssl );
 5786              		.loc 4 5393 11
 5787 00c9 488B45C8 		movq	-56(%rbp), %rax
 5788 00cd 4889C7   		movq	%rax, %rdi
 5789 00d0 E8000000 		call	mbedtls_ssl_own_cert
 5789      00
 5790 00d5 488945E0 		movq	%rax, -32(%rbp)
5394:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5395:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     while( crt != NULL )
 5791              		.loc 4 5395 10
 5792 00d9 E9CC0000 		jmp	.L352
 5792      00
 5793              	.L354:
5396:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5397:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         n = crt->raw.len;
 5794              		.loc 4 5397 11
 5795 00de 488B45E0 		movq	-32(%rbp), %rax
 5796 00e2 488B4008 		movq	8(%rax), %rax
 5797 00e6 488945F0 		movq	%rax, -16(%rbp)
5398:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( n > MBEDTLS_SSL_OUT_CONTENT_LEN - 3 - i )
 5798              		.loc 4 5398 49
 5799 00ea B87D3E00 		movl	$15997, %eax
 5799      00
 5800 00ef 482B45D8 		subq	-40(%rbp), %rax
 5801              		.loc 4 5398 11
 5802 00f3 483945F0 		cmpq	%rax, -16(%rbp)
 5803 00f7 760A     		jbe	.L353
5399:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5400:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "certificate too large, %d > %d",
5401:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            i + 3 + n, MBEDTLS_SSL_OUT_CONTENT_LEN ) );
5402:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_CERTIFICATE_TOO_LARGE );
 5804              		.loc 4 5402 19
 5805 00f9 B8008BFF 		movl	$-29952, %eax
 5805      FF
 5806 00fe E9650100 		jmp	.L350
 5806      00
 5807              	.L353:
5403:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5404:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5405:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_msg[i    ] = (unsigned char)( n >> 16 );
 5808              		.loc 4 5405 50
 5809 0103 488B45F0 		movq	-16(%rbp), %rax
 5810 0107 48C1E810 		shrq	$16, %rax
 5811 010b 4889C1   		movq	%rax, %rcx
 5812              		.loc 4 5405 12
 5813 010e 488B45C8 		movq	-56(%rbp), %rax
 5814 0112 488B9028 		movq	296(%rax), %rdx
 5814      010000
 5815              		.loc 4 5405 21
GAS LISTING /tmp/ccEn8xFO.s 			page 250


 5816 0119 488B45D8 		movq	-40(%rbp), %rax
 5817 011d 4801D0   		addq	%rdx, %rax
 5818              		.loc 4 5405 31
 5819 0120 89CA     		movl	%ecx, %edx
 5820              		.loc 4 5405 29
 5821 0122 8810     		movb	%dl, (%rax)
5406:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_msg[i + 1] = (unsigned char)( n >>  8 );
 5822              		.loc 4 5406 50
 5823 0124 488B45F0 		movq	-16(%rbp), %rax
 5824 0128 48C1E808 		shrq	$8, %rax
 5825 012c 4889C1   		movq	%rax, %rcx
 5826              		.loc 4 5406 12
 5827 012f 488B45C8 		movq	-56(%rbp), %rax
 5828 0133 488B8028 		movq	296(%rax), %rax
 5828      010000
 5829              		.loc 4 5406 21
 5830 013a 488B55D8 		movq	-40(%rbp), %rdx
 5831 013e 4883C201 		addq	$1, %rdx
 5832 0142 4801D0   		addq	%rdx, %rax
 5833              		.loc 4 5406 31
 5834 0145 89CA     		movl	%ecx, %edx
 5835              		.loc 4 5406 29
 5836 0147 8810     		movb	%dl, (%rax)
5407:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_msg[i + 2] = (unsigned char)( n       );
 5837              		.loc 4 5407 12
 5838 0149 488B45C8 		movq	-56(%rbp), %rax
 5839 014d 488B8028 		movq	296(%rax), %rax
 5839      010000
 5840              		.loc 4 5407 21
 5841 0154 488B55D8 		movq	-40(%rbp), %rdx
 5842 0158 4883C202 		addq	$2, %rdx
 5843 015c 4801D0   		addq	%rdx, %rax
 5844              		.loc 4 5407 31
 5845 015f 488B55F0 		movq	-16(%rbp), %rdx
 5846              		.loc 4 5407 29
 5847 0163 8810     		movb	%dl, (%rax)
5408:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5409:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         i += 3; memcpy( ssl->out_msg + i, crt->raw.p, n );
 5848              		.loc 4 5409 11
 5849 0165 488345D8 		addq	$3, -40(%rbp)
 5849      03
 5850              		.loc 4 5409 51
 5851 016a 488B45E0 		movq	-32(%rbp), %rax
 5852 016e 488B4010 		movq	16(%rax), %rax
 5853              		.loc 4 5409 28
 5854 0172 488B55C8 		movq	-56(%rbp), %rdx
 5855 0176 488B8A28 		movq	296(%rdx), %rcx
 5855      010000
 5856              		.loc 4 5409 38
 5857 017d 488B55D8 		movq	-40(%rbp), %rdx
 5858 0181 4801D1   		addq	%rdx, %rcx
 5859              		.loc 4 5409 17
 5860 0184 488B55F0 		movq	-16(%rbp), %rdx
 5861 0188 4889C6   		movq	%rax, %rsi
 5862 018b 4889CF   		movq	%rcx, %rdi
 5863 018e E8000000 		call	memcpy@PLT
 5863      00
GAS LISTING /tmp/ccEn8xFO.s 			page 251


5410:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         i += n; crt = crt->next;
 5864              		.loc 4 5410 11
 5865 0193 488B45F0 		movq	-16(%rbp), %rax
 5866 0197 480145D8 		addq	%rax, -40(%rbp)
 5867              		.loc 4 5410 21
 5868 019b 488B45E0 		movq	-32(%rbp), %rax
 5869 019f 488B8020 		movq	544(%rax), %rax
 5869      020000
 5870 01a6 488945E0 		movq	%rax, -32(%rbp)
 5871              	.L352:
5395:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 5872              		.loc 4 5395 10
 5873 01aa 48837DE0 		cmpq	$0, -32(%rbp)
 5873      00
 5874 01af 0F8529FF 		jne	.L354
 5874      FFFF
5411:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5412:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5413:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_msg[4]  = (unsigned char)( ( i - 7 ) >> 16 );
 5875              		.loc 4 5413 45
 5876 01b5 488B45D8 		movq	-40(%rbp), %rax
 5877 01b9 4883E807 		subq	$7, %rax
 5878              		.loc 4 5413 51
 5879 01bd 48C1E810 		shrq	$16, %rax
 5880 01c1 4889C2   		movq	%rax, %rdx
 5881              		.loc 4 5413 8
 5882 01c4 488B45C8 		movq	-56(%rbp), %rax
 5883 01c8 488B8028 		movq	296(%rax), %rax
 5883      010000
 5884              		.loc 4 5413 17
 5885 01cf 4883C004 		addq	$4, %rax
 5886              		.loc 4 5413 22
 5887 01d3 8810     		movb	%dl, (%rax)
5414:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_msg[5]  = (unsigned char)( ( i - 7 ) >>  8 );
 5888              		.loc 4 5414 45
 5889 01d5 488B45D8 		movq	-40(%rbp), %rax
 5890 01d9 4883E807 		subq	$7, %rax
 5891              		.loc 4 5414 51
 5892 01dd 48C1E808 		shrq	$8, %rax
 5893 01e1 4889C2   		movq	%rax, %rdx
 5894              		.loc 4 5414 8
 5895 01e4 488B45C8 		movq	-56(%rbp), %rax
 5896 01e8 488B8028 		movq	296(%rax), %rax
 5896      010000
 5897              		.loc 4 5414 17
 5898 01ef 4883C005 		addq	$5, %rax
 5899              		.loc 4 5414 22
 5900 01f3 8810     		movb	%dl, (%rax)
5415:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_msg[6]  = (unsigned char)( ( i - 7 )       );
 5901              		.loc 4 5415 24
 5902 01f5 488B45D8 		movq	-40(%rbp), %rax
 5903 01f9 89C2     		movl	%eax, %edx
 5904              		.loc 4 5415 8
 5905 01fb 488B45C8 		movq	-56(%rbp), %rax
 5906 01ff 488B8028 		movq	296(%rax), %rax
 5906      010000
 5907              		.loc 4 5415 17
GAS LISTING /tmp/ccEn8xFO.s 			page 252


 5908 0206 4883C006 		addq	$6, %rax
 5909              		.loc 4 5415 24
 5910 020a 83EA07   		subl	$7, %edx
 5911              		.loc 4 5415 22
 5912 020d 8810     		movb	%dl, (%rax)
5416:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5417:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_msglen  = i;
 5913              		.loc 4 5417 22
 5914 020f 488B45C8 		movq	-56(%rbp), %rax
 5915 0213 488B55D8 		movq	-40(%rbp), %rdx
 5916 0217 48899038 		movq	%rdx, 312(%rax)
 5916      010000
5418:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_msgtype = MBEDTLS_SSL_MSG_HANDSHAKE;
 5917              		.loc 4 5418 22
 5918 021e 488B45C8 		movq	-56(%rbp), %rax
 5919 0222 C7803001 		movl	$22, 304(%rax)
 5919      00001600 
 5919      0000
5419:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_msg[0]  = MBEDTLS_SSL_HS_CERTIFICATE;
 5920              		.loc 4 5419 8
 5921 022c 488B45C8 		movq	-56(%rbp), %rax
 5922 0230 488B8028 		movq	296(%rax), %rax
 5922      010000
 5923              		.loc 4 5419 22
 5924 0237 C6000B   		movb	$11, (%rax)
5420:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5421:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) && defined(MBEDTLS_SSL_CLI_C)
5422:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** write_msg:
5423:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
5424:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5425:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->state++;
 5925              		.loc 4 5425 8
 5926 023a 488B45C8 		movq	-56(%rbp), %rax
 5927 023e 8B4008   		movl	8(%rax), %eax
 5928              		.loc 4 5425 15
 5929 0241 8D5001   		leal	1(%rax), %edx
 5930 0244 488B45C8 		movq	-56(%rbp), %rax
 5931 0248 895008   		movl	%edx, 8(%rax)
5426:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5427:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_ssl_write_handshake_msg( ssl ) ) != 0 )
 5932              		.loc 4 5427 17
 5933 024b 488B45C8 		movq	-56(%rbp), %rax
 5934 024f 4889C7   		movq	%rax, %rdi
 5935 0252 E8000000 		call	mbedtls_ssl_write_handshake_msg
 5935      00
 5936 0257 8945D4   		movl	%eax, -44(%rbp)
 5937              		.loc 4 5427 7
 5938 025a 837DD400 		cmpl	$0, -44(%rbp)
 5939 025e 7405     		je	.L355
5428:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5429:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_write_handshake_msg", ret );
5430:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 5940              		.loc 4 5430 15
 5941 0260 8B45D4   		movl	-44(%rbp), %eax
 5942 0263 EB03     		jmp	.L350
 5943              	.L355:
5431:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
GAS LISTING /tmp/ccEn8xFO.s 			page 253


5432:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5433:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= write certificate" ) );
5434:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5435:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ret );
 5944              		.loc 4 5435 11
 5945 0265 8B45D4   		movl	-44(%rbp), %eax
 5946              	.L350:
5436:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 5947              		.loc 4 5436 1
 5948 0268 488B75F8 		movq	-8(%rbp), %rsi
 5949 026c 64483334 		xorq	%fs:40, %rsi
 5949      25280000 
 5949      00
 5950 0275 7405     		je	.L356
 5951 0277 E8000000 		call	__stack_chk_fail@PLT
 5951      00
 5952              	.L356:
 5953 027c C9       		leave
 5954              	.LCFI110:
 5955              		.cfi_def_cfa 7, 8
 5956 027d C3       		ret
 5957              		.cfi_endproc
 5958              	.LFE55:
 5960              		.section	.text.ssl_parse_certificate_chain,"ax",@progbits
 5962              	ssl_parse_certificate_chain:
 5963              	.LFB56:
5437:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5438:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
5439:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Once the certificate message is read, parse it into a cert chain and
5440:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * perform basic checks, but leave actual verification to the caller
5441:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
5442:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_parse_certificate_chain( mbedtls_ssl_context *ssl )
5443:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 5964              		.loc 4 5443 1
 5965              		.cfi_startproc
 5966 0000 F30F1EFA 		endbr64
 5967 0004 55       		pushq	%rbp
 5968              	.LCFI111:
 5969              		.cfi_def_cfa_offset 16
 5970              		.cfi_offset 6, -16
 5971 0005 4889E5   		movq	%rsp, %rbp
 5972              	.LCFI112:
 5973              		.cfi_def_cfa_register 6
 5974 0008 53       		pushq	%rbx
 5975 0009 4883EC38 		subq	$56, %rsp
 5976              		.cfi_offset 3, -24
 5977 000d 48897DC8 		movq	%rdi, -56(%rbp)
 5978              		.loc 4 5443 1
 5979 0011 64488B04 		movq	%fs:40, %rax
 5979      25280000 
 5979      00
 5980 001a 488945E8 		movq	%rax, -24(%rbp)
 5981 001e 31C0     		xorl	%eax, %eax
5444:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
5445:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t i, n;
5446:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     uint8_t alert;
5447:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 254


5448:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
5449:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
5450:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
5451:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Check if the client sent an empty certificate
5452:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
5453:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->endpoint  == MBEDTLS_SSL_IS_SERVER &&
5454:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 )
5455:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5456:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_msglen  == 2                        &&
5457:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msgtype == MBEDTLS_SSL_MSG_ALERT            &&
5458:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msg[0]  == MBEDTLS_SSL_ALERT_LEVEL_WARNING  &&
5459:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msg[1]  == MBEDTLS_SSL_ALERT_MSG_NO_CERT )
5460:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5461:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "SSLv3 client has no certificate" ) );
5462:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5463:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* The client was asked for a certificate but didn't send
5464:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                one. The client should know what's going on, so we
5465:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                don't send an alert. */
5466:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->session_negotiate->verify_result = MBEDTLS_X509_BADCERT_MISSING;
5467:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_NO_CLIENT_CERTIFICATE );
5468:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5469:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5470:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 */
5471:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5472:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1) || \
5473:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_2)
5474:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->endpoint  == MBEDTLS_SSL_IS_SERVER &&
5475:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->minor_ver != MBEDTLS_SSL_MINOR_VERSION_0 )
5476:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5477:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_hslen   == 3 + mbedtls_ssl_hs_hdr_len( ssl ) &&
5478:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msgtype == MBEDTLS_SSL_MSG_HANDSHAKE    &&
5479:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msg[0]  == MBEDTLS_SSL_HS_CERTIFICATE   &&
5480:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcmp( ssl->in_msg + mbedtls_ssl_hs_hdr_len( ssl ), "\0\0\0", 3 ) == 0 )
5481:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5482:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "TLSv1 client has no certificate" ) );
5483:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5484:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* The client was asked for a certificate but didn't send
5485:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                one. The client should know what's going on, so we
5486:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                don't send an alert. */
5487:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->session_negotiate->verify_result = MBEDTLS_X509_BADCERT_MISSING;
5488:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_NO_CLIENT_CERTIFICATE );
5489:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5490:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5491:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1 || MBEDTLS_SSL_PROTO_TLS1_1 || \
5492:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****           MBEDTLS_SSL_PROTO_TLS1_2 */
5493:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_SRV_C */
5494:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5495:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_msgtype != MBEDTLS_SSL_MSG_HANDSHAKE )
 5982              		.loc 4 5495 12
 5983 0020 488B45C8 		movq	-56(%rbp), %rax
 5984 0024 8B80D800 		movl	216(%rax), %eax
 5984      0000
 5985              		.loc 4 5495 7
 5986 002a 83F816   		cmpl	$22, %eax
 5987 002d 7420     		je	.L358
5496:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5497:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad certificate message" ) );
GAS LISTING /tmp/ccEn8xFO.s 			page 255


5498:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 5988              		.loc 4 5498 9
 5989 002f 488B45C8 		movq	-56(%rbp), %rax
 5990 0033 BA0A0000 		movl	$10, %edx
 5990      00
 5991 0038 BE020000 		movl	$2, %esi
 5991      00
 5992 003d 4889C7   		movq	%rax, %rdi
 5993 0040 E8000000 		call	mbedtls_ssl_send_alert_message
 5993      00
5499:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_UNEXPECTED_MESSAGE );
5500:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
 5994              		.loc 4 5500 15
 5995 0045 B80089FF 		movl	$-30464, %eax
 5995      FF
 5996 004a E92D0400 		jmp	.L359
 5996      00
 5997              	.L358:
5501:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5502:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5503:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_msg[0] != MBEDTLS_SSL_HS_CERTIFICATE ||
 5998              		.loc 4 5503 12
 5999 004f 488B45C8 		movq	-56(%rbp), %rax
 6000 0053 488B80C8 		movq	200(%rax), %rax
 6000      000000
 6001              		.loc 4 5503 20
 6002 005a 0FB600   		movzbl	(%rax), %eax
 6003              		.loc 4 5503 7
 6004 005d 3C0B     		cmpb	$11, %al
 6005 005f 7520     		jne	.L360
5504:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_hslen < mbedtls_ssl_hs_hdr_len( ssl ) + 3 + 3 )
 6006              		.loc 4 5504 12 discriminator 1
 6007 0061 488B45C8 		movq	-56(%rbp), %rax
 6008 0065 488B98F0 		movq	240(%rax), %rbx
 6008      000000
 6009              		.loc 4 5504 25 discriminator 1
 6010 006c 488B45C8 		movq	-56(%rbp), %rax
 6011 0070 4889C7   		movq	%rax, %rdi
 6012 0073 E8000000 		call	mbedtls_ssl_hs_hdr_len
 6012      00
 6013              		.loc 4 5504 59 discriminator 1
 6014 0078 4883C006 		addq	$6, %rax
5503:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_hslen < mbedtls_ssl_hs_hdr_len( ssl ) + 3 + 3 )
 6015              		.loc 4 5503 54 discriminator 1
 6016 007c 4839C3   		cmpq	%rax, %rbx
 6017 007f 7320     		jnb	.L361
 6018              	.L360:
5505:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5506:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad certificate message" ) );
5507:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 6019              		.loc 4 5507 9
 6020 0081 488B45C8 		movq	-56(%rbp), %rax
 6021 0085 BA320000 		movl	$50, %edx
 6021      00
 6022 008a BE020000 		movl	$2, %esi
 6022      00
 6023 008f 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/ccEn8xFO.s 			page 256


 6024 0092 E8000000 		call	mbedtls_ssl_send_alert_message
 6024      00
5508:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
5509:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE );
 6025              		.loc 4 5509 15
 6026 0097 B80086FF 		movl	$-31232, %eax
 6026      FF
 6027 009c E9DB0300 		jmp	.L359
 6027      00
 6028              	.L361:
5510:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5511:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5512:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     i = mbedtls_ssl_hs_hdr_len( ssl );
 6029              		.loc 4 5512 9
 6030 00a1 488B45C8 		movq	-56(%rbp), %rax
 6031 00a5 4889C7   		movq	%rax, %rdi
 6032 00a8 E8000000 		call	mbedtls_ssl_hs_hdr_len
 6032      00
 6033 00ad 488945D8 		movq	%rax, -40(%rbp)
5513:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5514:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
5515:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Same message structure as in mbedtls_ssl_write_certificate()
5516:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
5517:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     n = ( ssl->in_msg[i+1] << 8 ) | ssl->in_msg[i+2];
 6034              		.loc 4 5517 14
 6035 00b1 488B45C8 		movq	-56(%rbp), %rax
 6036 00b5 488B80C8 		movq	200(%rax), %rax
 6036      000000
 6037              		.loc 4 5517 22
 6038 00bc 488B55D8 		movq	-40(%rbp), %rdx
 6039 00c0 4883C201 		addq	$1, %rdx
 6040 00c4 4801D0   		addq	%rdx, %rax
 6041 00c7 0FB600   		movzbl	(%rax), %eax
 6042 00ca 0FB6C0   		movzbl	%al, %eax
 6043              		.loc 4 5517 28
 6044 00cd C1E008   		sall	$8, %eax
 6045 00d0 89C1     		movl	%eax, %ecx
 6046              		.loc 4 5517 40
 6047 00d2 488B45C8 		movq	-56(%rbp), %rax
 6048 00d6 488B80C8 		movq	200(%rax), %rax
 6048      000000
 6049              		.loc 4 5517 48
 6050 00dd 488B55D8 		movq	-40(%rbp), %rdx
 6051 00e1 4883C202 		addq	$2, %rdx
 6052 00e5 4801D0   		addq	%rdx, %rax
 6053 00e8 0FB600   		movzbl	(%rax), %eax
 6054 00eb 0FB6C0   		movzbl	%al, %eax
 6055              		.loc 4 5517 35
 6056 00ee 09C8     		orl	%ecx, %eax
 6057              		.loc 4 5517 7
 6058 00f0 4898     		cltq
 6059 00f2 488945E0 		movq	%rax, -32(%rbp)
5518:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5519:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_msg[i] != 0 ||
 6060              		.loc 4 5519 12
 6061 00f6 488B45C8 		movq	-56(%rbp), %rax
 6062 00fa 488B90C8 		movq	200(%rax), %rdx
GAS LISTING /tmp/ccEn8xFO.s 			page 257


 6062      000000
 6063              		.loc 4 5519 20
 6064 0101 488B45D8 		movq	-40(%rbp), %rax
 6065 0105 4801D0   		addq	%rdx, %rax
 6066 0108 0FB600   		movzbl	(%rax), %eax
 6067              		.loc 4 5519 7
 6068 010b 84C0     		testb	%al, %al
 6069 010d 7527     		jne	.L362
5520:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_hslen != n + 3 + mbedtls_ssl_hs_hdr_len( ssl ) )
 6070              		.loc 4 5520 12 discriminator 1
 6071 010f 488B45C8 		movq	-56(%rbp), %rax
 6072 0113 488B98F0 		movq	240(%rax), %rbx
 6072      000000
 6073              		.loc 4 5520 34 discriminator 1
 6074 011a 488B45C8 		movq	-56(%rbp), %rax
 6075 011e 4889C7   		movq	%rax, %rdi
 6076 0121 E8000000 		call	mbedtls_ssl_hs_hdr_len
 6076      00
 6077              		.loc 4 5520 32 discriminator 1
 6078 0126 488B55E0 		movq	-32(%rbp), %rdx
 6079 012a 4801D0   		addq	%rdx, %rax
 6080 012d 4883C003 		addq	$3, %rax
5519:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_hslen != n + 3 + mbedtls_ssl_hs_hdr_len( ssl ) )
 6081              		.loc 4 5519 29 discriminator 1
 6082 0131 4839C3   		cmpq	%rax, %rbx
 6083 0134 7420     		je	.L363
 6084              	.L362:
5521:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5522:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad certificate message" ) );
5523:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 6085              		.loc 4 5523 9
 6086 0136 488B45C8 		movq	-56(%rbp), %rax
 6087 013a BA320000 		movl	$50, %edx
 6087      00
 6088 013f BE020000 		movl	$2, %esi
 6088      00
 6089 0144 4889C7   		movq	%rax, %rdi
 6090 0147 E8000000 		call	mbedtls_ssl_send_alert_message
 6090      00
5524:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
5525:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE );
 6091              		.loc 4 5525 15
 6092 014c B80086FF 		movl	$-31232, %eax
 6092      FF
 6093 0151 E9260300 		jmp	.L359
 6093      00
 6094              	.L363:
5526:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5527:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5528:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* In case we tried to reuse a session but it failed */
5529:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->session_negotiate->peer_cert != NULL )
 6095              		.loc 4 5529 12
 6096 0156 488B45C8 		movq	-56(%rbp), %rax
 6097 015a 488B4058 		movq	88(%rax), %rax
 6098              		.loc 4 5529 31
 6099 015e 488B4060 		movq	96(%rax), %rax
 6100              		.loc 4 5529 7
GAS LISTING /tmp/ccEn8xFO.s 			page 258


 6101 0162 4885C0   		testq	%rax, %rax
 6102 0165 7428     		je	.L364
5530:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5531:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_x509_crt_free( ssl->session_negotiate->peer_cert );
 6103              		.loc 4 5531 35
 6104 0167 488B45C8 		movq	-56(%rbp), %rax
 6105 016b 488B4058 		movq	88(%rax), %rax
 6106              		.loc 4 5531 9
 6107 016f 488B4060 		movq	96(%rax), %rax
 6108 0173 4889C7   		movq	%rax, %rdi
 6109 0176 E8000000 		call	mbedtls_x509_crt_free@PLT
 6109      00
5532:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( ssl->session_negotiate->peer_cert );
 6110              		.loc 4 5532 26
 6111 017b 488B45C8 		movq	-56(%rbp), %rax
 6112 017f 488B4058 		movq	88(%rax), %rax
 6113              		.loc 4 5532 45
 6114 0183 488B4060 		movq	96(%rax), %rax
 6115              		.loc 4 5532 9
 6116 0187 4889C7   		movq	%rax, %rdi
 6117 018a E8000000 		call	mbedtls_free@PLT
 6117      00
 6118              	.L364:
5533:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5534:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5535:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ssl->session_negotiate->peer_cert = mbedtls_calloc( 1,
 6119              		.loc 4 5535 14
 6120 018f 488B45C8 		movq	-56(%rbp), %rax
 6121 0193 488B5858 		movq	88(%rax), %rbx
 6122              		.loc 4 5535 47
 6123 0197 BE280200 		movl	$552, %esi
 6123      00
 6124 019c BF010000 		movl	$1, %edi
 6124      00
 6125 01a1 E8000000 		call	mbedtls_calloc@PLT
 6125      00
 6126              		.loc 4 5535 45
 6127 01a6 48894360 		movq	%rax, 96(%rbx)
 6128              		.loc 4 5535 33
 6129 01aa 488B4360 		movq	96(%rbx), %rax
 6130              		.loc 4 5535 7
 6131 01ae 4885C0   		testq	%rax, %rax
 6132 01b1 7520     		jne	.L365
5536:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     sizeof( mbedtls_x509_crt ) ) ) == NULL )
5537:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5538:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "alloc(%d bytes) failed",
5539:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                        sizeof( mbedtls_x509_crt ) ) );
5540:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 6133              		.loc 4 5540 9
 6134 01b3 488B45C8 		movq	-56(%rbp), %rax
 6135 01b7 BA500000 		movl	$80, %edx
 6135      00
 6136 01bc BE020000 		movl	$2, %esi
 6136      00
 6137 01c1 4889C7   		movq	%rax, %rdi
 6138 01c4 E8000000 		call	mbedtls_ssl_send_alert_message
 6138      00
GAS LISTING /tmp/ccEn8xFO.s 			page 259


5541:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_INTERNAL_ERROR );
5542:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
 6139              		.loc 4 5542 15
 6140 01c9 B80081FF 		movl	$-32512, %eax
 6140      FF
 6141 01ce E9A90200 		jmp	.L359
 6141      00
 6142              	.L365:
5543:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5544:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5545:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_x509_crt_init( ssl->session_negotiate->peer_cert );
 6143              		.loc 4 5545 31
 6144 01d3 488B45C8 		movq	-56(%rbp), %rax
 6145 01d7 488B4058 		movq	88(%rax), %rax
 6146              		.loc 4 5545 5
 6147 01db 488B4060 		movq	96(%rax), %rax
 6148 01df 4889C7   		movq	%rax, %rdi
 6149 01e2 E8000000 		call	mbedtls_x509_crt_init@PLT
 6149      00
5546:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5547:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     i += 3;
 6150              		.loc 4 5547 7
 6151 01e7 488345D8 		addq	$3, -40(%rbp)
 6151      03
5548:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5549:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     while( i < ssl->in_hslen )
 6152              		.loc 4 5549 10
 6153 01ec E9960100 		jmp	.L366
 6153      00
 6154              	.L377:
5550:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5551:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if ( i + 3 > ssl->in_hslen ) {
 6155              		.loc 4 5551 16
 6156 01f1 488B45D8 		movq	-40(%rbp), %rax
 6157 01f5 488D5003 		leaq	3(%rax), %rdx
 6158              		.loc 4 5551 25
 6159 01f9 488B45C8 		movq	-56(%rbp), %rax
 6160 01fd 488B80F0 		movq	240(%rax), %rax
 6160      000000
 6161              		.loc 4 5551 12
 6162 0204 4839C2   		cmpq	%rax, %rdx
 6163 0207 7620     		jbe	.L367
5552:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad certificate message" ) );
5553:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 6164              		.loc 4 5553 13
 6165 0209 488B45C8 		movq	-56(%rbp), %rax
 6166 020d BA320000 		movl	$50, %edx
 6166      00
 6167 0212 BE020000 		movl	$2, %esi
 6167      00
 6168 0217 4889C7   		movq	%rax, %rdi
 6169 021a E8000000 		call	mbedtls_ssl_send_alert_message
 6169      00
5554:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                            MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
5555:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE );
 6170              		.loc 4 5555 19
 6171 021f B80086FF 		movl	$-31232, %eax
GAS LISTING /tmp/ccEn8xFO.s 			page 260


 6171      FF
 6172 0224 E9530200 		jmp	.L359
 6172      00
 6173              	.L367:
5556:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5557:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_msg[i] != 0 )
 6174              		.loc 4 5557 16
 6175 0229 488B45C8 		movq	-56(%rbp), %rax
 6176 022d 488B90C8 		movq	200(%rax), %rdx
 6176      000000
 6177              		.loc 4 5557 24
 6178 0234 488B45D8 		movq	-40(%rbp), %rax
 6179 0238 4801D0   		addq	%rdx, %rax
 6180 023b 0FB600   		movzbl	(%rax), %eax
 6181              		.loc 4 5557 11
 6182 023e 84C0     		testb	%al, %al
 6183 0240 7420     		je	.L368
5558:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5559:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad certificate message" ) );
5560:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 6184              		.loc 4 5560 13
 6185 0242 488B45C8 		movq	-56(%rbp), %rax
 6186 0246 BA320000 		movl	$50, %edx
 6186      00
 6187 024b BE020000 		movl	$2, %esi
 6187      00
 6188 0250 4889C7   		movq	%rax, %rdi
 6189 0253 E8000000 		call	mbedtls_ssl_send_alert_message
 6189      00
5561:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                             MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
5562:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE );
 6190              		.loc 4 5562 19
 6191 0258 B80086FF 		movl	$-31232, %eax
 6191      FF
 6192 025d E91A0200 		jmp	.L359
 6192      00
 6193              	.L368:
5563:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5564:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5565:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         n = ( (unsigned int) ssl->in_msg[i + 1] << 8 )
 6194              		.loc 4 5565 33
 6195 0262 488B45C8 		movq	-56(%rbp), %rax
 6196 0266 488B80C8 		movq	200(%rax), %rax
 6196      000000
 6197              		.loc 4 5565 41
 6198 026d 488B55D8 		movq	-40(%rbp), %rdx
 6199 0271 4883C201 		addq	$1, %rdx
 6200 0275 4801D0   		addq	%rdx, %rax
 6201 0278 0FB600   		movzbl	(%rax), %eax
 6202              		.loc 4 5565 15
 6203 027b 0FB6C0   		movzbl	%al, %eax
 6204              		.loc 4 5565 49
 6205 027e C1E008   		sall	$8, %eax
 6206 0281 89C1     		movl	%eax, %ecx
5566:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             | (unsigned int) ssl->in_msg[i + 2];
 6207              		.loc 4 5566 33
 6208 0283 488B45C8 		movq	-56(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 261


 6209 0287 488B80C8 		movq	200(%rax), %rax
 6209      000000
 6210              		.loc 4 5566 41
 6211 028e 488B55D8 		movq	-40(%rbp), %rdx
 6212 0292 4883C202 		addq	$2, %rdx
 6213 0296 4801D0   		addq	%rdx, %rax
 6214 0299 0FB600   		movzbl	(%rax), %eax
 6215              		.loc 4 5566 15
 6216 029c 0FB6C0   		movzbl	%al, %eax
 6217              		.loc 4 5566 13
 6218 029f 09C8     		orl	%ecx, %eax
5565:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             | (unsigned int) ssl->in_msg[i + 2];
 6219              		.loc 4 5565 11
 6220 02a1 89C0     		movl	%eax, %eax
 6221 02a3 488945E0 		movq	%rax, -32(%rbp)
5567:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         i += 3;
 6222              		.loc 4 5567 11
 6223 02a7 488345D8 		addq	$3, -40(%rbp)
 6223      03
5568:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5569:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( n < 128 || i + n > ssl->in_hslen )
 6224              		.loc 4 5569 11
 6225 02ac 48837DE0 		cmpq	$127, -32(%rbp)
 6225      7F
 6226 02b1 761B     		jbe	.L369
 6227              		.loc 4 5569 26 discriminator 1
 6228 02b3 488B55D8 		movq	-40(%rbp), %rdx
 6229 02b7 488B45E0 		movq	-32(%rbp), %rax
 6230 02bb 4801C2   		addq	%rax, %rdx
 6231              		.loc 4 5569 35 discriminator 1
 6232 02be 488B45C8 		movq	-56(%rbp), %rax
 6233 02c2 488B80F0 		movq	240(%rax), %rax
 6233      000000
 6234              		.loc 4 5569 21 discriminator 1
 6235 02c9 4839C2   		cmpq	%rax, %rdx
 6236 02cc 7620     		jbe	.L370
 6237              	.L369:
5570:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5571:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad certificate message" ) );
5572:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 6238              		.loc 4 5572 13
 6239 02ce 488B45C8 		movq	-56(%rbp), %rax
 6240 02d2 BA320000 		movl	$50, %edx
 6240      00
 6241 02d7 BE020000 		movl	$2, %esi
 6241      00
 6242 02dc 4889C7   		movq	%rax, %rdi
 6243 02df E8000000 		call	mbedtls_ssl_send_alert_message
 6243      00
5573:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                             MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
5574:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE );
 6244              		.loc 4 5574 19
 6245 02e4 B80086FF 		movl	$-31232, %eax
 6245      FF
 6246 02e9 E98E0100 		jmp	.L359
 6246      00
 6247              	.L370:
GAS LISTING /tmp/ccEn8xFO.s 			page 262


5575:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5576:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5577:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ret = mbedtls_x509_crt_parse_der( ssl->session_negotiate->peer_cert,
5578:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   ssl->in_msg + i, n );
 6248              		.loc 4 5578 38
 6249 02ee 488B45C8 		movq	-56(%rbp), %rax
 6250 02f2 488B90C8 		movq	200(%rax), %rdx
 6250      000000
 6251              		.loc 4 5578 47
 6252 02f9 488B45D8 		movq	-40(%rbp), %rax
 6253 02fd 488D0C02 		leaq	(%rdx,%rax), %rcx
5577:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   ssl->in_msg + i, n );
 6254              		.loc 4 5577 46
 6255 0301 488B45C8 		movq	-56(%rbp), %rax
 6256 0305 488B4058 		movq	88(%rax), %rax
5577:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   ssl->in_msg + i, n );
 6257              		.loc 4 5577 15
 6258 0309 488B4060 		movq	96(%rax), %rax
 6259 030d 488B55E0 		movq	-32(%rbp), %rdx
 6260 0311 4889CE   		movq	%rcx, %rsi
 6261 0314 4889C7   		movq	%rax, %rdi
 6262 0317 E8000000 		call	mbedtls_x509_crt_parse_der@PLT
 6262      00
 6263 031c 8945D4   		movl	%eax, -44(%rbp)
5579:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         switch( ret )
 6264              		.loc 4 5579 9
 6265 031f 837DD400 		cmpl	$0, -44(%rbp)
 6266 0323 7459     		je	.L382
 6267 0325 837DD400 		cmpl	$0, -44(%rbp)
 6268 0329 7F32     		jg	.L372
 6269 032b 817DD480 		cmpl	$-9600, -44(%rbp)
 6269      DAFFFF
 6270 0332 7423     		je	.L373
 6271 0334 817DD480 		cmpl	$-9600, -44(%rbp)
 6271      DAFFFF
 6272 033b 7F20     		jg	.L372
 6273 033d 817DD480 		cmpl	$-10368, -44(%rbp)
 6273      D7FFFF
 6274 0344 740B     		je	.L374
 6275 0346 817DD4D2 		cmpl	$-9774, -44(%rbp)
 6275      D9FFFF
 6276 034d 750E     		jne	.L372
5580:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5581:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case 0: /*ok*/
5582:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_ERR_X509_UNKNOWN_SIG_ALG + MBEDTLS_ERR_OID_NOT_FOUND:
5583:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Ignore certificate with an unknown algorithm: maybe a
5584:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                prior certificate was already trusted. */
5585:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             break;
 6277              		.loc 4 5585 13
 6278 034f EB2D     		jmp	.L382
 6279              	.L374:
5586:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5587:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_ERR_X509_ALLOC_FAILED:
5588:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             alert = MBEDTLS_SSL_ALERT_MSG_INTERNAL_ERROR;
 6280              		.loc 4 5588 19
 6281 0351 C645D350 		movb	$80, -45(%rbp)
5589:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             goto crt_parse_der_failed;
GAS LISTING /tmp/ccEn8xFO.s 			page 263


 6282              		.loc 4 5589 13
 6283 0355 EB0A     		jmp	.L376
 6284              	.L373:
5590:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5591:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_ERR_X509_UNKNOWN_VERSION:
5592:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             alert = MBEDTLS_SSL_ALERT_MSG_UNSUPPORTED_CERT;
 6285              		.loc 4 5592 19
 6286 0357 C645D32B 		movb	$43, -45(%rbp)
5593:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             goto crt_parse_der_failed;
 6287              		.loc 4 5593 13
 6288 035b EB04     		jmp	.L376
 6289              	.L372:
5594:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5595:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         default:
5596:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             alert = MBEDTLS_SSL_ALERT_MSG_BAD_CERT;
 6290              		.loc 4 5596 19
 6291 035d C645D32A 		movb	$42, -45(%rbp)
 6292              	.L376:
5597:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         crt_parse_der_failed:
5598:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL, alert );
 6293              		.loc 4 5598 13
 6294 0361 0FB655D3 		movzbl	-45(%rbp), %edx
 6295 0365 488B45C8 		movq	-56(%rbp), %rax
 6296 0369 BE020000 		movl	$2, %esi
 6296      00
 6297 036e 4889C7   		movq	%rax, %rdi
 6298 0371 E8000000 		call	mbedtls_ssl_send_alert_message
 6298      00
5599:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, " mbedtls_x509_crt_parse_der", ret );
5600:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 6299              		.loc 4 5600 19
 6300 0376 8B45D4   		movl	-44(%rbp), %eax
 6301 0379 E9FE0000 		jmp	.L359
 6301      00
 6302              	.L382:
5585:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 6303              		.loc 4 5585 13
 6304 037e 90       		nop
5601:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5602:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5603:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         i += n;
 6305              		.loc 4 5603 11
 6306 037f 488B45E0 		movq	-32(%rbp), %rax
 6307 0383 480145D8 		addq	%rax, -40(%rbp)
 6308              	.L366:
5549:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 6309              		.loc 4 5549 19
 6310 0387 488B45C8 		movq	-56(%rbp), %rax
 6311 038b 488B80F0 		movq	240(%rax), %rax
 6311      000000
5549:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 6312              		.loc 4 5549 10
 6313 0392 483945D8 		cmpq	%rax, -40(%rbp)
 6314 0396 0F8255FE 		jb	.L377
 6314      FFFF
5604:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5605:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 264


5606:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_CRT( 3, "peer certificate", ssl->session_negotiate->peer_cert );
5607:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5608:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
5609:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * On client, make sure the server cert doesn't change during renego to
5610:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * avoid "triple handshake" attack: https://secure-resumption.com/
5611:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
5612:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION) && defined(MBEDTLS_SSL_CLI_C)
5613:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_CLIENT &&
 6315              		.loc 4 5613 12
 6316 039c 488B45C8 		movq	-56(%rbp), %rax
 6317 03a0 488B00   		movq	(%rax), %rax
 6318              		.loc 4 5613 29
 6319 03a3 0FB680BC 		movzbl	188(%rax), %eax
 6319      000000
 6320 03aa 83E001   		andl	$1, %eax
 6321              		.loc 4 5613 7
 6322 03ad 84C0     		testb	%al, %al
 6323 03af 0F85C200 		jne	.L378
 6323      0000
5614:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->renego_status == MBEDTLS_SSL_RENEGOTIATION_IN_PROGRESS )
 6324              		.loc 4 5614 12 discriminator 1
 6325 03b5 488B45C8 		movq	-56(%rbp), %rax
 6326 03b9 8B400C   		movl	12(%rax), %eax
5613:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->renego_status == MBEDTLS_SSL_RENEGOTIATION_IN_PROGRESS )
 6327              		.loc 4 5613 54 discriminator 1
 6328 03bc 83F801   		cmpl	$1, %eax
 6329 03bf 0F85B200 		jne	.L378
 6329      0000
5615:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5616:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->session->peer_cert == NULL )
 6330              		.loc 4 5616 16
 6331 03c5 488B45C8 		movq	-56(%rbp), %rax
 6332 03c9 488B4050 		movq	80(%rax), %rax
 6333              		.loc 4 5616 25
 6334 03cd 488B4060 		movq	96(%rax), %rax
 6335              		.loc 4 5616 11
 6336 03d1 4885C0   		testq	%rax, %rax
 6337 03d4 7520     		jne	.L379
5617:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5618:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "new server cert during renegotiation" ) );
5619:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 6338              		.loc 4 5619 13
 6339 03d6 488B45C8 		movq	-56(%rbp), %rax
 6340 03da BA310000 		movl	$49, %edx
 6340      00
 6341 03df BE020000 		movl	$2, %esi
 6341      00
 6342 03e4 4889C7   		movq	%rax, %rdi
 6343 03e7 E8000000 		call	mbedtls_ssl_send_alert_message
 6343      00
5620:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                             MBEDTLS_SSL_ALERT_MSG_ACCESS_DENIED );
5621:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE );
 6344              		.loc 4 5621 19
 6345 03ec B80086FF 		movl	$-31232, %eax
 6345      FF
 6346 03f1 E9860000 		jmp	.L359
 6346      00
GAS LISTING /tmp/ccEn8xFO.s 			page 265


 6347              	.L379:
5622:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5623:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5624:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->session->peer_cert->raw.len !=
 6348              		.loc 4 5624 16
 6349 03f6 488B45C8 		movq	-56(%rbp), %rax
 6350 03fa 488B4050 		movq	80(%rax), %rax
 6351              		.loc 4 5624 25
 6352 03fe 488B4060 		movq	96(%rax), %rax
 6353              		.loc 4 5624 41
 6354 0402 488B5008 		movq	8(%rax), %rdx
5625:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->session_negotiate->peer_cert->raw.len ||
 6355              		.loc 4 5625 16
 6356 0406 488B45C8 		movq	-56(%rbp), %rax
 6357 040a 488B4058 		movq	88(%rax), %rax
 6358              		.loc 4 5625 35
 6359 040e 488B4060 		movq	96(%rax), %rax
 6360              		.loc 4 5625 51
 6361 0412 488B4008 		movq	8(%rax), %rax
5624:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->session_negotiate->peer_cert->raw.len ||
 6362              		.loc 4 5624 11
 6363 0416 4839C2   		cmpq	%rax, %rdx
 6364 0419 753F     		jne	.L380
5626:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcmp( ssl->session->peer_cert->raw.p,
5627:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ssl->session_negotiate->peer_cert->raw.p,
5628:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ssl->session->peer_cert->raw.len ) != 0 )
 6365              		.loc 4 5628 24
 6366 041b 488B45C8 		movq	-56(%rbp), %rax
 6367 041f 488B4050 		movq	80(%rax), %rax
 6368              		.loc 4 5628 33
 6369 0423 488B4060 		movq	96(%rax), %rax
5626:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcmp( ssl->session->peer_cert->raw.p,
 6370              		.loc 4 5626 13
 6371 0427 488B5008 		movq	8(%rax), %rdx
5627:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ssl->session->peer_cert->raw.len ) != 0 )
 6372              		.loc 4 5627 24
 6373 042b 488B45C8 		movq	-56(%rbp), %rax
 6374 042f 488B4058 		movq	88(%rax), %rax
5627:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ssl->session->peer_cert->raw.len ) != 0 )
 6375              		.loc 4 5627 43
 6376 0433 488B4060 		movq	96(%rax), %rax
5627:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ssl->session->peer_cert->raw.len ) != 0 )
 6377              		.loc 4 5627 59
 6378 0437 488B4810 		movq	16(%rax), %rcx
5626:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcmp( ssl->session->peer_cert->raw.p,
 6379              		.loc 4 5626 24
 6380 043b 488B45C8 		movq	-56(%rbp), %rax
 6381 043f 488B4050 		movq	80(%rax), %rax
5626:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcmp( ssl->session->peer_cert->raw.p,
 6382              		.loc 4 5626 33
 6383 0443 488B4060 		movq	96(%rax), %rax
5626:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcmp( ssl->session->peer_cert->raw.p,
 6384              		.loc 4 5626 49
 6385 0447 488B4010 		movq	16(%rax), %rax
5626:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcmp( ssl->session->peer_cert->raw.p,
 6386              		.loc 4 5626 13
 6387 044b 4889CE   		movq	%rcx, %rsi
GAS LISTING /tmp/ccEn8xFO.s 			page 266


 6388 044e 4889C7   		movq	%rax, %rdi
 6389 0451 E8000000 		call	memcmp@PLT
 6389      00
5625:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             memcmp( ssl->session->peer_cert->raw.p,
 6390              		.loc 4 5625 56
 6391 0456 85C0     		testl	%eax, %eax
 6392 0458 741D     		je	.L378
 6393              	.L380:
5629:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5630:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "server cert changed during renegotiation" ) );
5631:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 6394              		.loc 4 5631 13
 6395 045a 488B45C8 		movq	-56(%rbp), %rax
 6396 045e BA310000 		movl	$49, %edx
 6396      00
 6397 0463 BE020000 		movl	$2, %esi
 6397      00
 6398 0468 4889C7   		movq	%rax, %rdi
 6399 046b E8000000 		call	mbedtls_ssl_send_alert_message
 6399      00
5632:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                             MBEDTLS_SSL_ALERT_MSG_ACCESS_DENIED );
5633:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE );
 6400              		.loc 4 5633 19
 6401 0470 B80086FF 		movl	$-31232, %eax
 6401      FF
 6402 0475 EB05     		jmp	.L359
 6403              	.L378:
5634:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5635:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5636:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_RENEGOTIATION && MBEDTLS_SSL_CLI_C */
5637:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5638:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 6404              		.loc 4 5638 11
 6405 0477 B8000000 		movl	$0, %eax
 6405      00
 6406              	.L359:
5639:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 6407              		.loc 4 5639 1
 6408 047c 488B5DE8 		movq	-24(%rbp), %rbx
 6409 0480 6448331C 		xorq	%fs:40, %rbx
 6409      25280000 
 6409      00
 6410 0489 7405     		je	.L381
 6411 048b E8000000 		call	__stack_chk_fail@PLT
 6411      00
 6412              	.L381:
 6413 0490 4883C438 		addq	$56, %rsp
 6414 0494 5B       		popq	%rbx
 6415 0495 5D       		popq	%rbp
 6416              	.LCFI113:
 6417              		.cfi_def_cfa 7, 8
 6418 0496 C3       		ret
 6419              		.cfi_endproc
 6420              	.LFE56:
 6422              		.section	.text.mbedtls_ssl_parse_certificate,"ax",@progbits
 6423              		.globl	mbedtls_ssl_parse_certificate
 6425              	mbedtls_ssl_parse_certificate:
GAS LISTING /tmp/ccEn8xFO.s 			page 267


 6426              	.LFB57:
5640:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5641:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_parse_certificate( mbedtls_ssl_context *ssl )
5642:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 6427              		.loc 4 5642 1
 6428              		.cfi_startproc
 6429 0000 F30F1EFA 		endbr64
 6430 0004 55       		pushq	%rbp
 6431              	.LCFI114:
 6432              		.cfi_def_cfa_offset 16
 6433              		.cfi_offset 6, -16
 6434 0005 4889E5   		movq	%rsp, %rbp
 6435              	.LCFI115:
 6436              		.cfi_def_cfa_register 6
 6437 0008 4883EC50 		subq	$80, %rsp
 6438 000c 48897DB8 		movq	%rdi, -72(%rbp)
 6439              		.loc 4 5642 1
 6440 0010 64488B04 		movq	%fs:40, %rax
 6440      25280000 
 6440      00
 6441 0019 488945F8 		movq	%rax, -8(%rbp)
 6442 001d 31C0     		xorl	%eax, %eax
5643:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
5644:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const mbedtls_ssl_ciphersuite_t * const ciphersuite_info =
5645:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****           ssl->transform_negotiate->ciphersuite_info;
 6443              		.loc 4 5645 14
 6444 001f 488B45B8 		movq	-72(%rbp), %rax
 6445 0023 488B8080 		movq	128(%rax), %rax
 6445      000000
5644:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****           ssl->transform_negotiate->ciphersuite_info;
 6446              		.loc 4 5644 45
 6447 002a 488B00   		movq	(%rax), %rax
 6448 002d 488945D0 		movq	%rax, -48(%rbp)
5646:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C) && defined(MBEDTLS_SSL_SERVER_NAME_INDICATION)
5647:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const int authmode = ssl->handshake->sni_authmode != MBEDTLS_SSL_VERIFY_UNSET
5648:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                        ? ssl->handshake->sni_authmode
5649:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                        : ssl->conf->authmode;
5650:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #else
5651:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const int authmode = ssl->conf->authmode;
 6449              		.loc 4 5651 29
 6450 0031 488B45B8 		movq	-72(%rbp), %rax
 6451 0035 488B00   		movq	(%rax), %rax
 6452              		.loc 4 5651 35
 6453 0038 0FB680BC 		movzbl	188(%rax), %eax
 6453      000000
 6454 003f C0E802   		shrb	$2, %al
 6455 0042 83E003   		andl	$3, %eax
 6456              		.loc 4 5651 15
 6457 0045 0FB6C0   		movzbl	%al, %eax
 6458 0048 8945CC   		movl	%eax, -52(%rbp)
5652:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
5653:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     void *rs_ctx = NULL;
 6459              		.loc 4 5653 11
 6460 004b 48C745D8 		movq	$0, -40(%rbp)
 6460      00000000 
5654:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5655:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> parse certificate" ) );
GAS LISTING /tmp/ccEn8xFO.s 			page 268


5656:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5657:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_PSK ||
 6461              		.loc 4 5657 25
 6462 0053 488B45D0 		movq	-48(%rbp), %rax
 6463 0057 8B4018   		movl	24(%rax), %eax
 6464              		.loc 4 5657 7
 6465 005a 83F805   		cmpl	$5, %eax
 6466 005d 7424     		je	.L384
5658:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_DHE_PSK ||
 6467              		.loc 4 5658 25 discriminator 1
 6468 005f 488B45D0 		movq	-48(%rbp), %rax
 6469 0063 8B4018   		movl	24(%rax), %eax
5657:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_DHE_PSK ||
 6470              		.loc 4 5657 68 discriminator 1
 6471 0066 83F806   		cmpl	$6, %eax
 6472 0069 7418     		je	.L384
5659:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_PSK ||
 6473              		.loc 4 5659 25
 6474 006b 488B45D0 		movq	-48(%rbp), %rax
 6475 006f 8B4018   		movl	24(%rax), %eax
5658:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_DHE_PSK ||
 6476              		.loc 4 5658 72
 6477 0072 83F808   		cmpl	$8, %eax
 6478 0075 740C     		je	.L384
5660:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECJPAKE )
 6479              		.loc 4 5660 25
 6480 0077 488B45D0 		movq	-48(%rbp), %rax
 6481 007b 8B4018   		movl	24(%rax), %eax
5659:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_PSK ||
 6482              		.loc 4 5659 74
 6483 007e 83F80B   		cmpl	$11, %eax
 6484 0081 751B     		jne	.L385
 6485              	.L384:
5661:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5662:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= skip parse certificate" ) );
5663:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->state++;
 6486              		.loc 4 5663 12
 6487 0083 488B45B8 		movq	-72(%rbp), %rax
 6488 0087 8B4008   		movl	8(%rax), %eax
 6489              		.loc 4 5663 19
 6490 008a 8D5001   		leal	1(%rax), %edx
 6491 008d 488B45B8 		movq	-72(%rbp), %rax
 6492 0091 895008   		movl	%edx, 8(%rax)
5664:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
 6493              		.loc 4 5664 15
 6494 0094 B8000000 		movl	$0, %eax
 6494      00
 6495 0099 E9270300 		jmp	.L386
 6495      00
 6496              	.L385:
5665:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5666:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5667:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
5668:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER &&
5669:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_RSA_PSK )
5670:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5671:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= skip parse certificate" ) );
GAS LISTING /tmp/ccEn8xFO.s 			page 269


5672:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->state++;
5673:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
5674:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5675:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5676:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER &&
5677:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         authmode == MBEDTLS_SSL_VERIFY_NONE )
5678:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5679:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->session_negotiate->verify_result = MBEDTLS_X509_BADCERT_SKIP_VERIFY;
5680:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= skip parse certificate" ) );
5681:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5682:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->state++;
5683:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
5684:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5685:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
5686:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5687:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL__ECP_RESTARTABLE)
5688:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->handshake->ecrs_enabled &&
5689:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake->ecrs_state == ssl_ecrs_crt_verify )
5690:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5691:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         goto crt_verify;
5692:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5693:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
5694:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5695:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_ssl_read_record( ssl, 1 ) ) != 0 )
 6497              		.loc 4 5695 17
 6498 009e 488B45B8 		movq	-72(%rbp), %rax
 6499 00a2 BE010000 		movl	$1, %esi
 6499      00
 6500 00a7 4889C7   		movq	%rax, %rdi
 6501 00aa E8000000 		call	mbedtls_ssl_read_record
 6501      00
 6502 00af 8945C8   		movl	%eax, -56(%rbp)
 6503              		.loc 4 5695 7
 6504 00b2 837DC800 		cmpl	$0, -56(%rbp)
 6505 00b6 7408     		je	.L387
5696:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5697:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* mbedtls_ssl_read_record may have sent an alert already. We
5698:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****            let it decide whether to alert. */
5699:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_read_record", ret );
5700:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 6506              		.loc 4 5700 15
 6507 00b8 8B45C8   		movl	-56(%rbp), %eax
 6508 00bb E9050300 		jmp	.L386
 6508      00
 6509              	.L387:
5701:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5702:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5703:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = ssl_parse_certificate_chain( ssl ) ) != 0 )
 6510              		.loc 4 5703 17
 6511 00c0 488B45B8 		movq	-72(%rbp), %rax
 6512 00c4 4889C7   		movq	%rax, %rdi
 6513 00c7 E8000000 		call	ssl_parse_certificate_chain
 6513      00
 6514 00cc 8945C8   		movl	%eax, -56(%rbp)
 6515              		.loc 4 5703 7
 6516 00cf 837DC800 		cmpl	$0, -56(%rbp)
 6517 00d3 7419     		je	.L388
GAS LISTING /tmp/ccEn8xFO.s 			page 270


5704:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5705:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
5706:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ret == MBEDTLS_ERR_SSL_NO_CLIENT_CERTIFICATE &&
5707:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             authmode == MBEDTLS_SSL_VERIFY_OPTIONAL )
5708:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5709:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ret = 0;
5710:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5711:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
5712:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5713:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->state++;
 6518              		.loc 4 5713 12
 6519 00d5 488B45B8 		movq	-72(%rbp), %rax
 6520 00d9 8B4008   		movl	8(%rax), %eax
 6521              		.loc 4 5713 19
 6522 00dc 8D5001   		leal	1(%rax), %edx
 6523 00df 488B45B8 		movq	-72(%rbp), %rax
 6524 00e3 895008   		movl	%edx, 8(%rax)
5714:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 6525              		.loc 4 5714 15
 6526 00e6 8B45C8   		movl	-56(%rbp), %eax
 6527 00e9 E9D70200 		jmp	.L386
 6527      00
 6528              	.L388:
5715:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5716:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5717:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL__ECP_RESTARTABLE)
5718:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->handshake->ecrs_enabled)
5719:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake->ecrs_state = ssl_ecrs_crt_verify;
5720:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5721:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** crt_verify:
5722:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->handshake->ecrs_enabled)
5723:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         rs_ctx = &ssl->handshake->ecrs_ctx;
5724:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
5725:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5726:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( authmode != MBEDTLS_SSL_VERIFY_NONE )
 6529              		.loc 4 5726 7
 6530 00ee 837DCC00 		cmpl	$0, -52(%rbp)
 6531 00f2 0F84B902 		je	.L389
 6531      0000
 6532              	.LBB20:
5727:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5728:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_x509_crt *ca_chain;
5729:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_x509_crl *ca_crl;
5730:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5731:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SERVER_NAME_INDICATION)
5732:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->handshake->sni_ca_chain != NULL )
5733:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5734:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ca_chain = ssl->handshake->sni_ca_chain;
5735:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ca_crl   = ssl->handshake->sni_ca_crl;
5736:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5737:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else
5738:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
5739:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5740:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ca_chain = ssl->conf->ca_chain;
 6533              		.loc 4 5740 27
 6534 00f8 488B45B8 		movq	-72(%rbp), %rax
 6535 00fc 488B00   		movq	(%rax), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 271


 6536              		.loc 4 5740 22
 6537 00ff 488B8088 		movq	136(%rax), %rax
 6537      000000
 6538 0106 488945E0 		movq	%rax, -32(%rbp)
5741:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ca_crl   = ssl->conf->ca_crl;
 6539              		.loc 4 5741 27
 6540 010a 488B45B8 		movq	-72(%rbp), %rax
 6541 010e 488B00   		movq	(%rax), %rax
 6542              		.loc 4 5741 22
 6543 0111 488B8090 		movq	144(%rax), %rax
 6543      000000
 6544 0118 488945E8 		movq	%rax, -24(%rbp)
5742:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5743:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5744:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
5745:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Main check: verify certificate
5746:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
5747:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ret = mbedtls_x509_crt_verify_restartable(
5748:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 ssl->session_negotiate->peer_cert,
5749:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 ca_chain, ca_crl,
5750:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 ssl->conf->cert_profile,
5751:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 ssl->hostname,
5752:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                &ssl->session_negotiate->verify_result,
5753:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 ssl->conf->f_vrfy, ssl->conf->p_vrfy, rs_ctx );
 6545              		.loc 4 5753 55
 6546 011c 488B45B8 		movq	-72(%rbp), %rax
 6547 0120 488B00   		movq	(%rax), %rax
5747:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 ssl->session_negotiate->peer_cert,
 6548              		.loc 4 5747 15
 6549 0123 4C8B4060 		movq	96(%rax), %r8
 6550              		.loc 4 5753 36
 6551 0127 488B45B8 		movq	-72(%rbp), %rax
 6552 012b 488B00   		movq	(%rax), %rax
5747:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 ssl->session_negotiate->peer_cert,
 6553              		.loc 4 5747 15
 6554 012e 488B7858 		movq	88(%rax), %rdi
5752:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 ssl->conf->f_vrfy, ssl->conf->p_vrfy, rs_ctx );
 6555              		.loc 4 5752 36
 6556 0132 488B45B8 		movq	-72(%rbp), %rax
 6557 0136 488B4058 		movq	88(%rax), %rax
5747:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 ssl->session_negotiate->peer_cert,
 6558              		.loc 4 5747 15
 6559 013a 4C8D4868 		leaq	104(%rax), %r9
5751:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                &ssl->session_negotiate->verify_result,
 6560              		.loc 4 5751 36
 6561 013e 488B45B8 		movq	-72(%rbp), %rax
 6562 0142 4C8B9058 		movq	344(%rax), %r10
 6562      010000
5750:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 ssl->hostname,
 6563              		.loc 4 5750 36
 6564 0149 488B45B8 		movq	-72(%rbp), %rax
 6565 014d 488B00   		movq	(%rax), %rax
5747:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 ssl->session_negotiate->peer_cert,
 6566              		.loc 4 5747 15
 6567 0150 488B4878 		movq	120(%rax), %rcx
5748:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 ca_chain, ca_crl,
 6568              		.loc 4 5748 36
GAS LISTING /tmp/ccEn8xFO.s 			page 272


 6569 0154 488B45B8 		movq	-72(%rbp), %rax
 6570 0158 488B4058 		movq	88(%rax), %rax
5747:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 ssl->session_negotiate->peer_cert,
 6571              		.loc 4 5747 15
 6572 015c 488B4060 		movq	96(%rax), %rax
 6573 0160 488B55E8 		movq	-24(%rbp), %rdx
 6574 0164 488B75E0 		movq	-32(%rbp), %rsi
 6575 0168 4883EC08 		subq	$8, %rsp
 6576 016c FF75D8   		pushq	-40(%rbp)
 6577 016f 4150     		pushq	%r8
 6578 0171 57       		pushq	%rdi
 6579 0172 4D89D0   		movq	%r10, %r8
 6580 0175 4889C7   		movq	%rax, %rdi
 6581 0178 E8000000 		call	mbedtls_x509_crt_verify_restartable@PLT
 6581      00
 6582 017d 4883C420 		addq	$32, %rsp
 6583 0181 8945C8   		movl	%eax, -56(%rbp)
 6584              	.LBB21:
5754:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5755:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ret != 0 )
5756:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5757:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "x509_verify_cert", ret );
5758:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5759:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5760:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL__ECP_RESTARTABLE)
5761:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ret == MBEDTLS_ERR_ECP_IN_PROGRESS )
5762:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_CRYPTO_IN_PROGRESS );
5763:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
5764:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5765:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
5766:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Secondary checks: always done, but change 'ret' only if it was 0
5767:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
5768:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5769:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_ECP_C)
5770:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5771:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             const mbedtls_pk_context *pk = &ssl->session_negotiate->peer_cert->pk;
 6585              		.loc 4 5771 48
 6586 0184 488B45B8 		movq	-72(%rbp), %rax
 6587 0188 488B4058 		movq	88(%rax), %rax
 6588              		.loc 4 5771 67
 6589 018c 488B4060 		movq	96(%rax), %rax
 6590              		.loc 4 5771 39
 6591 0190 48054801 		addq	$328, %rax
 6591      0000
 6592 0196 488945F0 		movq	%rax, -16(%rbp)
5772:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5773:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* If certificate uses an EC key, make sure the curve is OK */
5774:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( mbedtls_pk_can_do( pk, MBEDTLS_PK_ECKEY ) &&
 6593              		.loc 4 5774 17
 6594 019a 488B45F0 		movq	-16(%rbp), %rax
 6595 019e BE020000 		movl	$2, %esi
 6595      00
 6596 01a3 4889C7   		movq	%rax, %rdi
 6597 01a6 E8000000 		call	mbedtls_pk_can_do@PLT
 6597      00
 6598              		.loc 4 5774 15
 6599 01ab 85C0     		testl	%eax, %eax
GAS LISTING /tmp/ccEn8xFO.s 			page 273


 6600 01ad 7453     		je	.L390
5775:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 mbedtls_ssl_check_curve( ssl, mbedtls_pk_ec( *pk )->grp.id ) != 0 )
 6601              		.loc 4 5775 47 discriminator 1
 6602 01af 488B45F0 		movq	-16(%rbp), %rax
 6603 01b3 488B10   		movq	(%rax), %rdx
 6604 01b6 488B4008 		movq	8(%rax), %rax
 6605 01ba 4889D7   		movq	%rdx, %rdi
 6606 01bd 4889C6   		movq	%rax, %rsi
 6607 01c0 E8000000 		call	mbedtls_pk_ec
 6607      00
 6608              		.loc 4 5775 17 discriminator 1
 6609 01c5 8B10     		movl	(%rax), %edx
 6610 01c7 488B45B8 		movq	-72(%rbp), %rax
 6611 01cb 89D6     		movl	%edx, %esi
 6612 01cd 4889C7   		movq	%rax, %rdi
 6613 01d0 E8000000 		call	mbedtls_ssl_check_curve
 6613      00
5774:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 mbedtls_ssl_check_curve( ssl, mbedtls_pk_ec( *pk )->grp.id ) != 0 )
 6614              		.loc 4 5774 59 discriminator 1
 6615 01d5 85C0     		testl	%eax, %eax
 6616 01d7 7429     		je	.L390
5776:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
5777:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->session_negotiate->verify_result |= MBEDTLS_X509_BADCERT_BAD_KEY;
 6617              		.loc 4 5777 20
 6618 01d9 488B45B8 		movq	-72(%rbp), %rax
 6619 01dd 488B4058 		movq	88(%rax), %rax
 6620              		.loc 4 5777 55
 6621 01e1 8B5068   		movl	104(%rax), %edx
 6622              		.loc 4 5777 20
 6623 01e4 488B45B8 		movq	-72(%rbp), %rax
 6624 01e8 488B4058 		movq	88(%rax), %rax
 6625              		.loc 4 5777 55
 6626 01ec 81CA0000 		orl	$65536, %edx
 6626      0100
 6627 01f2 895068   		movl	%edx, 104(%rax)
5778:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5779:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad certificate (EC key curve)" ) );
5780:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( ret == 0 )
 6628              		.loc 4 5780 19
 6629 01f5 837DC800 		cmpl	$0, -56(%rbp)
 6630 01f9 7507     		jne	.L390
5781:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ret = MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE;
 6631              		.loc 4 5781 25
 6632 01fb C745C800 		movl	$-31232, -56(%rbp)
 6632      86FFFF
 6633              	.L390:
 6634              	.LBE21:
5782:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
5783:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5784:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_ECP_C */
5785:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5786:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( mbedtls_ssl_check_cert_usage( ssl->session_negotiate->peer_cert,
5787:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  ciphersuite_info,
5788:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  ! ssl->conf->endpoint,
5789:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  &ssl->session_negotiate->verify_result ) != 0 )
 6635              		.loc 4 5789 38
 6636 0202 488B45B8 		movq	-72(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 274


 6637 0206 488B4058 		movq	88(%rax), %rax
5786:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  ciphersuite_info,
 6638              		.loc 4 5786 13
 6639 020a 488D4868 		leaq	104(%rax), %rcx
5788:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  &ssl->session_negotiate->verify_result ) != 0 )
 6640              		.loc 4 5788 39
 6641 020e 488B45B8 		movq	-72(%rbp), %rax
 6642 0212 488B00   		movq	(%rax), %rax
5788:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  &ssl->session_negotiate->verify_result ) != 0 )
 6643              		.loc 4 5788 34
 6644 0215 0FB680BC 		movzbl	188(%rax), %eax
 6644      000000
5786:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  ciphersuite_info,
 6645              		.loc 4 5786 13
 6646 021c 83E001   		andl	$1, %eax
 6647 021f 84C0     		testb	%al, %al
 6648 0221 0F94C0   		sete	%al
 6649 0224 0FB6D0   		movzbl	%al, %edx
5786:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  ciphersuite_info,
 6650              		.loc 4 5786 46
 6651 0227 488B45B8 		movq	-72(%rbp), %rax
 6652 022b 488B4058 		movq	88(%rax), %rax
5786:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  ciphersuite_info,
 6653              		.loc 4 5786 65
 6654 022f 488B4060 		movq	96(%rax), %rax
5786:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  ciphersuite_info,
 6655              		.loc 4 5786 13
 6656 0233 488B75D0 		movq	-48(%rbp), %rsi
 6657 0237 4889C7   		movq	%rax, %rdi
 6658 023a E8000000 		call	mbedtls_ssl_check_cert_usage
 6658      00
5786:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  ciphersuite_info,
 6659              		.loc 4 5786 11
 6660 023f 85C0     		testl	%eax, %eax
 6661 0241 740D     		je	.L391
5790:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5791:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad certificate (usage extensions)" ) );
5792:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ret == 0 )
 6662              		.loc 4 5792 15
 6663 0243 837DC800 		cmpl	$0, -56(%rbp)
 6664 0247 7507     		jne	.L391
5793:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ret = MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE;
 6665              		.loc 4 5793 21
 6666 0249 C745C800 		movl	$-31232, -56(%rbp)
 6666      86FFFF
 6667              	.L391:
5794:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5795:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5796:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* mbedtls_x509_crt_verify_with_profile is supposed to report a
5797:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * verification failure through MBEDTLS_ERR_X509_CERT_VERIFY_FAILED,
5798:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * with details encoded in the verification flags. All other kinds
5799:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * of error codes, including those from the user provided f_vrfy
5800:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * functions, are treated as fatal and lead to a failure of
5801:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * ssl_parse_certificate even if verification was optional. */
5802:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( authmode == MBEDTLS_SSL_VERIFY_OPTIONAL &&
 6668              		.loc 4 5802 11
 6669 0250 837DCC01 		cmpl	$1, -52(%rbp)
GAS LISTING /tmp/ccEn8xFO.s 			page 275


 6670 0254 7519     		jne	.L392
 6671              		.loc 4 5802 53 discriminator 1
 6672 0256 817DC800 		cmpl	$-9984, -56(%rbp)
 6672      D9FFFF
 6673 025d 7409     		je	.L393
5803:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ( ret == MBEDTLS_ERR_X509_CERT_VERIFY_FAILED ||
 6674              		.loc 4 5803 58
 6675 025f 817DC800 		cmpl	$-31232, -56(%rbp)
 6675      86FFFF
 6676 0266 7507     		jne	.L392
 6677              	.L393:
5804:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****               ret == MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE ) )
5805:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5806:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ret = 0;
 6678              		.loc 4 5806 17
 6679 0268 C745C800 		movl	$0, -56(%rbp)
 6679      000000
 6680              	.L392:
5807:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5808:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5809:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ca_chain == NULL && authmode == MBEDTLS_SSL_VERIFY_REQUIRED )
 6681              		.loc 4 5809 11
 6682 026f 48837DE0 		cmpq	$0, -32(%rbp)
 6682      00
 6683 0274 750D     		jne	.L394
 6684              		.loc 4 5809 30 discriminator 1
 6685 0276 837DCC02 		cmpl	$2, -52(%rbp)
 6686 027a 7507     		jne	.L394
5810:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5811:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "got no CA chain" ) );
5812:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ret = MBEDTLS_ERR_SSL_CA_CHAIN_REQUIRED;
 6687              		.loc 4 5812 17
 6688 027c C745C880 		movl	$-30336, -56(%rbp)
 6688      89FFFF
 6689              	.L394:
5813:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5814:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5815:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ret != 0 )
 6690              		.loc 4 5815 11
 6691 0283 837DC800 		cmpl	$0, -56(%rbp)
 6692 0287 0F842401 		je	.L389
 6692      0000
 6693              	.LBB22:
5816:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5817:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             uint8_t alert;
5818:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5819:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* The certificate may have been rejected for several reasons.
5820:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                Pick one and send the corresponding alert. Which alert to send
5821:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                may be a subject of debate in some cases. */
5822:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_OTHER )
 6694              		.loc 4 5822 20
 6695 028d 488B45B8 		movq	-72(%rbp), %rax
 6696 0291 488B4058 		movq	88(%rax), %rax
 6697              		.loc 4 5822 39
 6698 0295 8B4068   		movl	104(%rax), %eax
 6699              		.loc 4 5822 55
 6700 0298 25000100 		andl	$256, %eax
GAS LISTING /tmp/ccEn8xFO.s 			page 276


 6700      00
 6701              		.loc 4 5822 15
 6702 029d 85C0     		testl	%eax, %eax
 6703 029f 7409     		je	.L395
5823:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_ACCESS_DENIED;
 6704              		.loc 4 5823 23
 6705 02a1 C645C731 		movb	$49, -57(%rbp)
 6706 02a5 E9F20000 		jmp	.L396
 6706      00
 6707              	.L395:
5824:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_CN_MISMATCH )
 6708              		.loc 4 5824 25
 6709 02aa 488B45B8 		movq	-72(%rbp), %rax
 6710 02ae 488B4058 		movq	88(%rax), %rax
 6711              		.loc 4 5824 44
 6712 02b2 8B4068   		movl	104(%rax), %eax
 6713              		.loc 4 5824 60
 6714 02b5 83E004   		andl	$4, %eax
 6715              		.loc 4 5824 20
 6716 02b8 85C0     		testl	%eax, %eax
 6717 02ba 7409     		je	.L397
5825:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_BAD_CERT;
 6718              		.loc 4 5825 23
 6719 02bc C645C72A 		movb	$42, -57(%rbp)
 6720 02c0 E9D70000 		jmp	.L396
 6720      00
 6721              	.L397:
5826:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_KEY_USAGE )
 6722              		.loc 4 5826 25
 6723 02c5 488B45B8 		movq	-72(%rbp), %rax
 6724 02c9 488B4058 		movq	88(%rax), %rax
 6725              		.loc 4 5826 44
 6726 02cd 8B4068   		movl	104(%rax), %eax
 6727              		.loc 4 5826 60
 6728 02d0 25000800 		andl	$2048, %eax
 6728      00
 6729              		.loc 4 5826 20
 6730 02d5 85C0     		testl	%eax, %eax
 6731 02d7 7409     		je	.L398
5827:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_UNSUPPORTED_CERT;
 6732              		.loc 4 5827 23
 6733 02d9 C645C72B 		movb	$43, -57(%rbp)
 6734 02dd E9BA0000 		jmp	.L396
 6734      00
 6735              	.L398:
5828:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_EXT_KEY_USAGE )
 6736              		.loc 4 5828 25
 6737 02e2 488B45B8 		movq	-72(%rbp), %rax
 6738 02e6 488B4058 		movq	88(%rax), %rax
 6739              		.loc 4 5828 44
 6740 02ea 8B4068   		movl	104(%rax), %eax
 6741              		.loc 4 5828 60
 6742 02ed 25001000 		andl	$4096, %eax
 6742      00
 6743              		.loc 4 5828 20
 6744 02f2 85C0     		testl	%eax, %eax
 6745 02f4 7409     		je	.L399
GAS LISTING /tmp/ccEn8xFO.s 			page 277


5829:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_UNSUPPORTED_CERT;
 6746              		.loc 4 5829 23
 6747 02f6 C645C72B 		movb	$43, -57(%rbp)
 6748 02fa E99D0000 		jmp	.L396
 6748      00
 6749              	.L399:
5830:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_NS_CERT_TYPE )
 6750              		.loc 4 5830 25
 6751 02ff 488B45B8 		movq	-72(%rbp), %rax
 6752 0303 488B4058 		movq	88(%rax), %rax
 6753              		.loc 4 5830 44
 6754 0307 8B4068   		movl	104(%rax), %eax
 6755              		.loc 4 5830 60
 6756 030a 25002000 		andl	$8192, %eax
 6756      00
 6757              		.loc 4 5830 20
 6758 030f 85C0     		testl	%eax, %eax
 6759 0311 7409     		je	.L400
5831:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_UNSUPPORTED_CERT;
 6760              		.loc 4 5831 23
 6761 0313 C645C72B 		movb	$43, -57(%rbp)
 6762 0317 E9800000 		jmp	.L396
 6762      00
 6763              	.L400:
5832:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_BAD_PK )
 6764              		.loc 4 5832 25
 6765 031c 488B45B8 		movq	-72(%rbp), %rax
 6766 0320 488B4058 		movq	88(%rax), %rax
 6767              		.loc 4 5832 44
 6768 0324 8B4068   		movl	104(%rax), %eax
 6769              		.loc 4 5832 60
 6770 0327 25008000 		andl	$32768, %eax
 6770      00
 6771              		.loc 4 5832 20
 6772 032c 85C0     		testl	%eax, %eax
 6773 032e 7406     		je	.L401
5833:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_UNSUPPORTED_CERT;
 6774              		.loc 4 5833 23
 6775 0330 C645C72B 		movb	$43, -57(%rbp)
 6776 0334 EB66     		jmp	.L396
 6777              	.L401:
5834:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_BAD_KEY )
 6778              		.loc 4 5834 25
 6779 0336 488B45B8 		movq	-72(%rbp), %rax
 6780 033a 488B4058 		movq	88(%rax), %rax
 6781              		.loc 4 5834 44
 6782 033e 8B4068   		movl	104(%rax), %eax
 6783              		.loc 4 5834 60
 6784 0341 25000001 		andl	$65536, %eax
 6784      00
 6785              		.loc 4 5834 20
 6786 0346 85C0     		testl	%eax, %eax
 6787 0348 7406     		je	.L402
5835:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_UNSUPPORTED_CERT;
 6788              		.loc 4 5835 23
 6789 034a C645C72B 		movb	$43, -57(%rbp)
 6790 034e EB4C     		jmp	.L396
GAS LISTING /tmp/ccEn8xFO.s 			page 278


 6791              	.L402:
5836:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_EXPIRED )
 6792              		.loc 4 5836 25
 6793 0350 488B45B8 		movq	-72(%rbp), %rax
 6794 0354 488B4058 		movq	88(%rax), %rax
 6795              		.loc 4 5836 44
 6796 0358 8B4068   		movl	104(%rax), %eax
 6797              		.loc 4 5836 60
 6798 035b 83E001   		andl	$1, %eax
 6799              		.loc 4 5836 20
 6800 035e 85C0     		testl	%eax, %eax
 6801 0360 7406     		je	.L403
5837:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_CERT_EXPIRED;
 6802              		.loc 4 5837 23
 6803 0362 C645C72D 		movb	$45, -57(%rbp)
 6804 0366 EB34     		jmp	.L396
 6805              	.L403:
5838:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_REVOKED )
 6806              		.loc 4 5838 25
 6807 0368 488B45B8 		movq	-72(%rbp), %rax
 6808 036c 488B4058 		movq	88(%rax), %rax
 6809              		.loc 4 5838 44
 6810 0370 8B4068   		movl	104(%rax), %eax
 6811              		.loc 4 5838 60
 6812 0373 83E002   		andl	$2, %eax
 6813              		.loc 4 5838 20
 6814 0376 85C0     		testl	%eax, %eax
 6815 0378 7406     		je	.L404
5839:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_CERT_REVOKED;
 6816              		.loc 4 5839 23
 6817 037a C645C72C 		movb	$44, -57(%rbp)
 6818 037e EB1C     		jmp	.L396
 6819              	.L404:
5840:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_NOT_TRUSTED )
 6820              		.loc 4 5840 25
 6821 0380 488B45B8 		movq	-72(%rbp), %rax
 6822 0384 488B4058 		movq	88(%rax), %rax
 6823              		.loc 4 5840 44
 6824 0388 8B4068   		movl	104(%rax), %eax
 6825              		.loc 4 5840 60
 6826 038b 83E008   		andl	$8, %eax
 6827              		.loc 4 5840 20
 6828 038e 85C0     		testl	%eax, %eax
 6829 0390 7406     		je	.L405
5841:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_UNKNOWN_CA;
 6830              		.loc 4 5841 23
 6831 0392 C645C730 		movb	$48, -57(%rbp)
 6832 0396 EB04     		jmp	.L396
 6833              	.L405:
5842:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else
5843:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_CERT_UNKNOWN;
 6834              		.loc 4 5843 23
 6835 0398 C645C72E 		movb	$46, -57(%rbp)
 6836              	.L396:
5844:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 6837              		.loc 4 5844 13
 6838 039c 0FB655C7 		movzbl	-57(%rbp), %edx
GAS LISTING /tmp/ccEn8xFO.s 			page 279


 6839 03a0 488B45B8 		movq	-72(%rbp), %rax
 6840 03a4 BE020000 		movl	$2, %esi
 6840      00
 6841 03a9 4889C7   		movq	%rax, %rdi
 6842 03ac E8000000 		call	mbedtls_ssl_send_alert_message
 6842      00
 6843              	.L389:
 6844              	.LBE22:
 6845              	.LBE20:
5845:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                             alert );
5846:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5847:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5848:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_DEBUG_C)
5849:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->session_negotiate->verify_result != 0 )
5850:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5851:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "! Certificate verification flags %x",
5852:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         ssl->session_negotiate->verify_result ) );
5853:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5854:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else
5855:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5856:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "Certificate verification flags clear" ) );
5857:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5858:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_DEBUG_C */
5859:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5860:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5861:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->state++;
 6846              		.loc 4 5861 8
 6847 03b1 488B45B8 		movq	-72(%rbp), %rax
 6848 03b5 8B4008   		movl	8(%rax), %eax
 6849              		.loc 4 5861 15
 6850 03b8 8D5001   		leal	1(%rax), %edx
 6851 03bb 488B45B8 		movq	-72(%rbp), %rax
 6852 03bf 895008   		movl	%edx, 8(%rax)
5862:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5863:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= parse certificate" ) );
5864:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5865:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ret );
 6853              		.loc 4 5865 11
 6854 03c2 8B45C8   		movl	-56(%rbp), %eax
 6855              	.L386:
5866:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 6856              		.loc 4 5866 1
 6857 03c5 488B4DF8 		movq	-8(%rbp), %rcx
 6858 03c9 6448330C 		xorq	%fs:40, %rcx
 6858      25280000 
 6858      00
 6859 03d2 7405     		je	.L406
 6860 03d4 E8000000 		call	__stack_chk_fail@PLT
 6860      00
 6861              	.L406:
 6862 03d9 C9       		leave
 6863              	.LCFI116:
 6864              		.cfi_def_cfa 7, 8
 6865 03da C3       		ret
 6866              		.cfi_endproc
 6867              	.LFE57:
 6869              		.section	.text.mbedtls_ssl_write_change_cipher_spec,"ax",@progbits
GAS LISTING /tmp/ccEn8xFO.s 			page 280


 6870              		.globl	mbedtls_ssl_write_change_cipher_spec
 6872              	mbedtls_ssl_write_change_cipher_spec:
 6873              	.LFB58:
5867:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* !MBEDTLS_KEY_EXCHANGE_RSA_ENABLED
5868:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****           !MBEDTLS_KEY_EXCHANGE_RSA_PSK_ENABLED
5869:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****           !MBEDTLS_KEY_EXCHANGE_DHE_RSA_ENABLED
5870:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****           !MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED
5871:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****           !MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED
5872:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****           !MBEDTLS_KEY_EXCHANGE_ECDH_RSA_ENABLED
5873:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****           !MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA_ENABLED */
5874:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5875:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_write_change_cipher_spec( mbedtls_ssl_context *ssl )
5876:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 6874              		.loc 4 5876 1
 6875              		.cfi_startproc
 6876 0000 F30F1EFA 		endbr64
 6877 0004 55       		pushq	%rbp
 6878              	.LCFI117:
 6879              		.cfi_def_cfa_offset 16
 6880              		.cfi_offset 6, -16
 6881 0005 4889E5   		movq	%rsp, %rbp
 6882              	.LCFI118:
 6883              		.cfi_def_cfa_register 6
 6884 0008 4883EC20 		subq	$32, %rsp
 6885 000c 48897DE8 		movq	%rdi, -24(%rbp)
 6886              		.loc 4 5876 1
 6887 0010 64488B04 		movq	%fs:40, %rax
 6887      25280000 
 6887      00
 6888 0019 488945F8 		movq	%rax, -8(%rbp)
 6889 001d 31C0     		xorl	%eax, %eax
5877:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
5878:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5879:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> write change cipher spec" ) );
5880:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5881:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_msgtype = MBEDTLS_SSL_MSG_CHANGE_CIPHER_SPEC;
 6890              		.loc 4 5881 22
 6891 001f 488B45E8 		movq	-24(%rbp), %rax
 6892 0023 C7803001 		movl	$20, 304(%rax)
 6892      00001400 
 6892      0000
5882:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_msglen  = 1;
 6893              		.loc 4 5882 22
 6894 002d 488B45E8 		movq	-24(%rbp), %rax
 6895 0031 48C78038 		movq	$1, 312(%rax)
 6895      01000001 
 6895      000000
5883:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_msg[0]  = 1;
 6896              		.loc 4 5883 8
 6897 003c 488B45E8 		movq	-24(%rbp), %rax
 6898 0040 488B8028 		movq	296(%rax), %rax
 6898      010000
 6899              		.loc 4 5883 22
 6900 0047 C60001   		movb	$1, (%rax)
5884:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5885:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->state++;
 6901              		.loc 4 5885 8
GAS LISTING /tmp/ccEn8xFO.s 			page 281


 6902 004a 488B45E8 		movq	-24(%rbp), %rax
 6903 004e 8B4008   		movl	8(%rax), %eax
 6904              		.loc 4 5885 15
 6905 0051 8D5001   		leal	1(%rax), %edx
 6906 0054 488B45E8 		movq	-24(%rbp), %rax
 6907 0058 895008   		movl	%edx, 8(%rax)
5886:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5887:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_ssl_write_handshake_msg( ssl ) ) != 0 )
 6908              		.loc 4 5887 17
 6909 005b 488B45E8 		movq	-24(%rbp), %rax
 6910 005f 4889C7   		movq	%rax, %rdi
 6911 0062 E8000000 		call	mbedtls_ssl_write_handshake_msg
 6911      00
 6912 0067 8945F4   		movl	%eax, -12(%rbp)
 6913              		.loc 4 5887 7
 6914 006a 837DF400 		cmpl	$0, -12(%rbp)
 6915 006e 7405     		je	.L408
5888:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5889:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_write_handshake_msg", ret );
5890:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 6916              		.loc 4 5890 15
 6917 0070 8B45F4   		movl	-12(%rbp), %eax
 6918 0073 EB05     		jmp	.L409
 6919              	.L408:
5891:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5892:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5893:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= write change cipher spec" ) );
5894:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5895:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 6920              		.loc 4 5895 11
 6921 0075 B8000000 		movl	$0, %eax
 6921      00
 6922              	.L409:
5896:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 6923              		.loc 4 5896 1
 6924 007a 488B4DF8 		movq	-8(%rbp), %rcx
 6925 007e 6448330C 		xorq	%fs:40, %rcx
 6925      25280000 
 6925      00
 6926 0087 7405     		je	.L410
 6927 0089 E8000000 		call	__stack_chk_fail@PLT
 6927      00
 6928              	.L410:
 6929 008e C9       		leave
 6930              	.LCFI119:
 6931              		.cfi_def_cfa 7, 8
 6932 008f C3       		ret
 6933              		.cfi_endproc
 6934              	.LFE58:
 6936              		.section	.text.mbedtls_ssl_parse_change_cipher_spec,"ax",@progbits
 6937              		.globl	mbedtls_ssl_parse_change_cipher_spec
 6939              	mbedtls_ssl_parse_change_cipher_spec:
 6940              	.LFB59:
5897:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5898:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_parse_change_cipher_spec( mbedtls_ssl_context *ssl )
5899:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 6941              		.loc 4 5899 1
GAS LISTING /tmp/ccEn8xFO.s 			page 282


 6942              		.cfi_startproc
 6943 0000 F30F1EFA 		endbr64
 6944 0004 55       		pushq	%rbp
 6945              	.LCFI120:
 6946              		.cfi_def_cfa_offset 16
 6947              		.cfi_offset 6, -16
 6948 0005 4889E5   		movq	%rsp, %rbp
 6949              	.LCFI121:
 6950              		.cfi_def_cfa_register 6
 6951 0008 4883EC20 		subq	$32, %rsp
 6952 000c 48897DE8 		movq	%rdi, -24(%rbp)
 6953              		.loc 4 5899 1
 6954 0010 64488B04 		movq	%fs:40, %rax
 6954      25280000 
 6954      00
 6955 0019 488945F8 		movq	%rax, -8(%rbp)
 6956 001d 31C0     		xorl	%eax, %eax
5900:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
5901:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5902:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> parse change cipher spec" ) );
5903:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5904:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_ssl_read_record( ssl, 1 ) ) != 0 )
 6957              		.loc 4 5904 17
 6958 001f 488B45E8 		movq	-24(%rbp), %rax
 6959 0023 BE010000 		movl	$1, %esi
 6959      00
 6960 0028 4889C7   		movq	%rax, %rdi
 6961 002b E8000000 		call	mbedtls_ssl_read_record
 6961      00
 6962 0030 8945F4   		movl	%eax, -12(%rbp)
 6963              		.loc 4 5904 7
 6964 0033 837DF400 		cmpl	$0, -12(%rbp)
 6965 0037 7408     		je	.L412
5905:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5906:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_read_record", ret );
5907:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 6966              		.loc 4 5907 15
 6967 0039 8B45F4   		movl	-12(%rbp), %eax
 6968 003c E99C0000 		jmp	.L413
 6968      00
 6969              	.L412:
5908:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5909:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5910:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_msgtype != MBEDTLS_SSL_MSG_CHANGE_CIPHER_SPEC )
 6970              		.loc 4 5910 12
 6971 0041 488B45E8 		movq	-24(%rbp), %rax
 6972 0045 8B80D800 		movl	216(%rax), %eax
 6972      0000
 6973              		.loc 4 5910 7
 6974 004b 83F814   		cmpl	$20, %eax
 6975 004e 741D     		je	.L414
5911:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5912:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad change cipher spec message" ) );
5913:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 6976              		.loc 4 5913 9
 6977 0050 488B45E8 		movq	-24(%rbp), %rax
 6978 0054 BA0A0000 		movl	$10, %edx
GAS LISTING /tmp/ccEn8xFO.s 			page 283


 6978      00
 6979 0059 BE020000 		movl	$2, %esi
 6979      00
 6980 005e 4889C7   		movq	%rax, %rdi
 6981 0061 E8000000 		call	mbedtls_ssl_send_alert_message
 6981      00
5914:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_UNEXPECTED_MESSAGE );
5915:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
 6982              		.loc 4 5915 15
 6983 0066 B80089FF 		movl	$-30464, %eax
 6983      FF
 6984 006b EB70     		jmp	.L413
 6985              	.L414:
5916:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5917:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5918:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* CCS records are only accepted if they have length 1 and content '1',
5919:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * so we don't need to check this here. */
5920:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5921:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
5922:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Switch to our negotiated transform and session parameters for inbound
5923:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * data.
5924:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
5925:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "switching to new transform spec for inbound data" ) );
5926:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->transform_in = ssl->transform_negotiate;
 6986              		.loc 4 5926 28
 6987 006d 488B45E8 		movq	-24(%rbp), %rax
 6988 0071 488B9080 		movq	128(%rax), %rdx
 6988      000000
 6989              		.loc 4 5926 23
 6990 0078 488B45E8 		movq	-24(%rbp), %rax
 6991 007c 48895068 		movq	%rdx, 104(%rax)
5927:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->session_in = ssl->session_negotiate;
 6992              		.loc 4 5927 26
 6993 0080 488B45E8 		movq	-24(%rbp), %rax
 6994 0084 488B5058 		movq	88(%rax), %rdx
 6995              		.loc 4 5927 21
 6996 0088 488B45E8 		movq	-24(%rbp), %rax
 6997 008c 48895040 		movq	%rdx, 64(%rax)
5928:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5929:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
5930:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
5931:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5932:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_ANTI_REPLAY)
5933:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl_dtls_replay_reset( ssl );
5934:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
5935:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5936:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Increment epoch */
5937:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ++ssl->in_epoch == 0 )
5938:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5939:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "DTLS epoch would wrap" ) );
5940:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* This is highly unlikely to happen for legitimate reasons, so
5941:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                treat it as an attack and don't send an alert. */
5942:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_COUNTER_WRAPPING );
5943:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5944:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5945:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
5946:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
GAS LISTING /tmp/ccEn8xFO.s 			page 284


5947:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memset( ssl->in_ctr, 0, 8 );
 6998              		.loc 4 5947 16
 6999 0090 488B45E8 		movq	-24(%rbp), %rax
 7000 0094 488B80A8 		movq	168(%rax), %rax
 7000      000000
 7001              		.loc 4 5947 5
 7002 009b BA080000 		movl	$8, %edx
 7002      00
 7003 00a0 BE000000 		movl	$0, %esi
 7003      00
 7004 00a5 4889C7   		movq	%rax, %rdi
 7005 00a8 E8000000 		call	memset@PLT
 7005      00
5948:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5949:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_update_in_pointers( ssl, ssl->transform_negotiate );
 7006              		.loc 4 5949 5
 7007 00ad 488B45E8 		movq	-24(%rbp), %rax
 7008 00b1 488B9080 		movq	128(%rax), %rdx
 7008      000000
 7009 00b8 488B45E8 		movq	-24(%rbp), %rax
 7010 00bc 4889D6   		movq	%rdx, %rsi
 7011 00bf 4889C7   		movq	%rax, %rdi
 7012 00c2 E8000000 		call	ssl_update_in_pointers
 7012      00
5950:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5951:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_HW_RECORD_ACCEL)
5952:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( mbedtls_ssl_hw_record_activate != NULL )
5953:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5954:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_ssl_hw_record_activate( ssl, MBEDTLS_SSL_CHANNEL_INBOUND ) ) != 0 )
5955:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
5956:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_hw_record_activate", ret );
5957:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
5958:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                             MBEDTLS_SSL_ALERT_MSG_INTERNAL_ERROR );
5959:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_HW_ACCEL_FAILED );
5960:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
5961:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5962:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
5963:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5964:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->state++;
 7013              		.loc 4 5964 8
 7014 00c7 488B45E8 		movq	-24(%rbp), %rax
 7015 00cb 8B4008   		movl	8(%rax), %eax
 7016              		.loc 4 5964 15
 7017 00ce 8D5001   		leal	1(%rax), %edx
 7018 00d1 488B45E8 		movq	-24(%rbp), %rax
 7019 00d5 895008   		movl	%edx, 8(%rax)
5965:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5966:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= parse change cipher spec" ) );
5967:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5968:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 7020              		.loc 4 5968 11
 7021 00d8 B8000000 		movl	$0, %eax
 7021      00
 7022              	.L413:
5969:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 7023              		.loc 4 5969 1
 7024 00dd 488B4DF8 		movq	-8(%rbp), %rcx
GAS LISTING /tmp/ccEn8xFO.s 			page 285


 7025 00e1 6448330C 		xorq	%fs:40, %rcx
 7025      25280000 
 7025      00
 7026 00ea 7405     		je	.L415
 7027 00ec E8000000 		call	__stack_chk_fail@PLT
 7027      00
 7028              	.L415:
 7029 00f1 C9       		leave
 7030              	.LCFI122:
 7031              		.cfi_def_cfa 7, 8
 7032 00f2 C3       		ret
 7033              		.cfi_endproc
 7034              	.LFE59:
 7036              		.section	.text.mbedtls_ssl_optimize_checksum,"ax",@progbits
 7037              		.globl	mbedtls_ssl_optimize_checksum
 7039              	mbedtls_ssl_optimize_checksum:
 7040              	.LFB60:
5970:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5971:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_optimize_checksum( mbedtls_ssl_context *ssl,
5972:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             const mbedtls_ssl_ciphersuite_t *ciphersuite_info )
5973:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 7041              		.loc 4 5973 1
 7042              		.cfi_startproc
 7043 0000 F30F1EFA 		endbr64
 7044 0004 55       		pushq	%rbp
 7045              	.LCFI123:
 7046              		.cfi_def_cfa_offset 16
 7047              		.cfi_offset 6, -16
 7048 0005 4889E5   		movq	%rsp, %rbp
 7049              	.LCFI124:
 7050              		.cfi_def_cfa_register 6
 7051 0008 4883EC20 		subq	$32, %rsp
 7052 000c 48897DE8 		movq	%rdi, -24(%rbp)
 7053 0010 488975E0 		movq	%rsi, -32(%rbp)
 7054              		.loc 4 5973 1
 7055 0014 64488B04 		movq	%fs:40, %rax
 7055      25280000 
 7055      00
 7056 001d 488945F8 		movq	%rax, -8(%rbp)
 7057 0021 31C0     		xorl	%eax, %eax
5974:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ((void) ciphersuite_info);
5975:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
5976:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1) || \
5977:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_1)
5978:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->minor_ver < MBEDTLS_SSL_MINOR_VERSION_3 )
5979:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake->update_checksum = ssl_update_checksum_md5sha1;
5980:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
5981:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
5982:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
5983:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
5984:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ciphersuite_info->mac == MBEDTLS_MD_SHA384 )
5985:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake->update_checksum = ssl_update_checksum_sha384;
5986:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
5987:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
5988:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
5989:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ciphersuite_info->mac != MBEDTLS_MD_SHA384 )
 7058              		.loc 4 5989 25
GAS LISTING /tmp/ccEn8xFO.s 			page 286


 7059 0023 488B45E0 		movq	-32(%rbp), %rax
 7060 0027 8B4014   		movl	20(%rax), %eax
 7061              		.loc 4 5989 7
 7062 002a 83F807   		cmpl	$7, %eax
 7063 002d 7418     		je	.L420
5990:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake->update_checksum = ssl_update_checksum_sha256;
 7064              		.loc 4 5990 12
 7065 002f 488B45E8 		movq	-24(%rbp), %rax
 7066 0033 488B4060 		movq	96(%rax), %rax
 7067              		.loc 4 5990 41
 7068 0037 488D1500 		leaq	ssl_update_checksum_sha256(%rip), %rdx
 7068      000000
 7069 003e 488990F0 		movq	%rdx, 752(%rax)
 7069      020000
 7070 0045 EB01     		jmp	.L416
 7071              	.L420:
5991:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
5992:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
5993:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
5994:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
5995:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
5996:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return;
 7072              		.loc 4 5996 9
 7073 0047 90       		nop
 7074              	.L416:
5997:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
5998:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 7075              		.loc 4 5998 1
 7076 0048 488B45F8 		movq	-8(%rbp), %rax
 7077 004c 64483304 		xorq	%fs:40, %rax
 7077      25280000 
 7077      00
 7078 0055 7405     		je	.L419
 7079 0057 E8000000 		call	__stack_chk_fail@PLT
 7079      00
 7080              	.L419:
 7081 005c C9       		leave
 7082              	.LCFI125:
 7083              		.cfi_def_cfa 7, 8
 7084 005d C3       		ret
 7085              		.cfi_endproc
 7086              	.LFE60:
 7088              		.section	.text.mbedtls_ssl_reset_checksum,"ax",@progbits
 7089              		.globl	mbedtls_ssl_reset_checksum
 7091              	mbedtls_ssl_reset_checksum:
 7092              	.LFB61:
5999:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6000:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_reset_checksum( mbedtls_ssl_context *ssl )
6001:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 7093              		.loc 4 6001 1
 7094              		.cfi_startproc
 7095 0000 F30F1EFA 		endbr64
 7096 0004 55       		pushq	%rbp
 7097              	.LCFI126:
 7098              		.cfi_def_cfa_offset 16
 7099              		.cfi_offset 6, -16
 7100 0005 4889E5   		movq	%rsp, %rbp
GAS LISTING /tmp/ccEn8xFO.s 			page 287


 7101              	.LCFI127:
 7102              		.cfi_def_cfa_register 6
 7103 0008 4883EC20 		subq	$32, %rsp
 7104 000c 48897DE8 		movq	%rdi, -24(%rbp)
 7105              		.loc 4 6001 1
 7106 0010 64488B04 		movq	%fs:40, %rax
 7106      25280000 
 7106      00
 7107 0019 488945F8 		movq	%rax, -8(%rbp)
 7108 001d 31C0     		xorl	%eax, %eax
6002:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1) || \
6003:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_1)
6004:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      mbedtls_md5_starts_ret( &ssl->handshake->fin_md5  );
6005:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_starts_ret( &ssl->handshake->fin_sha1 );
6006:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6007:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
6008:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
6009:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha256_starts_ret( &ssl->handshake->fin_sha256, 0 );
 7109              		.loc 4 6009 36
 7110 001f 488B45E8 		movq	-24(%rbp), %rax
 7111 0023 488B4060 		movq	96(%rax), %rax
 7112              		.loc 4 6009 5
 7113 0027 48058002 		addq	$640, %rax
 7113      0000
 7114 002d BE000000 		movl	$0, %esi
 7114      00
 7115 0032 4889C7   		movq	%rax, %rdi
 7116 0035 E8000000 		call	mbedtls_sha256_starts_ret@PLT
 7116      00
6010:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6011:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
6012:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha512_starts_ret( &ssl->handshake->fin_sha512, 1 );
6013:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6014:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
6015:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 7117              		.loc 4 6015 1
 7118 003a 90       		nop
 7119 003b 488B45F8 		movq	-8(%rbp), %rax
 7120 003f 64483304 		xorq	%fs:40, %rax
 7120      25280000 
 7120      00
 7121 0048 7405     		je	.L422
 7122 004a E8000000 		call	__stack_chk_fail@PLT
 7122      00
 7123              	.L422:
 7124 004f C9       		leave
 7125              	.LCFI128:
 7126              		.cfi_def_cfa 7, 8
 7127 0050 C3       		ret
 7128              		.cfi_endproc
 7129              	.LFE61:
 7131              		.section	.text.ssl_update_checksum_start,"ax",@progbits
 7133              	ssl_update_checksum_start:
 7134              	.LFB62:
6016:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6017:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_update_checksum_start( mbedtls_ssl_context *ssl,
6018:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                        const unsigned char *buf, size_t len )
GAS LISTING /tmp/ccEn8xFO.s 			page 288


6019:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 7135              		.loc 4 6019 1
 7136              		.cfi_startproc
 7137 0000 F30F1EFA 		endbr64
 7138 0004 55       		pushq	%rbp
 7139              	.LCFI129:
 7140              		.cfi_def_cfa_offset 16
 7141              		.cfi_offset 6, -16
 7142 0005 4889E5   		movq	%rsp, %rbp
 7143              	.LCFI130:
 7144              		.cfi_def_cfa_register 6
 7145 0008 4883EC30 		subq	$48, %rsp
 7146 000c 48897DE8 		movq	%rdi, -24(%rbp)
 7147 0010 488975E0 		movq	%rsi, -32(%rbp)
 7148 0014 488955D8 		movq	%rdx, -40(%rbp)
 7149              		.loc 4 6019 1
 7150 0018 64488B04 		movq	%fs:40, %rax
 7150      25280000 
 7150      00
 7151 0021 488945F8 		movq	%rax, -8(%rbp)
 7152 0025 31C0     		xorl	%eax, %eax
6020:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1) || \
6021:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_1)
6022:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      mbedtls_md5_update_ret( &ssl->handshake->fin_md5 , buf, len );
6023:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_update_ret( &ssl->handshake->fin_sha1, buf, len );
6024:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6025:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
6026:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
6027:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha256_update_ret( &ssl->handshake->fin_sha256, buf, len );
 7153              		.loc 4 6027 36
 7154 0027 488B45E8 		movq	-24(%rbp), %rax
 7155 002b 488B4060 		movq	96(%rax), %rax
 7156              		.loc 4 6027 5
 7157 002f 488D8880 		leaq	640(%rax), %rcx
 7157      020000
 7158 0036 488B55D8 		movq	-40(%rbp), %rdx
 7159 003a 488B45E0 		movq	-32(%rbp), %rax
 7160 003e 4889C6   		movq	%rax, %rsi
 7161 0041 4889CF   		movq	%rcx, %rdi
 7162 0044 E8000000 		call	mbedtls_sha256_update_ret@PLT
 7162      00
6028:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6029:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
6030:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha512_update_ret( &ssl->handshake->fin_sha512, buf, len );
6031:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6032:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
6033:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 7163              		.loc 4 6033 1
 7164 0049 90       		nop
 7165 004a 488B45F8 		movq	-8(%rbp), %rax
 7166 004e 64483304 		xorq	%fs:40, %rax
 7166      25280000 
 7166      00
 7167 0057 7405     		je	.L424
 7168 0059 E8000000 		call	__stack_chk_fail@PLT
 7168      00
 7169              	.L424:
GAS LISTING /tmp/ccEn8xFO.s 			page 289


 7170 005e C9       		leave
 7171              	.LCFI131:
 7172              		.cfi_def_cfa 7, 8
 7173 005f C3       		ret
 7174              		.cfi_endproc
 7175              	.LFE62:
 7177              		.section	.text.ssl_update_checksum_sha256,"ax",@progbits
 7179              	ssl_update_checksum_sha256:
 7180              	.LFB63:
6034:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6035:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1) || \
6036:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_1)
6037:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_update_checksum_md5sha1( mbedtls_ssl_context *ssl,
6038:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                          const unsigned char *buf, size_t len )
6039:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
6040:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      mbedtls_md5_update_ret( &ssl->handshake->fin_md5 , buf, len );
6041:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_update_ret( &ssl->handshake->fin_sha1, buf, len );
6042:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
6043:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6044:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6045:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
6046:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
6047:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_update_checksum_sha256( mbedtls_ssl_context *ssl,
6048:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         const unsigned char *buf, size_t len )
6049:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 7181              		.loc 4 6049 1
 7182              		.cfi_startproc
 7183 0000 F30F1EFA 		endbr64
 7184 0004 55       		pushq	%rbp
 7185              	.LCFI132:
 7186              		.cfi_def_cfa_offset 16
 7187              		.cfi_offset 6, -16
 7188 0005 4889E5   		movq	%rsp, %rbp
 7189              	.LCFI133:
 7190              		.cfi_def_cfa_register 6
 7191 0008 4883EC30 		subq	$48, %rsp
 7192 000c 48897DE8 		movq	%rdi, -24(%rbp)
 7193 0010 488975E0 		movq	%rsi, -32(%rbp)
 7194 0014 488955D8 		movq	%rdx, -40(%rbp)
 7195              		.loc 4 6049 1
 7196 0018 64488B04 		movq	%fs:40, %rax
 7196      25280000 
 7196      00
 7197 0021 488945F8 		movq	%rax, -8(%rbp)
 7198 0025 31C0     		xorl	%eax, %eax
6050:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha256_update_ret( &ssl->handshake->fin_sha256, buf, len );
 7199              		.loc 4 6050 36
 7200 0027 488B45E8 		movq	-24(%rbp), %rax
 7201 002b 488B4060 		movq	96(%rax), %rax
 7202              		.loc 4 6050 5
 7203 002f 488D8880 		leaq	640(%rax), %rcx
 7203      020000
 7204 0036 488B55D8 		movq	-40(%rbp), %rdx
 7205 003a 488B45E0 		movq	-32(%rbp), %rax
 7206 003e 4889C6   		movq	%rax, %rsi
 7207 0041 4889CF   		movq	%rcx, %rdi
 7208 0044 E8000000 		call	mbedtls_sha256_update_ret@PLT
GAS LISTING /tmp/ccEn8xFO.s 			page 290


 7208      00
6051:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 7209              		.loc 4 6051 1
 7210 0049 90       		nop
 7211 004a 488B45F8 		movq	-8(%rbp), %rax
 7212 004e 64483304 		xorq	%fs:40, %rax
 7212      25280000 
 7212      00
 7213 0057 7405     		je	.L426
 7214 0059 E8000000 		call	__stack_chk_fail@PLT
 7214      00
 7215              	.L426:
 7216 005e C9       		leave
 7217              	.LCFI134:
 7218              		.cfi_def_cfa 7, 8
 7219 005f C3       		ret
 7220              		.cfi_endproc
 7221              	.LFE63:
 7223              		.section	.rodata
 7224              	.LC3:
 7225 0033 636C6965 		.string	"client finished"
 7225      6E742066 
 7225      696E6973 
 7225      68656400 
 7226              	.LC4:
 7227 0043 73657276 		.string	"server finished"
 7227      65722066 
 7227      696E6973 
 7227      68656400 
 7228              		.section	.text.ssl_calc_finished_tls_sha256,"ax",@progbits
 7230              	ssl_calc_finished_tls_sha256:
 7231              	.LFB64:
6052:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6053:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6054:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
6055:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_update_checksum_sha384( mbedtls_ssl_context *ssl,
6056:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         const unsigned char *buf, size_t len )
6057:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
6058:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha512_update_ret( &ssl->handshake->fin_sha512, buf, len );
6059:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
6060:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6061:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
6062:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6063:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
6064:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_calc_finished_ssl(
6065:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 mbedtls_ssl_context *ssl, unsigned char *buf, int from )
6066:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
6067:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const char *sender;
6068:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_context  md5;
6069:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_context sha1;
6070:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6071:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char padbuf[48];
6072:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char md5sum[16];
6073:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char sha1sum[20];
6074:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6075:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_session *session = ssl->session_negotiate;
6076:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( !session )
GAS LISTING /tmp/ccEn8xFO.s 			page 291


6077:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         session = ssl->session;
6078:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6079:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> calc  finished ssl" ) );
6080:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6081:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_init( &md5 );
6082:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_init( &sha1 );
6083:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6084:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_clone( &md5, &ssl->handshake->fin_md5 );
6085:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_clone( &sha1, &ssl->handshake->fin_sha1 );
6086:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6087:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
6088:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * SSLv3:
6089:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *   hash =
6090:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *      MD5( master + pad2 +
6091:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *          MD5( handshake + sender + master + pad1 ) )
6092:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *   + SHA1( master + pad2 +
6093:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *         SHA1( handshake + sender + master + pad1 ) )
6094:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
6095:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6096:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if !defined(MBEDTLS_MD5_ALT)
6097:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "finished  md5 state", (unsigned char *)
6098:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     md5.state, sizeof(  md5.state ) );
6099:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6100:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6101:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if !defined(MBEDTLS_SHA1_ALT)
6102:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "finished sha1 state", (unsigned char *)
6103:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                    sha1.state, sizeof( sha1.state ) );
6104:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6105:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6106:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     sender = ( from == MBEDTLS_SSL_IS_CLIENT ) ? "CLNT"
6107:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                        : "SRVR";
6108:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6109:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memset( padbuf, 0x36, 48 );
6110:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6111:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_update_ret( &md5, (const unsigned char *) sender, 4 );
6112:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_update_ret( &md5, session->master, 48 );
6113:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_update_ret( &md5, padbuf, 48 );
6114:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_finish_ret( &md5, md5sum );
6115:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6116:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_update_ret( &sha1, (const unsigned char *) sender, 4 );
6117:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_update_ret( &sha1, session->master, 48 );
6118:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_update_ret( &sha1, padbuf, 40 );
6119:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_finish_ret( &sha1, sha1sum );
6120:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6121:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memset( padbuf, 0x5C, 48 );
6122:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_starts_ret( &md5 );
6124:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_update_ret( &md5, session->master, 48 );
6125:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_update_ret( &md5, padbuf, 48 );
6126:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_update_ret( &md5, md5sum, 16 );
6127:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_finish_ret( &md5, buf );
6128:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6129:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_starts_ret( &sha1 );
6130:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_update_ret( &sha1, session->master, 48 );
6131:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_update_ret( &sha1, padbuf , 40 );
6132:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_update_ret( &sha1, sha1sum, 20 );
6133:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_finish_ret( &sha1, buf + 16 );
GAS LISTING /tmp/ccEn8xFO.s 			page 292


6134:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6135:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "calc finished result", buf, 36 );
6136:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6137:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_free(  &md5  );
6138:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_free( &sha1 );
6139:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6140:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_platform_zeroize(  padbuf, sizeof(  padbuf ) );
6141:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_platform_zeroize(  md5sum, sizeof(  md5sum ) );
6142:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_platform_zeroize( sha1sum, sizeof( sha1sum ) );
6143:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6144:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= calc  finished" ) );
6145:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
6146:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 */
6147:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6148:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1)
6149:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_calc_finished_tls(
6150:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 mbedtls_ssl_context *ssl, unsigned char *buf, int from )
6151:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
6152:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int len = 12;
6153:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const char *sender;
6154:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_context  md5;
6155:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_context sha1;
6156:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char padbuf[36];
6157:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6158:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_session *session = ssl->session_negotiate;
6159:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( !session )
6160:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         session = ssl->session;
6161:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6162:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> calc  finished tls" ) );
6163:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6164:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_init( &md5 );
6165:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_init( &sha1 );
6166:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6167:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_clone( &md5, &ssl->handshake->fin_md5 );
6168:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_clone( &sha1, &ssl->handshake->fin_sha1 );
6169:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6170:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
6171:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * TLSv1:
6172:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *   hash = PRF( master, finished_label,
6173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *               MD5( handshake ) + SHA1( handshake ) )[0..11]
6174:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
6175:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6176:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if !defined(MBEDTLS_MD5_ALT)
6177:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "finished  md5 state", (unsigned char *)
6178:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     md5.state, sizeof(  md5.state ) );
6179:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6180:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6181:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if !defined(MBEDTLS_SHA1_ALT)
6182:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "finished sha1 state", (unsigned char *)
6183:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                    sha1.state, sizeof( sha1.state ) );
6184:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6185:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6186:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     sender = ( from == MBEDTLS_SSL_IS_CLIENT )
6187:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              ? "client finished"
6188:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              : "server finished";
6189:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6190:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_finish_ret(  &md5, padbuf );
GAS LISTING /tmp/ccEn8xFO.s 			page 293


6191:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_finish_ret( &sha1, padbuf + 16 );
6192:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6193:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->handshake->tls_prf( session->master, 48, sender,
6194:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                              padbuf, 36, buf, len );
6195:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6196:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "calc finished result", buf, len );
6197:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6198:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_free(  &md5  );
6199:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_free( &sha1 );
6200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6201:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_platform_zeroize(  padbuf, sizeof(  padbuf ) );
6202:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6203:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= calc  finished" ) );
6204:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
6205:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1 || MBEDTLS_SSL_PROTO_TLS1_1 */
6206:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6207:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
6208:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
6209:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_calc_finished_tls_sha256(
6210:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 mbedtls_ssl_context *ssl, unsigned char *buf, int from )
6211:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 7232              		.loc 4 6211 1
 7233              		.cfi_startproc
 7234 0000 F30F1EFA 		endbr64
 7235 0004 55       		pushq	%rbp
 7236              	.LCFI135:
 7237              		.cfi_def_cfa_offset 16
 7238              		.cfi_offset 6, -16
 7239 0005 4889E5   		movq	%rsp, %rbp
 7240              	.LCFI136:
 7241              		.cfi_def_cfa_register 6
 7242 0008 4881ECE0 		subq	$224, %rsp
 7242      000000
 7243 000f 4889BD38 		movq	%rdi, -200(%rbp)
 7243      FFFFFF
 7244 0016 4889B530 		movq	%rsi, -208(%rbp)
 7244      FFFFFF
 7245 001d 89952CFF 		movl	%edx, -212(%rbp)
 7245      FFFF
 7246              		.loc 4 6211 1
 7247 0023 64488B04 		movq	%fs:40, %rax
 7247      25280000 
 7247      00
 7248 002c 488945F8 		movq	%rax, -8(%rbp)
 7249 0030 31C0     		xorl	%eax, %eax
6212:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int len = 12;
 7250              		.loc 4 6212 9
 7251 0032 C7854CFF 		movl	$12, -180(%rbp)
 7251      FFFF0C00 
 7251      0000
6213:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const char *sender;
6214:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha256_context sha256;
6215:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char padbuf[32];
6216:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6217:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_session *session = ssl->session_negotiate;
 7252              		.loc 4 6217 26
 7253 003c 488B8538 		movq	-200(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 294


 7253      FFFFFF
 7254 0043 488B4058 		movq	88(%rax), %rax
 7255 0047 48898550 		movq	%rax, -176(%rbp)
 7255      FFFFFF
6218:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( !session )
 7256              		.loc 4 6218 7
 7257 004e 4883BD50 		cmpq	$0, -176(%rbp)
 7257      FFFFFF00 
 7258 0056 7512     		jne	.L428
6219:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         session = ssl->session;
 7259              		.loc 4 6219 17
 7260 0058 488B8538 		movq	-200(%rbp), %rax
 7260      FFFFFF
 7261 005f 488B4050 		movq	80(%rax), %rax
 7262 0063 48898550 		movq	%rax, -176(%rbp)
 7262      FFFFFF
 7263              	.L428:
6220:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6221:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha256_init( &sha256 );
 7264              		.loc 4 6221 5
 7265 006a 488D8560 		leaq	-160(%rbp), %rax
 7265      FFFFFF
 7266 0071 4889C7   		movq	%rax, %rdi
 7267 0074 E8000000 		call	mbedtls_sha256_init@PLT
 7267      00
6222:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6223:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> calc  finished tls sha256" ) );
6224:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6225:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha256_clone( &sha256, &ssl->handshake->fin_sha256 );
 7268              		.loc 4 6225 40
 7269 0079 488B8538 		movq	-200(%rbp), %rax
 7269      FFFFFF
 7270 0080 488B4060 		movq	96(%rax), %rax
 7271              		.loc 4 6225 36
 7272 0084 488D9080 		leaq	640(%rax), %rdx
 7272      020000
 7273              		.loc 4 6225 5
 7274 008b 488D8560 		leaq	-160(%rbp), %rax
 7274      FFFFFF
 7275 0092 4889D6   		movq	%rdx, %rsi
 7276 0095 4889C7   		movq	%rax, %rdi
 7277 0098 E8000000 		call	mbedtls_sha256_clone@PLT
 7277      00
6226:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6227:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
6228:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * TLSv1.2:
6229:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *   hash = PRF( master, finished_label,
6230:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *               Hash( handshake ) )[0.11]
6231:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
6232:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6233:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if !defined(MBEDTLS_SHA256_ALT)
6234:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "finished sha2 state", (unsigned char *)
6235:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                    sha256.state, sizeof( sha256.state ) );
6236:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6237:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6238:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     sender = ( from == MBEDTLS_SSL_IS_CLIENT )
 7278              		.loc 4 6238 12
GAS LISTING /tmp/ccEn8xFO.s 			page 295


 7279 009d 83BD2CFF 		cmpl	$0, -212(%rbp)
 7279      FFFF00
 7280 00a4 7509     		jne	.L429
 7281              		.loc 4 6238 12 is_stmt 0 discriminator 1
 7282 00a6 488D0500 		leaq	.LC3(%rip), %rax
 7282      000000
 7283 00ad EB07     		jmp	.L430
 7284              	.L429:
 7285              		.loc 4 6238 12 discriminator 2
 7286 00af 488D0500 		leaq	.LC4(%rip), %rax
 7286      000000
 7287              	.L430:
 7288              		.loc 4 6238 12 discriminator 4
 7289 00b6 48898558 		movq	%rax, -168(%rbp)
 7289      FFFFFF
6239:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              ? "client finished"
6240:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              : "server finished";
6241:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6242:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha256_finish_ret( &sha256, padbuf );
 7290              		.loc 4 6242 5 is_stmt 1 discriminator 4
 7291 00bd 488D55D0 		leaq	-48(%rbp), %rdx
 7292 00c1 488D8560 		leaq	-160(%rbp), %rax
 7292      FFFFFF
 7293 00c8 4889D6   		movq	%rdx, %rsi
 7294 00cb 4889C7   		movq	%rax, %rdi
 7295 00ce E8000000 		call	mbedtls_sha256_finish_ret@PLT
 7295      00
6243:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6244:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->handshake->tls_prf( session->master, 48, sender,
 7296              		.loc 4 6244 8 discriminator 4
 7297 00d3 488B8538 		movq	-200(%rbp), %rax
 7297      FFFFFF
 7298 00da 488B4060 		movq	96(%rax), %rax
 7299              		.loc 4 6244 19 discriminator 4
 7300 00de 4C8B9008 		movq	776(%rax), %r10
 7300      030000
 7301              		.loc 4 6244 5 discriminator 4
 7302 00e5 8B854CFF 		movl	-180(%rbp), %eax
 7302      FFFF
 7303 00eb 4863C8   		movslq	%eax, %rcx
 7304              		.loc 4 6244 37 discriminator 4
 7305 00ee 488B8550 		movq	-176(%rbp), %rax
 7305      FFFFFF
 7306 00f5 488D7830 		leaq	48(%rax), %rdi
 7307              		.loc 4 6244 5 discriminator 4
 7308 00f9 488BB530 		movq	-208(%rbp), %rsi
 7308      FFFFFF
 7309 0100 488D55D0 		leaq	-48(%rbp), %rdx
 7310 0104 488B8558 		movq	-168(%rbp), %rax
 7310      FFFFFF
 7311 010b 4883EC08 		subq	$8, %rsp
 7312 010f 51       		pushq	%rcx
 7313 0110 4989F1   		movq	%rsi, %r9
 7314 0113 41B82000 		movl	$32, %r8d
 7314      0000
 7315 0119 4889D1   		movq	%rdx, %rcx
 7316 011c 4889C2   		movq	%rax, %rdx
GAS LISTING /tmp/ccEn8xFO.s 			page 296


 7317 011f BE300000 		movl	$48, %esi
 7317      00
 7318 0124 41FFD2   		call	*%r10
 7319              	.LVL13:
 7320 0127 4883C410 		addq	$16, %rsp
6245:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                              padbuf, 32, buf, len );
6246:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6247:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "calc finished result", buf, len );
6248:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6249:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha256_free( &sha256 );
 7321              		.loc 4 6249 5 discriminator 4
 7322 012b 488D8560 		leaq	-160(%rbp), %rax
 7322      FFFFFF
 7323 0132 4889C7   		movq	%rax, %rdi
 7324 0135 E8000000 		call	mbedtls_sha256_free@PLT
 7324      00
6250:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6251:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_platform_zeroize(  padbuf, sizeof(  padbuf ) );
 7325              		.loc 4 6251 5 discriminator 4
 7326 013a 488D45D0 		leaq	-48(%rbp), %rax
 7327 013e BE200000 		movl	$32, %esi
 7327      00
 7328 0143 4889C7   		movq	%rax, %rdi
 7329 0146 E8000000 		call	mbedtls_platform_zeroize@PLT
 7329      00
6252:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6253:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= calc  finished" ) );
6254:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 7330              		.loc 4 6254 1 discriminator 4
 7331 014b 90       		nop
 7332 014c 488B45F8 		movq	-8(%rbp), %rax
 7333 0150 64483304 		xorq	%fs:40, %rax
 7333      25280000 
 7333      00
 7334 0159 7405     		je	.L431
 7335              		.loc 4 6254 1 is_stmt 0
 7336 015b E8000000 		call	__stack_chk_fail@PLT
 7336      00
 7337              	.L431:
 7338 0160 C9       		leave
 7339              	.LCFI137:
 7340              		.cfi_def_cfa 7, 8
 7341 0161 C3       		ret
 7342              		.cfi_endproc
 7343              	.LFE64:
 7345              		.section	.text.ssl_handshake_wrapup_free_hs_transform,"ax",@progbits
 7347              	ssl_handshake_wrapup_free_hs_transform:
 7348              	.LFB65:
6255:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SHA256_C */
6256:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6257:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
6258:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_calc_finished_tls_sha384(
6259:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 mbedtls_ssl_context *ssl, unsigned char *buf, int from )
6260:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
6261:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int len = 12;
6262:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const char *sender;
6263:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha512_context sha512;
GAS LISTING /tmp/ccEn8xFO.s 			page 297


6264:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char padbuf[48];
6265:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6266:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_session *session = ssl->session_negotiate;
6267:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( !session )
6268:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         session = ssl->session;
6269:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6270:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha512_init( &sha512 );
6271:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6272:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> calc  finished tls sha384" ) );
6273:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6274:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha512_clone( &sha512, &ssl->handshake->fin_sha512 );
6275:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6276:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
6277:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * TLSv1.2:
6278:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *   hash = PRF( master, finished_label,
6279:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *               Hash( handshake ) )[0.11]
6280:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
6281:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6282:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if !defined(MBEDTLS_SHA512_ALT)
6283:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "finished sha512 state", (unsigned char *)
6284:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                    sha512.state, sizeof( sha512.state ) );
6285:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6286:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6287:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     sender = ( from == MBEDTLS_SSL_IS_CLIENT )
6288:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              ? "client finished"
6289:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              : "server finished";
6290:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6291:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha512_finish_ret( &sha512, padbuf );
6292:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6293:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->handshake->tls_prf( session->master, 48, sender,
6294:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                              padbuf, 48, buf, len );
6295:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6296:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "calc finished result", buf, len );
6297:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6298:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha512_free( &sha512 );
6299:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6300:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_platform_zeroize(  padbuf, sizeof( padbuf ) );
6301:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= calc  finished" ) );
6303:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
6304:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SHA512_C */
6305:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
6306:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6307:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_handshake_wrapup_free_hs_transform( mbedtls_ssl_context *ssl )
6308:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 7349              		.loc 4 6308 1 is_stmt 1
 7350              		.cfi_startproc
 7351 0000 F30F1EFA 		endbr64
 7352 0004 55       		pushq	%rbp
 7353              	.LCFI138:
 7354              		.cfi_def_cfa_offset 16
 7355              		.cfi_offset 6, -16
 7356 0005 4889E5   		movq	%rsp, %rbp
 7357              	.LCFI139:
 7358              		.cfi_def_cfa_register 6
 7359 0008 4883EC20 		subq	$32, %rsp
 7360 000c 48897DE8 		movq	%rdi, -24(%rbp)
GAS LISTING /tmp/ccEn8xFO.s 			page 298


 7361              		.loc 4 6308 1
 7362 0010 64488B04 		movq	%fs:40, %rax
 7362      25280000 
 7362      00
 7363 0019 488945F8 		movq	%rax, -8(%rbp)
 7364 001d 31C0     		xorl	%eax, %eax
6309:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "=> handshake wrapup: final free" ) );
6310:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6311:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
6312:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Free our handshake params
6313:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
6314:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_handshake_free( ssl );
 7365              		.loc 4 6314 5
 7366 001f 488B45E8 		movq	-24(%rbp), %rax
 7367 0023 4889C7   		movq	%rax, %rdi
 7368 0026 E8000000 		call	mbedtls_ssl_handshake_free
 7368      00
6315:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_free( ssl->handshake );
 7369              		.loc 4 6315 22
 7370 002b 488B45E8 		movq	-24(%rbp), %rax
 7371 002f 488B4060 		movq	96(%rax), %rax
 7372              		.loc 4 6315 5
 7373 0033 4889C7   		movq	%rax, %rdi
 7374 0036 E8000000 		call	mbedtls_free@PLT
 7374      00
6316:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->handshake = NULL;
 7375              		.loc 4 6316 20
 7376 003b 488B45E8 		movq	-24(%rbp), %rax
 7377 003f 48C74060 		movq	$0, 96(%rax)
 7377      00000000 
6317:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6318:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
6319:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Free the previous transform and swith in the current one
6320:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
6321:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->transform )
 7378              		.loc 4 6321 12
 7379 0047 488B45E8 		movq	-24(%rbp), %rax
 7380 004b 488B4078 		movq	120(%rax), %rax
 7381              		.loc 4 6321 7
 7382 004f 4885C0   		testq	%rax, %rax
 7383 0052 7420     		je	.L433
6322:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6323:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_transform_free( ssl->transform );
 7384              		.loc 4 6323 9
 7385 0054 488B45E8 		movq	-24(%rbp), %rax
 7386 0058 488B4078 		movq	120(%rax), %rax
 7387 005c 4889C7   		movq	%rax, %rdi
 7388 005f E8000000 		call	mbedtls_ssl_transform_free
 7388      00
6324:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( ssl->transform );
 7389              		.loc 4 6324 26
 7390 0064 488B45E8 		movq	-24(%rbp), %rax
 7391 0068 488B4078 		movq	120(%rax), %rax
 7392              		.loc 4 6324 9
 7393 006c 4889C7   		movq	%rax, %rdi
 7394 006f E8000000 		call	mbedtls_free@PLT
 7394      00
GAS LISTING /tmp/ccEn8xFO.s 			page 299


 7395              	.L433:
6325:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6326:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->transform = ssl->transform_negotiate;
 7396              		.loc 4 6326 25
 7397 0074 488B45E8 		movq	-24(%rbp), %rax
 7398 0078 488B9080 		movq	128(%rax), %rdx
 7398      000000
 7399              		.loc 4 6326 20
 7400 007f 488B45E8 		movq	-24(%rbp), %rax
 7401 0083 48895078 		movq	%rdx, 120(%rax)
6327:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->transform_negotiate = NULL;
 7402              		.loc 4 6327 30
 7403 0087 488B45E8 		movq	-24(%rbp), %rax
 7404 008b 48C78080 		movq	$0, 128(%rax)
 7404      00000000 
 7404      000000
6328:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6329:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "<= handshake wrapup: final free" ) );
6330:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 7405              		.loc 4 6330 1
 7406 0096 90       		nop
 7407 0097 488B45F8 		movq	-8(%rbp), %rax
 7408 009b 64483304 		xorq	%fs:40, %rax
 7408      25280000 
 7408      00
 7409 00a4 7405     		je	.L434
 7410 00a6 E8000000 		call	__stack_chk_fail@PLT
 7410      00
 7411              	.L434:
 7412 00ab C9       		leave
 7413              	.LCFI140:
 7414              		.cfi_def_cfa 7, 8
 7415 00ac C3       		ret
 7416              		.cfi_endproc
 7417              	.LFE65:
 7419              		.section	.text.mbedtls_ssl_handshake_wrapup,"ax",@progbits
 7420              		.globl	mbedtls_ssl_handshake_wrapup
 7422              	mbedtls_ssl_handshake_wrapup:
 7423              	.LFB66:
6331:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6332:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_handshake_wrapup( mbedtls_ssl_context *ssl )
6333:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 7424              		.loc 4 6333 1
 7425              		.cfi_startproc
 7426 0000 F30F1EFA 		endbr64
 7427 0004 55       		pushq	%rbp
 7428              	.LCFI141:
 7429              		.cfi_def_cfa_offset 16
 7430              		.cfi_offset 6, -16
 7431 0005 4889E5   		movq	%rsp, %rbp
 7432              	.LCFI142:
 7433              		.cfi_def_cfa_register 6
 7434 0008 4883EC20 		subq	$32, %rsp
 7435 000c 48897DE8 		movq	%rdi, -24(%rbp)
 7436              		.loc 4 6333 1
 7437 0010 64488B04 		movq	%fs:40, %rax
 7437      25280000 
GAS LISTING /tmp/ccEn8xFO.s 			page 300


 7437      00
 7438 0019 488945F8 		movq	%rax, -8(%rbp)
 7439 001d 31C0     		xorl	%eax, %eax
6334:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int resume = ssl->handshake->resume;
 7440              		.loc 4 6334 21
 7441 001f 488B45E8 		movq	-24(%rbp), %rax
 7442 0023 488B4060 		movq	96(%rax), %rax
 7443              		.loc 4 6334 9
 7444 0027 8B809C03 		movl	924(%rax), %eax
 7444      0000
 7445 002d 8945F4   		movl	%eax, -12(%rbp)
6335:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6336:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "=> handshake wrapup" ) );
6337:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6338:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
6339:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->renego_status == MBEDTLS_SSL_RENEGOTIATION_IN_PROGRESS )
 7446              		.loc 4 6339 12
 7447 0030 488B45E8 		movq	-24(%rbp), %rax
 7448 0034 8B400C   		movl	12(%rax), %eax
 7449              		.loc 4 6339 7
 7450 0037 83F801   		cmpl	$1, %eax
 7451 003a 7516     		jne	.L436
6340:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6341:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->renego_status =  MBEDTLS_SSL_RENEGOTIATION_DONE;
 7452              		.loc 4 6341 28
 7453 003c 488B45E8 		movq	-24(%rbp), %rax
 7454 0040 C7400C02 		movl	$2, 12(%rax)
 7454      000000
6342:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->renego_records_seen = 0;
 7455              		.loc 4 6342 34
 7456 0047 488B45E8 		movq	-24(%rbp), %rax
 7457 004b C7401000 		movl	$0, 16(%rax)
 7457      000000
 7458              	.L436:
6343:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6344:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6345:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6346:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
6347:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Free the previous session and switch in the current one
6348:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
6349:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->session )
 7459              		.loc 4 6349 12
 7460 0052 488B45E8 		movq	-24(%rbp), %rax
 7461 0056 488B4050 		movq	80(%rax), %rax
 7462              		.loc 4 6349 7
 7463 005a 4885C0   		testq	%rax, %rax
 7464 005d 7420     		je	.L437
6350:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6351:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_ENCRYPT_THEN_MAC)
6352:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* RFC 7366 3.1: keep the EtM state */
6353:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->session_negotiate->encrypt_then_mac =
6354:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                   ssl->session->encrypt_then_mac;
6355:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6356:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6357:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_session_free( ssl->session );
 7465              		.loc 4 6357 9
 7466 005f 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 301


 7467 0063 488B4050 		movq	80(%rax), %rax
 7468 0067 4889C7   		movq	%rax, %rdi
 7469 006a E8000000 		call	mbedtls_ssl_session_free
 7469      00
6358:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( ssl->session );
 7470              		.loc 4 6358 26
 7471 006f 488B45E8 		movq	-24(%rbp), %rax
 7472 0073 488B4050 		movq	80(%rax), %rax
 7473              		.loc 4 6358 9
 7474 0077 4889C7   		movq	%rax, %rdi
 7475 007a E8000000 		call	mbedtls_free@PLT
 7475      00
 7476              	.L437:
6359:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6360:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->session = ssl->session_negotiate;
 7477              		.loc 4 6360 23
 7478 007f 488B45E8 		movq	-24(%rbp), %rax
 7479 0083 488B5058 		movq	88(%rax), %rdx
 7480              		.loc 4 6360 18
 7481 0087 488B45E8 		movq	-24(%rbp), %rax
 7482 008b 48895050 		movq	%rdx, 80(%rax)
6361:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->session_negotiate = NULL;
 7483              		.loc 4 6361 28
 7484 008f 488B45E8 		movq	-24(%rbp), %rax
 7485 0093 48C74058 		movq	$0, 88(%rax)
 7485      00000000 
6362:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6363:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
6364:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Add cache entry
6365:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
6366:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->f_set_cache != NULL &&
 7486              		.loc 4 6366 12
 7487 009b 488B45E8 		movq	-24(%rbp), %rax
 7488 009f 488B00   		movq	(%rax), %rax
 7489              		.loc 4 6366 18
 7490 00a2 488B4048 		movq	72(%rax), %rax
 7491              		.loc 4 6366 7
 7492 00a6 4885C0   		testq	%rax, %rax
 7493 00a9 743D     		je	.L438
6367:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->session->id_len != 0 &&
 7494              		.loc 4 6367 12 discriminator 1
 7495 00ab 488B45E8 		movq	-24(%rbp), %rax
 7496 00af 488B4050 		movq	80(%rax), %rax
 7497              		.loc 4 6367 21 discriminator 1
 7498 00b3 488B4008 		movq	8(%rax), %rax
6366:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->session->id_len != 0 &&
 7499              		.loc 4 6366 40 discriminator 1
 7500 00b7 4885C0   		testq	%rax, %rax
 7501 00ba 742C     		je	.L438
 7502              		.loc 4 6367 35
 7503 00bc 837DF400 		cmpl	$0, -12(%rbp)
 7504 00c0 7526     		jne	.L438
6368:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         resume == 0 )
6369:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6370:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->conf->f_set_cache( ssl->conf->p_cache, ssl->session ) != 0 )
 7505              		.loc 4 6370 16
 7506 00c2 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 302


 7507 00c6 488B00   		movq	(%rax), %rax
 7508              		.loc 4 6370 22
 7509 00c9 488B4848 		movq	72(%rax), %rcx
 7510              		.loc 4 6370 60
 7511 00cd 488B45E8 		movq	-24(%rbp), %rax
 7512 00d1 488B5050 		movq	80(%rax), %rdx
 7513              		.loc 4 6370 40
 7514 00d5 488B45E8 		movq	-24(%rbp), %rax
 7515 00d9 488B00   		movq	(%rax), %rax
 7516              		.loc 4 6370 13
 7517 00dc 488B4050 		movq	80(%rax), %rax
 7518 00e0 4889D6   		movq	%rdx, %rsi
 7519 00e3 4889C7   		movq	%rax, %rdi
 7520 00e6 FFD1     		call	*%rcx
 7521              	.LVL14:
 7522              	.L438:
6371:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "cache did not store session" ) );
6372:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6373:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6374:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
6375:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
6376:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake->flight != NULL )
6377:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6378:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Cancel handshake timer */
6379:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl_set_timer( ssl, 0 );
6380:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6381:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Keep last flight around in case we need to resend it:
6382:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * we need the handshake and transform structures for that */
6383:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "skip freeing handshake and transform" ) );
6384:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6385:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
6386:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6387:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl_handshake_wrapup_free_hs_transform( ssl );
 7523              		.loc 4 6387 9
 7524 00e8 488B45E8 		movq	-24(%rbp), %rax
 7525 00ec 4889C7   		movq	%rax, %rdi
 7526 00ef E8000000 		call	ssl_handshake_wrapup_free_hs_transform
 7526      00
6388:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6389:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->state++;
 7527              		.loc 4 6389 8
 7528 00f4 488B45E8 		movq	-24(%rbp), %rax
 7529 00f8 8B4008   		movl	8(%rax), %eax
 7530              		.loc 4 6389 15
 7531 00fb 8D5001   		leal	1(%rax), %edx
 7532 00fe 488B45E8 		movq	-24(%rbp), %rax
 7533 0102 895008   		movl	%edx, 8(%rax)
6390:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6391:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "<= handshake wrapup" ) );
6392:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 7534              		.loc 4 6392 1
 7535 0105 90       		nop
 7536 0106 488B45F8 		movq	-8(%rbp), %rax
 7537 010a 64483304 		xorq	%fs:40, %rax
 7537      25280000 
 7537      00
 7538 0113 7405     		je	.L439
GAS LISTING /tmp/ccEn8xFO.s 			page 303


 7539 0115 E8000000 		call	__stack_chk_fail@PLT
 7539      00
 7540              	.L439:
 7541 011a C9       		leave
 7542              	.LCFI143:
 7543              		.cfi_def_cfa 7, 8
 7544 011b C3       		ret
 7545              		.cfi_endproc
 7546              	.LFE66:
 7548              		.section	.text.mbedtls_ssl_write_finished,"ax",@progbits
 7549              		.globl	mbedtls_ssl_write_finished
 7551              	mbedtls_ssl_write_finished:
 7552              	.LFB67:
6393:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6394:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_write_finished( mbedtls_ssl_context *ssl )
6395:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 7553              		.loc 4 6395 1
 7554              		.cfi_startproc
 7555 0000 F30F1EFA 		endbr64
 7556 0004 55       		pushq	%rbp
 7557              	.LCFI144:
 7558              		.cfi_def_cfa_offset 16
 7559              		.cfi_offset 6, -16
 7560 0005 4889E5   		movq	%rsp, %rbp
 7561              	.LCFI145:
 7562              		.cfi_def_cfa_register 6
 7563 0008 4883EC20 		subq	$32, %rsp
 7564 000c 48897DE8 		movq	%rdi, -24(%rbp)
 7565              		.loc 4 6395 1
 7566 0010 64488B04 		movq	%fs:40, %rax
 7566      25280000 
 7566      00
 7567 0019 488945F8 		movq	%rax, -8(%rbp)
 7568 001d 31C0     		xorl	%eax, %eax
6396:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret, hash_len;
6397:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6398:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> write finished" ) );
6399:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6400:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_update_out_pointers( ssl, ssl->transform_negotiate );
 7569              		.loc 4 6400 5
 7570 001f 488B45E8 		movq	-24(%rbp), %rax
 7571 0023 488B9080 		movq	128(%rax), %rdx
 7571      000000
 7572 002a 488B45E8 		movq	-24(%rbp), %rax
 7573 002e 4889D6   		movq	%rdx, %rsi
 7574 0031 4889C7   		movq	%rax, %rdi
 7575 0034 E8000000 		call	ssl_update_out_pointers
 7575      00
6401:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6402:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->handshake->calc_finished( ssl, ssl->out_msg + 4, ssl->conf->endpoint );
 7576              		.loc 4 6402 8
 7577 0039 488B45E8 		movq	-24(%rbp), %rax
 7578 003d 488B4060 		movq	96(%rax), %rax
 7579              		.loc 4 6402 19
 7580 0041 488B8800 		movq	768(%rax), %rcx
 7580      030000
 7581              		.loc 4 6402 62
GAS LISTING /tmp/ccEn8xFO.s 			page 304


 7582 0048 488B45E8 		movq	-24(%rbp), %rax
 7583 004c 488B00   		movq	(%rax), %rax
 7584              		.loc 4 6402 68
 7585 004f 0FB680BC 		movzbl	188(%rax), %eax
 7585      000000
 7586 0056 83E001   		andl	$1, %eax
 7587              		.loc 4 6402 5
 7588 0059 0FB6D0   		movzbl	%al, %edx
 7589              		.loc 4 6402 44
 7590 005c 488B45E8 		movq	-24(%rbp), %rax
 7591 0060 488B8028 		movq	296(%rax), %rax
 7591      010000
 7592              		.loc 4 6402 5
 7593 0067 488D7004 		leaq	4(%rax), %rsi
 7594 006b 488B45E8 		movq	-24(%rbp), %rax
 7595 006f 4889C7   		movq	%rax, %rdi
 7596 0072 FFD1     		call	*%rcx
 7597              	.LVL15:
6403:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6404:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
6405:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * RFC 5246 7.4.9 (Page 63) says 12 is the default length and ciphersuites
6406:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * may define some other value. Currently (early 2016), no defined
6407:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * ciphersuite does this (and this is unlikely to change as activity has
6408:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * moved to TLS 1.3 now) so we can keep the hardcoded 12 here.
6409:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
6410:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     hash_len = ( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 ) ? 36 : 12;
 7598              		.loc 4 6410 21
 7599 0074 488B45E8 		movq	-24(%rbp), %rax
 7600 0078 8B4018   		movl	24(%rax), %eax
 7601              		.loc 4 6410 71
 7602 007b 85C0     		testl	%eax, %eax
 7603 007d 7507     		jne	.L441
 7604              		.loc 4 6410 71 is_stmt 0 discriminator 1
 7605 007f B8240000 		movl	$36, %eax
 7605      00
 7606 0084 EB05     		jmp	.L442
 7607              	.L441:
 7608              		.loc 4 6410 71 discriminator 2
 7609 0086 B80C0000 		movl	$12, %eax
 7609      00
 7610              	.L442:
 7611              		.loc 4 6410 14 is_stmt 1 discriminator 4
 7612 008b 8945F0   		movl	%eax, -16(%rbp)
6411:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6412:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
6413:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->verify_data_len = hash_len;
 7613              		.loc 4 6413 26 discriminator 4
 7614 008e 8B45F0   		movl	-16(%rbp), %eax
 7615 0091 4863D0   		movslq	%eax, %rdx
 7616 0094 488B45E8 		movq	-24(%rbp), %rax
 7617 0098 48899068 		movq	%rdx, 360(%rax)
 7617      010000
6414:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( ssl->own_verify_data, ssl->out_msg + 4, hash_len );
 7618              		.loc 4 6414 5 discriminator 4
 7619 009f 8B45F0   		movl	-16(%rbp), %eax
 7620 00a2 4898     		cltq
 7621              		.loc 4 6414 38 discriminator 4
GAS LISTING /tmp/ccEn8xFO.s 			page 305


 7622 00a4 488B55E8 		movq	-24(%rbp), %rdx
 7623 00a8 488B9228 		movq	296(%rdx), %rdx
 7623      010000
 7624              		.loc 4 6414 48 discriminator 4
 7625 00af 488D7204 		leaq	4(%rdx), %rsi
 7626              		.loc 4 6414 16 discriminator 4
 7627 00b3 488B55E8 		movq	-24(%rbp), %rdx
 7628 00b7 488D8A70 		leaq	368(%rdx), %rcx
 7628      010000
 7629              		.loc 4 6414 5 discriminator 4
 7630 00be 4889C2   		movq	%rax, %rdx
 7631 00c1 4889CF   		movq	%rcx, %rdi
 7632 00c4 E8000000 		call	memcpy@PLT
 7632      00
6415:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6416:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6417:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_msglen  = 4 + hash_len;
 7633              		.loc 4 6417 26 discriminator 4
 7634 00c9 8B45F0   		movl	-16(%rbp), %eax
 7635 00cc 83C004   		addl	$4, %eax
 7636 00cf 4863D0   		movslq	%eax, %rdx
 7637              		.loc 4 6417 22 discriminator 4
 7638 00d2 488B45E8 		movq	-24(%rbp), %rax
 7639 00d6 48899038 		movq	%rdx, 312(%rax)
 7639      010000
6418:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_msgtype = MBEDTLS_SSL_MSG_HANDSHAKE;
 7640              		.loc 4 6418 22 discriminator 4
 7641 00dd 488B45E8 		movq	-24(%rbp), %rax
 7642 00e1 C7803001 		movl	$22, 304(%rax)
 7642      00001600 
 7642      0000
6419:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_msg[0]  = MBEDTLS_SSL_HS_FINISHED;
 7643              		.loc 4 6419 8 discriminator 4
 7644 00eb 488B45E8 		movq	-24(%rbp), %rax
 7645 00ef 488B8028 		movq	296(%rax), %rax
 7645      010000
 7646              		.loc 4 6419 22 discriminator 4
 7647 00f6 C60014   		movb	$20, (%rax)
6420:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6421:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
6422:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * In case of session resuming, invert the client and server
6423:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * ChangeCipherSpec messages order.
6424:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
6425:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->handshake->resume != 0 )
 7648              		.loc 4 6425 12 discriminator 4
 7649 00f9 488B45E8 		movq	-24(%rbp), %rax
 7650 00fd 488B4060 		movq	96(%rax), %rax
 7651              		.loc 4 6425 23 discriminator 4
 7652 0101 8B809C03 		movl	924(%rax), %eax
 7652      0000
 7653              		.loc 4 6425 7 discriminator 4
 7654 0107 85C0     		testl	%eax, %eax
 7655 0109 7422     		je	.L443
6426:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6427:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
6428:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->conf->endpoint == MBEDTLS_SSL_IS_CLIENT )
 7656              		.loc 4 6428 16
GAS LISTING /tmp/ccEn8xFO.s 			page 306


 7657 010b 488B45E8 		movq	-24(%rbp), %rax
 7658 010f 488B00   		movq	(%rax), %rax
 7659              		.loc 4 6428 33
 7660 0112 0FB680BC 		movzbl	188(%rax), %eax
 7660      000000
 7661 0119 83E001   		andl	$1, %eax
 7662              		.loc 4 6428 11
 7663 011c 84C0     		testb	%al, %al
 7664 011e 751E     		jne	.L444
6429:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->state = MBEDTLS_SSL_HANDSHAKE_WRAPUP;
 7665              		.loc 4 6429 24
 7666 0120 488B45E8 		movq	-24(%rbp), %rax
 7667 0124 C740080F 		movl	$15, 8(%rax)
 7667      000000
 7668 012b EB11     		jmp	.L444
 7669              	.L443:
6430:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6431:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
6432:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER )
6433:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->state = MBEDTLS_SSL_CLIENT_CHANGE_CIPHER_SPEC;
6434:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6435:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6436:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
6437:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->state++;
 7670              		.loc 4 6437 12
 7671 012d 488B45E8 		movq	-24(%rbp), %rax
 7672 0131 8B4008   		movl	8(%rax), %eax
 7673              		.loc 4 6437 19
 7674 0134 8D5001   		leal	1(%rax), %edx
 7675 0137 488B45E8 		movq	-24(%rbp), %rax
 7676 013b 895008   		movl	%edx, 8(%rax)
 7677              	.L444:
6438:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6439:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
6440:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Switch to our negotiated transform and session parameters for outbound
6441:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * data.
6442:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
6443:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "switching to new transform spec for outbound data" ) );
6444:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6445:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
6446:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
6447:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6448:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         unsigned char i;
6449:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6450:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Remember current epoch settings for resending */
6451:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake->alt_transform_out = ssl->transform_out;
6452:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memcpy( ssl->handshake->alt_out_ctr, ssl->cur_out_ctr, 8 );
6453:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6454:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Set sequence_number to zero */
6455:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memset( ssl->cur_out_ctr + 2, 0, 6 );
6456:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6457:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Increment epoch */
6458:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         for( i = 2; i > 0; i-- )
6459:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ++ssl->cur_out_ctr[i - 1] != 0 )
6460:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 break;
6461:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6462:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* The loop goes to its end iff the counter is wrapping */
GAS LISTING /tmp/ccEn8xFO.s 			page 307


6463:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( i == 0 )
6464:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
6465:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "DTLS epoch would wrap" ) );
6466:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_COUNTER_WRAPPING );
6467:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
6468:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6469:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
6470:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
6471:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memset( ssl->cur_out_ctr, 0, 8 );
 7678              		.loc 4 6471 16
 7679 013e 488B45E8 		movq	-24(%rbp), %rax
 7680 0142 48054801 		addq	$328, %rax
 7680      0000
 7681              		.loc 4 6471 5
 7682 0148 BA080000 		movl	$8, %edx
 7682      00
 7683 014d BE000000 		movl	$0, %esi
 7683      00
 7684 0152 4889C7   		movq	%rax, %rdi
 7685 0155 E8000000 		call	memset@PLT
 7685      00
6472:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6473:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->transform_out = ssl->transform_negotiate;
 7686              		.loc 4 6473 29
 7687 015a 488B45E8 		movq	-24(%rbp), %rax
 7688 015e 488B9080 		movq	128(%rax), %rdx
 7688      000000
 7689              		.loc 4 6473 24
 7690 0165 488B45E8 		movq	-24(%rbp), %rax
 7691 0169 48895070 		movq	%rdx, 112(%rax)
6474:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->session_out = ssl->session_negotiate;
 7692              		.loc 4 6474 27
 7693 016d 488B45E8 		movq	-24(%rbp), %rax
 7694 0171 488B5058 		movq	88(%rax), %rdx
 7695              		.loc 4 6474 22
 7696 0175 488B45E8 		movq	-24(%rbp), %rax
 7697 0179 48895048 		movq	%rdx, 72(%rax)
6475:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6476:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_HW_RECORD_ACCEL)
6477:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( mbedtls_ssl_hw_record_activate != NULL )
6478:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6479:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_ssl_hw_record_activate( ssl, MBEDTLS_SSL_CHANNEL_OUTBOUND ) ) != 0 )
6480:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
6481:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_hw_record_activate", ret );
6482:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_HW_ACCEL_FAILED );
6483:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
6484:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6485:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6486:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6487:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
6488:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
6489:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_send_flight_completed( ssl );
6490:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6491:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6492:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_ssl_write_handshake_msg( ssl ) ) != 0 )
 7698              		.loc 4 6492 17
 7699 017d 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 308


 7700 0181 4889C7   		movq	%rax, %rdi
 7701 0184 E8000000 		call	mbedtls_ssl_write_handshake_msg
 7701      00
 7702 0189 8945F4   		movl	%eax, -12(%rbp)
 7703              		.loc 4 6492 7
 7704 018c 837DF400 		cmpl	$0, -12(%rbp)
 7705 0190 7405     		je	.L445
6493:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6494:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_write_handshake_msg", ret );
6495:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 7706              		.loc 4 6495 15
 7707 0192 8B45F4   		movl	-12(%rbp), %eax
 7708 0195 EB05     		jmp	.L446
 7709              	.L445:
6496:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6497:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6498:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
6499:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
6500:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ( ret = mbedtls_ssl_flight_transmit( ssl ) ) != 0 )
6501:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6502:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_flight_transmit", ret );
6503:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
6504:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6505:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6506:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6507:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= write finished" ) );
6508:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6509:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 7710              		.loc 4 6509 11
 7711 0197 B8000000 		movl	$0, %eax
 7711      00
 7712              	.L446:
6510:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 7713              		.loc 4 6510 1
 7714 019c 488B4DF8 		movq	-8(%rbp), %rcx
 7715 01a0 6448330C 		xorq	%fs:40, %rcx
 7715      25280000 
 7715      00
 7716 01a9 7405     		je	.L447
 7717 01ab E8000000 		call	__stack_chk_fail@PLT
 7717      00
 7718              	.L447:
 7719 01b0 C9       		leave
 7720              	.LCFI146:
 7721              		.cfi_def_cfa 7, 8
 7722 01b1 C3       		ret
 7723              		.cfi_endproc
 7724              	.LFE67:
 7726              		.section	.text.mbedtls_ssl_parse_finished,"ax",@progbits
 7727              		.globl	mbedtls_ssl_parse_finished
 7729              	mbedtls_ssl_parse_finished:
 7730              	.LFB68:
6511:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6512:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
6513:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #define SSL_MAX_HASH_LEN 36
6514:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #else
6515:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #define SSL_MAX_HASH_LEN 12
GAS LISTING /tmp/ccEn8xFO.s 			page 309


6516:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6517:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6518:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_parse_finished( mbedtls_ssl_context *ssl )
6519:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 7731              		.loc 4 6519 1
 7732              		.cfi_startproc
 7733 0000 F30F1EFA 		endbr64
 7734 0004 55       		pushq	%rbp
 7735              	.LCFI147:
 7736              		.cfi_def_cfa_offset 16
 7737              		.cfi_offset 6, -16
 7738 0005 4889E5   		movq	%rsp, %rbp
 7739              	.LCFI148:
 7740              		.cfi_def_cfa_register 6
 7741 0008 4154     		pushq	%r12
 7742 000a 53       		pushq	%rbx
 7743 000b 4883EC30 		subq	$48, %rsp
 7744              		.cfi_offset 12, -24
 7745              		.cfi_offset 3, -32
 7746 000f 48897DC8 		movq	%rdi, -56(%rbp)
 7747              		.loc 4 6519 1
 7748 0013 64488B04 		movq	%fs:40, %rax
 7748      25280000 
 7748      00
 7749 001c 488945E8 		movq	%rax, -24(%rbp)
 7750 0020 31C0     		xorl	%eax, %eax
6520:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
6521:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned int hash_len;
6522:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned char buf[SSL_MAX_HASH_LEN];
6523:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6524:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> parse finished" ) );
6525:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6526:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->handshake->calc_finished( ssl, buf, ssl->conf->endpoint ^ 1 );
 7751              		.loc 4 6526 8
 7752 0022 488B45C8 		movq	-56(%rbp), %rax
 7753 0026 488B4060 		movq	96(%rax), %rax
 7754              		.loc 4 6526 19
 7755 002a 4C8B8000 		movq	768(%rax), %r8
 7755      030000
 7756              		.loc 4 6526 49
 7757 0031 488B45C8 		movq	-56(%rbp), %rax
 7758 0035 488B00   		movq	(%rax), %rax
 7759              		.loc 4 6526 55
 7760 0038 0FB680BC 		movzbl	188(%rax), %eax
 7760      000000
 7761 003f 83E001   		andl	$1, %eax
 7762              		.loc 4 6526 66
 7763 0042 83F001   		xorl	$1, %eax
 7764              		.loc 4 6526 5
 7765 0045 0FB6D0   		movzbl	%al, %edx
 7766 0048 488D4DDC 		leaq	-36(%rbp), %rcx
 7767 004c 488B45C8 		movq	-56(%rbp), %rax
 7768 0050 4889CE   		movq	%rcx, %rsi
 7769 0053 4889C7   		movq	%rax, %rdi
 7770 0056 41FFD0   		call	*%r8
 7771              	.LVL16:
6527:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 310


6528:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_ssl_read_record( ssl, 1 ) ) != 0 )
 7772              		.loc 4 6528 17
 7773 0059 488B45C8 		movq	-56(%rbp), %rax
 7774 005d BE010000 		movl	$1, %esi
 7774      00
 7775 0062 4889C7   		movq	%rax, %rdi
 7776 0065 E8000000 		call	mbedtls_ssl_read_record
 7776      00
 7777 006a 8945D4   		movl	%eax, -44(%rbp)
 7778              		.loc 4 6528 7
 7779 006d 837DD400 		cmpl	$0, -44(%rbp)
 7780 0071 7408     		je	.L449
6529:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6530:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_read_record", ret );
6531:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 7781              		.loc 4 6531 15
 7782 0073 8B45D4   		movl	-44(%rbp), %eax
 7783 0076 E9500100 		jmp	.L457
 7783      00
 7784              	.L449:
6532:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6533:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6534:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_msgtype != MBEDTLS_SSL_MSG_HANDSHAKE )
 7785              		.loc 4 6534 12
 7786 007b 488B45C8 		movq	-56(%rbp), %rax
 7787 007f 8B80D800 		movl	216(%rax), %eax
 7787      0000
 7788              		.loc 4 6534 7
 7789 0085 83F816   		cmpl	$22, %eax
 7790 0088 7420     		je	.L451
6535:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6536:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad finished message" ) );
6537:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 7791              		.loc 4 6537 9
 7792 008a 488B45C8 		movq	-56(%rbp), %rax
 7793 008e BA0A0000 		movl	$10, %edx
 7793      00
 7794 0093 BE020000 		movl	$2, %esi
 7794      00
 7795 0098 4889C7   		movq	%rax, %rdi
 7796 009b E8000000 		call	mbedtls_ssl_send_alert_message
 7796      00
6538:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_UNEXPECTED_MESSAGE );
6539:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
 7797              		.loc 4 6539 15
 7798 00a0 B80089FF 		movl	$-30464, %eax
 7798      FF
 7799 00a5 E9210100 		jmp	.L457
 7799      00
 7800              	.L451:
6540:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6541:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6542:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* There is currently no ciphersuite using another length with TLS 1.2 */
6543:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
6544:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 )
6545:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         hash_len = 36;
6546:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
GAS LISTING /tmp/ccEn8xFO.s 			page 311


6547:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6548:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         hash_len = 12;
 7801              		.loc 4 6548 18
 7802 00aa C745D80C 		movl	$12, -40(%rbp)
 7802      000000
6549:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6550:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_msg[0] != MBEDTLS_SSL_HS_FINISHED ||
 7803              		.loc 4 6550 12
 7804 00b1 488B45C8 		movq	-56(%rbp), %rax
 7805 00b5 488B80C8 		movq	200(%rax), %rax
 7805      000000
 7806              		.loc 4 6550 20
 7807 00bc 0FB600   		movzbl	(%rax), %eax
 7808              		.loc 4 6550 7
 7809 00bf 3C14     		cmpb	$20, %al
 7810 00c1 7522     		jne	.L452
6551:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_hslen  != mbedtls_ssl_hs_hdr_len( ssl ) + hash_len )
 7811              		.loc 4 6551 12 discriminator 1
 7812 00c3 488B45C8 		movq	-56(%rbp), %rax
 7813 00c7 488B98F0 		movq	240(%rax), %rbx
 7813      000000
 7814              		.loc 4 6551 27 discriminator 1
 7815 00ce 488B45C8 		movq	-56(%rbp), %rax
 7816 00d2 4889C7   		movq	%rax, %rdi
 7817 00d5 E8000000 		call	mbedtls_ssl_hs_hdr_len
 7817      00
 7818              		.loc 4 6551 57 discriminator 1
 7819 00da 8B55D8   		movl	-40(%rbp), %edx
 7820 00dd 4801D0   		addq	%rdx, %rax
6550:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_hslen  != mbedtls_ssl_hs_hdr_len( ssl ) + hash_len )
 7821              		.loc 4 6550 51 discriminator 1
 7822 00e0 4839C3   		cmpq	%rax, %rbx
 7823 00e3 7420     		je	.L453
 7824              	.L452:
6552:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6553:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad finished message" ) );
6554:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 7825              		.loc 4 6554 9
 7826 00e5 488B45C8 		movq	-56(%rbp), %rax
 7827 00e9 BA320000 		movl	$50, %edx
 7827      00
 7828 00ee BE020000 		movl	$2, %esi
 7828      00
 7829 00f3 4889C7   		movq	%rax, %rdi
 7830 00f6 E8000000 		call	mbedtls_ssl_send_alert_message
 7830      00
6555:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
6556:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_FINISHED );
 7831              		.loc 4 6556 15
 7832 00fb B88081FF 		movl	$-32384, %eax
 7832      FF
 7833 0100 E9C60000 		jmp	.L457
 7833      00
 7834              	.L453:
6557:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6558:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6559:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( mbedtls_ssl_safer_memcmp( ssl->in_msg + mbedtls_ssl_hs_hdr_len( ssl ),
GAS LISTING /tmp/ccEn8xFO.s 			page 312


 7835              		.loc 4 6559 9
 7836 0105 8B5DD8   		movl	-40(%rbp), %ebx
 7837              		.loc 4 6559 38
 7838 0108 488B45C8 		movq	-56(%rbp), %rax
 7839 010c 4C8BA0C8 		movq	200(%rax), %r12
 7839      000000
 7840              		.loc 4 6559 49
 7841 0113 488B45C8 		movq	-56(%rbp), %rax
 7842 0117 4889C7   		movq	%rax, %rdi
 7843 011a E8000000 		call	mbedtls_ssl_hs_hdr_len
 7843      00
 7844              		.loc 4 6559 47
 7845 011f 498D0C04 		leaq	(%r12,%rax), %rcx
 7846              		.loc 4 6559 9
 7847 0123 488D45DC 		leaq	-36(%rbp), %rax
 7848 0127 4889DA   		movq	%rbx, %rdx
 7849 012a 4889C6   		movq	%rax, %rsi
 7850 012d 4889CF   		movq	%rcx, %rdi
 7851 0130 E8000000 		call	mbedtls_ssl_safer_memcmp
 7851      00
 7852              		.loc 4 6559 7
 7853 0135 85C0     		testl	%eax, %eax
 7854 0137 741D     		je	.L454
6560:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                       buf, hash_len ) != 0 )
6561:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6562:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad finished message" ) );
6563:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 7855              		.loc 4 6563 9
 7856 0139 488B45C8 		movq	-56(%rbp), %rax
 7857 013d BA320000 		movl	$50, %edx
 7857      00
 7858 0142 BE020000 		movl	$2, %esi
 7858      00
 7859 0147 4889C7   		movq	%rax, %rdi
 7860 014a E8000000 		call	mbedtls_ssl_send_alert_message
 7860      00
6564:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
6565:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_FINISHED );
 7861              		.loc 4 6565 15
 7862 014f B88081FF 		movl	$-32384, %eax
 7862      FF
 7863 0154 EB75     		jmp	.L457
 7864              	.L454:
6566:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6567:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6568:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
6569:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->verify_data_len = hash_len;
 7865              		.loc 4 6569 26
 7866 0156 8B55D8   		movl	-40(%rbp), %edx
 7867 0159 488B45C8 		movq	-56(%rbp), %rax
 7868 015d 48899068 		movq	%rdx, 360(%rax)
 7868      010000
6570:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( ssl->peer_verify_data, buf, hash_len );
 7869              		.loc 4 6570 5
 7870 0164 8B55D8   		movl	-40(%rbp), %edx
 7871              		.loc 4 6570 16
 7872 0167 488B45C8 		movq	-56(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 313


 7873 016b 488D887C 		leaq	380(%rax), %rcx
 7873      010000
 7874              		.loc 4 6570 5
 7875 0172 488D45DC 		leaq	-36(%rbp), %rax
 7876 0176 4889C6   		movq	%rax, %rsi
 7877 0179 4889CF   		movq	%rcx, %rdi
 7878 017c E8000000 		call	memcpy@PLT
 7878      00
6571:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6572:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6573:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->handshake->resume != 0 )
 7879              		.loc 4 6573 12
 7880 0181 488B45C8 		movq	-56(%rbp), %rax
 7881 0185 488B4060 		movq	96(%rax), %rax
 7882              		.loc 4 6573 23
 7883 0189 8B809C03 		movl	924(%rax), %eax
 7883      0000
 7884              		.loc 4 6573 7
 7885 018f 85C0     		testl	%eax, %eax
 7886 0191 7422     		je	.L455
6574:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6575:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
6576:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->conf->endpoint == MBEDTLS_SSL_IS_CLIENT )
 7887              		.loc 4 6576 16
 7888 0193 488B45C8 		movq	-56(%rbp), %rax
 7889 0197 488B00   		movq	(%rax), %rax
 7890              		.loc 4 6576 33
 7891 019a 0FB680BC 		movzbl	188(%rax), %eax
 7891      000000
 7892 01a1 83E001   		andl	$1, %eax
 7893              		.loc 4 6576 11
 7894 01a4 84C0     		testb	%al, %al
 7895 01a6 751E     		jne	.L456
6577:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->state = MBEDTLS_SSL_CLIENT_CHANGE_CIPHER_SPEC;
 7896              		.loc 4 6577 24
 7897 01a8 488B45C8 		movq	-56(%rbp), %rax
 7898 01ac C740080A 		movl	$10, 8(%rax)
 7898      000000
 7899 01b3 EB11     		jmp	.L456
 7900              	.L455:
6578:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6579:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
6580:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER )
6581:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->state = MBEDTLS_SSL_HANDSHAKE_WRAPUP;
6582:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6583:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6584:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
6585:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->state++;
 7901              		.loc 4 6585 12
 7902 01b5 488B45C8 		movq	-56(%rbp), %rax
 7903 01b9 8B4008   		movl	8(%rax), %eax
 7904              		.loc 4 6585 19
 7905 01bc 8D5001   		leal	1(%rax), %edx
 7906 01bf 488B45C8 		movq	-56(%rbp), %rax
 7907 01c3 895008   		movl	%edx, 8(%rax)
 7908              	.L456:
6586:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 314


6587:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
6588:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
6589:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_recv_flight_completed( ssl );
6590:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6591:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6592:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= parse finished" ) );
6593:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6594:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 7909              		.loc 4 6594 11
 7910 01c6 B8000000 		movl	$0, %eax
 7910      00
 7911              	.L457:
6595:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 7912              		.loc 4 6595 1 discriminator 1
 7913 01cb 488B5DE8 		movq	-24(%rbp), %rbx
 7914 01cf 6448331C 		xorq	%fs:40, %rbx
 7914      25280000 
 7914      00
 7915 01d8 7405     		je	.L458
 7916              		.loc 4 6595 1 is_stmt 0
 7917 01da E8000000 		call	__stack_chk_fail@PLT
 7917      00
 7918              	.L458:
 7919 01df 4883C430 		addq	$48, %rsp
 7920 01e3 5B       		popq	%rbx
 7921 01e4 415C     		popq	%r12
 7922 01e6 5D       		popq	%rbp
 7923              	.LCFI149:
 7924              		.cfi_def_cfa 7, 8
 7925 01e7 C3       		ret
 7926              		.cfi_endproc
 7927              	.LFE68:
 7929              		.section	.text.ssl_handshake_params_init,"ax",@progbits
 7931              	ssl_handshake_params_init:
 7932              	.LFB69:
6596:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6597:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_handshake_params_init( mbedtls_ssl_handshake_params *handshake )
6598:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 7933              		.loc 4 6598 1 is_stmt 1
 7934              		.cfi_startproc
 7935 0000 F30F1EFA 		endbr64
 7936 0004 55       		pushq	%rbp
 7937              	.LCFI150:
 7938              		.cfi_def_cfa_offset 16
 7939              		.cfi_offset 6, -16
 7940 0005 4889E5   		movq	%rsp, %rbp
 7941              	.LCFI151:
 7942              		.cfi_def_cfa_register 6
 7943 0008 4883EC20 		subq	$32, %rsp
 7944 000c 48897DE8 		movq	%rdi, -24(%rbp)
 7945              		.loc 4 6598 1
 7946 0010 64488B04 		movq	%fs:40, %rax
 7946      25280000 
 7946      00
 7947 0019 488945F8 		movq	%rax, -8(%rbp)
 7948 001d 31C0     		xorl	%eax, %eax
6599:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memset( handshake, 0, sizeof( mbedtls_ssl_handshake_params ) );
GAS LISTING /tmp/ccEn8xFO.s 			page 315


 7949              		.loc 4 6599 5
 7950 001f 488B45E8 		movq	-24(%rbp), %rax
 7951 0023 BAB80300 		movl	$952, %edx
 7951      00
 7952 0028 BE000000 		movl	$0, %esi
 7952      00
 7953 002d 4889C7   		movq	%rax, %rdi
 7954 0030 E8000000 		call	memset@PLT
 7954      00
6600:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6601:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1) || \
6602:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_1)
6603:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      mbedtls_md5_init(   &handshake->fin_md5  );
6604:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_init(   &handshake->fin_sha1 );
6605:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      mbedtls_md5_starts_ret( &handshake->fin_md5  );
6606:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_starts_ret( &handshake->fin_sha1 );
6607:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6608:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
6609:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
6610:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha256_init(   &handshake->fin_sha256    );
 7955              		.loc 4 6610 5
 7956 0035 488B45E8 		movq	-24(%rbp), %rax
 7957 0039 48058002 		addq	$640, %rax
 7957      0000
 7958 003f 4889C7   		movq	%rax, %rdi
 7959 0042 E8000000 		call	mbedtls_sha256_init@PLT
 7959      00
6611:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha256_starts_ret( &handshake->fin_sha256, 0 );
 7960              		.loc 4 6611 5
 7961 0047 488B45E8 		movq	-24(%rbp), %rax
 7962 004b 48058002 		addq	$640, %rax
 7962      0000
 7963 0051 BE000000 		movl	$0, %esi
 7963      00
 7964 0056 4889C7   		movq	%rax, %rdi
 7965 0059 E8000000 		call	mbedtls_sha256_starts_ret@PLT
 7965      00
6612:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6613:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
6614:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha512_init(   &handshake->fin_sha512    );
6615:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha512_starts_ret( &handshake->fin_sha512, 1 );
6616:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6617:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
6618:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6619:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     handshake->update_checksum = ssl_update_checksum_start;
 7966              		.loc 4 6619 32
 7967 005e 488B45E8 		movq	-24(%rbp), %rax
 7968 0062 488D1500 		leaq	ssl_update_checksum_start(%rip), %rdx
 7968      000000
 7969 0069 488990F0 		movq	%rdx, 752(%rax)
 7969      020000
6620:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6621:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2) && \
6622:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
6623:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_sig_hash_set_init( &handshake->hash_algs );
 7970              		.loc 4 6623 5
 7971 0070 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 316


 7972 0074 4889C7   		movq	%rax, %rdi
 7973 0077 E8000000 		call	mbedtls_ssl_sig_hash_set_init
 7973      00
6624:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6625:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6626:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_DHM_C)
6627:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_dhm_init( &handshake->dhm_ctx );
6628:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6629:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_ECDH_C)
6630:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ecdh_init( &handshake->ecdh_ctx );
 7974              		.loc 4 6630 5
 7975 007c 488B45E8 		movq	-24(%rbp), %rax
 7976 0080 4883C008 		addq	$8, %rax
 7977 0084 4889C7   		movq	%rax, %rdi
 7978 0087 E8000000 		call	mbedtls_ecdh_init@PLT
 7978      00
6631:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6632:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
6633:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ecjpake_init( &handshake->ecjpake_ctx );
6634:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
6635:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     handshake->ecjpake_cache = NULL;
6636:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     handshake->ecjpake_cache_len = 0;
6637:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6638:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6639:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6640:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL__ECP_RESTARTABLE)
6641:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_x509_crt_restart_init( &handshake->ecrs_ctx );
6642:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6643:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6644:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SERVER_NAME_INDICATION)
6645:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     handshake->sni_authmode = MBEDTLS_SSL_VERIFY_UNSET;
6646:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6647:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 7979              		.loc 4 6647 1
 7980 008c 90       		nop
 7981 008d 488B45F8 		movq	-8(%rbp), %rax
 7982 0091 64483304 		xorq	%fs:40, %rax
 7982      25280000 
 7982      00
 7983 009a 7405     		je	.L460
 7984 009c E8000000 		call	__stack_chk_fail@PLT
 7984      00
 7985              	.L460:
 7986 00a1 C9       		leave
 7987              	.LCFI152:
 7988              		.cfi_def_cfa 7, 8
 7989 00a2 C3       		ret
 7990              		.cfi_endproc
 7991              	.LFE69:
 7993              		.section	.text.ssl_transform_init,"ax",@progbits
 7995              	ssl_transform_init:
 7996              	.LFB70:
6648:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6649:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_transform_init( mbedtls_ssl_transform *transform )
6650:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 7997              		.loc 4 6650 1
 7998              		.cfi_startproc
GAS LISTING /tmp/ccEn8xFO.s 			page 317


 7999 0000 F30F1EFA 		endbr64
 8000 0004 55       		pushq	%rbp
 8001              	.LCFI153:
 8002              		.cfi_def_cfa_offset 16
 8003              		.cfi_offset 6, -16
 8004 0005 4889E5   		movq	%rsp, %rbp
 8005              	.LCFI154:
 8006              		.cfi_def_cfa_register 6
 8007 0008 4883EC20 		subq	$32, %rsp
 8008 000c 48897DE8 		movq	%rdi, -24(%rbp)
 8009              		.loc 4 6650 1
 8010 0010 64488B04 		movq	%fs:40, %rax
 8010      25280000 
 8010      00
 8011 0019 488945F8 		movq	%rax, -8(%rbp)
 8012 001d 31C0     		xorl	%eax, %eax
6651:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memset( transform, 0, sizeof(mbedtls_ssl_transform) );
 8013              		.loc 4 6651 5
 8014 001f 488B45E8 		movq	-24(%rbp), %rax
 8015 0023 BA300100 		movl	$304, %edx
 8015      00
 8016 0028 BE000000 		movl	$0, %esi
 8016      00
 8017 002d 4889C7   		movq	%rax, %rdi
 8018 0030 E8000000 		call	memset@PLT
 8018      00
6652:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6653:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_cipher_init( &transform->cipher_ctx_enc );
 8019              		.loc 4 6653 5
 8020 0035 488B45E8 		movq	-24(%rbp), %rax
 8021 0039 4883E880 		subq	$-128, %rax
 8022 003d 4889C7   		movq	%rax, %rdi
 8023 0040 E8000000 		call	mbedtls_cipher_init@PLT
 8023      00
6654:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_cipher_init( &transform->cipher_ctx_dec );
 8024              		.loc 4 6654 5
 8025 0045 488B45E8 		movq	-24(%rbp), %rax
 8026 0049 4805D800 		addq	$216, %rax
 8026      0000
 8027 004f 4889C7   		movq	%rax, %rdi
 8028 0052 E8000000 		call	mbedtls_cipher_init@PLT
 8028      00
6655:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6656:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_init( &transform->md_ctx_enc );
 8029              		.loc 4 6656 5
 8030 0057 488B45E8 		movq	-24(%rbp), %rax
 8031 005b 4883C050 		addq	$80, %rax
 8032 005f 4889C7   		movq	%rax, %rdi
 8033 0062 E8000000 		call	mbedtls_md_init@PLT
 8033      00
6657:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_init( &transform->md_ctx_dec );
 8034              		.loc 4 6657 5
 8035 0067 488B45E8 		movq	-24(%rbp), %rax
 8036 006b 4883C068 		addq	$104, %rax
 8037 006f 4889C7   		movq	%rax, %rdi
 8038 0072 E8000000 		call	mbedtls_md_init@PLT
 8038      00
GAS LISTING /tmp/ccEn8xFO.s 			page 318


6658:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 8039              		.loc 4 6658 1
 8040 0077 90       		nop
 8041 0078 488B45F8 		movq	-8(%rbp), %rax
 8042 007c 64483304 		xorq	%fs:40, %rax
 8042      25280000 
 8042      00
 8043 0085 7405     		je	.L462
 8044 0087 E8000000 		call	__stack_chk_fail@PLT
 8044      00
 8045              	.L462:
 8046 008c C9       		leave
 8047              	.LCFI155:
 8048              		.cfi_def_cfa 7, 8
 8049 008d C3       		ret
 8050              		.cfi_endproc
 8051              	.LFE70:
 8053              		.section	.text.mbedtls_ssl_session_init,"ax",@progbits
 8054              		.globl	mbedtls_ssl_session_init
 8056              	mbedtls_ssl_session_init:
 8057              	.LFB71:
6659:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6660:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_session_init( mbedtls_ssl_session *session )
6661:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 8058              		.loc 4 6661 1
 8059              		.cfi_startproc
 8060 0000 F30F1EFA 		endbr64
 8061 0004 55       		pushq	%rbp
 8062              	.LCFI156:
 8063              		.cfi_def_cfa_offset 16
 8064              		.cfi_offset 6, -16
 8065 0005 4889E5   		movq	%rsp, %rbp
 8066              	.LCFI157:
 8067              		.cfi_def_cfa_register 6
 8068 0008 4883EC20 		subq	$32, %rsp
 8069 000c 48897DE8 		movq	%rdi, -24(%rbp)
 8070              		.loc 4 6661 1
 8071 0010 64488B04 		movq	%fs:40, %rax
 8071      25280000 
 8071      00
 8072 0019 488945F8 		movq	%rax, -8(%rbp)
 8073 001d 31C0     		xorl	%eax, %eax
6662:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memset( session, 0, sizeof(mbedtls_ssl_session) );
 8074              		.loc 4 6662 5
 8075 001f 488B45E8 		movq	-24(%rbp), %rax
 8076 0023 BA880000 		movl	$136, %edx
 8076      00
 8077 0028 BE000000 		movl	$0, %esi
 8077      00
 8078 002d 4889C7   		movq	%rax, %rdi
 8079 0030 E8000000 		call	memset@PLT
 8079      00
6663:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 8080              		.loc 4 6663 1
 8081 0035 90       		nop
 8082 0036 488B45F8 		movq	-8(%rbp), %rax
 8083 003a 64483304 		xorq	%fs:40, %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 319


 8083      25280000 
 8083      00
 8084 0043 7405     		je	.L464
 8085 0045 E8000000 		call	__stack_chk_fail@PLT
 8085      00
 8086              	.L464:
 8087 004a C9       		leave
 8088              	.LCFI158:
 8089              		.cfi_def_cfa 7, 8
 8090 004b C3       		ret
 8091              		.cfi_endproc
 8092              	.LFE71:
 8094              		.section	.text.ssl_handshake_init,"ax",@progbits
 8096              	ssl_handshake_init:
 8097              	.LFB72:
6664:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6665:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_handshake_init( mbedtls_ssl_context *ssl )
6666:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 8098              		.loc 4 6666 1
 8099              		.cfi_startproc
 8100 0000 F30F1EFA 		endbr64
 8101 0004 55       		pushq	%rbp
 8102              	.LCFI159:
 8103              		.cfi_def_cfa_offset 16
 8104              		.cfi_offset 6, -16
 8105 0005 4889E5   		movq	%rsp, %rbp
 8106              	.LCFI160:
 8107              		.cfi_def_cfa_register 6
 8108 0008 4883EC20 		subq	$32, %rsp
 8109 000c 48897DE8 		movq	%rdi, -24(%rbp)
 8110              		.loc 4 6666 1
 8111 0010 64488B04 		movq	%fs:40, %rax
 8111      25280000 
 8111      00
 8112 0019 488945F8 		movq	%rax, -8(%rbp)
 8113 001d 31C0     		xorl	%eax, %eax
6667:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Clear old handshake information if present */
6668:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->transform_negotiate )
 8114              		.loc 4 6668 12
 8115 001f 488B45E8 		movq	-24(%rbp), %rax
 8116 0023 488B8080 		movq	128(%rax), %rax
 8116      000000
 8117              		.loc 4 6668 7
 8118 002a 4885C0   		testq	%rax, %rax
 8119 002d 7413     		je	.L466
6669:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_transform_free( ssl->transform_negotiate );
 8120              		.loc 4 6669 9
 8121 002f 488B45E8 		movq	-24(%rbp), %rax
 8122 0033 488B8080 		movq	128(%rax), %rax
 8122      000000
 8123 003a 4889C7   		movq	%rax, %rdi
 8124 003d E8000000 		call	mbedtls_ssl_transform_free
 8124      00
 8125              	.L466:
6670:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->session_negotiate )
 8126              		.loc 4 6670 12
 8127 0042 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 320


 8128 0046 488B4058 		movq	88(%rax), %rax
 8129              		.loc 4 6670 7
 8130 004a 4885C0   		testq	%rax, %rax
 8131 004d 7410     		je	.L467
6671:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_session_free( ssl->session_negotiate );
 8132              		.loc 4 6671 9
 8133 004f 488B45E8 		movq	-24(%rbp), %rax
 8134 0053 488B4058 		movq	88(%rax), %rax
 8135 0057 4889C7   		movq	%rax, %rdi
 8136 005a E8000000 		call	mbedtls_ssl_session_free
 8136      00
 8137              	.L467:
6672:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->handshake )
 8138              		.loc 4 6672 12
 8139 005f 488B45E8 		movq	-24(%rbp), %rax
 8140 0063 488B4060 		movq	96(%rax), %rax
 8141              		.loc 4 6672 7
 8142 0067 4885C0   		testq	%rax, %rax
 8143 006a 740C     		je	.L468
6673:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_handshake_free( ssl );
 8144              		.loc 4 6673 9
 8145 006c 488B45E8 		movq	-24(%rbp), %rax
 8146 0070 4889C7   		movq	%rax, %rdi
 8147 0073 E8000000 		call	mbedtls_ssl_handshake_free
 8147      00
 8148              	.L468:
6674:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6675:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
6676:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Either the pointers are now NULL or cleared properly and can be freed.
6677:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Now allocate missing structures.
6678:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
6679:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->transform_negotiate == NULL )
 8149              		.loc 4 6679 12
 8150 0078 488B45E8 		movq	-24(%rbp), %rax
 8151 007c 488B8080 		movq	128(%rax), %rax
 8151      000000
 8152              		.loc 4 6679 7
 8153 0083 4885C0   		testq	%rax, %rax
 8154 0086 751A     		jne	.L469
6680:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6681:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->transform_negotiate = mbedtls_calloc( 1, sizeof(mbedtls_ssl_transform) );
 8155              		.loc 4 6681 36
 8156 0088 BE300100 		movl	$304, %esi
 8156      00
 8157 008d BF010000 		movl	$1, %edi
 8157      00
 8158 0092 E8000000 		call	mbedtls_calloc@PLT
 8158      00
 8159              		.loc 4 6681 34
 8160 0097 488B55E8 		movq	-24(%rbp), %rdx
 8161 009b 48898280 		movq	%rax, 128(%rdx)
 8161      000000
 8162              	.L469:
6682:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6683:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6684:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->session_negotiate == NULL )
 8163              		.loc 4 6684 12
GAS LISTING /tmp/ccEn8xFO.s 			page 321


 8164 00a2 488B45E8 		movq	-24(%rbp), %rax
 8165 00a6 488B4058 		movq	88(%rax), %rax
 8166              		.loc 4 6684 7
 8167 00aa 4885C0   		testq	%rax, %rax
 8168 00ad 7517     		jne	.L470
6685:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6686:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->session_negotiate = mbedtls_calloc( 1, sizeof(mbedtls_ssl_session) );
 8169              		.loc 4 6686 34
 8170 00af BE880000 		movl	$136, %esi
 8170      00
 8171 00b4 BF010000 		movl	$1, %edi
 8171      00
 8172 00b9 E8000000 		call	mbedtls_calloc@PLT
 8172      00
 8173              		.loc 4 6686 32
 8174 00be 488B55E8 		movq	-24(%rbp), %rdx
 8175 00c2 48894258 		movq	%rax, 88(%rdx)
 8176              	.L470:
6687:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6688:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6689:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->handshake == NULL )
 8177              		.loc 4 6689 12
 8178 00c6 488B45E8 		movq	-24(%rbp), %rax
 8179 00ca 488B4060 		movq	96(%rax), %rax
 8180              		.loc 4 6689 7
 8181 00ce 4885C0   		testq	%rax, %rax
 8182 00d1 7517     		jne	.L471
6690:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6691:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake = mbedtls_calloc( 1, sizeof(mbedtls_ssl_handshake_params) );
 8183              		.loc 4 6691 26
 8184 00d3 BEB80300 		movl	$952, %esi
 8184      00
 8185 00d8 BF010000 		movl	$1, %edi
 8185      00
 8186 00dd E8000000 		call	mbedtls_calloc@PLT
 8186      00
 8187              		.loc 4 6691 24
 8188 00e2 488B55E8 		movq	-24(%rbp), %rdx
 8189 00e6 48894260 		movq	%rax, 96(%rdx)
 8190              	.L471:
6692:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6693:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6694:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* All pointers should exist and can be directly freed without issue */
6695:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->handshake == NULL ||
 8191              		.loc 4 6695 12
 8192 00ea 488B45E8 		movq	-24(%rbp), %rax
 8193 00ee 488B4060 		movq	96(%rax), %rax
 8194              		.loc 4 6695 7
 8195 00f2 4885C0   		testq	%rax, %rax
 8196 00f5 741D     		je	.L472
6696:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->transform_negotiate == NULL ||
 8197              		.loc 4 6696 12 discriminator 1
 8198 00f7 488B45E8 		movq	-24(%rbp), %rax
 8199 00fb 488B8080 		movq	128(%rax), %rax
 8199      000000
6695:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->transform_negotiate == NULL ||
 8200              		.loc 4 6695 32 discriminator 1
GAS LISTING /tmp/ccEn8xFO.s 			page 322


 8201 0102 4885C0   		testq	%rax, %rax
 8202 0105 740D     		je	.L472
6697:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->session_negotiate == NULL )
 8203              		.loc 4 6697 12
 8204 0107 488B45E8 		movq	-24(%rbp), %rax
 8205 010b 488B4058 		movq	88(%rax), %rax
6696:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->transform_negotiate == NULL ||
 8206              		.loc 4 6696 42
 8207 010f 4885C0   		testq	%rax, %rax
 8208 0112 7561     		jne	.L473
 8209              	.L472:
6698:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6699:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "alloc() of ssl sub-contexts failed" ) );
6700:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6701:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( ssl->handshake );
 8210              		.loc 4 6701 26
 8211 0114 488B45E8 		movq	-24(%rbp), %rax
 8212 0118 488B4060 		movq	96(%rax), %rax
 8213              		.loc 4 6701 9
 8214 011c 4889C7   		movq	%rax, %rdi
 8215 011f E8000000 		call	mbedtls_free@PLT
 8215      00
6702:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( ssl->transform_negotiate );
 8216              		.loc 4 6702 26
 8217 0124 488B45E8 		movq	-24(%rbp), %rax
 8218 0128 488B8080 		movq	128(%rax), %rax
 8218      000000
 8219              		.loc 4 6702 9
 8220 012f 4889C7   		movq	%rax, %rdi
 8221 0132 E8000000 		call	mbedtls_free@PLT
 8221      00
6703:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( ssl->session_negotiate );
 8222              		.loc 4 6703 26
 8223 0137 488B45E8 		movq	-24(%rbp), %rax
 8224 013b 488B4058 		movq	88(%rax), %rax
 8225              		.loc 4 6703 9
 8226 013f 4889C7   		movq	%rax, %rdi
 8227 0142 E8000000 		call	mbedtls_free@PLT
 8227      00
6704:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6705:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake = NULL;
 8228              		.loc 4 6705 24
 8229 0147 488B45E8 		movq	-24(%rbp), %rax
 8230 014b 48C74060 		movq	$0, 96(%rax)
 8230      00000000 
6706:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->transform_negotiate = NULL;
 8231              		.loc 4 6706 34
 8232 0153 488B45E8 		movq	-24(%rbp), %rax
 8233 0157 48C78080 		movq	$0, 128(%rax)
 8233      00000000 
 8233      000000
6707:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->session_negotiate = NULL;
 8234              		.loc 4 6707 32
 8235 0162 488B45E8 		movq	-24(%rbp), %rax
 8236 0166 48C74058 		movq	$0, 88(%rax)
 8236      00000000 
6708:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 323


6709:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
 8237              		.loc 4 6709 15
 8238 016e B80081FF 		movl	$-32512, %eax
 8238      FF
 8239 0173 EB38     		jmp	.L474
 8240              	.L473:
6710:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6711:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6712:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Initialize structures */
6713:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_session_init( ssl->session_negotiate );
 8241              		.loc 4 6713 5
 8242 0175 488B45E8 		movq	-24(%rbp), %rax
 8243 0179 488B4058 		movq	88(%rax), %rax
 8244 017d 4889C7   		movq	%rax, %rdi
 8245 0180 E8000000 		call	mbedtls_ssl_session_init
 8245      00
6714:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_transform_init( ssl->transform_negotiate );
 8246              		.loc 4 6714 5
 8247 0185 488B45E8 		movq	-24(%rbp), %rax
 8248 0189 488B8080 		movq	128(%rax), %rax
 8248      000000
 8249 0190 4889C7   		movq	%rax, %rdi
 8250 0193 E8000000 		call	ssl_transform_init
 8250      00
6715:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_handshake_params_init( ssl->handshake );
 8251              		.loc 4 6715 5
 8252 0198 488B45E8 		movq	-24(%rbp), %rax
 8253 019c 488B4060 		movq	96(%rax), %rax
 8254 01a0 4889C7   		movq	%rax, %rdi
 8255 01a3 E8000000 		call	ssl_handshake_params_init
 8255      00
6716:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6717:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
6718:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
6719:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6720:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake->alt_transform_out = ssl->transform_out;
6721:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6722:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->conf->endpoint == MBEDTLS_SSL_IS_CLIENT )
6723:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->handshake->retransmit_state = MBEDTLS_SSL_RETRANS_PREPARING;
6724:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else
6725:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->handshake->retransmit_state = MBEDTLS_SSL_RETRANS_WAITING;
6726:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6727:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl_set_timer( ssl, 0 );
6728:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6729:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6730:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6731:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 8256              		.loc 4 6731 11
 8257 01a8 B8000000 		movl	$0, %eax
 8257      00
 8258              	.L474:
6732:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 8259              		.loc 4 6732 1
 8260 01ad 488B4DF8 		movq	-8(%rbp), %rcx
 8261 01b1 6448330C 		xorq	%fs:40, %rcx
 8261      25280000 
 8261      00
GAS LISTING /tmp/ccEn8xFO.s 			page 324


 8262 01ba 7405     		je	.L475
 8263 01bc E8000000 		call	__stack_chk_fail@PLT
 8263      00
 8264              	.L475:
 8265 01c1 C9       		leave
 8266              	.LCFI161:
 8267              		.cfi_def_cfa 7, 8
 8268 01c2 C3       		ret
 8269              		.cfi_endproc
 8270              	.LFE72:
 8272              		.section	.text.ssl_update_out_pointers,"ax",@progbits
 8274              	ssl_update_out_pointers:
 8275              	.LFB73:
6733:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6734:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_HELLO_VERIFY) && defined(MBEDTLS_SSL_SRV_C)
6735:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /* Dummy cookie callbacks for defaults */
6736:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_cookie_write_dummy( void *ctx,
6737:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                       unsigned char **p, unsigned char *end,
6738:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                       const unsigned char *cli_id, size_t cli_id_len )
6739:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
6740:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ((void) ctx);
6741:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ((void) p);
6742:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ((void) end);
6743:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ((void) cli_id);
6744:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ((void) cli_id_len);
6745:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6746:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE );
6747:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
6748:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6749:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_cookie_check_dummy( void *ctx,
6750:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                       const unsigned char *cookie, size_t cookie_len,
6751:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                       const unsigned char *cli_id, size_t cli_id_len )
6752:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
6753:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ((void) ctx);
6754:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ((void) cookie);
6755:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ((void) cookie_len);
6756:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ((void) cli_id);
6757:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ((void) cli_id_len);
6758:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6759:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE );
6760:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
6761:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_DTLS_HELLO_VERIFY && MBEDTLS_SSL_SRV_C */
6762:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6763:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /* Once ssl->out_hdr as the address of the beginning of the
6764:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * next outgoing record is set, deduce the other pointers.
6765:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
6766:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Note: For TLS, we save the implicit record sequence number
6767:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *       (entering MAC computation) in the 8 bytes before ssl->out_hdr,
6768:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *       and the caller has to make sure there's space for this.
6769:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
6770:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6771:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_update_out_pointers( mbedtls_ssl_context *ssl,
6772:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                      mbedtls_ssl_transform *transform )
6773:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 8276              		.loc 4 6773 1
 8277              		.cfi_startproc
 8278 0000 F30F1EFA 		endbr64
GAS LISTING /tmp/ccEn8xFO.s 			page 325


 8279 0004 55       		pushq	%rbp
 8280              	.LCFI162:
 8281              		.cfi_def_cfa_offset 16
 8282              		.cfi_offset 6, -16
 8283 0005 4889E5   		movq	%rsp, %rbp
 8284              	.LCFI163:
 8285              		.cfi_def_cfa_register 6
 8286 0008 4883EC20 		subq	$32, %rsp
 8287 000c 48897DE8 		movq	%rdi, -24(%rbp)
 8288 0010 488975E0 		movq	%rsi, -32(%rbp)
 8289              		.loc 4 6773 1
 8290 0014 64488B04 		movq	%fs:40, %rax
 8290      25280000 
 8290      00
 8291 001d 488945F8 		movq	%rax, -8(%rbp)
 8292 0021 31C0     		xorl	%eax, %eax
6774:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
6775:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
6776:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6777:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_ctr = ssl->out_hdr +  3;
6778:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_len = ssl->out_hdr + 11;
6779:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_iv  = ssl->out_hdr + 13;
6780:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6781:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
6782:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6783:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6784:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_ctr = ssl->out_hdr - 8;
 8293              		.loc 4 6784 27
 8294 0023 488B45E8 		movq	-24(%rbp), %rax
 8295 0027 488B8010 		movq	272(%rax), %rax
 8295      010000
 8296              		.loc 4 6784 37
 8297 002e 488D50F8 		leaq	-8(%rax), %rdx
 8298              		.loc 4 6784 22
 8299 0032 488B45E8 		movq	-24(%rbp), %rax
 8300 0036 48899008 		movq	%rdx, 264(%rax)
 8300      010000
6785:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_len = ssl->out_hdr + 3;
 8301              		.loc 4 6785 27
 8302 003d 488B45E8 		movq	-24(%rbp), %rax
 8303 0041 488B8010 		movq	272(%rax), %rax
 8303      010000
 8304              		.loc 4 6785 37
 8305 0048 488D5003 		leaq	3(%rax), %rdx
 8306              		.loc 4 6785 22
 8307 004c 488B45E8 		movq	-24(%rbp), %rax
 8308 0050 48899018 		movq	%rdx, 280(%rax)
 8308      010000
6786:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_iv  = ssl->out_hdr + 5;
 8309              		.loc 4 6786 27
 8310 0057 488B45E8 		movq	-24(%rbp), %rax
 8311 005b 488B8010 		movq	272(%rax), %rax
 8311      010000
 8312              		.loc 4 6786 37
 8313 0062 488D5005 		leaq	5(%rax), %rdx
 8314              		.loc 4 6786 22
 8315 0066 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 326


 8316 006a 48899020 		movq	%rdx, 288(%rax)
 8316      010000
6787:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6788:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6789:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Adjust out_msg to make space for explicit IV, if used. */
6790:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( transform != NULL &&
 8317              		.loc 4 6790 7
 8318 0071 48837DE0 		cmpq	$0, -32(%rbp)
 8318      00
 8319 0076 743D     		je	.L477
6791:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_2 )
 8320              		.loc 4 6791 12 discriminator 1
 8321 0078 488B45E8 		movq	-24(%rbp), %rax
 8322 007c 8B4018   		movl	24(%rax), %eax
6790:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_2 )
 8323              		.loc 4 6790 27 discriminator 1
 8324 007f 83F801   		cmpl	$1, %eax
 8325 0082 7E31     		jle	.L477
6792:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6793:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_msg = ssl->out_iv + transform->ivlen - transform->fixed_ivlen;
 8326              		.loc 4 6793 27
 8327 0084 488B45E8 		movq	-24(%rbp), %rax
 8328 0088 488B9020 		movq	288(%rax), %rdx
 8328      010000
 8329              		.loc 4 6793 47
 8330 008f 488B45E0 		movq	-32(%rbp), %rax
 8331 0093 488B4818 		movq	24(%rax), %rcx
 8332              		.loc 4 6793 66
 8333 0097 488B45E0 		movq	-32(%rbp), %rax
 8334 009b 488B4020 		movq	32(%rax), %rax
 8335              		.loc 4 6793 55
 8336 009f 4829C1   		subq	%rax, %rcx
 8337 00a2 4889C8   		movq	%rcx, %rax
 8338 00a5 4801C2   		addq	%rax, %rdx
 8339              		.loc 4 6793 22
 8340 00a8 488B45E8 		movq	-24(%rbp), %rax
 8341 00ac 48899028 		movq	%rdx, 296(%rax)
 8341      010000
 8342 00b3 EB16     		jmp	.L478
 8343              	.L477:
6794:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6795:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
6796:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_msg = ssl->out_iv;
 8344              		.loc 4 6796 27
 8345 00b5 488B45E8 		movq	-24(%rbp), %rax
 8346 00b9 488B9020 		movq	288(%rax), %rdx
 8346      010000
 8347              		.loc 4 6796 22
 8348 00c0 488B45E8 		movq	-24(%rbp), %rax
 8349 00c4 48899028 		movq	%rdx, 296(%rax)
 8349      010000
 8350              	.L478:
6797:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 8351              		.loc 4 6797 1
 8352 00cb 90       		nop
 8353 00cc 488B45F8 		movq	-8(%rbp), %rax
 8354 00d0 64483304 		xorq	%fs:40, %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 327


 8354      25280000 
 8354      00
 8355 00d9 7405     		je	.L479
 8356 00db E8000000 		call	__stack_chk_fail@PLT
 8356      00
 8357              	.L479:
 8358 00e0 C9       		leave
 8359              	.LCFI164:
 8360              		.cfi_def_cfa 7, 8
 8361 00e1 C3       		ret
 8362              		.cfi_endproc
 8363              	.LFE73:
 8365              		.section	.text.ssl_update_in_pointers,"ax",@progbits
 8367              	ssl_update_in_pointers:
 8368              	.LFB74:
6798:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6799:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /* Once ssl->in_hdr as the address of the beginning of the
6800:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * next incoming record is set, deduce the other pointers.
6801:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
6802:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Note: For TLS, we save the implicit record sequence number
6803:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *       (entering MAC computation) in the 8 bytes before ssl->in_hdr,
6804:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *       and the caller has to make sure there's space for this.
6805:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
6806:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6807:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_update_in_pointers( mbedtls_ssl_context *ssl,
6808:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     mbedtls_ssl_transform *transform )
6809:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 8369              		.loc 4 6809 1
 8370              		.cfi_startproc
 8371 0000 F30F1EFA 		endbr64
 8372 0004 55       		pushq	%rbp
 8373              	.LCFI165:
 8374              		.cfi_def_cfa_offset 16
 8375              		.cfi_offset 6, -16
 8376 0005 4889E5   		movq	%rsp, %rbp
 8377              	.LCFI166:
 8378              		.cfi_def_cfa_register 6
 8379 0008 4883EC20 		subq	$32, %rsp
 8380 000c 48897DE8 		movq	%rdi, -24(%rbp)
 8381 0010 488975E0 		movq	%rsi, -32(%rbp)
 8382              		.loc 4 6809 1
 8383 0014 64488B04 		movq	%fs:40, %rax
 8383      25280000 
 8383      00
 8384 001d 488945F8 		movq	%rax, -8(%rbp)
 8385 0021 31C0     		xorl	%eax, %eax
6810:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
6811:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
6812:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6813:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_ctr = ssl->in_hdr +  3;
6814:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_len = ssl->in_hdr + 11;
6815:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_iv  = ssl->in_hdr + 13;
6816:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6817:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
6818:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6819:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6820:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_ctr = ssl->in_hdr - 8;
GAS LISTING /tmp/ccEn8xFO.s 			page 328


 8386              		.loc 4 6820 26
 8387 0023 488B45E8 		movq	-24(%rbp), %rax
 8388 0027 488B80B0 		movq	176(%rax), %rax
 8388      000000
 8389              		.loc 4 6820 35
 8390 002e 488D50F8 		leaq	-8(%rax), %rdx
 8391              		.loc 4 6820 21
 8392 0032 488B45E8 		movq	-24(%rbp), %rax
 8393 0036 488990A8 		movq	%rdx, 168(%rax)
 8393      000000
6821:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_len = ssl->in_hdr + 3;
 8394              		.loc 4 6821 26
 8395 003d 488B45E8 		movq	-24(%rbp), %rax
 8396 0041 488B80B0 		movq	176(%rax), %rax
 8396      000000
 8397              		.loc 4 6821 35
 8398 0048 488D5003 		leaq	3(%rax), %rdx
 8399              		.loc 4 6821 21
 8400 004c 488B45E8 		movq	-24(%rbp), %rax
 8401 0050 488990B8 		movq	%rdx, 184(%rax)
 8401      000000
6822:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_iv  = ssl->in_hdr + 5;
 8402              		.loc 4 6822 26
 8403 0057 488B45E8 		movq	-24(%rbp), %rax
 8404 005b 488B80B0 		movq	176(%rax), %rax
 8404      000000
 8405              		.loc 4 6822 35
 8406 0062 488D5005 		leaq	5(%rax), %rdx
 8407              		.loc 4 6822 21
 8408 0066 488B45E8 		movq	-24(%rbp), %rax
 8409 006a 488990C0 		movq	%rdx, 192(%rax)
 8409      000000
6823:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6824:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6825:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Offset in_msg from in_iv to allow space for explicit IV, if used. */
6826:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( transform != NULL &&
 8410              		.loc 4 6826 7
 8411 0071 48837DE0 		cmpq	$0, -32(%rbp)
 8411      00
 8412 0076 743D     		je	.L481
6827:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_2 )
 8413              		.loc 4 6827 12 discriminator 1
 8414 0078 488B45E8 		movq	-24(%rbp), %rax
 8415 007c 8B4018   		movl	24(%rax), %eax
6826:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_2 )
 8416              		.loc 4 6826 27 discriminator 1
 8417 007f 83F801   		cmpl	$1, %eax
 8418 0082 7E31     		jle	.L481
6828:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6829:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_msg = ssl->in_iv + transform->ivlen - transform->fixed_ivlen;
 8419              		.loc 4 6829 26
 8420 0084 488B45E8 		movq	-24(%rbp), %rax
 8421 0088 488B90C0 		movq	192(%rax), %rdx
 8421      000000
 8422              		.loc 4 6829 45
 8423 008f 488B45E0 		movq	-32(%rbp), %rax
 8424 0093 488B4818 		movq	24(%rax), %rcx
GAS LISTING /tmp/ccEn8xFO.s 			page 329


 8425              		.loc 4 6829 64
 8426 0097 488B45E0 		movq	-32(%rbp), %rax
 8427 009b 488B4020 		movq	32(%rax), %rax
 8428              		.loc 4 6829 53
 8429 009f 4829C1   		subq	%rax, %rcx
 8430 00a2 4889C8   		movq	%rcx, %rax
 8431 00a5 4801C2   		addq	%rax, %rdx
 8432              		.loc 4 6829 21
 8433 00a8 488B45E8 		movq	-24(%rbp), %rax
 8434 00ac 488990C8 		movq	%rdx, 200(%rax)
 8434      000000
 8435 00b3 EB16     		jmp	.L482
 8436              	.L481:
6830:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6831:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
6832:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_msg = ssl->in_iv;
 8437              		.loc 4 6832 26
 8438 00b5 488B45E8 		movq	-24(%rbp), %rax
 8439 00b9 488B90C0 		movq	192(%rax), %rdx
 8439      000000
 8440              		.loc 4 6832 21
 8441 00c0 488B45E8 		movq	-24(%rbp), %rax
 8442 00c4 488990C8 		movq	%rdx, 200(%rax)
 8442      000000
 8443              	.L482:
6833:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 8444              		.loc 4 6833 1
 8445 00cb 90       		nop
 8446 00cc 488B45F8 		movq	-8(%rbp), %rax
 8447 00d0 64483304 		xorq	%fs:40, %rax
 8447      25280000 
 8447      00
 8448 00d9 7405     		je	.L483
 8449 00db E8000000 		call	__stack_chk_fail@PLT
 8449      00
 8450              	.L483:
 8451 00e0 C9       		leave
 8452              	.LCFI167:
 8453              		.cfi_def_cfa 7, 8
 8454 00e1 C3       		ret
 8455              		.cfi_endproc
 8456              	.LFE74:
 8458              		.section	.text.mbedtls_ssl_init,"ax",@progbits
 8459              		.globl	mbedtls_ssl_init
 8461              	mbedtls_ssl_init:
 8462              	.LFB75:
6834:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6835:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
6836:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Initialize an SSL context
6837:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
6838:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_init( mbedtls_ssl_context *ssl )
6839:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 8463              		.loc 4 6839 1
 8464              		.cfi_startproc
 8465 0000 F30F1EFA 		endbr64
 8466 0004 55       		pushq	%rbp
 8467              	.LCFI168:
GAS LISTING /tmp/ccEn8xFO.s 			page 330


 8468              		.cfi_def_cfa_offset 16
 8469              		.cfi_offset 6, -16
 8470 0005 4889E5   		movq	%rsp, %rbp
 8471              	.LCFI169:
 8472              		.cfi_def_cfa_register 6
 8473 0008 4883EC20 		subq	$32, %rsp
 8474 000c 48897DE8 		movq	%rdi, -24(%rbp)
 8475              		.loc 4 6839 1
 8476 0010 64488B04 		movq	%fs:40, %rax
 8476      25280000 
 8476      00
 8477 0019 488945F8 		movq	%rax, -8(%rbp)
 8478 001d 31C0     		xorl	%eax, %eax
6840:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memset( ssl, 0, sizeof( mbedtls_ssl_context ) );
 8479              		.loc 4 6840 5
 8480 001f 488B45E8 		movq	-24(%rbp), %rax
 8481 0023 BA880100 		movl	$392, %edx
 8481      00
 8482 0028 BE000000 		movl	$0, %esi
 8482      00
 8483 002d 4889C7   		movq	%rax, %rdi
 8484 0030 E8000000 		call	memset@PLT
 8484      00
6841:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 8485              		.loc 4 6841 1
 8486 0035 90       		nop
 8487 0036 488B45F8 		movq	-8(%rbp), %rax
 8488 003a 64483304 		xorq	%fs:40, %rax
 8488      25280000 
 8488      00
 8489 0043 7405     		je	.L485
 8490 0045 E8000000 		call	__stack_chk_fail@PLT
 8490      00
 8491              	.L485:
 8492 004a C9       		leave
 8493              	.LCFI170:
 8494              		.cfi_def_cfa 7, 8
 8495 004b C3       		ret
 8496              		.cfi_endproc
 8497              	.LFE75:
 8499              		.section	.text.ssl_reset_in_out_pointers,"ax",@progbits
 8501              	ssl_reset_in_out_pointers:
 8502              	.LFB76:
6842:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6843:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
6844:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Setup an SSL context
6845:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
6846:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6847:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_reset_in_out_pointers( mbedtls_ssl_context *ssl )
6848:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 8503              		.loc 4 6848 1
 8504              		.cfi_startproc
 8505 0000 F30F1EFA 		endbr64
 8506 0004 55       		pushq	%rbp
 8507              	.LCFI171:
 8508              		.cfi_def_cfa_offset 16
 8509              		.cfi_offset 6, -16
GAS LISTING /tmp/ccEn8xFO.s 			page 331


 8510 0005 4889E5   		movq	%rsp, %rbp
 8511              	.LCFI172:
 8512              		.cfi_def_cfa_register 6
 8513 0008 4883EC20 		subq	$32, %rsp
 8514 000c 48897DE8 		movq	%rdi, -24(%rbp)
 8515              		.loc 4 6848 1
 8516 0010 64488B04 		movq	%fs:40, %rax
 8516      25280000 
 8516      00
 8517 0019 488945F8 		movq	%rax, -8(%rbp)
 8518 001d 31C0     		xorl	%eax, %eax
6849:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Set the incoming and outgoing record pointers. */
6850:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
6851:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
6852:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6853:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_hdr = ssl->out_buf;
6854:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_hdr  = ssl->in_buf;
6855:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6856:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
6857:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
6858:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6859:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_hdr = ssl->out_buf + 8;
 8519              		.loc 4 6859 27
 8520 001f 488B45E8 		movq	-24(%rbp), %rax
 8521 0023 488B8000 		movq	256(%rax), %rax
 8521      010000
 8522              		.loc 4 6859 37
 8523 002a 488D5008 		leaq	8(%rax), %rdx
 8524              		.loc 4 6859 22
 8525 002e 488B45E8 		movq	-24(%rbp), %rax
 8526 0032 48899010 		movq	%rdx, 272(%rax)
 8526      010000
6860:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_hdr  = ssl->in_buf  + 8;
 8527              		.loc 4 6860 27
 8528 0039 488B45E8 		movq	-24(%rbp), %rax
 8529 003d 488B80A0 		movq	160(%rax), %rax
 8529      000000
 8530              		.loc 4 6860 37
 8531 0044 488D5008 		leaq	8(%rax), %rdx
 8532              		.loc 4 6860 22
 8533 0048 488B45E8 		movq	-24(%rbp), %rax
 8534 004c 488990B0 		movq	%rdx, 176(%rax)
 8534      000000
6861:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6862:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6863:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Derive other internal pointers. */
6864:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_update_out_pointers( ssl, NULL /* no transform enabled */ );
 8535              		.loc 4 6864 5
 8536 0053 488B45E8 		movq	-24(%rbp), %rax
 8537 0057 BE000000 		movl	$0, %esi
 8537      00
 8538 005c 4889C7   		movq	%rax, %rdi
 8539 005f E8000000 		call	ssl_update_out_pointers
 8539      00
6865:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_update_in_pointers ( ssl, NULL /* no transform enabled */ );
 8540              		.loc 4 6865 5
 8541 0064 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 332


 8542 0068 BE000000 		movl	$0, %esi
 8542      00
 8543 006d 4889C7   		movq	%rax, %rdi
 8544 0070 E8000000 		call	ssl_update_in_pointers
 8544      00
6866:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 8545              		.loc 4 6866 1
 8546 0075 90       		nop
 8547 0076 488B45F8 		movq	-8(%rbp), %rax
 8548 007a 64483304 		xorq	%fs:40, %rax
 8548      25280000 
 8548      00
 8549 0083 7405     		je	.L487
 8550 0085 E8000000 		call	__stack_chk_fail@PLT
 8550      00
 8551              	.L487:
 8552 008a C9       		leave
 8553              	.LCFI173:
 8554              		.cfi_def_cfa 7, 8
 8555 008b C3       		ret
 8556              		.cfi_endproc
 8557              	.LFE76:
 8559              		.section	.text.mbedtls_ssl_setup,"ax",@progbits
 8560              		.globl	mbedtls_ssl_setup
 8562              	mbedtls_ssl_setup:
 8563              	.LFB77:
6867:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6868:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_setup( mbedtls_ssl_context *ssl,
6869:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                        const mbedtls_ssl_config *conf )
6870:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 8564              		.loc 4 6870 1
 8565              		.cfi_startproc
 8566 0000 F30F1EFA 		endbr64
 8567 0004 55       		pushq	%rbp
 8568              	.LCFI174:
 8569              		.cfi_def_cfa_offset 16
 8570              		.cfi_offset 6, -16
 8571 0005 4889E5   		movq	%rsp, %rbp
 8572              	.LCFI175:
 8573              		.cfi_def_cfa_register 6
 8574 0008 4883EC20 		subq	$32, %rsp
 8575 000c 48897DE8 		movq	%rdi, -24(%rbp)
 8576 0010 488975E0 		movq	%rsi, -32(%rbp)
 8577              		.loc 4 6870 1
 8578 0014 64488B04 		movq	%fs:40, %rax
 8578      25280000 
 8578      00
 8579 001d 488945F8 		movq	%rax, -8(%rbp)
 8580 0021 31C0     		xorl	%eax, %eax
6871:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
6872:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6873:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->conf = conf;
 8581              		.loc 4 6873 15
 8582 0023 488B45E8 		movq	-24(%rbp), %rax
 8583 0027 488B55E0 		movq	-32(%rbp), %rdx
 8584 002b 488910   		movq	%rdx, (%rax)
6874:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 333


6875:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
6876:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Prepare base structures
6877:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
6878:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6879:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Set to NULL in case of an error condition */
6880:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_buf = NULL;
 8585              		.loc 4 6880 18
 8586 002e 488B45E8 		movq	-24(%rbp), %rax
 8587 0032 48C78000 		movq	$0, 256(%rax)
 8587      01000000 
 8587      000000
6881:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6882:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->in_buf = mbedtls_calloc( 1, MBEDTLS_SSL_IN_BUFFER_LEN );
 8588              		.loc 4 6882 19
 8589 003d BEBD3F00 		movl	$16317, %esi
 8589      00
 8590 0042 BF010000 		movl	$1, %edi
 8590      00
 8591 0047 E8000000 		call	mbedtls_calloc@PLT
 8591      00
 8592              		.loc 4 6882 17
 8593 004c 488B55E8 		movq	-24(%rbp), %rdx
 8594 0050 488982A0 		movq	%rax, 160(%rdx)
 8594      000000
6883:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_buf == NULL )
 8595              		.loc 4 6883 12
 8596 0057 488B45E8 		movq	-24(%rbp), %rax
 8597 005b 488B80A0 		movq	160(%rax), %rax
 8597      000000
 8598              		.loc 4 6883 7
 8599 0062 4885C0   		testq	%rax, %rax
 8600 0065 7509     		jne	.L489
6884:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6885:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "alloc(%d bytes) failed", MBEDTLS_SSL_IN_BUFFER_LEN) );
6886:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ret = MBEDTLS_ERR_SSL_ALLOC_FAILED;
 8601              		.loc 4 6886 13
 8602 0067 C745F400 		movl	$-32512, -12(%rbp)
 8602      81FFFF
6887:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         goto error;
 8603              		.loc 4 6887 9
 8604 006e EB5F     		jmp	.L490
 8605              	.L489:
6888:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6889:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6890:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_buf = mbedtls_calloc( 1, MBEDTLS_SSL_OUT_BUFFER_LEN );
 8606              		.loc 4 6890 20
 8607 0070 BEBD3F00 		movl	$16317, %esi
 8607      00
 8608 0075 BF010000 		movl	$1, %edi
 8608      00
 8609 007a E8000000 		call	mbedtls_calloc@PLT
 8609      00
 8610              		.loc 4 6890 18
 8611 007f 488B55E8 		movq	-24(%rbp), %rdx
 8612 0083 48898200 		movq	%rax, 256(%rdx)
 8612      010000
6891:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->out_buf == NULL )
GAS LISTING /tmp/ccEn8xFO.s 			page 334


 8613              		.loc 4 6891 12
 8614 008a 488B45E8 		movq	-24(%rbp), %rax
 8615 008e 488B8000 		movq	256(%rax), %rax
 8615      010000
 8616              		.loc 4 6891 7
 8617 0095 4885C0   		testq	%rax, %rax
 8618 0098 7509     		jne	.L491
6892:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
6893:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "alloc(%d bytes) failed", MBEDTLS_SSL_OUT_BUFFER_LEN) );
6894:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ret = MBEDTLS_ERR_SSL_ALLOC_FAILED;
 8619              		.loc 4 6894 13
 8620 009a C745F400 		movl	$-32512, -12(%rbp)
 8620      81FFFF
6895:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         goto error;
 8621              		.loc 4 6895 9
 8622 00a1 EB2C     		jmp	.L490
 8623              	.L491:
6896:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
6897:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6898:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_reset_in_out_pointers( ssl );
 8624              		.loc 4 6898 5
 8625 00a3 488B45E8 		movq	-24(%rbp), %rax
 8626 00a7 4889C7   		movq	%rax, %rdi
 8627 00aa E8000000 		call	ssl_reset_in_out_pointers
 8627      00
6899:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6900:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = ssl_handshake_init( ssl ) ) != 0 )
 8628              		.loc 4 6900 17
 8629 00af 488B45E8 		movq	-24(%rbp), %rax
 8630 00b3 4889C7   		movq	%rax, %rdi
 8631 00b6 E8000000 		call	ssl_handshake_init
 8631      00
 8632 00bb 8945F4   		movl	%eax, -12(%rbp)
 8633              		.loc 4 6900 7
 8634 00be 837DF400 		cmpl	$0, -12(%rbp)
 8635 00c2 750A     		jne	.L495
6901:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         goto error;
6902:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6903:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 8636              		.loc 4 6903 11
 8637 00c4 B8000000 		movl	$0, %eax
 8637      00
 8638 00c9 E9E90000 		jmp	.L493
 8638      00
 8639              	.L495:
6901:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         goto error;
 8640              		.loc 4 6901 9
 8641 00ce 90       		nop
 8642              	.L490:
6904:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6905:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** error:
6906:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_free( ssl->in_buf );
 8643              		.loc 4 6906 22
 8644 00cf 488B45E8 		movq	-24(%rbp), %rax
 8645 00d3 488B80A0 		movq	160(%rax), %rax
 8645      000000
 8646              		.loc 4 6906 5
GAS LISTING /tmp/ccEn8xFO.s 			page 335


 8647 00da 4889C7   		movq	%rax, %rdi
 8648 00dd E8000000 		call	mbedtls_free@PLT
 8648      00
6907:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_free( ssl->out_buf );
 8649              		.loc 4 6907 22
 8650 00e2 488B45E8 		movq	-24(%rbp), %rax
 8651 00e6 488B8000 		movq	256(%rax), %rax
 8651      010000
 8652              		.loc 4 6907 5
 8653 00ed 4889C7   		movq	%rax, %rdi
 8654 00f0 E8000000 		call	mbedtls_free@PLT
 8654      00
6908:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6909:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->conf = NULL;
 8655              		.loc 4 6909 15
 8656 00f5 488B45E8 		movq	-24(%rbp), %rax
 8657 00f9 48C70000 		movq	$0, (%rax)
 8657      000000
6910:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6911:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->in_buf = NULL;
 8658              		.loc 4 6911 17
 8659 0100 488B45E8 		movq	-24(%rbp), %rax
 8660 0104 48C780A0 		movq	$0, 160(%rax)
 8660      00000000 
 8660      000000
6912:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_buf = NULL;
 8661              		.loc 4 6912 18
 8662 010f 488B45E8 		movq	-24(%rbp), %rax
 8663 0113 48C78000 		movq	$0, 256(%rax)
 8663      01000000 
 8663      000000
6913:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6914:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->in_hdr = NULL;
 8664              		.loc 4 6914 17
 8665 011e 488B45E8 		movq	-24(%rbp), %rax
 8666 0122 48C780B0 		movq	$0, 176(%rax)
 8666      00000000 
 8666      000000
6915:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->in_ctr = NULL;
 8667              		.loc 4 6915 17
 8668 012d 488B45E8 		movq	-24(%rbp), %rax
 8669 0131 48C780A8 		movq	$0, 168(%rax)
 8669      00000000 
 8669      000000
6916:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->in_len = NULL;
 8670              		.loc 4 6916 17
 8671 013c 488B45E8 		movq	-24(%rbp), %rax
 8672 0140 48C780B8 		movq	$0, 184(%rax)
 8672      00000000 
 8672      000000
6917:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->in_iv = NULL;
 8673              		.loc 4 6917 16
 8674 014b 488B45E8 		movq	-24(%rbp), %rax
 8675 014f 48C780C0 		movq	$0, 192(%rax)
 8675      00000000 
 8675      000000
6918:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->in_msg = NULL;
GAS LISTING /tmp/ccEn8xFO.s 			page 336


 8676              		.loc 4 6918 17
 8677 015a 488B45E8 		movq	-24(%rbp), %rax
 8678 015e 48C780C8 		movq	$0, 200(%rax)
 8678      00000000 
 8678      000000
6919:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6920:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_hdr = NULL;
 8679              		.loc 4 6920 18
 8680 0169 488B45E8 		movq	-24(%rbp), %rax
 8681 016d 48C78010 		movq	$0, 272(%rax)
 8681      01000000 
 8681      000000
6921:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_ctr = NULL;
 8682              		.loc 4 6921 18
 8683 0178 488B45E8 		movq	-24(%rbp), %rax
 8684 017c 48C78008 		movq	$0, 264(%rax)
 8684      01000000 
 8684      000000
6922:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_len = NULL;
 8685              		.loc 4 6922 18
 8686 0187 488B45E8 		movq	-24(%rbp), %rax
 8687 018b 48C78018 		movq	$0, 280(%rax)
 8687      01000000 
 8687      000000
6923:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_iv = NULL;
 8688              		.loc 4 6923 17
 8689 0196 488B45E8 		movq	-24(%rbp), %rax
 8690 019a 48C78020 		movq	$0, 288(%rax)
 8690      01000000 
 8690      000000
6924:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_msg = NULL;
 8691              		.loc 4 6924 18
 8692 01a5 488B45E8 		movq	-24(%rbp), %rax
 8693 01a9 48C78028 		movq	$0, 296(%rax)
 8693      01000000 
 8693      000000
6925:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6926:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ret );
 8694              		.loc 4 6926 11
 8695 01b4 8B45F4   		movl	-12(%rbp), %eax
 8696              	.L493:
6927:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 8697              		.loc 4 6927 1
 8698 01b7 488B4DF8 		movq	-8(%rbp), %rcx
 8699 01bb 6448330C 		xorq	%fs:40, %rcx
 8699      25280000 
 8699      00
 8700 01c4 7405     		je	.L494
 8701 01c6 E8000000 		call	__stack_chk_fail@PLT
 8701      00
 8702              	.L494:
 8703 01cb C9       		leave
 8704              	.LCFI176:
 8705              		.cfi_def_cfa 7, 8
 8706 01cc C3       		ret
 8707              		.cfi_endproc
 8708              	.LFE77:
GAS LISTING /tmp/ccEn8xFO.s 			page 337


 8710              		.section	.text.ssl_session_reset_int,"ax",@progbits
 8712              	ssl_session_reset_int:
 8713              	.LFB78:
6928:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6929:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
6930:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Reset an initialized and used SSL context for re-use while retaining
6931:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * all application-set variables, function pointers and data.
6932:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
6933:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * If partial is non-zero, keep data in the input buffer and client ID.
6934:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * (Use when a DTLS client reconnects from the same port.)
6935:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
6936:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_session_reset_int( mbedtls_ssl_context *ssl, int partial )
6937:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 8714              		.loc 4 6937 1
 8715              		.cfi_startproc
 8716 0000 F30F1EFA 		endbr64
 8717 0004 55       		pushq	%rbp
 8718              	.LCFI177:
 8719              		.cfi_def_cfa_offset 16
 8720              		.cfi_offset 6, -16
 8721 0005 4889E5   		movq	%rsp, %rbp
 8722              	.LCFI178:
 8723              		.cfi_def_cfa_register 6
 8724 0008 4883EC20 		subq	$32, %rsp
 8725 000c 48897DE8 		movq	%rdi, -24(%rbp)
 8726 0010 8975E4   		movl	%esi, -28(%rbp)
 8727              		.loc 4 6937 1
 8728 0013 64488B04 		movq	%fs:40, %rax
 8728      25280000 
 8728      00
 8729 001c 488945F8 		movq	%rax, -8(%rbp)
 8730 0020 31C0     		xorl	%eax, %eax
6938:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
6939:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6940:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if !defined(MBEDTLS_SSL_DTLS_CLIENT_PORT_REUSE) ||     \
6941:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     !defined(MBEDTLS_SSL_SRV_C)
6942:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ((void) partial);
6943:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6944:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6945:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->state = MBEDTLS_SSL_HELLO_REQUEST;
 8731              		.loc 4 6945 16
 8732 0022 488B45E8 		movq	-24(%rbp), %rax
 8733 0026 C7400800 		movl	$0, 8(%rax)
 8733      000000
6946:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6947:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Cancel any possibly running timer */
6948:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_set_timer( ssl, 0 );
 8734              		.loc 4 6948 5
 8735 002d 488B45E8 		movq	-24(%rbp), %rax
 8736 0031 BE000000 		movl	$0, %esi
 8736      00
 8737 0036 4889C7   		movq	%rax, %rdi
 8738 0039 E8000000 		call	ssl_set_timer
 8738      00
6949:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6950:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
6951:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->renego_status = MBEDTLS_SSL_INITIAL_HANDSHAKE;
GAS LISTING /tmp/ccEn8xFO.s 			page 338


 8739              		.loc 4 6951 24
 8740 003e 488B45E8 		movq	-24(%rbp), %rax
 8741 0042 C7400C00 		movl	$0, 12(%rax)
 8741      000000
6952:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->renego_records_seen = 0;
 8742              		.loc 4 6952 30
 8743 0049 488B45E8 		movq	-24(%rbp), %rax
 8744 004d C7401000 		movl	$0, 16(%rax)
 8744      000000
6953:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6954:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->verify_data_len = 0;
 8745              		.loc 4 6954 26
 8746 0054 488B45E8 		movq	-24(%rbp), %rax
 8747 0058 48C78068 		movq	$0, 360(%rax)
 8747      01000000 
 8747      000000
6955:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memset( ssl->own_verify_data, 0, MBEDTLS_SSL_VERIFY_DATA_MAX_LEN );
 8748              		.loc 4 6955 16
 8749 0063 488B45E8 		movq	-24(%rbp), %rax
 8750 0067 48057001 		addq	$368, %rax
 8750      0000
 8751              		.loc 4 6955 5
 8752 006d BA0C0000 		movl	$12, %edx
 8752      00
 8753 0072 BE000000 		movl	$0, %esi
 8753      00
 8754 0077 4889C7   		movq	%rax, %rdi
 8755 007a E8000000 		call	memset@PLT
 8755      00
6956:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memset( ssl->peer_verify_data, 0, MBEDTLS_SSL_VERIFY_DATA_MAX_LEN );
 8756              		.loc 4 6956 16
 8757 007f 488B45E8 		movq	-24(%rbp), %rax
 8758 0083 48057C01 		addq	$380, %rax
 8758      0000
 8759              		.loc 4 6956 5
 8760 0089 BA0C0000 		movl	$12, %edx
 8760      00
 8761 008e BE000000 		movl	$0, %esi
 8761      00
 8762 0093 4889C7   		movq	%rax, %rdi
 8763 0096 E8000000 		call	memset@PLT
 8763      00
6957:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6958:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->secure_renegotiation = MBEDTLS_SSL_LEGACY_RENEGOTIATION;
 8764              		.loc 4 6958 31
 8765 009b 488B45E8 		movq	-24(%rbp), %rax
 8766 009f C7806001 		movl	$0, 352(%rax)
 8766      00000000 
 8766      0000
6959:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6960:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->in_offt = NULL;
 8767              		.loc 4 6960 18
 8768 00a9 488B45E8 		movq	-24(%rbp), %rax
 8769 00ad 48C780D0 		movq	$0, 208(%rax)
 8769      00000000 
 8769      000000
6961:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_reset_in_out_pointers( ssl );
GAS LISTING /tmp/ccEn8xFO.s 			page 339


 8770              		.loc 4 6961 5
 8771 00b8 488B45E8 		movq	-24(%rbp), %rax
 8772 00bc 4889C7   		movq	%rax, %rdi
 8773 00bf E8000000 		call	ssl_reset_in_out_pointers
 8773      00
6962:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6963:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->in_msgtype = 0;
 8774              		.loc 4 6963 21
 8775 00c4 488B45E8 		movq	-24(%rbp), %rax
 8776 00c8 C780D800 		movl	$0, 216(%rax)
 8776      00000000 
 8776      0000
6964:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->in_msglen = 0;
 8777              		.loc 4 6964 20
 8778 00d2 488B45E8 		movq	-24(%rbp), %rax
 8779 00d6 48C780E0 		movq	$0, 224(%rax)
 8779      00000000 
 8779      000000
6965:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
6966:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->next_record_offset = 0;
6967:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->in_epoch = 0;
6968:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6969:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_ANTI_REPLAY)
6970:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_dtls_replay_reset( ssl );
6971:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6972:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6973:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->in_hslen = 0;
 8780              		.loc 4 6973 19
 8781 00e1 488B45E8 		movq	-24(%rbp), %rax
 8782 00e5 48C780F0 		movq	$0, 240(%rax)
 8782      00000000 
 8782      000000
6974:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->nb_zero = 0;
 8783              		.loc 4 6974 18
 8784 00f0 488B45E8 		movq	-24(%rbp), %rax
 8785 00f4 C780F800 		movl	$0, 248(%rax)
 8785      00000000 
 8785      0000
6975:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6976:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->keep_current_message = 0;
 8786              		.loc 4 6976 31
 8787 00fe 488B45E8 		movq	-24(%rbp), %rax
 8788 0102 C780FC00 		movl	$0, 252(%rax)
 8788      00000000 
 8788      0000
6977:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6978:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_msgtype = 0;
 8789              		.loc 4 6978 22
 8790 010c 488B45E8 		movq	-24(%rbp), %rax
 8791 0110 C7803001 		movl	$0, 304(%rax)
 8791      00000000 
 8791      0000
6979:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_msglen = 0;
 8792              		.loc 4 6979 21
 8793 011a 488B45E8 		movq	-24(%rbp), %rax
 8794 011e 48C78038 		movq	$0, 312(%rax)
 8794      01000000 
GAS LISTING /tmp/ccEn8xFO.s 			page 340


 8794      000000
6980:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_left = 0;
 8795              		.loc 4 6980 19
 8796 0129 488B45E8 		movq	-24(%rbp), %rax
 8797 012d 48C78040 		movq	$0, 320(%rax)
 8797      01000000 
 8797      000000
6981:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_CBC_RECORD_SPLITTING)
6982:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->split_done != MBEDTLS_SSL_CBC_RECORD_SPLITTING_DISABLED )
6983:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->split_done = 0;
6984:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
6985:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6986:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memset( ssl->cur_out_ctr, 0, sizeof( ssl->cur_out_ctr ) );
 8798              		.loc 4 6986 16
 8799 0138 488B45E8 		movq	-24(%rbp), %rax
 8800 013c 48054801 		addq	$328, %rax
 8800      0000
 8801              		.loc 4 6986 5
 8802 0142 BA080000 		movl	$8, %edx
 8802      00
 8803 0147 BE000000 		movl	$0, %esi
 8803      00
 8804 014c 4889C7   		movq	%rax, %rdi
 8805 014f E8000000 		call	memset@PLT
 8805      00
6987:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6988:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->transform_in = NULL;
 8806              		.loc 4 6988 23
 8807 0154 488B45E8 		movq	-24(%rbp), %rax
 8808 0158 48C74068 		movq	$0, 104(%rax)
 8808      00000000 
6989:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->transform_out = NULL;
 8809              		.loc 4 6989 24
 8810 0160 488B45E8 		movq	-24(%rbp), %rax
 8811 0164 48C74070 		movq	$0, 112(%rax)
 8811      00000000 
6990:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6991:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->session_in = NULL;
 8812              		.loc 4 6991 21
 8813 016c 488B45E8 		movq	-24(%rbp), %rax
 8814 0170 48C74040 		movq	$0, 64(%rax)
 8814      00000000 
6992:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->session_out = NULL;
 8815              		.loc 4 6992 22
 8816 0178 488B45E8 		movq	-24(%rbp), %rax
 8817 017c 48C74048 		movq	$0, 72(%rax)
 8817      00000000 
6993:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6994:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memset( ssl->out_buf, 0, MBEDTLS_SSL_OUT_BUFFER_LEN );
 8818              		.loc 4 6994 16
 8819 0184 488B45E8 		movq	-24(%rbp), %rax
 8820 0188 488B8000 		movq	256(%rax), %rax
 8820      010000
 8821              		.loc 4 6994 5
 8822 018f BABD3F00 		movl	$16317, %edx
 8822      00
 8823 0194 BE000000 		movl	$0, %esi
GAS LISTING /tmp/ccEn8xFO.s 			page 341


 8823      00
 8824 0199 4889C7   		movq	%rax, %rdi
 8825 019c E8000000 		call	memset@PLT
 8825      00
6995:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
6996:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_CLIENT_PORT_REUSE) && defined(MBEDTLS_SSL_SRV_C)
6997:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( partial == 0 )
6998:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_DTLS_CLIENT_PORT_REUSE && MBEDTLS_SSL_SRV_C */
6999:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7000:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_left = 0;
 8826              		.loc 4 7000 22
 8827 01a1 488B45E8 		movq	-24(%rbp), %rax
 8828 01a5 48C780E8 		movq	$0, 232(%rax)
 8828      00000000 
 8828      000000
7001:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memset( ssl->in_buf, 0, MBEDTLS_SSL_IN_BUFFER_LEN );
 8829              		.loc 4 7001 20
 8830 01b0 488B45E8 		movq	-24(%rbp), %rax
 8831 01b4 488B80A0 		movq	160(%rax), %rax
 8831      000000
 8832              		.loc 4 7001 9
 8833 01bb BABD3F00 		movl	$16317, %edx
 8833      00
 8834 01c0 BE000000 		movl	$0, %esi
 8834      00
 8835 01c5 4889C7   		movq	%rax, %rdi
 8836 01c8 E8000000 		call	memset@PLT
 8836      00
7002:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7003:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7004:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_HW_RECORD_ACCEL)
7005:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( mbedtls_ssl_hw_record_reset != NULL )
7006:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7007:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "going for mbedtls_ssl_hw_record_reset()" ) );
7008:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_ssl_hw_record_reset( ssl ) ) != 0 )
7009:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
7010:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_hw_record_reset", ret );
7011:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_HW_ACCEL_FAILED );
7012:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
7013:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7014:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
7015:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7016:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->transform )
 8837              		.loc 4 7016 12
 8838 01cd 488B45E8 		movq	-24(%rbp), %rax
 8839 01d1 488B4078 		movq	120(%rax), %rax
 8840              		.loc 4 7016 7
 8841 01d5 4885C0   		testq	%rax, %rax
 8842 01d8 742C     		je	.L497
7017:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7018:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_transform_free( ssl->transform );
 8843              		.loc 4 7018 9
 8844 01da 488B45E8 		movq	-24(%rbp), %rax
 8845 01de 488B4078 		movq	120(%rax), %rax
 8846 01e2 4889C7   		movq	%rax, %rdi
 8847 01e5 E8000000 		call	mbedtls_ssl_transform_free
 8847      00
GAS LISTING /tmp/ccEn8xFO.s 			page 342


7019:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( ssl->transform );
 8848              		.loc 4 7019 26
 8849 01ea 488B45E8 		movq	-24(%rbp), %rax
 8850 01ee 488B4078 		movq	120(%rax), %rax
 8851              		.loc 4 7019 9
 8852 01f2 4889C7   		movq	%rax, %rdi
 8853 01f5 E8000000 		call	mbedtls_free@PLT
 8853      00
7020:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->transform = NULL;
 8854              		.loc 4 7020 24
 8855 01fa 488B45E8 		movq	-24(%rbp), %rax
 8856 01fe 48C74078 		movq	$0, 120(%rax)
 8856      00000000 
 8857              	.L497:
7021:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7022:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7023:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->session )
 8858              		.loc 4 7023 12
 8859 0206 488B45E8 		movq	-24(%rbp), %rax
 8860 020a 488B4050 		movq	80(%rax), %rax
 8861              		.loc 4 7023 7
 8862 020e 4885C0   		testq	%rax, %rax
 8863 0211 742C     		je	.L498
7024:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7025:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_session_free( ssl->session );
 8864              		.loc 4 7025 9
 8865 0213 488B45E8 		movq	-24(%rbp), %rax
 8866 0217 488B4050 		movq	80(%rax), %rax
 8867 021b 4889C7   		movq	%rax, %rdi
 8868 021e E8000000 		call	mbedtls_ssl_session_free
 8868      00
7026:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( ssl->session );
 8869              		.loc 4 7026 26
 8870 0223 488B45E8 		movq	-24(%rbp), %rax
 8871 0227 488B4050 		movq	80(%rax), %rax
 8872              		.loc 4 7026 9
 8873 022b 4889C7   		movq	%rax, %rdi
 8874 022e E8000000 		call	mbedtls_free@PLT
 8874      00
7027:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->session = NULL;
 8875              		.loc 4 7027 22
 8876 0233 488B45E8 		movq	-24(%rbp), %rax
 8877 0237 48C74050 		movq	$0, 80(%rax)
 8877      00000000 
 8878              	.L498:
7028:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7029:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7030:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_ALPN)
7031:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->alpn_chosen = NULL;
7032:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
7033:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7034:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_HELLO_VERIFY) && defined(MBEDTLS_SSL_SRV_C)
7035:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_CLIENT_PORT_REUSE)
7036:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( partial == 0 )
7037:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
7038:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7039:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( ssl->cli_id );
GAS LISTING /tmp/ccEn8xFO.s 			page 343


7040:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->cli_id = NULL;
7041:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->cli_id_len = 0;
7042:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7043:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
7044:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7045:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = ssl_handshake_init( ssl ) ) != 0 )
 8879              		.loc 4 7045 17
 8880 023f 488B45E8 		movq	-24(%rbp), %rax
 8881 0243 4889C7   		movq	%rax, %rdi
 8882 0246 E8000000 		call	ssl_handshake_init
 8882      00
 8883 024b 8945F4   		movl	%eax, -12(%rbp)
 8884              		.loc 4 7045 7
 8885 024e 837DF400 		cmpl	$0, -12(%rbp)
 8886 0252 7405     		je	.L499
7046:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 8887              		.loc 4 7046 15
 8888 0254 8B45F4   		movl	-12(%rbp), %eax
 8889 0257 EB05     		jmp	.L500
 8890              	.L499:
7047:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7048:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 8891              		.loc 4 7048 11
 8892 0259 B8000000 		movl	$0, %eax
 8892      00
 8893              	.L500:
7049:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 8894              		.loc 4 7049 1
 8895 025e 488B4DF8 		movq	-8(%rbp), %rcx
 8896 0262 6448330C 		xorq	%fs:40, %rcx
 8896      25280000 
 8896      00
 8897 026b 7405     		je	.L501
 8898 026d E8000000 		call	__stack_chk_fail@PLT
 8898      00
 8899              	.L501:
 8900 0272 C9       		leave
 8901              	.LCFI179:
 8902              		.cfi_def_cfa 7, 8
 8903 0273 C3       		ret
 8904              		.cfi_endproc
 8905              	.LFE78:
 8907              		.section	.text.mbedtls_ssl_session_reset,"ax",@progbits
 8908              		.globl	mbedtls_ssl_session_reset
 8910              	mbedtls_ssl_session_reset:
 8911              	.LFB79:
7050:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7051:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
7052:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Reset an initialized and used SSL context for re-use while retaining
7053:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * all application-set variables, function pointers and data.
7054:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
7055:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_session_reset( mbedtls_ssl_context *ssl )
7056:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 8912              		.loc 4 7056 1
 8913              		.cfi_startproc
 8914 0000 F30F1EFA 		endbr64
 8915 0004 55       		pushq	%rbp
GAS LISTING /tmp/ccEn8xFO.s 			page 344


 8916              	.LCFI180:
 8917              		.cfi_def_cfa_offset 16
 8918              		.cfi_offset 6, -16
 8919 0005 4889E5   		movq	%rsp, %rbp
 8920              	.LCFI181:
 8921              		.cfi_def_cfa_register 6
 8922 0008 4883EC20 		subq	$32, %rsp
 8923 000c 48897DE8 		movq	%rdi, -24(%rbp)
 8924              		.loc 4 7056 1
 8925 0010 64488B04 		movq	%fs:40, %rax
 8925      25280000 
 8925      00
 8926 0019 488945F8 		movq	%rax, -8(%rbp)
 8927 001d 31C0     		xorl	%eax, %eax
7057:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ssl_session_reset_int( ssl, 0 ) );
 8928              		.loc 4 7057 13
 8929 001f 488B45E8 		movq	-24(%rbp), %rax
 8930 0023 BE000000 		movl	$0, %esi
 8930      00
 8931 0028 4889C7   		movq	%rax, %rdi
 8932 002b E8000000 		call	ssl_session_reset_int
 8932      00
7058:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 8933              		.loc 4 7058 1
 8934 0030 488B55F8 		movq	-8(%rbp), %rdx
 8935 0034 64483314 		xorq	%fs:40, %rdx
 8935      25280000 
 8935      00
 8936 003d 7405     		je	.L504
 8937 003f E8000000 		call	__stack_chk_fail@PLT
 8937      00
 8938              	.L504:
 8939 0044 C9       		leave
 8940              	.LCFI182:
 8941              		.cfi_def_cfa 7, 8
 8942 0045 C3       		ret
 8943              		.cfi_endproc
 8944              	.LFE79:
 8946              		.section	.text.mbedtls_ssl_conf_endpoint,"ax",@progbits
 8947              		.globl	mbedtls_ssl_conf_endpoint
 8949              	mbedtls_ssl_conf_endpoint:
 8950              	.LFB80:
7059:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7060:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
7061:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * SSL set accessors
7062:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
7063:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_endpoint( mbedtls_ssl_config *conf, int endpoint )
7064:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 8951              		.loc 4 7064 1
 8952              		.cfi_startproc
 8953 0000 F30F1EFA 		endbr64
 8954 0004 55       		pushq	%rbp
 8955              	.LCFI183:
 8956              		.cfi_def_cfa_offset 16
 8957              		.cfi_offset 6, -16
 8958 0005 4889E5   		movq	%rsp, %rbp
 8959              	.LCFI184:
GAS LISTING /tmp/ccEn8xFO.s 			page 345


 8960              		.cfi_def_cfa_register 6
 8961 0008 4883EC20 		subq	$32, %rsp
 8962 000c 48897DE8 		movq	%rdi, -24(%rbp)
 8963 0010 8975E4   		movl	%esi, -28(%rbp)
 8964              		.loc 4 7064 1
 8965 0013 64488B04 		movq	%fs:40, %rax
 8965      25280000 
 8965      00
 8966 001c 488945F8 		movq	%rax, -8(%rbp)
 8967 0020 31C0     		xorl	%eax, %eax
7065:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->endpoint   = endpoint;
 8968              		.loc 4 7065 22
 8969 0022 8B45E4   		movl	-28(%rbp), %eax
 8970 0025 83E001   		andl	$1, %eax
 8971 0028 488B55E8 		movq	-24(%rbp), %rdx
 8972 002c 83E001   		andl	$1, %eax
 8973 002f 89C1     		movl	%eax, %ecx
 8974 0031 0FB682BC 		movzbl	188(%rdx), %eax
 8974      000000
 8975 0038 83E0FE   		andl	$-2, %eax
 8976 003b 09C8     		orl	%ecx, %eax
 8977 003d 8882BC00 		movb	%al, 188(%rdx)
 8977      0000
7066:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 8978              		.loc 4 7066 1
 8979 0043 90       		nop
 8980 0044 488B45F8 		movq	-8(%rbp), %rax
 8981 0048 64483304 		xorq	%fs:40, %rax
 8981      25280000 
 8981      00
 8982 0051 7405     		je	.L506
 8983 0053 E8000000 		call	__stack_chk_fail@PLT
 8983      00
 8984              	.L506:
 8985 0058 C9       		leave
 8986              	.LCFI185:
 8987              		.cfi_def_cfa 7, 8
 8988 0059 C3       		ret
 8989              		.cfi_endproc
 8990              	.LFE80:
 8992              		.section	.text.mbedtls_ssl_conf_transport,"ax",@progbits
 8993              		.globl	mbedtls_ssl_conf_transport
 8995              	mbedtls_ssl_conf_transport:
 8996              	.LFB81:
7067:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7068:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_transport( mbedtls_ssl_config *conf, int transport )
7069:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 8997              		.loc 4 7069 1
 8998              		.cfi_startproc
 8999 0000 F30F1EFA 		endbr64
 9000 0004 55       		pushq	%rbp
 9001              	.LCFI186:
 9002              		.cfi_def_cfa_offset 16
 9003              		.cfi_offset 6, -16
 9004 0005 4889E5   		movq	%rsp, %rbp
 9005              	.LCFI187:
 9006              		.cfi_def_cfa_register 6
GAS LISTING /tmp/ccEn8xFO.s 			page 346


 9007 0008 4883EC20 		subq	$32, %rsp
 9008 000c 48897DE8 		movq	%rdi, -24(%rbp)
 9009 0010 8975E4   		movl	%esi, -28(%rbp)
 9010              		.loc 4 7069 1
 9011 0013 64488B04 		movq	%fs:40, %rax
 9011      25280000 
 9011      00
 9012 001c 488945F8 		movq	%rax, -8(%rbp)
 9013 0020 31C0     		xorl	%eax, %eax
7070:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->transport = transport;
 9014              		.loc 4 7070 21
 9015 0022 8B45E4   		movl	-28(%rbp), %eax
 9016 0025 83E001   		andl	$1, %eax
 9017 0028 488B55E8 		movq	-24(%rbp), %rdx
 9018 002c 83E001   		andl	$1, %eax
 9019 002f 8D0C00   		leal	(%rax,%rax), %ecx
 9020 0032 0FB682BC 		movzbl	188(%rdx), %eax
 9020      000000
 9021 0039 83E0FD   		andl	$-3, %eax
 9022 003c 09C8     		orl	%ecx, %eax
 9023 003e 8882BC00 		movb	%al, 188(%rdx)
 9023      0000
7071:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 9024              		.loc 4 7071 1
 9025 0044 90       		nop
 9026 0045 488B45F8 		movq	-8(%rbp), %rax
 9027 0049 64483304 		xorq	%fs:40, %rax
 9027      25280000 
 9027      00
 9028 0052 7405     		je	.L508
 9029 0054 E8000000 		call	__stack_chk_fail@PLT
 9029      00
 9030              	.L508:
 9031 0059 C9       		leave
 9032              	.LCFI188:
 9033              		.cfi_def_cfa 7, 8
 9034 005a C3       		ret
 9035              		.cfi_endproc
 9036              	.LFE81:
 9038              		.section	.text.mbedtls_ssl_conf_authmode,"ax",@progbits
 9039              		.globl	mbedtls_ssl_conf_authmode
 9041              	mbedtls_ssl_conf_authmode:
 9042              	.LFB82:
7072:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7073:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_ANTI_REPLAY)
7074:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_dtls_anti_replay( mbedtls_ssl_config *conf, char mode )
7075:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7076:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->anti_replay = mode;
7077:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7078:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
7079:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7080:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_BADMAC_LIMIT)
7081:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_dtls_badmac_limit( mbedtls_ssl_config *conf, unsigned limit )
7082:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7083:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->badmac_limit = limit;
7084:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7085:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
GAS LISTING /tmp/ccEn8xFO.s 			page 347


7086:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7087:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
7088:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7089:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_set_datagram_packing( mbedtls_ssl_context *ssl,
7090:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                        unsigned allow_packing )
7091:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7092:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->disable_datagram_packing = !allow_packing;
7093:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7094:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7095:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_handshake_timeout( mbedtls_ssl_config *conf,
7096:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                          uint32_t min, uint32_t max )
7097:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7098:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->hs_timeout_min = min;
7099:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->hs_timeout_max = max;
7100:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7101:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
7102:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7103:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_authmode( mbedtls_ssl_config *conf, int authmode )
7104:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 9043              		.loc 4 7104 1
 9044              		.cfi_startproc
 9045 0000 F30F1EFA 		endbr64
 9046 0004 55       		pushq	%rbp
 9047              	.LCFI189:
 9048              		.cfi_def_cfa_offset 16
 9049              		.cfi_offset 6, -16
 9050 0005 4889E5   		movq	%rsp, %rbp
 9051              	.LCFI190:
 9052              		.cfi_def_cfa_register 6
 9053 0008 4883EC20 		subq	$32, %rsp
 9054 000c 48897DE8 		movq	%rdi, -24(%rbp)
 9055 0010 8975E4   		movl	%esi, -28(%rbp)
 9056              		.loc 4 7104 1
 9057 0013 64488B04 		movq	%fs:40, %rax
 9057      25280000 
 9057      00
 9058 001c 488945F8 		movq	%rax, -8(%rbp)
 9059 0020 31C0     		xorl	%eax, %eax
7105:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->authmode   = authmode;
 9060              		.loc 4 7105 22
 9061 0022 8B45E4   		movl	-28(%rbp), %eax
 9062 0025 83E003   		andl	$3, %eax
 9063 0028 488B55E8 		movq	-24(%rbp), %rdx
 9064 002c 83E003   		andl	$3, %eax
 9065 002f 8D0C8500 		leal	0(,%rax,4), %ecx
 9065      000000
 9066 0036 0FB682BC 		movzbl	188(%rdx), %eax
 9066      000000
 9067 003d 83E0F3   		andl	$-13, %eax
 9068 0040 09C8     		orl	%ecx, %eax
 9069 0042 8882BC00 		movb	%al, 188(%rdx)
 9069      0000
7106:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 9070              		.loc 4 7106 1
 9071 0048 90       		nop
 9072 0049 488B45F8 		movq	-8(%rbp), %rax
 9073 004d 64483304 		xorq	%fs:40, %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 348


 9073      25280000 
 9073      00
 9074 0056 7405     		je	.L510
 9075 0058 E8000000 		call	__stack_chk_fail@PLT
 9075      00
 9076              	.L510:
 9077 005d C9       		leave
 9078              	.LCFI191:
 9079              		.cfi_def_cfa 7, 8
 9080 005e C3       		ret
 9081              		.cfi_endproc
 9082              	.LFE82:
 9084              		.section	.text.mbedtls_ssl_conf_verify,"ax",@progbits
 9085              		.globl	mbedtls_ssl_conf_verify
 9087              	mbedtls_ssl_conf_verify:
 9088              	.LFB83:
7107:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7108:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
7109:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_verify( mbedtls_ssl_config *conf,
7110:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      int (*f_vrfy)(void *, mbedtls_x509_crt *, int, uint32_t *),
7111:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      void *p_vrfy )
7112:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 9089              		.loc 4 7112 1
 9090              		.cfi_startproc
 9091 0000 F30F1EFA 		endbr64
 9092 0004 55       		pushq	%rbp
 9093              	.LCFI192:
 9094              		.cfi_def_cfa_offset 16
 9095              		.cfi_offset 6, -16
 9096 0005 4889E5   		movq	%rsp, %rbp
 9097              	.LCFI193:
 9098              		.cfi_def_cfa_register 6
 9099 0008 4883EC30 		subq	$48, %rsp
 9100 000c 48897DE8 		movq	%rdi, -24(%rbp)
 9101 0010 488975E0 		movq	%rsi, -32(%rbp)
 9102 0014 488955D8 		movq	%rdx, -40(%rbp)
 9103              		.loc 4 7112 1
 9104 0018 64488B04 		movq	%fs:40, %rax
 9104      25280000 
 9104      00
 9105 0021 488945F8 		movq	%rax, -8(%rbp)
 9106 0025 31C0     		xorl	%eax, %eax
7113:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->f_vrfy      = f_vrfy;
 9107              		.loc 4 7113 23
 9108 0027 488B45E8 		movq	-24(%rbp), %rax
 9109 002b 488B55E0 		movq	-32(%rbp), %rdx
 9110 002f 48895058 		movq	%rdx, 88(%rax)
7114:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->p_vrfy      = p_vrfy;
 9111              		.loc 4 7114 23
 9112 0033 488B45E8 		movq	-24(%rbp), %rax
 9113 0037 488B55D8 		movq	-40(%rbp), %rdx
 9114 003b 48895060 		movq	%rdx, 96(%rax)
7115:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 9115              		.loc 4 7115 1
 9116 003f 90       		nop
 9117 0040 488B45F8 		movq	-8(%rbp), %rax
 9118 0044 64483304 		xorq	%fs:40, %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 349


 9118      25280000 
 9118      00
 9119 004d 7405     		je	.L512
 9120 004f E8000000 		call	__stack_chk_fail@PLT
 9120      00
 9121              	.L512:
 9122 0054 C9       		leave
 9123              	.LCFI194:
 9124              		.cfi_def_cfa 7, 8
 9125 0055 C3       		ret
 9126              		.cfi_endproc
 9127              	.LFE83:
 9129              		.section	.text.mbedtls_ssl_conf_rng,"ax",@progbits
 9130              		.globl	mbedtls_ssl_conf_rng
 9132              	mbedtls_ssl_conf_rng:
 9133              	.LFB84:
7116:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
7117:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7118:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_rng( mbedtls_ssl_config *conf,
7119:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                   int (*f_rng)(void *, unsigned char *, size_t),
7120:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                   void *p_rng )
7121:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 9134              		.loc 4 7121 1
 9135              		.cfi_startproc
 9136 0000 F30F1EFA 		endbr64
 9137 0004 55       		pushq	%rbp
 9138              	.LCFI195:
 9139              		.cfi_def_cfa_offset 16
 9140              		.cfi_offset 6, -16
 9141 0005 4889E5   		movq	%rsp, %rbp
 9142              	.LCFI196:
 9143              		.cfi_def_cfa_register 6
 9144 0008 4883EC30 		subq	$48, %rsp
 9145 000c 48897DE8 		movq	%rdi, -24(%rbp)
 9146 0010 488975E0 		movq	%rsi, -32(%rbp)
 9147 0014 488955D8 		movq	%rdx, -40(%rbp)
 9148              		.loc 4 7121 1
 9149 0018 64488B04 		movq	%fs:40, %rax
 9149      25280000 
 9149      00
 9150 0021 488945F8 		movq	%rax, -8(%rbp)
 9151 0025 31C0     		xorl	%eax, %eax
7122:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->f_rng      = f_rng;
 9152              		.loc 4 7122 22
 9153 0027 488B45E8 		movq	-24(%rbp), %rax
 9154 002b 488B55E0 		movq	-32(%rbp), %rdx
 9155 002f 48895030 		movq	%rdx, 48(%rax)
7123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->p_rng      = p_rng;
 9156              		.loc 4 7123 22
 9157 0033 488B45E8 		movq	-24(%rbp), %rax
 9158 0037 488B55D8 		movq	-40(%rbp), %rdx
 9159 003b 48895038 		movq	%rdx, 56(%rax)
7124:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 9160              		.loc 4 7124 1
 9161 003f 90       		nop
 9162 0040 488B45F8 		movq	-8(%rbp), %rax
 9163 0044 64483304 		xorq	%fs:40, %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 350


 9163      25280000 
 9163      00
 9164 004d 7405     		je	.L514
 9165 004f E8000000 		call	__stack_chk_fail@PLT
 9165      00
 9166              	.L514:
 9167 0054 C9       		leave
 9168              	.LCFI197:
 9169              		.cfi_def_cfa 7, 8
 9170 0055 C3       		ret
 9171              		.cfi_endproc
 9172              	.LFE84:
 9174              		.section	.text.mbedtls_ssl_conf_dbg,"ax",@progbits
 9175              		.globl	mbedtls_ssl_conf_dbg
 9177              	mbedtls_ssl_conf_dbg:
 9178              	.LFB85:
7125:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7126:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_dbg( mbedtls_ssl_config *conf,
7127:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                   void (*f_dbg)(void *, int, const char *, int, const char *),
7128:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                   void  *p_dbg )
7129:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 9179              		.loc 4 7129 1
 9180              		.cfi_startproc
 9181 0000 F30F1EFA 		endbr64
 9182 0004 55       		pushq	%rbp
 9183              	.LCFI198:
 9184              		.cfi_def_cfa_offset 16
 9185              		.cfi_offset 6, -16
 9186 0005 4889E5   		movq	%rsp, %rbp
 9187              	.LCFI199:
 9188              		.cfi_def_cfa_register 6
 9189 0008 4883EC30 		subq	$48, %rsp
 9190 000c 48897DE8 		movq	%rdi, -24(%rbp)
 9191 0010 488975E0 		movq	%rsi, -32(%rbp)
 9192 0014 488955D8 		movq	%rdx, -40(%rbp)
 9193              		.loc 4 7129 1
 9194 0018 64488B04 		movq	%fs:40, %rax
 9194      25280000 
 9194      00
 9195 0021 488945F8 		movq	%rax, -8(%rbp)
 9196 0025 31C0     		xorl	%eax, %eax
7130:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->f_dbg      = f_dbg;
 9197              		.loc 4 7130 22
 9198 0027 488B45E8 		movq	-24(%rbp), %rax
 9199 002b 488B55E0 		movq	-32(%rbp), %rdx
 9200 002f 48895020 		movq	%rdx, 32(%rax)
7131:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->p_dbg      = p_dbg;
 9201              		.loc 4 7131 22
 9202 0033 488B45E8 		movq	-24(%rbp), %rax
 9203 0037 488B55D8 		movq	-40(%rbp), %rdx
 9204 003b 48895028 		movq	%rdx, 40(%rax)
7132:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 9205              		.loc 4 7132 1
 9206 003f 90       		nop
 9207 0040 488B45F8 		movq	-8(%rbp), %rax
 9208 0044 64483304 		xorq	%fs:40, %rax
 9208      25280000 
GAS LISTING /tmp/ccEn8xFO.s 			page 351


 9208      00
 9209 004d 7405     		je	.L516
 9210 004f E8000000 		call	__stack_chk_fail@PLT
 9210      00
 9211              	.L516:
 9212 0054 C9       		leave
 9213              	.LCFI200:
 9214              		.cfi_def_cfa 7, 8
 9215 0055 C3       		ret
 9216              		.cfi_endproc
 9217              	.LFE85:
 9219              		.section	.text.mbedtls_ssl_set_bio,"ax",@progbits
 9220              		.globl	mbedtls_ssl_set_bio
 9222              	mbedtls_ssl_set_bio:
 9223              	.LFB86:
7133:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7134:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_set_bio( mbedtls_ssl_context *ssl,
7135:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         void *p_bio,
7136:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_send_t *f_send,
7137:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_recv_t *f_recv,
7138:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_recv_timeout_t *f_recv_timeout )
7139:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 9224              		.loc 4 7139 1
 9225              		.cfi_startproc
 9226 0000 F30F1EFA 		endbr64
 9227 0004 55       		pushq	%rbp
 9228              	.LCFI201:
 9229              		.cfi_def_cfa_offset 16
 9230              		.cfi_offset 6, -16
 9231 0005 4889E5   		movq	%rsp, %rbp
 9232              	.LCFI202:
 9233              		.cfi_def_cfa_register 6
 9234 0008 4883EC40 		subq	$64, %rsp
 9235 000c 48897DE8 		movq	%rdi, -24(%rbp)
 9236 0010 488975E0 		movq	%rsi, -32(%rbp)
 9237 0014 488955D8 		movq	%rdx, -40(%rbp)
 9238 0018 48894DD0 		movq	%rcx, -48(%rbp)
 9239 001c 4C8945C8 		movq	%r8, -56(%rbp)
 9240              		.loc 4 7139 1
 9241 0020 64488B04 		movq	%fs:40, %rax
 9241      25280000 
 9241      00
 9242 0029 488945F8 		movq	%rax, -8(%rbp)
 9243 002d 31C0     		xorl	%eax, %eax
7140:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->p_bio          = p_bio;
 9244              		.loc 4 7140 25
 9245 002f 488B45E8 		movq	-24(%rbp), %rax
 9246 0033 488B55E0 		movq	-32(%rbp), %rdx
 9247 0037 48895038 		movq	%rdx, 56(%rax)
7141:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->f_send         = f_send;
 9248              		.loc 4 7141 25
 9249 003b 488B45E8 		movq	-24(%rbp), %rax
 9250 003f 488B55D8 		movq	-40(%rbp), %rdx
 9251 0043 48895020 		movq	%rdx, 32(%rax)
7142:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->f_recv         = f_recv;
 9252              		.loc 4 7142 25
 9253 0047 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 352


 9254 004b 488B55D0 		movq	-48(%rbp), %rdx
 9255 004f 48895028 		movq	%rdx, 40(%rax)
7143:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->f_recv_timeout = f_recv_timeout;
 9256              		.loc 4 7143 25
 9257 0053 488B45E8 		movq	-24(%rbp), %rax
 9258 0057 488B55C8 		movq	-56(%rbp), %rdx
 9259 005b 48895030 		movq	%rdx, 48(%rax)
7144:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 9260              		.loc 4 7144 1
 9261 005f 90       		nop
 9262 0060 488B45F8 		movq	-8(%rbp), %rax
 9263 0064 64483304 		xorq	%fs:40, %rax
 9263      25280000 
 9263      00
 9264 006d 7405     		je	.L518
 9265 006f E8000000 		call	__stack_chk_fail@PLT
 9265      00
 9266              	.L518:
 9267 0074 C9       		leave
 9268              	.LCFI203:
 9269              		.cfi_def_cfa 7, 8
 9270 0075 C3       		ret
 9271              		.cfi_endproc
 9272              	.LFE86:
 9274              		.section	.text.mbedtls_ssl_conf_read_timeout,"ax",@progbits
 9275              		.globl	mbedtls_ssl_conf_read_timeout
 9277              	mbedtls_ssl_conf_read_timeout:
 9278              	.LFB87:
7145:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7146:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
7147:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_set_mtu( mbedtls_ssl_context *ssl, uint16_t mtu )
7148:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7149:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->mtu = mtu;
7150:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7151:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
7152:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7153:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_read_timeout( mbedtls_ssl_config *conf, uint32_t timeout )
7154:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 9279              		.loc 4 7154 1
 9280              		.cfi_startproc
 9281 0000 F30F1EFA 		endbr64
 9282 0004 55       		pushq	%rbp
 9283              	.LCFI204:
 9284              		.cfi_def_cfa_offset 16
 9285              		.cfi_offset 6, -16
 9286 0005 4889E5   		movq	%rsp, %rbp
 9287              	.LCFI205:
 9288              		.cfi_def_cfa_register 6
 9289 0008 4883EC20 		subq	$32, %rsp
 9290 000c 48897DE8 		movq	%rdi, -24(%rbp)
 9291 0010 8975E4   		movl	%esi, -28(%rbp)
 9292              		.loc 4 7154 1
 9293 0013 64488B04 		movq	%fs:40, %rax
 9293      25280000 
 9293      00
 9294 001c 488945F8 		movq	%rax, -8(%rbp)
 9295 0020 31C0     		xorl	%eax, %eax
GAS LISTING /tmp/ccEn8xFO.s 			page 353


7155:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->read_timeout   = timeout;
 9296              		.loc 4 7155 26
 9297 0022 488B45E8 		movq	-24(%rbp), %rax
 9298 0026 8B55E4   		movl	-28(%rbp), %edx
 9299 0029 8990A800 		movl	%edx, 168(%rax)
 9299      0000
7156:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 9300              		.loc 4 7156 1
 9301 002f 90       		nop
 9302 0030 488B45F8 		movq	-8(%rbp), %rax
 9303 0034 64483304 		xorq	%fs:40, %rax
 9303      25280000 
 9303      00
 9304 003d 7405     		je	.L520
 9305 003f E8000000 		call	__stack_chk_fail@PLT
 9305      00
 9306              	.L520:
 9307 0044 C9       		leave
 9308              	.LCFI206:
 9309              		.cfi_def_cfa 7, 8
 9310 0045 C3       		ret
 9311              		.cfi_endproc
 9312              	.LFE87:
 9314              		.section	.text.mbedtls_ssl_set_timer_cb,"ax",@progbits
 9315              		.globl	mbedtls_ssl_set_timer_cb
 9317              	mbedtls_ssl_set_timer_cb:
 9318              	.LFB88:
7157:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7158:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_set_timer_cb( mbedtls_ssl_context *ssl,
7159:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                void *p_timer,
7160:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                mbedtls_ssl_set_timer_t *f_set_timer,
7161:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                mbedtls_ssl_get_timer_t *f_get_timer )
7162:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 9319              		.loc 4 7162 1
 9320              		.cfi_startproc
 9321 0000 F30F1EFA 		endbr64
 9322 0004 55       		pushq	%rbp
 9323              	.LCFI207:
 9324              		.cfi_def_cfa_offset 16
 9325              		.cfi_offset 6, -16
 9326 0005 4889E5   		movq	%rsp, %rbp
 9327              	.LCFI208:
 9328              		.cfi_def_cfa_register 6
 9329 0008 4883EC30 		subq	$48, %rsp
 9330 000c 48897DE8 		movq	%rdi, -24(%rbp)
 9331 0010 488975E0 		movq	%rsi, -32(%rbp)
 9332 0014 488955D8 		movq	%rdx, -40(%rbp)
 9333 0018 48894DD0 		movq	%rcx, -48(%rbp)
 9334              		.loc 4 7162 1
 9335 001c 64488B04 		movq	%fs:40, %rax
 9335      25280000 
 9335      00
 9336 0025 488945F8 		movq	%rax, -8(%rbp)
 9337 0029 31C0     		xorl	%eax, %eax
7163:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->p_timer        = p_timer;
 9338              		.loc 4 7163 25
 9339 002b 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 354


 9340 002f 488B55E0 		movq	-32(%rbp), %rdx
 9341 0033 48899088 		movq	%rdx, 136(%rax)
 9341      000000
7164:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->f_set_timer    = f_set_timer;
 9342              		.loc 4 7164 25
 9343 003a 488B45E8 		movq	-24(%rbp), %rax
 9344 003e 488B55D8 		movq	-40(%rbp), %rdx
 9345 0042 48899090 		movq	%rdx, 144(%rax)
 9345      000000
7165:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->f_get_timer    = f_get_timer;
 9346              		.loc 4 7165 25
 9347 0049 488B45E8 		movq	-24(%rbp), %rax
 9348 004d 488B55D0 		movq	-48(%rbp), %rdx
 9349 0051 48899098 		movq	%rdx, 152(%rax)
 9349      000000
7166:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7167:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Make sure we start with no timer running */
7168:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_set_timer( ssl, 0 );
 9350              		.loc 4 7168 5
 9351 0058 488B45E8 		movq	-24(%rbp), %rax
 9352 005c BE000000 		movl	$0, %esi
 9352      00
 9353 0061 4889C7   		movq	%rax, %rdi
 9354 0064 E8000000 		call	ssl_set_timer
 9354      00
7169:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 9355              		.loc 4 7169 1
 9356 0069 90       		nop
 9357 006a 488B45F8 		movq	-8(%rbp), %rax
 9358 006e 64483304 		xorq	%fs:40, %rax
 9358      25280000 
 9358      00
 9359 0077 7405     		je	.L522
 9360 0079 E8000000 		call	__stack_chk_fail@PLT
 9360      00
 9361              	.L522:
 9362 007e C9       		leave
 9363              	.LCFI209:
 9364              		.cfi_def_cfa 7, 8
 9365 007f C3       		ret
 9366              		.cfi_endproc
 9367              	.LFE88:
 9369              		.section	.text.mbedtls_ssl_set_session,"ax",@progbits
 9370              		.globl	mbedtls_ssl_set_session
 9372              	mbedtls_ssl_set_session:
 9373              	.LFB89:
7170:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7171:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
7172:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_session_cache( mbedtls_ssl_config *conf,
7173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         void *p_cache,
7174:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         int (*f_get_cache)(void *, mbedtls_ssl_session *),
7175:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         int (*f_set_cache)(void *, const mbedtls_ssl_session *) )
7176:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7177:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->p_cache = p_cache;
7178:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->f_get_cache = f_get_cache;
7179:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->f_set_cache = f_set_cache;
7180:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
GAS LISTING /tmp/ccEn8xFO.s 			page 355


7181:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_SRV_C */
7182:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7183:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
7184:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_set_session( mbedtls_ssl_context *ssl, const mbedtls_ssl_session *session )
7185:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 9374              		.loc 4 7185 1
 9375              		.cfi_startproc
 9376 0000 F30F1EFA 		endbr64
 9377 0004 55       		pushq	%rbp
 9378              	.LCFI210:
 9379              		.cfi_def_cfa_offset 16
 9380              		.cfi_offset 6, -16
 9381 0005 4889E5   		movq	%rsp, %rbp
 9382              	.LCFI211:
 9383              		.cfi_def_cfa_register 6
 9384 0008 4883EC20 		subq	$32, %rsp
 9385 000c 48897DE8 		movq	%rdi, -24(%rbp)
 9386 0010 488975E0 		movq	%rsi, -32(%rbp)
 9387              		.loc 4 7185 1
 9388 0014 64488B04 		movq	%fs:40, %rax
 9388      25280000 
 9388      00
 9389 001d 488945F8 		movq	%rax, -8(%rbp)
 9390 0021 31C0     		xorl	%eax, %eax
7186:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
7187:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7188:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl == NULL ||
 9391              		.loc 4 7188 7
 9392 0023 48837DE8 		cmpq	$0, -24(%rbp)
 9392      00
 9393 0028 7429     		je	.L524
 9394              		.loc 4 7188 21 discriminator 1
 9395 002a 48837DE0 		cmpq	$0, -32(%rbp)
 9395      00
 9396 002f 7422     		je	.L524
7189:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         session == NULL ||
7190:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->session_negotiate == NULL ||
 9397              		.loc 4 7190 12
 9398 0031 488B45E8 		movq	-24(%rbp), %rax
 9399 0035 488B4058 		movq	88(%rax), %rax
7189:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         session == NULL ||
 9400              		.loc 4 7189 25
 9401 0039 4885C0   		testq	%rax, %rax
 9402 003c 7415     		je	.L524
7191:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->conf->endpoint != MBEDTLS_SSL_IS_CLIENT )
 9403              		.loc 4 7191 12
 9404 003e 488B45E8 		movq	-24(%rbp), %rax
 9405 0042 488B00   		movq	(%rax), %rax
 9406              		.loc 4 7191 29
 9407 0045 0FB680BC 		movzbl	188(%rax), %eax
 9407      000000
 9408 004c 83E001   		andl	$1, %eax
7190:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->conf->endpoint != MBEDTLS_SSL_IS_CLIENT )
 9409              		.loc 4 7190 40
 9410 004f 84C0     		testb	%al, %al
 9411 0051 7407     		je	.L525
 9412              	.L524:
GAS LISTING /tmp/ccEn8xFO.s 			page 356


7192:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7193:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 9413              		.loc 4 7193 15
 9414 0053 B8008FFF 		movl	$-28928, %eax
 9414      FF
 9415 0058 EB3C     		jmp	.L526
 9416              	.L525:
7194:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7195:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7196:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = ssl_session_copy( ssl->session_negotiate, session ) ) != 0 )
 9417              		.loc 4 7196 17
 9418 005a 488B45E8 		movq	-24(%rbp), %rax
 9419 005e 488B4058 		movq	88(%rax), %rax
 9420 0062 488B55E0 		movq	-32(%rbp), %rdx
 9421 0066 4889D6   		movq	%rdx, %rsi
 9422 0069 4889C7   		movq	%rax, %rdi
 9423 006c E8000000 		call	ssl_session_copy
 9423      00
 9424 0071 8945F4   		movl	%eax, -12(%rbp)
 9425              		.loc 4 7196 7
 9426 0074 837DF400 		cmpl	$0, -12(%rbp)
 9427 0078 7405     		je	.L527
7197:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 9428              		.loc 4 7197 15
 9429 007a 8B45F4   		movl	-12(%rbp), %eax
 9430 007d EB17     		jmp	.L526
 9431              	.L527:
7198:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7199:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->handshake->resume = 1;
 9432              		.loc 4 7199 8
 9433 007f 488B45E8 		movq	-24(%rbp), %rax
 9434 0083 488B4060 		movq	96(%rax), %rax
 9435              		.loc 4 7199 28
 9436 0087 C7809C03 		movl	$1, 924(%rax)
 9436      00000100 
 9436      0000
7200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7201:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 9437              		.loc 4 7201 11
 9438 0091 B8000000 		movl	$0, %eax
 9438      00
 9439              	.L526:
7202:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 9440              		.loc 4 7202 1
 9441 0096 488B4DF8 		movq	-8(%rbp), %rcx
 9442 009a 6448330C 		xorq	%fs:40, %rcx
 9442      25280000 
 9442      00
 9443 00a3 7405     		je	.L528
 9444 00a5 E8000000 		call	__stack_chk_fail@PLT
 9444      00
 9445              	.L528:
 9446 00aa C9       		leave
 9447              	.LCFI212:
 9448              		.cfi_def_cfa 7, 8
 9449 00ab C3       		ret
 9450              		.cfi_endproc
GAS LISTING /tmp/ccEn8xFO.s 			page 357


 9451              	.LFE89:
 9453              		.section	.text.mbedtls_ssl_conf_ciphersuites,"ax",@progbits
 9454              		.globl	mbedtls_ssl_conf_ciphersuites
 9456              	mbedtls_ssl_conf_ciphersuites:
 9457              	.LFB90:
7203:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_CLI_C */
7204:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7205:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_ciphersuites( mbedtls_ssl_config *conf,
7206:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    const int *ciphersuites )
7207:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 9458              		.loc 4 7207 1
 9459              		.cfi_startproc
 9460 0000 F30F1EFA 		endbr64
 9461 0004 55       		pushq	%rbp
 9462              	.LCFI213:
 9463              		.cfi_def_cfa_offset 16
 9464              		.cfi_offset 6, -16
 9465 0005 4889E5   		movq	%rsp, %rbp
 9466              	.LCFI214:
 9467              		.cfi_def_cfa_register 6
 9468 0008 4883EC20 		subq	$32, %rsp
 9469 000c 48897DE8 		movq	%rdi, -24(%rbp)
 9470 0010 488975E0 		movq	%rsi, -32(%rbp)
 9471              		.loc 4 7207 1
 9472 0014 64488B04 		movq	%fs:40, %rax
 9472      25280000 
 9472      00
 9473 001d 488945F8 		movq	%rax, -8(%rbp)
 9474 0021 31C0     		xorl	%eax, %eax
7208:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_0] = ciphersuites;
 9475              		.loc 4 7208 57
 9476 0023 488B45E8 		movq	-24(%rbp), %rax
 9477 0027 488B55E0 		movq	-32(%rbp), %rdx
 9478 002b 488910   		movq	%rdx, (%rax)
7209:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_1] = ciphersuites;
 9479              		.loc 4 7209 57
 9480 002e 488B45E8 		movq	-24(%rbp), %rax
 9481 0032 488B55E0 		movq	-32(%rbp), %rdx
 9482 0036 48895008 		movq	%rdx, 8(%rax)
7210:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_2] = ciphersuites;
 9483              		.loc 4 7210 57
 9484 003a 488B45E8 		movq	-24(%rbp), %rax
 9485 003e 488B55E0 		movq	-32(%rbp), %rdx
 9486 0042 48895010 		movq	%rdx, 16(%rax)
7211:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_3] = ciphersuites;
 9487              		.loc 4 7211 57
 9488 0046 488B45E8 		movq	-24(%rbp), %rax
 9489 004a 488B55E0 		movq	-32(%rbp), %rdx
 9490 004e 48895018 		movq	%rdx, 24(%rax)
7212:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 9491              		.loc 4 7212 1
 9492 0052 90       		nop
 9493 0053 488B45F8 		movq	-8(%rbp), %rax
 9494 0057 64483304 		xorq	%fs:40, %rax
 9494      25280000 
 9494      00
 9495 0060 7405     		je	.L530
GAS LISTING /tmp/ccEn8xFO.s 			page 358


 9496 0062 E8000000 		call	__stack_chk_fail@PLT
 9496      00
 9497              	.L530:
 9498 0067 C9       		leave
 9499              	.LCFI215:
 9500              		.cfi_def_cfa 7, 8
 9501 0068 C3       		ret
 9502              		.cfi_endproc
 9503              	.LFE90:
 9505              		.section	.text.mbedtls_ssl_conf_ciphersuites_for_version,"ax",@progbits
 9506              		.globl	mbedtls_ssl_conf_ciphersuites_for_version
 9508              	mbedtls_ssl_conf_ciphersuites_for_version:
 9509              	.LFB91:
7213:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7214:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_ciphersuites_for_version( mbedtls_ssl_config *conf,
7215:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                        const int *ciphersuites,
7216:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                        int major, int minor )
7217:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 9510              		.loc 4 7217 1
 9511              		.cfi_startproc
 9512 0000 F30F1EFA 		endbr64
 9513 0004 55       		pushq	%rbp
 9514              	.LCFI216:
 9515              		.cfi_def_cfa_offset 16
 9516              		.cfi_offset 6, -16
 9517 0005 4889E5   		movq	%rsp, %rbp
 9518              	.LCFI217:
 9519              		.cfi_def_cfa_register 6
 9520 0008 4883EC30 		subq	$48, %rsp
 9521 000c 48897DE8 		movq	%rdi, -24(%rbp)
 9522 0010 488975E0 		movq	%rsi, -32(%rbp)
 9523 0014 8955DC   		movl	%edx, -36(%rbp)
 9524 0017 894DD8   		movl	%ecx, -40(%rbp)
 9525              		.loc 4 7217 1
 9526 001a 64488B04 		movq	%fs:40, %rax
 9526      25280000 
 9526      00
 9527 0023 488945F8 		movq	%rax, -8(%rbp)
 9528 0027 31C0     		xorl	%eax, %eax
7218:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( major != MBEDTLS_SSL_MAJOR_VERSION_3 )
 9529              		.loc 4 7218 7
 9530 0029 837DDC03 		cmpl	$3, -36(%rbp)
 9531 002d 7520     		jne	.L537
7219:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return;
7220:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7221:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( minor < MBEDTLS_SSL_MINOR_VERSION_0 || minor > MBEDTLS_SSL_MINOR_VERSION_3 )
 9532              		.loc 4 7221 7
 9533 002f 837DD800 		cmpl	$0, -40(%rbp)
 9534 0033 781D     		js	.L538
 9535              		.loc 4 7221 45 discriminator 1
 9536 0035 837DD803 		cmpl	$3, -40(%rbp)
 9537 0039 7F17     		jg	.L538
7222:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return;
7223:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7224:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->ciphersuite_list[minor] = ciphersuites;
 9538              		.loc 4 7224 35
 9539 003b 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 359


 9540 003f 8B55D8   		movl	-40(%rbp), %edx
 9541 0042 4863D2   		movslq	%edx, %rdx
 9542 0045 488B4DE0 		movq	-32(%rbp), %rcx
 9543 0049 48890CD0 		movq	%rcx, (%rax,%rdx,8)
 9544 004d EB04     		jmp	.L531
 9545              	.L537:
7219:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return;
 9546              		.loc 4 7219 9
 9547 004f 90       		nop
 9548 0050 EB01     		jmp	.L531
 9549              	.L538:
7222:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return;
 9550              		.loc 4 7222 9
 9551 0052 90       		nop
 9552              	.L531:
7225:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 9553              		.loc 4 7225 1
 9554 0053 488B45F8 		movq	-8(%rbp), %rax
 9555 0057 64483304 		xorq	%fs:40, %rax
 9555      25280000 
 9555      00
 9556 0060 7405     		je	.L536
 9557 0062 E8000000 		call	__stack_chk_fail@PLT
 9557      00
 9558              	.L536:
 9559 0067 C9       		leave
 9560              	.LCFI218:
 9561              		.cfi_def_cfa 7, 8
 9562 0068 C3       		ret
 9563              		.cfi_endproc
 9564              	.LFE91:
 9566              		.section	.text.mbedtls_ssl_conf_cert_profile,"ax",@progbits
 9567              		.globl	mbedtls_ssl_conf_cert_profile
 9569              	mbedtls_ssl_conf_cert_profile:
 9570              	.LFB92:
7226:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7227:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
7228:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_cert_profile( mbedtls_ssl_config *conf,
7229:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     const mbedtls_x509_crt_profile *profile )
7230:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 9571              		.loc 4 7230 1
 9572              		.cfi_startproc
 9573 0000 F30F1EFA 		endbr64
 9574 0004 55       		pushq	%rbp
 9575              	.LCFI219:
 9576              		.cfi_def_cfa_offset 16
 9577              		.cfi_offset 6, -16
 9578 0005 4889E5   		movq	%rsp, %rbp
 9579              	.LCFI220:
 9580              		.cfi_def_cfa_register 6
 9581 0008 4883EC20 		subq	$32, %rsp
 9582 000c 48897DE8 		movq	%rdi, -24(%rbp)
 9583 0010 488975E0 		movq	%rsi, -32(%rbp)
 9584              		.loc 4 7230 1
 9585 0014 64488B04 		movq	%fs:40, %rax
 9585      25280000 
 9585      00
GAS LISTING /tmp/ccEn8xFO.s 			page 360


 9586 001d 488945F8 		movq	%rax, -8(%rbp)
 9587 0021 31C0     		xorl	%eax, %eax
7231:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->cert_profile = profile;
 9588              		.loc 4 7231 24
 9589 0023 488B45E8 		movq	-24(%rbp), %rax
 9590 0027 488B55E0 		movq	-32(%rbp), %rdx
 9591 002b 48895078 		movq	%rdx, 120(%rax)
7232:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 9592              		.loc 4 7232 1
 9593 002f 90       		nop
 9594 0030 488B45F8 		movq	-8(%rbp), %rax
 9595 0034 64483304 		xorq	%fs:40, %rax
 9595      25280000 
 9595      00
 9596 003d 7405     		je	.L540
 9597 003f E8000000 		call	__stack_chk_fail@PLT
 9597      00
 9598              	.L540:
 9599 0044 C9       		leave
 9600              	.LCFI221:
 9601              		.cfi_def_cfa 7, 8
 9602 0045 C3       		ret
 9603              		.cfi_endproc
 9604              	.LFE92:
 9606              		.section	.text.ssl_append_key_cert,"ax",@progbits
 9608              	ssl_append_key_cert:
 9609              	.LFB93:
7233:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7234:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /* Append a new keycert entry to a (possibly empty) list */
7235:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_append_key_cert( mbedtls_ssl_key_cert **head,
7236:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 mbedtls_x509_crt *cert,
7237:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 mbedtls_pk_context *key )
7238:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 9610              		.loc 4 7238 1
 9611              		.cfi_startproc
 9612 0000 F30F1EFA 		endbr64
 9613 0004 55       		pushq	%rbp
 9614              	.LCFI222:
 9615              		.cfi_def_cfa_offset 16
 9616              		.cfi_offset 6, -16
 9617 0005 4889E5   		movq	%rsp, %rbp
 9618              	.LCFI223:
 9619              		.cfi_def_cfa_register 6
 9620 0008 4883EC40 		subq	$64, %rsp
 9621 000c 48897DD8 		movq	%rdi, -40(%rbp)
 9622 0010 488975D0 		movq	%rsi, -48(%rbp)
 9623 0014 488955C8 		movq	%rdx, -56(%rbp)
 9624              		.loc 4 7238 1
 9625 0018 64488B04 		movq	%fs:40, %rax
 9625      25280000 
 9625      00
 9626 0021 488945F8 		movq	%rax, -8(%rbp)
 9627 0025 31C0     		xorl	%eax, %eax
7239:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_key_cert *new_cert;
7240:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7241:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     new_cert = mbedtls_calloc( 1, sizeof( mbedtls_ssl_key_cert ) );
 9628              		.loc 4 7241 16
GAS LISTING /tmp/ccEn8xFO.s 			page 361


 9629 0027 BE180000 		movl	$24, %esi
 9629      00
 9630 002c BF010000 		movl	$1, %edi
 9630      00
 9631 0031 E8000000 		call	mbedtls_calloc@PLT
 9631      00
 9632 0036 488945F0 		movq	%rax, -16(%rbp)
7242:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( new_cert == NULL )
 9633              		.loc 4 7242 7
 9634 003a 48837DF0 		cmpq	$0, -16(%rbp)
 9634      00
 9635 003f 7507     		jne	.L542
7243:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
 9636              		.loc 4 7243 15
 9637 0041 B80081FF 		movl	$-32512, %eax
 9637      FF
 9638 0046 EB73     		jmp	.L543
 9639              	.L542:
7244:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7245:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     new_cert->cert = cert;
 9640              		.loc 4 7245 20
 9641 0048 488B45F0 		movq	-16(%rbp), %rax
 9642 004c 488B55D0 		movq	-48(%rbp), %rdx
 9643 0050 488910   		movq	%rdx, (%rax)
7246:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     new_cert->key  = key;
 9644              		.loc 4 7246 20
 9645 0053 488B45F0 		movq	-16(%rbp), %rax
 9646 0057 488B55C8 		movq	-56(%rbp), %rdx
 9647 005b 48895008 		movq	%rdx, 8(%rax)
7247:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     new_cert->next = NULL;
 9648              		.loc 4 7247 20
 9649 005f 488B45F0 		movq	-16(%rbp), %rax
 9650 0063 48C74010 		movq	$0, 16(%rax)
 9650      00000000 
7248:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7249:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Update head is the list was null, else add to the end */
7250:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( *head == NULL )
 9651              		.loc 4 7250 9
 9652 006b 488B45D8 		movq	-40(%rbp), %rax
 9653 006f 488B00   		movq	(%rax), %rax
 9654              		.loc 4 7250 7
 9655 0072 4885C0   		testq	%rax, %rax
 9656 0075 750D     		jne	.L544
7251:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7252:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         *head = new_cert;
 9657              		.loc 4 7252 15
 9658 0077 488B45D8 		movq	-40(%rbp), %rax
 9659 007b 488B55F0 		movq	-16(%rbp), %rdx
 9660 007f 488910   		movq	%rdx, (%rax)
 9661 0082 EB32     		jmp	.L545
 9662              	.L544:
 9663              	.LBB23:
7253:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7254:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
7255:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7256:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_key_cert *cur = *head;
 9664              		.loc 4 7256 31
GAS LISTING /tmp/ccEn8xFO.s 			page 362


 9665 0084 488B45D8 		movq	-40(%rbp), %rax
 9666 0088 488B00   		movq	(%rax), %rax
 9667 008b 488945E8 		movq	%rax, -24(%rbp)
7257:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         while( cur->next != NULL )
 9668              		.loc 4 7257 14
 9669 008f EB0C     		jmp	.L546
 9670              	.L547:
7258:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             cur = cur->next;
 9671              		.loc 4 7258 17
 9672 0091 488B45E8 		movq	-24(%rbp), %rax
 9673 0095 488B4010 		movq	16(%rax), %rax
 9674 0099 488945E8 		movq	%rax, -24(%rbp)
 9675              	.L546:
7257:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         while( cur->next != NULL )
 9676              		.loc 4 7257 19
 9677 009d 488B45E8 		movq	-24(%rbp), %rax
 9678 00a1 488B4010 		movq	16(%rax), %rax
7257:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         while( cur->next != NULL )
 9679              		.loc 4 7257 14
 9680 00a5 4885C0   		testq	%rax, %rax
 9681 00a8 75E7     		jne	.L547
7259:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         cur->next = new_cert;
 9682              		.loc 4 7259 19
 9683 00aa 488B45E8 		movq	-24(%rbp), %rax
 9684 00ae 488B55F0 		movq	-16(%rbp), %rdx
 9685 00b2 48895010 		movq	%rdx, 16(%rax)
 9686              	.L545:
 9687              	.LBE23:
7260:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7261:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7262:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 9688              		.loc 4 7262 11
 9689 00b6 B8000000 		movl	$0, %eax
 9689      00
 9690              	.L543:
7263:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 9691              		.loc 4 7263 1
 9692 00bb 488B4DF8 		movq	-8(%rbp), %rcx
 9693 00bf 6448330C 		xorq	%fs:40, %rcx
 9693      25280000 
 9693      00
 9694 00c8 7405     		je	.L548
 9695 00ca E8000000 		call	__stack_chk_fail@PLT
 9695      00
 9696              	.L548:
 9697 00cf C9       		leave
 9698              	.LCFI224:
 9699              		.cfi_def_cfa 7, 8
 9700 00d0 C3       		ret
 9701              		.cfi_endproc
 9702              	.LFE93:
 9704              		.section	.text.mbedtls_ssl_conf_own_cert,"ax",@progbits
 9705              		.globl	mbedtls_ssl_conf_own_cert
 9707              	mbedtls_ssl_conf_own_cert:
 9708              	.LFB94:
7264:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7265:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_conf_own_cert( mbedtls_ssl_config *conf,
GAS LISTING /tmp/ccEn8xFO.s 			page 363


7266:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                               mbedtls_x509_crt *own_cert,
7267:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                               mbedtls_pk_context *pk_key )
7268:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 9709              		.loc 4 7268 1
 9710              		.cfi_startproc
 9711 0000 F30F1EFA 		endbr64
 9712 0004 55       		pushq	%rbp
 9713              	.LCFI225:
 9714              		.cfi_def_cfa_offset 16
 9715              		.cfi_offset 6, -16
 9716 0005 4889E5   		movq	%rsp, %rbp
 9717              	.LCFI226:
 9718              		.cfi_def_cfa_register 6
 9719 0008 4883EC30 		subq	$48, %rsp
 9720 000c 48897DE8 		movq	%rdi, -24(%rbp)
 9721 0010 488975E0 		movq	%rsi, -32(%rbp)
 9722 0014 488955D8 		movq	%rdx, -40(%rbp)
 9723              		.loc 4 7268 1
 9724 0018 64488B04 		movq	%fs:40, %rax
 9724      25280000 
 9724      00
 9725 0021 488945F8 		movq	%rax, -8(%rbp)
 9726 0025 31C0     		xorl	%eax, %eax
7269:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ssl_append_key_cert( &conf->key_cert, own_cert, pk_key ) );
 9727              		.loc 4 7269 13
 9728 0027 488B45E8 		movq	-24(%rbp), %rax
 9729 002b 488D8880 		leaq	128(%rax), %rcx
 9729      000000
 9730 0032 488B55D8 		movq	-40(%rbp), %rdx
 9731 0036 488B45E0 		movq	-32(%rbp), %rax
 9732 003a 4889C6   		movq	%rax, %rsi
 9733 003d 4889CF   		movq	%rcx, %rdi
 9734 0040 E8000000 		call	ssl_append_key_cert
 9734      00
7270:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 9735              		.loc 4 7270 1
 9736 0045 488B4DF8 		movq	-8(%rbp), %rcx
 9737 0049 6448330C 		xorq	%fs:40, %rcx
 9737      25280000 
 9737      00
 9738 0052 7405     		je	.L551
 9739 0054 E8000000 		call	__stack_chk_fail@PLT
 9739      00
 9740              	.L551:
 9741 0059 C9       		leave
 9742              	.LCFI227:
 9743              		.cfi_def_cfa 7, 8
 9744 005a C3       		ret
 9745              		.cfi_endproc
 9746              	.LFE94:
 9748              		.section	.text.mbedtls_ssl_conf_ca_chain,"ax",@progbits
 9749              		.globl	mbedtls_ssl_conf_ca_chain
 9751              	mbedtls_ssl_conf_ca_chain:
 9752              	.LFB95:
7271:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7272:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_ca_chain( mbedtls_ssl_config *conf,
7273:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                mbedtls_x509_crt *ca_chain,
GAS LISTING /tmp/ccEn8xFO.s 			page 364


7274:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                mbedtls_x509_crl *ca_crl )
7275:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 9753              		.loc 4 7275 1
 9754              		.cfi_startproc
 9755 0000 F30F1EFA 		endbr64
 9756 0004 55       		pushq	%rbp
 9757              	.LCFI228:
 9758              		.cfi_def_cfa_offset 16
 9759              		.cfi_offset 6, -16
 9760 0005 4889E5   		movq	%rsp, %rbp
 9761              	.LCFI229:
 9762              		.cfi_def_cfa_register 6
 9763 0008 4883EC30 		subq	$48, %rsp
 9764 000c 48897DE8 		movq	%rdi, -24(%rbp)
 9765 0010 488975E0 		movq	%rsi, -32(%rbp)
 9766 0014 488955D8 		movq	%rdx, -40(%rbp)
 9767              		.loc 4 7275 1
 9768 0018 64488B04 		movq	%fs:40, %rax
 9768      25280000 
 9768      00
 9769 0021 488945F8 		movq	%rax, -8(%rbp)
 9770 0025 31C0     		xorl	%eax, %eax
7276:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->ca_chain   = ca_chain;
 9771              		.loc 4 7276 22
 9772 0027 488B45E8 		movq	-24(%rbp), %rax
 9773 002b 488B55E0 		movq	-32(%rbp), %rdx
 9774 002f 48899088 		movq	%rdx, 136(%rax)
 9774      000000
7277:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->ca_crl     = ca_crl;
 9775              		.loc 4 7277 22
 9776 0036 488B45E8 		movq	-24(%rbp), %rax
 9777 003a 488B55D8 		movq	-40(%rbp), %rdx
 9778 003e 48899090 		movq	%rdx, 144(%rax)
 9778      000000
7278:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 9779              		.loc 4 7278 1
 9780 0045 90       		nop
 9781 0046 488B45F8 		movq	-8(%rbp), %rax
 9782 004a 64483304 		xorq	%fs:40, %rax
 9782      25280000 
 9782      00
 9783 0053 7405     		je	.L553
 9784 0055 E8000000 		call	__stack_chk_fail@PLT
 9784      00
 9785              	.L553:
 9786 005a C9       		leave
 9787              	.LCFI230:
 9788              		.cfi_def_cfa 7, 8
 9789 005b C3       		ret
 9790              		.cfi_endproc
 9791              	.LFE95:
 9793              		.section	.text.mbedtls_ssl_conf_sig_hashes,"ax",@progbits
 9794              		.globl	mbedtls_ssl_conf_sig_hashes
 9796              	mbedtls_ssl_conf_sig_hashes:
 9797              	.LFB96:
7279:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
7280:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 365


7281:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SERVER_NAME_INDICATION)
7282:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_set_hs_own_cert( mbedtls_ssl_context *ssl,
7283:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  mbedtls_x509_crt *own_cert,
7284:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  mbedtls_pk_context *pk_key )
7285:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7286:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ssl_append_key_cert( &ssl->handshake->sni_key_cert,
7287:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  own_cert, pk_key ) );
7288:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7289:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7290:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_set_hs_ca_chain( mbedtls_ssl_context *ssl,
7291:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   mbedtls_x509_crt *ca_chain,
7292:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   mbedtls_x509_crl *ca_crl )
7293:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7294:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->handshake->sni_ca_chain   = ca_chain;
7295:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->handshake->sni_ca_crl     = ca_crl;
7296:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7297:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7298:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_set_hs_authmode( mbedtls_ssl_context *ssl,
7299:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   int authmode )
7300:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7301:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->handshake->sni_authmode = authmode;
7302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7303:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_SERVER_NAME_INDICATION */
7304:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7305:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
7306:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
7307:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Set EC J-PAKE password for current handshake
7308:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
7309:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_set_hs_ecjpake_password( mbedtls_ssl_context *ssl,
7310:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                          const unsigned char *pw,
7311:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                          size_t pw_len )
7312:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7313:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ecjpake_role role;
7314:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7315:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->handshake == NULL || ssl->conf == NULL )
7316:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
7317:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7318:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER )
7319:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         role = MBEDTLS_ECJPAKE_SERVER;
7320:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
7321:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         role = MBEDTLS_ECJPAKE_CLIENT;
7322:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7323:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( mbedtls_ecjpake_setup( &ssl->handshake->ecjpake_ctx,
7324:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    role,
7325:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    MBEDTLS_MD_SHA256,
7326:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    MBEDTLS_ECP_DP_SECP256R1,
7327:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    pw, pw_len ) );
7328:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7329:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED */
7330:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7331:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED)
7332:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_conf_psk( mbedtls_ssl_config *conf,
7333:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 const unsigned char *psk, size_t psk_len,
7334:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 const unsigned char *psk_identity, size_t psk_identity_len )
7335:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7336:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( psk == NULL || psk_identity == NULL )
7337:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
GAS LISTING /tmp/ccEn8xFO.s 			page 366


7338:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7339:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( psk_len > MBEDTLS_PSK_MAX_LEN )
7340:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
7341:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7342:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Identity len will be encoded on two bytes */
7343:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( psk_identity_len >> 16 ) != 0 ||
7344:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         psk_identity_len > MBEDTLS_SSL_OUT_CONTENT_LEN )
7345:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7346:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
7347:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7348:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7349:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( conf->psk != NULL )
7350:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7351:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_platform_zeroize( conf->psk, conf->psk_len );
7352:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7353:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( conf->psk );
7354:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         conf->psk = NULL;
7355:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         conf->psk_len = 0;
7356:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7357:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( conf->psk_identity != NULL )
7358:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7359:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( conf->psk_identity );
7360:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         conf->psk_identity = NULL;
7361:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         conf->psk_identity_len = 0;
7362:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7363:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7364:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( conf->psk = mbedtls_calloc( 1, psk_len ) ) == NULL ||
7365:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ( conf->psk_identity = mbedtls_calloc( 1, psk_identity_len ) ) == NULL )
7366:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7367:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( conf->psk );
7368:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( conf->psk_identity );
7369:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         conf->psk = NULL;
7370:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         conf->psk_identity = NULL;
7371:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
7372:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7373:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7374:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->psk_len = psk_len;
7375:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->psk_identity_len = psk_identity_len;
7376:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7377:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( conf->psk, psk, conf->psk_len );
7378:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( conf->psk_identity, psk_identity, conf->psk_identity_len );
7379:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7380:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
7381:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7382:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7383:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_set_hs_psk( mbedtls_ssl_context *ssl,
7384:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             const unsigned char *psk, size_t psk_len )
7385:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7386:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( psk == NULL || ssl->handshake == NULL )
7387:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
7388:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7389:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( psk_len > MBEDTLS_PSK_MAX_LEN )
7390:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
7391:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7392:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->handshake->psk != NULL )
7393:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7394:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_platform_zeroize( ssl->handshake->psk,
GAS LISTING /tmp/ccEn8xFO.s 			page 367


7395:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   ssl->handshake->psk_len );
7396:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( ssl->handshake->psk );
7397:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake->psk_len = 0;
7398:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7399:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7400:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ssl->handshake->psk = mbedtls_calloc( 1, psk_len ) ) == NULL )
7401:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
7402:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7403:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->handshake->psk_len = psk_len;
7404:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( ssl->handshake->psk, psk, ssl->handshake->psk_len );
7405:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7406:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
7407:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7408:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7409:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_psk_cb( mbedtls_ssl_config *conf,
7410:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      int (*f_psk)(void *, mbedtls_ssl_context *, const unsigned char *,
7411:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      size_t),
7412:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                      void *p_psk )
7413:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7414:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->f_psk = f_psk;
7415:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->p_psk = p_psk;
7416:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7417:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED */
7418:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7419:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_DHM_C) && defined(MBEDTLS_SSL_SRV_C)
7420:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7421:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if !defined(MBEDTLS_DEPRECATED_REMOVED)
7422:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_conf_dh_param( mbedtls_ssl_config *conf, const char *dhm_P, const char *dhm_G )
7423:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7424:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
7425:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7426:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_mpi_read_string( &conf->dhm_P, 16, dhm_P ) ) != 0 ||
7427:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ( ret = mbedtls_mpi_read_string( &conf->dhm_G, 16, dhm_G ) ) != 0 )
7428:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7429:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_mpi_free( &conf->dhm_P );
7430:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_mpi_free( &conf->dhm_G );
7431:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
7432:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7433:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7434:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
7435:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7436:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_DEPRECATED_REMOVED */
7437:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7438:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_conf_dh_param_bin( mbedtls_ssl_config *conf,
7439:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    const unsigned char *dhm_P, size_t P_len,
7440:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    const unsigned char *dhm_G, size_t G_len )
7441:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7442:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
7443:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7444:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_mpi_read_binary( &conf->dhm_P, dhm_P, P_len ) ) != 0 ||
7445:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ( ret = mbedtls_mpi_read_binary( &conf->dhm_G, dhm_G, G_len ) ) != 0 )
7446:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7447:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_mpi_free( &conf->dhm_P );
7448:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_mpi_free( &conf->dhm_G );
7449:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
7450:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7451:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 368


7452:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
7453:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7454:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7455:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_conf_dh_param_ctx( mbedtls_ssl_config *conf, mbedtls_dhm_context *dhm_ctx )
7456:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7457:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
7458:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7459:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_mpi_copy( &conf->dhm_P, &dhm_ctx->P ) ) != 0 ||
7460:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ( ret = mbedtls_mpi_copy( &conf->dhm_G, &dhm_ctx->G ) ) != 0 )
7461:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7462:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_mpi_free( &conf->dhm_P );
7463:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_mpi_free( &conf->dhm_G );
7464:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
7465:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7466:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7467:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
7468:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7469:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_DHM_C && MBEDTLS_SSL_SRV_C */
7470:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7471:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_DHM_C) && defined(MBEDTLS_SSL_CLI_C)
7472:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
7473:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Set the minimum length for Diffie-Hellman parameters
7474:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
7475:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_dhm_min_bitlen( mbedtls_ssl_config *conf,
7476:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                       unsigned int bitlen )
7477:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7478:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->dhm_min_bitlen = bitlen;
7479:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7480:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_DHM_C && MBEDTLS_SSL_CLI_C */
7481:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7482:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
7483:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
7484:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Set allowed/preferred hashes for handshake signatures
7485:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
7486:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_sig_hashes( mbedtls_ssl_config *conf,
7487:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                   const int *hashes )
7488:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 9798              		.loc 4 7488 1
 9799              		.cfi_startproc
 9800 0000 F30F1EFA 		endbr64
 9801 0004 55       		pushq	%rbp
 9802              	.LCFI231:
 9803              		.cfi_def_cfa_offset 16
 9804              		.cfi_offset 6, -16
 9805 0005 4889E5   		movq	%rsp, %rbp
 9806              	.LCFI232:
 9807              		.cfi_def_cfa_register 6
 9808 0008 4883EC20 		subq	$32, %rsp
 9809 000c 48897DE8 		movq	%rdi, -24(%rbp)
 9810 0010 488975E0 		movq	%rsi, -32(%rbp)
 9811              		.loc 4 7488 1
 9812 0014 64488B04 		movq	%fs:40, %rax
 9812      25280000 
 9812      00
 9813 001d 488945F8 		movq	%rax, -8(%rbp)
 9814 0021 31C0     		xorl	%eax, %eax
7489:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->sig_hashes = hashes;
GAS LISTING /tmp/ccEn8xFO.s 			page 369


 9815              		.loc 4 7489 22
 9816 0023 488B45E8 		movq	-24(%rbp), %rax
 9817 0027 488B55E0 		movq	-32(%rbp), %rdx
 9818 002b 48899098 		movq	%rdx, 152(%rax)
 9818      000000
7490:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 9819              		.loc 4 7490 1
 9820 0032 90       		nop
 9821 0033 488B45F8 		movq	-8(%rbp), %rax
 9822 0037 64483304 		xorq	%fs:40, %rax
 9822      25280000 
 9822      00
 9823 0040 7405     		je	.L555
 9824 0042 E8000000 		call	__stack_chk_fail@PLT
 9824      00
 9825              	.L555:
 9826 0047 C9       		leave
 9827              	.LCFI233:
 9828              		.cfi_def_cfa 7, 8
 9829 0048 C3       		ret
 9830              		.cfi_endproc
 9831              	.LFE96:
 9833              		.section	.text.mbedtls_ssl_conf_curves,"ax",@progbits
 9834              		.globl	mbedtls_ssl_conf_curves
 9836              	mbedtls_ssl_conf_curves:
 9837              	.LFB97:
7491:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED */
7492:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7493:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_ECP_C)
7494:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
7495:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Set the allowed elliptic curves
7496:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
7497:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_curves( mbedtls_ssl_config *conf,
7498:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                              const mbedtls_ecp_group_id *curve_list )
7499:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 9838              		.loc 4 7499 1
 9839              		.cfi_startproc
 9840 0000 F30F1EFA 		endbr64
 9841 0004 55       		pushq	%rbp
 9842              	.LCFI234:
 9843              		.cfi_def_cfa_offset 16
 9844              		.cfi_offset 6, -16
 9845 0005 4889E5   		movq	%rsp, %rbp
 9846              	.LCFI235:
 9847              		.cfi_def_cfa_register 6
 9848 0008 4883EC20 		subq	$32, %rsp
 9849 000c 48897DE8 		movq	%rdi, -24(%rbp)
 9850 0010 488975E0 		movq	%rsi, -32(%rbp)
 9851              		.loc 4 7499 1
 9852 0014 64488B04 		movq	%fs:40, %rax
 9852      25280000 
 9852      00
 9853 001d 488945F8 		movq	%rax, -8(%rbp)
 9854 0021 31C0     		xorl	%eax, %eax
7500:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->curve_list = curve_list;
 9855              		.loc 4 7500 22
 9856 0023 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 370


 9857 0027 488B55E0 		movq	-32(%rbp), %rdx
 9858 002b 488990A0 		movq	%rdx, 160(%rax)
 9858      000000
7501:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 9859              		.loc 4 7501 1
 9860 0032 90       		nop
 9861 0033 488B45F8 		movq	-8(%rbp), %rax
 9862 0037 64483304 		xorq	%fs:40, %rax
 9862      25280000 
 9862      00
 9863 0040 7405     		je	.L557
 9864 0042 E8000000 		call	__stack_chk_fail@PLT
 9864      00
 9865              	.L557:
 9866 0047 C9       		leave
 9867              	.LCFI236:
 9868              		.cfi_def_cfa 7, 8
 9869 0048 C3       		ret
 9870              		.cfi_endproc
 9871              	.LFE97:
 9873              		.section	.text.mbedtls_ssl_set_hostname,"ax",@progbits
 9874              		.globl	mbedtls_ssl_set_hostname
 9876              	mbedtls_ssl_set_hostname:
 9877              	.LFB98:
7502:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_ECP_C */
7503:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7504:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
7505:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_set_hostname( mbedtls_ssl_context *ssl, const char *hostname )
7506:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 9878              		.loc 4 7506 1
 9879              		.cfi_startproc
 9880 0000 F30F1EFA 		endbr64
 9881 0004 55       		pushq	%rbp
 9882              	.LCFI237:
 9883              		.cfi_def_cfa_offset 16
 9884              		.cfi_offset 6, -16
 9885 0005 4889E5   		movq	%rsp, %rbp
 9886              	.LCFI238:
 9887              		.cfi_def_cfa_register 6
 9888 0008 4883EC20 		subq	$32, %rsp
 9889 000c 48897DE8 		movq	%rdi, -24(%rbp)
 9890 0010 488975E0 		movq	%rsi, -32(%rbp)
 9891              		.loc 4 7506 1
 9892 0014 64488B04 		movq	%fs:40, %rax
 9892      25280000 
 9892      00
 9893 001d 488945F8 		movq	%rax, -8(%rbp)
 9894 0021 31C0     		xorl	%eax, %eax
7507:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Initialize to suppress unnecessary compiler warning */
7508:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t hostname_len = 0;
 9895              		.loc 4 7508 12
 9896 0023 48C745F0 		movq	$0, -16(%rbp)
 9896      00000000 
7509:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7510:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Check if new hostname is valid before
7511:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * making any change to current one */
7512:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( hostname != NULL )
GAS LISTING /tmp/ccEn8xFO.s 			page 371


 9897              		.loc 4 7512 7
 9898 002b 48837DE0 		cmpq	$0, -32(%rbp)
 9898      00
 9899 0030 7424     		je	.L559
7513:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7514:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         hostname_len = strlen( hostname );
 9900              		.loc 4 7514 24
 9901 0032 488B45E0 		movq	-32(%rbp), %rax
 9902 0036 4889C7   		movq	%rax, %rdi
 9903 0039 E8000000 		call	strlen@PLT
 9903      00
 9904 003e 488945F0 		movq	%rax, -16(%rbp)
7515:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7516:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( hostname_len > MBEDTLS_SSL_MAX_HOST_NAME_LEN )
 9905              		.loc 4 7516 11
 9906 0042 48817DF0 		cmpq	$255, -16(%rbp)
 9906      FF000000 
 9907 004a 760A     		jbe	.L559
7517:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 9908              		.loc 4 7517 19
 9909 004c B8008FFF 		movl	$-28928, %eax
 9909      FF
 9910 0051 E9D60000 		jmp	.L560
 9910      00
 9911              	.L559:
7518:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7519:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7520:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Now it's clear that we will overwrite the old hostname,
7521:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * so we can free it safely */
7522:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7523:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->hostname != NULL )
 9912              		.loc 4 7523 12
 9913 0056 488B45E8 		movq	-24(%rbp), %rax
 9914 005a 488B8058 		movq	344(%rax), %rax
 9914      010000
 9915              		.loc 4 7523 7
 9916 0061 4885C0   		testq	%rax, %rax
 9917 0064 743F     		je	.L561
7524:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7525:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_platform_zeroize( ssl->hostname, strlen( ssl->hostname ) );
 9918              		.loc 4 7525 61
 9919 0066 488B45E8 		movq	-24(%rbp), %rax
 9920 006a 488B8058 		movq	344(%rax), %rax
 9920      010000
 9921              		.loc 4 7525 9
 9922 0071 4889C7   		movq	%rax, %rdi
 9923 0074 E8000000 		call	strlen@PLT
 9923      00
 9924 0079 4889C2   		movq	%rax, %rdx
 9925              		.loc 4 7525 38
 9926 007c 488B45E8 		movq	-24(%rbp), %rax
 9927 0080 488B8058 		movq	344(%rax), %rax
 9927      010000
 9928              		.loc 4 7525 9
 9929 0087 4889D6   		movq	%rdx, %rsi
 9930 008a 4889C7   		movq	%rax, %rdi
 9931 008d E8000000 		call	mbedtls_platform_zeroize@PLT
GAS LISTING /tmp/ccEn8xFO.s 			page 372


 9931      00
7526:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( ssl->hostname );
 9932              		.loc 4 7526 26
 9933 0092 488B45E8 		movq	-24(%rbp), %rax
 9934 0096 488B8058 		movq	344(%rax), %rax
 9934      010000
 9935              		.loc 4 7526 9
 9936 009d 4889C7   		movq	%rax, %rdi
 9937 00a0 E8000000 		call	mbedtls_free@PLT
 9937      00
 9938              	.L561:
7527:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7528:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7529:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Passing NULL as hostname shall clear the old one */
7530:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7531:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( hostname == NULL )
 9939              		.loc 4 7531 7
 9940 00a5 48837DE0 		cmpq	$0, -32(%rbp)
 9940      00
 9941 00aa 7511     		jne	.L562
7532:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7533:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->hostname = NULL;
 9942              		.loc 4 7533 23
 9943 00ac 488B45E8 		movq	-24(%rbp), %rax
 9944 00b0 48C78058 		movq	$0, 344(%rax)
 9944      01000000 
 9944      000000
 9945 00bb EB6A     		jmp	.L563
 9946              	.L562:
7534:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7535:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
7536:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7537:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->hostname = mbedtls_calloc( 1, hostname_len + 1 );
 9947              		.loc 4 7537 25
 9948 00bd 488B45F0 		movq	-16(%rbp), %rax
 9949 00c1 4883C001 		addq	$1, %rax
 9950 00c5 4889C6   		movq	%rax, %rsi
 9951 00c8 BF010000 		movl	$1, %edi
 9951      00
 9952 00cd E8000000 		call	mbedtls_calloc@PLT
 9952      00
 9953              		.loc 4 7537 23
 9954 00d2 488B55E8 		movq	-24(%rbp), %rdx
 9955 00d6 48898258 		movq	%rax, 344(%rdx)
 9955      010000
7538:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->hostname == NULL )
 9956              		.loc 4 7538 16
 9957 00dd 488B45E8 		movq	-24(%rbp), %rax
 9958 00e1 488B8058 		movq	344(%rax), %rax
 9958      010000
 9959              		.loc 4 7538 11
 9960 00e8 4885C0   		testq	%rax, %rax
 9961 00eb 7507     		jne	.L564
7539:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
 9962              		.loc 4 7539 19
 9963 00ed B80081FF 		movl	$-32512, %eax
 9963      FF
GAS LISTING /tmp/ccEn8xFO.s 			page 373


 9964 00f2 EB38     		jmp	.L560
 9965              	.L564:
7540:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7541:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memcpy( ssl->hostname, hostname, hostname_len );
 9966              		.loc 4 7541 20
 9967 00f4 488B45E8 		movq	-24(%rbp), %rax
 9968 00f8 488B8058 		movq	344(%rax), %rax
 9968      010000
 9969              		.loc 4 7541 9
 9970 00ff 488B55F0 		movq	-16(%rbp), %rdx
 9971 0103 488B4DE0 		movq	-32(%rbp), %rcx
 9972 0107 4889CE   		movq	%rcx, %rsi
 9973 010a 4889C7   		movq	%rax, %rdi
 9974 010d E8000000 		call	memcpy@PLT
 9974      00
7542:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7543:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->hostname[hostname_len] = '\0';
 9975              		.loc 4 7543 12
 9976 0112 488B45E8 		movq	-24(%rbp), %rax
 9977 0116 488B9058 		movq	344(%rax), %rdx
 9977      010000
 9978              		.loc 4 7543 22
 9979 011d 488B45F0 		movq	-16(%rbp), %rax
 9980 0121 4801D0   		addq	%rdx, %rax
 9981              		.loc 4 7543 37
 9982 0124 C60000   		movb	$0, (%rax)
 9983              	.L563:
7544:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7545:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7546:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 9984              		.loc 4 7546 11
 9985 0127 B8000000 		movl	$0, %eax
 9985      00
 9986              	.L560:
7547:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 9987              		.loc 4 7547 1
 9988 012c 488B4DF8 		movq	-8(%rbp), %rcx
 9989 0130 6448330C 		xorq	%fs:40, %rcx
 9989      25280000 
 9989      00
 9990 0139 7405     		je	.L565
 9991 013b E8000000 		call	__stack_chk_fail@PLT
 9991      00
 9992              	.L565:
 9993 0140 C9       		leave
 9994              	.LCFI239:
 9995              		.cfi_def_cfa 7, 8
 9996 0141 C3       		ret
 9997              		.cfi_endproc
 9998              	.LFE98:
 10000              		.section	.text.mbedtls_ssl_conf_max_version,"ax",@progbits
 10001              		.globl	mbedtls_ssl_conf_max_version
 10003              	mbedtls_ssl_conf_max_version:
 10004              	.LFB99:
7548:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
7549:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7550:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SERVER_NAME_INDICATION)
GAS LISTING /tmp/ccEn8xFO.s 			page 374


7551:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_sni( mbedtls_ssl_config *conf,
7552:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                   int (*f_sni)(void *, mbedtls_ssl_context *,
7553:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 const unsigned char *, size_t),
7554:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                   void *p_sni )
7555:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7556:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->f_sni = f_sni;
7557:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->p_sni = p_sni;
7558:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7559:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_SERVER_NAME_INDICATION */
7560:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7561:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_ALPN)
7562:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_conf_alpn_protocols( mbedtls_ssl_config *conf, const char **protos )
7563:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7564:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t cur_len, tot_len;
7565:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const char **p;
7566:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7567:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
7568:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * RFC 7301 3.1: "Empty strings MUST NOT be included and byte strings
7569:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * MUST NOT be truncated."
7570:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * We check lengths now rather than later.
7571:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
7572:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     tot_len = 0;
7573:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     for( p = protos; *p != NULL; p++ )
7574:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7575:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         cur_len = strlen( *p );
7576:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         tot_len += cur_len;
7577:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7578:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( cur_len == 0 || cur_len > 255 || tot_len > 65535 )
7579:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
7580:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7581:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7582:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->alpn_list = protos;
7583:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7584:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
7585:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7586:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7587:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** const char *mbedtls_ssl_get_alpn_protocol( const mbedtls_ssl_context *ssl )
7588:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7589:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ssl->alpn_chosen );
7590:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7591:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_ALPN */
7592:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7593:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_max_version( mbedtls_ssl_config *conf, int major, int minor )
7594:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 10005              		.loc 4 7594 1
 10006              		.cfi_startproc
 10007 0000 F30F1EFA 		endbr64
 10008 0004 55       		pushq	%rbp
 10009              	.LCFI240:
 10010              		.cfi_def_cfa_offset 16
 10011              		.cfi_offset 6, -16
 10012 0005 4889E5   		movq	%rsp, %rbp
 10013              	.LCFI241:
 10014              		.cfi_def_cfa_register 6
 10015 0008 4883EC20 		subq	$32, %rsp
 10016 000c 48897DE8 		movq	%rdi, -24(%rbp)
 10017 0010 8975E4   		movl	%esi, -28(%rbp)
GAS LISTING /tmp/ccEn8xFO.s 			page 375


 10018 0013 8955E0   		movl	%edx, -32(%rbp)
 10019              		.loc 4 7594 1
 10020 0016 64488B04 		movq	%fs:40, %rax
 10020      25280000 
 10020      00
 10021 001f 488945F8 		movq	%rax, -8(%rbp)
 10022 0023 31C0     		xorl	%eax, %eax
7595:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->max_major_ver = major;
 10023              		.loc 4 7595 25
 10024 0025 8B45E4   		movl	-28(%rbp), %eax
 10025 0028 89C2     		movl	%eax, %edx
 10026 002a 488B45E8 		movq	-24(%rbp), %rax
 10027 002e 8890B800 		movb	%dl, 184(%rax)
 10027      0000
7596:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->max_minor_ver = minor;
 10028              		.loc 4 7596 25
 10029 0034 8B45E0   		movl	-32(%rbp), %eax
 10030 0037 89C2     		movl	%eax, %edx
 10031 0039 488B45E8 		movq	-24(%rbp), %rax
 10032 003d 8890B900 		movb	%dl, 185(%rax)
 10032      0000
7597:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 10033              		.loc 4 7597 1
 10034 0043 90       		nop
 10035 0044 488B45F8 		movq	-8(%rbp), %rax
 10036 0048 64483304 		xorq	%fs:40, %rax
 10036      25280000 
 10036      00
 10037 0051 7405     		je	.L567
 10038 0053 E8000000 		call	__stack_chk_fail@PLT
 10038      00
 10039              	.L567:
 10040 0058 C9       		leave
 10041              	.LCFI242:
 10042              		.cfi_def_cfa 7, 8
 10043 0059 C3       		ret
 10044              		.cfi_endproc
 10045              	.LFE99:
 10047              		.section	.text.mbedtls_ssl_conf_min_version,"ax",@progbits
 10048              		.globl	mbedtls_ssl_conf_min_version
 10050              	mbedtls_ssl_conf_min_version:
 10051              	.LFB100:
7598:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7599:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_min_version( mbedtls_ssl_config *conf, int major, int minor )
7600:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 10052              		.loc 4 7600 1
 10053              		.cfi_startproc
 10054 0000 F30F1EFA 		endbr64
 10055 0004 55       		pushq	%rbp
 10056              	.LCFI243:
 10057              		.cfi_def_cfa_offset 16
 10058              		.cfi_offset 6, -16
 10059 0005 4889E5   		movq	%rsp, %rbp
 10060              	.LCFI244:
 10061              		.cfi_def_cfa_register 6
 10062 0008 4883EC20 		subq	$32, %rsp
 10063 000c 48897DE8 		movq	%rdi, -24(%rbp)
GAS LISTING /tmp/ccEn8xFO.s 			page 376


 10064 0010 8975E4   		movl	%esi, -28(%rbp)
 10065 0013 8955E0   		movl	%edx, -32(%rbp)
 10066              		.loc 4 7600 1
 10067 0016 64488B04 		movq	%fs:40, %rax
 10067      25280000 
 10067      00
 10068 001f 488945F8 		movq	%rax, -8(%rbp)
 10069 0023 31C0     		xorl	%eax, %eax
7601:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->min_major_ver = major;
 10070              		.loc 4 7601 25
 10071 0025 8B45E4   		movl	-28(%rbp), %eax
 10072 0028 89C2     		movl	%eax, %edx
 10073 002a 488B45E8 		movq	-24(%rbp), %rax
 10074 002e 8890BA00 		movb	%dl, 186(%rax)
 10074      0000
7602:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->min_minor_ver = minor;
 10075              		.loc 4 7602 25
 10076 0034 8B45E0   		movl	-32(%rbp), %eax
 10077 0037 89C2     		movl	%eax, %edx
 10078 0039 488B45E8 		movq	-24(%rbp), %rax
 10079 003d 8890BB00 		movb	%dl, 187(%rax)
 10079      0000
7603:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 10080              		.loc 4 7603 1
 10081 0043 90       		nop
 10082 0044 488B45F8 		movq	-8(%rbp), %rax
 10083 0048 64483304 		xorq	%fs:40, %rax
 10083      25280000 
 10083      00
 10084 0051 7405     		je	.L569
 10085 0053 E8000000 		call	__stack_chk_fail@PLT
 10085      00
 10086              	.L569:
 10087 0058 C9       		leave
 10088              	.LCFI245:
 10089              		.cfi_def_cfa 7, 8
 10090 0059 C3       		ret
 10091              		.cfi_endproc
 10092              	.LFE100:
 10094              		.section	.text.mbedtls_ssl_conf_fallback,"ax",@progbits
 10095              		.globl	mbedtls_ssl_conf_fallback
 10097              	mbedtls_ssl_conf_fallback:
 10098              	.LFB101:
7604:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7605:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_FALLBACK_SCSV) && defined(MBEDTLS_SSL_CLI_C)
7606:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_fallback( mbedtls_ssl_config *conf, char fallback )
7607:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 10099              		.loc 4 7607 1
 10100              		.cfi_startproc
 10101 0000 F30F1EFA 		endbr64
 10102 0004 55       		pushq	%rbp
 10103              	.LCFI246:
 10104              		.cfi_def_cfa_offset 16
 10105              		.cfi_offset 6, -16
 10106 0005 4889E5   		movq	%rsp, %rbp
 10107              	.LCFI247:
 10108              		.cfi_def_cfa_register 6
GAS LISTING /tmp/ccEn8xFO.s 			page 377


 10109 0008 4883EC20 		subq	$32, %rsp
 10110 000c 48897DE8 		movq	%rdi, -24(%rbp)
 10111 0010 89F0     		movl	%esi, %eax
 10112 0012 8845E4   		movb	%al, -28(%rbp)
 10113              		.loc 4 7607 1
 10114 0015 64488B04 		movq	%fs:40, %rax
 10114      25280000 
 10114      00
 10115 001e 488945F8 		movq	%rax, -8(%rbp)
 10116 0022 31C0     		xorl	%eax, %eax
7608:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->fallback = fallback;
 10117              		.loc 4 7608 20
 10118 0024 0FB645E4 		movzbl	-28(%rbp), %eax
 10119 0028 83E001   		andl	$1, %eax
 10120 002b 89C2     		movl	%eax, %edx
 10121 002d 488B45E8 		movq	-24(%rbp), %rax
 10122 0031 83E201   		andl	$1, %edx
 10123 0034 89D1     		movl	%edx, %ecx
 10124 0036 C1E104   		sall	$4, %ecx
 10125 0039 0FB690BD 		movzbl	189(%rax), %edx
 10125      000000
 10126 0040 83E2EF   		andl	$-17, %edx
 10127 0043 09CA     		orl	%ecx, %edx
 10128 0045 8890BD00 		movb	%dl, 189(%rax)
 10128      0000
7609:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 10129              		.loc 4 7609 1
 10130 004b 90       		nop
 10131 004c 488B45F8 		movq	-8(%rbp), %rax
 10132 0050 64483304 		xorq	%fs:40, %rax
 10132      25280000 
 10132      00
 10133 0059 7405     		je	.L571
 10134 005b E8000000 		call	__stack_chk_fail@PLT
 10134      00
 10135              	.L571:
 10136 0060 C9       		leave
 10137              	.LCFI248:
 10138              		.cfi_def_cfa 7, 8
 10139 0061 C3       		ret
 10140              		.cfi_endproc
 10141              	.LFE101:
 10143              		.section	.text.mbedtls_ssl_conf_extended_master_secret,"ax",@progbits
 10144              		.globl	mbedtls_ssl_conf_extended_master_secret
 10146              	mbedtls_ssl_conf_extended_master_secret:
 10147              	.LFB102:
7610:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
7611:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7612:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
7613:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_cert_req_ca_list( mbedtls_ssl_config *conf,
7614:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                           char cert_req_ca_list )
7615:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7616:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->cert_req_ca_list = cert_req_ca_list;
7617:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7618:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
7619:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7620:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_ENCRYPT_THEN_MAC)
GAS LISTING /tmp/ccEn8xFO.s 			page 378


7621:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_encrypt_then_mac( mbedtls_ssl_config *conf, char etm )
7622:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7623:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->encrypt_then_mac = etm;
7624:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7625:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
7626:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7627:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_EXTENDED_MASTER_SECRET)
7628:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_extended_master_secret( mbedtls_ssl_config *conf, char ems )
7629:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 10148              		.loc 4 7629 1
 10149              		.cfi_startproc
 10150 0000 F30F1EFA 		endbr64
 10151 0004 55       		pushq	%rbp
 10152              	.LCFI249:
 10153              		.cfi_def_cfa_offset 16
 10154              		.cfi_offset 6, -16
 10155 0005 4889E5   		movq	%rsp, %rbp
 10156              	.LCFI250:
 10157              		.cfi_def_cfa_register 6
 10158 0008 4883EC20 		subq	$32, %rsp
 10159 000c 48897DE8 		movq	%rdi, -24(%rbp)
 10160 0010 89F0     		movl	%esi, %eax
 10161 0012 8845E4   		movb	%al, -28(%rbp)
 10162              		.loc 4 7629 1
 10163 0015 64488B04 		movq	%fs:40, %rax
 10163      25280000 
 10163      00
 10164 001e 488945F8 		movq	%rax, -8(%rbp)
 10165 0022 31C0     		xorl	%eax, %eax
7630:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->extended_ms = ems;
 10166              		.loc 4 7630 23
 10167 0024 0FB645E4 		movzbl	-28(%rbp), %eax
 10168 0028 83E001   		andl	$1, %eax
 10169 002b 89C2     		movl	%eax, %edx
 10170 002d 488B45E8 		movq	-24(%rbp), %rax
 10171 0031 83E201   		andl	$1, %edx
 10172 0034 8D0C12   		leal	(%rdx,%rdx), %ecx
 10173 0037 0FB690BD 		movzbl	189(%rax), %edx
 10173      000000
 10174 003e 83E2FD   		andl	$-3, %edx
 10175 0041 09CA     		orl	%ecx, %edx
 10176 0043 8890BD00 		movb	%dl, 189(%rax)
 10176      0000
7631:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 10177              		.loc 4 7631 1
 10178 0049 90       		nop
 10179 004a 488B45F8 		movq	-8(%rbp), %rax
 10180 004e 64483304 		xorq	%fs:40, %rax
 10180      25280000 
 10180      00
 10181 0057 7405     		je	.L573
 10182 0059 E8000000 		call	__stack_chk_fail@PLT
 10182      00
 10183              	.L573:
 10184 005e C9       		leave
 10185              	.LCFI251:
 10186              		.cfi_def_cfa 7, 8
GAS LISTING /tmp/ccEn8xFO.s 			page 379


 10187 005f C3       		ret
 10188              		.cfi_endproc
 10189              	.LFE102:
 10191              		.section	.text.mbedtls_ssl_conf_max_frag_len,"ax",@progbits
 10192              		.globl	mbedtls_ssl_conf_max_frag_len
 10194              	mbedtls_ssl_conf_max_frag_len:
 10195              	.LFB103:
7632:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
7633:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7634:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_ARC4_C)
7635:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_arc4_support( mbedtls_ssl_config *conf, char arc4 )
7636:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7637:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->arc4_disabled = arc4;
7638:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7639:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
7640:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7641:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_MAX_FRAGMENT_LENGTH)
7642:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_conf_max_frag_len( mbedtls_ssl_config *conf, unsigned char mfl_code )
7643:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 10196              		.loc 4 7643 1
 10197              		.cfi_startproc
 10198 0000 F30F1EFA 		endbr64
 10199 0004 55       		pushq	%rbp
 10200              	.LCFI252:
 10201              		.cfi_def_cfa_offset 16
 10202              		.cfi_offset 6, -16
 10203 0005 4889E5   		movq	%rsp, %rbp
 10204              	.LCFI253:
 10205              		.cfi_def_cfa_register 6
 10206 0008 4883EC20 		subq	$32, %rsp
 10207 000c 48897DE8 		movq	%rdi, -24(%rbp)
 10208 0010 89F0     		movl	%esi, %eax
 10209 0012 8845E4   		movb	%al, -28(%rbp)
 10210              		.loc 4 7643 1
 10211 0015 64488B04 		movq	%fs:40, %rax
 10211      25280000 
 10211      00
 10212 001e 488945F8 		movq	%rax, -8(%rbp)
 10213 0022 31C0     		xorl	%eax, %eax
7644:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( mfl_code >= MBEDTLS_SSL_MAX_FRAG_LEN_INVALID ||
 10214              		.loc 4 7644 7
 10215 0024 807DE404 		cmpb	$4, -28(%rbp)
 10216 0028 7712     		ja	.L575
7645:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl_mfl_code_to_length( mfl_code ) > MBEDTLS_TLS_EXT_ADV_CONTENT_LEN )
 10217              		.loc 4 7645 9 discriminator 1
 10218 002a 0FB645E4 		movzbl	-28(%rbp), %eax
 10219 002e 89C7     		movl	%eax, %edi
 10220 0030 E8000000 		call	ssl_mfl_code_to_length
 10220      00
7644:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( mfl_code >= MBEDTLS_SSL_MAX_FRAG_LEN_INVALID ||
 10221              		.loc 4 7644 54 discriminator 1
 10222 0035 3D803E00 		cmpl	$16000, %eax
 10222      00
 10223 003a 7607     		jbe	.L576
 10224              	.L575:
7646:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7647:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
GAS LISTING /tmp/ccEn8xFO.s 			page 380


 10225              		.loc 4 7647 15
 10226 003c B8008FFF 		movl	$-28928, %eax
 10226      FF
 10227 0041 EB32     		jmp	.L577
 10228              	.L576:
7648:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7649:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7650:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->mfl_code = mfl_code;
 10229              		.loc 4 7650 20
 10230 0043 0FB645E4 		movzbl	-28(%rbp), %eax
 10231 0047 83E007   		andl	$7, %eax
 10232 004a 89C2     		movl	%eax, %edx
 10233 004c 488B45E8 		movq	-24(%rbp), %rax
 10234 0050 0FB6D2   		movzbl	%dl, %edx
 10235 0053 83E207   		andl	$7, %edx
 10236 0056 89D1     		movl	%edx, %ecx
 10237 0058 C1E106   		sall	$6, %ecx
 10238 005b 0FB790BC 		movzwl	188(%rax), %edx
 10238      000000
 10239 0062 6681E23F 		andw	$-449, %dx
 10239      FE
 10240 0067 09CA     		orl	%ecx, %edx
 10241 0069 668990BC 		movw	%dx, 188(%rax)
 10241      000000
7651:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7652:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 10242              		.loc 4 7652 11
 10243 0070 B8000000 		movl	$0, %eax
 10243      00
 10244              	.L577:
7653:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 10245              		.loc 4 7653 1
 10246 0075 488B75F8 		movq	-8(%rbp), %rsi
 10247 0079 64483334 		xorq	%fs:40, %rsi
 10247      25280000 
 10247      00
 10248 0082 7405     		je	.L578
 10249 0084 E8000000 		call	__stack_chk_fail@PLT
 10249      00
 10250              	.L578:
 10251 0089 C9       		leave
 10252              	.LCFI254:
 10253              		.cfi_def_cfa 7, 8
 10254 008a C3       		ret
 10255              		.cfi_endproc
 10256              	.LFE103:
 10258              		.section	.text.mbedtls_ssl_conf_legacy_renegotiation,"ax",@progbits
 10259              		.globl	mbedtls_ssl_conf_legacy_renegotiation
 10261              	mbedtls_ssl_conf_legacy_renegotiation:
 10262              	.LFB104:
7654:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_MAX_FRAGMENT_LENGTH */
7655:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7656:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_TRUNCATED_HMAC)
7657:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_truncated_hmac( mbedtls_ssl_config *conf, int truncate )
7658:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7659:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->trunc_hmac = truncate;
7660:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
GAS LISTING /tmp/ccEn8xFO.s 			page 381


7661:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_TRUNCATED_HMAC */
7662:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7663:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_CBC_RECORD_SPLITTING)
7664:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_cbc_record_splitting( mbedtls_ssl_config *conf, char split )
7665:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7666:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->cbc_record_splitting = split;
7667:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7668:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
7669:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7670:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_legacy_renegotiation( mbedtls_ssl_config *conf, int allow_legacy )
7671:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 10263              		.loc 4 7671 1
 10264              		.cfi_startproc
 10265 0000 F30F1EFA 		endbr64
 10266 0004 55       		pushq	%rbp
 10267              	.LCFI255:
 10268              		.cfi_def_cfa_offset 16
 10269              		.cfi_offset 6, -16
 10270 0005 4889E5   		movq	%rsp, %rbp
 10271              	.LCFI256:
 10272              		.cfi_def_cfa_register 6
 10273 0008 4883EC20 		subq	$32, %rsp
 10274 000c 48897DE8 		movq	%rdi, -24(%rbp)
 10275 0010 8975E4   		movl	%esi, -28(%rbp)
 10276              		.loc 4 7671 1
 10277 0013 64488B04 		movq	%fs:40, %rax
 10277      25280000 
 10277      00
 10278 001c 488945F8 		movq	%rax, -8(%rbp)
 10279 0020 31C0     		xorl	%eax, %eax
7672:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->allow_legacy_renegotiation = allow_legacy;
 10280              		.loc 4 7672 38
 10281 0022 8B45E4   		movl	-28(%rbp), %eax
 10282 0025 83E003   		andl	$3, %eax
 10283 0028 488B55E8 		movq	-24(%rbp), %rdx
 10284 002c 83E003   		andl	$3, %eax
 10285 002f C1E004   		sall	$4, %eax
 10286 0032 89C1     		movl	%eax, %ecx
 10287 0034 0FB682BC 		movzbl	188(%rdx), %eax
 10287      000000
 10288 003b 83E0CF   		andl	$-49, %eax
 10289 003e 09C8     		orl	%ecx, %eax
 10290 0040 8882BC00 		movb	%al, 188(%rdx)
 10290      0000
7673:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 10291              		.loc 4 7673 1
 10292 0046 90       		nop
 10293 0047 488B45F8 		movq	-8(%rbp), %rax
 10294 004b 64483304 		xorq	%fs:40, %rax
 10294      25280000 
 10294      00
 10295 0054 7405     		je	.L580
 10296 0056 E8000000 		call	__stack_chk_fail@PLT
 10296      00
 10297              	.L580:
 10298 005b C9       		leave
 10299              	.LCFI257:
GAS LISTING /tmp/ccEn8xFO.s 			page 382


 10300              		.cfi_def_cfa 7, 8
 10301 005c C3       		ret
 10302              		.cfi_endproc
 10303              	.LFE104:
 10305              		.section	.text.mbedtls_ssl_conf_renegotiation,"ax",@progbits
 10306              		.globl	mbedtls_ssl_conf_renegotiation
 10308              	mbedtls_ssl_conf_renegotiation:
 10309              	.LFB105:
7674:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7675:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
7676:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_renegotiation( mbedtls_ssl_config *conf, int renegotiation )
7677:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 10310              		.loc 4 7677 1
 10311              		.cfi_startproc
 10312 0000 F30F1EFA 		endbr64
 10313 0004 55       		pushq	%rbp
 10314              	.LCFI258:
 10315              		.cfi_def_cfa_offset 16
 10316              		.cfi_offset 6, -16
 10317 0005 4889E5   		movq	%rsp, %rbp
 10318              	.LCFI259:
 10319              		.cfi_def_cfa_register 6
 10320 0008 4883EC20 		subq	$32, %rsp
 10321 000c 48897DE8 		movq	%rdi, -24(%rbp)
 10322 0010 8975E4   		movl	%esi, -28(%rbp)
 10323              		.loc 4 7677 1
 10324 0013 64488B04 		movq	%fs:40, %rax
 10324      25280000 
 10324      00
 10325 001c 488945F8 		movq	%rax, -8(%rbp)
 10326 0020 31C0     		xorl	%eax, %eax
7678:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->disable_renegotiation = renegotiation;
 10327              		.loc 4 7678 33
 10328 0022 8B45E4   		movl	-28(%rbp), %eax
 10329 0025 83E001   		andl	$1, %eax
 10330 0028 488B55E8 		movq	-24(%rbp), %rdx
 10331 002c 83E001   		andl	$1, %eax
 10332 002f 8D0C8500 		leal	0(,%rax,4), %ecx
 10332      000000
 10333 0036 0FB682BD 		movzbl	189(%rdx), %eax
 10333      000000
 10334 003d 83E0FB   		andl	$-5, %eax
 10335 0040 09C8     		orl	%ecx, %eax
 10336 0042 8882BD00 		movb	%al, 189(%rdx)
 10336      0000
7679:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 10337              		.loc 4 7679 1
 10338 0048 90       		nop
 10339 0049 488B45F8 		movq	-8(%rbp), %rax
 10340 004d 64483304 		xorq	%fs:40, %rax
 10340      25280000 
 10340      00
 10341 0056 7405     		je	.L582
 10342 0058 E8000000 		call	__stack_chk_fail@PLT
 10342      00
 10343              	.L582:
 10344 005d C9       		leave
GAS LISTING /tmp/ccEn8xFO.s 			page 383


 10345              	.LCFI260:
 10346              		.cfi_def_cfa 7, 8
 10347 005e C3       		ret
 10348              		.cfi_endproc
 10349              	.LFE105:
 10351              		.section	.text.mbedtls_ssl_conf_renegotiation_enforced,"ax",@progbits
 10352              		.globl	mbedtls_ssl_conf_renegotiation_enforced
 10354              	mbedtls_ssl_conf_renegotiation_enforced:
 10355              	.LFB106:
7680:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7681:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_renegotiation_enforced( mbedtls_ssl_config *conf, int max_records )
7682:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 10356              		.loc 4 7682 1
 10357              		.cfi_startproc
 10358 0000 F30F1EFA 		endbr64
 10359 0004 55       		pushq	%rbp
 10360              	.LCFI261:
 10361              		.cfi_def_cfa_offset 16
 10362              		.cfi_offset 6, -16
 10363 0005 4889E5   		movq	%rsp, %rbp
 10364              	.LCFI262:
 10365              		.cfi_def_cfa_register 6
 10366 0008 4883EC20 		subq	$32, %rsp
 10367 000c 48897DE8 		movq	%rdi, -24(%rbp)
 10368 0010 8975E4   		movl	%esi, -28(%rbp)
 10369              		.loc 4 7682 1
 10370 0013 64488B04 		movq	%fs:40, %rax
 10370      25280000 
 10370      00
 10371 001c 488945F8 		movq	%rax, -8(%rbp)
 10372 0020 31C0     		xorl	%eax, %eax
7683:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->renego_max_records = max_records;
 10373              		.loc 4 7683 30
 10374 0022 488B45E8 		movq	-24(%rbp), %rax
 10375 0026 8B55E4   		movl	-28(%rbp), %edx
 10376 0029 8990AC00 		movl	%edx, 172(%rax)
 10376      0000
7684:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 10377              		.loc 4 7684 1
 10378 002f 90       		nop
 10379 0030 488B45F8 		movq	-8(%rbp), %rax
 10380 0034 64483304 		xorq	%fs:40, %rax
 10380      25280000 
 10380      00
 10381 003d 7405     		je	.L584
 10382 003f E8000000 		call	__stack_chk_fail@PLT
 10382      00
 10383              	.L584:
 10384 0044 C9       		leave
 10385              	.LCFI263:
 10386              		.cfi_def_cfa 7, 8
 10387 0045 C3       		ret
 10388              		.cfi_endproc
 10389              	.LFE106:
 10391              		.section	.text.mbedtls_ssl_conf_renegotiation_period,"ax",@progbits
 10392              		.globl	mbedtls_ssl_conf_renegotiation_period
 10394              	mbedtls_ssl_conf_renegotiation_period:
GAS LISTING /tmp/ccEn8xFO.s 			page 384


 10395              	.LFB107:
7685:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7686:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_renegotiation_period( mbedtls_ssl_config *conf,
7687:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    const unsigned char period[8] )
7688:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 10396              		.loc 4 7688 1
 10397              		.cfi_startproc
 10398 0000 F30F1EFA 		endbr64
 10399 0004 55       		pushq	%rbp
 10400              	.LCFI264:
 10401              		.cfi_def_cfa_offset 16
 10402              		.cfi_offset 6, -16
 10403 0005 4889E5   		movq	%rsp, %rbp
 10404              	.LCFI265:
 10405              		.cfi_def_cfa_register 6
 10406 0008 4883EC20 		subq	$32, %rsp
 10407 000c 48897DE8 		movq	%rdi, -24(%rbp)
 10408 0010 488975E0 		movq	%rsi, -32(%rbp)
 10409              		.loc 4 7688 1
 10410 0014 64488B04 		movq	%fs:40, %rax
 10410      25280000 
 10410      00
 10411 001d 488945F8 		movq	%rax, -8(%rbp)
 10412 0021 31C0     		xorl	%eax, %eax
7689:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( conf->renego_period, period, 8 );
 10413              		.loc 4 7689 17
 10414 0023 488B45E8 		movq	-24(%rbp), %rax
 10415 0027 488D90B0 		leaq	176(%rax), %rdx
 10415      000000
 10416 002e 488B45E0 		movq	-32(%rbp), %rax
 10417 0032 488B00   		movq	(%rax), %rax
 10418              		.loc 4 7689 5
 10419 0035 488902   		movq	%rax, (%rdx)
7690:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 10420              		.loc 4 7690 1
 10421 0038 90       		nop
 10422 0039 488B45F8 		movq	-8(%rbp), %rax
 10423 003d 64483304 		xorq	%fs:40, %rax
 10423      25280000 
 10423      00
 10424 0046 7405     		je	.L586
 10425 0048 E8000000 		call	__stack_chk_fail@PLT
 10425      00
 10426              	.L586:
 10427 004d C9       		leave
 10428              	.LCFI266:
 10429              		.cfi_def_cfa 7, 8
 10430 004e C3       		ret
 10431              		.cfi_endproc
 10432              	.LFE107:
 10434              		.section	.text.mbedtls_ssl_conf_session_tickets,"ax",@progbits
 10435              		.globl	mbedtls_ssl_conf_session_tickets
 10437              	mbedtls_ssl_conf_session_tickets:
 10438              	.LFB108:
7691:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_RENEGOTIATION */
7692:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7693:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SESSION_TICKETS)
GAS LISTING /tmp/ccEn8xFO.s 			page 385


7694:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
7695:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_session_tickets( mbedtls_ssl_config *conf, int use_tickets )
7696:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 10439              		.loc 4 7696 1
 10440              		.cfi_startproc
 10441 0000 F30F1EFA 		endbr64
 10442 0004 55       		pushq	%rbp
 10443              	.LCFI267:
 10444              		.cfi_def_cfa_offset 16
 10445              		.cfi_offset 6, -16
 10446 0005 4889E5   		movq	%rsp, %rbp
 10447              	.LCFI268:
 10448              		.cfi_def_cfa_register 6
 10449 0008 4883EC20 		subq	$32, %rsp
 10450 000c 48897DE8 		movq	%rdi, -24(%rbp)
 10451 0010 8975E4   		movl	%esi, -28(%rbp)
 10452              		.loc 4 7696 1
 10453 0013 64488B04 		movq	%fs:40, %rax
 10453      25280000 
 10453      00
 10454 001c 488945F8 		movq	%rax, -8(%rbp)
 10455 0020 31C0     		xorl	%eax, %eax
7697:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->session_tickets = use_tickets;
 10456              		.loc 4 7697 27
 10457 0022 8B45E4   		movl	-28(%rbp), %eax
 10458 0025 83E001   		andl	$1, %eax
 10459 0028 488B55E8 		movq	-24(%rbp), %rdx
 10460 002c 83E001   		andl	$1, %eax
 10461 002f 8D0CC500 		leal	0(,%rax,8), %ecx
 10461      000000
 10462 0036 0FB682BD 		movzbl	189(%rdx), %eax
 10462      000000
 10463 003d 83E0F7   		andl	$-9, %eax
 10464 0040 09C8     		orl	%ecx, %eax
 10465 0042 8882BD00 		movb	%al, 189(%rdx)
 10465      0000
7698:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 10466              		.loc 4 7698 1
 10467 0048 90       		nop
 10468 0049 488B45F8 		movq	-8(%rbp), %rax
 10469 004d 64483304 		xorq	%fs:40, %rax
 10469      25280000 
 10469      00
 10470 0056 7405     		je	.L588
 10471 0058 E8000000 		call	__stack_chk_fail@PLT
 10471      00
 10472              	.L588:
 10473 005d C9       		leave
 10474              	.LCFI269:
 10475              		.cfi_def_cfa 7, 8
 10476 005e C3       		ret
 10477              		.cfi_endproc
 10478              	.LFE108:
 10480              		.section	.text.mbedtls_ssl_conf_export_keys_cb,"ax",@progbits
 10481              		.globl	mbedtls_ssl_conf_export_keys_cb
 10483              	mbedtls_ssl_conf_export_keys_cb:
 10484              	.LFB109:
GAS LISTING /tmp/ccEn8xFO.s 			page 386


7699:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
7700:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7701:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
7702:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_session_tickets_cb( mbedtls_ssl_config *conf,
7703:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_ticket_write_t *f_ticket_write,
7704:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_ticket_parse_t *f_ticket_parse,
7705:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         void *p_ticket )
7706:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7707:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->f_ticket_write = f_ticket_write;
7708:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->f_ticket_parse = f_ticket_parse;
7709:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->p_ticket       = p_ticket;
7710:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7711:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
7712:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_SESSION_TICKETS */
7713:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7714:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_EXPORT_KEYS)
7715:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_export_keys_cb( mbedtls_ssl_config *conf,
7716:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_export_keys_t *f_export_keys,
7717:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         void *p_export_keys )
7718:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 10485              		.loc 4 7718 1
 10486              		.cfi_startproc
 10487 0000 F30F1EFA 		endbr64
 10488 0004 55       		pushq	%rbp
 10489              	.LCFI270:
 10490              		.cfi_def_cfa_offset 16
 10491              		.cfi_offset 6, -16
 10492 0005 4889E5   		movq	%rsp, %rbp
 10493              	.LCFI271:
 10494              		.cfi_def_cfa_register 6
 10495 0008 4883EC30 		subq	$48, %rsp
 10496 000c 48897DE8 		movq	%rdi, -24(%rbp)
 10497 0010 488975E0 		movq	%rsi, -32(%rbp)
 10498 0014 488955D8 		movq	%rdx, -40(%rbp)
 10499              		.loc 4 7718 1
 10500 0018 64488B04 		movq	%fs:40, %rax
 10500      25280000 
 10500      00
 10501 0021 488945F8 		movq	%rax, -8(%rbp)
 10502 0025 31C0     		xorl	%eax, %eax
7719:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->f_export_keys = f_export_keys;
 10503              		.loc 4 7719 25
 10504 0027 488B45E8 		movq	-24(%rbp), %rax
 10505 002b 488B55E0 		movq	-32(%rbp), %rdx
 10506 002f 48895068 		movq	%rdx, 104(%rax)
7720:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->p_export_keys = p_export_keys;
 10507              		.loc 4 7720 25
 10508 0033 488B45E8 		movq	-24(%rbp), %rax
 10509 0037 488B55D8 		movq	-40(%rbp), %rdx
 10510 003b 48895070 		movq	%rdx, 112(%rax)
7721:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 10511              		.loc 4 7721 1
 10512 003f 90       		nop
 10513 0040 488B45F8 		movq	-8(%rbp), %rax
 10514 0044 64483304 		xorq	%fs:40, %rax
 10514      25280000 
 10514      00
GAS LISTING /tmp/ccEn8xFO.s 			page 387


 10515 004d 7405     		je	.L590
 10516 004f E8000000 		call	__stack_chk_fail@PLT
 10516      00
 10517              	.L590:
 10518 0054 C9       		leave
 10519              	.LCFI272:
 10520              		.cfi_def_cfa 7, 8
 10521 0055 C3       		ret
 10522              		.cfi_endproc
 10523              	.LFE109:
 10525              		.section	.text.mbedtls_ssl_get_bytes_avail,"ax",@progbits
 10526              		.globl	mbedtls_ssl_get_bytes_avail
 10528              	mbedtls_ssl_get_bytes_avail:
 10529              	.LFB110:
7722:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
7723:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7724:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_ASYNC_PRIVATE)
7725:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_conf_async_private_cb(
7726:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_config *conf,
7727:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_async_sign_t *f_async_sign,
7728:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_async_decrypt_t *f_async_decrypt,
7729:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_async_resume_t *f_async_resume,
7730:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_async_cancel_t *f_async_cancel,
7731:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     void *async_config_data )
7732:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7733:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->f_async_sign_start = f_async_sign;
7734:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->f_async_decrypt_start = f_async_decrypt;
7735:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->f_async_resume = f_async_resume;
7736:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->f_async_cancel = f_async_cancel;
7737:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->p_async_config_data = async_config_data;
7738:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7739:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7740:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void *mbedtls_ssl_conf_get_async_config_data( const mbedtls_ssl_config *conf )
7741:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7742:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( conf->p_async_config_data );
7743:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7744:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7745:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void *mbedtls_ssl_get_async_operation_data( const mbedtls_ssl_context *ssl )
7746:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7747:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->handshake == NULL )
7748:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( NULL );
7749:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
7750:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ssl->handshake->user_async_ctx );
7751:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7752:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7753:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_set_async_operation_data( mbedtls_ssl_context *ssl,
7754:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  void *ctx )
7755:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7756:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->handshake != NULL )
7757:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->handshake->user_async_ctx = ctx;
7758:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7759:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_ASYNC_PRIVATE */
7760:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7761:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
7762:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * SSL get accessors
7763:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
7764:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** size_t mbedtls_ssl_get_bytes_avail( const mbedtls_ssl_context *ssl )
GAS LISTING /tmp/ccEn8xFO.s 			page 388


7765:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 10530              		.loc 4 7765 1
 10531              		.cfi_startproc
 10532 0000 F30F1EFA 		endbr64
 10533 0004 55       		pushq	%rbp
 10534              	.LCFI273:
 10535              		.cfi_def_cfa_offset 16
 10536              		.cfi_offset 6, -16
 10537 0005 4889E5   		movq	%rsp, %rbp
 10538              	.LCFI274:
 10539              		.cfi_def_cfa_register 6
 10540 0008 4883EC20 		subq	$32, %rsp
 10541 000c 48897DE8 		movq	%rdi, -24(%rbp)
 10542              		.loc 4 7765 1
 10543 0010 64488B04 		movq	%fs:40, %rax
 10543      25280000 
 10543      00
 10544 0019 488945F8 		movq	%rax, -8(%rbp)
 10545 001d 31C0     		xorl	%eax, %eax
7766:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ssl->in_offt == NULL ? 0 : ssl->in_msglen );
 10546              		.loc 4 7766 16
 10547 001f 488B45E8 		movq	-24(%rbp), %rax
 10548 0023 488B80D0 		movq	208(%rax), %rax
 10548      000000
 10549              		.loc 4 7766 38
 10550 002a 4885C0   		testq	%rax, %rax
 10551 002d 740D     		je	.L592
 10552              		.loc 4 7766 38 is_stmt 0 discriminator 1
 10553 002f 488B45E8 		movq	-24(%rbp), %rax
 10554 0033 488B80E0 		movq	224(%rax), %rax
 10554      000000
 10555 003a EB05     		jmp	.L594
 10556              	.L592:
 10557              		.loc 4 7766 38 discriminator 2
 10558 003c B8000000 		movl	$0, %eax
 10558      00
 10559              	.L594:
7767:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 10560              		.loc 4 7767 1 is_stmt 1 discriminator 5
 10561 0041 488B55F8 		movq	-8(%rbp), %rdx
 10562 0045 64483314 		xorq	%fs:40, %rdx
 10562      25280000 
 10562      00
 10563 004e 7405     		je	.L595
 10564              		.loc 4 7767 1 is_stmt 0
 10565 0050 E8000000 		call	__stack_chk_fail@PLT
 10565      00
 10566              	.L595:
 10567 0055 C9       		leave
 10568              	.LCFI275:
 10569              		.cfi_def_cfa 7, 8
 10570 0056 C3       		ret
 10571              		.cfi_endproc
 10572              	.LFE110:
 10574              		.section	.text.mbedtls_ssl_check_pending,"ax",@progbits
 10575              		.globl	mbedtls_ssl_check_pending
 10577              	mbedtls_ssl_check_pending:
GAS LISTING /tmp/ccEn8xFO.s 			page 389


 10578              	.LFB111:
7768:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7769:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_check_pending( const mbedtls_ssl_context *ssl )
7770:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 10579              		.loc 4 7770 1 is_stmt 1
 10580              		.cfi_startproc
 10581 0000 F30F1EFA 		endbr64
 10582 0004 55       		pushq	%rbp
 10583              	.LCFI276:
 10584              		.cfi_def_cfa_offset 16
 10585              		.cfi_offset 6, -16
 10586 0005 4889E5   		movq	%rsp, %rbp
 10587              	.LCFI277:
 10588              		.cfi_def_cfa_register 6
 10589 0008 4883EC20 		subq	$32, %rsp
 10590 000c 48897DE8 		movq	%rdi, -24(%rbp)
 10591              		.loc 4 7770 1
 10592 0010 64488B04 		movq	%fs:40, %rax
 10592      25280000 
 10592      00
 10593 0019 488945F8 		movq	%rax, -8(%rbp)
 10594 001d 31C0     		xorl	%eax, %eax
7771:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
7772:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Case A: We're currently holding back
7773:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * a message for further processing.
7774:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
7775:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7776:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->keep_current_message == 1 )
 10595              		.loc 4 7776 12
 10596 001f 488B45E8 		movq	-24(%rbp), %rax
 10597 0023 8B80FC00 		movl	252(%rax), %eax
 10597      0000
 10598              		.loc 4 7776 7
 10599 0029 83F801   		cmpl	$1, %eax
 10600 002c 7507     		jne	.L597
7777:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7778:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "ssl_check_pending: record held back for processing" ) );
7779:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 1 );
 10601              		.loc 4 7779 15
 10602 002e B8010000 		movl	$1, %eax
 10602      00
 10603 0033 EB4E     		jmp	.L598
 10604              	.L597:
7780:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7781:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7782:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
7783:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Case B: Further records are pending in the current datagram.
7784:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
7785:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7786:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
7787:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
7788:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_left > ssl->next_record_offset )
7789:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7790:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "ssl_check_pending: more records within current datagram" ) );
7791:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 1 );
7792:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7793:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
GAS LISTING /tmp/ccEn8xFO.s 			page 390


7794:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7795:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
7796:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Case C: A handshake message is being processed.
7797:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
7798:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7799:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_hslen > 0 && ssl->in_hslen < ssl->in_msglen )
 10605              		.loc 4 7799 12
 10606 0035 488B45E8 		movq	-24(%rbp), %rax
 10607 0039 488B80F0 		movq	240(%rax), %rax
 10607      000000
 10608              		.loc 4 7799 7
 10609 0040 4885C0   		testq	%rax, %rax
 10610 0043 7422     		je	.L599
 10611              		.loc 4 7799 33 discriminator 1
 10612 0045 488B45E8 		movq	-24(%rbp), %rax
 10613 0049 488B90F0 		movq	240(%rax), %rdx
 10613      000000
 10614              		.loc 4 7799 49 discriminator 1
 10615 0050 488B45E8 		movq	-24(%rbp), %rax
 10616 0054 488B80E0 		movq	224(%rax), %rax
 10616      000000
 10617              		.loc 4 7799 27 discriminator 1
 10618 005b 4839C2   		cmpq	%rax, %rdx
 10619 005e 7307     		jnb	.L599
7800:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7801:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "ssl_check_pending: more handshake messages within current reco
7802:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 1 );
 10620              		.loc 4 7802 15
 10621 0060 B8010000 		movl	$1, %eax
 10621      00
 10622 0065 EB1C     		jmp	.L598
 10623              	.L599:
7803:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7804:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7805:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
7806:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Case D: An application data message is being processed
7807:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
7808:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_offt != NULL )
 10624              		.loc 4 7808 12
 10625 0067 488B45E8 		movq	-24(%rbp), %rax
 10626 006b 488B80D0 		movq	208(%rax), %rax
 10626      000000
 10627              		.loc 4 7808 7
 10628 0072 4885C0   		testq	%rax, %rax
 10629 0075 7407     		je	.L600
7809:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7810:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "ssl_check_pending: application data record is being processed"
7811:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 1 );
 10630              		.loc 4 7811 15
 10631 0077 B8010000 		movl	$1, %eax
 10631      00
 10632 007c EB05     		jmp	.L598
 10633              	.L600:
7812:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7813:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7814:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
7815:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * In all other cases, the rest of the message can be dropped.
GAS LISTING /tmp/ccEn8xFO.s 			page 391


7816:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * As in ssl_get_next_record, this needs to be adapted if
7817:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * we implement support for multiple alerts in single records.
7818:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
7819:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7820:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "ssl_check_pending: nothing pending" ) );
7821:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 10634              		.loc 4 7821 11
 10635 007e B8000000 		movl	$0, %eax
 10635      00
 10636              	.L598:
7822:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 10637              		.loc 4 7822 1
 10638 0083 488B4DF8 		movq	-8(%rbp), %rcx
 10639 0087 6448330C 		xorq	%fs:40, %rcx
 10639      25280000 
 10639      00
 10640 0090 7405     		je	.L601
 10641 0092 E8000000 		call	__stack_chk_fail@PLT
 10641      00
 10642              	.L601:
 10643 0097 C9       		leave
 10644              	.LCFI278:
 10645              		.cfi_def_cfa 7, 8
 10646 0098 C3       		ret
 10647              		.cfi_endproc
 10648              	.LFE111:
 10650              		.section	.text.mbedtls_ssl_get_verify_result,"ax",@progbits
 10651              		.globl	mbedtls_ssl_get_verify_result
 10653              	mbedtls_ssl_get_verify_result:
 10654              	.LFB112:
7823:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7824:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** uint32_t mbedtls_ssl_get_verify_result( const mbedtls_ssl_context *ssl )
7825:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 10655              		.loc 4 7825 1
 10656              		.cfi_startproc
 10657 0000 F30F1EFA 		endbr64
 10658 0004 55       		pushq	%rbp
 10659              	.LCFI279:
 10660              		.cfi_def_cfa_offset 16
 10661              		.cfi_offset 6, -16
 10662 0005 4889E5   		movq	%rsp, %rbp
 10663              	.LCFI280:
 10664              		.cfi_def_cfa_register 6
 10665 0008 4883EC20 		subq	$32, %rsp
 10666 000c 48897DE8 		movq	%rdi, -24(%rbp)
 10667              		.loc 4 7825 1
 10668 0010 64488B04 		movq	%fs:40, %rax
 10668      25280000 
 10668      00
 10669 0019 488945F8 		movq	%rax, -8(%rbp)
 10670 001d 31C0     		xorl	%eax, %eax
7826:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->session != NULL )
 10671              		.loc 4 7826 12
 10672 001f 488B45E8 		movq	-24(%rbp), %rax
 10673 0023 488B4050 		movq	80(%rax), %rax
 10674              		.loc 4 7826 7
 10675 0027 4885C0   		testq	%rax, %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 392


 10676 002a 740D     		je	.L603
7827:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ssl->session->verify_result );
 10677              		.loc 4 7827 20
 10678 002c 488B45E8 		movq	-24(%rbp), %rax
 10679 0030 488B4050 		movq	80(%rax), %rax
 10680              		.loc 4 7827 29
 10681 0034 8B4068   		movl	104(%rax), %eax
 10682 0037 EB1F     		jmp	.L604
 10683              	.L603:
7828:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7829:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->session_negotiate != NULL )
 10684              		.loc 4 7829 12
 10685 0039 488B45E8 		movq	-24(%rbp), %rax
 10686 003d 488B4058 		movq	88(%rax), %rax
 10687              		.loc 4 7829 7
 10688 0041 4885C0   		testq	%rax, %rax
 10689 0044 740D     		je	.L605
7830:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ssl->session_negotiate->verify_result );
 10690              		.loc 4 7830 20
 10691 0046 488B45E8 		movq	-24(%rbp), %rax
 10692 004a 488B4058 		movq	88(%rax), %rax
 10693              		.loc 4 7830 39
 10694 004e 8B4068   		movl	104(%rax), %eax
 10695 0051 EB05     		jmp	.L604
 10696              	.L605:
7831:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7832:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0xFFFFFFFF );
 10697              		.loc 4 7832 11
 10698 0053 B8FFFFFF 		movl	$-1, %eax
 10698      FF
 10699              	.L604:
7833:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 10700              		.loc 4 7833 1
 10701 0058 488B55F8 		movq	-8(%rbp), %rdx
 10702 005c 64483314 		xorq	%fs:40, %rdx
 10702      25280000 
 10702      00
 10703 0065 7405     		je	.L606
 10704 0067 E8000000 		call	__stack_chk_fail@PLT
 10704      00
 10705              	.L606:
 10706 006c C9       		leave
 10707              	.LCFI281:
 10708              		.cfi_def_cfa 7, 8
 10709 006d C3       		ret
 10710              		.cfi_endproc
 10711              	.LFE112:
 10713              		.section	.text.mbedtls_ssl_get_ciphersuite,"ax",@progbits
 10714              		.globl	mbedtls_ssl_get_ciphersuite
 10716              	mbedtls_ssl_get_ciphersuite:
 10717              	.LFB113:
7834:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7835:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** const char *mbedtls_ssl_get_ciphersuite( const mbedtls_ssl_context *ssl )
7836:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 10718              		.loc 4 7836 1
 10719              		.cfi_startproc
 10720 0000 F30F1EFA 		endbr64
GAS LISTING /tmp/ccEn8xFO.s 			page 393


 10721 0004 55       		pushq	%rbp
 10722              	.LCFI282:
 10723              		.cfi_def_cfa_offset 16
 10724              		.cfi_offset 6, -16
 10725 0005 4889E5   		movq	%rsp, %rbp
 10726              	.LCFI283:
 10727              		.cfi_def_cfa_register 6
 10728 0008 4883EC20 		subq	$32, %rsp
 10729 000c 48897DE8 		movq	%rdi, -24(%rbp)
 10730              		.loc 4 7836 1
 10731 0010 64488B04 		movq	%fs:40, %rax
 10731      25280000 
 10731      00
 10732 0019 488945F8 		movq	%rax, -8(%rbp)
 10733 001d 31C0     		xorl	%eax, %eax
7837:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl == NULL || ssl->session == NULL )
 10734              		.loc 4 7837 7
 10735 001f 48837DE8 		cmpq	$0, -24(%rbp)
 10735      00
 10736 0024 740D     		je	.L608
 10737              		.loc 4 7837 27 discriminator 1
 10738 0026 488B45E8 		movq	-24(%rbp), %rax
 10739 002a 488B4050 		movq	80(%rax), %rax
 10740              		.loc 4 7837 21 discriminator 1
 10741 002e 4885C0   		testq	%rax, %rax
 10742 0031 7507     		jne	.L609
 10743              	.L608:
7838:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( NULL );
 10744              		.loc 4 7838 15
 10745 0033 B8000000 		movl	$0, %eax
 10745      00
 10746 0038 EB11     		jmp	.L610
 10747              	.L609:
7839:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7840:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return mbedtls_ssl_get_ciphersuite_name( ssl->session->ciphersuite );
 10748              		.loc 4 7840 49
 10749 003a 488B45E8 		movq	-24(%rbp), %rax
 10750 003e 488B4050 		movq	80(%rax), %rax
 10751              		.loc 4 7840 12
 10752 0042 8B00     		movl	(%rax), %eax
 10753 0044 89C7     		movl	%eax, %edi
 10754 0046 E8000000 		call	mbedtls_ssl_get_ciphersuite_name@PLT
 10754      00
 10755              	.L610:
7841:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 10756              		.loc 4 7841 1
 10757 004b 488B55F8 		movq	-8(%rbp), %rdx
 10758 004f 64483314 		xorq	%fs:40, %rdx
 10758      25280000 
 10758      00
 10759 0058 7405     		je	.L611
 10760 005a E8000000 		call	__stack_chk_fail@PLT
 10760      00
 10761              	.L611:
 10762 005f C9       		leave
 10763              	.LCFI284:
 10764              		.cfi_def_cfa 7, 8
GAS LISTING /tmp/ccEn8xFO.s 			page 394


 10765 0060 C3       		ret
 10766              		.cfi_endproc
 10767              	.LFE113:
 10769              		.section	.rodata
 10770              	.LC5:
 10771 0053 53534C76 		.string	"SSLv3.0"
 10771      332E3000 
 10772              	.LC6:
 10773 005b 544C5376 		.string	"TLSv1.0"
 10773      312E3000 
 10774              	.LC7:
 10775 0063 544C5376 		.string	"TLSv1.1"
 10775      312E3100 
 10776              	.LC8:
 10777 006b 544C5376 		.string	"TLSv1.2"
 10777      312E3200 
 10778              	.LC9:
 10779 0073 756E6B6E 		.string	"unknown"
 10779      6F776E00 
 10780              		.section	.text.mbedtls_ssl_get_version,"ax",@progbits
 10781              		.globl	mbedtls_ssl_get_version
 10783              	mbedtls_ssl_get_version:
 10784              	.LFB114:
7842:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7843:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** const char *mbedtls_ssl_get_version( const mbedtls_ssl_context *ssl )
7844:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 10785              		.loc 4 7844 1
 10786              		.cfi_startproc
 10787 0000 F30F1EFA 		endbr64
 10788 0004 55       		pushq	%rbp
 10789              	.LCFI285:
 10790              		.cfi_def_cfa_offset 16
 10791              		.cfi_offset 6, -16
 10792 0005 4889E5   		movq	%rsp, %rbp
 10793              	.LCFI286:
 10794              		.cfi_def_cfa_register 6
 10795 0008 4883EC20 		subq	$32, %rsp
 10796 000c 48897DE8 		movq	%rdi, -24(%rbp)
 10797              		.loc 4 7844 1
 10798 0010 64488B04 		movq	%fs:40, %rax
 10798      25280000 
 10798      00
 10799 0019 488945F8 		movq	%rax, -8(%rbp)
 10800 001d 31C0     		xorl	%eax, %eax
7845:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
7846:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
7847:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7848:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         switch( ssl->minor_ver )
7849:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
7850:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             case MBEDTLS_SSL_MINOR_VERSION_2:
7851:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( "DTLSv1.0" );
7852:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7853:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             case MBEDTLS_SSL_MINOR_VERSION_3:
7854:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( "DTLSv1.2" );
7855:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7856:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             default:
7857:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( "unknown (DTLS)" );
GAS LISTING /tmp/ccEn8xFO.s 			page 395


7858:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
7859:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7860:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
7861:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7862:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     switch( ssl->minor_ver )
 10801              		.loc 4 7862 16
 10802 001f 488B45E8 		movq	-24(%rbp), %rax
 10803 0023 8B4018   		movl	24(%rax), %eax
 10804              		.loc 4 7862 5
 10805 0026 83F803   		cmpl	$3, %eax
 10806 0029 7435     		je	.L613
 10807 002b 83F803   		cmpl	$3, %eax
 10808 002e 7F39     		jg	.L614
 10809 0030 83F802   		cmpl	$2, %eax
 10810 0033 7422     		je	.L615
 10811 0035 83F802   		cmpl	$2, %eax
 10812 0038 7F2F     		jg	.L614
 10813 003a 85C0     		testl	%eax, %eax
 10814 003c 7407     		je	.L616
 10815 003e 83F801   		cmpl	$1, %eax
 10816 0041 740B     		je	.L617
 10817 0043 EB24     		jmp	.L614
 10818              	.L616:
7863:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7864:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_SSL_MINOR_VERSION_0:
7865:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( "SSLv3.0" );
 10819              		.loc 4 7865 19
 10820 0045 488D0500 		leaq	.LC5(%rip), %rax
 10820      000000
 10821 004c EB22     		jmp	.L618
 10822              	.L617:
7866:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7867:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_SSL_MINOR_VERSION_1:
7868:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( "TLSv1.0" );
 10823              		.loc 4 7868 19
 10824 004e 488D0500 		leaq	.LC6(%rip), %rax
 10824      000000
 10825 0055 EB19     		jmp	.L618
 10826              	.L615:
7869:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7870:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_SSL_MINOR_VERSION_2:
7871:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( "TLSv1.1" );
 10827              		.loc 4 7871 19
 10828 0057 488D0500 		leaq	.LC7(%rip), %rax
 10828      000000
 10829 005e EB10     		jmp	.L618
 10830              	.L613:
7872:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7873:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_SSL_MINOR_VERSION_3:
7874:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( "TLSv1.2" );
 10831              		.loc 4 7874 19
 10832 0060 488D0500 		leaq	.LC8(%rip), %rax
 10832      000000
 10833 0067 EB07     		jmp	.L618
 10834              	.L614:
7875:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7876:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         default:
GAS LISTING /tmp/ccEn8xFO.s 			page 396


7877:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( "unknown" );
 10835              		.loc 4 7877 19
 10836 0069 488D0500 		leaq	.LC9(%rip), %rax
 10836      000000
 10837              	.L618:
7878:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7879:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 10838              		.loc 4 7879 1
 10839 0070 488B55F8 		movq	-8(%rbp), %rdx
 10840 0074 64483314 		xorq	%fs:40, %rdx
 10840      25280000 
 10840      00
 10841 007d 7405     		je	.L619
 10842 007f E8000000 		call	__stack_chk_fail@PLT
 10842      00
 10843              	.L619:
 10844 0084 C9       		leave
 10845              	.LCFI287:
 10846              		.cfi_def_cfa 7, 8
 10847 0085 C3       		ret
 10848              		.cfi_endproc
 10849              	.LFE114:
 10851              		.section	.text.mbedtls_ssl_get_record_expansion,"ax",@progbits
 10852              		.globl	mbedtls_ssl_get_record_expansion
 10854              	mbedtls_ssl_get_record_expansion:
 10855              	.LFB115:
7880:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7881:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_get_record_expansion( const mbedtls_ssl_context *ssl )
7882:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 10856              		.loc 4 7882 1
 10857              		.cfi_startproc
 10858 0000 F30F1EFA 		endbr64
 10859 0004 55       		pushq	%rbp
 10860              	.LCFI288:
 10861              		.cfi_def_cfa_offset 16
 10862              		.cfi_offset 6, -16
 10863 0005 4889E5   		movq	%rsp, %rbp
 10864              	.LCFI289:
 10865              		.cfi_def_cfa_register 6
 10866 0008 4883EC30 		subq	$48, %rsp
 10867 000c 48897DD8 		movq	%rdi, -40(%rbp)
 10868              		.loc 4 7882 1
 10869 0010 64488B04 		movq	%fs:40, %rax
 10869      25280000 
 10869      00
 10870 0019 488945F8 		movq	%rax, -8(%rbp)
 10871 001d 31C0     		xorl	%eax, %eax
7883:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t transform_expansion = 0;
 10872              		.loc 4 7883 12
 10873 001f 48C745E8 		movq	$0, -24(%rbp)
 10873      00000000 
7884:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const mbedtls_ssl_transform *transform = ssl->transform_out;
 10874              		.loc 4 7884 34
 10875 0027 488B45D8 		movq	-40(%rbp), %rax
 10876 002b 488B4070 		movq	112(%rax), %rax
 10877 002f 488945F0 		movq	%rax, -16(%rbp)
7885:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned block_size;
GAS LISTING /tmp/ccEn8xFO.s 			page 397


7886:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7887:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( transform == NULL )
 10878              		.loc 4 7887 7
 10879 0033 48837DF0 		cmpq	$0, -16(%rbp)
 10879      00
 10880 0038 7511     		jne	.L621
7888:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( (int) mbedtls_ssl_hdr_len( ssl ) );
 10881              		.loc 4 7888 23
 10882 003a 488B45D8 		movq	-40(%rbp), %rax
 10883 003e 4889C7   		movq	%rax, %rdi
 10884 0041 E8000000 		call	mbedtls_ssl_hdr_len
 10884      00
 10885              		.loc 4 7888 17
 10886 0046 E9910000 		jmp	.L622
 10886      00
 10887              	.L621:
7889:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7890:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_ZLIB_SUPPORT)
7891:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->session_out->compression != MBEDTLS_SSL_COMPRESS_NULL )
7892:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE );
7893:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
7894:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7895:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     switch( mbedtls_cipher_get_cipher_mode( &transform->cipher_ctx_enc ) )
 10888              		.loc 4 7895 13
 10889 004b 488B45F0 		movq	-16(%rbp), %rax
 10890 004f 4883E880 		subq	$-128, %rax
 10891 0053 4889C7   		movq	%rax, %rdi
 10892 0056 E8000000 		call	mbedtls_cipher_get_cipher_mode
 10892      00
 10893              		.loc 4 7895 5
 10894 005b 83F80A   		cmpl	$10, %eax
 10895 005e 7417     		je	.L623
 10896 0060 83F80A   		cmpl	$10, %eax
 10897 0063 775B     		ja	.L624
 10898 0065 83F802   		cmpl	$2, %eax
 10899 0068 741B     		je	.L625
 10900 006a 83F802   		cmpl	$2, %eax
 10901 006d 7251     		jb	.L624
 10902 006f 83E806   		subl	$6, %eax
 10903 0072 83F802   		cmpl	$2, %eax
 10904 0075 7749     		ja	.L624
 10905              	.L623:
7896:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7897:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_MODE_GCM:
7898:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_MODE_CCM:
7899:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_MODE_CHACHAPOLY:
7900:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_MODE_STREAM:
7901:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             transform_expansion = transform->minlen;
 10906              		.loc 4 7901 33
 10907 0077 488B45F0 		movq	-16(%rbp), %rax
 10908 007b 488B4010 		movq	16(%rax), %rax
 10909 007f 488945E8 		movq	%rax, -24(%rbp)
7902:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             break;
 10910              		.loc 4 7902 13
 10911 0083 EB43     		jmp	.L626
 10912              	.L625:
7903:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 398


7904:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_MODE_CBC:
7905:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7906:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             block_size = mbedtls_cipher_get_block_size(
 10913              		.loc 4 7906 26
 10914 0085 488B45F0 		movq	-16(%rbp), %rax
 10915 0089 4883E880 		subq	$-128, %rax
 10916 008d 4889C7   		movq	%rax, %rdi
 10917 0090 E8000000 		call	mbedtls_cipher_get_block_size
 10917      00
 10918 0095 8945E4   		movl	%eax, -28(%rbp)
7907:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 &transform->cipher_ctx_enc );
7908:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7909:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Expansion due to the addition of the MAC. */
7910:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             transform_expansion += transform->maclen;
 10919              		.loc 4 7910 45
 10920 0098 488B45F0 		movq	-16(%rbp), %rax
 10921 009c 488B4028 		movq	40(%rax), %rax
 10922              		.loc 4 7910 33
 10923 00a0 480145E8 		addq	%rax, -24(%rbp)
7911:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7912:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Expansion due to the addition of CBC padding;
7913:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * Theoretically up to 256 bytes, but we never use
7914:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * more than the block size of the underlying cipher. */
7915:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             transform_expansion += block_size;
 10924              		.loc 4 7915 33
 10925 00a4 8B45E4   		movl	-28(%rbp), %eax
 10926 00a7 480145E8 		addq	%rax, -24(%rbp)
7916:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7917:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* For TLS 1.1 or higher, an explicit IV is added
7918:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * after the record header. */
7919:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_1) || defined(MBEDTLS_SSL_PROTO_TLS1_2)
7920:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_2 )
 10927              		.loc 4 7920 20
 10928 00ab 488B45D8 		movq	-40(%rbp), %rax
 10929 00af 8B4018   		movl	24(%rax), %eax
 10930              		.loc 4 7920 15
 10931 00b2 83F801   		cmpl	$1, %eax
 10932 00b5 7E10     		jle	.L629
7921:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 transform_expansion += block_size;
 10933              		.loc 4 7921 37
 10934 00b7 8B45E4   		movl	-28(%rbp), %eax
 10935 00ba 480145E8 		addq	%rax, -24(%rbp)
7922:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_1 || MBEDTLS_SSL_PROTO_TLS1_2 */
7923:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7924:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             break;
 10936              		.loc 4 7924 13
 10937 00be EB07     		jmp	.L629
 10938              	.L624:
7925:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7926:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         default:
7927:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
7928:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 10939              		.loc 4 7928 19
 10940 00c0 B80094FF 		movl	$-27648, %eax
 10940      FF
 10941 00c5 EB15     		jmp	.L622
 10942              	.L629:
GAS LISTING /tmp/ccEn8xFO.s 			page 399


7924:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 10943              		.loc 4 7924 13
 10944 00c7 90       		nop
 10945              	.L626:
7929:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7930:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7931:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( (int)( mbedtls_ssl_hdr_len( ssl ) + transform_expansion ) );
 10946              		.loc 4 7931 20
 10947 00c8 488B45D8 		movq	-40(%rbp), %rax
 10948 00cc 4889C7   		movq	%rax, %rdi
 10949 00cf E8000000 		call	mbedtls_ssl_hdr_len
 10949      00
 10950              		.loc 4 7931 47
 10951 00d4 89C2     		movl	%eax, %edx
 10952 00d6 488B45E8 		movq	-24(%rbp), %rax
 10953 00da 01D0     		addl	%edx, %eax
 10954              	.L622:
7932:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 10955              		.loc 4 7932 1
 10956 00dc 488B4DF8 		movq	-8(%rbp), %rcx
 10957 00e0 6448330C 		xorq	%fs:40, %rcx
 10957      25280000 
 10957      00
 10958 00e9 7405     		je	.L628
 10959 00eb E8000000 		call	__stack_chk_fail@PLT
 10959      00
 10960              	.L628:
 10961 00f0 C9       		leave
 10962              	.LCFI290:
 10963              		.cfi_def_cfa 7, 8
 10964 00f1 C3       		ret
 10965              		.cfi_endproc
 10966              	.LFE115:
 10968              		.section	.text.mbedtls_ssl_get_max_frag_len,"ax",@progbits
 10969              		.globl	mbedtls_ssl_get_max_frag_len
 10971              	mbedtls_ssl_get_max_frag_len:
 10972              	.LFB116:
7933:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7934:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_MAX_FRAGMENT_LENGTH)
7935:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** size_t mbedtls_ssl_get_max_frag_len( const mbedtls_ssl_context *ssl )
7936:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 10973              		.loc 4 7936 1
 10974              		.cfi_startproc
 10975 0000 F30F1EFA 		endbr64
 10976 0004 55       		pushq	%rbp
 10977              	.LCFI291:
 10978              		.cfi_def_cfa_offset 16
 10979              		.cfi_offset 6, -16
 10980 0005 4889E5   		movq	%rsp, %rbp
 10981              	.LCFI292:
 10982              		.cfi_def_cfa_register 6
 10983 0008 4883EC20 		subq	$32, %rsp
 10984 000c 48897DE8 		movq	%rdi, -24(%rbp)
 10985              		.loc 4 7936 1
 10986 0010 64488B04 		movq	%fs:40, %rax
 10986      25280000 
 10986      00
GAS LISTING /tmp/ccEn8xFO.s 			page 400


 10987 0019 488945F8 		movq	%rax, -8(%rbp)
 10988 001d 31C0     		xorl	%eax, %eax
7937:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t max_len;
7938:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7939:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
7940:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Assume mfl_code is correct since it was checked when set
7941:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
7942:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     max_len = ssl_mfl_code_to_length( ssl->conf->mfl_code );
 10989              		.loc 4 7942 42
 10990 001f 488B45E8 		movq	-24(%rbp), %rax
 10991 0023 488B00   		movq	(%rax), %rax
 10992              		.loc 4 7942 48
 10993 0026 0FB780BC 		movzwl	188(%rax), %eax
 10993      000000
 10994 002d 66C1E806 		shrw	$6, %ax
 10995 0031 83E007   		andl	$7, %eax
 10996              		.loc 4 7942 15
 10997 0034 0FB6C0   		movzbl	%al, %eax
 10998 0037 89C7     		movl	%eax, %edi
 10999 0039 E8000000 		call	ssl_mfl_code_to_length
 10999      00
 11000              		.loc 4 7942 13
 11001 003e 89C0     		movl	%eax, %eax
 11002 0040 488945F0 		movq	%rax, -16(%rbp)
7943:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7944:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Check if a smaller max length was negotiated */
7945:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->session_out != NULL &&
 11003              		.loc 4 7945 12
 11004 0044 488B45E8 		movq	-24(%rbp), %rax
 11005 0048 488B4048 		movq	72(%rax), %rax
 11006              		.loc 4 7945 7
 11007 004c 4885C0   		testq	%rax, %rax
 11008 004f 7440     		je	.L631
7946:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl_mfl_code_to_length( ssl->session_out->mfl_code ) < max_len )
 11009              		.loc 4 7946 36 discriminator 1
 11010 0051 488B45E8 		movq	-24(%rbp), %rax
 11011 0055 488B4048 		movq	72(%rax), %rax
 11012              		.loc 4 7946 49 discriminator 1
 11013 0059 0FB68084 		movzbl	132(%rax), %eax
 11013      000000
 11014              		.loc 4 7946 9 discriminator 1
 11015 0060 0FB6C0   		movzbl	%al, %eax
 11016 0063 89C7     		movl	%eax, %edi
 11017 0065 E8000000 		call	ssl_mfl_code_to_length
 11017      00
 11018 006a 89C0     		movl	%eax, %eax
7945:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl_mfl_code_to_length( ssl->session_out->mfl_code ) < max_len )
 11019              		.loc 4 7945 34 discriminator 1
 11020 006c 483945F0 		cmpq	%rax, -16(%rbp)
 11021 0070 761F     		jbe	.L631
7947:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7948:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         max_len = ssl_mfl_code_to_length( ssl->session_out->mfl_code );
 11022              		.loc 4 7948 46
 11023 0072 488B45E8 		movq	-24(%rbp), %rax
 11024 0076 488B4048 		movq	72(%rax), %rax
 11025              		.loc 4 7948 59
 11026 007a 0FB68084 		movzbl	132(%rax), %eax
GAS LISTING /tmp/ccEn8xFO.s 			page 401


 11026      000000
 11027              		.loc 4 7948 19
 11028 0081 0FB6C0   		movzbl	%al, %eax
 11029 0084 89C7     		movl	%eax, %edi
 11030 0086 E8000000 		call	ssl_mfl_code_to_length
 11030      00
 11031              		.loc 4 7948 17
 11032 008b 89C0     		movl	%eax, %eax
 11033 008d 488945F0 		movq	%rax, -16(%rbp)
 11034              	.L631:
7949:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7950:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7951:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* During a handshake, use the value being negotiated */
7952:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->session_negotiate != NULL &&
 11035              		.loc 4 7952 12
 11036 0091 488B45E8 		movq	-24(%rbp), %rax
 11037 0095 488B4058 		movq	88(%rax), %rax
 11038              		.loc 4 7952 7
 11039 0099 4885C0   		testq	%rax, %rax
 11040 009c 7440     		je	.L632
7953:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl_mfl_code_to_length( ssl->session_negotiate->mfl_code ) < max_len )
 11041              		.loc 4 7953 36 discriminator 1
 11042 009e 488B45E8 		movq	-24(%rbp), %rax
 11043 00a2 488B4058 		movq	88(%rax), %rax
 11044              		.loc 4 7953 55 discriminator 1
 11045 00a6 0FB68084 		movzbl	132(%rax), %eax
 11045      000000
 11046              		.loc 4 7953 9 discriminator 1
 11047 00ad 0FB6C0   		movzbl	%al, %eax
 11048 00b0 89C7     		movl	%eax, %edi
 11049 00b2 E8000000 		call	ssl_mfl_code_to_length
 11049      00
 11050 00b7 89C0     		movl	%eax, %eax
7952:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl_mfl_code_to_length( ssl->session_negotiate->mfl_code ) < max_len )
 11051              		.loc 4 7952 40 discriminator 1
 11052 00b9 483945F0 		cmpq	%rax, -16(%rbp)
 11053 00bd 761F     		jbe	.L632
7954:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
7955:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         max_len = ssl_mfl_code_to_length( ssl->session_negotiate->mfl_code );
 11054              		.loc 4 7955 46
 11055 00bf 488B45E8 		movq	-24(%rbp), %rax
 11056 00c3 488B4058 		movq	88(%rax), %rax
 11057              		.loc 4 7955 65
 11058 00c7 0FB68084 		movzbl	132(%rax), %eax
 11058      000000
 11059              		.loc 4 7955 19
 11060 00ce 0FB6C0   		movzbl	%al, %eax
 11061 00d1 89C7     		movl	%eax, %edi
 11062 00d3 E8000000 		call	ssl_mfl_code_to_length
 11062      00
 11063              		.loc 4 7955 17
 11064 00d8 89C0     		movl	%eax, %eax
 11065 00da 488945F0 		movq	%rax, -16(%rbp)
 11066              	.L632:
7956:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
7957:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7958:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( max_len );
GAS LISTING /tmp/ccEn8xFO.s 			page 402


 11067              		.loc 4 7958 11
 11068 00de 488B45F0 		movq	-16(%rbp), %rax
7959:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 11069              		.loc 4 7959 1
 11070 00e2 488B55F8 		movq	-8(%rbp), %rdx
 11071 00e6 64483314 		xorq	%fs:40, %rdx
 11071      25280000 
 11071      00
 11072 00ef 7405     		je	.L634
 11073 00f1 E8000000 		call	__stack_chk_fail@PLT
 11073      00
 11074              	.L634:
 11075 00f6 C9       		leave
 11076              	.LCFI293:
 11077              		.cfi_def_cfa 7, 8
 11078 00f7 C3       		ret
 11079              		.cfi_endproc
 11080              	.LFE116:
 11082              		.section	.text.mbedtls_ssl_get_max_out_record_payload,"ax",@progbits
 11083              		.globl	mbedtls_ssl_get_max_out_record_payload
 11085              	mbedtls_ssl_get_max_out_record_payload:
 11086              	.LFB117:
7960:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_MAX_FRAGMENT_LENGTH */
7961:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7962:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
7963:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static size_t ssl_get_current_mtu( const mbedtls_ssl_context *ssl )
7964:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
7965:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Return unlimited mtu for client hello messages to avoid fragmentation. */
7966:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_CLIENT &&
7967:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ( ssl->state == MBEDTLS_SSL_CLIENT_HELLO ||
7968:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****           ssl->state == MBEDTLS_SSL_SERVER_HELLO ) )
7969:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return ( 0 );
7970:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7971:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->handshake == NULL || ssl->handshake->mtu == 0 )
7972:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ssl->mtu );
7973:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7974:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->mtu == 0 )
7975:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ssl->handshake->mtu );
7976:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7977:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ssl->mtu < ssl->handshake->mtu ?
7978:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->mtu : ssl->handshake->mtu );
7979:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
7980:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
7981:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7982:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_get_max_out_record_payload( const mbedtls_ssl_context *ssl )
7983:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 11087              		.loc 4 7983 1
 11088              		.cfi_startproc
 11089 0000 F30F1EFA 		endbr64
 11090 0004 55       		pushq	%rbp
 11091              	.LCFI294:
 11092              		.cfi_def_cfa_offset 16
 11093              		.cfi_offset 6, -16
 11094 0005 4889E5   		movq	%rsp, %rbp
 11095              	.LCFI295:
 11096              		.cfi_def_cfa_register 6
 11097 0008 4883EC30 		subq	$48, %rsp
GAS LISTING /tmp/ccEn8xFO.s 			page 403


 11098 000c 48897DD8 		movq	%rdi, -40(%rbp)
 11099              		.loc 4 7983 1
 11100 0010 64488B04 		movq	%fs:40, %rax
 11100      25280000 
 11100      00
 11101 0019 488945F8 		movq	%rax, -8(%rbp)
 11102 001d 31C0     		xorl	%eax, %eax
7984:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t max_len = MBEDTLS_SSL_OUT_CONTENT_LEN;
 11103              		.loc 4 7984 12
 11104 001f 48C745E8 		movq	$16000, -24(%rbp)
 11104      803E0000 
7985:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7986:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if !defined(MBEDTLS_SSL_MAX_FRAGMENT_LENGTH) && \
7987:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     !defined(MBEDTLS_SSL_PROTO_DTLS)
7988:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     (void) ssl;
7989:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
7990:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7991:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_MAX_FRAGMENT_LENGTH)
7992:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const size_t mfl = mbedtls_ssl_get_max_frag_len( ssl );
 11105              		.loc 4 7992 24
 11106 0027 488B45D8 		movq	-40(%rbp), %rax
 11107 002b 4889C7   		movq	%rax, %rdi
 11108 002e E8000000 		call	mbedtls_ssl_get_max_frag_len
 11108      00
 11109 0033 488945F0 		movq	%rax, -16(%rbp)
7993:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7994:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( max_len > mfl )
 11110              		.loc 4 7994 7
 11111 0037 488B45E8 		movq	-24(%rbp), %rax
 11112 003b 483B45F0 		cmpq	-16(%rbp), %rax
 11113 003f 7608     		jbe	.L636
7995:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         max_len = mfl;
 11114              		.loc 4 7995 17
 11115 0041 488B45F0 		movq	-16(%rbp), %rax
 11116 0045 488945E8 		movq	%rax, -24(%rbp)
 11117              	.L636:
7996:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
7997:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
7998:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
7999:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl_get_current_mtu( ssl ) != 0 )
8000:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8001:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         const size_t mtu = ssl_get_current_mtu( ssl );
8002:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         const int ret = mbedtls_ssl_get_record_expansion( ssl );
8003:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         const size_t overhead = (size_t) ret;
8004:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8005:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ret < 0 )
8006:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
8007:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8008:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( mtu <= overhead )
8009:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
8010:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "MTU too low for record expansion" ) );
8011:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE );
8012:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
8013:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8014:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( max_len > mtu - overhead )
8015:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             max_len = mtu - overhead;
8016:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
GAS LISTING /tmp/ccEn8xFO.s 			page 404


8017:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
8018:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8019:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if !defined(MBEDTLS_SSL_MAX_FRAGMENT_LENGTH) &&        \
8020:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     !defined(MBEDTLS_SSL_PROTO_DTLS)
8021:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ((void) ssl);
8022:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8023:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8024:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( (int) max_len );
 11118              		.loc 4 8024 13
 11119 0049 488B45E8 		movq	-24(%rbp), %rax
8025:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 11120              		.loc 4 8025 1
 11121 004d 488B55F8 		movq	-8(%rbp), %rdx
 11122 0051 64483314 		xorq	%fs:40, %rdx
 11122      25280000 
 11122      00
 11123 005a 7405     		je	.L638
 11124 005c E8000000 		call	__stack_chk_fail@PLT
 11124      00
 11125              	.L638:
 11126 0061 C9       		leave
 11127              	.LCFI296:
 11128              		.cfi_def_cfa 7, 8
 11129 0062 C3       		ret
 11130              		.cfi_endproc
 11131              	.LFE117:
 11133              		.section	.text.mbedtls_ssl_get_peer_cert,"ax",@progbits
 11134              		.globl	mbedtls_ssl_get_peer_cert
 11136              	mbedtls_ssl_get_peer_cert:
 11137              	.LFB118:
8026:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8027:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
8028:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** const mbedtls_x509_crt *mbedtls_ssl_get_peer_cert( const mbedtls_ssl_context *ssl )
8029:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 11138              		.loc 4 8029 1
 11139              		.cfi_startproc
 11140 0000 F30F1EFA 		endbr64
 11141 0004 55       		pushq	%rbp
 11142              	.LCFI297:
 11143              		.cfi_def_cfa_offset 16
 11144              		.cfi_offset 6, -16
 11145 0005 4889E5   		movq	%rsp, %rbp
 11146              	.LCFI298:
 11147              		.cfi_def_cfa_register 6
 11148 0008 4883EC20 		subq	$32, %rsp
 11149 000c 48897DE8 		movq	%rdi, -24(%rbp)
 11150              		.loc 4 8029 1
 11151 0010 64488B04 		movq	%fs:40, %rax
 11151      25280000 
 11151      00
 11152 0019 488945F8 		movq	%rax, -8(%rbp)
 11153 001d 31C0     		xorl	%eax, %eax
8030:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl == NULL || ssl->session == NULL )
 11154              		.loc 4 8030 7
 11155 001f 48837DE8 		cmpq	$0, -24(%rbp)
 11155      00
 11156 0024 740D     		je	.L640
GAS LISTING /tmp/ccEn8xFO.s 			page 405


 11157              		.loc 4 8030 27 discriminator 1
 11158 0026 488B45E8 		movq	-24(%rbp), %rax
 11159 002a 488B4050 		movq	80(%rax), %rax
 11160              		.loc 4 8030 21 discriminator 1
 11161 002e 4885C0   		testq	%rax, %rax
 11162 0031 7507     		jne	.L641
 11163              	.L640:
8031:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( NULL );
 11164              		.loc 4 8031 15
 11165 0033 B8000000 		movl	$0, %eax
 11165      00
 11166 0038 EB0C     		jmp	.L642
 11167              	.L641:
8032:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8033:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ssl->session->peer_cert );
 11168              		.loc 4 8033 16
 11169 003a 488B45E8 		movq	-24(%rbp), %rax
 11170 003e 488B4050 		movq	80(%rax), %rax
 11171              		.loc 4 8033 25
 11172 0042 488B4060 		movq	96(%rax), %rax
 11173              	.L642:
8034:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 11174              		.loc 4 8034 1
 11175 0046 488B55F8 		movq	-8(%rbp), %rdx
 11176 004a 64483314 		xorq	%fs:40, %rdx
 11176      25280000 
 11176      00
 11177 0053 7405     		je	.L643
 11178 0055 E8000000 		call	__stack_chk_fail@PLT
 11178      00
 11179              	.L643:
 11180 005a C9       		leave
 11181              	.LCFI299:
 11182              		.cfi_def_cfa 7, 8
 11183 005b C3       		ret
 11184              		.cfi_endproc
 11185              	.LFE118:
 11187              		.section	.text.mbedtls_ssl_get_session,"ax",@progbits
 11188              		.globl	mbedtls_ssl_get_session
 11190              	mbedtls_ssl_get_session:
 11191              	.LFB119:
8035:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
8036:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8037:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
8038:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_get_session( const mbedtls_ssl_context *ssl, mbedtls_ssl_session *dst )
8039:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 11192              		.loc 4 8039 1
 11193              		.cfi_startproc
 11194 0000 F30F1EFA 		endbr64
 11195 0004 55       		pushq	%rbp
 11196              	.LCFI300:
 11197              		.cfi_def_cfa_offset 16
 11198              		.cfi_offset 6, -16
 11199 0005 4889E5   		movq	%rsp, %rbp
 11200              	.LCFI301:
 11201              		.cfi_def_cfa_register 6
 11202 0008 4883EC20 		subq	$32, %rsp
GAS LISTING /tmp/ccEn8xFO.s 			page 406


 11203 000c 48897DE8 		movq	%rdi, -24(%rbp)
 11204 0010 488975E0 		movq	%rsi, -32(%rbp)
 11205              		.loc 4 8039 1
 11206 0014 64488B04 		movq	%fs:40, %rax
 11206      25280000 
 11206      00
 11207 001d 488945F8 		movq	%rax, -8(%rbp)
 11208 0021 31C0     		xorl	%eax, %eax
8040:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl == NULL ||
 11209              		.loc 4 8040 7
 11210 0023 48837DE8 		cmpq	$0, -24(%rbp)
 11210      00
 11211 0028 7429     		je	.L645
 11212              		.loc 4 8040 21 discriminator 1
 11213 002a 48837DE0 		cmpq	$0, -32(%rbp)
 11213      00
 11214 002f 7422     		je	.L645
8041:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         dst == NULL ||
8042:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->session == NULL ||
 11215              		.loc 4 8042 12
 11216 0031 488B45E8 		movq	-24(%rbp), %rax
 11217 0035 488B4050 		movq	80(%rax), %rax
8041:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         dst == NULL ||
 11218              		.loc 4 8041 21
 11219 0039 4885C0   		testq	%rax, %rax
 11220 003c 7415     		je	.L645
8043:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->conf->endpoint != MBEDTLS_SSL_IS_CLIENT )
 11221              		.loc 4 8043 12
 11222 003e 488B45E8 		movq	-24(%rbp), %rax
 11223 0042 488B00   		movq	(%rax), %rax
 11224              		.loc 4 8043 29
 11225 0045 0FB680BC 		movzbl	188(%rax), %eax
 11225      000000
 11226 004c 83E001   		andl	$1, %eax
8042:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->conf->endpoint != MBEDTLS_SSL_IS_CLIENT )
 11227              		.loc 4 8042 30
 11228 004f 84C0     		testb	%al, %al
 11229 0051 7407     		je	.L646
 11230              	.L645:
8044:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8045:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 11231              		.loc 4 8045 15
 11232 0053 B8008FFF 		movl	$-28928, %eax
 11232      FF
 11233 0058 EB17     		jmp	.L647
 11234              	.L646:
8046:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8047:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8048:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ssl_session_copy( dst, ssl->session ) );
 11235              		.loc 4 8048 39
 11236 005a 488B45E8 		movq	-24(%rbp), %rax
 11237 005e 488B5050 		movq	80(%rax), %rdx
 11238              		.loc 4 8048 13
 11239 0062 488B45E0 		movq	-32(%rbp), %rax
 11240 0066 4889D6   		movq	%rdx, %rsi
 11241 0069 4889C7   		movq	%rax, %rdi
 11242 006c E8000000 		call	ssl_session_copy
GAS LISTING /tmp/ccEn8xFO.s 			page 407


 11242      00
 11243              	.L647:
8049:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 11244              		.loc 4 8049 1
 11245 0071 488B4DF8 		movq	-8(%rbp), %rcx
 11246 0075 6448330C 		xorq	%fs:40, %rcx
 11246      25280000 
 11246      00
 11247 007e 7405     		je	.L648
 11248 0080 E8000000 		call	__stack_chk_fail@PLT
 11248      00
 11249              	.L648:
 11250 0085 C9       		leave
 11251              	.LCFI302:
 11252              		.cfi_def_cfa 7, 8
 11253 0086 C3       		ret
 11254              		.cfi_endproc
 11255              	.LFE119:
 11257              		.section	.text.mbedtls_ssl_handshake_step,"ax",@progbits
 11258              		.globl	mbedtls_ssl_handshake_step
 11260              	mbedtls_ssl_handshake_step:
 11261              	.LFB120:
8050:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_CLI_C */
8051:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8052:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
8053:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Perform a single step of the SSL handshake
8054:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
8055:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_handshake_step( mbedtls_ssl_context *ssl )
8056:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 11262              		.loc 4 8056 1
 11263              		.cfi_startproc
 11264 0000 F30F1EFA 		endbr64
 11265 0004 55       		pushq	%rbp
 11266              	.LCFI303:
 11267              		.cfi_def_cfa_offset 16
 11268              		.cfi_offset 6, -16
 11269 0005 4889E5   		movq	%rsp, %rbp
 11270              	.LCFI304:
 11271              		.cfi_def_cfa_register 6
 11272 0008 4883EC20 		subq	$32, %rsp
 11273 000c 48897DE8 		movq	%rdi, -24(%rbp)
 11274              		.loc 4 8056 1
 11275 0010 64488B04 		movq	%fs:40, %rax
 11275      25280000 
 11275      00
 11276 0019 488945F8 		movq	%rax, -8(%rbp)
 11277 001d 31C0     		xorl	%eax, %eax
8057:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret = MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE;
 11278              		.loc 4 8057 9
 11279 001f C745F480 		movl	$-28800, -12(%rbp)
 11279      8FFFFF
8058:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8059:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl == NULL || ssl->conf == NULL )
 11280              		.loc 4 8059 7
 11281 0026 48837DE8 		cmpq	$0, -24(%rbp)
 11281      00
 11282 002b 740C     		je	.L650
GAS LISTING /tmp/ccEn8xFO.s 			page 408


 11283              		.loc 4 8059 27 discriminator 1
 11284 002d 488B45E8 		movq	-24(%rbp), %rax
 11285 0031 488B00   		movq	(%rax), %rax
 11286              		.loc 4 8059 21 discriminator 1
 11287 0034 4885C0   		testq	%rax, %rax
 11288 0037 7507     		jne	.L651
 11289              	.L650:
8060:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 11290              		.loc 4 8060 15
 11291 0039 B8008FFF 		movl	$-28928, %eax
 11291      FF
 11292 003e EB27     		jmp	.L652
 11293              	.L651:
8061:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8062:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
8063:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_CLIENT )
 11294              		.loc 4 8063 12
 11295 0040 488B45E8 		movq	-24(%rbp), %rax
 11296 0044 488B00   		movq	(%rax), %rax
 11297              		.loc 4 8063 29
 11298 0047 0FB680BC 		movzbl	188(%rax), %eax
 11298      000000
 11299 004e 83E001   		andl	$1, %eax
 11300              		.loc 4 8063 7
 11301 0051 84C0     		testb	%al, %al
 11302 0053 750F     		jne	.L653
8064:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ret = mbedtls_ssl_handshake_client_step( ssl );
 11303              		.loc 4 8064 15
 11304 0055 488B45E8 		movq	-24(%rbp), %rax
 11305 0059 4889C7   		movq	%rax, %rdi
 11306 005c E8000000 		call	mbedtls_ssl_handshake_client_step@PLT
 11306      00
 11307 0061 8945F4   		movl	%eax, -12(%rbp)
 11308              	.L653:
8065:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8066:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
8067:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER )
8068:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ret = mbedtls_ssl_handshake_server_step( ssl );
8069:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8070:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8071:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ret );
 11309              		.loc 4 8071 11
 11310 0064 8B45F4   		movl	-12(%rbp), %eax
 11311              	.L652:
8072:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 11312              		.loc 4 8072 1
 11313 0067 488B55F8 		movq	-8(%rbp), %rdx
 11314 006b 64483314 		xorq	%fs:40, %rdx
 11314      25280000 
 11314      00
 11315 0074 7405     		je	.L654
 11316 0076 E8000000 		call	__stack_chk_fail@PLT
 11316      00
 11317              	.L654:
 11318 007b C9       		leave
 11319              	.LCFI305:
 11320              		.cfi_def_cfa 7, 8
GAS LISTING /tmp/ccEn8xFO.s 			page 409


 11321 007c C3       		ret
 11322              		.cfi_endproc
 11323              	.LFE120:
 11325              		.section	.text.mbedtls_ssl_handshake,"ax",@progbits
 11326              		.globl	mbedtls_ssl_handshake
 11328              	mbedtls_ssl_handshake:
 11329              	.LFB121:
8073:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8074:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
8075:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Perform the SSL handshake
8076:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
8077:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_handshake( mbedtls_ssl_context *ssl )
8078:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 11330              		.loc 4 8078 1
 11331              		.cfi_startproc
 11332 0000 F30F1EFA 		endbr64
 11333 0004 55       		pushq	%rbp
 11334              	.LCFI306:
 11335              		.cfi_def_cfa_offset 16
 11336              		.cfi_offset 6, -16
 11337 0005 4889E5   		movq	%rsp, %rbp
 11338              	.LCFI307:
 11339              		.cfi_def_cfa_register 6
 11340 0008 4883EC20 		subq	$32, %rsp
 11341 000c 48897DE8 		movq	%rdi, -24(%rbp)
 11342              		.loc 4 8078 1
 11343 0010 64488B04 		movq	%fs:40, %rax
 11343      25280000 
 11343      00
 11344 0019 488945F8 		movq	%rax, -8(%rbp)
 11345 001d 31C0     		xorl	%eax, %eax
8079:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret = 0;
 11346              		.loc 4 8079 9
 11347 001f C745F400 		movl	$0, -12(%rbp)
 11347      000000
8080:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8081:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl == NULL || ssl->conf == NULL )
 11348              		.loc 4 8081 7
 11349 0026 48837DE8 		cmpq	$0, -24(%rbp)
 11349      00
 11350 002b 740C     		je	.L656
 11351              		.loc 4 8081 27 discriminator 1
 11352 002d 488B45E8 		movq	-24(%rbp), %rax
 11353 0031 488B00   		movq	(%rax), %rax
 11354              		.loc 4 8081 21 discriminator 1
 11355 0034 4885C0   		testq	%rax, %rax
 11356 0037 751C     		jne	.L659
 11357              	.L656:
8082:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 11358              		.loc 4 8082 15
 11359 0039 B8008FFF 		movl	$-28928, %eax
 11359      FF
 11360 003e EB27     		jmp	.L658
 11361              	.L661:
8083:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8084:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> handshake" ) );
8085:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 410


8086:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     while( ssl->state != MBEDTLS_SSL_HANDSHAKE_OVER )
8087:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8088:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ret = mbedtls_ssl_handshake_step( ssl );
 11362              		.loc 4 8088 15
 11363 0040 488B45E8 		movq	-24(%rbp), %rax
 11364 0044 4889C7   		movq	%rax, %rdi
 11365 0047 E8000000 		call	mbedtls_ssl_handshake_step
 11365      00
 11366 004c 8945F4   		movl	%eax, -12(%rbp)
8089:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8090:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ret != 0 )
 11367              		.loc 4 8090 11
 11368 004f 837DF400 		cmpl	$0, -12(%rbp)
 11369 0053 750E     		jne	.L663
 11370              	.L659:
8086:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 11371              		.loc 4 8086 15
 11372 0055 488B45E8 		movq	-24(%rbp), %rax
 11373 0059 8B4008   		movl	8(%rax), %eax
8086:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 11374              		.loc 4 8086 10
 11375 005c 83F810   		cmpl	$16, %eax
 11376 005f 75DF     		jne	.L661
 11377 0061 EB01     		jmp	.L660
 11378              	.L663:
8091:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             break;
 11379              		.loc 4 8091 13
 11380 0063 90       		nop
 11381              	.L660:
8092:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8093:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8094:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= handshake" ) );
8095:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8096:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ret );
 11382              		.loc 4 8096 11
 11383 0064 8B45F4   		movl	-12(%rbp), %eax
 11384              	.L658:
8097:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 11385              		.loc 4 8097 1
 11386 0067 488B55F8 		movq	-8(%rbp), %rdx
 11387 006b 64483314 		xorq	%fs:40, %rdx
 11387      25280000 
 11387      00
 11388 0074 7405     		je	.L662
 11389 0076 E8000000 		call	__stack_chk_fail@PLT
 11389      00
 11390              	.L662:
 11391 007b C9       		leave
 11392              	.LCFI308:
 11393              		.cfi_def_cfa 7, 8
 11394 007c C3       		ret
 11395              		.cfi_endproc
 11396              	.LFE121:
 11398              		.section	.text.ssl_start_renegotiation,"ax",@progbits
 11400              	ssl_start_renegotiation:
 11401              	.LFB122:
8098:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 411


8099:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
8100:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
8101:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
8102:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Write HelloRequest to request renegotiation on server
8103:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
8104:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_write_hello_request( mbedtls_ssl_context *ssl )
8105:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
8106:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
8107:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8108:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> write hello request" ) );
8109:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8110:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_msglen  = 4;
8111:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_msgtype = MBEDTLS_SSL_MSG_HANDSHAKE;
8112:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->out_msg[0]  = MBEDTLS_SSL_HS_HELLO_REQUEST;
8113:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8114:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_ssl_write_handshake_msg( ssl ) ) != 0 )
8115:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8116:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_write_handshake_msg", ret );
8117:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
8118:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8119:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8120:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= write hello request" ) );
8121:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8122:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
8123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
8124:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_SRV_C */
8125:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8126:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
8127:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Actually renegotiate current connection, triggered by either:
8128:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * - any side: calling mbedtls_ssl_renegotiate(),
8129:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * - client: receiving a HelloRequest during mbedtls_ssl_read(),
8130:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * - server: receiving any handshake message on server during mbedtls_ssl_read() after
8131:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *   the initial handshake is completed.
8132:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * If the handshake doesn't complete due to waiting for I/O, it will continue
8133:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * during the next calls to mbedtls_ssl_renegotiate() or mbedtls_ssl_read() respectively.
8134:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
8135:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_start_renegotiation( mbedtls_ssl_context *ssl )
8136:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 11402              		.loc 4 8136 1
 11403              		.cfi_startproc
 11404 0000 F30F1EFA 		endbr64
 11405 0004 55       		pushq	%rbp
 11406              	.LCFI309:
 11407              		.cfi_def_cfa_offset 16
 11408              		.cfi_offset 6, -16
 11409 0005 4889E5   		movq	%rsp, %rbp
 11410              	.LCFI310:
 11411              		.cfi_def_cfa_register 6
 11412 0008 4883EC20 		subq	$32, %rsp
 11413 000c 48897DE8 		movq	%rdi, -24(%rbp)
 11414              		.loc 4 8136 1
 11415 0010 64488B04 		movq	%fs:40, %rax
 11415      25280000 
 11415      00
 11416 0019 488945F8 		movq	%rax, -8(%rbp)
 11417 001d 31C0     		xorl	%eax, %eax
8137:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
GAS LISTING /tmp/ccEn8xFO.s 			page 412


8138:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8139:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> renegotiate" ) );
8140:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8141:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = ssl_handshake_init( ssl ) ) != 0 )
 11418              		.loc 4 8141 17
 11419 001f 488B45E8 		movq	-24(%rbp), %rax
 11420 0023 4889C7   		movq	%rax, %rdi
 11421 0026 E8000000 		call	ssl_handshake_init
 11421      00
 11422 002b 8945F4   		movl	%eax, -12(%rbp)
 11423              		.loc 4 8141 7
 11424 002e 837DF400 		cmpl	$0, -12(%rbp)
 11425 0032 7405     		je	.L665
8142:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 11426              		.loc 4 8142 15
 11427 0034 8B45F4   		movl	-12(%rbp), %eax
 11428 0037 EB35     		jmp	.L666
 11429              	.L665:
8143:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8144:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* RFC 6347 4.2.2: "[...] the HelloRequest will have message_seq = 0 and
8145:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * the ServerHello will have message_seq = 1" */
8146:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
8147:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
8148:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->renego_status == MBEDTLS_SSL_RENEGOTIATION_PENDING )
8149:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8150:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER )
8151:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->handshake->out_msg_seq = 1;
8152:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else
8153:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->handshake->in_msg_seq = 1;
8154:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8155:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8156:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8157:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->state = MBEDTLS_SSL_HELLO_REQUEST;
 11430              		.loc 4 8157 16
 11431 0039 488B45E8 		movq	-24(%rbp), %rax
 11432 003d C7400800 		movl	$0, 8(%rax)
 11432      000000
8158:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->renego_status = MBEDTLS_SSL_RENEGOTIATION_IN_PROGRESS;
 11433              		.loc 4 8158 24
 11434 0044 488B45E8 		movq	-24(%rbp), %rax
 11435 0048 C7400C01 		movl	$1, 12(%rax)
 11435      000000
8159:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8160:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_ssl_handshake( ssl ) ) != 0 )
 11436              		.loc 4 8160 17
 11437 004f 488B45E8 		movq	-24(%rbp), %rax
 11438 0053 4889C7   		movq	%rax, %rdi
 11439 0056 E8000000 		call	mbedtls_ssl_handshake
 11439      00
 11440 005b 8945F4   		movl	%eax, -12(%rbp)
 11441              		.loc 4 8160 7
 11442 005e 837DF400 		cmpl	$0, -12(%rbp)
 11443 0062 7405     		je	.L667
8161:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8162:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_handshake", ret );
8163:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 11444              		.loc 4 8163 15
GAS LISTING /tmp/ccEn8xFO.s 			page 413


 11445 0064 8B45F4   		movl	-12(%rbp), %eax
 11446 0067 EB05     		jmp	.L666
 11447              	.L667:
8164:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8165:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8166:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= renegotiate" ) );
8167:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8168:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 11448              		.loc 4 8168 11
 11449 0069 B8000000 		movl	$0, %eax
 11449      00
 11450              	.L666:
8169:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 11451              		.loc 4 8169 1
 11452 006e 488B55F8 		movq	-8(%rbp), %rdx
 11453 0072 64483314 		xorq	%fs:40, %rdx
 11453      25280000 
 11453      00
 11454 007b 7405     		je	.L668
 11455 007d E8000000 		call	__stack_chk_fail@PLT
 11455      00
 11456              	.L668:
 11457 0082 C9       		leave
 11458              	.LCFI311:
 11459              		.cfi_def_cfa 7, 8
 11460 0083 C3       		ret
 11461              		.cfi_endproc
 11462              	.LFE122:
 11464              		.section	.text.mbedtls_ssl_renegotiate,"ax",@progbits
 11465              		.globl	mbedtls_ssl_renegotiate
 11467              	mbedtls_ssl_renegotiate:
 11468              	.LFB123:
8170:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8171:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
8172:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Renegotiate current connection on client,
8173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * or request renegotiation on server
8174:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
8175:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_renegotiate( mbedtls_ssl_context *ssl )
8176:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 11469              		.loc 4 8176 1
 11470              		.cfi_startproc
 11471 0000 F30F1EFA 		endbr64
 11472 0004 55       		pushq	%rbp
 11473              	.LCFI312:
 11474              		.cfi_def_cfa_offset 16
 11475              		.cfi_offset 6, -16
 11476 0005 4889E5   		movq	%rsp, %rbp
 11477              	.LCFI313:
 11478              		.cfi_def_cfa_register 6
 11479 0008 4883EC20 		subq	$32, %rsp
 11480 000c 48897DE8 		movq	%rdi, -24(%rbp)
 11481              		.loc 4 8176 1
 11482 0010 64488B04 		movq	%fs:40, %rax
 11482      25280000 
 11482      00
 11483 0019 488945F8 		movq	%rax, -8(%rbp)
 11484 001d 31C0     		xorl	%eax, %eax
GAS LISTING /tmp/ccEn8xFO.s 			page 414


8177:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret = MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE;
 11485              		.loc 4 8177 9
 11486 001f C745F480 		movl	$-28800, -12(%rbp)
 11486      8FFFFF
8178:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8179:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl == NULL || ssl->conf == NULL )
 11487              		.loc 4 8179 7
 11488 0026 48837DE8 		cmpq	$0, -24(%rbp)
 11488      00
 11489 002b 740C     		je	.L670
 11490              		.loc 4 8179 27 discriminator 1
 11491 002d 488B45E8 		movq	-24(%rbp), %rax
 11492 0031 488B00   		movq	(%rax), %rax
 11493              		.loc 4 8179 21 discriminator 1
 11494 0034 4885C0   		testq	%rax, %rax
 11495 0037 7507     		jne	.L671
 11496              	.L670:
8180:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 11497              		.loc 4 8180 15
 11498 0039 B8008FFF 		movl	$-28928, %eax
 11498      FF
 11499 003e EB56     		jmp	.L672
 11500              	.L671:
8181:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8182:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
8183:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* On server, just send the request */
8184:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER )
8185:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8186:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->state != MBEDTLS_SSL_HANDSHAKE_OVER )
8187:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
8188:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8189:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->renego_status = MBEDTLS_SSL_RENEGOTIATION_PENDING;
8190:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8191:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Did we already try/start sending HelloRequest? */
8192:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->out_left != 0 )
8193:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( mbedtls_ssl_flush_output( ssl ) );
8194:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8195:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ssl_write_hello_request( ssl ) );
8196:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8197:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_SRV_C */
8198:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8199:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
8200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
8201:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * On client, either start the renegotiation process or,
8202:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * if already in progress, continue the handshake
8203:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
8204:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->renego_status != MBEDTLS_SSL_RENEGOTIATION_IN_PROGRESS )
 11501              		.loc 4 8204 12
 11502 0040 488B45E8 		movq	-24(%rbp), %rax
 11503 0044 8B400C   		movl	12(%rax), %eax
 11504              		.loc 4 8204 7
 11505 0047 83F801   		cmpl	$1, %eax
 11506 004a 742D     		je	.L673
8205:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8206:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->state != MBEDTLS_SSL_HANDSHAKE_OVER )
 11507              		.loc 4 8206 16
 11508 004c 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 415


 11509 0050 8B4008   		movl	8(%rax), %eax
 11510              		.loc 4 8206 11
 11511 0053 83F810   		cmpl	$16, %eax
 11512 0056 7407     		je	.L674
8207:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 11513              		.loc 4 8207 19
 11514 0058 B8008FFF 		movl	$-28928, %eax
 11514      FF
 11515 005d EB37     		jmp	.L672
 11516              	.L674:
8208:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8209:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = ssl_start_renegotiation( ssl ) ) != 0 )
 11517              		.loc 4 8209 21
 11518 005f 488B45E8 		movq	-24(%rbp), %rax
 11519 0063 4889C7   		movq	%rax, %rdi
 11520 0066 E8000000 		call	ssl_start_renegotiation
 11520      00
 11521 006b 8945F4   		movl	%eax, -12(%rbp)
 11522              		.loc 4 8209 11
 11523 006e 837DF400 		cmpl	$0, -12(%rbp)
 11524 0072 741F     		je	.L675
8210:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
8211:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "ssl_start_renegotiation", ret );
8212:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 11525              		.loc 4 8212 19
 11526 0074 8B45F4   		movl	-12(%rbp), %eax
 11527 0077 EB1D     		jmp	.L672
 11528              	.L673:
8213:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
8214:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8215:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
8216:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8217:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_ssl_handshake( ssl ) ) != 0 )
 11529              		.loc 4 8217 21
 11530 0079 488B45E8 		movq	-24(%rbp), %rax
 11531 007d 4889C7   		movq	%rax, %rdi
 11532 0080 E8000000 		call	mbedtls_ssl_handshake
 11532      00
 11533 0085 8945F4   		movl	%eax, -12(%rbp)
 11534              		.loc 4 8217 11
 11535 0088 837DF400 		cmpl	$0, -12(%rbp)
 11536 008c 7405     		je	.L675
8218:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
8219:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_handshake", ret );
8220:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 11537              		.loc 4 8220 19
 11538 008e 8B45F4   		movl	-12(%rbp), %eax
 11539 0091 EB03     		jmp	.L672
 11540              	.L675:
8221:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
8222:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8223:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_CLI_C */
8224:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8225:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ret );
 11541              		.loc 4 8225 11
 11542 0093 8B45F4   		movl	-12(%rbp), %eax
 11543              	.L672:
GAS LISTING /tmp/ccEn8xFO.s 			page 416


8226:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 11544              		.loc 4 8226 1
 11545 0096 488B55F8 		movq	-8(%rbp), %rdx
 11546 009a 64483314 		xorq	%fs:40, %rdx
 11546      25280000 
 11546      00
 11547 00a3 7405     		je	.L676
 11548 00a5 E8000000 		call	__stack_chk_fail@PLT
 11548      00
 11549              	.L676:
 11550 00aa C9       		leave
 11551              	.LCFI314:
 11552              		.cfi_def_cfa 7, 8
 11553 00ab C3       		ret
 11554              		.cfi_endproc
 11555              	.LFE123:
 11557              		.section	.text.ssl_check_ctr_renegotiate,"ax",@progbits
 11559              	ssl_check_ctr_renegotiate:
 11560              	.LFB124:
8227:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8228:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
8229:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Check record counters and renegotiate if they're above the limit.
8230:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
8231:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_check_ctr_renegotiate( mbedtls_ssl_context *ssl )
8232:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 11561              		.loc 4 8232 1
 11562              		.cfi_startproc
 11563 0000 F30F1EFA 		endbr64
 11564 0004 55       		pushq	%rbp
 11565              	.LCFI315:
 11566              		.cfi_def_cfa_offset 16
 11567              		.cfi_offset 6, -16
 11568 0005 4889E5   		movq	%rsp, %rbp
 11569              	.LCFI316:
 11570              		.cfi_def_cfa_register 6
 11571 0008 4883EC30 		subq	$48, %rsp
 11572 000c 48897DD8 		movq	%rdi, -40(%rbp)
 11573              		.loc 4 8232 1
 11574 0010 64488B04 		movq	%fs:40, %rax
 11574      25280000 
 11574      00
 11575 0019 488945F8 		movq	%rax, -8(%rbp)
 11576 001d 31C0     		xorl	%eax, %eax
8233:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t ep_len = ssl_ep_len( ssl );
 11577              		.loc 4 8233 21
 11578 001f 488B45D8 		movq	-40(%rbp), %rax
 11579 0023 4889C7   		movq	%rax, %rdi
 11580 0026 E8000000 		call	ssl_ep_len
 11580      00
 11581 002b 488945F0 		movq	%rax, -16(%rbp)
8234:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int in_ctr_cmp;
8235:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int out_ctr_cmp;
8236:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8237:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->state != MBEDTLS_SSL_HANDSHAKE_OVER ||
 11582              		.loc 4 8237 12
 11583 002f 488B45D8 		movq	-40(%rbp), %rax
 11584 0033 8B4008   		movl	8(%rax), %eax
GAS LISTING /tmp/ccEn8xFO.s 			page 417


 11585              		.loc 4 8237 7
 11586 0036 83F810   		cmpl	$16, %eax
 11587 0039 7521     		jne	.L678
8238:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->renego_status == MBEDTLS_SSL_RENEGOTIATION_PENDING ||
 11588              		.loc 4 8238 12 discriminator 1
 11589 003b 488B45D8 		movq	-40(%rbp), %rax
 11590 003f 8B400C   		movl	12(%rax), %eax
8237:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->renego_status == MBEDTLS_SSL_RENEGOTIATION_PENDING ||
 11591              		.loc 4 8237 50 discriminator 1
 11592 0042 83F803   		cmpl	$3, %eax
 11593 0045 7415     		je	.L678
8239:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->conf->disable_renegotiation == MBEDTLS_SSL_RENEGOTIATION_DISABLED )
 11594              		.loc 4 8239 12
 11595 0047 488B45D8 		movq	-40(%rbp), %rax
 11596 004b 488B00   		movq	(%rax), %rax
 11597              		.loc 4 8239 42
 11598 004e 0FB680BD 		movzbl	189(%rax), %eax
 11598      000000
 11599 0055 83E004   		andl	$4, %eax
8238:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->renego_status == MBEDTLS_SSL_RENEGOTIATION_PENDING ||
 11600              		.loc 4 8238 65
 11601 0058 84C0     		testb	%al, %al
 11602 005a 750A     		jne	.L679
 11603              	.L678:
8240:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8241:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
 11604              		.loc 4 8241 15
 11605 005c B8000000 		movl	$0, %eax
 11605      00
 11606 0061 E99D0000 		jmp	.L680
 11606      00
 11607              	.L679:
8242:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8243:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8244:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     in_ctr_cmp = memcmp( ssl->in_ctr + ep_len,
 11608              		.loc 4 8244 18
 11609 0066 B8080000 		movl	$8, %eax
 11609      00
 11610 006b 482B45F0 		subq	-16(%rbp), %rax
8245:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         ssl->conf->renego_period + ep_len, 8 - ep_len );
 11611              		.loc 4 8245 28
 11612 006f 488B55D8 		movq	-40(%rbp), %rdx
 11613 0073 488B12   		movq	(%rdx), %rdx
 11614              		.loc 4 8245 25
 11615 0076 488D8AB0 		leaq	176(%rdx), %rcx
 11615      000000
8244:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         ssl->conf->renego_period + ep_len, 8 - ep_len );
 11616              		.loc 4 8244 18
 11617 007d 488B55F0 		movq	-16(%rbp), %rdx
 11618 0081 488D3411 		leaq	(%rcx,%rdx), %rsi
8244:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         ssl->conf->renego_period + ep_len, 8 - ep_len );
 11619              		.loc 4 8244 29
 11620 0085 488B55D8 		movq	-40(%rbp), %rdx
 11621 0089 488B8AA8 		movq	168(%rdx), %rcx
 11621      000000
8244:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         ssl->conf->renego_period + ep_len, 8 - ep_len );
 11622              		.loc 4 8244 38
GAS LISTING /tmp/ccEn8xFO.s 			page 418


 11623 0090 488B55F0 		movq	-16(%rbp), %rdx
 11624 0094 4801D1   		addq	%rdx, %rcx
8244:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         ssl->conf->renego_period + ep_len, 8 - ep_len );
 11625              		.loc 4 8244 18
 11626 0097 4889C2   		movq	%rax, %rdx
 11627 009a 4889CF   		movq	%rcx, %rdi
 11628 009d E8000000 		call	memcmp@PLT
 11628      00
 11629 00a2 8945E8   		movl	%eax, -24(%rbp)
8246:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     out_ctr_cmp = memcmp( ssl->cur_out_ctr + ep_len,
 11630              		.loc 4 8246 19
 11631 00a5 B8080000 		movl	$8, %eax
 11631      00
 11632 00aa 482B45F0 		subq	-16(%rbp), %rax
8247:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                           ssl->conf->renego_period + ep_len, 8 - ep_len );
 11633              		.loc 4 8247 30
 11634 00ae 488B55D8 		movq	-40(%rbp), %rdx
 11635 00b2 488B12   		movq	(%rdx), %rdx
 11636              		.loc 4 8247 27
 11637 00b5 488D8AB0 		leaq	176(%rdx), %rcx
 11637      000000
8246:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     out_ctr_cmp = memcmp( ssl->cur_out_ctr + ep_len,
 11638              		.loc 4 8246 19
 11639 00bc 488B55F0 		movq	-16(%rbp), %rdx
 11640 00c0 488D3411 		leaq	(%rcx,%rdx), %rsi
8246:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     out_ctr_cmp = memcmp( ssl->cur_out_ctr + ep_len,
 11641              		.loc 4 8246 27
 11642 00c4 488B55D8 		movq	-40(%rbp), %rdx
 11643 00c8 488D8A48 		leaq	328(%rdx), %rcx
 11643      010000
8246:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     out_ctr_cmp = memcmp( ssl->cur_out_ctr + ep_len,
 11644              		.loc 4 8246 19
 11645 00cf 488B55F0 		movq	-16(%rbp), %rdx
 11646 00d3 4801D1   		addq	%rdx, %rcx
 11647 00d6 4889C2   		movq	%rax, %rdx
 11648 00d9 4889CF   		movq	%rcx, %rdi
 11649 00dc E8000000 		call	memcmp@PLT
 11649      00
 11650 00e1 8945EC   		movl	%eax, -20(%rbp)
8248:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8249:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( in_ctr_cmp <= 0 && out_ctr_cmp <= 0 )
 11651              		.loc 4 8249 7
 11652 00e4 837DE800 		cmpl	$0, -24(%rbp)
 11653 00e8 7F0D     		jg	.L681
 11654              		.loc 4 8249 25 discriminator 1
 11655 00ea 837DEC00 		cmpl	$0, -20(%rbp)
 11656 00ee 7F07     		jg	.L681
8250:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8251:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( 0 );
 11657              		.loc 4 8251 15
 11658 00f0 B8000000 		movl	$0, %eax
 11658      00
 11659 00f5 EB0C     		jmp	.L680
 11660              	.L681:
8252:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8253:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8254:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 1, ( "record counter limit reached: renegotiate" ) );
GAS LISTING /tmp/ccEn8xFO.s 			page 419


8255:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( mbedtls_ssl_renegotiate( ssl ) );
 11661              		.loc 4 8255 13
 11662 00f7 488B45D8 		movq	-40(%rbp), %rax
 11663 00fb 4889C7   		movq	%rax, %rdi
 11664 00fe E8000000 		call	mbedtls_ssl_renegotiate
 11664      00
 11665              	.L680:
8256:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 11666              		.loc 4 8256 1
 11667 0103 488B7DF8 		movq	-8(%rbp), %rdi
 11668 0107 6448333C 		xorq	%fs:40, %rdi
 11668      25280000 
 11668      00
 11669 0110 7405     		je	.L682
 11670 0112 E8000000 		call	__stack_chk_fail@PLT
 11670      00
 11671              	.L682:
 11672 0117 C9       		leave
 11673              	.LCFI317:
 11674              		.cfi_def_cfa 7, 8
 11675 0118 C3       		ret
 11676              		.cfi_endproc
 11677              	.LFE124:
 11679              		.section	.text.mbedtls_ssl_read,"ax",@progbits
 11680              		.globl	mbedtls_ssl_read
 11682              	mbedtls_ssl_read:
 11683              	.LFB125:
8257:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_RENEGOTIATION */
8258:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8259:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
8260:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Receive application data decrypted from the SSL layer
8261:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
8262:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_read( mbedtls_ssl_context *ssl, unsigned char *buf, size_t len )
8263:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 11684              		.loc 4 8263 1
 11685              		.cfi_startproc
 11686 0000 F30F1EFA 		endbr64
 11687 0004 55       		pushq	%rbp
 11688              	.LCFI318:
 11689              		.cfi_def_cfa_offset 16
 11690              		.cfi_offset 6, -16
 11691 0005 4889E5   		movq	%rsp, %rbp
 11692              	.LCFI319:
 11693              		.cfi_def_cfa_register 6
 11694 0008 53       		pushq	%rbx
 11695 0009 4883EC48 		subq	$72, %rsp
 11696              		.cfi_offset 3, -24
 11697 000d 48897DC8 		movq	%rdi, -56(%rbp)
 11698 0011 488975C0 		movq	%rsi, -64(%rbp)
 11699 0015 488955B8 		movq	%rdx, -72(%rbp)
 11700              		.loc 4 8263 1
 11701 0019 64488B04 		movq	%fs:40, %rax
 11701      25280000 
 11701      00
 11702 0022 488945E8 		movq	%rax, -24(%rbp)
 11703 0026 31C0     		xorl	%eax, %eax
8264:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
GAS LISTING /tmp/ccEn8xFO.s 			page 420


8265:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t n;
8266:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8267:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl == NULL || ssl->conf == NULL )
 11704              		.loc 4 8267 7
 11705 0028 48837DC8 		cmpq	$0, -56(%rbp)
 11705      00
 11706 002d 740C     		je	.L684
 11707              		.loc 4 8267 27 discriminator 1
 11708 002f 488B45C8 		movq	-56(%rbp), %rax
 11709 0033 488B00   		movq	(%rax), %rax
 11710              		.loc 4 8267 21 discriminator 1
 11711 0036 4885C0   		testq	%rax, %rax
 11712 0039 750A     		jne	.L685
 11713              	.L684:
8268:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 11714              		.loc 4 8268 15
 11715 003b B8008FFF 		movl	$-28928, %eax
 11715      FF
 11716 0040 E9A80300 		jmp	.L686
 11716      00
 11717              	.L685:
8269:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8270:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> read" ) );
8271:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8272:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
8273:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
8274:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8275:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_ssl_flush_output( ssl ) ) != 0 )
8276:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
8277:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8278:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->handshake != NULL &&
8279:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->handshake->retransmit_state == MBEDTLS_SSL_RETRANS_SENDING )
8280:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
8281:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ( ret = mbedtls_ssl_flight_transmit( ssl ) ) != 0 )
8282:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( ret );
8283:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
8284:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8285:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8286:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8287:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
8288:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Check if renegotiation is necessary and/or handshake is
8289:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * in process. If yes, perform/continue, and fall through
8290:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * if an unexpected packet is received while the client
8291:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * is waiting for the ServerHello.
8292:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *
8293:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * (There is no equivalent to the last condition on
8294:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *  the server-side as it is not treated as within
8295:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *  a handshake while waiting for the ClientHello
8296:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *  after a renegotiation request.)
8297:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
8298:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8299:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
8300:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ret = ssl_check_ctr_renegotiate( ssl );
 11718              		.loc 4 8300 11
 11719 0045 488B45C8 		movq	-56(%rbp), %rax
 11720 0049 4889C7   		movq	%rax, %rdi
 11721 004c E8000000 		call	ssl_check_ctr_renegotiate
GAS LISTING /tmp/ccEn8xFO.s 			page 421


 11721      00
 11722 0051 8945DC   		movl	%eax, -36(%rbp)
8301:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ret != MBEDTLS_ERR_SSL_WAITING_SERVER_HELLO_RENEGO &&
 11723              		.loc 4 8301 7
 11724 0054 817DDC00 		cmpl	$-27392, -36(%rbp)
 11724      95FFFF
 11725 005b 740E     		je	.L687
 11726              		.loc 4 8301 60 discriminator 1
 11727 005d 837DDC00 		cmpl	$0, -36(%rbp)
 11728 0061 7408     		je	.L687
8302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ret != 0 )
8303:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8304:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "ssl_check_ctr_renegotiate", ret );
8305:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 11729              		.loc 4 8305 15
 11730 0063 8B45DC   		movl	-36(%rbp), %eax
 11731 0066 E9820300 		jmp	.L686
 11731      00
 11732              	.L687:
8306:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8307:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8308:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8309:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->state != MBEDTLS_SSL_HANDSHAKE_OVER )
 11733              		.loc 4 8309 12
 11734 006b 488B45C8 		movq	-56(%rbp), %rax
 11735 006f 8B4008   		movl	8(%rax), %eax
 11736              		.loc 4 8309 7
 11737 0072 83F810   		cmpl	$16, %eax
 11738 0075 0F84BB02 		je	.L689
 11738      0000
8310:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8311:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ret = mbedtls_ssl_handshake( ssl );
 11739              		.loc 4 8311 15
 11740 007b 488B45C8 		movq	-56(%rbp), %rax
 11741 007f 4889C7   		movq	%rax, %rdi
 11742 0082 E8000000 		call	mbedtls_ssl_handshake
 11742      00
 11743 0087 8945DC   		movl	%eax, -36(%rbp)
8312:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ret != MBEDTLS_ERR_SSL_WAITING_SERVER_HELLO_RENEGO &&
 11744              		.loc 4 8312 11
 11745 008a 817DDC00 		cmpl	$-27392, -36(%rbp)
 11745      95FFFF
 11746 0091 0F849F02 		je	.L689
 11746      0000
 11747              		.loc 4 8312 64 discriminator 1
 11748 0097 837DDC00 		cmpl	$0, -36(%rbp)
 11749 009b 0F849502 		je	.L689
 11749      0000
8313:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ret != 0 )
8314:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
8315:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_handshake", ret );
8316:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 11750              		.loc 4 8316 19
 11751 00a1 8B45DC   		movl	-36(%rbp), %eax
 11752 00a4 E9440300 		jmp	.L686
 11752      00
 11753              	.L706:
GAS LISTING /tmp/ccEn8xFO.s 			page 422


8317:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
8318:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8319:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8320:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Loop as long as no application data record is available */
8321:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     while( ssl->in_offt == NULL )
8322:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8323:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Start timer if not already running */
8324:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->f_get_timer != NULL &&
 11754              		.loc 4 8324 16
 11755 00a9 488B45C8 		movq	-56(%rbp), %rax
 11756 00ad 488B8098 		movq	152(%rax), %rax
 11756      000000
 11757              		.loc 4 8324 11
 11758 00b4 4885C0   		testq	%rax, %rax
 11759 00b7 743B     		je	.L690
8325:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->f_get_timer( ssl->p_timer ) == -1 )
 11760              		.loc 4 8325 16 discriminator 1
 11761 00b9 488B45C8 		movq	-56(%rbp), %rax
 11762 00bd 488B9098 		movq	152(%rax), %rdx
 11762      000000
 11763              		.loc 4 8325 13 discriminator 1
 11764 00c4 488B45C8 		movq	-56(%rbp), %rax
 11765 00c8 488B8088 		movq	136(%rax), %rax
 11765      000000
 11766 00cf 4889C7   		movq	%rax, %rdi
 11767 00d2 FFD2     		call	*%rdx
 11768              	.LVL17:
8324:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->f_get_timer( ssl->p_timer ) == -1 )
 11769              		.loc 4 8324 38 discriminator 1
 11770 00d4 83F8FF   		cmpl	$-1, %eax
 11771 00d7 751B     		jne	.L690
8326:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
8327:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl_set_timer( ssl, ssl->conf->read_timeout );
 11772              		.loc 4 8327 36
 11773 00d9 488B45C8 		movq	-56(%rbp), %rax
 11774 00dd 488B00   		movq	(%rax), %rax
 11775              		.loc 4 8327 13
 11776 00e0 8B90A800 		movl	168(%rax), %edx
 11776      0000
 11777 00e6 488B45C8 		movq	-56(%rbp), %rax
 11778 00ea 89D6     		movl	%edx, %esi
 11779 00ec 4889C7   		movq	%rax, %rdi
 11780 00ef E8000000 		call	ssl_set_timer
 11780      00
 11781              	.L690:
8328:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
8329:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8330:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_ssl_read_record( ssl, 1 ) ) != 0 )
 11782              		.loc 4 8330 21
 11783 00f4 488B45C8 		movq	-56(%rbp), %rax
 11784 00f8 BE010000 		movl	$1, %esi
 11784      00
 11785 00fd 4889C7   		movq	%rax, %rdi
 11786 0100 E8000000 		call	mbedtls_ssl_read_record
 11786      00
 11787 0105 8945DC   		movl	%eax, -36(%rbp)
 11788              		.loc 4 8330 11
GAS LISTING /tmp/ccEn8xFO.s 			page 423


 11789 0108 837DDC00 		cmpl	$0, -36(%rbp)
 11790 010c 741B     		je	.L691
8331:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
8332:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ret == MBEDTLS_ERR_SSL_CONN_EOF )
 11791              		.loc 4 8332 15
 11792 010e 817DDC80 		cmpl	$-29312, -36(%rbp)
 11792      8DFFFF
 11793 0115 750A     		jne	.L692
8333:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( 0 );
 11794              		.loc 4 8333 23
 11795 0117 B8000000 		movl	$0, %eax
 11795      00
 11796 011c E9CC0200 		jmp	.L686
 11796      00
 11797              	.L692:
8334:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8335:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_read_record", ret );
8336:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 11798              		.loc 4 8336 19
 11799 0121 8B45DC   		movl	-36(%rbp), %eax
 11800 0124 E9C40200 		jmp	.L686
 11800      00
 11801              	.L691:
8337:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
8338:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8339:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_msglen  == 0 &&
 11802              		.loc 4 8339 16
 11803 0129 488B45C8 		movq	-56(%rbp), %rax
 11804 012d 488B80E0 		movq	224(%rax), %rax
 11804      000000
 11805              		.loc 4 8339 11
 11806 0134 4885C0   		testq	%rax, %rax
 11807 0137 7544     		jne	.L693
8340:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msgtype == MBEDTLS_SSL_MSG_APPLICATION_DATA )
 11808              		.loc 4 8340 16 discriminator 1
 11809 0139 488B45C8 		movq	-56(%rbp), %rax
 11810 013d 8B80D800 		movl	216(%rax), %eax
 11810      0000
8339:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->in_msgtype == MBEDTLS_SSL_MSG_APPLICATION_DATA )
 11811              		.loc 4 8339 34 discriminator 1
 11812 0143 83F817   		cmpl	$23, %eax
 11813 0146 7535     		jne	.L693
8341:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
8342:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /*
8343:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * OpenSSL sends empty messages to randomize the IV
8344:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              */
8345:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ( ret = mbedtls_ssl_read_record( ssl, 1 ) ) != 0 )
 11814              		.loc 4 8345 25
 11815 0148 488B45C8 		movq	-56(%rbp), %rax
 11816 014c BE010000 		movl	$1, %esi
 11816      00
 11817 0151 4889C7   		movq	%rax, %rdi
 11818 0154 E8000000 		call	mbedtls_ssl_read_record
 11818      00
 11819 0159 8945DC   		movl	%eax, -36(%rbp)
 11820              		.loc 4 8345 15
 11821 015c 837DDC00 		cmpl	$0, -36(%rbp)
GAS LISTING /tmp/ccEn8xFO.s 			page 424


 11822 0160 741B     		je	.L693
8346:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
8347:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( ret == MBEDTLS_ERR_SSL_CONN_EOF )
 11823              		.loc 4 8347 19
 11824 0162 817DDC80 		cmpl	$-29312, -36(%rbp)
 11824      8DFFFF
 11825 0169 750A     		jne	.L694
8348:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     return( 0 );
 11826              		.loc 4 8348 27
 11827 016b B8000000 		movl	$0, %eax
 11827      00
 11828 0170 E9780200 		jmp	.L686
 11828      00
 11829              	.L694:
8349:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8350:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_read_record", ret );
8351:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( ret );
 11830              		.loc 4 8351 23
 11831 0175 8B45DC   		movl	-36(%rbp), %eax
 11832 0178 E9700200 		jmp	.L686
 11832      00
 11833              	.L693:
8352:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
8353:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
8354:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8355:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_msgtype == MBEDTLS_SSL_MSG_HANDSHAKE )
 11834              		.loc 4 8355 16
 11835 017d 488B45C8 		movq	-56(%rbp), %rax
 11836 0181 8B80D800 		movl	216(%rax), %eax
 11836      0000
 11837              		.loc 4 8355 11
 11838 0187 83F816   		cmpl	$22, %eax
 11839 018a 0F85F100 		jne	.L695
 11839      0000
8356:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
8357:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "received handshake message" ) );
8358:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8359:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /*
8360:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * - For client-side, expect SERVER_HELLO_REQUEST.
8361:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * - For server-side, expect CLIENT_HELLO.
8362:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * - Fail (TLS) or silently drop record (DTLS) in other cases.
8363:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              */
8364:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8365:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
8366:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ssl->conf->endpoint == MBEDTLS_SSL_IS_CLIENT &&
 11840              		.loc 4 8366 20
 11841 0190 488B45C8 		movq	-56(%rbp), %rax
 11842 0194 488B00   		movq	(%rax), %rax
 11843              		.loc 4 8366 37
 11844 0197 0FB680BC 		movzbl	188(%rax), %eax
 11844      000000
 11845 019e 83E001   		andl	$1, %eax
 11846              		.loc 4 8366 15
 11847 01a1 84C0     		testb	%al, %al
 11848 01a3 7538     		jne	.L696
8367:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ( ssl->in_msg[0] != MBEDTLS_SSL_HS_HELLO_REQUEST ||
 11849              		.loc 4 8367 22 discriminator 1
GAS LISTING /tmp/ccEn8xFO.s 			page 425


 11850 01a5 488B45C8 		movq	-56(%rbp), %rax
 11851 01a9 488B80C8 		movq	200(%rax), %rax
 11851      000000
 11852              		.loc 4 8367 30 discriminator 1
 11853 01b0 0FB600   		movzbl	(%rax), %eax
8366:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ( ssl->in_msg[0] != MBEDTLS_SSL_HS_HELLO_REQUEST ||
 11854              		.loc 4 8366 62 discriminator 1
 11855 01b3 84C0     		testb	%al, %al
 11856 01b5 751C     		jne	.L697
8368:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                   ssl->in_hslen  != mbedtls_ssl_hs_hdr_len( ssl ) ) )
 11857              		.loc 4 8368 22
 11858 01b7 488B45C8 		movq	-56(%rbp), %rax
 11859 01bb 488B98F0 		movq	240(%rax), %rbx
 11859      000000
 11860              		.loc 4 8368 37
 11861 01c2 488B45C8 		movq	-56(%rbp), %rax
 11862 01c6 4889C7   		movq	%rax, %rdi
 11863 01c9 E8000000 		call	mbedtls_ssl_hs_hdr_len
 11863      00
8367:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ( ssl->in_msg[0] != MBEDTLS_SSL_HS_HELLO_REQUEST ||
 11864              		.loc 4 8367 66
 11865 01ce 4839C3   		cmpq	%rax, %rbx
 11866 01d1 740A     		je	.L696
 11867              	.L697:
8369:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
8370:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "handshake received (not HelloRequest)" ) );
8371:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8372:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 /* With DTLS, drop the packet (probably from last handshake) */
8373:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
8374:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
8375:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
8376:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     continue;
8377:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
8378:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8379:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
 11868              		.loc 4 8379 23
 11869 01d3 B80089FF 		movl	$-30464, %eax
 11869      FF
 11870 01d8 E9100200 		jmp	.L686
 11870      00
 11871              	.L696:
8380:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
8381:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_CLI_C */
8382:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8383:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
8384:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER &&
8385:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ssl->in_msg[0] != MBEDTLS_SSL_HS_CLIENT_HELLO )
8386:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
8387:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "handshake received (not ClientHello)" ) );
8388:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8389:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 /* With DTLS, drop the packet (probably from last handshake) */
8390:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
8391:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
8392:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
8393:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     continue;
8394:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
8395:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
GAS LISTING /tmp/ccEn8xFO.s 			page 426


8396:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
8397:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
8398:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_SRV_C */
8399:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8400:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
8401:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Determine whether renegotiation attempt should be accepted */
8402:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ! ( ssl->conf->disable_renegotiation == MBEDTLS_SSL_RENEGOTIATION_DISABLED ||
 11872              		.loc 4 8402 24
 11873 01dd 488B45C8 		movq	-56(%rbp), %rax
 11874 01e1 488B00   		movq	(%rax), %rax
 11875              		.loc 4 8402 54
 11876 01e4 0FB680BD 		movzbl	189(%rax), %eax
 11876      000000
 11877 01eb 83E004   		andl	$4, %eax
 11878              		.loc 4 8402 15
 11879 01ee 84C0     		testb	%al, %al
 11880 01f0 7449     		je	.L698
8403:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ( ssl->secure_renegotiation == MBEDTLS_SSL_LEGACY_RENEGOTIATION &&
 11881              		.loc 4 8403 26 discriminator 1
 11882 01f2 488B45C8 		movq	-56(%rbp), %rax
 11883 01f6 8B806001 		movl	352(%rax), %eax
 11883      0000
8402:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ( ssl->secure_renegotiation == MBEDTLS_SSL_LEGACY_RENEGOTIATION &&
 11884              		.loc 4 8402 17 discriminator 1
 11885 01fc 85C0     		testl	%eax, %eax
 11886 01fe 7515     		jne	.L699
8404:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                       ssl->conf->allow_legacy_renegotiation ==
 11887              		.loc 4 8404 26
 11888 0200 488B45C8 		movq	-56(%rbp), %rax
 11889 0204 488B00   		movq	(%rax), %rax
 11890              		.loc 4 8404 61
 11891 0207 0FB680BC 		movzbl	188(%rax), %eax
 11891      000000
 11892 020e 83E030   		andl	$48, %eax
8403:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ( ssl->secure_renegotiation == MBEDTLS_SSL_LEGACY_RENEGOTIATION &&
 11893              		.loc 4 8403 85
 11894 0211 84C0     		testb	%al, %al
 11895 0213 7426     		je	.L698
 11896              	.L699:
8405:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                                    MBEDTLS_SSL_LEGACY_NO_RENEGOTIATION ) ) )
8406:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
8407:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 /*
8408:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                  * Accept renegotiation request
8409:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                  */
8410:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8411:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 /* DTLS clients need to know renego is server-initiated */
8412:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
8413:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
8414:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ssl->conf->endpoint == MBEDTLS_SSL_IS_CLIENT )
8415:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
8416:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ssl->renego_status = MBEDTLS_SSL_RENEGOTIATION_PENDING;
8417:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
8418:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8419:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 ret = ssl_start_renegotiation( ssl );
 11897              		.loc 4 8419 23
 11898 0215 488B45C8 		movq	-56(%rbp), %rax
 11899 0219 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/ccEn8xFO.s 			page 427


 11900 021c E8000000 		call	ssl_start_renegotiation
 11900      00
 11901 0221 8945DC   		movl	%eax, -36(%rbp)
8420:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( ret != MBEDTLS_ERR_SSL_WAITING_SERVER_HELLO_RENEGO &&
 11902              		.loc 4 8420 19
 11903 0224 817DDC00 		cmpl	$-27392, -36(%rbp)
 11903      95FFFF
 11904 022b 744E     		je	.L710
 11905              		.loc 4 8420 72 discriminator 1
 11906 022d 837DDC00 		cmpl	$0, -36(%rbp)
 11907 0231 7448     		je	.L710
8421:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ret != 0 )
8422:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
8423:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_RET( 1, "ssl_start_renegotiation", ret );
8424:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     return( ret );
 11908              		.loc 4 8424 27
 11909 0233 8B45DC   		movl	-36(%rbp), %eax
 11910 0236 E9B20100 		jmp	.L686
 11910      00
 11911              	.L698:
8425:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
8426:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
8427:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             else
8428:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_RENEGOTIATION */
8429:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
8430:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 /*
8431:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                  * Refuse renegotiation
8432:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                  */
8433:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8434:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 3, ( "refusing renegotiation, sending alert" ) );
8435:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8436:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
8437:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 )
8438:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
8439:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     /* SSLv3 does not have a "no_renegotiation" warning, so
8440:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                        we send a fatal alert and abort the connection. */
8441:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
8442:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                                     MBEDTLS_SSL_ALERT_MSG_UNEXPECTED_MESSAGE );
8443:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
8444:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
8445:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 else
8446:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 */
8447:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1) || \
8448:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_2)
8449:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_1 )
 11912              		.loc 4 8449 24
 11913 023b 488B45C8 		movq	-56(%rbp), %rax
 11914 023f 8B4018   		movl	24(%rax), %eax
 11915              		.loc 4 8449 19
 11916 0242 85C0     		testl	%eax, %eax
 11917 0244 7E2B     		jle	.L702
8450:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
8451:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     if( ( ret = mbedtls_ssl_send_alert_message( ssl,
 11918              		.loc 4 8451 33
 11919 0246 488B45C8 		movq	-56(%rbp), %rax
 11920 024a BA640000 		movl	$100, %edx
 11920      00
GAS LISTING /tmp/ccEn8xFO.s 			page 428


 11921 024f BE010000 		movl	$1, %esi
 11921      00
 11922 0254 4889C7   		movq	%rax, %rdi
 11923 0257 E8000000 		call	mbedtls_ssl_send_alert_message
 11923      00
 11924 025c 8945DC   		movl	%eax, -36(%rbp)
 11925              		.loc 4 8451 23
 11926 025f 837DDC00 		cmpl	$0, -36(%rbp)
 11927 0263 0F84CD00 		je	.L689
 11927      0000
8452:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     MBEDTLS_SSL_ALERT_LEVEL_WARNING,
8453:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     MBEDTLS_SSL_ALERT_MSG_NO_RENEGOTIATION ) ) != 0 )
8454:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     {
8455:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         return( ret );
 11928              		.loc 4 8455 31
 11929 0269 8B45DC   		movl	-36(%rbp), %eax
 11930 026c E97C0100 		jmp	.L686
 11930      00
 11931              	.L702:
8456:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     }
8457:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
8458:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 else
8459:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1 || MBEDTLS_SSL_PROTO_TLS1_1 ||
8460:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****           MBEDTLS_SSL_PROTO_TLS1_2 */
8461:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
8462:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
8463:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 11932              		.loc 4 8463 27
 11933 0271 B80094FF 		movl	$-27648, %eax
 11933      FF
 11934 0276 E9720100 		jmp	.L686
 11934      00
 11935              	.L710:
8420:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     ret != 0 )
 11936              		.loc 4 8420 19
 11937 027b 90       		nop
8464:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
8465:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
8466:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8467:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* At this point, we don't know whether the renegotiation has been
8468:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * completed or not. The cases to consider are the following:
8469:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * 1) The renegotiation is complete. In this case, no new record
8470:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *    has been read yet.
8471:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * 2) The renegotiation is incomplete because the client received
8472:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *    an application data record while awaiting the ServerHello.
8473:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * 3) The renegotiation is incomplete because the client received
8474:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *    a non-handshake, non-application data message while awaiting
8475:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *    the ServerHello.
8476:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * In each of these case, looping will be the proper action:
8477:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * - For 1), the next iteration will read a new record and check
8478:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *   if it's application data.
8479:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * - For 2), the loop condition isn't satisfied as application data
8480:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *   is present, hence continue is the same as break
8481:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              * - For 3), the loop condition is satisfied and read_record
8482:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *   will re-deliver the message that was held back by the client
8483:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              *   when expecting the ServerHello.
8484:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****              */
GAS LISTING /tmp/ccEn8xFO.s 			page 429


8485:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             continue;
 11938              		.loc 4 8485 13
 11939 027c E9B50000 		jmp	.L689
 11939      00
 11940              	.L695:
8486:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
8487:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
8488:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else if( ssl->renego_status == MBEDTLS_SSL_RENEGOTIATION_PENDING )
 11941              		.loc 4 8488 21
 11942 0281 488B45C8 		movq	-56(%rbp), %rax
 11943 0285 8B400C   		movl	12(%rax), %eax
 11944              		.loc 4 8488 16
 11945 0288 83F803   		cmpl	$3, %eax
 11946 028b 7544     		jne	.L703
8489:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
8490:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ssl->conf->renego_max_records >= 0 )
 11947              		.loc 4 8490 20
 11948 028d 488B45C8 		movq	-56(%rbp), %rax
 11949 0291 488B00   		movq	(%rax), %rax
 11950              		.loc 4 8490 26
 11951 0294 8B80AC00 		movl	172(%rax), %eax
 11951      0000
 11952              		.loc 4 8490 15
 11953 029a 85C0     		testl	%eax, %eax
 11954 029c 7833     		js	.L703
8491:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
8492:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if( ++ssl->renego_records_seen > ssl->conf->renego_max_records )
 11955              		.loc 4 8492 26
 11956 029e 488B45C8 		movq	-56(%rbp), %rax
 11957 02a2 8B4010   		movl	16(%rax), %eax
 11958              		.loc 4 8492 21
 11959 02a5 8D5001   		leal	1(%rax), %edx
 11960              		.loc 4 8492 19
 11961 02a8 488B45C8 		movq	-56(%rbp), %rax
 11962 02ac 895010   		movl	%edx, 16(%rax)
 11963              		.loc 4 8492 26
 11964 02af 488B45C8 		movq	-56(%rbp), %rax
 11965 02b3 8B5010   		movl	16(%rax), %edx
 11966              		.loc 4 8492 53
 11967 02b6 488B45C8 		movq	-56(%rbp), %rax
 11968 02ba 488B00   		movq	(%rax), %rax
 11969              		.loc 4 8492 59
 11970 02bd 8B80AC00 		movl	172(%rax), %eax
 11970      0000
 11971              		.loc 4 8492 19
 11972 02c3 39C2     		cmpl	%eax, %edx
 11973 02c5 7E0A     		jle	.L703
8493:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
8494:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_MSG( 1, ( "renegotiation requested, "
8495:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         "but not honored by client" ) );
8496:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
 11974              		.loc 4 8496 27
 11975 02c7 B80089FF 		movl	$-30464, %eax
 11975      FF
 11976 02cc E91C0100 		jmp	.L686
 11976      00
 11977              	.L703:
GAS LISTING /tmp/ccEn8xFO.s 			page 430


8497:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
8498:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
8499:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
8500:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_RENEGOTIATION */
8501:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8502:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Fatal and closure alerts handled by mbedtls_ssl_read_record() */
8503:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_msgtype == MBEDTLS_SSL_MSG_ALERT )
 11978              		.loc 4 8503 16
 11979 02d1 488B45C8 		movq	-56(%rbp), %rax
 11980 02d5 8B80D800 		movl	216(%rax), %eax
 11980      0000
 11981              		.loc 4 8503 11
 11982 02db 83F815   		cmpl	$21, %eax
 11983 02de 750A     		jne	.L704
8504:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
8505:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "ignoring non-fatal non-closure alert" ) );
8506:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_WANT_READ );
 11984              		.loc 4 8506 19
 11985 02e0 B80097FF 		movl	$-26880, %eax
 11985      FF
 11986 02e5 E9030100 		jmp	.L686
 11986      00
 11987              	.L704:
8507:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
8508:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8509:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->in_msgtype != MBEDTLS_SSL_MSG_APPLICATION_DATA )
 11988              		.loc 4 8509 16
 11989 02ea 488B45C8 		movq	-56(%rbp), %rax
 11990 02ee 8B80D800 		movl	216(%rax), %eax
 11990      0000
 11991              		.loc 4 8509 11
 11992 02f4 83F817   		cmpl	$23, %eax
 11993 02f7 740A     		je	.L705
8510:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
8511:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad application data message" ) );
8512:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
 11994              		.loc 4 8512 19
 11995 02f9 B80089FF 		movl	$-30464, %eax
 11995      FF
 11996 02fe E9EA0000 		jmp	.L686
 11996      00
 11997              	.L705:
8513:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
8514:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8515:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_offt = ssl->in_msg;
 11998              		.loc 4 8515 27
 11999 0303 488B45C8 		movq	-56(%rbp), %rax
 12000 0307 488B90C8 		movq	200(%rax), %rdx
 12000      000000
 12001              		.loc 4 8515 22
 12002 030e 488B45C8 		movq	-56(%rbp), %rax
 12003 0312 488990D0 		movq	%rdx, 208(%rax)
 12003      000000
8516:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8517:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* We're going to return something now, cancel timer,
8518:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * except if handshake (renegotiation) is in progress */
8519:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->state == MBEDTLS_SSL_HANDSHAKE_OVER )
GAS LISTING /tmp/ccEn8xFO.s 			page 431


 12004              		.loc 4 8519 16
 12005 0319 488B45C8 		movq	-56(%rbp), %rax
 12006 031d 8B4008   		movl	8(%rax), %eax
 12007              		.loc 4 8519 11
 12008 0320 83F810   		cmpl	$16, %eax
 12009 0323 7511     		jne	.L689
8520:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl_set_timer( ssl, 0 );
 12010              		.loc 4 8520 13
 12011 0325 488B45C8 		movq	-56(%rbp), %rax
 12012 0329 BE000000 		movl	$0, %esi
 12012      00
 12013 032e 4889C7   		movq	%rax, %rdi
 12014 0331 E8000000 		call	ssl_set_timer
 12014      00
 12015              	.L689:
8321:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 12016              		.loc 4 8321 15
 12017 0336 488B45C8 		movq	-56(%rbp), %rax
 12018 033a 488B80D0 		movq	208(%rax), %rax
 12018      000000
8321:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 12019              		.loc 4 8321 10
 12020 0341 4885C0   		testq	%rax, %rax
 12021 0344 0F845FFD 		je	.L706
 12021      FFFF
8521:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8522:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
8523:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* If we requested renego but received AppData, resend HelloRequest.
8524:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Do it now, after setting in_offt, to avoid taking this branch
8525:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * again if ssl_write_hello_request() returns WANT_WRITE */
8526:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C) && defined(MBEDTLS_SSL_RENEGOTIATION)
8527:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER &&
8528:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->renego_status == MBEDTLS_SSL_RENEGOTIATION_PENDING )
8529:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
8530:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( ( ret = ssl_resend_hello_request( ssl ) ) != 0 )
8531:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
8532:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_RET( 1, "ssl_resend_hello_request", ret );
8533:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 return( ret );
8534:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
8535:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
8536:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_SRV_C && MBEDTLS_SSL_RENEGOTIATION */
8537:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
8538:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8539:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8540:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     n = ( len < ssl->in_msglen )
 12022              		.loc 4 8540 20
 12023 034a 488B45C8 		movq	-56(%rbp), %rax
 12024 034e 488B80E0 		movq	224(%rax), %rax
 12024      000000
 12025              		.loc 4 8540 7
 12026 0355 483945B8 		cmpq	%rax, -72(%rbp)
 12027 0359 480F4645 		cmovbe	-72(%rbp), %rax
 12027      B8
 12028 035e 488945E0 		movq	%rax, -32(%rbp)
8541:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ? len : ssl->in_msglen;
8542:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8543:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memcpy( buf, ssl->in_offt, n );
GAS LISTING /tmp/ccEn8xFO.s 			page 432


 12029              		.loc 4 8543 21
 12030 0362 488B45C8 		movq	-56(%rbp), %rax
 12031 0366 488B88D0 		movq	208(%rax), %rcx
 12031      000000
 12032              		.loc 4 8543 5
 12033 036d 488B55E0 		movq	-32(%rbp), %rdx
 12034 0371 488B45C0 		movq	-64(%rbp), %rax
 12035 0375 4889CE   		movq	%rcx, %rsi
 12036 0378 4889C7   		movq	%rax, %rdi
 12037 037b E8000000 		call	memcpy@PLT
 12037      00
8544:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->in_msglen -= n;
 12038              		.loc 4 8544 20
 12039 0380 488B45C8 		movq	-56(%rbp), %rax
 12040 0384 488B80E0 		movq	224(%rax), %rax
 12040      000000
 12041 038b 482B45E0 		subq	-32(%rbp), %rax
 12042 038f 4889C2   		movq	%rax, %rdx
 12043 0392 488B45C8 		movq	-56(%rbp), %rax
 12044 0396 488990E0 		movq	%rdx, 224(%rax)
 12044      000000
8545:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8546:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_msglen == 0 )
 12045              		.loc 4 8546 12
 12046 039d 488B45C8 		movq	-56(%rbp), %rax
 12047 03a1 488B80E0 		movq	224(%rax), %rax
 12047      000000
 12048              		.loc 4 8546 7
 12049 03a8 4885C0   		testq	%rax, %rax
 12050 03ab 751F     		jne	.L707
8547:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8548:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* all bytes consumed */
8549:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_offt = NULL;
 12051              		.loc 4 8549 22
 12052 03ad 488B45C8 		movq	-56(%rbp), %rax
 12053 03b1 48C780D0 		movq	$0, 208(%rax)
 12053      00000000 
 12053      000000
8550:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->keep_current_message = 0;
 12054              		.loc 4 8550 35
 12055 03bc 488B45C8 		movq	-56(%rbp), %rax
 12056 03c0 C780FC00 		movl	$0, 252(%rax)
 12056      00000000 
 12056      0000
 12057 03ca EB1D     		jmp	.L708
 12058              	.L707:
8551:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8552:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
8553:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8554:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* more data available */
8555:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->in_offt += n;
 12059              		.loc 4 8555 22
 12060 03cc 488B45C8 		movq	-56(%rbp), %rax
 12061 03d0 488B90D0 		movq	208(%rax), %rdx
 12061      000000
 12062 03d7 488B45E0 		movq	-32(%rbp), %rax
 12063 03db 4801C2   		addq	%rax, %rdx
GAS LISTING /tmp/ccEn8xFO.s 			page 433


 12064 03de 488B45C8 		movq	-56(%rbp), %rax
 12065 03e2 488990D0 		movq	%rdx, 208(%rax)
 12065      000000
 12066              	.L708:
8556:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8557:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8558:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= read" ) );
8559:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8560:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( (int) n );
 12067              		.loc 4 8560 13
 12068 03e9 488B45E0 		movq	-32(%rbp), %rax
 12069              	.L686:
8561:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 12070              		.loc 4 8561 1
 12071 03ed 488B4DE8 		movq	-24(%rbp), %rcx
 12072 03f1 6448330C 		xorq	%fs:40, %rcx
 12072      25280000 
 12072      00
 12073 03fa 7405     		je	.L709
 12074 03fc E8000000 		call	__stack_chk_fail@PLT
 12074      00
 12075              	.L709:
 12076 0401 4883C448 		addq	$72, %rsp
 12077 0405 5B       		popq	%rbx
 12078 0406 5D       		popq	%rbp
 12079              	.LCFI320:
 12080              		.cfi_def_cfa 7, 8
 12081 0407 C3       		ret
 12082              		.cfi_endproc
 12083              	.LFE125:
 12085              		.section	.text.ssl_write_real,"ax",@progbits
 12087              	ssl_write_real:
 12088              	.LFB126:
8562:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8563:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
8564:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Send application data to be encrypted by the SSL layer, taking care of max
8565:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * fragment length and buffer size.
8566:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
8567:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * According to RFC 5246 Section 6.2.1:
8568:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
8569:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *      Zero-length fragments of Application data MAY be sent as they are
8570:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *      potentially useful as a traffic analysis countermeasure.
8571:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
8572:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Therefore, it is possible that the input message length is 0 and the
8573:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * corresponding return code is 0 on success.
8574:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
8575:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_write_real( mbedtls_ssl_context *ssl,
8576:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                            const unsigned char *buf, size_t len )
8577:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 12089              		.loc 4 8577 1
 12090              		.cfi_startproc
 12091 0000 F30F1EFA 		endbr64
 12092 0004 55       		pushq	%rbp
 12093              	.LCFI321:
 12094              		.cfi_def_cfa_offset 16
 12095              		.cfi_offset 6, -16
 12096 0005 4889E5   		movq	%rsp, %rbp
GAS LISTING /tmp/ccEn8xFO.s 			page 434


 12097              	.LCFI322:
 12098              		.cfi_def_cfa_register 6
 12099 0008 4883EC40 		subq	$64, %rsp
 12100 000c 48897DD8 		movq	%rdi, -40(%rbp)
 12101 0010 488975D0 		movq	%rsi, -48(%rbp)
 12102 0014 488955C8 		movq	%rdx, -56(%rbp)
 12103              		.loc 4 8577 1
 12104 0018 64488B04 		movq	%fs:40, %rax
 12104      25280000 
 12104      00
 12105 0021 488945F8 		movq	%rax, -8(%rbp)
 12106 0025 31C0     		xorl	%eax, %eax
8578:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret = mbedtls_ssl_get_max_out_record_payload( ssl );
 12107              		.loc 4 8578 15
 12108 0027 488B45D8 		movq	-40(%rbp), %rax
 12109 002b 4889C7   		movq	%rax, %rdi
 12110 002e E8000000 		call	mbedtls_ssl_get_max_out_record_payload
 12110      00
 12111 0033 8945EC   		movl	%eax, -20(%rbp)
8579:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const size_t max_len = (size_t) ret;
 12112              		.loc 4 8579 18
 12113 0036 8B45EC   		movl	-20(%rbp), %eax
 12114 0039 4898     		cltq
 12115 003b 488945F0 		movq	%rax, -16(%rbp)
8580:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8581:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ret < 0 )
 12116              		.loc 4 8581 7
 12117 003f 837DEC00 		cmpl	$0, -20(%rbp)
 12118 0043 7908     		jns	.L712
8582:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8583:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_get_max_out_record_payload", ret );
8584:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 12119              		.loc 4 8584 15
 12120 0045 8B45EC   		movl	-20(%rbp), %eax
 12121 0048 E99A0000 		jmp	.L713
 12121      00
 12122              	.L712:
8585:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8586:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8587:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( len > max_len )
 12123              		.loc 4 8587 7
 12124 004d 488B45C8 		movq	-56(%rbp), %rax
 12125 0051 483B45F0 		cmpq	-16(%rbp), %rax
 12126 0055 7608     		jbe	.L714
8588:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8589:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
8590:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
8591:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
8592:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "fragment larger than the (negotiated) "
8593:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 "maximum fragment length: %d > %d",
8594:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 len, max_len ) );
8595:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
8596:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
8597:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         else
8598:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8599:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             len = max_len;
 12127              		.loc 4 8599 17
GAS LISTING /tmp/ccEn8xFO.s 			page 435


 12128 0057 488B45F0 		movq	-16(%rbp), %rax
 12129 005b 488945C8 		movq	%rax, -56(%rbp)
 12130              	.L714:
8600:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8601:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8602:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->out_left != 0 )
 12131              		.loc 4 8602 12
 12132 005f 488B45D8 		movq	-40(%rbp), %rax
 12133 0063 488B8040 		movq	320(%rax), %rax
 12133      010000
 12134              		.loc 4 8602 7
 12135 006a 4885C0   		testq	%rax, %rax
 12136 006d 741A     		je	.L715
8603:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8604:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
8605:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * The user has previously tried to send the data and
8606:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * MBEDTLS_ERR_SSL_WANT_WRITE or the message was only partially
8607:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * written. In this case, we expect the high-level write function
8608:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * (e.g. mbedtls_ssl_write()) to be called with the same parameters
8609:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
8610:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_ssl_flush_output( ssl ) ) != 0 )
 12137              		.loc 4 8610 21
 12138 006f 488B45D8 		movq	-40(%rbp), %rax
 12139 0073 4889C7   		movq	%rax, %rdi
 12140 0076 E8000000 		call	mbedtls_ssl_flush_output
 12140      00
 12141 007b 8945EC   		movl	%eax, -20(%rbp)
 12142              		.loc 4 8610 11
 12143 007e 837DEC00 		cmpl	$0, -20(%rbp)
 12144 0082 745F     		je	.L716
8611:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
8612:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_flush_output", ret );
8613:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 12145              		.loc 4 8613 19
 12146 0084 8B45EC   		movl	-20(%rbp), %eax
 12147 0087 EB5E     		jmp	.L713
 12148              	.L715:
8614:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
8615:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8616:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
8617:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8618:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
8619:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * The user is trying to send a message the first time, so we need to
8620:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * copy the data into the internal buffers and setup the data structure
8621:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * to keep track of partial writes
8622:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
8623:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_msglen  = len;
 12149              		.loc 4 8623 26
 12150 0089 488B45D8 		movq	-40(%rbp), %rax
 12151 008d 488B55C8 		movq	-56(%rbp), %rdx
 12152 0091 48899038 		movq	%rdx, 312(%rax)
 12152      010000
8624:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->out_msgtype = MBEDTLS_SSL_MSG_APPLICATION_DATA;
 12153              		.loc 4 8624 26
 12154 0098 488B45D8 		movq	-40(%rbp), %rax
 12155 009c C7803001 		movl	$23, 304(%rax)
 12155      00001700 
GAS LISTING /tmp/ccEn8xFO.s 			page 436


 12155      0000
8625:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memcpy( ssl->out_msg, buf, len );
 12156              		.loc 4 8625 20
 12157 00a6 488B45D8 		movq	-40(%rbp), %rax
 12158 00aa 488B8028 		movq	296(%rax), %rax
 12158      010000
 12159              		.loc 4 8625 9
 12160 00b1 488B55C8 		movq	-56(%rbp), %rdx
 12161 00b5 488B4DD0 		movq	-48(%rbp), %rcx
 12162 00b9 4889CE   		movq	%rcx, %rsi
 12163 00bc 4889C7   		movq	%rax, %rdi
 12164 00bf E8000000 		call	memcpy@PLT
 12164      00
8626:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8627:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_ssl_write_record( ssl, SSL_FORCE_FLUSH ) ) != 0 )
 12165              		.loc 4 8627 21
 12166 00c4 488B45D8 		movq	-40(%rbp), %rax
 12167 00c8 BE010000 		movl	$1, %esi
 12167      00
 12168 00cd 4889C7   		movq	%rax, %rdi
 12169 00d0 E8000000 		call	mbedtls_ssl_write_record
 12169      00
 12170 00d5 8945EC   		movl	%eax, -20(%rbp)
 12171              		.loc 4 8627 11
 12172 00d8 837DEC00 		cmpl	$0, -20(%rbp)
 12173 00dc 7405     		je	.L716
8628:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
8629:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_write_record", ret );
8630:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 12174              		.loc 4 8630 19
 12175 00de 8B45EC   		movl	-20(%rbp), %eax
 12176 00e1 EB04     		jmp	.L713
 12177              	.L716:
8631:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
8632:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8633:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8634:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( (int) len );
 12178              		.loc 4 8634 13
 12179 00e3 488B45C8 		movq	-56(%rbp), %rax
 12180              	.L713:
8635:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 12181              		.loc 4 8635 1
 12182 00e7 488B4DF8 		movq	-8(%rbp), %rcx
 12183 00eb 6448330C 		xorq	%fs:40, %rcx
 12183      25280000 
 12183      00
 12184 00f4 7405     		je	.L717
 12185 00f6 E8000000 		call	__stack_chk_fail@PLT
 12185      00
 12186              	.L717:
 12187 00fb C9       		leave
 12188              	.LCFI323:
 12189              		.cfi_def_cfa 7, 8
 12190 00fc C3       		ret
 12191              		.cfi_endproc
 12192              	.LFE126:
 12194              		.section	.text.mbedtls_ssl_write,"ax",@progbits
GAS LISTING /tmp/ccEn8xFO.s 			page 437


 12195              		.globl	mbedtls_ssl_write
 12197              	mbedtls_ssl_write:
 12198              	.LFB127:
8636:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8637:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
8638:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Write application data, doing 1/n-1 splitting if necessary.
8639:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
8640:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * With non-blocking I/O, ssl_write_real() may return WANT_WRITE,
8641:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * then the caller will call us again with the same arguments, so
8642:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * remember whether we already did the split or not.
8643:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
8644:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_CBC_RECORD_SPLITTING)
8645:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_write_split( mbedtls_ssl_context *ssl,
8646:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                             const unsigned char *buf, size_t len )
8647:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
8648:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
8649:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8650:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->cbc_record_splitting ==
8651:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_CBC_RECORD_SPLITTING_DISABLED ||
8652:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         len <= 1 ||
8653:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->minor_ver > MBEDTLS_SSL_MINOR_VERSION_1 ||
8654:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_cipher_get_cipher_mode( &ssl->transform_out->cipher_ctx_enc )
8655:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 != MBEDTLS_MODE_CBC )
8656:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8657:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ssl_write_real( ssl, buf, len ) );
8658:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8659:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8660:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->split_done == 0 )
8661:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8662:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = ssl_write_real( ssl, buf, 1 ) ) <= 0 )
8663:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
8664:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->split_done = 1;
8665:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8666:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8667:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = ssl_write_real( ssl, buf + 1, len - 1 ) ) <= 0 )
8668:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
8669:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl->split_done = 0;
8670:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8671:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ret + 1 );
8672:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
8673:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_CBC_RECORD_SPLITTING */
8674:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8675:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
8676:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Write application data (public-facing wrapper)
8677:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
8678:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_write( mbedtls_ssl_context *ssl, const unsigned char *buf, size_t len )
8679:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 12199              		.loc 4 8679 1
 12200              		.cfi_startproc
 12201 0000 F30F1EFA 		endbr64
 12202 0004 55       		pushq	%rbp
 12203              	.LCFI324:
 12204              		.cfi_def_cfa_offset 16
 12205              		.cfi_offset 6, -16
 12206 0005 4889E5   		movq	%rsp, %rbp
 12207              	.LCFI325:
 12208              		.cfi_def_cfa_register 6
GAS LISTING /tmp/ccEn8xFO.s 			page 438


 12209 0008 4883EC30 		subq	$48, %rsp
 12210 000c 48897DE8 		movq	%rdi, -24(%rbp)
 12211 0010 488975E0 		movq	%rsi, -32(%rbp)
 12212 0014 488955D8 		movq	%rdx, -40(%rbp)
 12213              		.loc 4 8679 1
 12214 0018 64488B04 		movq	%fs:40, %rax
 12214      25280000 
 12214      00
 12215 0021 488945F8 		movq	%rax, -8(%rbp)
 12216 0025 31C0     		xorl	%eax, %eax
8680:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
8681:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8682:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> write" ) );
8683:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8684:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl == NULL || ssl->conf == NULL )
 12217              		.loc 4 8684 7
 12218 0027 48837DE8 		cmpq	$0, -24(%rbp)
 12218      00
 12219 002c 740C     		je	.L719
 12220              		.loc 4 8684 27 discriminator 1
 12221 002e 488B45E8 		movq	-24(%rbp), %rax
 12222 0032 488B00   		movq	(%rax), %rax
 12223              		.loc 4 8684 21 discriminator 1
 12224 0035 4885C0   		testq	%rax, %rax
 12225 0038 7507     		jne	.L720
 12226              	.L719:
8685:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 12227              		.loc 4 8685 15
 12228 003a B8008FFF 		movl	$-28928, %eax
 12228      FF
 12229 003f EB5D     		jmp	.L721
 12230              	.L720:
8686:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8687:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
8688:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = ssl_check_ctr_renegotiate( ssl ) ) != 0 )
 12231              		.loc 4 8688 17
 12232 0041 488B45E8 		movq	-24(%rbp), %rax
 12233 0045 4889C7   		movq	%rax, %rdi
 12234 0048 E8000000 		call	ssl_check_ctr_renegotiate
 12234      00
 12235 004d 8945F4   		movl	%eax, -12(%rbp)
 12236              		.loc 4 8688 7
 12237 0050 837DF400 		cmpl	$0, -12(%rbp)
 12238 0054 7405     		je	.L722
8689:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8690:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "ssl_check_ctr_renegotiate", ret );
8691:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( ret );
 12239              		.loc 4 8691 15
 12240 0056 8B45F4   		movl	-12(%rbp), %eax
 12241 0059 EB43     		jmp	.L721
 12242              	.L722:
8692:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8693:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8694:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8695:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->state != MBEDTLS_SSL_HANDSHAKE_OVER )
 12243              		.loc 4 8695 12
 12244 005b 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 439


 12245 005f 8B4008   		movl	8(%rax), %eax
 12246              		.loc 4 8695 7
 12247 0062 83F810   		cmpl	$16, %eax
 12248 0065 741A     		je	.L723
8696:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8697:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_ssl_handshake( ssl ) ) != 0 )
 12249              		.loc 4 8697 21
 12250 0067 488B45E8 		movq	-24(%rbp), %rax
 12251 006b 4889C7   		movq	%rax, %rdi
 12252 006e E8000000 		call	mbedtls_ssl_handshake
 12252      00
 12253 0073 8945F4   		movl	%eax, -12(%rbp)
 12254              		.loc 4 8697 11
 12255 0076 837DF400 		cmpl	$0, -12(%rbp)
 12256 007a 7405     		je	.L723
8698:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
8699:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_handshake", ret );
8700:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 12257              		.loc 4 8700 19
 12258 007c 8B45F4   		movl	-12(%rbp), %eax
 12259 007f EB1D     		jmp	.L721
 12260              	.L723:
8701:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
8702:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8703:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8704:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_CBC_RECORD_SPLITTING)
8705:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ret = ssl_write_split( ssl, buf, len );
8706:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #else
8707:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ret = ssl_write_real( ssl, buf, len );
 12261              		.loc 4 8707 11
 12262 0081 488B55D8 		movq	-40(%rbp), %rdx
 12263 0085 488B4DE0 		movq	-32(%rbp), %rcx
 12264 0089 488B45E8 		movq	-24(%rbp), %rax
 12265 008d 4889CE   		movq	%rcx, %rsi
 12266 0090 4889C7   		movq	%rax, %rdi
 12267 0093 E8000000 		call	ssl_write_real
 12267      00
 12268 0098 8945F4   		movl	%eax, -12(%rbp)
8708:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8709:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8710:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= write" ) );
8711:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8712:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ret );
 12269              		.loc 4 8712 11
 12270 009b 8B45F4   		movl	-12(%rbp), %eax
 12271              	.L721:
8713:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 12272              		.loc 4 8713 1
 12273 009e 488B4DF8 		movq	-8(%rbp), %rcx
 12274 00a2 6448330C 		xorq	%fs:40, %rcx
 12274      25280000 
 12274      00
 12275 00ab 7405     		je	.L724
 12276 00ad E8000000 		call	__stack_chk_fail@PLT
 12276      00
 12277              	.L724:
 12278 00b2 C9       		leave
GAS LISTING /tmp/ccEn8xFO.s 			page 440


 12279              	.LCFI326:
 12280              		.cfi_def_cfa 7, 8
 12281 00b3 C3       		ret
 12282              		.cfi_endproc
 12283              	.LFE127:
 12285              		.section	.text.mbedtls_ssl_close_notify,"ax",@progbits
 12286              		.globl	mbedtls_ssl_close_notify
 12288              	mbedtls_ssl_close_notify:
 12289              	.LFB128:
8714:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8715:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
8716:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Notify the peer that the connection is being closed
8717:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
8718:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_close_notify( mbedtls_ssl_context *ssl )
8719:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 12290              		.loc 4 8719 1
 12291              		.cfi_startproc
 12292 0000 F30F1EFA 		endbr64
 12293 0004 55       		pushq	%rbp
 12294              	.LCFI327:
 12295              		.cfi_def_cfa_offset 16
 12296              		.cfi_offset 6, -16
 12297 0005 4889E5   		movq	%rsp, %rbp
 12298              	.LCFI328:
 12299              		.cfi_def_cfa_register 6
 12300 0008 4883EC20 		subq	$32, %rsp
 12301 000c 48897DE8 		movq	%rdi, -24(%rbp)
 12302              		.loc 4 8719 1
 12303 0010 64488B04 		movq	%fs:40, %rax
 12303      25280000 
 12303      00
 12304 0019 488945F8 		movq	%rax, -8(%rbp)
 12305 001d 31C0     		xorl	%eax, %eax
8720:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
8721:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8722:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl == NULL || ssl->conf == NULL )
 12306              		.loc 4 8722 7
 12307 001f 48837DE8 		cmpq	$0, -24(%rbp)
 12307      00
 12308 0024 740C     		je	.L726
 12309              		.loc 4 8722 27 discriminator 1
 12310 0026 488B45E8 		movq	-24(%rbp), %rax
 12311 002a 488B00   		movq	(%rax), %rax
 12312              		.loc 4 8722 21 discriminator 1
 12313 002d 4885C0   		testq	%rax, %rax
 12314 0030 7507     		jne	.L727
 12315              	.L726:
8723:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 12316              		.loc 4 8723 15
 12317 0032 B8008FFF 		movl	$-28928, %eax
 12317      FF
 12318 0037 EB53     		jmp	.L728
 12319              	.L727:
8724:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8725:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> write close notify" ) );
8726:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8727:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->out_left != 0 )
GAS LISTING /tmp/ccEn8xFO.s 			page 441


 12320              		.loc 4 8727 12
 12321 0039 488B45E8 		movq	-24(%rbp), %rax
 12322 003d 488B8040 		movq	320(%rax), %rax
 12322      010000
 12323              		.loc 4 8727 7
 12324 0044 4885C0   		testq	%rax, %rax
 12325 0047 740E     		je	.L729
8728:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( mbedtls_ssl_flush_output( ssl ) );
 12326              		.loc 4 8728 17
 12327 0049 488B45E8 		movq	-24(%rbp), %rax
 12328 004d 4889C7   		movq	%rax, %rdi
 12329 0050 E8000000 		call	mbedtls_ssl_flush_output
 12329      00
 12330 0055 EB35     		jmp	.L728
 12331              	.L729:
8729:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8730:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->state == MBEDTLS_SSL_HANDSHAKE_OVER )
 12332              		.loc 4 8730 12
 12333 0057 488B45E8 		movq	-24(%rbp), %rax
 12334 005b 8B4008   		movl	8(%rax), %eax
 12335              		.loc 4 8730 7
 12336 005e 83F810   		cmpl	$16, %eax
 12337 0061 7524     		jne	.L730
8731:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8732:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( ( ret = mbedtls_ssl_send_alert_message( ssl,
 12338              		.loc 4 8732 21
 12339 0063 488B45E8 		movq	-24(%rbp), %rax
 12340 0067 BA000000 		movl	$0, %edx
 12340      00
 12341 006c BE010000 		movl	$1, %esi
 12341      00
 12342 0071 4889C7   		movq	%rax, %rdi
 12343 0074 E8000000 		call	mbedtls_ssl_send_alert_message
 12343      00
 12344 0079 8945F4   		movl	%eax, -12(%rbp)
 12345              		.loc 4 8732 11
 12346 007c 837DF400 		cmpl	$0, -12(%rbp)
 12347 0080 7405     		je	.L730
8733:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         MBEDTLS_SSL_ALERT_LEVEL_WARNING,
8734:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         MBEDTLS_SSL_ALERT_MSG_CLOSE_NOTIFY ) ) != 0 )
8735:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
8736:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_send_alert_message", ret );
8737:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( ret );
 12348              		.loc 4 8737 19
 12349 0082 8B45F4   		movl	-12(%rbp), %eax
 12350 0085 EB05     		jmp	.L728
 12351              	.L730:
8738:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
8739:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8740:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8741:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= write close notify" ) );
8742:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8743:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 12352              		.loc 4 8743 11
 12353 0087 B8000000 		movl	$0, %eax
 12353      00
 12354              	.L728:
GAS LISTING /tmp/ccEn8xFO.s 			page 442


8744:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 12355              		.loc 4 8744 1
 12356 008c 488B4DF8 		movq	-8(%rbp), %rcx
 12357 0090 6448330C 		xorq	%fs:40, %rcx
 12357      25280000 
 12357      00
 12358 0099 7405     		je	.L731
 12359 009b E8000000 		call	__stack_chk_fail@PLT
 12359      00
 12360              	.L731:
 12361 00a0 C9       		leave
 12362              	.LCFI329:
 12363              		.cfi_def_cfa 7, 8
 12364 00a1 C3       		ret
 12365              		.cfi_endproc
 12366              	.LFE128:
 12368              		.section	.text.mbedtls_ssl_transform_free,"ax",@progbits
 12369              		.globl	mbedtls_ssl_transform_free
 12371              	mbedtls_ssl_transform_free:
 12372              	.LFB129:
8745:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8746:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_transform_free( mbedtls_ssl_transform *transform )
8747:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 12373              		.loc 4 8747 1
 12374              		.cfi_startproc
 12375 0000 F30F1EFA 		endbr64
 12376 0004 55       		pushq	%rbp
 12377              	.LCFI330:
 12378              		.cfi_def_cfa_offset 16
 12379              		.cfi_offset 6, -16
 12380 0005 4889E5   		movq	%rsp, %rbp
 12381              	.LCFI331:
 12382              		.cfi_def_cfa_register 6
 12383 0008 4883EC20 		subq	$32, %rsp
 12384 000c 48897DE8 		movq	%rdi, -24(%rbp)
 12385              		.loc 4 8747 1
 12386 0010 64488B04 		movq	%fs:40, %rax
 12386      25280000 
 12386      00
 12387 0019 488945F8 		movq	%rax, -8(%rbp)
 12388 001d 31C0     		xorl	%eax, %eax
8748:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( transform == NULL )
 12389              		.loc 4 8748 7
 12390 001f 48837DE8 		cmpq	$0, -24(%rbp)
 12390      00
 12391 0024 7455     		je	.L736
8749:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return;
8750:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8751:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_ZLIB_SUPPORT)
8752:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     deflateEnd( &transform->ctx_deflate );
8753:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     inflateEnd( &transform->ctx_inflate );
8754:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8755:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8756:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_cipher_free( &transform->cipher_ctx_enc );
 12392              		.loc 4 8756 5
 12393 0026 488B45E8 		movq	-24(%rbp), %rax
 12394 002a 4883E880 		subq	$-128, %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 443


 12395 002e 4889C7   		movq	%rax, %rdi
 12396 0031 E8000000 		call	mbedtls_cipher_free@PLT
 12396      00
8757:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_cipher_free( &transform->cipher_ctx_dec );
 12397              		.loc 4 8757 5
 12398 0036 488B45E8 		movq	-24(%rbp), %rax
 12399 003a 4805D800 		addq	$216, %rax
 12399      0000
 12400 0040 4889C7   		movq	%rax, %rdi
 12401 0043 E8000000 		call	mbedtls_cipher_free@PLT
 12401      00
8758:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8759:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_free( &transform->md_ctx_enc );
 12402              		.loc 4 8759 5
 12403 0048 488B45E8 		movq	-24(%rbp), %rax
 12404 004c 4883C050 		addq	$80, %rax
 12405 0050 4889C7   		movq	%rax, %rdi
 12406 0053 E8000000 		call	mbedtls_md_free@PLT
 12406      00
8760:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_free( &transform->md_ctx_dec );
 12407              		.loc 4 8760 5
 12408 0058 488B45E8 		movq	-24(%rbp), %rax
 12409 005c 4883C068 		addq	$104, %rax
 12410 0060 4889C7   		movq	%rax, %rdi
 12411 0063 E8000000 		call	mbedtls_md_free@PLT
 12411      00
8761:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8762:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_platform_zeroize( transform, sizeof( mbedtls_ssl_transform ) );
 12412              		.loc 4 8762 5
 12413 0068 488B45E8 		movq	-24(%rbp), %rax
 12414 006c BE300100 		movl	$304, %esi
 12414      00
 12415 0071 4889C7   		movq	%rax, %rdi
 12416 0074 E8000000 		call	mbedtls_platform_zeroize@PLT
 12416      00
 12417 0079 EB01     		jmp	.L732
 12418              	.L736:
8749:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 12419              		.loc 4 8749 9
 12420 007b 90       		nop
 12421              	.L732:
8763:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 12422              		.loc 4 8763 1
 12423 007c 488B45F8 		movq	-8(%rbp), %rax
 12424 0080 64483304 		xorq	%fs:40, %rax
 12424      25280000 
 12424      00
 12425 0089 7405     		je	.L735
 12426 008b E8000000 		call	__stack_chk_fail@PLT
 12426      00
 12427              	.L735:
 12428 0090 C9       		leave
 12429              	.LCFI332:
 12430              		.cfi_def_cfa 7, 8
 12431 0091 C3       		ret
 12432              		.cfi_endproc
 12433              	.LFE129:
GAS LISTING /tmp/ccEn8xFO.s 			page 444


 12435              		.section	.text.ssl_key_cert_free,"ax",@progbits
 12437              	ssl_key_cert_free:
 12438              	.LFB130:
8764:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8765:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
8766:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_key_cert_free( mbedtls_ssl_key_cert *key_cert )
8767:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 12439              		.loc 4 8767 1
 12440              		.cfi_startproc
 12441 0000 F30F1EFA 		endbr64
 12442 0004 55       		pushq	%rbp
 12443              	.LCFI333:
 12444              		.cfi_def_cfa_offset 16
 12445              		.cfi_offset 6, -16
 12446 0005 4889E5   		movq	%rsp, %rbp
 12447              	.LCFI334:
 12448              		.cfi_def_cfa_register 6
 12449 0008 4883EC30 		subq	$48, %rsp
 12450 000c 48897DD8 		movq	%rdi, -40(%rbp)
 12451              		.loc 4 8767 1
 12452 0010 64488B04 		movq	%fs:40, %rax
 12452      25280000 
 12452      00
 12453 0019 488945F8 		movq	%rax, -8(%rbp)
 12454 001d 31C0     		xorl	%eax, %eax
8768:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_key_cert *cur = key_cert, *next;
 12455              		.loc 4 8768 27
 12456 001f 488B45D8 		movq	-40(%rbp), %rax
 12457 0023 488945E8 		movq	%rax, -24(%rbp)
8769:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8770:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     while( cur != NULL )
 12458              		.loc 4 8770 10
 12459 0027 EB20     		jmp	.L738
 12460              	.L739:
8771:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8772:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         next = cur->next;
 12461              		.loc 4 8772 14
 12462 0029 488B45E8 		movq	-24(%rbp), %rax
 12463 002d 488B4010 		movq	16(%rax), %rax
 12464 0031 488945F0 		movq	%rax, -16(%rbp)
8773:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( cur );
 12465              		.loc 4 8773 9
 12466 0035 488B45E8 		movq	-24(%rbp), %rax
 12467 0039 4889C7   		movq	%rax, %rdi
 12468 003c E8000000 		call	mbedtls_free@PLT
 12468      00
8774:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         cur = next;
 12469              		.loc 4 8774 13
 12470 0041 488B45F0 		movq	-16(%rbp), %rax
 12471 0045 488945E8 		movq	%rax, -24(%rbp)
 12472              	.L738:
8770:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
 12473              		.loc 4 8770 10
 12474 0049 48837DE8 		cmpq	$0, -24(%rbp)
 12474      00
 12475 004e 75D9     		jne	.L739
8775:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
GAS LISTING /tmp/ccEn8xFO.s 			page 445


8776:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 12476              		.loc 4 8776 1
 12477 0050 90       		nop
 12478 0051 488B45F8 		movq	-8(%rbp), %rax
 12479 0055 64483304 		xorq	%fs:40, %rax
 12479      25280000 
 12479      00
 12480 005e 7405     		je	.L740
 12481 0060 E8000000 		call	__stack_chk_fail@PLT
 12481      00
 12482              	.L740:
 12483 0065 C9       		leave
 12484              	.LCFI335:
 12485              		.cfi_def_cfa 7, 8
 12486 0066 C3       		ret
 12487              		.cfi_endproc
 12488              	.LFE130:
 12490              		.section	.text.mbedtls_ssl_handshake_free,"ax",@progbits
 12491              		.globl	mbedtls_ssl_handshake_free
 12493              	mbedtls_ssl_handshake_free:
 12494              	.LFB131:
8777:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
8778:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8779:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
8780:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8781:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_buffering_free( mbedtls_ssl_context *ssl )
8782:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
8783:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     unsigned offset;
8784:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_handshake_params * const hs = ssl->handshake;
8785:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8786:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( hs == NULL )
8787:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return;
8788:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8789:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_free_buffered_record( ssl );
8790:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8791:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     for( offset = 0; offset < MBEDTLS_SSL_MAX_BUFFERED_HS; offset++ )
8792:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl_buffering_free_slot( ssl, offset );
8793:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
8794:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8795:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static void ssl_buffering_free_slot( mbedtls_ssl_context *ssl,
8796:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                      uint8_t slot )
8797:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
8798:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_handshake_params * const hs = ssl->handshake;
8799:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_hs_buffer * const hs_buf = &hs->buffering.hs[slot];
8800:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8801:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( slot >= MBEDTLS_SSL_MAX_BUFFERED_HS )
8802:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return;
8803:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8804:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( hs_buf->is_valid == 1 )
8805:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8806:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         hs->buffering.total_bytes_buffered -= hs_buf->data_len;
8807:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_platform_zeroize( hs_buf->data, hs_buf->data_len );
8808:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( hs_buf->data );
8809:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         memset( hs_buf, 0, sizeof( mbedtls_ssl_hs_buffer ) );
8810:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8811:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
8812:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 446


8813:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
8814:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8815:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_handshake_free( mbedtls_ssl_context *ssl )
8816:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 12495              		.loc 4 8816 1
 12496              		.cfi_startproc
 12497 0000 F30F1EFA 		endbr64
 12498 0004 55       		pushq	%rbp
 12499              	.LCFI336:
 12500              		.cfi_def_cfa_offset 16
 12501              		.cfi_offset 6, -16
 12502 0005 4889E5   		movq	%rsp, %rbp
 12503              	.LCFI337:
 12504              		.cfi_def_cfa_register 6
 12505 0008 4883EC20 		subq	$32, %rsp
 12506 000c 48897DE8 		movq	%rdi, -24(%rbp)
 12507              		.loc 4 8816 1
 12508 0010 64488B04 		movq	%fs:40, %rax
 12508      25280000 
 12508      00
 12509 0019 488945F8 		movq	%rax, -8(%rbp)
 12510 001d 31C0     		xorl	%eax, %eax
8817:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_handshake_params *handshake = ssl->handshake;
 12511              		.loc 4 8817 35
 12512 001f 488B45E8 		movq	-24(%rbp), %rax
 12513 0023 488B4060 		movq	96(%rax), %rax
 12514 0027 488945F0 		movq	%rax, -16(%rbp)
8818:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8819:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( handshake == NULL )
 12515              		.loc 4 8819 7
 12516 002b 48837DF0 		cmpq	$0, -16(%rbp)
 12516      00
 12517 0030 7448     		je	.L745
8820:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return;
8821:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8822:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_ASYNC_PRIVATE)
8823:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->f_async_cancel != NULL && handshake->async_in_progress != 0 )
8824:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8825:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ssl->conf->f_async_cancel( ssl );
8826:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         handshake->async_in_progress = 0;
8827:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8828:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_ASYNC_PRIVATE */
8829:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8830:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1) || \
8831:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_1)
8832:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_free(    &handshake->fin_md5  );
8833:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_free(   &handshake->fin_sha1 );
8834:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8835:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
8836:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
8837:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha256_free(   &handshake->fin_sha256    );
 12518              		.loc 4 8837 5
 12519 0032 488B45F0 		movq	-16(%rbp), %rax
 12520 0036 48058002 		addq	$640, %rax
 12520      0000
 12521 003c 4889C7   		movq	%rax, %rdi
 12522 003f E8000000 		call	mbedtls_sha256_free@PLT
GAS LISTING /tmp/ccEn8xFO.s 			page 447


 12522      00
8838:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8839:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
8840:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha512_free(   &handshake->fin_sha512    );
8841:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8842:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
8843:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8844:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_DHM_C)
8845:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_dhm_free( &handshake->dhm_ctx );
8846:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8847:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_ECDH_C)
8848:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ecdh_free( &handshake->ecdh_ctx );
 12523              		.loc 4 8848 5
 12524 0044 488B45F0 		movq	-16(%rbp), %rax
 12525 0048 4883C008 		addq	$8, %rax
 12526 004c 4889C7   		movq	%rax, %rdi
 12527 004f E8000000 		call	mbedtls_ecdh_free@PLT
 12527      00
8849:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8850:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
8851:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ecjpake_free( &handshake->ecjpake_ctx );
8852:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
8853:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_free( handshake->ecjpake_cache );
8854:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     handshake->ecjpake_cache = NULL;
8855:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     handshake->ecjpake_cache_len = 0;
8856:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8857:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8858:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8859:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_ECDH_C) || defined(MBEDTLS_ECDSA_C) || \
8860:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
8861:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* explicit void pointer cast for buggy MS compiler */
8862:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_free( (void *) handshake->curves );
 12528              		.loc 4 8862 37
 12529 0054 488B45F0 		movq	-16(%rbp), %rax
 12530 0058 488B8070 		movq	624(%rax), %rax
 12530      020000
 12531              		.loc 4 8862 5
 12532 005f 4889C7   		movq	%rax, %rdi
 12533 0062 E8000000 		call	mbedtls_free@PLT
 12533      00
8863:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8864:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8865:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED)
8866:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( handshake->psk != NULL )
8867:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8868:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_platform_zeroize( handshake->psk, handshake->psk_len );
8869:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( handshake->psk );
8870:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8871:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8872:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8873:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C) && \
8874:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     defined(MBEDTLS_SSL_SERVER_NAME_INDICATION)
8875:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
8876:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Free only the linked list wrapper, not the keys themselves
8877:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * since the belong to the SNI callback
8878:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
8879:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( handshake->sni_key_cert != NULL )
GAS LISTING /tmp/ccEn8xFO.s 			page 448


8880:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8881:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_key_cert *cur = handshake->sni_key_cert, *next;
8882:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8883:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         while( cur != NULL )
8884:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
8885:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             next = cur->next;
8886:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             mbedtls_free( cur );
8887:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             cur = next;
8888:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
8889:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8890:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_X509_CRT_PARSE_C && MBEDTLS_SSL_SERVER_NAME_INDICATION */
8891:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8892:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL__ECP_RESTARTABLE)
8893:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_x509_crt_restart_free( &handshake->ecrs_ctx );
8894:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8895:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8896:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
8897:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_free( handshake->verify_cookie );
8898:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_flight_free( handshake->flight );
8899:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_buffering_free( ssl );
8900:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8901:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8902:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_platform_zeroize( handshake,
 12534              		.loc 4 8902 5
 12535 0067 488B45F0 		movq	-16(%rbp), %rax
 12536 006b BEB80300 		movl	$952, %esi
 12536      00
 12537 0070 4889C7   		movq	%rax, %rdi
 12538 0073 E8000000 		call	mbedtls_platform_zeroize@PLT
 12538      00
 12539 0078 EB01     		jmp	.L741
 12540              	.L745:
8820:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 12541              		.loc 4 8820 9
 12542 007a 90       		nop
 12543              	.L741:
8903:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                               sizeof( mbedtls_ssl_handshake_params ) );
8904:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 12544              		.loc 4 8904 1
 12545 007b 488B45F8 		movq	-8(%rbp), %rax
 12546 007f 64483304 		xorq	%fs:40, %rax
 12546      25280000 
 12546      00
 12547 0088 7405     		je	.L744
 12548 008a E8000000 		call	__stack_chk_fail@PLT
 12548      00
 12549              	.L744:
 12550 008f C9       		leave
 12551              	.LCFI338:
 12552              		.cfi_def_cfa 7, 8
 12553 0090 C3       		ret
 12554              		.cfi_endproc
 12555              	.LFE131:
 12557              		.section	.text.mbedtls_ssl_session_free,"ax",@progbits
 12558              		.globl	mbedtls_ssl_session_free
 12560              	mbedtls_ssl_session_free:
 12561              	.LFB132:
GAS LISTING /tmp/ccEn8xFO.s 			page 449


8905:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8906:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_session_free( mbedtls_ssl_session *session )
8907:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 12562              		.loc 4 8907 1
 12563              		.cfi_startproc
 12564 0000 F30F1EFA 		endbr64
 12565 0004 55       		pushq	%rbp
 12566              	.LCFI339:
 12567              		.cfi_def_cfa_offset 16
 12568              		.cfi_offset 6, -16
 12569 0005 4889E5   		movq	%rsp, %rbp
 12570              	.LCFI340:
 12571              		.cfi_def_cfa_register 6
 12572 0008 4883EC20 		subq	$32, %rsp
 12573 000c 48897DE8 		movq	%rdi, -24(%rbp)
 12574              		.loc 4 8907 1
 12575 0010 64488B04 		movq	%fs:40, %rax
 12575      25280000 
 12575      00
 12576 0019 488945F8 		movq	%rax, -8(%rbp)
 12577 001d 31C0     		xorl	%eax, %eax
8908:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( session == NULL )
 12578              		.loc 4 8908 7
 12579 001f 48837DE8 		cmpq	$0, -24(%rbp)
 12579      00
 12580 0024 7450     		je	.L751
8909:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return;
8910:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8911:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
8912:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( session->peer_cert != NULL )
 12581              		.loc 4 8912 16
 12582 0026 488B45E8 		movq	-24(%rbp), %rax
 12583 002a 488B4060 		movq	96(%rax), %rax
 12584              		.loc 4 8912 7
 12585 002e 4885C0   		testq	%rax, %rax
 12586 0031 7420     		je	.L749
8913:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8914:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_x509_crt_free( session->peer_cert );
 12587              		.loc 4 8914 9
 12588 0033 488B45E8 		movq	-24(%rbp), %rax
 12589 0037 488B4060 		movq	96(%rax), %rax
 12590 003b 4889C7   		movq	%rax, %rdi
 12591 003e E8000000 		call	mbedtls_x509_crt_free@PLT
 12591      00
8915:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( session->peer_cert );
 12592              		.loc 4 8915 30
 12593 0043 488B45E8 		movq	-24(%rbp), %rax
 12594 0047 488B4060 		movq	96(%rax), %rax
 12595              		.loc 4 8915 9
 12596 004b 4889C7   		movq	%rax, %rdi
 12597 004e E8000000 		call	mbedtls_free@PLT
 12597      00
 12598              	.L749:
8916:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8917:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8918:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8919:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SESSION_TICKETS) && defined(MBEDTLS_SSL_CLI_C)
GAS LISTING /tmp/ccEn8xFO.s 			page 450


8920:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_free( session->ticket );
 12599              		.loc 4 8920 26
 12600 0053 488B45E8 		movq	-24(%rbp), %rax
 12601 0057 488B4070 		movq	112(%rax), %rax
 12602              		.loc 4 8920 5
 12603 005b 4889C7   		movq	%rax, %rdi
 12604 005e E8000000 		call	mbedtls_free@PLT
 12604      00
8921:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8922:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8923:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_platform_zeroize( session, sizeof( mbedtls_ssl_session ) );
 12605              		.loc 4 8923 5
 12606 0063 488B45E8 		movq	-24(%rbp), %rax
 12607 0067 BE880000 		movl	$136, %esi
 12607      00
 12608 006c 4889C7   		movq	%rax, %rdi
 12609 006f E8000000 		call	mbedtls_platform_zeroize@PLT
 12609      00
 12610 0074 EB01     		jmp	.L746
 12611              	.L751:
8909:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 12612              		.loc 4 8909 9
 12613 0076 90       		nop
 12614              	.L746:
8924:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 12615              		.loc 4 8924 1
 12616 0077 488B45F8 		movq	-8(%rbp), %rax
 12617 007b 64483304 		xorq	%fs:40, %rax
 12617      25280000 
 12617      00
 12618 0084 7405     		je	.L750
 12619 0086 E8000000 		call	__stack_chk_fail@PLT
 12619      00
 12620              	.L750:
 12621 008b C9       		leave
 12622              	.LCFI341:
 12623              		.cfi_def_cfa 7, 8
 12624 008c C3       		ret
 12625              		.cfi_endproc
 12626              	.LFE132:
 12628              		.section	.text.mbedtls_ssl_free,"ax",@progbits
 12629              		.globl	mbedtls_ssl_free
 12631              	mbedtls_ssl_free:
 12632              	.LFB133:
8925:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8926:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
8927:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Free an SSL context
8928:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
8929:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_free( mbedtls_ssl_context *ssl )
8930:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 12633              		.loc 4 8930 1
 12634              		.cfi_startproc
 12635 0000 F30F1EFA 		endbr64
 12636 0004 55       		pushq	%rbp
 12637              	.LCFI342:
 12638              		.cfi_def_cfa_offset 16
 12639              		.cfi_offset 6, -16
GAS LISTING /tmp/ccEn8xFO.s 			page 451


 12640 0005 4889E5   		movq	%rsp, %rbp
 12641              	.LCFI343:
 12642              		.cfi_def_cfa_register 6
 12643 0008 4883EC20 		subq	$32, %rsp
 12644 000c 48897DE8 		movq	%rdi, -24(%rbp)
 12645              		.loc 4 8930 1
 12646 0010 64488B04 		movq	%fs:40, %rax
 12646      25280000 
 12646      00
 12647 0019 488945F8 		movq	%rax, -8(%rbp)
 12648 001d 31C0     		xorl	%eax, %eax
8931:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl == NULL )
 12649              		.loc 4 8931 7
 12650 001f 48837DE8 		cmpq	$0, -24(%rbp)
 12650      00
 12651 0024 0F84A101 		je	.L762
 12651      0000
8932:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return;
8933:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8934:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> free" ) );
8935:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8936:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->out_buf != NULL )
 12652              		.loc 4 8936 12
 12653 002a 488B45E8 		movq	-24(%rbp), %rax
 12654 002e 488B8000 		movq	256(%rax), %rax
 12654      010000
 12655              		.loc 4 8936 7
 12656 0035 4885C0   		testq	%rax, %rax
 12657 0038 742B     		je	.L755
8937:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8938:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_platform_zeroize( ssl->out_buf, MBEDTLS_SSL_OUT_BUFFER_LEN );
 12658              		.loc 4 8938 38
 12659 003a 488B45E8 		movq	-24(%rbp), %rax
 12660 003e 488B8000 		movq	256(%rax), %rax
 12660      010000
 12661              		.loc 4 8938 9
 12662 0045 BEBD3F00 		movl	$16317, %esi
 12662      00
 12663 004a 4889C7   		movq	%rax, %rdi
 12664 004d E8000000 		call	mbedtls_platform_zeroize@PLT
 12664      00
8939:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( ssl->out_buf );
 12665              		.loc 4 8939 26
 12666 0052 488B45E8 		movq	-24(%rbp), %rax
 12667 0056 488B8000 		movq	256(%rax), %rax
 12667      010000
 12668              		.loc 4 8939 9
 12669 005d 4889C7   		movq	%rax, %rdi
 12670 0060 E8000000 		call	mbedtls_free@PLT
 12670      00
 12671              	.L755:
8940:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8941:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8942:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->in_buf != NULL )
 12672              		.loc 4 8942 12
 12673 0065 488B45E8 		movq	-24(%rbp), %rax
 12674 0069 488B80A0 		movq	160(%rax), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 452


 12674      000000
 12675              		.loc 4 8942 7
 12676 0070 4885C0   		testq	%rax, %rax
 12677 0073 742B     		je	.L756
8943:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8944:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_platform_zeroize( ssl->in_buf, MBEDTLS_SSL_IN_BUFFER_LEN );
 12678              		.loc 4 8944 38
 12679 0075 488B45E8 		movq	-24(%rbp), %rax
 12680 0079 488B80A0 		movq	160(%rax), %rax
 12680      000000
 12681              		.loc 4 8944 9
 12682 0080 BEBD3F00 		movl	$16317, %esi
 12682      00
 12683 0085 4889C7   		movq	%rax, %rdi
 12684 0088 E8000000 		call	mbedtls_platform_zeroize@PLT
 12684      00
8945:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( ssl->in_buf );
 12685              		.loc 4 8945 26
 12686 008d 488B45E8 		movq	-24(%rbp), %rax
 12687 0091 488B80A0 		movq	160(%rax), %rax
 12687      000000
 12688              		.loc 4 8945 9
 12689 0098 4889C7   		movq	%rax, %rdi
 12690 009b E8000000 		call	mbedtls_free@PLT
 12690      00
 12691              	.L756:
8946:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8947:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8948:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_ZLIB_SUPPORT)
8949:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->compress_buf != NULL )
8950:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8951:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_platform_zeroize( ssl->compress_buf, MBEDTLS_SSL_COMPRESS_BUFFER_LEN );
8952:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( ssl->compress_buf );
8953:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8954:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8955:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8956:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->transform )
 12692              		.loc 4 8956 12
 12693 00a0 488B45E8 		movq	-24(%rbp), %rax
 12694 00a4 488B4078 		movq	120(%rax), %rax
 12695              		.loc 4 8956 7
 12696 00a8 4885C0   		testq	%rax, %rax
 12697 00ab 7420     		je	.L757
8957:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8958:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_transform_free( ssl->transform );
 12698              		.loc 4 8958 9
 12699 00ad 488B45E8 		movq	-24(%rbp), %rax
 12700 00b1 488B4078 		movq	120(%rax), %rax
 12701 00b5 4889C7   		movq	%rax, %rdi
 12702 00b8 E8000000 		call	mbedtls_ssl_transform_free
 12702      00
8959:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( ssl->transform );
 12703              		.loc 4 8959 26
 12704 00bd 488B45E8 		movq	-24(%rbp), %rax
 12705 00c1 488B4078 		movq	120(%rax), %rax
 12706              		.loc 4 8959 9
 12707 00c5 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/ccEn8xFO.s 			page 453


 12708 00c8 E8000000 		call	mbedtls_free@PLT
 12708      00
 12709              	.L757:
8960:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8961:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8962:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->handshake )
 12710              		.loc 4 8962 12
 12711 00cd 488B45E8 		movq	-24(%rbp), %rax
 12712 00d1 488B4060 		movq	96(%rax), %rax
 12713              		.loc 4 8962 7
 12714 00d5 4885C0   		testq	%rax, %rax
 12715 00d8 7462     		je	.L758
8963:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8964:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_handshake_free( ssl );
 12716              		.loc 4 8964 9
 12717 00da 488B45E8 		movq	-24(%rbp), %rax
 12718 00de 4889C7   		movq	%rax, %rdi
 12719 00e1 E8000000 		call	mbedtls_ssl_handshake_free
 12719      00
8965:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_transform_free( ssl->transform_negotiate );
 12720              		.loc 4 8965 9
 12721 00e6 488B45E8 		movq	-24(%rbp), %rax
 12722 00ea 488B8080 		movq	128(%rax), %rax
 12722      000000
 12723 00f1 4889C7   		movq	%rax, %rdi
 12724 00f4 E8000000 		call	mbedtls_ssl_transform_free
 12724      00
8966:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_session_free( ssl->session_negotiate );
 12725              		.loc 4 8966 9
 12726 00f9 488B45E8 		movq	-24(%rbp), %rax
 12727 00fd 488B4058 		movq	88(%rax), %rax
 12728 0101 4889C7   		movq	%rax, %rdi
 12729 0104 E8000000 		call	mbedtls_ssl_session_free
 12729      00
8967:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8968:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( ssl->handshake );
 12730              		.loc 4 8968 26
 12731 0109 488B45E8 		movq	-24(%rbp), %rax
 12732 010d 488B4060 		movq	96(%rax), %rax
 12733              		.loc 4 8968 9
 12734 0111 4889C7   		movq	%rax, %rdi
 12735 0114 E8000000 		call	mbedtls_free@PLT
 12735      00
8969:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( ssl->transform_negotiate );
 12736              		.loc 4 8969 26
 12737 0119 488B45E8 		movq	-24(%rbp), %rax
 12738 011d 488B8080 		movq	128(%rax), %rax
 12738      000000
 12739              		.loc 4 8969 9
 12740 0124 4889C7   		movq	%rax, %rdi
 12741 0127 E8000000 		call	mbedtls_free@PLT
 12741      00
8970:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( ssl->session_negotiate );
 12742              		.loc 4 8970 26
 12743 012c 488B45E8 		movq	-24(%rbp), %rax
 12744 0130 488B4058 		movq	88(%rax), %rax
 12745              		.loc 4 8970 9
GAS LISTING /tmp/ccEn8xFO.s 			page 454


 12746 0134 4889C7   		movq	%rax, %rdi
 12747 0137 E8000000 		call	mbedtls_free@PLT
 12747      00
 12748              	.L758:
8971:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8972:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8973:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->session )
 12749              		.loc 4 8973 12
 12750 013c 488B45E8 		movq	-24(%rbp), %rax
 12751 0140 488B4050 		movq	80(%rax), %rax
 12752              		.loc 4 8973 7
 12753 0144 4885C0   		testq	%rax, %rax
 12754 0147 7420     		je	.L759
8974:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8975:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_session_free( ssl->session );
 12755              		.loc 4 8975 9
 12756 0149 488B45E8 		movq	-24(%rbp), %rax
 12757 014d 488B4050 		movq	80(%rax), %rax
 12758 0151 4889C7   		movq	%rax, %rdi
 12759 0154 E8000000 		call	mbedtls_ssl_session_free
 12759      00
8976:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( ssl->session );
 12760              		.loc 4 8976 26
 12761 0159 488B45E8 		movq	-24(%rbp), %rax
 12762 015d 488B4050 		movq	80(%rax), %rax
 12763              		.loc 4 8976 9
 12764 0161 4889C7   		movq	%rax, %rdi
 12765 0164 E8000000 		call	mbedtls_free@PLT
 12765      00
 12766              	.L759:
8977:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8978:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8979:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
8980:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->hostname != NULL )
 12767              		.loc 4 8980 12
 12768 0169 488B45E8 		movq	-24(%rbp), %rax
 12769 016d 488B8058 		movq	344(%rax), %rax
 12769      010000
 12770              		.loc 4 8980 7
 12771 0174 4885C0   		testq	%rax, %rax
 12772 0177 743F     		je	.L760
8981:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8982:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_platform_zeroize( ssl->hostname, strlen( ssl->hostname ) );
 12773              		.loc 4 8982 61
 12774 0179 488B45E8 		movq	-24(%rbp), %rax
 12775 017d 488B8058 		movq	344(%rax), %rax
 12775      010000
 12776              		.loc 4 8982 9
 12777 0184 4889C7   		movq	%rax, %rdi
 12778 0187 E8000000 		call	strlen@PLT
 12778      00
 12779 018c 4889C2   		movq	%rax, %rdx
 12780              		.loc 4 8982 38
 12781 018f 488B45E8 		movq	-24(%rbp), %rax
 12782 0193 488B8058 		movq	344(%rax), %rax
 12782      010000
 12783              		.loc 4 8982 9
GAS LISTING /tmp/ccEn8xFO.s 			page 455


 12784 019a 4889D6   		movq	%rdx, %rsi
 12785 019d 4889C7   		movq	%rax, %rdi
 12786 01a0 E8000000 		call	mbedtls_platform_zeroize@PLT
 12786      00
8983:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( ssl->hostname );
 12787              		.loc 4 8983 26
 12788 01a5 488B45E8 		movq	-24(%rbp), %rax
 12789 01a9 488B8058 		movq	344(%rax), %rax
 12789      010000
 12790              		.loc 4 8983 9
 12791 01b0 4889C7   		movq	%rax, %rdi
 12792 01b3 E8000000 		call	mbedtls_free@PLT
 12792      00
 12793              	.L760:
8984:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8985:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8986:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8987:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_HW_RECORD_ACCEL)
8988:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( mbedtls_ssl_hw_record_finish != NULL )
8989:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
8990:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "going for mbedtls_ssl_hw_record_finish()" ) );
8991:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_hw_record_finish( ssl );
8992:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
8993:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8994:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8995:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_HELLO_VERIFY) && defined(MBEDTLS_SSL_SRV_C)
8996:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_free( ssl->cli_id );
8997:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
8998:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
8999:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= free" ) );
9000:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9001:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Actually clear after last debug message */
9002:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_platform_zeroize( ssl, sizeof( mbedtls_ssl_context ) );
 12794              		.loc 4 9002 5
 12795 01b8 488B45E8 		movq	-24(%rbp), %rax
 12796 01bc BE880100 		movl	$392, %esi
 12796      00
 12797 01c1 4889C7   		movq	%rax, %rdi
 12798 01c4 E8000000 		call	mbedtls_platform_zeroize@PLT
 12798      00
 12799 01c9 EB01     		jmp	.L752
 12800              	.L762:
8932:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 12801              		.loc 4 8932 9
 12802 01cb 90       		nop
 12803              	.L752:
9003:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 12804              		.loc 4 9003 1
 12805 01cc 488B45F8 		movq	-8(%rbp), %rax
 12806 01d0 64483304 		xorq	%fs:40, %rax
 12806      25280000 
 12806      00
 12807 01d9 7405     		je	.L761
 12808 01db E8000000 		call	__stack_chk_fail@PLT
 12808      00
 12809              	.L761:
 12810 01e0 C9       		leave
GAS LISTING /tmp/ccEn8xFO.s 			page 456


 12811              	.LCFI344:
 12812              		.cfi_def_cfa 7, 8
 12813 01e1 C3       		ret
 12814              		.cfi_endproc
 12815              	.LFE133:
 12817              		.section	.text.mbedtls_ssl_config_init,"ax",@progbits
 12818              		.globl	mbedtls_ssl_config_init
 12820              	mbedtls_ssl_config_init:
 12821              	.LFB134:
9004:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9005:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
9006:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Initialze mbedtls_ssl_config
9007:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
9008:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_config_init( mbedtls_ssl_config *conf )
9009:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 12822              		.loc 4 9009 1
 12823              		.cfi_startproc
 12824 0000 F30F1EFA 		endbr64
 12825 0004 55       		pushq	%rbp
 12826              	.LCFI345:
 12827              		.cfi_def_cfa_offset 16
 12828              		.cfi_offset 6, -16
 12829 0005 4889E5   		movq	%rsp, %rbp
 12830              	.LCFI346:
 12831              		.cfi_def_cfa_register 6
 12832 0008 4883EC20 		subq	$32, %rsp
 12833 000c 48897DE8 		movq	%rdi, -24(%rbp)
 12834              		.loc 4 9009 1
 12835 0010 64488B04 		movq	%fs:40, %rax
 12835      25280000 
 12835      00
 12836 0019 488945F8 		movq	%rax, -8(%rbp)
 12837 001d 31C0     		xorl	%eax, %eax
9010:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memset( conf, 0, sizeof( mbedtls_ssl_config ) );
 12838              		.loc 4 9010 5
 12839 001f 488B45E8 		movq	-24(%rbp), %rax
 12840 0023 BAC00000 		movl	$192, %edx
 12840      00
 12841 0028 BE000000 		movl	$0, %esi
 12841      00
 12842 002d 4889C7   		movq	%rax, %rdi
 12843 0030 E8000000 		call	memset@PLT
 12843      00
9011:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 12844              		.loc 4 9011 1
 12845 0035 90       		nop
 12846 0036 488B45F8 		movq	-8(%rbp), %rax
 12847 003a 64483304 		xorq	%fs:40, %rax
 12847      25280000 
 12847      00
 12848 0043 7405     		je	.L764
 12849 0045 E8000000 		call	__stack_chk_fail@PLT
 12849      00
 12850              	.L764:
 12851 004a C9       		leave
 12852              	.LCFI347:
 12853              		.cfi_def_cfa 7, 8
GAS LISTING /tmp/ccEn8xFO.s 			page 457


 12854 004b C3       		ret
 12855              		.cfi_endproc
 12856              	.LFE134:
 12858              		.section	.data.ssl_preset_default_hashes,"aw"
 12859              		.align 8
 12862              	ssl_preset_default_hashes:
 12863 0000 06000000 		.long	6
 12864 0004 05000000 		.long	5
 12865 0008 00000000 		.long	0
 12866              		.section	.data.ssl_preset_suiteb_ciphersuites,"aw"
 12867              		.align 8
 12870              	ssl_preset_suiteb_ciphersuites:
 12871 0000 2BC00000 		.long	49195
 12872 0004 2CC00000 		.long	49196
 12873 0008 00000000 		.long	0
 12874              		.section	.data.ssl_preset_suiteb_hashes,"aw"
 12875              		.align 8
 12878              	ssl_preset_suiteb_hashes:
 12879 0000 06000000 		.long	6
 12880 0004 07000000 		.long	7
 12881 0008 00000000 		.long	0
 12882              		.section	.data.ssl_preset_suiteb_curves,"aw"
 12883              		.align 8
 12886              	ssl_preset_suiteb_curves:
 12887 0000 03000000 		.long	3
 12888 0004 04000000 		.long	4
 12889 0008 00000000 		.long	0
 12890              		.section	.text.mbedtls_ssl_config_defaults,"ax",@progbits
 12891              		.globl	mbedtls_ssl_config_defaults
 12893              	mbedtls_ssl_config_defaults:
 12894              	.LFB135:
9012:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9013:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
9014:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_preset_default_hashes[] = {
9015:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
9016:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_MD_SHA512,
9017:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_MD_SHA384,
9018:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9019:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
9020:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_MD_SHA256,
9021:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_MD_SHA224,
9022:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9023:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA1_C) && defined(MBEDTLS_TLS_DEFAULT_ALLOW_SHA1_IN_KEY_EXCHANGE)
9024:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_MD_SHA1,
9025:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9026:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_MD_NONE
9027:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** };
9028:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9029:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9030:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_preset_suiteb_ciphersuites[] = {
9031:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,
9032:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,
9033:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     0
9034:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** };
9035:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9036:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
9037:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static int ssl_preset_suiteb_hashes[] = {
GAS LISTING /tmp/ccEn8xFO.s 			page 458


9038:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_MD_SHA256,
9039:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_MD_SHA384,
9040:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_MD_NONE
9041:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** };
9042:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9043:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9044:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_ECP_C)
9045:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** static mbedtls_ecp_group_id ssl_preset_suiteb_curves[] = {
9046:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_ECP_DP_SECP256R1,
9047:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_ECP_DP_SECP384R1,
9048:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     MBEDTLS_ECP_DP_NONE
9049:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** };
9050:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9051:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9052:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
9053:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Load default in mbedtls_ssl_config
9054:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
9055:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_config_defaults( mbedtls_ssl_config *conf,
9056:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                  int endpoint, int transport, int preset )
9057:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 12895              		.loc 4 9057 1
 12896              		.cfi_startproc
 12897 0000 F30F1EFA 		endbr64
 12898 0004 55       		pushq	%rbp
 12899              	.LCFI348:
 12900              		.cfi_def_cfa_offset 16
 12901              		.cfi_offset 6, -16
 12902 0005 4889E5   		movq	%rsp, %rbp
 12903              	.LCFI349:
 12904              		.cfi_def_cfa_register 6
 12905 0008 4883EC30 		subq	$48, %rsp
 12906 000c 48897DE8 		movq	%rdi, -24(%rbp)
 12907 0010 8975E4   		movl	%esi, -28(%rbp)
 12908 0013 8955E0   		movl	%edx, -32(%rbp)
 12909 0016 894DDC   		movl	%ecx, -36(%rbp)
 12910              		.loc 4 9057 1
 12911 0019 64488B04 		movq	%fs:40, %rax
 12911      25280000 
 12911      00
 12912 0022 488945F8 		movq	%rax, -8(%rbp)
 12913 0026 31C0     		xorl	%eax, %eax
9058:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_DHM_C) && defined(MBEDTLS_SSL_SRV_C)
9059:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret;
9060:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9061:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9062:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /* Use the functions here so that they are covered in tests,
9063:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * but otherwise access member directly for efficiency */
9064:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_conf_endpoint( conf, endpoint );
 12914              		.loc 4 9064 5
 12915 0028 8B55E4   		movl	-28(%rbp), %edx
 12916 002b 488B45E8 		movq	-24(%rbp), %rax
 12917 002f 89D6     		movl	%edx, %esi
 12918 0031 4889C7   		movq	%rax, %rdi
 12919 0034 E8000000 		call	mbedtls_ssl_conf_endpoint
 12919      00
9065:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_ssl_conf_transport( conf, transport );
 12920              		.loc 4 9065 5
GAS LISTING /tmp/ccEn8xFO.s 			page 459


 12921 0039 8B55E0   		movl	-32(%rbp), %edx
 12922 003c 488B45E8 		movq	-24(%rbp), %rax
 12923 0040 89D6     		movl	%edx, %esi
 12924 0042 4889C7   		movq	%rax, %rdi
 12925 0045 E8000000 		call	mbedtls_ssl_conf_transport
 12925      00
9066:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9067:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
9068:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Things that are common to all presets
9069:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
9070:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
9071:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( endpoint == MBEDTLS_SSL_IS_CLIENT )
 12926              		.loc 4 9071 7
 12927 004a 837DE400 		cmpl	$0, -28(%rbp)
 12928 004e 752B     		jne	.L766
9072:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9073:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         conf->authmode = MBEDTLS_SSL_VERIFY_REQUIRED;
 12929              		.loc 4 9073 24
 12930 0050 488B45E8 		movq	-24(%rbp), %rax
 12931 0054 0FB690BC 		movzbl	188(%rax), %edx
 12931      000000
 12932 005b 83E2F3   		andl	$-13, %edx
 12933 005e 83CA08   		orl	$8, %edx
 12934 0061 8890BC00 		movb	%dl, 188(%rax)
 12934      0000
9074:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SESSION_TICKETS)
9075:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         conf->session_tickets = MBEDTLS_SSL_SESSION_TICKETS_ENABLED;
 12935              		.loc 4 9075 31
 12936 0067 488B45E8 		movq	-24(%rbp), %rax
 12937 006b 0FB690BD 		movzbl	189(%rax), %edx
 12937      000000
 12938 0072 83CA08   		orl	$8, %edx
 12939 0075 8890BD00 		movb	%dl, 189(%rax)
 12939      0000
 12940              	.L766:
9076:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9077:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9078:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9079:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9080:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_ARC4_C)
9081:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->arc4_disabled = MBEDTLS_SSL_ARC4_DISABLED;
9082:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9083:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9084:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_ENCRYPT_THEN_MAC)
9085:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->encrypt_then_mac = MBEDTLS_SSL_ETM_ENABLED;
9086:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9087:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9088:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_EXTENDED_MASTER_SECRET)
9089:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->extended_ms = MBEDTLS_SSL_EXTENDED_MS_ENABLED;
 12941              		.loc 4 9089 23
 12942 007b 488B45E8 		movq	-24(%rbp), %rax
 12943 007f 0FB690BD 		movzbl	189(%rax), %edx
 12943      000000
 12944 0086 83CA02   		orl	$2, %edx
 12945 0089 8890BD00 		movb	%dl, 189(%rax)
 12945      0000
9090:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
GAS LISTING /tmp/ccEn8xFO.s 			page 460


9091:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9092:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_CBC_RECORD_SPLITTING)
9093:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->cbc_record_splitting = MBEDTLS_SSL_CBC_RECORD_SPLITTING_ENABLED;
9094:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9095:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9096:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_HELLO_VERIFY) && defined(MBEDTLS_SSL_SRV_C)
9097:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->f_cookie_write = ssl_cookie_write_dummy;
9098:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->f_cookie_check = ssl_cookie_check_dummy;
9099:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9100:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9101:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_ANTI_REPLAY)
9102:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->anti_replay = MBEDTLS_SSL_ANTI_REPLAY_ENABLED;
9103:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9104:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9105:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
9106:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->cert_req_ca_list = MBEDTLS_SSL_CERT_REQ_CA_LIST_ENABLED;
9107:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9108:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9109:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
9110:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->hs_timeout_min = MBEDTLS_SSL_DTLS_TIMEOUT_DFL_MIN;
9111:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->hs_timeout_max = MBEDTLS_SSL_DTLS_TIMEOUT_DFL_MAX;
9112:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9113:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9114:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
9115:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     conf->renego_max_records = MBEDTLS_SSL_RENEGO_MAX_RECORDS_DEFAULT;
 12946              		.loc 4 9115 30
 12947 008f 488B45E8 		movq	-24(%rbp), %rax
 12948 0093 C780AC00 		movl	$16, 172(%rax)
 12948      00001000 
 12948      0000
9116:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memset( conf->renego_period,     0x00, 2 );
 12949              		.loc 4 9116 17
 12950 009d 488B45E8 		movq	-24(%rbp), %rax
 12951 00a1 4805B000 		addq	$176, %rax
 12951      0000
 12952              		.loc 4 9116 5
 12953 00a7 BA020000 		movl	$2, %edx
 12953      00
 12954 00ac BE000000 		movl	$0, %esi
 12954      00
 12955 00b1 4889C7   		movq	%rax, %rdi
 12956 00b4 E8000000 		call	memset@PLT
 12956      00
9117:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     memset( conf->renego_period + 2, 0xFF, 6 );
 12957              		.loc 4 9117 13
 12958 00b9 488B45E8 		movq	-24(%rbp), %rax
 12959 00bd 4805B000 		addq	$176, %rax
 12959      0000
 12960              		.loc 4 9117 5
 12961 00c3 4883C002 		addq	$2, %rax
 12962 00c7 BA060000 		movl	$6, %edx
 12962      00
 12963 00cc BEFF0000 		movl	$255, %esi
 12963      00
 12964 00d1 4889C7   		movq	%rax, %rdi
 12965 00d4 E8000000 		call	memset@PLT
 12965      00
GAS LISTING /tmp/ccEn8xFO.s 			page 461


9118:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9119:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9120:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_DHM_C) && defined(MBEDTLS_SSL_SRV_C)
9121:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( endpoint == MBEDTLS_SSL_IS_SERVER )
9122:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             {
9123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 const unsigned char dhm_p[] =
9124:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     MBEDTLS_DHM_RFC3526_MODP_2048_P_BIN;
9125:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 const unsigned char dhm_g[] =
9126:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     MBEDTLS_DHM_RFC3526_MODP_2048_G_BIN;
9127:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9128:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 if ( ( ret = mbedtls_ssl_conf_dh_param_bin( conf,
9129:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                                dhm_p, sizeof( dhm_p ),
9130:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                                dhm_g, sizeof( dhm_g ) ) ) != 0 )
9131:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 {
9132:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                     return( ret );
9133:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 }
9134:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             }
9135:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9136:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9137:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
9138:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * Preset-specific defaults
9139:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
9140:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     switch( preset )
 12966              		.loc 4 9140 5
 12967 00d9 837DDC02 		cmpl	$2, -36(%rbp)
 12968 00dd 0F85A200 		jne	.L767
 12968      0000
9141:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9142:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
9143:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * NSA Suite B
9144:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
9145:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_SSL_PRESET_SUITEB:
9146:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->min_major_ver = MBEDTLS_SSL_MAJOR_VERSION_3;
 12969              		.loc 4 9146 33
 12970 00e3 488B45E8 		movq	-24(%rbp), %rax
 12971 00e7 C680BA00 		movb	$3, 186(%rax)
 12971      000003
9147:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->min_minor_ver = MBEDTLS_SSL_MINOR_VERSION_3; /* TLS 1.2 */
 12972              		.loc 4 9147 33
 12973 00ee 488B45E8 		movq	-24(%rbp), %rax
 12974 00f2 C680BB00 		movb	$3, 187(%rax)
 12974      000003
9148:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->max_major_ver = MBEDTLS_SSL_MAX_MAJOR_VERSION;
 12975              		.loc 4 9148 33
 12976 00f9 488B45E8 		movq	-24(%rbp), %rax
 12977 00fd C680B800 		movb	$3, 184(%rax)
 12977      000003
9149:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->max_minor_ver = MBEDTLS_SSL_MAX_MINOR_VERSION;
 12978              		.loc 4 9149 33
 12979 0104 488B45E8 		movq	-24(%rbp), %rax
 12980 0108 C680B900 		movb	$3, 185(%rax)
 12980      000003
9150:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9151:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_0] =
9152:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_1] =
9153:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_2] =
9154:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_3] =
GAS LISTING /tmp/ccEn8xFO.s 			page 462


 12981              		.loc 4 9154 65
 12982 010f 488B45E8 		movq	-24(%rbp), %rax
 12983 0113 488D1500 		leaq	ssl_preset_suiteb_ciphersuites(%rip), %rdx
 12983      000000
 12984 011a 48895018 		movq	%rdx, 24(%rax)
 12985              		.loc 4 9154 35
 12986 011e 488B45E8 		movq	-24(%rbp), %rax
 12987 0122 488B5018 		movq	24(%rax), %rdx
9153:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_3] =
 12988              		.loc 4 9153 65
 12989 0126 488B45E8 		movq	-24(%rbp), %rax
 12990 012a 48895010 		movq	%rdx, 16(%rax)
9153:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_3] =
 12991              		.loc 4 9153 35
 12992 012e 488B45E8 		movq	-24(%rbp), %rax
 12993 0132 488B5010 		movq	16(%rax), %rdx
9152:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_2] =
 12994              		.loc 4 9152 65
 12995 0136 488B45E8 		movq	-24(%rbp), %rax
 12996 013a 48895008 		movq	%rdx, 8(%rax)
9152:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_2] =
 12997              		.loc 4 9152 35
 12998 013e 488B45E8 		movq	-24(%rbp), %rax
 12999 0142 488B5008 		movq	8(%rax), %rdx
9151:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_1] =
 13000              		.loc 4 9151 65
 13001 0146 488B45E8 		movq	-24(%rbp), %rax
 13002 014a 488910   		movq	%rdx, (%rax)
9155:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    ssl_preset_suiteb_ciphersuites;
9156:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9157:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
9158:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->cert_profile = &mbedtls_x509_crt_profile_suiteb;
 13003              		.loc 4 9158 32
 13004 014d 488B45E8 		movq	-24(%rbp), %rax
 13005 0151 488D1500 		leaq	mbedtls_x509_crt_profile_suiteb(%rip), %rdx
 13005      000000
 13006 0158 48895078 		movq	%rdx, 120(%rax)
9159:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9160:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9161:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
9162:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->sig_hashes = ssl_preset_suiteb_hashes;
 13007              		.loc 4 9162 30
 13008 015c 488B45E8 		movq	-24(%rbp), %rax
 13009 0160 488D1500 		leaq	ssl_preset_suiteb_hashes(%rip), %rdx
 13009      000000
 13010 0167 48899098 		movq	%rdx, 152(%rax)
 13010      000000
9163:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9164:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9165:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_ECP_C)
9166:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->curve_list = ssl_preset_suiteb_curves;
 13011              		.loc 4 9166 30
 13012 016e 488B45E8 		movq	-24(%rbp), %rax
 13013 0172 488D1500 		leaq	ssl_preset_suiteb_curves(%rip), %rdx
 13013      000000
 13014 0179 488990A0 		movq	%rdx, 160(%rax)
 13014      000000
GAS LISTING /tmp/ccEn8xFO.s 			page 463


9167:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9168:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             break;
 13015              		.loc 4 9168 13
 13016 0180 E9990000 		jmp	.L768
 13016      00
 13017              	.L767:
9169:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9170:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /*
9171:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          * Default
9172:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****          */
9173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         default:
9174:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->min_major_ver = ( MBEDTLS_SSL_MIN_MAJOR_VERSION >
 13018              		.loc 4 9174 33
 13019 0185 488B45E8 		movq	-24(%rbp), %rax
 13020 0189 C680BA00 		movb	$3, 186(%rax)
 13020      000003
9175:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     MBEDTLS_SSL_MIN_VALID_MAJOR_VERSION ) ?
9176:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     MBEDTLS_SSL_MIN_MAJOR_VERSION :
9177:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     MBEDTLS_SSL_MIN_VALID_MAJOR_VERSION;
9178:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->min_minor_ver = ( MBEDTLS_SSL_MIN_MINOR_VERSION >
 13021              		.loc 4 9178 33
 13022 0190 488B45E8 		movq	-24(%rbp), %rax
 13023 0194 C680BB00 		movb	$3, 187(%rax)
 13023      000003
9179:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     MBEDTLS_SSL_MIN_VALID_MINOR_VERSION ) ?
9180:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     MBEDTLS_SSL_MIN_MINOR_VERSION :
9181:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                     MBEDTLS_SSL_MIN_VALID_MINOR_VERSION;
9182:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->max_major_ver = MBEDTLS_SSL_MAX_MAJOR_VERSION;
 13024              		.loc 4 9182 33
 13025 019b 488B45E8 		movq	-24(%rbp), %rax
 13026 019f C680B800 		movb	$3, 184(%rax)
 13026      000003
9183:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->max_minor_ver = MBEDTLS_SSL_MAX_MINOR_VERSION;
 13027              		.loc 4 9183 33
 13028 01a6 488B45E8 		movq	-24(%rbp), %rax
 13029 01aa C680B900 		movb	$3, 185(%rax)
 13029      000003
9184:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9185:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
9186:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
9187:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 conf->min_minor_ver = MBEDTLS_SSL_MINOR_VERSION_2;
9188:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9189:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9190:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_0] =
9191:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_1] =
9192:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_2] =
9193:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_3] =
9194:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    mbedtls_ssl_list_ciphersuites();
 13030              		.loc 4 9194 36
 13031 01b1 E8000000 		call	mbedtls_ssl_list_ciphersuites@PLT
 13031      00
9193:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    mbedtls_ssl_list_ciphersuites();
 13032              		.loc 4 9193 65
 13033 01b6 488B55E8 		movq	-24(%rbp), %rdx
 13034 01ba 48894218 		movq	%rax, 24(%rdx)
9193:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    mbedtls_ssl_list_ciphersuites();
 13035              		.loc 4 9193 35
GAS LISTING /tmp/ccEn8xFO.s 			page 464


 13036 01be 488B45E8 		movq	-24(%rbp), %rax
 13037 01c2 488B5018 		movq	24(%rax), %rdx
9192:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_3] =
 13038              		.loc 4 9192 65
 13039 01c6 488B45E8 		movq	-24(%rbp), %rax
 13040 01ca 48895010 		movq	%rdx, 16(%rax)
9192:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_3] =
 13041              		.loc 4 9192 35
 13042 01ce 488B45E8 		movq	-24(%rbp), %rax
 13043 01d2 488B5010 		movq	16(%rax), %rdx
9191:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_2] =
 13044              		.loc 4 9191 65
 13045 01d6 488B45E8 		movq	-24(%rbp), %rax
 13046 01da 48895008 		movq	%rdx, 8(%rax)
9191:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_2] =
 13047              		.loc 4 9191 35
 13048 01de 488B45E8 		movq	-24(%rbp), %rax
 13049 01e2 488B5008 		movq	8(%rax), %rdx
9190:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_1] =
 13050              		.loc 4 9190 65
 13051 01e6 488B45E8 		movq	-24(%rbp), %rax
 13052 01ea 488910   		movq	%rdx, (%rax)
9195:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9196:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
9197:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->cert_profile = &mbedtls_x509_crt_profile_default;
 13053              		.loc 4 9197 32
 13054 01ed 488B45E8 		movq	-24(%rbp), %rax
 13055 01f1 488D1500 		leaq	mbedtls_x509_crt_profile_default(%rip), %rdx
 13055      000000
 13056 01f8 48895078 		movq	%rdx, 120(%rax)
9198:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9199:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
9201:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->sig_hashes = ssl_preset_default_hashes;
 13057              		.loc 4 9201 30
 13058 01fc 488B45E8 		movq	-24(%rbp), %rax
 13059 0200 488D1500 		leaq	ssl_preset_default_hashes(%rip), %rdx
 13059      000000
 13060 0207 48899098 		movq	%rdx, 152(%rax)
 13060      000000
9202:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9203:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9204:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_ECP_C)
9205:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->curve_list = mbedtls_ecp_grp_id_list();
 13061              		.loc 4 9205 32
 13062 020e E8000000 		call	mbedtls_ecp_grp_id_list@PLT
 13062      00
 13063              		.loc 4 9205 30
 13064 0213 488B55E8 		movq	-24(%rbp), %rdx
 13065 0217 488982A0 		movq	%rax, 160(%rdx)
 13065      000000
 13066              	.L768:
9206:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9207:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9208:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_DHM_C) && defined(MBEDTLS_SSL_CLI_C)
9209:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             conf->dhm_min_bitlen = 1024;
9210:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
GAS LISTING /tmp/ccEn8xFO.s 			page 465


9211:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9212:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9213:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( 0 );
 13067              		.loc 4 9213 11
 13068 021e B8000000 		movl	$0, %eax
 13068      00
9214:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 13069              		.loc 4 9214 1
 13070 0223 488B4DF8 		movq	-8(%rbp), %rcx
 13071 0227 6448330C 		xorq	%fs:40, %rcx
 13071      25280000 
 13071      00
 13072 0230 7405     		je	.L770
 13073 0232 E8000000 		call	__stack_chk_fail@PLT
 13073      00
 13074              	.L770:
 13075 0237 C9       		leave
 13076              	.LCFI350:
 13077              		.cfi_def_cfa 7, 8
 13078 0238 C3       		ret
 13079              		.cfi_endproc
 13080              	.LFE135:
 13082              		.section	.text.mbedtls_ssl_config_free,"ax",@progbits
 13083              		.globl	mbedtls_ssl_config_free
 13085              	mbedtls_ssl_config_free:
 13086              	.LFB136:
9215:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9216:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
9217:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Free mbedtls_ssl_config
9218:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
9219:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_config_free( mbedtls_ssl_config *conf )
9220:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 13087              		.loc 4 9220 1
 13088              		.cfi_startproc
 13089 0000 F30F1EFA 		endbr64
 13090 0004 55       		pushq	%rbp
 13091              	.LCFI351:
 13092              		.cfi_def_cfa_offset 16
 13093              		.cfi_offset 6, -16
 13094 0005 4889E5   		movq	%rsp, %rbp
 13095              	.LCFI352:
 13096              		.cfi_def_cfa_register 6
 13097 0008 4883EC20 		subq	$32, %rsp
 13098 000c 48897DE8 		movq	%rdi, -24(%rbp)
 13099              		.loc 4 9220 1
 13100 0010 64488B04 		movq	%fs:40, %rax
 13100      25280000 
 13100      00
 13101 0019 488945F8 		movq	%rax, -8(%rbp)
 13102 001d 31C0     		xorl	%eax, %eax
9221:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_DHM_C)
9222:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_mpi_free( &conf->dhm_P );
9223:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_mpi_free( &conf->dhm_G );
9224:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9225:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9226:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED)
9227:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( conf->psk != NULL )
GAS LISTING /tmp/ccEn8xFO.s 			page 466


9228:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9229:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_platform_zeroize( conf->psk, conf->psk_len );
9230:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( conf->psk );
9231:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         conf->psk = NULL;
9232:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         conf->psk_len = 0;
9233:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9234:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9235:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( conf->psk_identity != NULL )
9236:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9237:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_platform_zeroize( conf->psk_identity, conf->psk_identity_len );
9238:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_free( conf->psk_identity );
9239:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         conf->psk_identity = NULL;
9240:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         conf->psk_identity_len = 0;
9241:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9242:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9243:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9244:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
9245:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ssl_key_cert_free( conf->key_cert );
 13103              		.loc 4 9245 5
 13104 001f 488B45E8 		movq	-24(%rbp), %rax
 13105 0023 488B8080 		movq	128(%rax), %rax
 13105      000000
 13106 002a 4889C7   		movq	%rax, %rdi
 13107 002d E8000000 		call	ssl_key_cert_free
 13107      00
9246:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9247:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9248:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_platform_zeroize( conf, sizeof( mbedtls_ssl_config ) );
 13108              		.loc 4 9248 5
 13109 0032 488B45E8 		movq	-24(%rbp), %rax
 13110 0036 BEC00000 		movl	$192, %esi
 13110      00
 13111 003b 4889C7   		movq	%rax, %rdi
 13112 003e E8000000 		call	mbedtls_platform_zeroize@PLT
 13112      00
9249:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 13113              		.loc 4 9249 1
 13114 0043 90       		nop
 13115 0044 488B45F8 		movq	-8(%rbp), %rax
 13116 0048 64483304 		xorq	%fs:40, %rax
 13116      25280000 
 13116      00
 13117 0051 7405     		je	.L772
 13118 0053 E8000000 		call	__stack_chk_fail@PLT
 13118      00
 13119              	.L772:
 13120 0058 C9       		leave
 13121              	.LCFI353:
 13122              		.cfi_def_cfa 7, 8
 13123 0059 C3       		ret
 13124              		.cfi_endproc
 13125              	.LFE136:
 13127              		.section	.text.mbedtls_ssl_sig_from_pk,"ax",@progbits
 13128              		.globl	mbedtls_ssl_sig_from_pk
 13130              	mbedtls_ssl_sig_from_pk:
 13131              	.LFB137:
9250:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
GAS LISTING /tmp/ccEn8xFO.s 			page 467


9251:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_PK_C) && \
9252:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ( defined(MBEDTLS_RSA_C) || defined(MBEDTLS_ECDSA_C) )
9253:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
9254:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Convert between MBEDTLS_PK_XXX and SSL_SIG_XXX
9255:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
9256:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** unsigned char mbedtls_ssl_sig_from_pk( mbedtls_pk_context *pk )
9257:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 13132              		.loc 4 9257 1
 13133              		.cfi_startproc
 13134 0000 F30F1EFA 		endbr64
 13135 0004 55       		pushq	%rbp
 13136              	.LCFI354:
 13137              		.cfi_def_cfa_offset 16
 13138              		.cfi_offset 6, -16
 13139 0005 4889E5   		movq	%rsp, %rbp
 13140              	.LCFI355:
 13141              		.cfi_def_cfa_register 6
 13142 0008 4883EC20 		subq	$32, %rsp
 13143 000c 48897DE8 		movq	%rdi, -24(%rbp)
 13144              		.loc 4 9257 1
 13145 0010 64488B04 		movq	%fs:40, %rax
 13145      25280000 
 13145      00
 13146 0019 488945F8 		movq	%rax, -8(%rbp)
 13147 001d 31C0     		xorl	%eax, %eax
9258:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_RSA_C)
9259:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( mbedtls_pk_can_do( pk, MBEDTLS_PK_RSA ) )
 13148              		.loc 4 9259 9
 13149 001f 488B45E8 		movq	-24(%rbp), %rax
 13150 0023 BE010000 		movl	$1, %esi
 13150      00
 13151 0028 4889C7   		movq	%rax, %rdi
 13152 002b E8000000 		call	mbedtls_pk_can_do@PLT
 13152      00
 13153              		.loc 4 9259 7
 13154 0030 85C0     		testl	%eax, %eax
 13155 0032 7407     		je	.L774
9260:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_SSL_SIG_RSA );
 13156              		.loc 4 9260 15
 13157 0034 B8010000 		movl	$1, %eax
 13157      00
 13158 0039 EB21     		jmp	.L775
 13159              	.L774:
9261:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9262:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_ECDSA_C)
9263:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( mbedtls_pk_can_do( pk, MBEDTLS_PK_ECDSA ) )
 13160              		.loc 4 9263 9
 13161 003b 488B45E8 		movq	-24(%rbp), %rax
 13162 003f BE040000 		movl	$4, %esi
 13162      00
 13163 0044 4889C7   		movq	%rax, %rdi
 13164 0047 E8000000 		call	mbedtls_pk_can_do@PLT
 13164      00
 13165              		.loc 4 9263 7
 13166 004c 85C0     		testl	%eax, %eax
 13167 004e 7407     		je	.L776
9264:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( MBEDTLS_SSL_SIG_ECDSA );
GAS LISTING /tmp/ccEn8xFO.s 			page 468


 13168              		.loc 4 9264 15
 13169 0050 B8030000 		movl	$3, %eax
 13169      00
 13170 0055 EB05     		jmp	.L775
 13171              	.L776:
9265:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9266:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( MBEDTLS_SSL_SIG_ANON );
 13172              		.loc 4 9266 11
 13173 0057 B8000000 		movl	$0, %eax
 13173      00
 13174              	.L775:
9267:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 13175              		.loc 4 9267 1
 13176 005c 488B55F8 		movq	-8(%rbp), %rdx
 13177 0060 64483314 		xorq	%fs:40, %rdx
 13177      25280000 
 13177      00
 13178 0069 7405     		je	.L777
 13179 006b E8000000 		call	__stack_chk_fail@PLT
 13179      00
 13180              	.L777:
 13181 0070 C9       		leave
 13182              	.LCFI356:
 13183              		.cfi_def_cfa 7, 8
 13184 0071 C3       		ret
 13185              		.cfi_endproc
 13186              	.LFE137:
 13188              		.section	.text.mbedtls_ssl_sig_from_pk_alg,"ax",@progbits
 13189              		.globl	mbedtls_ssl_sig_from_pk_alg
 13191              	mbedtls_ssl_sig_from_pk_alg:
 13192              	.LFB138:
9268:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9269:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** unsigned char mbedtls_ssl_sig_from_pk_alg( mbedtls_pk_type_t type )
9270:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 13193              		.loc 4 9270 1
 13194              		.cfi_startproc
 13195 0000 F30F1EFA 		endbr64
 13196 0004 55       		pushq	%rbp
 13197              	.LCFI357:
 13198              		.cfi_def_cfa_offset 16
 13199              		.cfi_offset 6, -16
 13200 0005 4889E5   		movq	%rsp, %rbp
 13201              	.LCFI358:
 13202              		.cfi_def_cfa_register 6
 13203 0008 4883EC20 		subq	$32, %rsp
 13204 000c 897DEC   		movl	%edi, -20(%rbp)
 13205              		.loc 4 9270 1
 13206 000f 64488B04 		movq	%fs:40, %rax
 13206      25280000 
 13206      00
 13207 0018 488945F8 		movq	%rax, -8(%rbp)
 13208 001c 31C0     		xorl	%eax, %eax
9271:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     switch( type ) {
 13209              		.loc 4 9271 5
 13210 001e 837DEC04 		cmpl	$4, -20(%rbp)
 13211 0022 741B     		je	.L779
 13212 0024 837DEC04 		cmpl	$4, -20(%rbp)
GAS LISTING /tmp/ccEn8xFO.s 			page 469


 13213 0028 771C     		ja	.L780
 13214 002a 837DEC01 		cmpl	$1, -20(%rbp)
 13215 002e 7408     		je	.L781
 13216 0030 837DEC02 		cmpl	$2, -20(%rbp)
 13217 0034 7409     		je	.L779
 13218 0036 EB0E     		jmp	.L780
 13219              	.L781:
9272:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_PK_RSA:
9273:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_SSL_SIG_RSA );
 13220              		.loc 4 9273 19
 13221 0038 B8010000 		movl	$1, %eax
 13221      00
 13222 003d EB0C     		jmp	.L782
 13223              	.L779:
9274:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_PK_ECDSA:
9275:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_PK_ECKEY:
9276:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_SSL_SIG_ECDSA );
 13224              		.loc 4 9276 19
 13225 003f B8030000 		movl	$3, %eax
 13225      00
 13226 0044 EB05     		jmp	.L782
 13227              	.L780:
9277:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         default:
9278:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_SSL_SIG_ANON );
 13228              		.loc 4 9278 19
 13229 0046 B8000000 		movl	$0, %eax
 13229      00
 13230              	.L782:
9279:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9280:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 13231              		.loc 4 9280 1
 13232 004b 488B55F8 		movq	-8(%rbp), %rdx
 13233 004f 64483314 		xorq	%fs:40, %rdx
 13233      25280000 
 13233      00
 13234 0058 7405     		je	.L783
 13235 005a E8000000 		call	__stack_chk_fail@PLT
 13235      00
 13236              	.L783:
 13237 005f C9       		leave
 13238              	.LCFI359:
 13239              		.cfi_def_cfa 7, 8
 13240 0060 C3       		ret
 13241              		.cfi_endproc
 13242              	.LFE138:
 13244              		.section	.text.mbedtls_ssl_pk_alg_from_sig,"ax",@progbits
 13245              		.globl	mbedtls_ssl_pk_alg_from_sig
 13247              	mbedtls_ssl_pk_alg_from_sig:
 13248              	.LFB139:
9281:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9282:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** mbedtls_pk_type_t mbedtls_ssl_pk_alg_from_sig( unsigned char sig )
9283:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 13249              		.loc 4 9283 1
 13250              		.cfi_startproc
 13251 0000 F30F1EFA 		endbr64
 13252 0004 55       		pushq	%rbp
 13253              	.LCFI360:
GAS LISTING /tmp/ccEn8xFO.s 			page 470


 13254              		.cfi_def_cfa_offset 16
 13255              		.cfi_offset 6, -16
 13256 0005 4889E5   		movq	%rsp, %rbp
 13257              	.LCFI361:
 13258              		.cfi_def_cfa_register 6
 13259 0008 4883EC20 		subq	$32, %rsp
 13260 000c 89F8     		movl	%edi, %eax
 13261 000e 8845EC   		movb	%al, -20(%rbp)
 13262              		.loc 4 9283 1
 13263 0011 64488B04 		movq	%fs:40, %rax
 13263      25280000 
 13263      00
 13264 001a 488945F8 		movq	%rax, -8(%rbp)
 13265 001e 31C0     		xorl	%eax, %eax
9284:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     switch( sig )
 13266              		.loc 4 9284 5
 13267 0020 0FB645EC 		movzbl	-20(%rbp), %eax
 13268 0024 83F801   		cmpl	$1, %eax
 13269 0027 7407     		je	.L785
 13270 0029 83F803   		cmpl	$3, %eax
 13271 002c 7409     		je	.L786
 13272 002e EB0E     		jmp	.L790
 13273              	.L785:
9285:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9286:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_RSA_C)
9287:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_SSL_SIG_RSA:
9288:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_PK_RSA );
 13274              		.loc 4 9288 19
 13275 0030 B8010000 		movl	$1, %eax
 13275      00
 13276 0035 EB0C     		jmp	.L788
 13277              	.L786:
9289:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9290:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_ECDSA_C)
9291:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_SSL_SIG_ECDSA:
9292:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_PK_ECDSA );
 13278              		.loc 4 9292 19
 13279 0037 B8040000 		movl	$4, %eax
 13279      00
 13280 003c EB05     		jmp	.L788
 13281              	.L790:
9293:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9294:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         default:
9295:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_PK_NONE );
 13282              		.loc 4 9295 19
 13283 003e B8000000 		movl	$0, %eax
 13283      00
 13284              	.L788:
9296:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9297:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 13285              		.loc 4 9297 1
 13286 0043 488B55F8 		movq	-8(%rbp), %rdx
 13287 0047 64483314 		xorq	%fs:40, %rdx
 13287      25280000 
 13287      00
 13288 0050 7405     		je	.L789
 13289 0052 E8000000 		call	__stack_chk_fail@PLT
GAS LISTING /tmp/ccEn8xFO.s 			page 471


 13289      00
 13290              	.L789:
 13291 0057 C9       		leave
 13292              	.LCFI362:
 13293              		.cfi_def_cfa 7, 8
 13294 0058 C3       		ret
 13295              		.cfi_endproc
 13296              	.LFE139:
 13298              		.section	.text.mbedtls_ssl_sig_hash_set_find,"ax",@progbits
 13299              		.globl	mbedtls_ssl_sig_hash_set_find
 13301              	mbedtls_ssl_sig_hash_set_find:
 13302              	.LFB140:
9298:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_PK_C && ( MBEDTLS_RSA_C || MBEDTLS_ECDSA_C ) */
9299:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9300:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2) && \
9301:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
9302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9303:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /* Find an entry in a signature-hash set matching a given hash algorithm. */
9304:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** mbedtls_md_type_t mbedtls_ssl_sig_hash_set_find( mbedtls_ssl_sig_hash_set_t *set,
9305:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                                  mbedtls_pk_type_t sig_alg )
9306:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 13303              		.loc 4 9306 1
 13304              		.cfi_startproc
 13305 0000 F30F1EFA 		endbr64
 13306 0004 55       		pushq	%rbp
 13307              	.LCFI363:
 13308              		.cfi_def_cfa_offset 16
 13309              		.cfi_offset 6, -16
 13310 0005 4889E5   		movq	%rsp, %rbp
 13311              	.LCFI364:
 13312              		.cfi_def_cfa_register 6
 13313 0008 4883EC20 		subq	$32, %rsp
 13314 000c 48897DE8 		movq	%rdi, -24(%rbp)
 13315 0010 8975E4   		movl	%esi, -28(%rbp)
 13316              		.loc 4 9306 1
 13317 0013 64488B04 		movq	%fs:40, %rax
 13317      25280000 
 13317      00
 13318 001c 488945F8 		movq	%rax, -8(%rbp)
 13319 0020 31C0     		xorl	%eax, %eax
9307:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     switch( sig_alg )
 13320              		.loc 4 9307 5
 13321 0022 837DE401 		cmpl	$1, -28(%rbp)
 13322 0026 7408     		je	.L792
 13323 0028 837DE404 		cmpl	$4, -28(%rbp)
 13324 002c 740A     		je	.L793
 13325 002e EB11     		jmp	.L797
 13326              	.L792:
9308:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9309:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_PK_RSA:
9310:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( set->rsa );
 13327              		.loc 4 9310 24
 13328 0030 488B45E8 		movq	-24(%rbp), %rax
 13329 0034 8B00     		movl	(%rax), %eax
 13330 0036 EB0E     		jmp	.L795
 13331              	.L793:
9311:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_PK_ECDSA:
GAS LISTING /tmp/ccEn8xFO.s 			page 472


9312:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( set->ecdsa );
 13332              		.loc 4 9312 24
 13333 0038 488B45E8 		movq	-24(%rbp), %rax
 13334 003c 8B4004   		movl	4(%rax), %eax
 13335 003f EB05     		jmp	.L795
 13336              	.L797:
9313:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         default:
9314:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_MD_NONE );
 13337              		.loc 4 9314 19
 13338 0041 B8000000 		movl	$0, %eax
 13338      00
 13339              	.L795:
9315:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9316:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 13340              		.loc 4 9316 1
 13341 0046 488B55F8 		movq	-8(%rbp), %rdx
 13342 004a 64483314 		xorq	%fs:40, %rdx
 13342      25280000 
 13342      00
 13343 0053 7405     		je	.L796
 13344 0055 E8000000 		call	__stack_chk_fail@PLT
 13344      00
 13345              	.L796:
 13346 005a C9       		leave
 13347              	.LCFI365:
 13348              		.cfi_def_cfa 7, 8
 13349 005b C3       		ret
 13350              		.cfi_endproc
 13351              	.LFE140:
 13353              		.section	.text.mbedtls_ssl_sig_hash_set_add,"ax",@progbits
 13354              		.globl	mbedtls_ssl_sig_hash_set_add
 13356              	mbedtls_ssl_sig_hash_set_add:
 13357              	.LFB141:
9317:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9318:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /* Add a signature-hash-pair to a signature-hash set */
9319:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_sig_hash_set_add( mbedtls_ssl_sig_hash_set_t *set,
9320:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    mbedtls_pk_type_t sig_alg,
9321:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                    mbedtls_md_type_t md_alg )
9322:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 13358              		.loc 4 9322 1
 13359              		.cfi_startproc
 13360 0000 F30F1EFA 		endbr64
 13361 0004 55       		pushq	%rbp
 13362              	.LCFI366:
 13363              		.cfi_def_cfa_offset 16
 13364              		.cfi_offset 6, -16
 13365 0005 4889E5   		movq	%rsp, %rbp
 13366              	.LCFI367:
 13367              		.cfi_def_cfa_register 6
 13368 0008 4883EC20 		subq	$32, %rsp
 13369 000c 48897DE8 		movq	%rdi, -24(%rbp)
 13370 0010 8975E4   		movl	%esi, -28(%rbp)
 13371 0013 8955E0   		movl	%edx, -32(%rbp)
 13372              		.loc 4 9322 1
 13373 0016 64488B04 		movq	%fs:40, %rax
 13373      25280000 
 13373      00
GAS LISTING /tmp/ccEn8xFO.s 			page 473


 13374 001f 488945F8 		movq	%rax, -8(%rbp)
 13375 0023 31C0     		xorl	%eax, %eax
9323:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     switch( sig_alg )
 13376              		.loc 4 9323 5
 13377 0025 837DE401 		cmpl	$1, -28(%rbp)
 13378 0029 7408     		je	.L799
 13379 002b 837DE404 		cmpl	$4, -28(%rbp)
 13380 002f 7417     		je	.L800
9324:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9325:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_PK_RSA:
9326:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( set->rsa == MBEDTLS_MD_NONE )
9327:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 set->rsa = md_alg;
9328:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             break;
9329:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9330:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_PK_ECDSA:
9331:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             if( set->ecdsa == MBEDTLS_MD_NONE )
9332:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 set->ecdsa = md_alg;
9333:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             break;
9334:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9335:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         default:
9336:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             break;
 13381              		.loc 4 9336 13
 13382 0031 EB30     		jmp	.L803
 13383              	.L799:
9326:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 set->rsa = md_alg;
 13384              		.loc 4 9326 20
 13385 0033 488B45E8 		movq	-24(%rbp), %rax
 13386 0037 8B00     		movl	(%rax), %eax
9326:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 set->rsa = md_alg;
 13387              		.loc 4 9326 15
 13388 0039 85C0     		testl	%eax, %eax
 13389 003b 7522     		jne	.L806
9327:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             break;
 13390              		.loc 4 9327 26
 13391 003d 488B45E8 		movq	-24(%rbp), %rax
 13392 0041 8B55E0   		movl	-32(%rbp), %edx
 13393 0044 8910     		movl	%edx, (%rax)
9328:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 13394              		.loc 4 9328 13
 13395 0046 EB17     		jmp	.L806
 13396              	.L800:
9331:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 set->ecdsa = md_alg;
 13397              		.loc 4 9331 20
 13398 0048 488B45E8 		movq	-24(%rbp), %rax
 13399 004c 8B4004   		movl	4(%rax), %eax
9331:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 set->ecdsa = md_alg;
 13400              		.loc 4 9331 15
 13401 004f 85C0     		testl	%eax, %eax
 13402 0051 750F     		jne	.L807
9332:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             break;
 13403              		.loc 4 9332 28
 13404 0053 488B45E8 		movq	-24(%rbp), %rax
 13405 0057 8B55E0   		movl	-32(%rbp), %edx
 13406 005a 895004   		movl	%edx, 4(%rax)
9333:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 13407              		.loc 4 9333 13
 13408 005d EB03     		jmp	.L807
GAS LISTING /tmp/ccEn8xFO.s 			page 474


 13409              	.L806:
9328:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 13410              		.loc 4 9328 13
 13411 005f 90       		nop
 13412 0060 EB01     		jmp	.L803
 13413              	.L807:
9333:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
 13414              		.loc 4 9333 13
 13415 0062 90       		nop
 13416              	.L803:
9337:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9338:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 13417              		.loc 4 9338 1
 13418 0063 90       		nop
 13419 0064 488B45F8 		movq	-8(%rbp), %rax
 13420 0068 64483304 		xorq	%fs:40, %rax
 13420      25280000 
 13420      00
 13421 0071 7405     		je	.L805
 13422 0073 E8000000 		call	__stack_chk_fail@PLT
 13422      00
 13423              	.L805:
 13424 0078 C9       		leave
 13425              	.LCFI368:
 13426              		.cfi_def_cfa 7, 8
 13427 0079 C3       		ret
 13428              		.cfi_endproc
 13429              	.LFE141:
 13431              		.section	.text.mbedtls_ssl_sig_hash_set_const_hash,"ax",@progbits
 13432              		.globl	mbedtls_ssl_sig_hash_set_const_hash
 13434              	mbedtls_ssl_sig_hash_set_const_hash:
 13435              	.LFB142:
9339:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9340:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /* Allow exactly one hash algorithm for each signature. */
9341:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_sig_hash_set_const_hash( mbedtls_ssl_sig_hash_set_t *set,
9342:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                           mbedtls_md_type_t md_alg )
9343:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 13436              		.loc 4 9343 1
 13437              		.cfi_startproc
 13438 0000 F30F1EFA 		endbr64
 13439 0004 55       		pushq	%rbp
 13440              	.LCFI369:
 13441              		.cfi_def_cfa_offset 16
 13442              		.cfi_offset 6, -16
 13443 0005 4889E5   		movq	%rsp, %rbp
 13444              	.LCFI370:
 13445              		.cfi_def_cfa_register 6
 13446 0008 4883EC20 		subq	$32, %rsp
 13447 000c 48897DE8 		movq	%rdi, -24(%rbp)
 13448 0010 8975E4   		movl	%esi, -28(%rbp)
 13449              		.loc 4 9343 1
 13450 0013 64488B04 		movq	%fs:40, %rax
 13450      25280000 
 13450      00
 13451 001c 488945F8 		movq	%rax, -8(%rbp)
 13452 0020 31C0     		xorl	%eax, %eax
9344:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     set->rsa   = md_alg;
GAS LISTING /tmp/ccEn8xFO.s 			page 475


 13453              		.loc 4 9344 16
 13454 0022 488B45E8 		movq	-24(%rbp), %rax
 13455 0026 8B55E4   		movl	-28(%rbp), %edx
 13456 0029 8910     		movl	%edx, (%rax)
9345:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     set->ecdsa = md_alg;
 13457              		.loc 4 9345 16
 13458 002b 488B45E8 		movq	-24(%rbp), %rax
 13459 002f 8B55E4   		movl	-28(%rbp), %edx
 13460 0032 895004   		movl	%edx, 4(%rax)
9346:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 13461              		.loc 4 9346 1
 13462 0035 90       		nop
 13463 0036 488B45F8 		movq	-8(%rbp), %rax
 13464 003a 64483304 		xorq	%fs:40, %rax
 13464      25280000 
 13464      00
 13465 0043 7405     		je	.L809
 13466 0045 E8000000 		call	__stack_chk_fail@PLT
 13466      00
 13467              	.L809:
 13468 004a C9       		leave
 13469              	.LCFI371:
 13470              		.cfi_def_cfa 7, 8
 13471 004b C3       		ret
 13472              		.cfi_endproc
 13473              	.LFE142:
 13475              		.section	.text.mbedtls_ssl_md_alg_from_hash,"ax",@progbits
 13476              		.globl	mbedtls_ssl_md_alg_from_hash
 13478              	mbedtls_ssl_md_alg_from_hash:
 13479              	.LFB143:
9347:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9348:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2) &&
9349:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****           MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED */
9350:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9351:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
9352:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Convert from MBEDTLS_SSL_HASH_XXX to MBEDTLS_MD_XXX
9353:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
9354:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** mbedtls_md_type_t mbedtls_ssl_md_alg_from_hash( unsigned char hash )
9355:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 13480              		.loc 4 9355 1
 13481              		.cfi_startproc
 13482 0000 F30F1EFA 		endbr64
 13483 0004 55       		pushq	%rbp
 13484              	.LCFI372:
 13485              		.cfi_def_cfa_offset 16
 13486              		.cfi_offset 6, -16
 13487 0005 4889E5   		movq	%rsp, %rbp
 13488              	.LCFI373:
 13489              		.cfi_def_cfa_register 6
 13490 0008 4883EC20 		subq	$32, %rsp
 13491 000c 89F8     		movl	%edi, %eax
 13492 000e 8845EC   		movb	%al, -20(%rbp)
 13493              		.loc 4 9355 1
 13494 0011 64488B04 		movq	%fs:40, %rax
 13494      25280000 
 13494      00
 13495 001a 488945F8 		movq	%rax, -8(%rbp)
GAS LISTING /tmp/ccEn8xFO.s 			page 476


 13496 001e 31C0     		xorl	%eax, %eax
9356:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     switch( hash )
 13497              		.loc 4 9356 5
 13498 0020 0FB645EC 		movzbl	-20(%rbp), %eax
 13499 0024 83F804   		cmpl	$4, %eax
 13500 0027 741F     		je	.L811
 13501 0029 83F804   		cmpl	$4, %eax
 13502 002c 7F21     		jg	.L812
 13503 002e 83F802   		cmpl	$2, %eax
 13504 0031 7407     		je	.L813
 13505 0033 83F803   		cmpl	$3, %eax
 13506 0036 7409     		je	.L814
 13507 0038 EB15     		jmp	.L812
 13508              	.L813:
9357:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9358:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_MD5_C)
9359:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_SSL_HASH_MD5:
9360:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_MD_MD5 );
9361:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9362:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA1_C)
9363:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_SSL_HASH_SHA1:
9364:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_MD_SHA1 );
 13509              		.loc 4 9364 19
 13510 003a B8040000 		movl	$4, %eax
 13510      00
 13511 003f EB13     		jmp	.L815
 13512              	.L814:
9365:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9366:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
9367:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_SSL_HASH_SHA224:
9368:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_MD_SHA224 );
 13513              		.loc 4 9368 19
 13514 0041 B8050000 		movl	$5, %eax
 13514      00
 13515 0046 EB0C     		jmp	.L815
 13516              	.L811:
9369:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_SSL_HASH_SHA256:
9370:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_MD_SHA256 );
 13517              		.loc 4 9370 19
 13518 0048 B8060000 		movl	$6, %eax
 13518      00
 13519 004d EB05     		jmp	.L815
 13520              	.L812:
9371:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9372:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
9373:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_SSL_HASH_SHA384:
9374:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_MD_SHA384 );
9375:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_SSL_HASH_SHA512:
9376:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_MD_SHA512 );
9377:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9378:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         default:
9379:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_MD_NONE );
 13521              		.loc 4 9379 19
 13522 004f B8000000 		movl	$0, %eax
 13522      00
 13523              	.L815:
9380:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
GAS LISTING /tmp/ccEn8xFO.s 			page 477


9381:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 13524              		.loc 4 9381 1
 13525 0054 488B55F8 		movq	-8(%rbp), %rdx
 13526 0058 64483314 		xorq	%fs:40, %rdx
 13526      25280000 
 13526      00
 13527 0061 7405     		je	.L816
 13528 0063 E8000000 		call	__stack_chk_fail@PLT
 13528      00
 13529              	.L816:
 13530 0068 C9       		leave
 13531              	.LCFI374:
 13532              		.cfi_def_cfa 7, 8
 13533 0069 C3       		ret
 13534              		.cfi_endproc
 13535              	.LFE143:
 13537              		.section	.text.mbedtls_ssl_hash_from_md_alg,"ax",@progbits
 13538              		.globl	mbedtls_ssl_hash_from_md_alg
 13540              	mbedtls_ssl_hash_from_md_alg:
 13541              	.LFB144:
9382:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9383:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
9384:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Convert from MBEDTLS_MD_XXX to MBEDTLS_SSL_HASH_XXX
9385:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
9386:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** unsigned char mbedtls_ssl_hash_from_md_alg( int md )
9387:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 13542              		.loc 4 9387 1
 13543              		.cfi_startproc
 13544 0000 F30F1EFA 		endbr64
 13545 0004 55       		pushq	%rbp
 13546              	.LCFI375:
 13547              		.cfi_def_cfa_offset 16
 13548              		.cfi_offset 6, -16
 13549 0005 4889E5   		movq	%rsp, %rbp
 13550              	.LCFI376:
 13551              		.cfi_def_cfa_register 6
 13552 0008 4883EC20 		subq	$32, %rsp
 13553 000c 897DEC   		movl	%edi, -20(%rbp)
 13554              		.loc 4 9387 1
 13555 000f 64488B04 		movq	%fs:40, %rax
 13555      25280000 
 13555      00
 13556 0018 488945F8 		movq	%rax, -8(%rbp)
 13557 001c 31C0     		xorl	%eax, %eax
9388:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     switch( md )
 13558              		.loc 4 9388 5
 13559 001e 837DEC06 		cmpl	$6, -20(%rbp)
 13560 0022 7422     		je	.L818
 13561 0024 837DEC06 		cmpl	$6, -20(%rbp)
 13562 0028 7F23     		jg	.L819
 13563 002a 837DEC04 		cmpl	$4, -20(%rbp)
 13564 002e 7408     		je	.L820
 13565 0030 837DEC05 		cmpl	$5, -20(%rbp)
 13566 0034 7409     		je	.L821
 13567 0036 EB15     		jmp	.L819
 13568              	.L820:
9389:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
GAS LISTING /tmp/ccEn8xFO.s 			page 478


9390:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_MD5_C)
9391:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_MD_MD5:
9392:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_SSL_HASH_MD5 );
9393:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9394:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA1_C)
9395:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_MD_SHA1:
9396:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_SSL_HASH_SHA1 );
 13569              		.loc 4 9396 19
 13570 0038 B8020000 		movl	$2, %eax
 13570      00
 13571 003d EB13     		jmp	.L822
 13572              	.L821:
9397:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9398:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
9399:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_MD_SHA224:
9400:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_SSL_HASH_SHA224 );
 13573              		.loc 4 9400 19
 13574 003f B8030000 		movl	$3, %eax
 13574      00
 13575 0044 EB0C     		jmp	.L822
 13576              	.L818:
9401:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_MD_SHA256:
9402:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_SSL_HASH_SHA256 );
 13577              		.loc 4 9402 19
 13578 0046 B8040000 		movl	$4, %eax
 13578      00
 13579 004b EB05     		jmp	.L822
 13580              	.L819:
9403:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9404:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
9405:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_MD_SHA384:
9406:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_SSL_HASH_SHA384 );
9407:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_MD_SHA512:
9408:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_SSL_HASH_SHA512 );
9409:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9410:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         default:
9411:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( MBEDTLS_SSL_HASH_NONE );
 13581              		.loc 4 9411 19
 13582 004d B8000000 		movl	$0, %eax
 13582      00
 13583              	.L822:
9412:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9413:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 13584              		.loc 4 9413 1
 13585 0052 488B55F8 		movq	-8(%rbp), %rdx
 13586 0056 64483314 		xorq	%fs:40, %rdx
 13586      25280000 
 13586      00
 13587 005f 7405     		je	.L823
 13588 0061 E8000000 		call	__stack_chk_fail@PLT
 13588      00
 13589              	.L823:
 13590 0066 C9       		leave
 13591              	.LCFI377:
 13592              		.cfi_def_cfa 7, 8
 13593 0067 C3       		ret
 13594              		.cfi_endproc
GAS LISTING /tmp/ccEn8xFO.s 			page 479


 13595              	.LFE144:
 13597              		.section	.text.mbedtls_ssl_check_curve,"ax",@progbits
 13598              		.globl	mbedtls_ssl_check_curve
 13600              	mbedtls_ssl_check_curve:
 13601              	.LFB145:
9414:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9415:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_ECP_C)
9416:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
9417:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Check if a curve proposed by the peer is in our list.
9418:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Return 0 if we're willing to use it, -1 otherwise.
9419:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
9420:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_check_curve( const mbedtls_ssl_context *ssl, mbedtls_ecp_group_id grp_id )
9421:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 13602              		.loc 4 9421 1
 13603              		.cfi_startproc
 13604 0000 F30F1EFA 		endbr64
 13605 0004 55       		pushq	%rbp
 13606              	.LCFI378:
 13607              		.cfi_def_cfa_offset 16
 13608              		.cfi_offset 6, -16
 13609 0005 4889E5   		movq	%rsp, %rbp
 13610              	.LCFI379:
 13611              		.cfi_def_cfa_register 6
 13612 0008 4883EC20 		subq	$32, %rsp
 13613 000c 48897DE8 		movq	%rdi, -24(%rbp)
 13614 0010 8975E4   		movl	%esi, -28(%rbp)
 13615              		.loc 4 9421 1
 13616 0013 64488B04 		movq	%fs:40, %rax
 13616      25280000 
 13616      00
 13617 001c 488945F8 		movq	%rax, -8(%rbp)
 13618 0020 31C0     		xorl	%eax, %eax
9422:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const mbedtls_ecp_group_id *gid;
9423:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9424:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->curve_list == NULL )
 13619              		.loc 4 9424 12
 13620 0022 488B45E8 		movq	-24(%rbp), %rax
 13621 0026 488B00   		movq	(%rax), %rax
 13622              		.loc 4 9424 18
 13623 0029 488B80A0 		movq	160(%rax), %rax
 13623      000000
 13624              		.loc 4 9424 7
 13625 0030 4885C0   		testq	%rax, %rax
 13626 0033 7507     		jne	.L825
9425:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( -1 );
 13627              		.loc 4 9425 15
 13628 0035 B8FFFFFF 		movl	$-1, %eax
 13628      FF
 13629 003a EB3A     		jmp	.L826
 13630              	.L825:
9426:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9427:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     for( gid = ssl->conf->curve_list; *gid != MBEDTLS_ECP_DP_NONE; gid++ )
 13631              		.loc 4 9427 19
 13632 003c 488B45E8 		movq	-24(%rbp), %rax
 13633 0040 488B00   		movq	(%rax), %rax
 13634              		.loc 4 9427 14
 13635 0043 488B80A0 		movq	160(%rax), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 480


 13635      000000
 13636 004a 488945F0 		movq	%rax, -16(%rbp)
 13637              		.loc 4 9427 5
 13638 004e EB17     		jmp	.L827
 13639              	.L829:
9428:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( *gid == grp_id )
 13640              		.loc 4 9428 13
 13641 0050 488B45F0 		movq	-16(%rbp), %rax
 13642 0054 8B00     		movl	(%rax), %eax
 13643              		.loc 4 9428 11
 13644 0056 3945E4   		cmpl	%eax, -28(%rbp)
 13645 0059 7507     		jne	.L828
9429:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( 0 );
 13646              		.loc 4 9429 19
 13647 005b B8000000 		movl	$0, %eax
 13647      00
 13648 0060 EB14     		jmp	.L826
 13649              	.L828:
9427:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( *gid == grp_id )
 13650              		.loc 4 9427 71 discriminator 2
 13651 0062 488345F0 		addq	$4, -16(%rbp)
 13651      04
 13652              	.L827:
9427:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( *gid == grp_id )
 13653              		.loc 4 9427 39 discriminator 1
 13654 0067 488B45F0 		movq	-16(%rbp), %rax
 13655 006b 8B00     		movl	(%rax), %eax
9427:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( *gid == grp_id )
 13656              		.loc 4 9427 5 discriminator 1
 13657 006d 85C0     		testl	%eax, %eax
 13658 006f 75DF     		jne	.L829
9430:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9431:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( -1 );
 13659              		.loc 4 9431 11
 13660 0071 B8FFFFFF 		movl	$-1, %eax
 13660      FF
 13661              	.L826:
9432:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 13662              		.loc 4 9432 1
 13663 0076 488B55F8 		movq	-8(%rbp), %rdx
 13664 007a 64483314 		xorq	%fs:40, %rdx
 13664      25280000 
 13664      00
 13665 0083 7405     		je	.L830
 13666 0085 E8000000 		call	__stack_chk_fail@PLT
 13666      00
 13667              	.L830:
 13668 008a C9       		leave
 13669              	.LCFI380:
 13670              		.cfi_def_cfa 7, 8
 13671 008b C3       		ret
 13672              		.cfi_endproc
 13673              	.LFE145:
 13675              		.section	.text.mbedtls_ssl_check_sig_hash,"ax",@progbits
 13676              		.globl	mbedtls_ssl_check_sig_hash
 13678              	mbedtls_ssl_check_sig_hash:
 13679              	.LFB146:
GAS LISTING /tmp/ccEn8xFO.s 			page 481


9433:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_ECP_C */
9434:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9435:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
9436:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
9437:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Check if a hash proposed by the peer is in our list.
9438:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Return 0 if we're willing to use it, -1 otherwise.
9439:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
9440:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_check_sig_hash( const mbedtls_ssl_context *ssl,
9441:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                 mbedtls_md_type_t md )
9442:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 13680              		.loc 4 9442 1
 13681              		.cfi_startproc
 13682 0000 F30F1EFA 		endbr64
 13683 0004 55       		pushq	%rbp
 13684              	.LCFI381:
 13685              		.cfi_def_cfa_offset 16
 13686              		.cfi_offset 6, -16
 13687 0005 4889E5   		movq	%rsp, %rbp
 13688              	.LCFI382:
 13689              		.cfi_def_cfa_register 6
 13690 0008 4883EC20 		subq	$32, %rsp
 13691 000c 48897DE8 		movq	%rdi, -24(%rbp)
 13692 0010 8975E4   		movl	%esi, -28(%rbp)
 13693              		.loc 4 9442 1
 13694 0013 64488B04 		movq	%fs:40, %rax
 13694      25280000 
 13694      00
 13695 001c 488945F8 		movq	%rax, -8(%rbp)
 13696 0020 31C0     		xorl	%eax, %eax
9443:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const int *cur;
9444:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9445:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->conf->sig_hashes == NULL )
 13697              		.loc 4 9445 12
 13698 0022 488B45E8 		movq	-24(%rbp), %rax
 13699 0026 488B00   		movq	(%rax), %rax
 13700              		.loc 4 9445 18
 13701 0029 488B8098 		movq	152(%rax), %rax
 13701      000000
 13702              		.loc 4 9445 7
 13703 0030 4885C0   		testq	%rax, %rax
 13704 0033 7507     		jne	.L832
9446:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return( -1 );
 13705              		.loc 4 9446 15
 13706 0035 B8FFFFFF 		movl	$-1, %eax
 13706      FF
 13707 003a EB3C     		jmp	.L833
 13708              	.L832:
9447:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9448:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     for( cur = ssl->conf->sig_hashes; *cur != MBEDTLS_MD_NONE; cur++ )
 13709              		.loc 4 9448 19
 13710 003c 488B45E8 		movq	-24(%rbp), %rax
 13711 0040 488B00   		movq	(%rax), %rax
 13712              		.loc 4 9448 14
 13713 0043 488B8098 		movq	152(%rax), %rax
 13713      000000
 13714 004a 488945F0 		movq	%rax, -16(%rbp)
 13715              		.loc 4 9448 5
GAS LISTING /tmp/ccEn8xFO.s 			page 482


 13716 004e EB19     		jmp	.L834
 13717              	.L836:
9449:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( *cur == (int) md )
 13718              		.loc 4 9449 13
 13719 0050 488B45F0 		movq	-16(%rbp), %rax
 13720 0054 8B10     		movl	(%rax), %edx
 13721              		.loc 4 9449 18
 13722 0056 8B45E4   		movl	-28(%rbp), %eax
 13723              		.loc 4 9449 11
 13724 0059 39C2     		cmpl	%eax, %edx
 13725 005b 7507     		jne	.L835
9450:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return( 0 );
 13726              		.loc 4 9450 19
 13727 005d B8000000 		movl	$0, %eax
 13727      00
 13728 0062 EB14     		jmp	.L833
 13729              	.L835:
9448:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( *cur == (int) md )
 13730              		.loc 4 9448 67 discriminator 2
 13731 0064 488345F0 		addq	$4, -16(%rbp)
 13731      04
 13732              	.L834:
9448:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( *cur == (int) md )
 13733              		.loc 4 9448 39 discriminator 1
 13734 0069 488B45F0 		movq	-16(%rbp), %rax
 13735 006d 8B00     		movl	(%rax), %eax
9448:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( *cur == (int) md )
 13736              		.loc 4 9448 5 discriminator 1
 13737 006f 85C0     		testl	%eax, %eax
 13738 0071 75DD     		jne	.L836
9451:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9452:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( -1 );
 13739              		.loc 4 9452 11
 13740 0073 B8FFFFFF 		movl	$-1, %eax
 13740      FF
 13741              	.L833:
9453:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 13742              		.loc 4 9453 1
 13743 0078 488B4DF8 		movq	-8(%rbp), %rcx
 13744 007c 6448330C 		xorq	%fs:40, %rcx
 13744      25280000 
 13744      00
 13745 0085 7405     		je	.L837
 13746 0087 E8000000 		call	__stack_chk_fail@PLT
 13746      00
 13747              	.L837:
 13748 008c C9       		leave
 13749              	.LCFI383:
 13750              		.cfi_def_cfa 7, 8
 13751 008d C3       		ret
 13752              		.cfi_endproc
 13753              	.LFE146:
 13755              		.section	.rodata
 13756              	.LC10:
 13757 007b 2B060105 		.string	"+\006\001\005\005\007\003\001"
 13757      05070301 
 13757      00
GAS LISTING /tmp/ccEn8xFO.s 			page 483


 13758              	.LC11:
 13759 0084 2B060105 		.string	"+\006\001\005\005\007\003\002"
 13759      05070302 
 13759      00
 13760              		.section	.text.mbedtls_ssl_check_cert_usage,"ax",@progbits
 13761              		.globl	mbedtls_ssl_check_cert_usage
 13763              	mbedtls_ssl_check_cert_usage:
 13764              	.LFB147:
9454:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED */
9455:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9456:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
9457:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_check_cert_usage( const mbedtls_x509_crt *cert,
9458:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                           const mbedtls_ssl_ciphersuite_t *ciphersuite,
9459:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                           int cert_endpoint,
9460:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                           uint32_t *flags )
9461:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 13765              		.loc 4 9461 1
 13766              		.cfi_startproc
 13767 0000 F30F1EFA 		endbr64
 13768 0004 55       		pushq	%rbp
 13769              	.LCFI384:
 13770              		.cfi_def_cfa_offset 16
 13771              		.cfi_offset 6, -16
 13772 0005 4889E5   		movq	%rsp, %rbp
 13773              	.LCFI385:
 13774              		.cfi_def_cfa_register 6
 13775 0008 4883EC40 		subq	$64, %rsp
 13776 000c 48897DD8 		movq	%rdi, -40(%rbp)
 13777 0010 488975D0 		movq	%rsi, -48(%rbp)
 13778 0014 8955CC   		movl	%edx, -52(%rbp)
 13779 0017 48894DC0 		movq	%rcx, -64(%rbp)
 13780              		.loc 4 9461 1
 13781 001b 64488B04 		movq	%fs:40, %rax
 13781      25280000 
 13781      00
 13782 0024 488945F8 		movq	%rax, -8(%rbp)
 13783 0028 31C0     		xorl	%eax, %eax
9462:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret = 0;
 13784              		.loc 4 9462 9
 13785 002a C745E000 		movl	$0, -32(%rbp)
 13785      000000
9463:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_X509_CHECK_KEY_USAGE)
9464:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int usage = 0;
 13786              		.loc 4 9464 9
 13787 0031 C745E400 		movl	$0, -28(%rbp)
 13787      000000
9465:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9466:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_X509_CHECK_EXTENDED_KEY_USAGE)
9467:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const char *ext_oid;
9468:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     size_t ext_len;
9469:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9470:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9471:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if !defined(MBEDTLS_X509_CHECK_KEY_USAGE) &&          \
9472:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     !defined(MBEDTLS_X509_CHECK_EXTENDED_KEY_USAGE)
9473:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ((void) cert);
9474:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ((void) cert_endpoint);
9475:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ((void) flags);
GAS LISTING /tmp/ccEn8xFO.s 			page 484


9476:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9477:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9478:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_X509_CHECK_KEY_USAGE)
9479:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( cert_endpoint == MBEDTLS_SSL_IS_SERVER )
 13788              		.loc 4 9479 7
 13789 0038 837DCC01 		cmpl	$1, -52(%rbp)
 13790 003c 7553     		jne	.L839
9480:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9481:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Server part of the key exchange */
9482:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         switch( ciphersuite->key_exchange )
 13791              		.loc 4 9482 28
 13792 003e 488B45D0 		movq	-48(%rbp), %rax
 13793 0042 8B4018   		movl	24(%rax), %eax
 13794 0045 83F80B   		cmpl	$11, %eax
 13795 0048 774E     		ja	.L846
 13796 004a 89C0     		movl	%eax, %eax
 13797 004c 488D1485 		leaq	0(,%rax,4), %rdx
 13797      00000000 
 13798 0054 488D0500 		leaq	.L842(%rip), %rax
 13798      000000
 13799 005b 8B0402   		movl	(%rdx,%rax), %eax
 13800 005e 4898     		cltq
 13801 0060 488D1500 		leaq	.L842(%rip), %rdx
 13801      000000
 13802 0067 4801D0   		addq	%rdx, %rax
 13803 006a 3EFFE0   		notrack jmp	*%rax
 13804              		.section	.rodata.mbedtls_ssl_check_cert_usage,"a",@progbits
 13805              		.align 4
 13806              		.align 4
 13807              	.L842:
 13808 0000 00000000 		.long	.L841-.L842
 13809 0004 00000000 		.long	.L844-.L842
 13810 0008 00000000 		.long	.L845-.L842
 13811 000c 00000000 		.long	.L845-.L842
 13812 0010 00000000 		.long	.L845-.L842
 13813 0014 00000000 		.long	.L841-.L842
 13814 0018 00000000 		.long	.L841-.L842
 13815 001c 00000000 		.long	.L844-.L842
 13816 0020 00000000 		.long	.L841-.L842
 13817 0024 00000000 		.long	.L843-.L842
 13818 0028 00000000 		.long	.L843-.L842
 13819 002c 00000000 		.long	.L841-.L842
 13820              		.section	.text.mbedtls_ssl_check_cert_usage
 13821              	.L844:
9483:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         {
9484:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_RSA:
9485:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_RSA_PSK:
9486:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 usage = MBEDTLS_X509_KU_KEY_ENCIPHERMENT;
 13822              		.loc 4 9486 23
 13823 006d C745E420 		movl	$32, -28(%rbp)
 13823      000000
9487:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 break;
 13824              		.loc 4 9487 17
 13825 0074 EB22     		jmp	.L846
 13826              	.L845:
9488:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9489:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_DHE_RSA:
GAS LISTING /tmp/ccEn8xFO.s 			page 485


9490:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_ECDHE_RSA:
9491:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA:
9492:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 usage = MBEDTLS_X509_KU_DIGITAL_SIGNATURE;
 13827              		.loc 4 9492 23
 13828 0076 C745E480 		movl	$128, -28(%rbp)
 13828      000000
9493:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 break;
 13829              		.loc 4 9493 17
 13830 007d EB19     		jmp	.L846
 13831              	.L843:
9494:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9495:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_ECDH_RSA:
9496:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA:
9497:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 usage = MBEDTLS_X509_KU_KEY_AGREEMENT;
 13832              		.loc 4 9497 23
 13833 007f C745E408 		movl	$8, -28(%rbp)
 13833      000000
9498:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 break;
 13834              		.loc 4 9498 17
 13835 0086 EB10     		jmp	.L846
 13836              	.L841:
9499:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9500:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             /* Don't use default: we want warnings when adding new values */
9501:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_NONE:
9502:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_PSK:
9503:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_DHE_PSK:
9504:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_ECDHE_PSK:
9505:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_ECJPAKE:
9506:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                 usage = 0;
 13837              		.loc 4 9506 23
 13838 0088 C745E400 		movl	$0, -28(%rbp)
 13838      000000
 13839 008f EB07     		jmp	.L846
 13840              	.L839:
9507:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         }
9508:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9509:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
9510:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9511:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         /* Client auth: we only implement rsa_sign and mbedtls_ecdsa_sign for now */
9512:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         usage = MBEDTLS_X509_KU_DIGITAL_SIGNATURE;
 13841              		.loc 4 9512 15
 13842 0091 C745E480 		movl	$128, -28(%rbp)
 13842      000000
 13843              	.L846:
9513:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9514:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9515:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( mbedtls_x509_crt_check_key_usage( cert, usage ) != 0 )
 13844              		.loc 4 9515 9
 13845 0098 8B55E4   		movl	-28(%rbp), %edx
 13846 009b 488B45D8 		movq	-40(%rbp), %rax
 13847 009f 89D6     		movl	%edx, %esi
 13848 00a1 4889C7   		movq	%rax, %rdi
 13849 00a4 E8000000 		call	mbedtls_x509_crt_check_key_usage@PLT
 13849      00
 13850              		.loc 4 9515 7
 13851 00a9 85C0     		testl	%eax, %eax
 13852 00ab 7418     		je	.L847
GAS LISTING /tmp/ccEn8xFO.s 			page 486


9516:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9517:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         *flags |= MBEDTLS_X509_BADCERT_KEY_USAGE;
 13853              		.loc 4 9517 16
 13854 00ad 488B45C0 		movq	-64(%rbp), %rax
 13855 00b1 8B00     		movl	(%rax), %eax
 13856 00b3 80CC08   		orb	$8, %ah
 13857 00b6 89C2     		movl	%eax, %edx
 13858 00b8 488B45C0 		movq	-64(%rbp), %rax
 13859 00bc 8910     		movl	%edx, (%rax)
9518:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ret = -1;
 13860              		.loc 4 9518 13
 13861 00be C745E0FF 		movl	$-1, -32(%rbp)
 13861      FFFFFF
 13862              	.L847:
9519:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9520:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #else
9521:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ((void) ciphersuite);
9522:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_X509_CHECK_KEY_USAGE */
9523:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9524:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_X509_CHECK_EXTENDED_KEY_USAGE)
9525:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( cert_endpoint == MBEDTLS_SSL_IS_SERVER )
 13863              		.loc 4 9525 7
 13864 00c5 837DCC01 		cmpl	$1, -52(%rbp)
 13865 00c9 7515     		jne	.L848
9526:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9527:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ext_oid = MBEDTLS_OID_SERVER_AUTH;
 13866              		.loc 4 9527 17
 13867 00cb 488D0500 		leaq	.LC10(%rip), %rax
 13867      000000
 13868 00d2 488945E8 		movq	%rax, -24(%rbp)
9528:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ext_len = MBEDTLS_OID_SIZE( MBEDTLS_OID_SERVER_AUTH );
 13869              		.loc 4 9528 17
 13870 00d6 48C745F0 		movq	$8, -16(%rbp)
 13870      08000000 
 13871 00de EB13     		jmp	.L849
 13872              	.L848:
9529:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9530:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
9531:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9532:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ext_oid = MBEDTLS_OID_CLIENT_AUTH;
 13873              		.loc 4 9532 17
 13874 00e0 488D0500 		leaq	.LC11(%rip), %rax
 13874      000000
 13875 00e7 488945E8 		movq	%rax, -24(%rbp)
9533:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ext_len = MBEDTLS_OID_SIZE( MBEDTLS_OID_CLIENT_AUTH );
 13876              		.loc 4 9533 17
 13877 00eb 48C745F0 		movq	$8, -16(%rbp)
 13877      08000000 
 13878              	.L849:
9534:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9535:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9536:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( mbedtls_x509_crt_check_extended_key_usage( cert, ext_oid, ext_len ) != 0 )
 13879              		.loc 4 9536 9
 13880 00f3 488B55F0 		movq	-16(%rbp), %rdx
 13881 00f7 488B4DE8 		movq	-24(%rbp), %rcx
 13882 00fb 488B45D8 		movq	-40(%rbp), %rax
 13883 00ff 4889CE   		movq	%rcx, %rsi
GAS LISTING /tmp/ccEn8xFO.s 			page 487


 13884 0102 4889C7   		movq	%rax, %rdi
 13885 0105 E8000000 		call	mbedtls_x509_crt_check_extended_key_usage@PLT
 13885      00
 13886              		.loc 4 9536 7
 13887 010a 85C0     		testl	%eax, %eax
 13888 010c 7418     		je	.L850
9537:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9538:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         *flags |= MBEDTLS_X509_BADCERT_EXT_KEY_USAGE;
 13889              		.loc 4 9538 16
 13890 010e 488B45C0 		movq	-64(%rbp), %rax
 13891 0112 8B00     		movl	(%rax), %eax
 13892 0114 80CC10   		orb	$16, %ah
 13893 0117 89C2     		movl	%eax, %edx
 13894 0119 488B45C0 		movq	-64(%rbp), %rax
 13895 011d 8910     		movl	%edx, (%rax)
9539:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ret = -1;
 13896              		.loc 4 9539 13
 13897 011f C745E0FF 		movl	$-1, -32(%rbp)
 13897      FFFFFF
 13898              	.L850:
9540:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9541:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_X509_CHECK_EXTENDED_KEY_USAGE */
9542:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9543:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ret );
 13899              		.loc 4 9543 11
 13900 0126 8B45E0   		movl	-32(%rbp), %eax
9544:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 13901              		.loc 4 9544 1
 13902 0129 488B4DF8 		movq	-8(%rbp), %rcx
 13903 012d 6448330C 		xorq	%fs:40, %rcx
 13903      25280000 
 13903      00
 13904 0136 7405     		je	.L852
 13905 0138 E8000000 		call	__stack_chk_fail@PLT
 13905      00
 13906              	.L852:
 13907 013d C9       		leave
 13908              	.LCFI386:
 13909              		.cfi_def_cfa 7, 8
 13910 013e C3       		ret
 13911              		.cfi_endproc
 13912              	.LFE147:
 13914              		.section	.text.mbedtls_ssl_write_version,"ax",@progbits
 13915              		.globl	mbedtls_ssl_write_version
 13917              	mbedtls_ssl_write_version:
 13918              	.LFB148:
9545:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
9546:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9547:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** /*
9548:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * Convert version numbers to/from wire format
9549:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * and, for DTLS, to/from TLS equivalent.
9550:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  *
9551:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * For TLS this is the identity.
9552:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * For DTLS, use 1's complement (v -> 255 - v, and then map as follows:
9553:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * 1.0 <-> 3.2      (DTLS 1.0 is based on TLS 1.1)
9554:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  * 1.x <-> 3.x+1    for x != 0 (DTLS 1.2 based on TLS 1.2)
9555:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****  */
GAS LISTING /tmp/ccEn8xFO.s 			page 488


9556:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_write_version( int major, int minor, int transport,
9557:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                         unsigned char ver[2] )
9558:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 13919              		.loc 4 9558 1
 13920              		.cfi_startproc
 13921 0000 F30F1EFA 		endbr64
 13922 0004 55       		pushq	%rbp
 13923              	.LCFI387:
 13924              		.cfi_def_cfa_offset 16
 13925              		.cfi_offset 6, -16
 13926 0005 4889E5   		movq	%rsp, %rbp
 13927              	.LCFI388:
 13928              		.cfi_def_cfa_register 6
 13929 0008 4883EC30 		subq	$48, %rsp
 13930 000c 897DEC   		movl	%edi, -20(%rbp)
 13931 000f 8975E8   		movl	%esi, -24(%rbp)
 13932 0012 8955E4   		movl	%edx, -28(%rbp)
 13933 0015 48894DD8 		movq	%rcx, -40(%rbp)
 13934              		.loc 4 9558 1
 13935 0019 64488B04 		movq	%fs:40, %rax
 13935      25280000 
 13935      00
 13936 0022 488945F8 		movq	%rax, -8(%rbp)
 13937 0026 31C0     		xorl	%eax, %eax
9559:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
9560:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
9561:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9562:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( minor == MBEDTLS_SSL_MINOR_VERSION_2 )
9563:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             --minor; /* DTLS 1.0 stored as TLS 1.1 internally */
9564:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9565:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ver[0] = (unsigned char)( 255 - ( major - 2 ) );
9566:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ver[1] = (unsigned char)( 255 - ( minor - 1 ) );
9567:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9568:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
9569:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #else
9570:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ((void) transport);
9571:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9572:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9573:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ver[0] = (unsigned char) major;
 13938              		.loc 4 9573 18
 13939 0028 8B45EC   		movl	-20(%rbp), %eax
 13940 002b 89C2     		movl	%eax, %edx
 13941              		.loc 4 9573 16
 13942 002d 488B45D8 		movq	-40(%rbp), %rax
 13943 0031 8810     		movb	%dl, (%rax)
9574:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         ver[1] = (unsigned char) minor;
 13944              		.loc 4 9574 12
 13945 0033 488B45D8 		movq	-40(%rbp), %rax
 13946 0037 4883C001 		addq	$1, %rax
 13947              		.loc 4 9574 18
 13948 003b 8B55E8   		movl	-24(%rbp), %edx
 13949              		.loc 4 9574 16
 13950 003e 8810     		movb	%dl, (%rax)
9575:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9576:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 13951              		.loc 4 9576 1
 13952 0040 90       		nop
GAS LISTING /tmp/ccEn8xFO.s 			page 489


 13953 0041 488B45F8 		movq	-8(%rbp), %rax
 13954 0045 64483304 		xorq	%fs:40, %rax
 13954      25280000 
 13954      00
 13955 004e 7405     		je	.L854
 13956 0050 E8000000 		call	__stack_chk_fail@PLT
 13956      00
 13957              	.L854:
 13958 0055 C9       		leave
 13959              	.LCFI389:
 13960              		.cfi_def_cfa 7, 8
 13961 0056 C3       		ret
 13962              		.cfi_endproc
 13963              	.LFE148:
 13965              		.section	.text.mbedtls_ssl_read_version,"ax",@progbits
 13966              		.globl	mbedtls_ssl_read_version
 13968              	mbedtls_ssl_read_version:
 13969              	.LFB149:
9577:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9578:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** void mbedtls_ssl_read_version( int *major, int *minor, int transport,
9579:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                        const unsigned char ver[2] )
9580:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 13970              		.loc 4 9580 1
 13971              		.cfi_startproc
 13972 0000 F30F1EFA 		endbr64
 13973 0004 55       		pushq	%rbp
 13974              	.LCFI390:
 13975              		.cfi_def_cfa_offset 16
 13976              		.cfi_offset 6, -16
 13977 0005 4889E5   		movq	%rsp, %rbp
 13978              	.LCFI391:
 13979              		.cfi_def_cfa_register 6
 13980 0008 4883EC30 		subq	$48, %rsp
 13981 000c 48897DE8 		movq	%rdi, -24(%rbp)
 13982 0010 488975E0 		movq	%rsi, -32(%rbp)
 13983 0014 8955DC   		movl	%edx, -36(%rbp)
 13984 0017 48894DD0 		movq	%rcx, -48(%rbp)
 13985              		.loc 4 9580 1
 13986 001b 64488B04 		movq	%fs:40, %rax
 13986      25280000 
 13986      00
 13987 0024 488945F8 		movq	%rax, -8(%rbp)
 13988 0028 31C0     		xorl	%eax, %eax
9581:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
9582:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
9583:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9584:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         *major = 255 - ver[0] + 2;
9585:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         *minor = 255 - ver[1] + 1;
9586:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9587:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         if( *minor == MBEDTLS_SSL_MINOR_VERSION_1 )
9588:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ++*minor; /* DTLS 1.0 stored as TLS 1.1 internally */
9589:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9590:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     else
9591:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #else
9592:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     ((void) transport);
9593:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9594:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
GAS LISTING /tmp/ccEn8xFO.s 			page 490


9595:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         *major = ver[0];
 13989              		.loc 4 9595 21
 13990 002a 488B45D0 		movq	-48(%rbp), %rax
 13991 002e 0FB600   		movzbl	(%rax), %eax
 13992 0031 0FB6D0   		movzbl	%al, %edx
 13993              		.loc 4 9595 16
 13994 0034 488B45E8 		movq	-24(%rbp), %rax
 13995 0038 8910     		movl	%edx, (%rax)
9596:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         *minor = ver[1];
 13996              		.loc 4 9596 21
 13997 003a 488B45D0 		movq	-48(%rbp), %rax
 13998 003e 4883C001 		addq	$1, %rax
 13999 0042 0FB600   		movzbl	(%rax), %eax
 14000 0045 0FB6D0   		movzbl	%al, %edx
 14001              		.loc 4 9596 16
 14002 0048 488B45E0 		movq	-32(%rbp), %rax
 14003 004c 8910     		movl	%edx, (%rax)
9597:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9598:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 14004              		.loc 4 9598 1
 14005 004e 90       		nop
 14006 004f 488B45F8 		movq	-8(%rbp), %rax
 14007 0053 64483304 		xorq	%fs:40, %rax
 14007      25280000 
 14007      00
 14008 005c 7405     		je	.L856
 14009 005e E8000000 		call	__stack_chk_fail@PLT
 14009      00
 14010              	.L856:
 14011 0063 C9       		leave
 14012              	.LCFI392:
 14013              		.cfi_def_cfa 7, 8
 14014 0064 C3       		ret
 14015              		.cfi_endproc
 14016              	.LFE149:
 14018              		.section	.text.mbedtls_ssl_set_calc_verify_md,"ax",@progbits
 14019              		.globl	mbedtls_ssl_set_calc_verify_md
 14021              	mbedtls_ssl_set_calc_verify_md:
 14022              	.LFB150:
9599:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9600:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_set_calc_verify_md( mbedtls_ssl_context *ssl, int md )
9601:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 14023              		.loc 4 9601 1
 14024              		.cfi_startproc
 14025 0000 F30F1EFA 		endbr64
 14026 0004 55       		pushq	%rbp
 14027              	.LCFI393:
 14028              		.cfi_def_cfa_offset 16
 14029              		.cfi_offset 6, -16
 14030 0005 4889E5   		movq	%rsp, %rbp
 14031              	.LCFI394:
 14032              		.cfi_def_cfa_register 6
 14033 0008 4883EC20 		subq	$32, %rsp
 14034 000c 48897DE8 		movq	%rdi, -24(%rbp)
 14035 0010 8975E4   		movl	%esi, -28(%rbp)
 14036              		.loc 4 9601 1
 14037 0013 64488B04 		movq	%fs:40, %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 491


 14037      25280000 
 14037      00
 14038 001c 488945F8 		movq	%rax, -8(%rbp)
 14039 0020 31C0     		xorl	%eax, %eax
9602:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
9603:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ssl->minor_ver != MBEDTLS_SSL_MINOR_VERSION_3 )
 14040              		.loc 4 9603 12
 14041 0022 488B45E8 		movq	-24(%rbp), %rax
 14042 0026 8B4018   		movl	24(%rax), %eax
 14043              		.loc 4 9603 7
 14044 0029 83F803   		cmpl	$3, %eax
 14045 002c 7407     		je	.L858
9604:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         return MBEDTLS_ERR_SSL_INVALID_VERIFY_HASH;
 14046              		.loc 4 9604 16
 14047 002e B8009AFF 		movl	$-26112, %eax
 14047      FF
 14048 0033 EB29     		jmp	.L859
 14049              	.L858:
9605:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9606:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     switch( md )
 14050              		.loc 4 9606 5
 14051 0035 837DE404 		cmpl	$4, -28(%rbp)
 14052 0039 751E     		jne	.L860
9607:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9608:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1)
9609:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_MD5_C)
9610:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_SSL_HASH_MD5:
9611:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return MBEDTLS_ERR_SSL_INVALID_VERIFY_HASH;
9612:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9613:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA1_C)
9614:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_SSL_HASH_SHA1:
9615:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->handshake->calc_verify = ssl_calc_verify_tls;
9616:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             break;
9617:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9618:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1 || MBEDTLS_SSL_PROTO_TLS1_1 */
9619:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
9620:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_SSL_HASH_SHA384:
9621:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->handshake->calc_verify = ssl_calc_verify_tls_sha384;
9622:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             break;
9623:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9624:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
9625:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         case MBEDTLS_SSL_HASH_SHA256:
9626:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             ssl->handshake->calc_verify = ssl_calc_verify_tls_sha256;
 14053              		.loc 4 9626 16
 14054 003b 488B45E8 		movq	-24(%rbp), %rax
 14055 003f 488B4060 		movq	96(%rax), %rax
 14056              		.loc 4 9626 41
 14057 0043 488D1500 		leaq	ssl_calc_verify_tls_sha256(%rip), %rdx
 14057      000000
 14058 004a 488990F8 		movq	%rdx, 760(%rax)
 14058      020000
9627:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             break;
 14059              		.loc 4 9627 13
 14060 0051 90       		nop
9628:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif
9629:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         default:
9630:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****             return MBEDTLS_ERR_SSL_INVALID_VERIFY_HASH;
GAS LISTING /tmp/ccEn8xFO.s 			page 492


9631:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9632:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9633:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return 0;
 14061              		.loc 4 9633 12
 14062 0052 B8000000 		movl	$0, %eax
 14062      00
 14063 0057 EB05     		jmp	.L859
 14064              	.L860:
9630:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 14065              		.loc 4 9630 20
 14066 0059 B8009AFF 		movl	$-26112, %eax
 14066      FF
 14067              	.L859:
9634:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #else /* !MBEDTLS_SSL_PROTO_TLS1_2 */
9635:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     (void) ssl;
9636:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     (void) md;
9637:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9638:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return MBEDTLS_ERR_SSL_INVALID_VERIFY_HASH;
9639:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
9640:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 14068              		.loc 4 9640 1
 14069 005e 488B4DF8 		movq	-8(%rbp), %rcx
 14070 0062 6448330C 		xorq	%fs:40, %rcx
 14070      25280000 
 14070      00
 14071 006b 7405     		je	.L862
 14072 006d E8000000 		call	__stack_chk_fail@PLT
 14072      00
 14073              	.L862:
 14074 0072 C9       		leave
 14075              	.LCFI395:
 14076              		.cfi_def_cfa 7, 8
 14077 0073 C3       		ret
 14078              		.cfi_endproc
 14079              	.LFE150:
 14081              		.section	.text.mbedtls_ssl_get_key_exchange_md_tls1_2,"ax",@progbits
 14082              		.globl	mbedtls_ssl_get_key_exchange_md_tls1_2
 14084              	mbedtls_ssl_get_key_exchange_md_tls1_2:
 14085              	.LFB151:
9641:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9642:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1) || \
9643:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_1)
9644:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_get_key_exchange_md_ssl_tls( mbedtls_ssl_context *ssl,
9645:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         unsigned char *output,
9646:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         unsigned char *data, size_t data_len )
9647:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
9648:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret = 0;
9649:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_context mbedtls_md5;
9650:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_context mbedtls_sha1;
9651:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9652:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_init( &mbedtls_md5 );
9653:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_init( &mbedtls_sha1 );
9654:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9655:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
9656:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * digitally-signed struct {
9657:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     opaque md5_hash[16];
9658:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     opaque sha_hash[20];
GAS LISTING /tmp/ccEn8xFO.s 			page 493


9659:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * };
9660:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *
9661:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * md5_hash
9662:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     MD5(ClientHello.random + ServerHello.random
9663:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *                            + ServerParams);
9664:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * sha_hash
9665:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     SHA(ClientHello.random + ServerHello.random
9666:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *                            + ServerParams);
9667:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
9668:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_md5_starts_ret( &mbedtls_md5 ) ) != 0 )
9669:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9670:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_md5_starts_ret", ret );
9671:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         goto exit;
9672:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9673:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_md5_update_ret( &mbedtls_md5,
9674:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         ssl->handshake->randbytes, 64 ) ) != 0 )
9675:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9676:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_md5_update_ret", ret );
9677:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         goto exit;
9678:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9679:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_md5_update_ret( &mbedtls_md5, data, data_len ) ) != 0 )
9680:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9681:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_md5_update_ret", ret );
9682:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         goto exit;
9683:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9684:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_md5_finish_ret( &mbedtls_md5, output ) ) != 0 )
9685:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9686:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_md5_finish_ret", ret );
9687:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         goto exit;
9688:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9689:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9690:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_sha1_starts_ret( &mbedtls_sha1 ) ) != 0 )
9691:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9692:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_sha1_starts_ret", ret );
9693:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         goto exit;
9694:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9695:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_sha1_update_ret( &mbedtls_sha1,
9696:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                          ssl->handshake->randbytes, 64 ) ) != 0 )
9697:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9698:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_sha1_update_ret", ret );
9699:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         goto exit;
9700:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9701:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_sha1_update_ret( &mbedtls_sha1, data,
9702:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                          data_len ) ) != 0 )
9703:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9704:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_sha1_update_ret", ret );
9705:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         goto exit;
9706:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9707:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_sha1_finish_ret( &mbedtls_sha1,
9708:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                          output + 16 ) ) != 0 )
9709:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9710:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_sha1_finish_ret", ret );
9711:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         goto exit;
9712:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9713:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9714:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** exit:
9715:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md5_free( &mbedtls_md5 );
GAS LISTING /tmp/ccEn8xFO.s 			page 494


9716:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_sha1_free( &mbedtls_sha1 );
9717:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9718:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ret != 0 )
9719:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
9720:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_INTERNAL_ERROR );
9721:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9722:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ret );
9723:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9724:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
9725:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 || MBEDTLS_SSL_PROTO_TLS1 || \
9726:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****           MBEDTLS_SSL_PROTO_TLS1_1 */
9727:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9728:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1) || \
9729:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_2)
9730:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** int mbedtls_ssl_get_key_exchange_md_tls1_2( mbedtls_ssl_context *ssl,
9731:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                             unsigned char *hash, size_t *hashlen,
9732:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                             unsigned char *data, size_t data_len,
9733:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                             mbedtls_md_type_t md_alg )
9734:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** {
 14086              		.loc 4 9734 1
 14087              		.cfi_startproc
 14088 0000 F30F1EFA 		endbr64
 14089 0004 55       		pushq	%rbp
 14090              	.LCFI396:
 14091              		.cfi_def_cfa_offset 16
 14092              		.cfi_offset 6, -16
 14093 0005 4889E5   		movq	%rsp, %rbp
 14094              	.LCFI397:
 14095              		.cfi_def_cfa_register 6
 14096 0008 4883EC60 		subq	$96, %rsp
 14097 000c 48897DC8 		movq	%rdi, -56(%rbp)
 14098 0010 488975C0 		movq	%rsi, -64(%rbp)
 14099 0014 488955B8 		movq	%rdx, -72(%rbp)
 14100 0018 48894DB0 		movq	%rcx, -80(%rbp)
 14101 001c 4C8945A8 		movq	%r8, -88(%rbp)
 14102 0020 44894DA4 		movl	%r9d, -92(%rbp)
 14103              		.loc 4 9734 1
 14104 0024 64488B04 		movq	%fs:40, %rax
 14104      25280000 
 14104      00
 14105 002d 488945F8 		movq	%rax, -8(%rbp)
 14106 0031 31C0     		xorl	%eax, %eax
9735:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     int ret = 0;
 14107              		.loc 4 9735 9
 14108 0033 C745D400 		movl	$0, -44(%rbp)
 14108      000000
9736:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_context_t ctx;
9737:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     const mbedtls_md_info_t *md_info = mbedtls_md_info_from_type( md_alg );
 14109              		.loc 4 9737 40
 14110 003a 8B45A4   		movl	-92(%rbp), %eax
 14111 003d 89C7     		movl	%eax, %edi
 14112 003f E8000000 		call	mbedtls_md_info_from_type@PLT
 14112      00
 14113 0044 488945D8 		movq	%rax, -40(%rbp)
9738:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     *hashlen = mbedtls_md_get_size( md_info );
 14114              		.loc 4 9738 16
 14115 0048 488B45D8 		movq	-40(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 495


 14116 004c 4889C7   		movq	%rax, %rdi
 14117 004f E8000000 		call	mbedtls_md_get_size@PLT
 14117      00
 14118 0054 0FB6D0   		movzbl	%al, %edx
 14119              		.loc 4 9738 14
 14120 0057 488B45B8 		movq	-72(%rbp), %rax
 14121 005b 488910   		movq	%rdx, (%rax)
9739:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9740:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_init( &ctx );
 14122              		.loc 4 9740 5
 14123 005e 488D45E0 		leaq	-32(%rbp), %rax
 14124 0062 4889C7   		movq	%rax, %rdi
 14125 0065 E8000000 		call	mbedtls_md_init@PLT
 14125      00
9741:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9742:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     /*
9743:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * digitally-signed struct {
9744:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     opaque client_random[32];
9745:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     opaque server_random[32];
9746:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      *     ServerDHParams params;
9747:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      * };
9748:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****      */
9749:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_md_setup( &ctx, md_info, 0 ) ) != 0 )
 14126              		.loc 4 9749 17
 14127 006a 488B4DD8 		movq	-40(%rbp), %rcx
 14128 006e 488D45E0 		leaq	-32(%rbp), %rax
 14129 0072 BA000000 		movl	$0, %edx
 14129      00
 14130 0077 4889CE   		movq	%rcx, %rsi
 14131 007a 4889C7   		movq	%rax, %rdi
 14132 007d E8000000 		call	mbedtls_md_setup@PLT
 14132      00
 14133 0082 8945D4   		movl	%eax, -44(%rbp)
 14134              		.loc 4 9749 7
 14135 0085 837DD400 		cmpl	$0, -44(%rbp)
 14136 0089 757D     		jne	.L872
9750:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9751:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_md_setup", ret );
9752:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         goto exit;
9753:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9754:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_md_starts( &ctx ) ) != 0 )
 14137              		.loc 4 9754 17
 14138 008b 488D45E0 		leaq	-32(%rbp), %rax
 14139 008f 4889C7   		movq	%rax, %rdi
 14140 0092 E8000000 		call	mbedtls_md_starts@PLT
 14140      00
 14141 0097 8945D4   		movl	%eax, -44(%rbp)
 14142              		.loc 4 9754 7
 14143 009a 837DD400 		cmpl	$0, -44(%rbp)
 14144 009e 756B     		jne	.L873
9755:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9756:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_md_starts", ret );
9757:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         goto exit;
9758:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9759:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_md_update( &ctx, ssl->handshake->randbytes, 64 ) ) != 0 )
 14145              		.loc 4 9759 45
 14146 00a0 488B45C8 		movq	-56(%rbp), %rax
GAS LISTING /tmp/ccEn8xFO.s 			page 496


 14147 00a4 488B4060 		movq	96(%rax), %rax
 14148              		.loc 4 9759 56
 14149 00a8 488D8818 		leaq	792(%rax), %rcx
 14149      030000
 14150              		.loc 4 9759 17
 14151 00af 488D45E0 		leaq	-32(%rbp), %rax
 14152 00b3 BA400000 		movl	$64, %edx
 14152      00
 14153 00b8 4889CE   		movq	%rcx, %rsi
 14154 00bb 4889C7   		movq	%rax, %rdi
 14155 00be E8000000 		call	mbedtls_md_update@PLT
 14155      00
 14156 00c3 8945D4   		movl	%eax, -44(%rbp)
 14157              		.loc 4 9759 7
 14158 00c6 837DD400 		cmpl	$0, -44(%rbp)
 14159 00ca 7542     		jne	.L874
9760:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9761:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_md_update", ret );
9762:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         goto exit;
9763:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9764:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_md_update( &ctx, data, data_len ) ) != 0 )
 14160              		.loc 4 9764 17
 14161 00cc 488B55A8 		movq	-88(%rbp), %rdx
 14162 00d0 488B4DB0 		movq	-80(%rbp), %rcx
 14163 00d4 488D45E0 		leaq	-32(%rbp), %rax
 14164 00d8 4889CE   		movq	%rcx, %rsi
 14165 00db 4889C7   		movq	%rax, %rdi
 14166 00de E8000000 		call	mbedtls_md_update@PLT
 14166      00
 14167 00e3 8945D4   		movl	%eax, -44(%rbp)
 14168              		.loc 4 9764 7
 14169 00e6 837DD400 		cmpl	$0, -44(%rbp)
 14170 00ea 7525     		jne	.L875
9765:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9766:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_md_update", ret );
9767:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         goto exit;
9768:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9769:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ( ret = mbedtls_md_finish( &ctx, hash ) ) != 0 )
 14171              		.loc 4 9769 17
 14172 00ec 488B55C0 		movq	-64(%rbp), %rdx
 14173 00f0 488D45E0 		leaq	-32(%rbp), %rax
 14174 00f4 4889D6   		movq	%rdx, %rsi
 14175 00f7 4889C7   		movq	%rax, %rdi
 14176 00fa E8000000 		call	mbedtls_md_finish@PLT
 14176      00
 14177 00ff 8945D4   		movl	%eax, -44(%rbp)
 14178              		.loc 4 9769 7
 14179 0102 837DD400 		cmpl	$0, -44(%rbp)
9770:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     {
9771:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_md_finish", ret );
9772:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         goto exit;
9773:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
9774:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9775:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** exit:
 14180              		.loc 4 9775 1
 14181 0106 EB0A     		jmp	.L865
 14182              	.L872:
GAS LISTING /tmp/ccEn8xFO.s 			page 497


9752:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 14183              		.loc 4 9752 9
 14184 0108 90       		nop
 14185 0109 EB07     		jmp	.L865
 14186              	.L873:
9757:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 14187              		.loc 4 9757 9
 14188 010b 90       		nop
 14189 010c EB04     		jmp	.L865
 14190              	.L874:
9762:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 14191              		.loc 4 9762 9
 14192 010e 90       		nop
 14193 010f EB01     		jmp	.L865
 14194              	.L875:
9767:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     }
 14195              		.loc 4 9767 9
 14196 0111 90       		nop
 14197              	.L865:
9776:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     mbedtls_md_free( &ctx );
 14198              		.loc 4 9776 5
 14199 0112 488D45E0 		leaq	-32(%rbp), %rax
 14200 0116 4889C7   		movq	%rax, %rdi
 14201 0119 E8000000 		call	mbedtls_md_free@PLT
 14201      00
9777:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9778:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     if( ret != 0 )
 14202              		.loc 4 9778 7
 14203 011e 837DD400 		cmpl	$0, -44(%rbp)
 14204 0122 7416     		je	.L869
9779:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 14205              		.loc 4 9779 9
 14206 0124 488B45C8 		movq	-56(%rbp), %rax
 14207 0128 BA500000 		movl	$80, %edx
 14207      00
 14208 012d BE020000 		movl	$2, %esi
 14208      00
 14209 0132 4889C7   		movq	%rax, %rdi
 14210 0135 E8000000 		call	mbedtls_ssl_send_alert_message
 14210      00
 14211              	.L869:
9780:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_INTERNAL_ERROR );
9781:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** 
9782:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c ****     return( ret );
 14212              		.loc 4 9782 11
 14213 013a 8B45D4   		movl	-44(%rbp), %eax
9783:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_tls.c **** }
 14214              		.loc 4 9783 1
 14215 013d 488B75F8 		movq	-8(%rbp), %rsi
 14216 0141 64483334 		xorq	%fs:40, %rsi
 14216      25280000 
 14216      00
 14217 014a 7405     		je	.L871
 14218 014c E8000000 		call	__stack_chk_fail@PLT
 14218      00
 14219              	.L871:
 14220 0151 C9       		leave
GAS LISTING /tmp/ccEn8xFO.s 			page 498


 14221              	.LCFI398:
 14222              		.cfi_def_cfa 7, 8
 14223 0152 C3       		ret
 14224              		.cfi_endproc
 14225              	.LFE151:
 14227              		.text
 14228              	.Letext0:
 14229              		.file 5 "/usr/lib/gcc/x86_64-linux-gnu/9/include/stddef.h"
 14230              		.file 6 "/usr/include/x86_64-linux-gnu/bits/types.h"
 14231              		.file 7 "/usr/include/x86_64-linux-gnu/bits/types/struct_FILE.h"
 14232              		.file 8 "/usr/include/x86_64-linux-gnu/bits/types/FILE.h"
 14233              		.file 9 "/usr/include/stdio.h"
 14234              		.file 10 "/usr/include/x86_64-linux-gnu/bits/sys_errlist.h"
 14235              		.file 11 "/usr/include/time.h"
 14236              		.file 12 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/platform
 14237              		.file 13 "/usr/include/x86_64-linux-gnu/bits/stdint-uintn.h"
 14238              		.file 14 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/bignum.h
 14239              		.file 15 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ecp.h"
 14240              		.file 16 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/md.h"
 14241              		.file 17 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciph
 14242              		.file 18 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/asn1.h"
 14243              		.file 19 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/x509.h"
 14244              		.file 20 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/x509_crl
 14245              		.file 21 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/x509_crt
 14246              		.file 22 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ecdh.h"
 14247              		.file 23 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl.h"
 14248              		.file 24 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/sha256.h
 30446              		.section	.note.gnu.property,"a"
 30447              		.align 8
 30448 0000 04000000 		.long	 1f - 0f
 30449 0004 10000000 		.long	 4f - 1f
 30450 0008 05000000 		.long	 5
 30451              	0:
 30452 000c 474E5500 		.string	 "GNU"
 30453              	1:
 30454              		.align 8
 30455 0010 020000C0 		.long	 0xc0000002
 30456 0014 04000000 		.long	 3f - 2f
 30457              	2:
 30458 0018 03000000 		.long	 0x3
 30459              	3:
 30460 001c 00000000 		.align 8
 30461              	4:
GAS LISTING /tmp/ccEn8xFO.s 			page 499


DEFINED SYMBOLS
                            *ABS*:0000000000000000 ssl_tls.c
     /tmp/ccEn8xFO.s:6      .text.mbedtls_pk_ec:0000000000000000 mbedtls_pk_ec
     /tmp/ccEn8xFO.s:45     .text.mbedtls_cipher_get_block_size:0000000000000000 mbedtls_cipher_get_block_size
     /tmp/ccEn8xFO.s:94     .text.mbedtls_cipher_get_cipher_mode:0000000000000000 mbedtls_cipher_get_cipher_mode
     /tmp/ccEn8xFO.s:142    .text.mbedtls_ssl_sig_hash_set_init:0000000000000000 mbedtls_ssl_sig_hash_set_init
     /tmp/ccEn8xFO.s:13434  .text.mbedtls_ssl_sig_hash_set_const_hash:0000000000000000 mbedtls_ssl_sig_hash_set_const_hash
     /tmp/ccEn8xFO.s:181    .text.mbedtls_ssl_own_cert:0000000000000000 mbedtls_ssl_own_cert
     /tmp/ccEn8xFO.s:254    .text.mbedtls_ssl_hdr_len:0000000000000000 mbedtls_ssl_hdr_len
     /tmp/ccEn8xFO.s:288    .text.mbedtls_ssl_hs_hdr_len:0000000000000000 mbedtls_ssl_hs_hdr_len
     /tmp/ccEn8xFO.s:322    .text.mbedtls_ssl_safer_memcmp:0000000000000000 mbedtls_ssl_safer_memcmp
     /tmp/ccEn8xFO.s:402    .text.ssl_ep_len:0000000000000000 ssl_ep_len
     /tmp/ccEn8xFO.s:437    .text.ssl_set_timer:0000000000000000 ssl_set_timer
     /tmp/ccEn8xFO.s:495    .text.ssl_check_timer:0000000000000000 ssl_check_timer
     /tmp/ccEn8xFO.s:557    .text.ssl_mfl_code_to_length:0000000000000000 ssl_mfl_code_to_length
     /tmp/ccEn8xFO.s:634    .text.ssl_session_copy:0000000000000000 ssl_session_copy
     /tmp/ccEn8xFO.s:12560  .text.mbedtls_ssl_session_free:0000000000000000 mbedtls_ssl_session_free
     /tmp/ccEn8xFO.s:784    .text.tls_prf_generic:0000000000000000 tls_prf_generic
     /tmp/ccEn8xFO.s:1044   .text.tls_prf_sha256:0000000000000000 tls_prf_sha256
     /tmp/ccEn8xFO.s:1106   .text.mbedtls_ssl_derive_keys:0000000000000000 mbedtls_ssl_derive_keys
     /tmp/ccEn8xFO.s:1886   .text.ssl_calc_verify_tls_sha256:0000000000000000 ssl_calc_verify_tls_sha256
     /tmp/ccEn8xFO.s:7230   .text.ssl_calc_finished_tls_sha256:0000000000000000 ssl_calc_finished_tls_sha256
     /tmp/ccEn8xFO.s:1946   .text.ssl_read_memory:0000000000000000 ssl_read_memory
     /tmp/ccEn8xFO.s:2004   .text.ssl_encrypt_buf:0000000000000000 ssl_encrypt_buf
     /tmp/ccEn8xFO.s:13917  .text.mbedtls_ssl_write_version:0000000000000000 mbedtls_ssl_write_version
     /tmp/ccEn8xFO.s:2662   .text.ssl_decrypt_buf:0000000000000000 ssl_decrypt_buf
     /tmp/ccEn8xFO.s:3763   .text.mbedtls_ssl_fetch_input:0000000000000000 mbedtls_ssl_fetch_input
     /tmp/ccEn8xFO.s:3945   .text.mbedtls_ssl_flush_output:0000000000000000 mbedtls_ssl_flush_output
     /tmp/ccEn8xFO.s:8274   .text.ssl_update_out_pointers:0000000000000000 ssl_update_out_pointers
     /tmp/ccEn8xFO.s:4077   .text.mbedtls_ssl_write_handshake_msg:0000000000000000 mbedtls_ssl_write_handshake_msg
     /tmp/ccEn8xFO.s:4243   .text.mbedtls_ssl_write_record:0000000000000000 mbedtls_ssl_write_record
     /tmp/ccEn8xFO.s:4494   .text.ssl_get_hs_total_len:0000000000000000 ssl_get_hs_total_len
     /tmp/ccEn8xFO.s:4558   .text.mbedtls_ssl_prepare_handshake_record:0000000000000000 mbedtls_ssl_prepare_handshake_record
     /tmp/ccEn8xFO.s:4641   .text.mbedtls_ssl_update_handshake_status:0000000000000000 mbedtls_ssl_update_handshake_status
     /tmp/ccEn8xFO.s:4706   .text.ssl_parse_record_header:0000000000000000 ssl_parse_record_header
     /tmp/ccEn8xFO.s:13968  .text.mbedtls_ssl_read_version:0000000000000000 mbedtls_ssl_read_version
     /tmp/ccEn8xFO.s:5607   .text.mbedtls_ssl_send_alert_message:0000000000000000 mbedtls_ssl_send_alert_message
     /tmp/ccEn8xFO.s:4937   .text.ssl_prepare_record_content:0000000000000000 ssl_prepare_record_content
     /tmp/ccEn8xFO.s:5007   .text.mbedtls_ssl_read_record:0000000000000000 mbedtls_ssl_read_record
     /tmp/ccEn8xFO.s:5127   .text.ssl_consume_current_message:0000000000000000 ssl_consume_current_message
     /tmp/ccEn8xFO.s:5241   .text.ssl_record_is_in_progress:0000000000000000 ssl_record_is_in_progress
     /tmp/ccEn8xFO.s:5287   .text.ssl_get_next_record:0000000000000000 ssl_get_next_record
     /tmp/ccEn8xFO.s:5399   .text.mbedtls_ssl_handle_message_type:0000000000000000 mbedtls_ssl_handle_message_type
     /tmp/ccEn8xFO.s:5556   .text.mbedtls_ssl_send_fatal_handshake_failure:0000000000000000 mbedtls_ssl_send_fatal_handshake_failure
     /tmp/ccEn8xFO.s:5696   .text.mbedtls_ssl_write_certificate:0000000000000000 mbedtls_ssl_write_certificate
     /tmp/ccEn8xFO.s:5962   .text.ssl_parse_certificate_chain:0000000000000000 ssl_parse_certificate_chain
     /tmp/ccEn8xFO.s:6425   .text.mbedtls_ssl_parse_certificate:0000000000000000 mbedtls_ssl_parse_certificate
     /tmp/ccEn8xFO.s:13600  .text.mbedtls_ssl_check_curve:0000000000000000 mbedtls_ssl_check_curve
     /tmp/ccEn8xFO.s:13763  .text.mbedtls_ssl_check_cert_usage:0000000000000000 mbedtls_ssl_check_cert_usage
     /tmp/ccEn8xFO.s:6872   .text.mbedtls_ssl_write_change_cipher_spec:0000000000000000 mbedtls_ssl_write_change_cipher_spec
     /tmp/ccEn8xFO.s:6939   .text.mbedtls_ssl_parse_change_cipher_spec:0000000000000000 mbedtls_ssl_parse_change_cipher_spec
     /tmp/ccEn8xFO.s:8367   .text.ssl_update_in_pointers:0000000000000000 ssl_update_in_pointers
     /tmp/ccEn8xFO.s:7039   .text.mbedtls_ssl_optimize_checksum:0000000000000000 mbedtls_ssl_optimize_checksum
     /tmp/ccEn8xFO.s:7179   .text.ssl_update_checksum_sha256:0000000000000000 ssl_update_checksum_sha256
     /tmp/ccEn8xFO.s:7091   .text.mbedtls_ssl_reset_checksum:0000000000000000 mbedtls_ssl_reset_checksum
     /tmp/ccEn8xFO.s:7133   .text.ssl_update_checksum_start:0000000000000000 ssl_update_checksum_start
     /tmp/ccEn8xFO.s:7347   .text.ssl_handshake_wrapup_free_hs_transform:0000000000000000 ssl_handshake_wrapup_free_hs_transform
GAS LISTING /tmp/ccEn8xFO.s 			page 500


     /tmp/ccEn8xFO.s:12493  .text.mbedtls_ssl_handshake_free:0000000000000000 mbedtls_ssl_handshake_free
     /tmp/ccEn8xFO.s:12371  .text.mbedtls_ssl_transform_free:0000000000000000 mbedtls_ssl_transform_free
     /tmp/ccEn8xFO.s:7422   .text.mbedtls_ssl_handshake_wrapup:0000000000000000 mbedtls_ssl_handshake_wrapup
     /tmp/ccEn8xFO.s:7551   .text.mbedtls_ssl_write_finished:0000000000000000 mbedtls_ssl_write_finished
     /tmp/ccEn8xFO.s:7729   .text.mbedtls_ssl_parse_finished:0000000000000000 mbedtls_ssl_parse_finished
     /tmp/ccEn8xFO.s:7931   .text.ssl_handshake_params_init:0000000000000000 ssl_handshake_params_init
     /tmp/ccEn8xFO.s:7995   .text.ssl_transform_init:0000000000000000 ssl_transform_init
     /tmp/ccEn8xFO.s:8056   .text.mbedtls_ssl_session_init:0000000000000000 mbedtls_ssl_session_init
     /tmp/ccEn8xFO.s:8096   .text.ssl_handshake_init:0000000000000000 ssl_handshake_init
     /tmp/ccEn8xFO.s:8461   .text.mbedtls_ssl_init:0000000000000000 mbedtls_ssl_init
     /tmp/ccEn8xFO.s:8501   .text.ssl_reset_in_out_pointers:0000000000000000 ssl_reset_in_out_pointers
     /tmp/ccEn8xFO.s:8562   .text.mbedtls_ssl_setup:0000000000000000 mbedtls_ssl_setup
     /tmp/ccEn8xFO.s:8712   .text.ssl_session_reset_int:0000000000000000 ssl_session_reset_int
     /tmp/ccEn8xFO.s:8910   .text.mbedtls_ssl_session_reset:0000000000000000 mbedtls_ssl_session_reset
     /tmp/ccEn8xFO.s:8949   .text.mbedtls_ssl_conf_endpoint:0000000000000000 mbedtls_ssl_conf_endpoint
     /tmp/ccEn8xFO.s:8995   .text.mbedtls_ssl_conf_transport:0000000000000000 mbedtls_ssl_conf_transport
     /tmp/ccEn8xFO.s:9041   .text.mbedtls_ssl_conf_authmode:0000000000000000 mbedtls_ssl_conf_authmode
     /tmp/ccEn8xFO.s:9087   .text.mbedtls_ssl_conf_verify:0000000000000000 mbedtls_ssl_conf_verify
     /tmp/ccEn8xFO.s:9132   .text.mbedtls_ssl_conf_rng:0000000000000000 mbedtls_ssl_conf_rng
     /tmp/ccEn8xFO.s:9177   .text.mbedtls_ssl_conf_dbg:0000000000000000 mbedtls_ssl_conf_dbg
     /tmp/ccEn8xFO.s:9222   .text.mbedtls_ssl_set_bio:0000000000000000 mbedtls_ssl_set_bio
     /tmp/ccEn8xFO.s:9277   .text.mbedtls_ssl_conf_read_timeout:0000000000000000 mbedtls_ssl_conf_read_timeout
     /tmp/ccEn8xFO.s:9317   .text.mbedtls_ssl_set_timer_cb:0000000000000000 mbedtls_ssl_set_timer_cb
     /tmp/ccEn8xFO.s:9372   .text.mbedtls_ssl_set_session:0000000000000000 mbedtls_ssl_set_session
     /tmp/ccEn8xFO.s:9456   .text.mbedtls_ssl_conf_ciphersuites:0000000000000000 mbedtls_ssl_conf_ciphersuites
     /tmp/ccEn8xFO.s:9508   .text.mbedtls_ssl_conf_ciphersuites_for_version:0000000000000000 mbedtls_ssl_conf_ciphersuites_for_version
     /tmp/ccEn8xFO.s:9569   .text.mbedtls_ssl_conf_cert_profile:0000000000000000 mbedtls_ssl_conf_cert_profile
     /tmp/ccEn8xFO.s:9608   .text.ssl_append_key_cert:0000000000000000 ssl_append_key_cert
     /tmp/ccEn8xFO.s:9707   .text.mbedtls_ssl_conf_own_cert:0000000000000000 mbedtls_ssl_conf_own_cert
     /tmp/ccEn8xFO.s:9751   .text.mbedtls_ssl_conf_ca_chain:0000000000000000 mbedtls_ssl_conf_ca_chain
     /tmp/ccEn8xFO.s:9796   .text.mbedtls_ssl_conf_sig_hashes:0000000000000000 mbedtls_ssl_conf_sig_hashes
     /tmp/ccEn8xFO.s:9836   .text.mbedtls_ssl_conf_curves:0000000000000000 mbedtls_ssl_conf_curves
     /tmp/ccEn8xFO.s:9876   .text.mbedtls_ssl_set_hostname:0000000000000000 mbedtls_ssl_set_hostname
     /tmp/ccEn8xFO.s:10003  .text.mbedtls_ssl_conf_max_version:0000000000000000 mbedtls_ssl_conf_max_version
     /tmp/ccEn8xFO.s:10050  .text.mbedtls_ssl_conf_min_version:0000000000000000 mbedtls_ssl_conf_min_version
     /tmp/ccEn8xFO.s:10097  .text.mbedtls_ssl_conf_fallback:0000000000000000 mbedtls_ssl_conf_fallback
     /tmp/ccEn8xFO.s:10146  .text.mbedtls_ssl_conf_extended_master_secret:0000000000000000 mbedtls_ssl_conf_extended_master_secret
     /tmp/ccEn8xFO.s:10194  .text.mbedtls_ssl_conf_max_frag_len:0000000000000000 mbedtls_ssl_conf_max_frag_len
     /tmp/ccEn8xFO.s:10261  .text.mbedtls_ssl_conf_legacy_renegotiation:0000000000000000 mbedtls_ssl_conf_legacy_renegotiation
     /tmp/ccEn8xFO.s:10308  .text.mbedtls_ssl_conf_renegotiation:0000000000000000 mbedtls_ssl_conf_renegotiation
     /tmp/ccEn8xFO.s:10354  .text.mbedtls_ssl_conf_renegotiation_enforced:0000000000000000 mbedtls_ssl_conf_renegotiation_enforced
     /tmp/ccEn8xFO.s:10394  .text.mbedtls_ssl_conf_renegotiation_period:0000000000000000 mbedtls_ssl_conf_renegotiation_period
     /tmp/ccEn8xFO.s:10437  .text.mbedtls_ssl_conf_session_tickets:0000000000000000 mbedtls_ssl_conf_session_tickets
     /tmp/ccEn8xFO.s:10483  .text.mbedtls_ssl_conf_export_keys_cb:0000000000000000 mbedtls_ssl_conf_export_keys_cb
     /tmp/ccEn8xFO.s:10528  .text.mbedtls_ssl_get_bytes_avail:0000000000000000 mbedtls_ssl_get_bytes_avail
     /tmp/ccEn8xFO.s:10577  .text.mbedtls_ssl_check_pending:0000000000000000 mbedtls_ssl_check_pending
     /tmp/ccEn8xFO.s:10653  .text.mbedtls_ssl_get_verify_result:0000000000000000 mbedtls_ssl_get_verify_result
     /tmp/ccEn8xFO.s:10716  .text.mbedtls_ssl_get_ciphersuite:0000000000000000 mbedtls_ssl_get_ciphersuite
     /tmp/ccEn8xFO.s:10783  .text.mbedtls_ssl_get_version:0000000000000000 mbedtls_ssl_get_version
     /tmp/ccEn8xFO.s:10854  .text.mbedtls_ssl_get_record_expansion:0000000000000000 mbedtls_ssl_get_record_expansion
     /tmp/ccEn8xFO.s:10971  .text.mbedtls_ssl_get_max_frag_len:0000000000000000 mbedtls_ssl_get_max_frag_len
     /tmp/ccEn8xFO.s:11085  .text.mbedtls_ssl_get_max_out_record_payload:0000000000000000 mbedtls_ssl_get_max_out_record_payload
     /tmp/ccEn8xFO.s:11136  .text.mbedtls_ssl_get_peer_cert:0000000000000000 mbedtls_ssl_get_peer_cert
     /tmp/ccEn8xFO.s:11190  .text.mbedtls_ssl_get_session:0000000000000000 mbedtls_ssl_get_session
     /tmp/ccEn8xFO.s:11260  .text.mbedtls_ssl_handshake_step:0000000000000000 mbedtls_ssl_handshake_step
     /tmp/ccEn8xFO.s:11328  .text.mbedtls_ssl_handshake:0000000000000000 mbedtls_ssl_handshake
     /tmp/ccEn8xFO.s:11400  .text.ssl_start_renegotiation:0000000000000000 ssl_start_renegotiation
GAS LISTING /tmp/ccEn8xFO.s 			page 501


     /tmp/ccEn8xFO.s:11467  .text.mbedtls_ssl_renegotiate:0000000000000000 mbedtls_ssl_renegotiate
     /tmp/ccEn8xFO.s:11559  .text.ssl_check_ctr_renegotiate:0000000000000000 ssl_check_ctr_renegotiate
     /tmp/ccEn8xFO.s:11682  .text.mbedtls_ssl_read:0000000000000000 mbedtls_ssl_read
     /tmp/ccEn8xFO.s:12087  .text.ssl_write_real:0000000000000000 ssl_write_real
     /tmp/ccEn8xFO.s:12197  .text.mbedtls_ssl_write:0000000000000000 mbedtls_ssl_write
     /tmp/ccEn8xFO.s:12288  .text.mbedtls_ssl_close_notify:0000000000000000 mbedtls_ssl_close_notify
     /tmp/ccEn8xFO.s:12437  .text.ssl_key_cert_free:0000000000000000 ssl_key_cert_free
     /tmp/ccEn8xFO.s:12631  .text.mbedtls_ssl_free:0000000000000000 mbedtls_ssl_free
     /tmp/ccEn8xFO.s:12820  .text.mbedtls_ssl_config_init:0000000000000000 mbedtls_ssl_config_init
     /tmp/ccEn8xFO.s:12862  .data.ssl_preset_default_hashes:0000000000000000 ssl_preset_default_hashes
     /tmp/ccEn8xFO.s:12870  .data.ssl_preset_suiteb_ciphersuites:0000000000000000 ssl_preset_suiteb_ciphersuites
     /tmp/ccEn8xFO.s:12878  .data.ssl_preset_suiteb_hashes:0000000000000000 ssl_preset_suiteb_hashes
     /tmp/ccEn8xFO.s:12886  .data.ssl_preset_suiteb_curves:0000000000000000 ssl_preset_suiteb_curves
     /tmp/ccEn8xFO.s:12893  .text.mbedtls_ssl_config_defaults:0000000000000000 mbedtls_ssl_config_defaults
     /tmp/ccEn8xFO.s:13085  .text.mbedtls_ssl_config_free:0000000000000000 mbedtls_ssl_config_free
     /tmp/ccEn8xFO.s:13130  .text.mbedtls_ssl_sig_from_pk:0000000000000000 mbedtls_ssl_sig_from_pk
     /tmp/ccEn8xFO.s:13191  .text.mbedtls_ssl_sig_from_pk_alg:0000000000000000 mbedtls_ssl_sig_from_pk_alg
     /tmp/ccEn8xFO.s:13247  .text.mbedtls_ssl_pk_alg_from_sig:0000000000000000 mbedtls_ssl_pk_alg_from_sig
     /tmp/ccEn8xFO.s:13301  .text.mbedtls_ssl_sig_hash_set_find:0000000000000000 mbedtls_ssl_sig_hash_set_find
     /tmp/ccEn8xFO.s:13356  .text.mbedtls_ssl_sig_hash_set_add:0000000000000000 mbedtls_ssl_sig_hash_set_add
     /tmp/ccEn8xFO.s:13478  .text.mbedtls_ssl_md_alg_from_hash:0000000000000000 mbedtls_ssl_md_alg_from_hash
     /tmp/ccEn8xFO.s:13540  .text.mbedtls_ssl_hash_from_md_alg:0000000000000000 mbedtls_ssl_hash_from_md_alg
     /tmp/ccEn8xFO.s:13678  .text.mbedtls_ssl_check_sig_hash:0000000000000000 mbedtls_ssl_check_sig_hash
     /tmp/ccEn8xFO.s:14021  .text.mbedtls_ssl_set_calc_verify_md:0000000000000000 mbedtls_ssl_set_calc_verify_md
     /tmp/ccEn8xFO.s:14084  .text.mbedtls_ssl_get_key_exchange_md_tls1_2:0000000000000000 mbedtls_ssl_get_key_exchange_md_tls1_2

UNDEFINED SYMBOLS
_GLOBAL_OFFSET_TABLE_
__stack_chk_fail
memcpy
mbedtls_calloc
mbedtls_x509_crt_init
mbedtls_x509_crt_parse_der
mbedtls_free
mbedtls_md_init
mbedtls_md_info_from_type
mbedtls_md_get_size
strlen
mbedtls_md_setup
mbedtls_md_hmac_starts
mbedtls_md_hmac_update
mbedtls_md_hmac_finish
mbedtls_md_hmac_reset
mbedtls_md_free
mbedtls_platform_zeroize
mbedtls_cipher_info_from_type
mbedtls_cipher_setup
mbedtls_cipher_setkey
mbedtls_cipher_set_padding_mode
mbedtls_sha256_init
mbedtls_sha256_clone
mbedtls_sha256_finish_ret
mbedtls_sha256_free
mbedtls_cipher_auth_encrypt
mbedtls_cipher_crypt
mbedtls_cipher_auth_decrypt
mbedtls_md_process
GAS LISTING /tmp/ccEn8xFO.s 			page 502


memmove
mbedtls_x509_crt_free
memcmp
mbedtls_x509_crt_verify_restartable
mbedtls_pk_can_do
memset
mbedtls_sha256_starts_ret
mbedtls_sha256_update_ret
mbedtls_ecdh_init
mbedtls_cipher_init
mbedtls_ssl_get_ciphersuite_name
mbedtls_ssl_handshake_client_step
mbedtls_cipher_free
mbedtls_ecdh_free
mbedtls_x509_crt_profile_suiteb
mbedtls_ssl_list_ciphersuites
mbedtls_x509_crt_profile_default
mbedtls_ecp_grp_id_list
mbedtls_x509_crt_check_key_usage
mbedtls_x509_crt_check_extended_key_usage
mbedtls_md_starts
mbedtls_md_update
mbedtls_md_finish
