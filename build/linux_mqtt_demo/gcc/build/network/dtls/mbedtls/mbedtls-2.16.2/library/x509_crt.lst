GAS LISTING /tmp/ccnlqVtp.s 			page 1


   1              		.file	"x509_crt.c"
   2              		.text
   3              	.Ltext0:
   4              		.section	.text.mbedtls_pk_ec,"ax",@progbits
   6              	mbedtls_pk_ec:
   7              	.LFB1:
   8              		.file 1 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h"
   1:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /**
   2:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * \file pk.h
   3:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *
   4:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * \brief Public Key abstraction layer
   5:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  */
   6:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /*
   7:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  Copyright (C) 2006-2015, ARM Limited, All Rights Reserved
   8:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  SPDX-License-Identifier: Apache-2.0
   9:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *
  10:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  Licensed under the Apache License, Version 2.0 (the "License"); you may
  11:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  not use this file except in compliance with the License.
  12:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  You may obtain a copy of the License at
  13:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *
  14:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  http://www.apache.org/licenses/LICENSE-2.0
  15:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *
  16:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  Unless required by applicable law or agreed to in writing, software
  17:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  18:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  19:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  See the License for the specific language governing permissions and
  20:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  limitations under the License.
  21:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *
  22:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *  This file is part of mbed TLS (https://tls.mbed.org)
  23:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  */
  24:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  25:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #ifndef MBEDTLS_PK_H
  26:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_PK_H
  27:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  28:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #if !defined(MBEDTLS_CONFIG_FILE)
  29:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #include "config.h"
  30:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #else
  31:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #include MBEDTLS_CONFIG_FILE
  32:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #endif
  33:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  34:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #include "md.h"
  35:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  36:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #if defined(MBEDTLS_RSA_C)
  37:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #include "rsa.h"
  38:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #endif
  39:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  40:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #if defined(MBEDTLS_ECP_C)
  41:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #include "ecp.h"
  42:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #endif
  43:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  44:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #if defined(MBEDTLS_ECDSA_C)
  45:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #include "ecdsa.h"
  46:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #endif
  47:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  48:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #if ( defined(__ARMCC_VERSION) || defined(_MSC_VER) ) && \
  49:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     !defined(inline) && !defined(__cplusplus)
  50:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define inline __inline
GAS LISTING /tmp/ccnlqVtp.s 			page 2


  51:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #endif
  52:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  53:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_ALLOC_FAILED        -0x3F80  /**< Memory allocation failed. */
  54:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_TYPE_MISMATCH       -0x3F00  /**< Type mismatch, eg attempt to encrypt with 
  55:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_BAD_INPUT_DATA      -0x3E80  /**< Bad input parameters to function. */
  56:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_FILE_IO_ERROR       -0x3E00  /**< Read/write of file failed. */
  57:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_KEY_INVALID_VERSION -0x3D80  /**< Unsupported key version */
  58:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_KEY_INVALID_FORMAT  -0x3D00  /**< Invalid key tag or value. */
  59:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_UNKNOWN_PK_ALG      -0x3C80  /**< Key algorithm is unsupported (only RSA and
  60:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_PASSWORD_REQUIRED   -0x3C00  /**< Private key password can't be empty. */
  61:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_PASSWORD_MISMATCH   -0x3B80  /**< Given private key password does not allow 
  62:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_INVALID_PUBKEY      -0x3B00  /**< The pubkey tag or value is invalid (only R
  63:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_INVALID_ALG         -0x3A80  /**< The algorithm tag or value is invalid. */
  64:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_UNKNOWN_NAMED_CURVE -0x3A00  /**< Elliptic curve is unsupported (only NIST c
  65:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_FEATURE_UNAVAILABLE -0x3980  /**< Unavailable feature, e.g. RSA disabled for
  66:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_SIG_LEN_MISMATCH    -0x3900  /**< The buffer contains a valid signature foll
  67:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  68:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /* MBEDTLS_ERR_PK_HW_ACCEL_FAILED is deprecated and should not be used. */
  69:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_ERR_PK_HW_ACCEL_FAILED     -0x3880  /**< PK hardware accelerator failed. */
  70:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  71:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #ifdef __cplusplus
  72:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** extern "C" {
  73:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #endif
  74:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  75:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /**
  76:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * \brief          Public key types
  77:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  */
  78:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** typedef enum {
  79:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     MBEDTLS_PK_NONE=0,
  80:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     MBEDTLS_PK_RSA,
  81:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     MBEDTLS_PK_ECKEY,
  82:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     MBEDTLS_PK_ECKEY_DH,
  83:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     MBEDTLS_PK_ECDSA,
  84:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     MBEDTLS_PK_RSA_ALT,
  85:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     MBEDTLS_PK_RSASSA_PSS,
  86:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** } mbedtls_pk_type_t;
  87:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  88:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /**
  89:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * \brief           Options for RSASSA-PSS signature verification.
  90:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *                  See \c mbedtls_rsa_rsassa_pss_verify_ext()
  91:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  */
  92:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** typedef struct mbedtls_pk_rsassa_pss_options
  93:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** {
  94:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     mbedtls_md_type_t mgf1_hash_id;
  95:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     int expected_salt_len;
  96:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  97:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** } mbedtls_pk_rsassa_pss_options;
  98:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
  99:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /**
 100:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * \brief           Types for interfacing with the debug module
 101:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  */
 102:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** typedef enum
 103:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** {
 104:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     MBEDTLS_PK_DEBUG_NONE = 0,
 105:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     MBEDTLS_PK_DEBUG_MPI,
 106:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     MBEDTLS_PK_DEBUG_ECP,
 107:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** } mbedtls_pk_debug_type;
GAS LISTING /tmp/ccnlqVtp.s 			page 3


 108:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
 109:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /**
 110:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * \brief           Item to send to the debug module
 111:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  */
 112:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** typedef struct mbedtls_pk_debug_item
 113:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** {
 114:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     mbedtls_pk_debug_type type;
 115:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     const char *name;
 116:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     void *value;
 117:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** } mbedtls_pk_debug_item;
 118:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
 119:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /** Maximum number of item send for debugging, plus 1 */
 120:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #define MBEDTLS_PK_DEBUG_MAX_ITEMS 3
 121:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
 122:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /**
 123:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * \brief           Public key information and operations
 124:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  */
 125:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** typedef struct mbedtls_pk_info_t mbedtls_pk_info_t;
 126:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
 127:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /**
 128:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * \brief           Public key container
 129:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  */
 130:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** typedef struct mbedtls_pk_context
 131:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** {
 132:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     const mbedtls_pk_info_t *   pk_info; /**< Public key information         */
 133:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     void *                      pk_ctx;  /**< Underlying public key context  */
 134:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** } mbedtls_pk_context;
 135:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
 136:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #if defined(MBEDTLS_ECDSA_C) && defined(MBEDTLS_ECP_RESTARTABLE)
 137:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /**
 138:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * \brief           Context for resuming operations
 139:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  */
 140:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** typedef struct
 141:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** {
 142:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     const mbedtls_pk_info_t *   pk_info; /**< Public key information         */
 143:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     void *                      rs_ctx;  /**< Underlying restart context     */
 144:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** } mbedtls_pk_restart_ctx;
 145:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #else /* MBEDTLS_ECDSA_C && MBEDTLS_ECP_RESTARTABLE */
 146:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /* Now we can declare functions that take a pointer to that */
 147:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** typedef void mbedtls_pk_restart_ctx;
 148:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #endif /* MBEDTLS_ECDSA_C && MBEDTLS_ECP_RESTARTABLE */
 149:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
 150:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #if defined(MBEDTLS_RSA_C)
 151:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /**
 152:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * Quick access to an RSA context inside a PK context.
 153:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *
 154:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * \warning You must make sure the PK context actually holds an RSA context
 155:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * before using this function!
 156:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  */
 157:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** static inline mbedtls_rsa_context *mbedtls_pk_rsa( const mbedtls_pk_context pk )
 158:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** {
 159:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     return( (mbedtls_rsa_context *) (pk).pk_ctx );
 160:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** }
 161:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #endif /* MBEDTLS_RSA_C */
 162:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** 
 163:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** #if defined(MBEDTLS_ECP_C)
 164:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** /**
GAS LISTING /tmp/ccnlqVtp.s 			page 4


 165:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * Quick access to an EC context inside a PK context.
 166:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  *
 167:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * \warning You must make sure the PK context actually holds an EC context
 168:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  * before using this function!
 169:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****  */
 170:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** static inline mbedtls_ecp_keypair *mbedtls_pk_ec( const mbedtls_pk_context pk )
 171:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** {
   9              		.loc 1 171 1
  10              		.cfi_startproc
  11 0000 55       		pushq	%rbp
  12              	.LCFI0:
  13              		.cfi_def_cfa_offset 16
  14              		.cfi_offset 6, -16
  15 0001 4889E5   		movq	%rsp, %rbp
  16              	.LCFI1:
  17              		.cfi_def_cfa_register 6
  18 0004 4883EC20 		subq	$32, %rsp
  19 0008 4889F8   		movq	%rdi, %rax
  20 000b 4889F1   		movq	%rsi, %rcx
  21 000e 4889CA   		movq	%rcx, %rdx
  22 0011 488945E0 		movq	%rax, -32(%rbp)
  23 0015 488955E8 		movq	%rdx, -24(%rbp)
  24              		.loc 1 171 1
  25 0019 64488B04 		movq	%fs:40, %rax
  25      25280000 
  25      00
  26 0022 488945F8 		movq	%rax, -8(%rbp)
  27 0026 31C0     		xorl	%eax, %eax
 172:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h ****     return( (mbedtls_ecp_keypair *) (pk).pk_ctx );
  28              		.loc 1 172 13
  29 0028 488B45E8 		movq	-24(%rbp), %rax
 173:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h **** }
  30              		.loc 1 173 1
  31 002c 488B55F8 		movq	-8(%rbp), %rdx
  32 0030 64483314 		xorq	%fs:40, %rdx
  32      25280000 
  32      00
  33 0039 7405     		je	.L3
  34 003b E8000000 		call	__stack_chk_fail@PLT
  34      00
  35              	.L3:
  36 0040 C9       		leave
  37              	.LCFI2:
  38              		.cfi_def_cfa 7, 8
  39 0041 C3       		ret
  40              		.cfi_endproc
  41              	.LFE1:
  43              		.globl	mbedtls_x509_crt_profile_default
  44              		.section	.rodata.mbedtls_x509_crt_profile_default,"a"
  45              		.align 16
  48              	mbedtls_x509_crt_profile_default:
  49 0000 F0000000 		.long	240
  50 0004 FFFFFF0F 		.long	268435455
  51 0008 FFFFFF0F 		.long	268435455
  52 000c 00080000 		.long	2048
  53              		.globl	mbedtls_x509_crt_profile_next
  54              		.section	.rodata.mbedtls_x509_crt_profile_next,"a"
GAS LISTING /tmp/ccnlqVtp.s 			page 5


  55              		.align 16
  58              	mbedtls_x509_crt_profile_next:
  59 0000 E0000000 		.long	224
  60 0004 FFFFFF0F 		.long	268435455
  61 0008 FC080000 		.long	2300
  62 000c 00080000 		.long	2048
  63              		.globl	mbedtls_x509_crt_profile_suiteb
  64              		.section	.rodata.mbedtls_x509_crt_profile_suiteb,"a"
  65              		.align 16
  68              	mbedtls_x509_crt_profile_suiteb:
  69 0000 60000000 		.long	96
  70 0004 0A000000 		.long	10
  71 0008 0C000000 		.long	12
  72 000c 00000000 		.long	0
  73              		.section	.text.x509_profile_check_md_alg,"ax",@progbits
  75              	x509_profile_check_md_alg:
  76              	.LFB16:
  77              		.file 2 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c"
   1:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
   2:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  X.509 certificate parsing and verification
   3:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
   4:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  Copyright (C) 2006-2015, ARM Limited, All Rights Reserved
   5:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  SPDX-License-Identifier: Apache-2.0
   6:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
   7:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  Licensed under the Apache License, Version 2.0 (the "License"); you may
   8:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  not use this file except in compliance with the License.
   9:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  You may obtain a copy of the License at
  10:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
  11:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  http://www.apache.org/licenses/LICENSE-2.0
  12:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
  13:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  Unless required by applicable law or agreed to in writing, software
  14:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  15:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  16:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  See the License for the specific language governing permissions and
  17:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  limitations under the License.
  18:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
  19:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  This file is part of mbed TLS (https://tls.mbed.org)
  20:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
  21:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
  22:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  The ITU-T X.509 standard defines a certificate format for PKI.
  23:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
  24:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  http://www.ietf.org/rfc/rfc5280.txt (Certificates and CRLs)
  25:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  http://www.ietf.org/rfc/rfc3279.txt (Alg IDs for CRLs)
  26:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  http://www.ietf.org/rfc/rfc2986.txt (CSRs, aka PKCS#10)
  27:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
  28:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  http://www.itu.int/ITU-T/studygroups/com17/languages/X.680-0207.pdf
  29:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  http://www.itu.int/ITU-T/studygroups/com17/languages/X.690-0207.pdf
  30:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
  31:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  [SIRO] https://cabforum.org/wp-content/uploads/Chunghwatelecom201503cabforumV4.pdf
  32:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
  33:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
  34:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if !defined(MBEDTLS_CONFIG_FILE)
  35:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #include "mbedtls/config.h"
  36:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #else
  37:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #include MBEDTLS_CONFIG_FILE
  38:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
  39:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
GAS LISTING /tmp/ccnlqVtp.s 			page 6


  40:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
  41:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
  42:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #include "mbedtls/x509_crt.h"
  43:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #include "mbedtls/oid.h"
  44:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #include "mbedtls/platform_util.h"
  45:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
  46:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #include <string.h>
  47:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
  48:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_PEM_PARSE_C)
  49:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #include "mbedtls/pem.h"
  50:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
  51:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
  52:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_PLATFORM_C)
  53:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #include "mbedtls/platform.h"
  54:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #else
  55:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #include <stdio.h>
  56:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #include <stdlib.h>
  57:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #define mbedtls_free       free
  58:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #define mbedtls_calloc    calloc
  59:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #define mbedtls_snprintf   snprintf
  60:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
  61:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
  62:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_THREADING_C)
  63:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #include "mbedtls/threading.h"
  64:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
  65:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
  66:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(_WIN32) && !defined(EFIX64) && !defined(EFI32)
  67:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #include <windows.h>
  68:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #else
  69:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #include <time.h>
  70:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
  71:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
  72:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_FS_IO)
  73:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #include <stdio.h>
  74:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if !defined(_WIN32) || defined(EFIX64) || defined(EFI32)
  75:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #include <sys/types.h>
  76:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #include <sys/stat.h>
  77:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #include <dirent.h>
  78:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif /* !_WIN32 || EFIX64 || EFI32 */
  79:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
  80:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
  81:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
  82:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Item in a verification chain: cert and flags for it
  83:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
  84:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** typedef struct {
  85:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_x509_crt *crt;
  86:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     uint32_t flags;
  87:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** } x509_crt_verify_chain_item;
  88:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
  89:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
  90:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Max size of verification chain: end-entity + intermediates + trusted root
  91:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
  92:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #define X509_MAX_VERIFY_CHAIN_SIZE    ( MBEDTLS_X509_MAX_INTERMEDIATE_CA + 2 )
  93:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
  94:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
  95:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Default profile
  96:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
GAS LISTING /tmp/ccnlqVtp.s 			page 7


  97:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** const mbedtls_x509_crt_profile mbedtls_x509_crt_profile_default =
  98:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
  99:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_TLS_DEFAULT_ALLOW_SHA1_IN_CERTIFICATES)
 100:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Allow SHA-1 (weak, but still safe in controlled environments) */
 101:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_ID_FLAG( MBEDTLS_MD_SHA1 ) |
 102:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
 103:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Only SHA-2 hashes */
 104:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_ID_FLAG( MBEDTLS_MD_SHA224 ) |
 105:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_ID_FLAG( MBEDTLS_MD_SHA256 ) |
 106:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_ID_FLAG( MBEDTLS_MD_SHA384 ) |
 107:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_ID_FLAG( MBEDTLS_MD_SHA512 ),
 108:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     0xFFFFFFF, /* Any PK alg    */
 109:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     0xFFFFFFF, /* Any curve     */
 110:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     2048,
 111:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** };
 112:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 113:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
 114:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Next-default profile
 115:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
 116:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** const mbedtls_x509_crt_profile mbedtls_x509_crt_profile_next =
 117:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 118:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Hashes from SHA-256 and above */
 119:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_ID_FLAG( MBEDTLS_MD_SHA256 ) |
 120:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_ID_FLAG( MBEDTLS_MD_SHA384 ) |
 121:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_ID_FLAG( MBEDTLS_MD_SHA512 ),
 122:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     0xFFFFFFF, /* Any PK alg    */
 123:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_ECP_C)
 124:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Curves at or above 128-bit security level */
 125:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_ID_FLAG( MBEDTLS_ECP_DP_SECP256R1 ) |
 126:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_ID_FLAG( MBEDTLS_ECP_DP_SECP384R1 ) |
 127:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_ID_FLAG( MBEDTLS_ECP_DP_SECP521R1 ) |
 128:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_ID_FLAG( MBEDTLS_ECP_DP_BP256R1 ) |
 129:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_ID_FLAG( MBEDTLS_ECP_DP_BP384R1 ) |
 130:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_ID_FLAG( MBEDTLS_ECP_DP_BP512R1 ) |
 131:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_ID_FLAG( MBEDTLS_ECP_DP_SECP256K1 ),
 132:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #else
 133:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     0,
 134:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
 135:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     2048,
 136:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** };
 137:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 138:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
 139:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * NSA Suite B Profile
 140:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
 141:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** const mbedtls_x509_crt_profile mbedtls_x509_crt_profile_suiteb =
 142:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 143:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Only SHA-256 and 384 */
 144:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_ID_FLAG( MBEDTLS_MD_SHA256 ) |
 145:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_ID_FLAG( MBEDTLS_MD_SHA384 ),
 146:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Only ECDSA */
 147:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_ID_FLAG( MBEDTLS_PK_ECDSA ) |
 148:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_ID_FLAG( MBEDTLS_PK_ECKEY ),
 149:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_ECP_C)
 150:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Only NIST P-256 and P-384 */
 151:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_ID_FLAG( MBEDTLS_ECP_DP_SECP256R1 ) |
 152:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_ID_FLAG( MBEDTLS_ECP_DP_SECP384R1 ),
 153:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #else
GAS LISTING /tmp/ccnlqVtp.s 			page 8


 154:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     0,
 155:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
 156:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     0,
 157:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** };
 158:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 159:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
 160:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Check md_alg against profile
 161:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Return 0 if md_alg is acceptable for this profile, -1 otherwise
 162:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
 163:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_profile_check_md_alg( const mbedtls_x509_crt_profile *profile,
 164:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                       mbedtls_md_type_t md_alg )
 165:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
  78              		.loc 2 165 1
  79              		.cfi_startproc
  80 0000 F30F1EFA 		endbr64
  81 0004 55       		pushq	%rbp
  82              	.LCFI3:
  83              		.cfi_def_cfa_offset 16
  84              		.cfi_offset 6, -16
  85 0005 4889E5   		movq	%rsp, %rbp
  86              	.LCFI4:
  87              		.cfi_def_cfa_register 6
  88 0008 4883EC20 		subq	$32, %rsp
  89 000c 48897DE8 		movq	%rdi, -24(%rbp)
  90 0010 8975E4   		movl	%esi, -28(%rbp)
  91              		.loc 2 165 1
  92 0013 64488B04 		movq	%fs:40, %rax
  92      25280000 
  92      00
  93 001c 488945F8 		movq	%rax, -8(%rbp)
  94 0020 31C0     		xorl	%eax, %eax
 166:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( md_alg == MBEDTLS_MD_NONE )
  95              		.loc 2 166 7
  96 0022 837DE400 		cmpl	$0, -28(%rbp)
  97 0026 7507     		jne	.L5
 167:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( -1 );
  98              		.loc 2 167 15
  99 0028 B8FFFFFF 		movl	$-1, %eax
  99      FF
 100 002d EB29     		jmp	.L6
 101              	.L5:
 168:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 169:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( profile->allowed_mds & MBEDTLS_X509_ID_FLAG( md_alg ) ) != 0 )
 102              		.loc 2 169 18
 103 002f 488B45E8 		movq	-24(%rbp), %rax
 104 0033 8B00     		movl	(%rax), %eax
 105              		.loc 2 169 34
 106 0035 8B55E4   		movl	-28(%rbp), %edx
 107 0038 83EA01   		subl	$1, %edx
 108 003b BE010000 		movl	$1, %esi
 108      00
 109 0040 89D1     		movl	%edx, %ecx
 110 0042 D3E6     		sall	%cl, %esi
 111 0044 89F2     		movl	%esi, %edx
 112              		.loc 2 169 32
 113 0046 21D0     		andl	%edx, %eax
 114              		.loc 2 169 7
GAS LISTING /tmp/ccnlqVtp.s 			page 9


 115 0048 85C0     		testl	%eax, %eax
 116 004a 7407     		je	.L7
 170:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( 0 );
 117              		.loc 2 170 15
 118 004c B8000000 		movl	$0, %eax
 118      00
 119 0051 EB05     		jmp	.L6
 120              	.L7:
 171:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 172:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( -1 );
 121              		.loc 2 172 11
 122 0053 B8FFFFFF 		movl	$-1, %eax
 122      FF
 123              	.L6:
 173:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 124              		.loc 2 173 1
 125 0058 488B7DF8 		movq	-8(%rbp), %rdi
 126 005c 6448333C 		xorq	%fs:40, %rdi
 126      25280000 
 126      00
 127 0065 7405     		je	.L8
 128 0067 E8000000 		call	__stack_chk_fail@PLT
 128      00
 129              	.L8:
 130 006c C9       		leave
 131              	.LCFI5:
 132              		.cfi_def_cfa 7, 8
 133 006d C3       		ret
 134              		.cfi_endproc
 135              	.LFE16:
 137              		.section	.text.x509_profile_check_pk_alg,"ax",@progbits
 139              	x509_profile_check_pk_alg:
 140              	.LFB17:
 174:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 175:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
 176:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Check pk_alg against profile
 177:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Return 0 if pk_alg is acceptable for this profile, -1 otherwise
 178:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
 179:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_profile_check_pk_alg( const mbedtls_x509_crt_profile *profile,
 180:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                       mbedtls_pk_type_t pk_alg )
 181:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 141              		.loc 2 181 1
 142              		.cfi_startproc
 143 0000 F30F1EFA 		endbr64
 144 0004 55       		pushq	%rbp
 145              	.LCFI6:
 146              		.cfi_def_cfa_offset 16
 147              		.cfi_offset 6, -16
 148 0005 4889E5   		movq	%rsp, %rbp
 149              	.LCFI7:
 150              		.cfi_def_cfa_register 6
 151 0008 4883EC20 		subq	$32, %rsp
 152 000c 48897DE8 		movq	%rdi, -24(%rbp)
 153 0010 8975E4   		movl	%esi, -28(%rbp)
 154              		.loc 2 181 1
 155 0013 64488B04 		movq	%fs:40, %rax
 155      25280000 
GAS LISTING /tmp/ccnlqVtp.s 			page 10


 155      00
 156 001c 488945F8 		movq	%rax, -8(%rbp)
 157 0020 31C0     		xorl	%eax, %eax
 182:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( pk_alg == MBEDTLS_PK_NONE )
 158              		.loc 2 182 7
 159 0022 837DE400 		cmpl	$0, -28(%rbp)
 160 0026 7507     		jne	.L10
 183:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( -1 );
 161              		.loc 2 183 15
 162 0028 B8FFFFFF 		movl	$-1, %eax
 162      FF
 163 002d EB2A     		jmp	.L11
 164              	.L10:
 184:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 185:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( profile->allowed_pks & MBEDTLS_X509_ID_FLAG( pk_alg ) ) != 0 )
 165              		.loc 2 185 18
 166 002f 488B45E8 		movq	-24(%rbp), %rax
 167 0033 8B4004   		movl	4(%rax), %eax
 168              		.loc 2 185 34
 169 0036 8B55E4   		movl	-28(%rbp), %edx
 170 0039 83EA01   		subl	$1, %edx
 171 003c BE010000 		movl	$1, %esi
 171      00
 172 0041 89D1     		movl	%edx, %ecx
 173 0043 D3E6     		sall	%cl, %esi
 174 0045 89F2     		movl	%esi, %edx
 175              		.loc 2 185 32
 176 0047 21D0     		andl	%edx, %eax
 177              		.loc 2 185 7
 178 0049 85C0     		testl	%eax, %eax
 179 004b 7407     		je	.L12
 186:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( 0 );
 180              		.loc 2 186 15
 181 004d B8000000 		movl	$0, %eax
 181      00
 182 0052 EB05     		jmp	.L11
 183              	.L12:
 187:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 188:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( -1 );
 184              		.loc 2 188 11
 185 0054 B8FFFFFF 		movl	$-1, %eax
 185      FF
 186              	.L11:
 189:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 187              		.loc 2 189 1
 188 0059 488B7DF8 		movq	-8(%rbp), %rdi
 189 005d 6448333C 		xorq	%fs:40, %rdi
 189      25280000 
 189      00
 190 0066 7405     		je	.L13
 191 0068 E8000000 		call	__stack_chk_fail@PLT
 191      00
 192              	.L13:
 193 006d C9       		leave
 194              	.LCFI8:
 195              		.cfi_def_cfa 7, 8
 196 006e C3       		ret
GAS LISTING /tmp/ccnlqVtp.s 			page 11


 197              		.cfi_endproc
 198              	.LFE17:
 200              		.section	.text.x509_profile_check_key,"ax",@progbits
 202              	x509_profile_check_key:
 203              	.LFB18:
 190:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 191:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
 192:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Check key against profile
 193:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Return 0 if pk is acceptable for this profile, -1 otherwise
 194:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
 195:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_profile_check_key( const mbedtls_x509_crt_profile *profile,
 196:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                    const mbedtls_pk_context *pk )
 197:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 204              		.loc 2 197 1
 205              		.cfi_startproc
 206 0000 F30F1EFA 		endbr64
 207 0004 55       		pushq	%rbp
 208              	.LCFI9:
 209              		.cfi_def_cfa_offset 16
 210              		.cfi_offset 6, -16
 211 0005 4889E5   		movq	%rsp, %rbp
 212              	.LCFI10:
 213              		.cfi_def_cfa_register 6
 214 0008 4883EC20 		subq	$32, %rsp
 215 000c 48897DE8 		movq	%rdi, -24(%rbp)
 216 0010 488975E0 		movq	%rsi, -32(%rbp)
 217              		.loc 2 197 1
 218 0014 64488B04 		movq	%fs:40, %rax
 218      25280000 
 218      00
 219 001d 488945F8 		movq	%rax, -8(%rbp)
 220 0021 31C0     		xorl	%eax, %eax
 198:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     const mbedtls_pk_type_t pk_alg = mbedtls_pk_get_type( pk );
 221              		.loc 2 198 38
 222 0023 488B45E0 		movq	-32(%rbp), %rax
 223 0027 4889C7   		movq	%rax, %rdi
 224 002a E8000000 		call	mbedtls_pk_get_type@PLT
 224      00
 225 002f 8945F0   		movl	%eax, -16(%rbp)
 199:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 200:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_RSA_C)
 201:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( pk_alg == MBEDTLS_PK_RSA || pk_alg == MBEDTLS_PK_RSASSA_PSS )
 226              		.loc 2 201 7
 227 0032 837DF001 		cmpl	$1, -16(%rbp)
 228 0036 7406     		je	.L15
 229              		.loc 2 201 34 discriminator 1
 230 0038 837DF006 		cmpl	$6, -16(%rbp)
 231 003c 7528     		jne	.L16
 232              	.L15:
 202:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 203:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( mbedtls_pk_get_bitlen( pk ) >= profile->rsa_min_bitlen )
 233              		.loc 2 203 13
 234 003e 488B45E0 		movq	-32(%rbp), %rax
 235 0042 4889C7   		movq	%rax, %rdi
 236 0045 E8000000 		call	mbedtls_pk_get_bitlen@PLT
 236      00
 237              		.loc 2 203 51
GAS LISTING /tmp/ccnlqVtp.s 			page 12


 238 004a 488B55E8 		movq	-24(%rbp), %rdx
 239 004e 8B520C   		movl	12(%rdx), %edx
 240 0051 89D2     		movl	%edx, %edx
 241              		.loc 2 203 11
 242 0053 4839D0   		cmpq	%rdx, %rax
 243 0056 7207     		jb	.L17
 204:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( 0 );
 244              		.loc 2 204 19
 245 0058 B8000000 		movl	$0, %eax
 245      00
 246 005d EB72     		jmp	.L18
 247              	.L17:
 205:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 206:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( -1 );
 248              		.loc 2 206 15
 249 005f B8FFFFFF 		movl	$-1, %eax
 249      FF
 250 0064 EB6B     		jmp	.L18
 251              	.L16:
 207:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 208:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
 209:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 210:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_ECP_C)
 211:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( pk_alg == MBEDTLS_PK_ECDSA ||
 252              		.loc 2 211 7
 253 0066 837DF004 		cmpl	$4, -16(%rbp)
 254 006a 740C     		je	.L19
 255              		.loc 2 211 36 discriminator 1
 256 006c 837DF002 		cmpl	$2, -16(%rbp)
 257 0070 7406     		je	.L19
 212:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         pk_alg == MBEDTLS_PK_ECKEY ||
 258              		.loc 2 212 36
 259 0072 837DF003 		cmpl	$3, -16(%rbp)
 260 0076 7554     		jne	.L20
 261              	.L19:
 262              	.LBB2:
 213:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         pk_alg == MBEDTLS_PK_ECKEY_DH )
 214:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 215:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         const mbedtls_ecp_group_id gid = mbedtls_pk_ec( *pk )->grp.id;
 263              		.loc 2 215 42
 264 0078 488B45E0 		movq	-32(%rbp), %rax
 265 007c 488B10   		movq	(%rax), %rdx
 266 007f 488B4008 		movq	8(%rax), %rax
 267 0083 4889D7   		movq	%rdx, %rdi
 268 0086 4889C6   		movq	%rax, %rsi
 269 0089 E8000000 		call	mbedtls_pk_ec
 269      00
 270              		.loc 2 215 36
 271 008e 8B00     		movl	(%rax), %eax
 272 0090 8945F4   		movl	%eax, -12(%rbp)
 216:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 217:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( gid == MBEDTLS_ECP_DP_NONE )
 273              		.loc 2 217 11
 274 0093 837DF400 		cmpl	$0, -12(%rbp)
 275 0097 7507     		jne	.L21
 218:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( -1 );
 276              		.loc 2 218 19
GAS LISTING /tmp/ccnlqVtp.s 			page 13


 277 0099 B8FFFFFF 		movl	$-1, %eax
 277      FF
 278 009e EB31     		jmp	.L18
 279              	.L21:
 219:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 220:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ( profile->allowed_curves & MBEDTLS_X509_ID_FLAG( gid ) ) != 0 )
 280              		.loc 2 220 22
 281 00a0 488B45E8 		movq	-24(%rbp), %rax
 282 00a4 8B4008   		movl	8(%rax), %eax
 283              		.loc 2 220 41
 284 00a7 8B55F4   		movl	-12(%rbp), %edx
 285 00aa 83EA01   		subl	$1, %edx
 286 00ad BE010000 		movl	$1, %esi
 286      00
 287 00b2 89D1     		movl	%edx, %ecx
 288 00b4 D3E6     		sall	%cl, %esi
 289 00b6 89F2     		movl	%esi, %edx
 290              		.loc 2 220 39
 291 00b8 21D0     		andl	%edx, %eax
 292              		.loc 2 220 11
 293 00ba 85C0     		testl	%eax, %eax
 294 00bc 7407     		je	.L22
 221:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( 0 );
 295              		.loc 2 221 19
 296 00be B8000000 		movl	$0, %eax
 296      00
 297 00c3 EB0C     		jmp	.L18
 298              	.L22:
 222:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 223:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( -1 );
 299              		.loc 2 223 15
 300 00c5 B8FFFFFF 		movl	$-1, %eax
 300      FF
 301 00ca EB05     		jmp	.L18
 302              	.L20:
 303              	.LBE2:
 224:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 225:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
 226:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 227:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( -1 );
 304              		.loc 2 227 11
 305 00cc B8FFFFFF 		movl	$-1, %eax
 305      FF
 306              	.L18:
 228:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 307              		.loc 2 228 1
 308 00d1 488B4DF8 		movq	-8(%rbp), %rcx
 309 00d5 6448330C 		xorq	%fs:40, %rcx
 309      25280000 
 309      00
 310 00de 7405     		je	.L23
 311 00e0 E8000000 		call	__stack_chk_fail@PLT
 311      00
 312              	.L23:
 313 00e5 C9       		leave
 314              	.LCFI11:
 315              		.cfi_def_cfa 7, 8
GAS LISTING /tmp/ccnlqVtp.s 			page 14


 316 00e6 C3       		ret
 317              		.cfi_endproc
 318              	.LFE18:
 320              		.section	.text.x509_memcasecmp,"ax",@progbits
 322              	x509_memcasecmp:
 323              	.LFB19:
 229:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 230:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
 231:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Like memcmp, but case-insensitive and always returns -1 if different
 232:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
 233:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_memcasecmp( const void *s1, const void *s2, size_t len )
 234:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 324              		.loc 2 234 1
 325              		.cfi_startproc
 326 0000 F30F1EFA 		endbr64
 327 0004 55       		pushq	%rbp
 328              	.LCFI12:
 329              		.cfi_def_cfa_offset 16
 330              		.cfi_offset 6, -16
 331 0005 4889E5   		movq	%rsp, %rbp
 332              	.LCFI13:
 333              		.cfi_def_cfa_register 6
 334 0008 4883EC50 		subq	$80, %rsp
 335 000c 48897DC8 		movq	%rdi, -56(%rbp)
 336 0010 488975C0 		movq	%rsi, -64(%rbp)
 337 0014 488955B8 		movq	%rdx, -72(%rbp)
 338              		.loc 2 234 1
 339 0018 64488B04 		movq	%fs:40, %rax
 339      25280000 
 339      00
 340 0021 488945F8 		movq	%rax, -8(%rbp)
 341 0025 31C0     		xorl	%eax, %eax
 235:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     size_t i;
 236:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     unsigned char diff;
 237:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     const unsigned char *n1 = s1, *n2 = s2;
 342              		.loc 2 237 26
 343 0027 488B45C8 		movq	-56(%rbp), %rax
 344 002b 488945E8 		movq	%rax, -24(%rbp)
 345              		.loc 2 237 36
 346 002f 488B45C0 		movq	-64(%rbp), %rax
 347 0033 488945F0 		movq	%rax, -16(%rbp)
 238:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 239:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     for( i = 0; i < len; i++ )
 348              		.loc 2 239 12
 349 0037 48C745E0 		movq	$0, -32(%rbp)
 349      00000000 
 350              		.loc 2 239 5
 351 003f E9850000 		jmp	.L25
 351      00
 352              	.L32:
 240:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 241:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         diff = n1[i] ^ n2[i];
 353              		.loc 2 241 18
 354 0044 488B55E8 		movq	-24(%rbp), %rdx
 355 0048 488B45E0 		movq	-32(%rbp), %rax
 356 004c 4801D0   		addq	%rdx, %rax
 357 004f 0FB608   		movzbl	(%rax), %ecx
GAS LISTING /tmp/ccnlqVtp.s 			page 15


 358              		.loc 2 241 26
 359 0052 488B55F0 		movq	-16(%rbp), %rdx
 360 0056 488B45E0 		movq	-32(%rbp), %rax
 361 005a 4801D0   		addq	%rdx, %rax
 362 005d 0FB600   		movzbl	(%rax), %eax
 363              		.loc 2 241 14
 364 0060 31C8     		xorl	%ecx, %eax
 365 0062 8845DF   		movb	%al, -33(%rbp)
 242:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 243:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( diff == 0 )
 366              		.loc 2 243 11
 367 0065 807DDF00 		cmpb	$0, -33(%rbp)
 368 0069 7455     		je	.L34
 244:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             continue;
 245:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 246:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( diff == 32 &&
 369              		.loc 2 246 11
 370 006b 807DDF20 		cmpb	$32, -33(%rbp)
 371 006f 7548     		jne	.L28
 247:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             ( ( n1[i] >= 'a' && n1[i] <= 'z' ) ||
 372              		.loc 2 247 19 discriminator 1
 373 0071 488B55E8 		movq	-24(%rbp), %rdx
 374 0075 488B45E0 		movq	-32(%rbp), %rax
 375 0079 4801D0   		addq	%rdx, %rax
 376 007c 0FB600   		movzbl	(%rax), %eax
 246:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             ( ( n1[i] >= 'a' && n1[i] <= 'z' ) ||
 377              		.loc 2 246 24 discriminator 1
 378 007f 3C60     		cmpb	$96, %al
 379 0081 7612     		jbe	.L29
 380              		.loc 2 247 35
 381 0083 488B55E8 		movq	-24(%rbp), %rdx
 382 0087 488B45E0 		movq	-32(%rbp), %rax
 383 008b 4801D0   		addq	%rdx, %rax
 384 008e 0FB600   		movzbl	(%rax), %eax
 385              		.loc 2 247 30
 386 0091 3C7A     		cmpb	$122, %al
 387 0093 762E     		jbe	.L35
 388              	.L29:
 248:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****               ( n1[i] >= 'A' && n1[i] <= 'Z' ) ) )
 389              		.loc 2 248 19 discriminator 1
 390 0095 488B55E8 		movq	-24(%rbp), %rdx
 391 0099 488B45E0 		movq	-32(%rbp), %rax
 392 009d 4801D0   		addq	%rdx, %rax
 393 00a0 0FB600   		movzbl	(%rax), %eax
 247:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             ( ( n1[i] >= 'a' && n1[i] <= 'z' ) ||
 394              		.loc 2 247 48 discriminator 1
 395 00a3 3C40     		cmpb	$64, %al
 396 00a5 7612     		jbe	.L28
 397              		.loc 2 248 35
 398 00a7 488B55E8 		movq	-24(%rbp), %rdx
 399 00ab 488B45E0 		movq	-32(%rbp), %rax
 400 00af 4801D0   		addq	%rdx, %rax
 401 00b2 0FB600   		movzbl	(%rax), %eax
 402              		.loc 2 248 30
 403 00b5 3C5A     		cmpb	$90, %al
 404 00b7 760A     		jbe	.L35
 405              	.L28:
GAS LISTING /tmp/ccnlqVtp.s 			page 16


 249:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
 250:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             continue;
 251:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
 252:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 253:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( -1 );
 406              		.loc 2 253 15
 407 00b9 B8FFFFFF 		movl	$-1, %eax
 407      FF
 408 00be EB1C     		jmp	.L31
 409              	.L34:
 244:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 410              		.loc 2 244 13
 411 00c0 90       		nop
 412 00c1 EB01     		jmp	.L27
 413              	.L35:
 250:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
 414              		.loc 2 250 13
 415 00c3 90       		nop
 416              	.L27:
 239:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 417              		.loc 2 239 27 discriminator 2
 418 00c4 488345E0 		addq	$1, -32(%rbp)
 418      01
 419              	.L25:
 239:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 420              		.loc 2 239 5 discriminator 1
 421 00c9 488B45E0 		movq	-32(%rbp), %rax
 422 00cd 483B45B8 		cmpq	-72(%rbp), %rax
 423 00d1 0F826DFF 		jb	.L32
 423      FFFF
 254:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 255:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 256:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 424              		.loc 2 256 11
 425 00d7 B8000000 		movl	$0, %eax
 425      00
 426              	.L31:
 257:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 427              		.loc 2 257 1
 428 00dc 488B75F8 		movq	-8(%rbp), %rsi
 429 00e0 64483334 		xorq	%fs:40, %rsi
 429      25280000 
 429      00
 430 00e9 7405     		je	.L33
 431 00eb E8000000 		call	__stack_chk_fail@PLT
 431      00
 432              	.L33:
 433 00f0 C9       		leave
 434              	.LCFI14:
 435              		.cfi_def_cfa 7, 8
 436 00f1 C3       		ret
 437              		.cfi_endproc
 438              	.LFE19:
 440              		.section	.text.x509_check_wildcard,"ax",@progbits
 442              	x509_check_wildcard:
 443              	.LFB20:
 258:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
GAS LISTING /tmp/ccnlqVtp.s 			page 17


 259:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
 260:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Return 0 if name matches wildcard, -1 otherwise
 261:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
 262:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_check_wildcard( const char *cn, const mbedtls_x509_buf *name )
 263:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 444              		.loc 2 263 1
 445              		.cfi_startproc
 446 0000 F30F1EFA 		endbr64
 447 0004 55       		pushq	%rbp
 448              	.LCFI15:
 449              		.cfi_def_cfa_offset 16
 450              		.cfi_offset 6, -16
 451 0005 4889E5   		movq	%rsp, %rbp
 452              	.LCFI16:
 453              		.cfi_def_cfa_register 6
 454 0008 4883EC30 		subq	$48, %rsp
 455 000c 48897DD8 		movq	%rdi, -40(%rbp)
 456 0010 488975D0 		movq	%rsi, -48(%rbp)
 457              		.loc 2 263 1
 458 0014 64488B04 		movq	%fs:40, %rax
 458      25280000 
 458      00
 459 001d 488945F8 		movq	%rax, -8(%rbp)
 460 0021 31C0     		xorl	%eax, %eax
 264:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     size_t i;
 265:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     size_t cn_idx = 0, cn_len = strlen( cn );
 461              		.loc 2 265 12
 462 0023 48C745E8 		movq	$0, -24(%rbp)
 462      00000000 
 463              		.loc 2 265 33
 464 002b 488B45D8 		movq	-40(%rbp), %rax
 465 002f 4889C7   		movq	%rax, %rdi
 466 0032 E8000000 		call	strlen@PLT
 466      00
 467 0037 488945F0 		movq	%rax, -16(%rbp)
 266:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 267:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* We can't have a match if there is no wildcard to match */
 268:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( name->len < 3 || name->p[0] != '*' || name->p[1] != '.' )
 468              		.loc 2 268 13
 469 003b 488B45D0 		movq	-48(%rbp), %rax
 470 003f 488B4008 		movq	8(%rax), %rax
 471              		.loc 2 268 7
 472 0043 4883F802 		cmpq	$2, %rax
 473 0047 7622     		jbe	.L37
 474              		.loc 2 268 30 discriminator 1
 475 0049 488B45D0 		movq	-48(%rbp), %rax
 476 004d 488B4010 		movq	16(%rax), %rax
 477              		.loc 2 268 33 discriminator 1
 478 0051 0FB600   		movzbl	(%rax), %eax
 479              		.loc 2 268 23 discriminator 1
 480 0054 3C2A     		cmpb	$42, %al
 481 0056 7513     		jne	.L37
 482              		.loc 2 268 51 discriminator 2
 483 0058 488B45D0 		movq	-48(%rbp), %rax
 484 005c 488B4010 		movq	16(%rax), %rax
 485              		.loc 2 268 54 discriminator 2
 486 0060 4883C001 		addq	$1, %rax
GAS LISTING /tmp/ccnlqVtp.s 			page 18


 487 0064 0FB600   		movzbl	(%rax), %eax
 488              		.loc 2 268 44 discriminator 2
 489 0067 3C2E     		cmpb	$46, %al
 490 0069 740A     		je	.L38
 491              	.L37:
 269:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( -1 );
 492              		.loc 2 269 15
 493 006b B8FFFFFF 		movl	$-1, %eax
 493      FF
 494 0070 E99D0000 		jmp	.L39
 494      00
 495              	.L38:
 270:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 271:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     for( i = 0; i < cn_len; ++i )
 496              		.loc 2 271 12
 497 0075 48C745E0 		movq	$0, -32(%rbp)
 497      00000000 
 498              		.loc 2 271 5
 499 007d EB21     		jmp	.L40
 500              	.L43:
 272:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 273:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( cn[i] == '.' )
 501              		.loc 2 273 15
 502 007f 488B55D8 		movq	-40(%rbp), %rdx
 503 0083 488B45E0 		movq	-32(%rbp), %rax
 504 0087 4801D0   		addq	%rdx, %rax
 505 008a 0FB600   		movzbl	(%rax), %eax
 506              		.loc 2 273 11
 507 008d 3C2E     		cmpb	$46, %al
 508 008f 750A     		jne	.L41
 274:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
 275:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             cn_idx = i;
 509              		.loc 2 275 20
 510 0091 488B45E0 		movq	-32(%rbp), %rax
 511 0095 488945E8 		movq	%rax, -24(%rbp)
 276:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             break;
 512              		.loc 2 276 13
 513 0099 EB0F     		jmp	.L42
 514              	.L41:
 271:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 515              		.loc 2 271 29 discriminator 2
 516 009b 488345E0 		addq	$1, -32(%rbp)
 516      01
 517              	.L40:
 271:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 518              		.loc 2 271 5 discriminator 1
 519 00a0 488B45E0 		movq	-32(%rbp), %rax
 520 00a4 483B45F0 		cmpq	-16(%rbp), %rax
 521 00a8 72D5     		jb	.L43
 522              	.L42:
 277:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
 278:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 279:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 280:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( cn_idx == 0 )
 523              		.loc 2 280 7
 524 00aa 48837DE8 		cmpq	$0, -24(%rbp)
 524      00
GAS LISTING /tmp/ccnlqVtp.s 			page 19


 525 00af 7507     		jne	.L44
 281:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( -1 );
 526              		.loc 2 281 15
 527 00b1 B8FFFFFF 		movl	$-1, %eax
 527      FF
 528 00b6 EB5A     		jmp	.L39
 529              	.L44:
 282:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 283:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( cn_len - cn_idx == name->len - 1 &&
 530              		.loc 2 283 16
 531 00b8 488B45F0 		movq	-16(%rbp), %rax
 532 00bc 482B45E8 		subq	-24(%rbp), %rax
 533 00c0 4889C2   		movq	%rax, %rdx
 534              		.loc 2 283 32
 535 00c3 488B45D0 		movq	-48(%rbp), %rax
 536 00c7 488B4008 		movq	8(%rax), %rax
 537              		.loc 2 283 38
 538 00cb 4883E801 		subq	$1, %rax
 539              		.loc 2 283 7
 540 00cf 4839C2   		cmpq	%rax, %rdx
 541 00d2 7539     		jne	.L45
 284:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         x509_memcasecmp( name->p + 1, cn + cn_idx, name->len - 1 ) == 0 )
 542              		.loc 2 284 56 discriminator 1
 543 00d4 488B45D0 		movq	-48(%rbp), %rax
 544 00d8 488B4008 		movq	8(%rax), %rax
 545              		.loc 2 284 9 discriminator 1
 546 00dc 488D50FF 		leaq	-1(%rax), %rdx
 547              		.loc 2 284 42 discriminator 1
 548 00e0 488B4DD8 		movq	-40(%rbp), %rcx
 549 00e4 488B45E8 		movq	-24(%rbp), %rax
 550 00e8 4801C1   		addq	%rax, %rcx
 551              		.loc 2 284 30 discriminator 1
 552 00eb 488B45D0 		movq	-48(%rbp), %rax
 553 00ef 488B4010 		movq	16(%rax), %rax
 554              		.loc 2 284 34 discriminator 1
 555 00f3 4883C001 		addq	$1, %rax
 556              		.loc 2 284 9 discriminator 1
 557 00f7 4889CE   		movq	%rcx, %rsi
 558 00fa 4889C7   		movq	%rax, %rdi
 559 00fd E8000000 		call	x509_memcasecmp
 559      00
 283:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         x509_memcasecmp( name->p + 1, cn + cn_idx, name->len - 1 ) == 0 )
 560              		.loc 2 283 42 discriminator 1
 561 0102 85C0     		testl	%eax, %eax
 562 0104 7507     		jne	.L45
 285:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 286:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( 0 );
 563              		.loc 2 286 15
 564 0106 B8000000 		movl	$0, %eax
 564      00
 565 010b EB05     		jmp	.L39
 566              	.L45:
 287:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 288:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 289:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( -1 );
 567              		.loc 2 289 11
 568 010d B8FFFFFF 		movl	$-1, %eax
GAS LISTING /tmp/ccnlqVtp.s 			page 20


 568      FF
 569              	.L39:
 290:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 570              		.loc 2 290 1
 571 0112 488B75F8 		movq	-8(%rbp), %rsi
 572 0116 64483334 		xorq	%fs:40, %rsi
 572      25280000 
 572      00
 573 011f 7405     		je	.L46
 574 0121 E8000000 		call	__stack_chk_fail@PLT
 574      00
 575              	.L46:
 576 0126 C9       		leave
 577              	.LCFI17:
 578              		.cfi_def_cfa 7, 8
 579 0127 C3       		ret
 580              		.cfi_endproc
 581              	.LFE20:
 583              		.section	.text.x509_string_cmp,"ax",@progbits
 585              	x509_string_cmp:
 586              	.LFB21:
 291:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 292:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
 293:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Compare two X.509 strings, case-insensitive, and allowing for some encoding
 294:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * variations (but not all).
 295:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
 296:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Return 0 if equal, -1 otherwise.
 297:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
 298:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_string_cmp( const mbedtls_x509_buf *a, const mbedtls_x509_buf *b )
 299:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 587              		.loc 2 299 1
 588              		.cfi_startproc
 589 0000 F30F1EFA 		endbr64
 590 0004 55       		pushq	%rbp
 591              	.LCFI18:
 592              		.cfi_def_cfa_offset 16
 593              		.cfi_offset 6, -16
 594 0005 4889E5   		movq	%rsp, %rbp
 595              	.LCFI19:
 596              		.cfi_def_cfa_register 6
 597 0008 4883EC20 		subq	$32, %rsp
 598 000c 48897DE8 		movq	%rdi, -24(%rbp)
 599 0010 488975E0 		movq	%rsi, -32(%rbp)
 600              		.loc 2 299 1
 601 0014 64488B04 		movq	%fs:40, %rax
 601      25280000 
 601      00
 602 001d 488945F8 		movq	%rax, -8(%rbp)
 603 0021 31C0     		xorl	%eax, %eax
 300:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( a->tag == b->tag &&
 604              		.loc 2 300 10
 605 0023 488B45E8 		movq	-24(%rbp), %rax
 606 0027 8B10     		movl	(%rax), %edx
 607              		.loc 2 300 20
 608 0029 488B45E0 		movq	-32(%rbp), %rax
 609 002d 8B00     		movl	(%rax), %eax
 610              		.loc 2 300 7
GAS LISTING /tmp/ccnlqVtp.s 			page 21


 611 002f 39C2     		cmpl	%eax, %edx
 612 0031 7543     		jne	.L48
 301:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         a->len == b->len &&
 613              		.loc 2 301 10 discriminator 1
 614 0033 488B45E8 		movq	-24(%rbp), %rax
 615 0037 488B5008 		movq	8(%rax), %rdx
 616              		.loc 2 301 20 discriminator 1
 617 003b 488B45E0 		movq	-32(%rbp), %rax
 618 003f 488B4008 		movq	8(%rax), %rax
 300:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( a->tag == b->tag &&
 619              		.loc 2 300 26 discriminator 1
 620 0043 4839C2   		cmpq	%rax, %rdx
 621 0046 752E     		jne	.L48
 302:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         memcmp( a->p, b->p, b->len ) == 0 )
 622              		.loc 2 302 9
 623 0048 488B45E0 		movq	-32(%rbp), %rax
 624 004c 488B5008 		movq	8(%rax), %rdx
 625              		.loc 2 302 24
 626 0050 488B45E0 		movq	-32(%rbp), %rax
 627 0054 488B4810 		movq	16(%rax), %rcx
 628              		.loc 2 302 18
 629 0058 488B45E8 		movq	-24(%rbp), %rax
 630 005c 488B4010 		movq	16(%rax), %rax
 631              		.loc 2 302 9
 632 0060 4889CE   		movq	%rcx, %rsi
 633 0063 4889C7   		movq	%rax, %rdi
 634 0066 E8000000 		call	memcmp@PLT
 634      00
 301:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         a->len == b->len &&
 635              		.loc 2 301 26
 636 006b 85C0     		testl	%eax, %eax
 637 006d 7507     		jne	.L48
 303:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 304:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( 0 );
 638              		.loc 2 304 15
 639 006f B8000000 		movl	$0, %eax
 639      00
 640 0074 EB74     		jmp	.L49
 641              	.L48:
 305:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 306:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 307:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( a->tag == MBEDTLS_ASN1_UTF8_STRING || a->tag == MBEDTLS_ASN1_PRINTABLE_STRING ) &&
 642              		.loc 2 307 12
 643 0076 488B45E8 		movq	-24(%rbp), %rax
 644 007a 8B00     		movl	(%rax), %eax
 645              		.loc 2 307 7
 646 007c 83F80C   		cmpl	$12, %eax
 647 007f 740B     		je	.L50
 648              		.loc 2 307 50 discriminator 2
 649 0081 488B45E8 		movq	-24(%rbp), %rax
 650 0085 8B00     		movl	(%rax), %eax
 651              		.loc 2 307 46 discriminator 2
 652 0087 83F813   		cmpl	$19, %eax
 653 008a 7559     		jne	.L51
 654              	.L50:
 308:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ( b->tag == MBEDTLS_ASN1_UTF8_STRING || b->tag == MBEDTLS_ASN1_PRINTABLE_STRING ) &&
 655              		.loc 2 308 12 discriminator 3
GAS LISTING /tmp/ccnlqVtp.s 			page 22


 656 008c 488B45E0 		movq	-32(%rbp), %rax
 657 0090 8B00     		movl	(%rax), %eax
 307:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ( b->tag == MBEDTLS_ASN1_UTF8_STRING || b->tag == MBEDTLS_ASN1_PRINTABLE_STRING ) &&
 658              		.loc 2 307 91 discriminator 3
 659 0092 83F80C   		cmpl	$12, %eax
 660 0095 740B     		je	.L52
 661              		.loc 2 308 50
 662 0097 488B45E0 		movq	-32(%rbp), %rax
 663 009b 8B00     		movl	(%rax), %eax
 664              		.loc 2 308 46
 665 009d 83F813   		cmpl	$19, %eax
 666 00a0 7543     		jne	.L51
 667              	.L52:
 309:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         a->len == b->len &&
 668              		.loc 2 309 10 discriminator 1
 669 00a2 488B45E8 		movq	-24(%rbp), %rax
 670 00a6 488B5008 		movq	8(%rax), %rdx
 671              		.loc 2 309 20 discriminator 1
 672 00aa 488B45E0 		movq	-32(%rbp), %rax
 673 00ae 488B4008 		movq	8(%rax), %rax
 308:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ( b->tag == MBEDTLS_ASN1_UTF8_STRING || b->tag == MBEDTLS_ASN1_PRINTABLE_STRING ) &&
 674              		.loc 2 308 91 discriminator 1
 675 00b2 4839C2   		cmpq	%rax, %rdx
 676 00b5 752E     		jne	.L51
 310:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         x509_memcasecmp( a->p, b->p, b->len ) == 0 )
 677              		.loc 2 310 9
 678 00b7 488B45E0 		movq	-32(%rbp), %rax
 679 00bb 488B5008 		movq	8(%rax), %rdx
 680              		.loc 2 310 33
 681 00bf 488B45E0 		movq	-32(%rbp), %rax
 682 00c3 488B4810 		movq	16(%rax), %rcx
 683              		.loc 2 310 27
 684 00c7 488B45E8 		movq	-24(%rbp), %rax
 685 00cb 488B4010 		movq	16(%rax), %rax
 686              		.loc 2 310 9
 687 00cf 4889CE   		movq	%rcx, %rsi
 688 00d2 4889C7   		movq	%rax, %rdi
 689 00d5 E8000000 		call	x509_memcasecmp
 689      00
 309:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         a->len == b->len &&
 690              		.loc 2 309 26
 691 00da 85C0     		testl	%eax, %eax
 692 00dc 7507     		jne	.L51
 311:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 312:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( 0 );
 693              		.loc 2 312 15
 694 00de B8000000 		movl	$0, %eax
 694      00
 695 00e3 EB05     		jmp	.L49
 696              	.L51:
 313:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 314:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 315:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( -1 );
 697              		.loc 2 315 11
 698 00e5 B8FFFFFF 		movl	$-1, %eax
 698      FF
 699              	.L49:
GAS LISTING /tmp/ccnlqVtp.s 			page 23


 316:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 700              		.loc 2 316 1
 701 00ea 488B75F8 		movq	-8(%rbp), %rsi
 702 00ee 64483334 		xorq	%fs:40, %rsi
 702      25280000 
 702      00
 703 00f7 7405     		je	.L53
 704 00f9 E8000000 		call	__stack_chk_fail@PLT
 704      00
 705              	.L53:
 706 00fe C9       		leave
 707              	.LCFI20:
 708              		.cfi_def_cfa 7, 8
 709 00ff C3       		ret
 710              		.cfi_endproc
 711              	.LFE21:
 713              		.section	.text.x509_name_cmp,"ax",@progbits
 715              	x509_name_cmp:
 716              	.LFB22:
 317:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 318:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
 319:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Compare two X.509 Names (aka rdnSequence).
 320:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
 321:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * See RFC 5280 section 7.1, though we don't implement the whole algorithm:
 322:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * we sometimes return unequal when the full algorithm would return equal,
 323:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * but never the other way. (In particular, we don't do Unicode normalisation
 324:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * or space folding.)
 325:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
 326:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Return 0 if equal, -1 otherwise.
 327:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
 328:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_name_cmp( const mbedtls_x509_name *a, const mbedtls_x509_name *b )
 329:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 717              		.loc 2 329 1
 718              		.cfi_startproc
 719 0000 F30F1EFA 		endbr64
 720 0004 55       		pushq	%rbp
 721              	.LCFI21:
 722              		.cfi_def_cfa_offset 16
 723              		.cfi_offset 6, -16
 724 0005 4889E5   		movq	%rsp, %rbp
 725              	.LCFI22:
 726              		.cfi_def_cfa_register 6
 727 0008 4883EC20 		subq	$32, %rsp
 728 000c 48897DE8 		movq	%rdi, -24(%rbp)
 729 0010 488975E0 		movq	%rsi, -32(%rbp)
 730              		.loc 2 329 1
 731 0014 64488B04 		movq	%fs:40, %rax
 731      25280000 
 731      00
 732 001d 488945F8 		movq	%rax, -8(%rbp)
 733 0021 31C0     		xorl	%eax, %eax
 330:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Avoid recursion, it might not be optimised by the compiler */
 331:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     while( a != NULL || b != NULL )
 734              		.loc 2 331 10
 735 0023 E9C40000 		jmp	.L55
 735      00
 736              	.L63:
GAS LISTING /tmp/ccnlqVtp.s 			page 24


 332:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 333:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( a == NULL || b == NULL )
 737              		.loc 2 333 11
 738 0028 48837DE8 		cmpq	$0, -24(%rbp)
 738      00
 739 002d 7407     		je	.L56
 740              		.loc 2 333 23 discriminator 1
 741 002f 48837DE0 		cmpq	$0, -32(%rbp)
 741      00
 742 0034 750A     		jne	.L57
 743              	.L56:
 334:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( -1 );
 744              		.loc 2 334 19
 745 0036 B8FFFFFF 		movl	$-1, %eax
 745      FF
 746 003b E9C70000 		jmp	.L58
 746      00
 747              	.L57:
 335:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 336:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* type */
 337:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( a->oid.tag != b->oid.tag ||
 748              		.loc 2 337 19
 749 0040 488B45E8 		movq	-24(%rbp), %rax
 750 0044 8B10     		movl	(%rax), %edx
 751              		.loc 2 337 33
 752 0046 488B45E0 		movq	-32(%rbp), %rax
 753 004a 8B00     		movl	(%rax), %eax
 754              		.loc 2 337 11
 755 004c 39C2     		cmpl	%eax, %edx
 756 004e 753C     		jne	.L59
 338:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             a->oid.len != b->oid.len ||
 757              		.loc 2 338 19 discriminator 1
 758 0050 488B45E8 		movq	-24(%rbp), %rax
 759 0054 488B5008 		movq	8(%rax), %rdx
 760              		.loc 2 338 33 discriminator 1
 761 0058 488B45E0 		movq	-32(%rbp), %rax
 762 005c 488B4008 		movq	8(%rax), %rax
 337:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             a->oid.len != b->oid.len ||
 763              		.loc 2 337 38 discriminator 1
 764 0060 4839C2   		cmpq	%rax, %rdx
 765 0063 7527     		jne	.L59
 339:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             memcmp( a->oid.p, b->oid.p, b->oid.len ) != 0 )
 766              		.loc 2 339 13
 767 0065 488B45E0 		movq	-32(%rbp), %rax
 768 0069 488B5008 		movq	8(%rax), %rdx
 769              		.loc 2 339 37
 770 006d 488B45E0 		movq	-32(%rbp), %rax
 771 0071 488B4810 		movq	16(%rax), %rcx
 772              		.loc 2 339 27
 773 0075 488B45E8 		movq	-24(%rbp), %rax
 774 0079 488B4010 		movq	16(%rax), %rax
 775              		.loc 2 339 13
 776 007d 4889CE   		movq	%rcx, %rsi
 777 0080 4889C7   		movq	%rax, %rdi
 778 0083 E8000000 		call	memcmp@PLT
 778      00
 338:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             a->oid.len != b->oid.len ||
GAS LISTING /tmp/ccnlqVtp.s 			page 25


 779              		.loc 2 338 38
 780 0088 85C0     		testl	%eax, %eax
 781 008a 7407     		je	.L60
 782              	.L59:
 340:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
 341:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( -1 );
 783              		.loc 2 341 19
 784 008c B8FFFFFF 		movl	$-1, %eax
 784      FF
 785 0091 EB74     		jmp	.L58
 786              	.L60:
 342:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
 343:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 344:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* value */
 345:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( x509_string_cmp( &a->val, &b->val ) != 0 )
 787              		.loc 2 345 39
 788 0093 488B45E0 		movq	-32(%rbp), %rax
 789 0097 488D5018 		leaq	24(%rax), %rdx
 790              		.loc 2 345 30
 791 009b 488B45E8 		movq	-24(%rbp), %rax
 792 009f 4883C018 		addq	$24, %rax
 793              		.loc 2 345 13
 794 00a3 4889D6   		movq	%rdx, %rsi
 795 00a6 4889C7   		movq	%rax, %rdi
 796 00a9 E8000000 		call	x509_string_cmp
 796      00
 797              		.loc 2 345 11
 798 00ae 85C0     		testl	%eax, %eax
 799 00b0 7407     		je	.L61
 346:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( -1 );
 800              		.loc 2 346 19
 801 00b2 B8FFFFFF 		movl	$-1, %eax
 801      FF
 802 00b7 EB4E     		jmp	.L58
 803              	.L61:
 347:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 348:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* structure of the list of sets */
 349:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( a->next_merged != b->next_merged )
 804              		.loc 2 349 14
 805 00b9 488B45E8 		movq	-24(%rbp), %rax
 806 00bd 0FB65038 		movzbl	56(%rax), %edx
 807              		.loc 2 349 32
 808 00c1 488B45E0 		movq	-32(%rbp), %rax
 809 00c5 0FB64038 		movzbl	56(%rax), %eax
 810              		.loc 2 349 11
 811 00c9 38C2     		cmpb	%al, %dl
 812 00cb 7407     		je	.L62
 350:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( -1 );
 813              		.loc 2 350 19
 814 00cd B8FFFFFF 		movl	$-1, %eax
 814      FF
 815 00d2 EB33     		jmp	.L58
 816              	.L62:
 351:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 352:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         a = a->next;
 817              		.loc 2 352 11
 818 00d4 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/ccnlqVtp.s 			page 26


 819 00d8 488B4030 		movq	48(%rax), %rax
 820 00dc 488945E8 		movq	%rax, -24(%rbp)
 353:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         b = b->next;
 821              		.loc 2 353 11
 822 00e0 488B45E0 		movq	-32(%rbp), %rax
 823 00e4 488B4030 		movq	48(%rax), %rax
 824 00e8 488945E0 		movq	%rax, -32(%rbp)
 825              	.L55:
 331:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 826              		.loc 2 331 10
 827 00ec 48837DE8 		cmpq	$0, -24(%rbp)
 827      00
 828 00f1 0F8531FF 		jne	.L63
 828      FFFF
 331:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 829              		.loc 2 331 22 discriminator 1
 830 00f7 48837DE0 		cmpq	$0, -32(%rbp)
 830      00
 831 00fc 0F8526FF 		jne	.L63
 831      FFFF
 354:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 355:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 356:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* a == NULL == b */
 357:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 832              		.loc 2 357 11
 833 0102 B8000000 		movl	$0, %eax
 833      00
 834              	.L58:
 358:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 835              		.loc 2 358 1
 836 0107 488B4DF8 		movq	-8(%rbp), %rcx
 837 010b 6448330C 		xorq	%fs:40, %rcx
 837      25280000 
 837      00
 838 0114 7405     		je	.L64
 839 0116 E8000000 		call	__stack_chk_fail@PLT
 839      00
 840              	.L64:
 841 011b C9       		leave
 842              	.LCFI23:
 843              		.cfi_def_cfa 7, 8
 844 011c C3       		ret
 845              		.cfi_endproc
 846              	.LFE22:
 848              		.section	.text.x509_crt_verify_chain_reset,"ax",@progbits
 850              	x509_crt_verify_chain_reset:
 851              	.LFB23:
 359:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 360:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
 361:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Reset (init or clear) a verify_chain
 362:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
 363:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static void x509_crt_verify_chain_reset(
 364:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_x509_crt_verify_chain *ver_chain )
 365:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 852              		.loc 2 365 1
 853              		.cfi_startproc
 854 0000 F30F1EFA 		endbr64
GAS LISTING /tmp/ccnlqVtp.s 			page 27


 855 0004 55       		pushq	%rbp
 856              	.LCFI24:
 857              		.cfi_def_cfa_offset 16
 858              		.cfi_offset 6, -16
 859 0005 4889E5   		movq	%rsp, %rbp
 860              	.LCFI25:
 861              		.cfi_def_cfa_register 6
 862 0008 4883EC20 		subq	$32, %rsp
 863 000c 48897DE8 		movq	%rdi, -24(%rbp)
 864              		.loc 2 365 1
 865 0010 64488B04 		movq	%fs:40, %rax
 865      25280000 
 865      00
 866 0019 488945F8 		movq	%rax, -8(%rbp)
 867 001d 31C0     		xorl	%eax, %eax
 366:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     size_t i;
 367:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 368:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     for( i = 0; i < MBEDTLS_X509_MAX_VERIFY_CHAIN_SIZE; i++ )
 868              		.loc 2 368 12
 869 001f 48C745F0 		movq	$0, -16(%rbp)
 869      00000000 
 870              		.loc 2 368 5
 871 0027 EB34     		jmp	.L66
 872              	.L67:
 369:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 370:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ver_chain->items[i].crt = NULL;
 873              		.loc 2 370 33 discriminator 3
 874 0029 488B45E8 		movq	-24(%rbp), %rax
 875 002d 488B55F0 		movq	-16(%rbp), %rdx
 876 0031 48C1E204 		salq	$4, %rdx
 877 0035 4801D0   		addq	%rdx, %rax
 878 0038 48C70000 		movq	$0, (%rax)
 878      000000
 371:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ver_chain->items[i].flags = (uint32_t) -1;
 879              		.loc 2 371 35 discriminator 3
 880 003f 488B45E8 		movq	-24(%rbp), %rax
 881 0043 488B55F0 		movq	-16(%rbp), %rdx
 882 0047 48C1E204 		salq	$4, %rdx
 883 004b 4801D0   		addq	%rdx, %rax
 884 004e 4883C008 		addq	$8, %rax
 885 0052 C700FFFF 		movl	$-1, (%rax)
 885      FFFF
 368:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 886              		.loc 2 368 58 discriminator 3
 887 0058 488345F0 		addq	$1, -16(%rbp)
 887      01
 888              	.L66:
 368:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 889              		.loc 2 368 5 discriminator 1
 890 005d 48837DF0 		cmpq	$9, -16(%rbp)
 890      09
 891 0062 76C5     		jbe	.L67
 372:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 373:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 374:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     ver_chain->len = 0;
 892              		.loc 2 374 20
 893 0064 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/ccnlqVtp.s 			page 28


 894 0068 C780A000 		movl	$0, 160(%rax)
 894      00000000 
 894      0000
 375:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 895              		.loc 2 375 1
 896 0072 90       		nop
 897 0073 488B45F8 		movq	-8(%rbp), %rax
 898 0077 64483304 		xorq	%fs:40, %rax
 898      25280000 
 898      00
 899 0080 7405     		je	.L68
 900 0082 E8000000 		call	__stack_chk_fail@PLT
 900      00
 901              	.L68:
 902 0087 C9       		leave
 903              	.LCFI26:
 904              		.cfi_def_cfa 7, 8
 905 0088 C3       		ret
 906              		.cfi_endproc
 907              	.LFE23:
 909              		.section	.text.x509_get_version,"ax",@progbits
 911              	x509_get_version:
 912              	.LFB24:
 376:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 377:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
 378:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  Version  ::=  INTEGER  {  v1(0), v2(1), v3(2)  }
 379:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
 380:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_get_version( unsigned char **p,
 381:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                              const unsigned char *end,
 382:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                              int *ver )
 383:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 913              		.loc 2 383 1
 914              		.cfi_startproc
 915 0000 F30F1EFA 		endbr64
 916 0004 55       		pushq	%rbp
 917              	.LCFI27:
 918              		.cfi_def_cfa_offset 16
 919              		.cfi_offset 6, -16
 920 0005 4889E5   		movq	%rsp, %rbp
 921              	.LCFI28:
 922              		.cfi_def_cfa_register 6
 923 0008 4883EC40 		subq	$64, %rsp
 924 000c 48897DD8 		movq	%rdi, -40(%rbp)
 925 0010 488975D0 		movq	%rsi, -48(%rbp)
 926 0014 488955C8 		movq	%rdx, -56(%rbp)
 927              		.loc 2 383 1
 928 0018 64488B04 		movq	%fs:40, %rax
 928      25280000 
 928      00
 929 0021 488945F8 		movq	%rax, -8(%rbp)
 930 0025 31C0     		xorl	%eax, %eax
 384:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int ret;
 385:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     size_t len;
 386:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 387:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_asn1_get_tag( p, end, &len,
 931              		.loc 2 387 17
 932 0027 488D55F0 		leaq	-16(%rbp), %rdx
GAS LISTING /tmp/ccnlqVtp.s 			page 29


 933 002b 488B75D0 		movq	-48(%rbp), %rsi
 934 002f 488B45D8 		movq	-40(%rbp), %rax
 935 0033 B9A00000 		movl	$160, %ecx
 935      00
 936 0038 4889C7   		movq	%rax, %rdi
 937 003b E8000000 		call	mbedtls_asn1_get_tag@PLT
 937      00
 938 0040 8945EC   		movl	%eax, -20(%rbp)
 939              		.loc 2 387 7
 940 0043 837DEC00 		cmpl	$0, -20(%rbp)
 941 0047 7421     		je	.L70
 388:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             MBEDTLS_ASN1_CONTEXT_SPECIFIC | MBEDTLS_ASN1_CONSTRUCTED | 0 ) ) != 0 )
 389:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 390:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ret == MBEDTLS_ERR_ASN1_UNEXPECTED_TAG )
 942              		.loc 2 390 11
 943 0049 837DEC9E 		cmpl	$-98, -20(%rbp)
 944 004d 7511     		jne	.L71
 391:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
 392:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             *ver = 0;
 945              		.loc 2 392 18
 946 004f 488B45C8 		movq	-56(%rbp), %rax
 947 0053 C7000000 		movl	$0, (%rax)
 947      0000
 393:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( 0 );
 948              		.loc 2 393 19
 949 0059 B8000000 		movl	$0, %eax
 949      00
 950 005e EB5F     		jmp	.L75
 951              	.L71:
 394:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
 395:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 396:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_FORMAT + ret );
 952              		.loc 2 396 49
 953 0060 8B45EC   		movl	-20(%rbp), %eax
 954 0063 2D802100 		subl	$8576, %eax
 954      00
 955 0068 EB55     		jmp	.L75
 956              	.L70:
 397:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 398:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 399:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     end = *p + len;
 957              		.loc 2 399 11
 958 006a 488B45D8 		movq	-40(%rbp), %rax
 959 006e 488B10   		movq	(%rax), %rdx
 960              		.loc 2 399 14
 961 0071 488B45F0 		movq	-16(%rbp), %rax
 962              		.loc 2 399 9
 963 0075 4801D0   		addq	%rdx, %rax
 964 0078 488945D0 		movq	%rax, -48(%rbp)
 400:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 401:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_asn1_get_int( p, end, ver ) ) != 0 )
 965              		.loc 2 401 17
 966 007c 488B55C8 		movq	-56(%rbp), %rdx
 967 0080 488B4DD0 		movq	-48(%rbp), %rcx
 968 0084 488B45D8 		movq	-40(%rbp), %rax
 969 0088 4889CE   		movq	%rcx, %rsi
 970 008b 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/ccnlqVtp.s 			page 30


 971 008e E8000000 		call	mbedtls_asn1_get_int@PLT
 971      00
 972 0093 8945EC   		movl	%eax, -20(%rbp)
 973              		.loc 2 401 7
 974 0096 837DEC00 		cmpl	$0, -20(%rbp)
 975 009a 740A     		je	.L73
 402:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_VERSION + ret );
 976              		.loc 2 402 50
 977 009c 8B45EC   		movl	-20(%rbp), %eax
 978 009f 2D002200 		subl	$8704, %eax
 978      00
 979 00a4 EB19     		jmp	.L75
 980              	.L73:
 403:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 404:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( *p != end )
 981              		.loc 2 404 9
 982 00a6 488B45D8 		movq	-40(%rbp), %rax
 983 00aa 488B00   		movq	(%rax), %rax
 984              		.loc 2 404 7
 985 00ad 483945D0 		cmpq	%rax, -48(%rbp)
 986 00b1 7407     		je	.L74
 405:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_VERSION +
 987              		.loc 2 405 15
 988 00b3 B89ADDFF 		movl	$-8806, %eax
 988      FF
 989 00b8 EB05     		jmp	.L75
 990              	.L74:
 406:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 MBEDTLS_ERR_ASN1_LENGTH_MISMATCH );
 407:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 408:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 991              		.loc 2 408 11
 992 00ba B8000000 		movl	$0, %eax
 992      00
 993              	.L75:
 409:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 994              		.loc 2 409 1 discriminator 1
 995 00bf 488B4DF8 		movq	-8(%rbp), %rcx
 996 00c3 6448330C 		xorq	%fs:40, %rcx
 996      25280000 
 996      00
 997 00cc 7405     		je	.L76
 998              		.loc 2 409 1 is_stmt 0
 999 00ce E8000000 		call	__stack_chk_fail@PLT
 999      00
 1000              	.L76:
 1001 00d3 C9       		leave
 1002              	.LCFI29:
 1003              		.cfi_def_cfa 7, 8
 1004 00d4 C3       		ret
 1005              		.cfi_endproc
 1006              	.LFE24:
 1008              		.section	.text.x509_get_dates,"ax",@progbits
 1010              	x509_get_dates:
 1011              	.LFB25:
 410:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 411:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
 412:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  Validity ::= SEQUENCE {
GAS LISTING /tmp/ccnlqVtp.s 			page 31


 413:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *       notBefore      Time,
 414:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *       notAfter       Time }
 415:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
 416:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_get_dates( unsigned char **p,
 417:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                            const unsigned char *end,
 418:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                            mbedtls_x509_time *from,
 419:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                            mbedtls_x509_time *to )
 420:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 1012              		.loc 2 420 1 is_stmt 1
 1013              		.cfi_startproc
 1014 0000 F30F1EFA 		endbr64
 1015 0004 55       		pushq	%rbp
 1016              	.LCFI30:
 1017              		.cfi_def_cfa_offset 16
 1018              		.cfi_offset 6, -16
 1019 0005 4889E5   		movq	%rsp, %rbp
 1020              	.LCFI31:
 1021              		.cfi_def_cfa_register 6
 1022 0008 4883EC40 		subq	$64, %rsp
 1023 000c 48897DD8 		movq	%rdi, -40(%rbp)
 1024 0010 488975D0 		movq	%rsi, -48(%rbp)
 1025 0014 488955C8 		movq	%rdx, -56(%rbp)
 1026 0018 48894DC0 		movq	%rcx, -64(%rbp)
 1027              		.loc 2 420 1
 1028 001c 64488B04 		movq	%fs:40, %rax
 1028      25280000 
 1028      00
 1029 0025 488945F8 		movq	%rax, -8(%rbp)
 1030 0029 31C0     		xorl	%eax, %eax
 421:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int ret;
 422:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     size_t len;
 423:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 424:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_asn1_get_tag( p, end, &len,
 1031              		.loc 2 424 17
 1032 002b 488D55F0 		leaq	-16(%rbp), %rdx
 1033 002f 488B75D0 		movq	-48(%rbp), %rsi
 1034 0033 488B45D8 		movq	-40(%rbp), %rax
 1035 0037 B9300000 		movl	$48, %ecx
 1035      00
 1036 003c 4889C7   		movq	%rax, %rdi
 1037 003f E8000000 		call	mbedtls_asn1_get_tag@PLT
 1037      00
 1038 0044 8945EC   		movl	%eax, -20(%rbp)
 1039              		.loc 2 424 7
 1040 0047 837DEC00 		cmpl	$0, -20(%rbp)
 1041 004b 740A     		je	.L78
 425:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             MBEDTLS_ASN1_CONSTRUCTED | MBEDTLS_ASN1_SEQUENCE ) ) != 0 )
 426:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_DATE + ret );
 1042              		.loc 2 426 47
 1043 004d 8B45EC   		movl	-20(%rbp), %eax
 1044 0050 2D002400 		subl	$9216, %eax
 1044      00
 1045 0055 EB75     		jmp	.L83
 1046              	.L78:
 427:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 428:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     end = *p + len;
 1047              		.loc 2 428 11
GAS LISTING /tmp/ccnlqVtp.s 			page 32


 1048 0057 488B45D8 		movq	-40(%rbp), %rax
 1049 005b 488B10   		movq	(%rax), %rdx
 1050              		.loc 2 428 14
 1051 005e 488B45F0 		movq	-16(%rbp), %rax
 1052              		.loc 2 428 9
 1053 0062 4801D0   		addq	%rdx, %rax
 1054 0065 488945D0 		movq	%rax, -48(%rbp)
 429:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 430:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_x509_get_time( p, end, from ) ) != 0 )
 1055              		.loc 2 430 17
 1056 0069 488B55C8 		movq	-56(%rbp), %rdx
 1057 006d 488B4DD0 		movq	-48(%rbp), %rcx
 1058 0071 488B45D8 		movq	-40(%rbp), %rax
 1059 0075 4889CE   		movq	%rcx, %rsi
 1060 0078 4889C7   		movq	%rax, %rdi
 1061 007b E8000000 		call	mbedtls_x509_get_time@PLT
 1061      00
 1062 0080 8945EC   		movl	%eax, -20(%rbp)
 1063              		.loc 2 430 7
 1064 0083 837DEC00 		cmpl	$0, -20(%rbp)
 1065 0087 7405     		je	.L80
 431:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( ret );
 1066              		.loc 2 431 15
 1067 0089 8B45EC   		movl	-20(%rbp), %eax
 1068 008c EB3E     		jmp	.L83
 1069              	.L80:
 432:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 433:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_x509_get_time( p, end, to ) ) != 0 )
 1070              		.loc 2 433 17
 1071 008e 488B55C0 		movq	-64(%rbp), %rdx
 1072 0092 488B4DD0 		movq	-48(%rbp), %rcx
 1073 0096 488B45D8 		movq	-40(%rbp), %rax
 1074 009a 4889CE   		movq	%rcx, %rsi
 1075 009d 4889C7   		movq	%rax, %rdi
 1076 00a0 E8000000 		call	mbedtls_x509_get_time@PLT
 1076      00
 1077 00a5 8945EC   		movl	%eax, -20(%rbp)
 1078              		.loc 2 433 7
 1079 00a8 837DEC00 		cmpl	$0, -20(%rbp)
 1080 00ac 7405     		je	.L81
 434:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( ret );
 1081              		.loc 2 434 15
 1082 00ae 8B45EC   		movl	-20(%rbp), %eax
 1083 00b1 EB19     		jmp	.L83
 1084              	.L81:
 435:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 436:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( *p != end )
 1085              		.loc 2 436 9
 1086 00b3 488B45D8 		movq	-40(%rbp), %rax
 1087 00b7 488B00   		movq	(%rax), %rax
 1088              		.loc 2 436 7
 1089 00ba 483945D0 		cmpq	%rax, -48(%rbp)
 1090 00be 7407     		je	.L82
 437:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_DATE +
 1091              		.loc 2 437 15
 1092 00c0 B89ADBFF 		movl	$-9318, %eax
 1092      FF
GAS LISTING /tmp/ccnlqVtp.s 			page 33


 1093 00c5 EB05     		jmp	.L83
 1094              	.L82:
 438:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 MBEDTLS_ERR_ASN1_LENGTH_MISMATCH );
 439:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 440:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 1095              		.loc 2 440 11
 1096 00c7 B8000000 		movl	$0, %eax
 1096      00
 1097              	.L83:
 441:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 1098              		.loc 2 441 1 discriminator 1
 1099 00cc 488B7DF8 		movq	-8(%rbp), %rdi
 1100 00d0 6448333C 		xorq	%fs:40, %rdi
 1100      25280000 
 1100      00
 1101 00d9 7405     		je	.L84
 1102              		.loc 2 441 1 is_stmt 0
 1103 00db E8000000 		call	__stack_chk_fail@PLT
 1103      00
 1104              	.L84:
 1105 00e0 C9       		leave
 1106              	.LCFI32:
 1107              		.cfi_def_cfa 7, 8
 1108 00e1 C3       		ret
 1109              		.cfi_endproc
 1110              	.LFE25:
 1112              		.section	.text.x509_get_uid,"ax",@progbits
 1114              	x509_get_uid:
 1115              	.LFB26:
 442:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 443:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
 444:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * X.509 v2/v3 unique identifier (not parsed)
 445:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
 446:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_get_uid( unsigned char **p,
 447:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                          const unsigned char *end,
 448:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                          mbedtls_x509_buf *uid, int n )
 449:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 1116              		.loc 2 449 1 is_stmt 1
 1117              		.cfi_startproc
 1118 0000 F30F1EFA 		endbr64
 1119 0004 55       		pushq	%rbp
 1120              	.LCFI33:
 1121              		.cfi_def_cfa_offset 16
 1122              		.cfi_offset 6, -16
 1123 0005 4889E5   		movq	%rsp, %rbp
 1124              	.LCFI34:
 1125              		.cfi_def_cfa_register 6
 1126 0008 4883EC30 		subq	$48, %rsp
 1127 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1128 0010 488975E0 		movq	%rsi, -32(%rbp)
 1129 0014 488955D8 		movq	%rdx, -40(%rbp)
 1130 0018 894DD4   		movl	%ecx, -44(%rbp)
 1131              		.loc 2 449 1
 1132 001b 64488B04 		movq	%fs:40, %rax
 1132      25280000 
 1132      00
 1133 0024 488945F8 		movq	%rax, -8(%rbp)
GAS LISTING /tmp/ccnlqVtp.s 			page 34


 1134 0028 31C0     		xorl	%eax, %eax
 450:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int ret;
 451:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 452:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( *p == end )
 1135              		.loc 2 452 9
 1136 002a 488B45E8 		movq	-24(%rbp), %rax
 1137 002e 488B00   		movq	(%rax), %rax
 1138              		.loc 2 452 7
 1139 0031 483945E0 		cmpq	%rax, -32(%rbp)
 1140 0035 7507     		jne	.L86
 453:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( 0 );
 1141              		.loc 2 453 15
 1142 0037 B8000000 		movl	$0, %eax
 1142      00
 1143 003c EB7F     		jmp	.L87
 1144              	.L86:
 454:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 455:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     uid->tag = **p;
 1145              		.loc 2 455 17
 1146 003e 488B45E8 		movq	-24(%rbp), %rax
 1147 0042 488B00   		movq	(%rax), %rax
 1148              		.loc 2 455 16
 1149 0045 0FB600   		movzbl	(%rax), %eax
 1150 0048 0FB6D0   		movzbl	%al, %edx
 1151              		.loc 2 455 14
 1152 004b 488B45D8 		movq	-40(%rbp), %rax
 1153 004f 8910     		movl	%edx, (%rax)
 456:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 457:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_asn1_get_tag( p, end, &uid->len,
 1154              		.loc 2 457 17
 1155 0051 8B45D4   		movl	-44(%rbp), %eax
 1156 0054 0CA0     		orb	$-96, %al
 1157 0056 89C1     		movl	%eax, %ecx
 1158 0058 488B45D8 		movq	-40(%rbp), %rax
 1159 005c 488D5008 		leaq	8(%rax), %rdx
 1160 0060 488B75E0 		movq	-32(%rbp), %rsi
 1161 0064 488B45E8 		movq	-24(%rbp), %rax
 1162 0068 4889C7   		movq	%rax, %rdi
 1163 006b E8000000 		call	mbedtls_asn1_get_tag@PLT
 1163      00
 1164 0070 8945F4   		movl	%eax, -12(%rbp)
 1165              		.loc 2 457 7
 1166 0073 837DF400 		cmpl	$0, -12(%rbp)
 1167 0077 7417     		je	.L88
 458:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             MBEDTLS_ASN1_CONTEXT_SPECIFIC | MBEDTLS_ASN1_CONSTRUCTED | n ) ) != 0 )
 459:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 460:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ret == MBEDTLS_ERR_ASN1_UNEXPECTED_TAG )
 1168              		.loc 2 460 11
 1169 0079 837DF49E 		cmpl	$-98, -12(%rbp)
 1170 007d 7507     		jne	.L89
 461:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( 0 );
 1171              		.loc 2 461 19
 1172 007f B8000000 		movl	$0, %eax
 1172      00
 1173 0084 EB37     		jmp	.L87
 1174              	.L89:
 462:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
GAS LISTING /tmp/ccnlqVtp.s 			page 35


 463:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_FORMAT + ret );
 1175              		.loc 2 463 49
 1176 0086 8B45F4   		movl	-12(%rbp), %eax
 1177 0089 2D802100 		subl	$8576, %eax
 1177      00
 1178 008e EB2D     		jmp	.L87
 1179              	.L88:
 464:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 465:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 466:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     uid->p = *p;
 1180              		.loc 2 466 14
 1181 0090 488B45E8 		movq	-24(%rbp), %rax
 1182 0094 488B10   		movq	(%rax), %rdx
 1183              		.loc 2 466 12
 1184 0097 488B45D8 		movq	-40(%rbp), %rax
 1185 009b 48895010 		movq	%rdx, 16(%rax)
 467:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     *p += uid->len;
 1186              		.loc 2 467 8
 1187 009f 488B45E8 		movq	-24(%rbp), %rax
 1188 00a3 488B10   		movq	(%rax), %rdx
 1189              		.loc 2 467 14
 1190 00a6 488B45D8 		movq	-40(%rbp), %rax
 1191 00aa 488B4008 		movq	8(%rax), %rax
 1192              		.loc 2 467 8
 1193 00ae 4801C2   		addq	%rax, %rdx
 1194 00b1 488B45E8 		movq	-24(%rbp), %rax
 1195 00b5 488910   		movq	%rdx, (%rax)
 468:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 469:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 1196              		.loc 2 469 11
 1197 00b8 B8000000 		movl	$0, %eax
 1197      00
 1198              	.L87:
 470:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 1199              		.loc 2 470 1
 1200 00bd 488B7DF8 		movq	-8(%rbp), %rdi
 1201 00c1 6448333C 		xorq	%fs:40, %rdi
 1201      25280000 
 1201      00
 1202 00ca 7405     		je	.L90
 1203 00cc E8000000 		call	__stack_chk_fail@PLT
 1203      00
 1204              	.L90:
 1205 00d1 C9       		leave
 1206              	.LCFI35:
 1207              		.cfi_def_cfa 7, 8
 1208 00d2 C3       		ret
 1209              		.cfi_endproc
 1210              	.LFE26:
 1212              		.section	.text.x509_get_basic_constraints,"ax",@progbits
 1214              	x509_get_basic_constraints:
 1215              	.LFB27:
 471:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 472:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_get_basic_constraints( unsigned char **p,
 473:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                        const unsigned char *end,
 474:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                        int *ca_istrue,
 475:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                        int *max_pathlen )
GAS LISTING /tmp/ccnlqVtp.s 			page 36


 476:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 1216              		.loc 2 476 1
 1217              		.cfi_startproc
 1218 0000 F30F1EFA 		endbr64
 1219 0004 55       		pushq	%rbp
 1220              	.LCFI36:
 1221              		.cfi_def_cfa_offset 16
 1222              		.cfi_offset 6, -16
 1223 0005 4889E5   		movq	%rsp, %rbp
 1224              	.LCFI37:
 1225              		.cfi_def_cfa_register 6
 1226 0008 4883EC40 		subq	$64, %rsp
 1227 000c 48897DD8 		movq	%rdi, -40(%rbp)
 1228 0010 488975D0 		movq	%rsi, -48(%rbp)
 1229 0014 488955C8 		movq	%rdx, -56(%rbp)
 1230 0018 48894DC0 		movq	%rcx, -64(%rbp)
 1231              		.loc 2 476 1
 1232 001c 64488B04 		movq	%fs:40, %rax
 1232      25280000 
 1232      00
 1233 0025 488945F8 		movq	%rax, -8(%rbp)
 1234 0029 31C0     		xorl	%eax, %eax
 477:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int ret;
 478:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     size_t len;
 479:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 480:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /*
 481:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      * BasicConstraints ::= SEQUENCE {
 482:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      *      cA                      BOOLEAN DEFAULT FALSE,
 483:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      *      pathLenConstraint       INTEGER (0..MAX) OPTIONAL }
 484:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      */
 485:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     *ca_istrue = 0; /* DEFAULT FALSE */
 1235              		.loc 2 485 16
 1236 002b 488B45C8 		movq	-56(%rbp), %rax
 1237 002f C7000000 		movl	$0, (%rax)
 1237      0000
 486:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     *max_pathlen = 0; /* endless */
 1238              		.loc 2 486 18
 1239 0035 488B45C0 		movq	-64(%rbp), %rax
 1240 0039 C7000000 		movl	$0, (%rax)
 1240      0000
 487:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 488:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_asn1_get_tag( p, end, &len,
 1241              		.loc 2 488 17
 1242 003f 488D55F0 		leaq	-16(%rbp), %rdx
 1243 0043 488B75D0 		movq	-48(%rbp), %rsi
 1244 0047 488B45D8 		movq	-40(%rbp), %rax
 1245 004b B9300000 		movl	$48, %ecx
 1245      00
 1246 0050 4889C7   		movq	%rax, %rdi
 1247 0053 E8000000 		call	mbedtls_asn1_get_tag@PLT
 1247      00
 1248 0058 8945EC   		movl	%eax, -20(%rbp)
 1249              		.loc 2 488 7
 1250 005b 837DEC00 		cmpl	$0, -20(%rbp)
 1251 005f 740D     		je	.L92
 489:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             MBEDTLS_ASN1_CONSTRUCTED | MBEDTLS_ASN1_SEQUENCE ) ) != 0 )
 490:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS + ret );
GAS LISTING /tmp/ccnlqVtp.s 			page 37


 1252              		.loc 2 490 53
 1253 0061 8B45EC   		movl	-20(%rbp), %eax
 1254 0064 2D002500 		subl	$9472, %eax
 1254      00
 1255 0069 E9E10000 		jmp	.L101
 1255      00
 1256              	.L92:
 491:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 492:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( *p == end )
 1257              		.loc 2 492 9
 1258 006e 488B45D8 		movq	-40(%rbp), %rax
 1259 0072 488B00   		movq	(%rax), %rax
 1260              		.loc 2 492 7
 1261 0075 483945D0 		cmpq	%rax, -48(%rbp)
 1262 0079 750A     		jne	.L94
 493:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( 0 );
 1263              		.loc 2 493 15
 1264 007b B8000000 		movl	$0, %eax
 1264      00
 1265 0080 E9CA0000 		jmp	.L101
 1265      00
 1266              	.L94:
 494:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 495:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_asn1_get_bool( p, end, ca_istrue ) ) != 0 )
 1267              		.loc 2 495 17
 1268 0085 488B55C8 		movq	-56(%rbp), %rdx
 1269 0089 488B4DD0 		movq	-48(%rbp), %rcx
 1270 008d 488B45D8 		movq	-40(%rbp), %rax
 1271 0091 4889CE   		movq	%rcx, %rsi
 1272 0094 4889C7   		movq	%rax, %rdi
 1273 0097 E8000000 		call	mbedtls_asn1_get_bool@PLT
 1273      00
 1274 009c 8945EC   		movl	%eax, -20(%rbp)
 1275              		.loc 2 495 7
 1276 009f 837DEC00 		cmpl	$0, -20(%rbp)
 1277 00a3 7444     		je	.L95
 496:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 497:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ret == MBEDTLS_ERR_ASN1_UNEXPECTED_TAG )
 1278              		.loc 2 497 11
 1279 00a5 837DEC9E 		cmpl	$-98, -20(%rbp)
 1280 00a9 751A     		jne	.L96
 498:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             ret = mbedtls_asn1_get_int( p, end, ca_istrue );
 1281              		.loc 2 498 19
 1282 00ab 488B55C8 		movq	-56(%rbp), %rdx
 1283 00af 488B4DD0 		movq	-48(%rbp), %rcx
 1284 00b3 488B45D8 		movq	-40(%rbp), %rax
 1285 00b7 4889CE   		movq	%rcx, %rsi
 1286 00ba 4889C7   		movq	%rax, %rdi
 1287 00bd E8000000 		call	mbedtls_asn1_get_int@PLT
 1287      00
 1288 00c2 8945EC   		movl	%eax, -20(%rbp)
 1289              	.L96:
 499:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 500:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ret != 0 )
 1290              		.loc 2 500 11
 1291 00c5 837DEC00 		cmpl	$0, -20(%rbp)
 1292 00c9 740A     		je	.L97
GAS LISTING /tmp/ccnlqVtp.s 			page 38


 501:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS + ret );
 1293              		.loc 2 501 57
 1294 00cb 8B45EC   		movl	-20(%rbp), %eax
 1295 00ce 2D002500 		subl	$9472, %eax
 1295      00
 1296 00d3 EB7A     		jmp	.L101
 1297              	.L97:
 502:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 503:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( *ca_istrue != 0 )
 1298              		.loc 2 503 13
 1299 00d5 488B45C8 		movq	-56(%rbp), %rax
 1300 00d9 8B00     		movl	(%rax), %eax
 1301              		.loc 2 503 11
 1302 00db 85C0     		testl	%eax, %eax
 1303 00dd 740A     		je	.L95
 504:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             *ca_istrue = 1;
 1304              		.loc 2 504 24
 1305 00df 488B45C8 		movq	-56(%rbp), %rax
 1306 00e3 C7000100 		movl	$1, (%rax)
 1306      0000
 1307              	.L95:
 505:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 506:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 507:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( *p == end )
 1308              		.loc 2 507 9
 1309 00e9 488B45D8 		movq	-40(%rbp), %rax
 1310 00ed 488B00   		movq	(%rax), %rax
 1311              		.loc 2 507 7
 1312 00f0 483945D0 		cmpq	%rax, -48(%rbp)
 1313 00f4 7507     		jne	.L98
 508:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( 0 );
 1314              		.loc 2 508 15
 1315 00f6 B8000000 		movl	$0, %eax
 1315      00
 1316 00fb EB52     		jmp	.L101
 1317              	.L98:
 509:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 510:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_asn1_get_int( p, end, max_pathlen ) ) != 0 )
 1318              		.loc 2 510 17
 1319 00fd 488B55C0 		movq	-64(%rbp), %rdx
 1320 0101 488B4DD0 		movq	-48(%rbp), %rcx
 1321 0105 488B45D8 		movq	-40(%rbp), %rax
 1322 0109 4889CE   		movq	%rcx, %rsi
 1323 010c 4889C7   		movq	%rax, %rdi
 1324 010f E8000000 		call	mbedtls_asn1_get_int@PLT
 1324      00
 1325 0114 8945EC   		movl	%eax, -20(%rbp)
 1326              		.loc 2 510 7
 1327 0117 837DEC00 		cmpl	$0, -20(%rbp)
 1328 011b 740A     		je	.L99
 511:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS + ret );
 1329              		.loc 2 511 53
 1330 011d 8B45EC   		movl	-20(%rbp), %eax
 1331 0120 2D002500 		subl	$9472, %eax
 1331      00
 1332 0125 EB28     		jmp	.L101
 1333              	.L99:
GAS LISTING /tmp/ccnlqVtp.s 			page 39


 512:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 513:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( *p != end )
 1334              		.loc 2 513 9
 1335 0127 488B45D8 		movq	-40(%rbp), %rax
 1336 012b 488B00   		movq	(%rax), %rax
 1337              		.loc 2 513 7
 1338 012e 483945D0 		cmpq	%rax, -48(%rbp)
 1339 0132 7407     		je	.L100
 514:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS +
 1340              		.loc 2 514 15
 1341 0134 B89ADAFF 		movl	$-9574, %eax
 1341      FF
 1342 0139 EB14     		jmp	.L101
 1343              	.L100:
 515:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 MBEDTLS_ERR_ASN1_LENGTH_MISMATCH );
 516:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 517:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     (*max_pathlen)++;
 1344              		.loc 2 517 6
 1345 013b 488B45C0 		movq	-64(%rbp), %rax
 1346 013f 8B00     		movl	(%rax), %eax
 1347              		.loc 2 517 19
 1348 0141 8D5001   		leal	1(%rax), %edx
 1349 0144 488B45C0 		movq	-64(%rbp), %rax
 1350 0148 8910     		movl	%edx, (%rax)
 518:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 519:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 1351              		.loc 2 519 11
 1352 014a B8000000 		movl	$0, %eax
 1352      00
 1353              	.L101:
 520:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 1354              		.loc 2 520 1 discriminator 1
 1355 014f 488B7DF8 		movq	-8(%rbp), %rdi
 1356 0153 6448333C 		xorq	%fs:40, %rdi
 1356      25280000 
 1356      00
 1357 015c 7405     		je	.L102
 1358              		.loc 2 520 1 is_stmt 0
 1359 015e E8000000 		call	__stack_chk_fail@PLT
 1359      00
 1360              	.L102:
 1361 0163 C9       		leave
 1362              	.LCFI38:
 1363              		.cfi_def_cfa 7, 8
 1364 0164 C3       		ret
 1365              		.cfi_endproc
 1366              	.LFE27:
 1368              		.section	.text.x509_get_ns_cert_type,"ax",@progbits
 1370              	x509_get_ns_cert_type:
 1371              	.LFB28:
 521:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 522:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_get_ns_cert_type( unsigned char **p,
 523:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                        const unsigned char *end,
 524:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                        unsigned char *ns_cert_type)
 525:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 1372              		.loc 2 525 1 is_stmt 1
 1373              		.cfi_startproc
GAS LISTING /tmp/ccnlqVtp.s 			page 40


 1374 0000 F30F1EFA 		endbr64
 1375 0004 55       		pushq	%rbp
 1376              	.LCFI39:
 1377              		.cfi_def_cfa_offset 16
 1378              		.cfi_offset 6, -16
 1379 0005 4889E5   		movq	%rsp, %rbp
 1380              	.LCFI40:
 1381              		.cfi_def_cfa_register 6
 1382 0008 4883EC50 		subq	$80, %rsp
 1383 000c 48897DC8 		movq	%rdi, -56(%rbp)
 1384 0010 488975C0 		movq	%rsi, -64(%rbp)
 1385 0014 488955B8 		movq	%rdx, -72(%rbp)
 1386              		.loc 2 525 1
 1387 0018 64488B04 		movq	%fs:40, %rax
 1387      25280000 
 1387      00
 1388 0021 488945F8 		movq	%rax, -8(%rbp)
 1389 0025 31C0     		xorl	%eax, %eax
 526:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int ret;
 527:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_x509_bitstring bs = { 0, 0, NULL };
 1390              		.loc 2 527 28
 1391 0027 48C745E0 		movq	$0, -32(%rbp)
 1391      00000000 
 1392 002f C645E800 		movb	$0, -24(%rbp)
 1393 0033 48C745F0 		movq	$0, -16(%rbp)
 1393      00000000 
 528:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 529:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_asn1_get_bitstring( p, end, &bs ) ) != 0 )
 1394              		.loc 2 529 17
 1395 003b 488D55E0 		leaq	-32(%rbp), %rdx
 1396 003f 488B4DC0 		movq	-64(%rbp), %rcx
 1397 0043 488B45C8 		movq	-56(%rbp), %rax
 1398 0047 4889CE   		movq	%rcx, %rsi
 1399 004a 4889C7   		movq	%rax, %rdi
 1400 004d E8000000 		call	mbedtls_asn1_get_bitstring@PLT
 1400      00
 1401 0052 8945DC   		movl	%eax, -36(%rbp)
 1402              		.loc 2 529 7
 1403 0055 837DDC00 		cmpl	$0, -36(%rbp)
 1404 0059 740A     		je	.L104
 530:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS + ret );
 1405              		.loc 2 530 53
 1406 005b 8B45DC   		movl	-36(%rbp), %eax
 1407 005e 2D002500 		subl	$9472, %eax
 1407      00
 1408 0063 EB23     		jmp	.L107
 1409              	.L104:
 531:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 532:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( bs.len != 1 )
 1410              		.loc 2 532 11
 1411 0065 488B45E0 		movq	-32(%rbp), %rax
 1412              		.loc 2 532 7
 1413 0069 4883F801 		cmpq	$1, %rax
 1414 006d 7407     		je	.L106
 533:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS +
 1415              		.loc 2 533 15
 1416 006f B89CDAFF 		movl	$-9572, %eax
GAS LISTING /tmp/ccnlqVtp.s 			page 41


 1416      FF
 1417 0074 EB12     		jmp	.L107
 1418              	.L106:
 534:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 MBEDTLS_ERR_ASN1_INVALID_LENGTH );
 535:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 536:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Get actual bitstring */
 537:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     *ns_cert_type = *bs.p;
 1419              		.loc 2 537 24
 1420 0076 488B45F0 		movq	-16(%rbp), %rax
 1421              		.loc 2 537 21
 1422 007a 0FB610   		movzbl	(%rax), %edx
 1423              		.loc 2 537 19
 1424 007d 488B45B8 		movq	-72(%rbp), %rax
 1425 0081 8810     		movb	%dl, (%rax)
 538:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 1426              		.loc 2 538 11
 1427 0083 B8000000 		movl	$0, %eax
 1427      00
 1428              	.L107:
 539:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 1429              		.loc 2 539 1 discriminator 1
 1430 0088 488B4DF8 		movq	-8(%rbp), %rcx
 1431 008c 6448330C 		xorq	%fs:40, %rcx
 1431      25280000 
 1431      00
 1432 0095 7405     		je	.L108
 1433              		.loc 2 539 1 is_stmt 0
 1434 0097 E8000000 		call	__stack_chk_fail@PLT
 1434      00
 1435              	.L108:
 1436 009c C9       		leave
 1437              	.LCFI41:
 1438              		.cfi_def_cfa 7, 8
 1439 009d C3       		ret
 1440              		.cfi_endproc
 1441              	.LFE28:
 1443              		.section	.text.x509_get_key_usage,"ax",@progbits
 1445              	x509_get_key_usage:
 1446              	.LFB29:
 540:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 541:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_get_key_usage( unsigned char **p,
 542:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                const unsigned char *end,
 543:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                unsigned int *key_usage)
 544:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 1447              		.loc 2 544 1 is_stmt 1
 1448              		.cfi_startproc
 1449 0000 F30F1EFA 		endbr64
 1450 0004 55       		pushq	%rbp
 1451              	.LCFI42:
 1452              		.cfi_def_cfa_offset 16
 1453              		.cfi_offset 6, -16
 1454 0005 4889E5   		movq	%rsp, %rbp
 1455              	.LCFI43:
 1456              		.cfi_def_cfa_register 6
 1457 0008 4883EC50 		subq	$80, %rsp
 1458 000c 48897DC8 		movq	%rdi, -56(%rbp)
 1459 0010 488975C0 		movq	%rsi, -64(%rbp)
GAS LISTING /tmp/ccnlqVtp.s 			page 42


 1460 0014 488955B8 		movq	%rdx, -72(%rbp)
 1461              		.loc 2 544 1
 1462 0018 64488B04 		movq	%fs:40, %rax
 1462      25280000 
 1462      00
 1463 0021 488945F8 		movq	%rax, -8(%rbp)
 1464 0025 31C0     		xorl	%eax, %eax
 545:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int ret;
 546:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     size_t i;
 547:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_x509_bitstring bs = { 0, 0, NULL };
 1465              		.loc 2 547 28
 1466 0027 48C745E0 		movq	$0, -32(%rbp)
 1466      00000000 
 1467 002f C645E800 		movb	$0, -24(%rbp)
 1468 0033 48C745F0 		movq	$0, -16(%rbp)
 1468      00000000 
 548:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 549:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_asn1_get_bitstring( p, end, &bs ) ) != 0 )
 1469              		.loc 2 549 17
 1470 003b 488D55E0 		leaq	-32(%rbp), %rdx
 1471 003f 488B4DC0 		movq	-64(%rbp), %rcx
 1472 0043 488B45C8 		movq	-56(%rbp), %rax
 1473 0047 4889CE   		movq	%rcx, %rsi
 1474 004a 4889C7   		movq	%rax, %rdi
 1475 004d E8000000 		call	mbedtls_asn1_get_bitstring@PLT
 1475      00
 1476 0052 8945D4   		movl	%eax, -44(%rbp)
 1477              		.loc 2 549 7
 1478 0055 837DD400 		cmpl	$0, -44(%rbp)
 1479 0059 740A     		je	.L110
 550:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS + ret );
 1480              		.loc 2 550 53
 1481 005b 8B45D4   		movl	-44(%rbp), %eax
 1482 005e 2D002500 		subl	$9472, %eax
 1482      00
 1483 0063 EB6B     		jmp	.L116
 1484              	.L110:
 551:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 552:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( bs.len < 1 )
 1485              		.loc 2 552 11
 1486 0065 488B45E0 		movq	-32(%rbp), %rax
 1487              		.loc 2 552 7
 1488 0069 4885C0   		testq	%rax, %rax
 1489 006c 7507     		jne	.L112
 553:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS +
 1490              		.loc 2 553 15
 1491 006e B89CDAFF 		movl	$-9572, %eax
 1491      FF
 1492 0073 EB5B     		jmp	.L116
 1493              	.L112:
 554:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 MBEDTLS_ERR_ASN1_INVALID_LENGTH );
 555:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 556:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Get actual bitstring */
 557:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     *key_usage = 0;
 1494              		.loc 2 557 16
 1495 0075 488B45B8 		movq	-72(%rbp), %rax
 1496 0079 C7000000 		movl	$0, (%rax)
GAS LISTING /tmp/ccnlqVtp.s 			page 43


 1496      0000
 558:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     for( i = 0; i < bs.len && i < sizeof( unsigned int ); i++ )
 1497              		.loc 2 558 12
 1498 007f 48C745D8 		movq	$0, -40(%rbp)
 1498      00000000 
 1499              		.loc 2 558 5
 1500 0087 EB31     		jmp	.L113
 1501              	.L115:
 559:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 560:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         *key_usage |= (unsigned int) bs.p[i] << (8*i);
 1502              		.loc 2 560 20 discriminator 4
 1503 0089 488B45B8 		movq	-72(%rbp), %rax
 1504 008d 8B00     		movl	(%rax), %eax
 1505              		.loc 2 560 40 discriminator 4
 1506 008f 488B4DF0 		movq	-16(%rbp), %rcx
 1507              		.loc 2 560 42 discriminator 4
 1508 0093 488B55D8 		movq	-40(%rbp), %rdx
 1509 0097 4801CA   		addq	%rcx, %rdx
 1510 009a 0FB612   		movzbl	(%rdx), %edx
 1511              		.loc 2 560 23 discriminator 4
 1512 009d 0FB6F2   		movzbl	%dl, %esi
 1513              		.loc 2 560 46 discriminator 4
 1514 00a0 488B55D8 		movq	-40(%rbp), %rdx
 1515 00a4 C1E203   		sall	$3, %edx
 1516 00a7 89D1     		movl	%edx, %ecx
 1517 00a9 D3E6     		sall	%cl, %esi
 1518 00ab 89F2     		movl	%esi, %edx
 1519              		.loc 2 560 20 discriminator 4
 1520 00ad 09C2     		orl	%eax, %edx
 1521 00af 488B45B8 		movq	-72(%rbp), %rax
 1522 00b3 8910     		movl	%edx, (%rax)
 558:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     for( i = 0; i < bs.len && i < sizeof( unsigned int ); i++ )
 1523              		.loc 2 558 60 discriminator 4
 1524 00b5 488345D8 		addq	$1, -40(%rbp)
 1524      01
 1525              	.L113:
 558:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     for( i = 0; i < bs.len && i < sizeof( unsigned int ); i++ )
 1526              		.loc 2 558 23 discriminator 1
 1527 00ba 488B45E0 		movq	-32(%rbp), %rax
 558:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     for( i = 0; i < bs.len && i < sizeof( unsigned int ); i++ )
 1528              		.loc 2 558 5 discriminator 1
 1529 00be 483945D8 		cmpq	%rax, -40(%rbp)
 1530 00c2 7307     		jnb	.L114
 558:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     for( i = 0; i < bs.len && i < sizeof( unsigned int ); i++ )
 1531              		.loc 2 558 28 discriminator 3
 1532 00c4 48837DD8 		cmpq	$3, -40(%rbp)
 1532      03
 1533 00c9 76BE     		jbe	.L115
 1534              	.L114:
 561:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 562:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 563:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 1535              		.loc 2 563 11
 1536 00cb B8000000 		movl	$0, %eax
 1536      00
 1537              	.L116:
 564:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
GAS LISTING /tmp/ccnlqVtp.s 			page 44


 1538              		.loc 2 564 1 discriminator 1
 1539 00d0 488B7DF8 		movq	-8(%rbp), %rdi
 1540 00d4 6448333C 		xorq	%fs:40, %rdi
 1540      25280000 
 1540      00
 1541 00dd 7405     		je	.L117
 1542              		.loc 2 564 1 is_stmt 0
 1543 00df E8000000 		call	__stack_chk_fail@PLT
 1543      00
 1544              	.L117:
 1545 00e4 C9       		leave
 1546              	.LCFI44:
 1547              		.cfi_def_cfa 7, 8
 1548 00e5 C3       		ret
 1549              		.cfi_endproc
 1550              	.LFE29:
 1552              		.section	.text.x509_get_ext_key_usage,"ax",@progbits
 1554              	x509_get_ext_key_usage:
 1555              	.LFB30:
 565:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 566:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
 567:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * ExtKeyUsageSyntax ::= SEQUENCE SIZE (1..MAX) OF KeyPurposeId
 568:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
 569:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * KeyPurposeId ::= OBJECT IDENTIFIER
 570:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
 571:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_get_ext_key_usage( unsigned char **p,
 572:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                const unsigned char *end,
 573:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                mbedtls_x509_sequence *ext_key_usage)
 574:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 1556              		.loc 2 574 1 is_stmt 1
 1557              		.cfi_startproc
 1558 0000 F30F1EFA 		endbr64
 1559 0004 55       		pushq	%rbp
 1560              	.LCFI45:
 1561              		.cfi_def_cfa_offset 16
 1562              		.cfi_offset 6, -16
 1563 0005 4889E5   		movq	%rsp, %rbp
 1564              	.LCFI46:
 1565              		.cfi_def_cfa_register 6
 1566 0008 4883EC30 		subq	$48, %rsp
 1567 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1568 0010 488975E0 		movq	%rsi, -32(%rbp)
 1569 0014 488955D8 		movq	%rdx, -40(%rbp)
 1570              		.loc 2 574 1
 1571 0018 64488B04 		movq	%fs:40, %rax
 1571      25280000 
 1571      00
 1572 0021 488945F8 		movq	%rax, -8(%rbp)
 1573 0025 31C0     		xorl	%eax, %eax
 575:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int ret;
 576:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 577:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_asn1_get_sequence_of( p, end, ext_key_usage, MBEDTLS_ASN1_OID ) ) != 0 )
 1574              		.loc 2 577 17
 1575 0027 488B55D8 		movq	-40(%rbp), %rdx
 1576 002b 488B75E0 		movq	-32(%rbp), %rsi
 1577 002f 488B45E8 		movq	-24(%rbp), %rax
 1578 0033 B9060000 		movl	$6, %ecx
GAS LISTING /tmp/ccnlqVtp.s 			page 45


 1578      00
 1579 0038 4889C7   		movq	%rax, %rdi
 1580 003b E8000000 		call	mbedtls_asn1_get_sequence_of@PLT
 1580      00
 1581 0040 8945F4   		movl	%eax, -12(%rbp)
 1582              		.loc 2 577 7
 1583 0043 837DF400 		cmpl	$0, -12(%rbp)
 1584 0047 740A     		je	.L119
 578:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS + ret );
 1585              		.loc 2 578 53
 1586 0049 8B45F4   		movl	-12(%rbp), %eax
 1587 004c 2D002500 		subl	$9472, %eax
 1587      00
 1588 0051 EB19     		jmp	.L120
 1589              	.L119:
 579:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 580:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Sequence length must be >= 1 */
 581:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ext_key_usage->buf.p == NULL )
 1590              		.loc 2 581 27
 1591 0053 488B45D8 		movq	-40(%rbp), %rax
 1592 0057 488B4010 		movq	16(%rax), %rax
 1593              		.loc 2 581 7
 1594 005b 4885C0   		testq	%rax, %rax
 1595 005e 7507     		jne	.L121
 582:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS +
 1596              		.loc 2 582 15
 1597 0060 B89CDAFF 		movl	$-9572, %eax
 1597      FF
 1598 0065 EB05     		jmp	.L120
 1599              	.L121:
 583:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 MBEDTLS_ERR_ASN1_INVALID_LENGTH );
 584:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 585:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 1600              		.loc 2 585 11
 1601 0067 B8000000 		movl	$0, %eax
 1601      00
 1602              	.L120:
 586:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 1603              		.loc 2 586 1
 1604 006c 488B4DF8 		movq	-8(%rbp), %rcx
 1605 0070 6448330C 		xorq	%fs:40, %rcx
 1605      25280000 
 1605      00
 1606 0079 7405     		je	.L122
 1607 007b E8000000 		call	__stack_chk_fail@PLT
 1607      00
 1608              	.L122:
 1609 0080 C9       		leave
 1610              	.LCFI47:
 1611              		.cfi_def_cfa 7, 8
 1612 0081 C3       		ret
 1613              		.cfi_endproc
 1614              	.LFE30:
 1616              		.section	.text.x509_get_subject_alt_name,"ax",@progbits
 1618              	x509_get_subject_alt_name:
 1619              	.LFB31:
 587:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
GAS LISTING /tmp/ccnlqVtp.s 			page 46


 588:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
 589:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * SubjectAltName ::= GeneralNames
 590:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
 591:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * GeneralNames ::= SEQUENCE SIZE (1..MAX) OF GeneralName
 592:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
 593:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * GeneralName ::= CHOICE {
 594:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *      otherName                       [0]     OtherName,
 595:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *      rfc822Name                      [1]     IA5String,
 596:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *      dNSName                         [2]     IA5String,
 597:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *      x400Address                     [3]     ORAddress,
 598:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *      directoryName                   [4]     Name,
 599:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *      ediPartyName                    [5]     EDIPartyName,
 600:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *      uniformResourceIdentifier       [6]     IA5String,
 601:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *      iPAddress                       [7]     OCTET STRING,
 602:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *      registeredID                    [8]     OBJECT IDENTIFIER }
 603:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
 604:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * OtherName ::= SEQUENCE {
 605:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *      type-id    OBJECT IDENTIFIER,
 606:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *      value      [0] EXPLICIT ANY DEFINED BY type-id }
 607:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
 608:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * EDIPartyName ::= SEQUENCE {
 609:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *      nameAssigner            [0]     DirectoryString OPTIONAL,
 610:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *      partyName               [1]     DirectoryString }
 611:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
 612:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * NOTE: we only parse and use dNSName at this point.
 613:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
 614:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_get_subject_alt_name( unsigned char **p,
 615:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                       const unsigned char *end,
 616:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                       mbedtls_x509_sequence *subject_alt_name )
 617:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 1620              		.loc 2 617 1
 1621              		.cfi_startproc
 1622 0000 F30F1EFA 		endbr64
 1623 0004 55       		pushq	%rbp
 1624              	.LCFI48:
 1625              		.cfi_def_cfa_offset 16
 1626              		.cfi_offset 6, -16
 1627 0005 4889E5   		movq	%rsp, %rbp
 1628              	.LCFI49:
 1629              		.cfi_def_cfa_register 6
 1630 0008 4883EC50 		subq	$80, %rsp
 1631 000c 48897DC8 		movq	%rdi, -56(%rbp)
 1632 0010 488975C0 		movq	%rsi, -64(%rbp)
 1633 0014 488955B8 		movq	%rdx, -72(%rbp)
 1634              		.loc 2 617 1
 1635 0018 64488B04 		movq	%fs:40, %rax
 1635      25280000 
 1635      00
 1636 0021 488945F8 		movq	%rax, -8(%rbp)
 1637 0025 31C0     		xorl	%eax, %eax
 618:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int ret;
 619:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     size_t len, tag_len;
 620:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_asn1_buf *buf;
 621:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     unsigned char tag;
 622:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_asn1_sequence *cur = subject_alt_name;
 1638              		.loc 2 622 28
 1639 0027 488B45B8 		movq	-72(%rbp), %rax
GAS LISTING /tmp/ccnlqVtp.s 			page 47


 1640 002b 488945E8 		movq	%rax, -24(%rbp)
 623:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 624:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Get main sequence tag */
 625:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_asn1_get_tag( p, end, &len,
 1641              		.loc 2 625 17
 1642 002f 488D55D8 		leaq	-40(%rbp), %rdx
 1643 0033 488B75C0 		movq	-64(%rbp), %rsi
 1644 0037 488B45C8 		movq	-56(%rbp), %rax
 1645 003b B9300000 		movl	$48, %ecx
 1645      00
 1646 0040 4889C7   		movq	%rax, %rdi
 1647 0043 E8000000 		call	mbedtls_asn1_get_tag@PLT
 1647      00
 1648 0048 8945D4   		movl	%eax, -44(%rbp)
 1649              		.loc 2 625 7
 1650 004b 837DD400 		cmpl	$0, -44(%rbp)
 1651 004f 740D     		je	.L124
 626:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             MBEDTLS_ASN1_CONSTRUCTED | MBEDTLS_ASN1_SEQUENCE ) ) != 0 )
 627:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS + ret );
 1652              		.loc 2 627 53
 1653 0051 8B45D4   		movl	-44(%rbp), %eax
 1654 0054 2D002500 		subl	$9472, %eax
 1654      00
 1655 0059 E9A20100 		jmp	.L137
 1655      00
 1656              	.L124:
 628:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 629:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( *p + len != end )
 1657              		.loc 2 629 9
 1658 005e 488B45C8 		movq	-56(%rbp), %rax
 1659 0062 488B10   		movq	(%rax), %rdx
 1660              		.loc 2 629 12
 1661 0065 488B45D8 		movq	-40(%rbp), %rax
 1662 0069 4801D0   		addq	%rdx, %rax
 1663              		.loc 2 629 7
 1664 006c 483945C0 		cmpq	%rax, -64(%rbp)
 1665 0070 0F845401 		je	.L127
 1665      0000
 630:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS +
 1666              		.loc 2 630 15
 1667 0076 B89ADAFF 		movl	$-9574, %eax
 1667      FF
 1668 007b E9800100 		jmp	.L137
 1668      00
 1669              	.L135:
 631:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 MBEDTLS_ERR_ASN1_LENGTH_MISMATCH );
 632:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 633:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     while( *p < end )
 634:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 635:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ( end - *p ) < 1 )
 1670              		.loc 2 635 21
 1671 0080 488B45C8 		movq	-56(%rbp), %rax
 1672 0084 488B00   		movq	(%rax), %rax
 1673              		.loc 2 635 19
 1674 0087 488B55C0 		movq	-64(%rbp), %rdx
 1675 008b 4829C2   		subq	%rax, %rdx
 1676 008e 4889D0   		movq	%rdx, %rax
GAS LISTING /tmp/ccnlqVtp.s 			page 48


 1677              		.loc 2 635 11
 1678 0091 4885C0   		testq	%rax, %rax
 1679 0094 7F0A     		jg	.L128
 636:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS +
 1680              		.loc 2 636 19
 1681 0096 B8A0DAFF 		movl	$-9568, %eax
 1681      FF
 1682 009b E9600100 		jmp	.L137
 1682      00
 1683              	.L128:
 637:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                     MBEDTLS_ERR_ASN1_OUT_OF_DATA );
 638:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 639:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         tag = **p;
 1684              		.loc 2 639 16
 1685 00a0 488B45C8 		movq	-56(%rbp), %rax
 1686 00a4 488B00   		movq	(%rax), %rax
 1687              		.loc 2 639 13
 1688 00a7 0FB600   		movzbl	(%rax), %eax
 1689 00aa 8845D3   		movb	%al, -45(%rbp)
 640:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         (*p)++;
 1690              		.loc 2 640 10
 1691 00ad 488B45C8 		movq	-56(%rbp), %rax
 1692 00b1 488B00   		movq	(%rax), %rax
 1693              		.loc 2 640 13
 1694 00b4 488D5001 		leaq	1(%rax), %rdx
 1695 00b8 488B45C8 		movq	-56(%rbp), %rax
 1696 00bc 488910   		movq	%rdx, (%rax)
 641:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ( ret = mbedtls_asn1_get_len( p, end, &tag_len ) ) != 0 )
 1697              		.loc 2 641 21
 1698 00bf 488D55E0 		leaq	-32(%rbp), %rdx
 1699 00c3 488B4DC0 		movq	-64(%rbp), %rcx
 1700 00c7 488B45C8 		movq	-56(%rbp), %rax
 1701 00cb 4889CE   		movq	%rcx, %rsi
 1702 00ce 4889C7   		movq	%rax, %rdi
 1703 00d1 E8000000 		call	mbedtls_asn1_get_len@PLT
 1703      00
 1704 00d6 8945D4   		movl	%eax, -44(%rbp)
 1705              		.loc 2 641 11
 1706 00d9 837DD400 		cmpl	$0, -44(%rbp)
 1707 00dd 740D     		je	.L129
 642:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS + ret );
 1708              		.loc 2 642 57
 1709 00df 8B45D4   		movl	-44(%rbp), %eax
 1710 00e2 2D002500 		subl	$9472, %eax
 1710      00
 1711 00e7 E9140100 		jmp	.L137
 1711      00
 1712              	.L129:
 643:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 644:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ( tag & MBEDTLS_ASN1_TAG_CLASS_MASK ) !=
 1713              		.loc 2 644 19
 1714 00ec 0FB645D3 		movzbl	-45(%rbp), %eax
 1715 00f0 25C00000 		andl	$192, %eax
 1715      00
 1716              		.loc 2 644 11
 1717 00f5 3D800000 		cmpl	$128, %eax
 1717      00
GAS LISTING /tmp/ccnlqVtp.s 			page 49


 1718 00fa 740A     		je	.L130
 645:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 MBEDTLS_ASN1_CONTEXT_SPECIFIC )
 646:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
 647:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS +
 1719              		.loc 2 647 19
 1720 00fc B89EDAFF 		movl	$-9570, %eax
 1720      FF
 1721 0101 E9FA0000 		jmp	.L137
 1721      00
 1722              	.L130:
 648:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                     MBEDTLS_ERR_ASN1_UNEXPECTED_TAG );
 649:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
 650:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 651:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* Skip everything but DNS name */
 652:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( tag != ( MBEDTLS_ASN1_CONTEXT_SPECIFIC | 2 ) )
 1723              		.loc 2 652 11
 1724 0106 807DD382 		cmpb	$-126, -45(%rbp)
 1725 010a 741A     		je	.L131
 653:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
 654:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             *p += tag_len;
 1726              		.loc 2 654 16
 1727 010c 488B45C8 		movq	-56(%rbp), %rax
 1728 0110 488B10   		movq	(%rax), %rdx
 1729 0113 488B45E0 		movq	-32(%rbp), %rax
 1730 0117 4801C2   		addq	%rax, %rdx
 1731 011a 488B45C8 		movq	-56(%rbp), %rax
 1732 011e 488910   		movq	%rdx, (%rax)
 655:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             continue;
 1733              		.loc 2 655 13
 1734 0121 E9A40000 		jmp	.L127
 1734      00
 1735              	.L131:
 656:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
 657:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 658:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* Allocate and assign next pointer */
 659:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( cur->buf.p != NULL )
 1736              		.loc 2 659 21
 1737 0126 488B45E8 		movq	-24(%rbp), %rax
 1738 012a 488B4010 		movq	16(%rax), %rax
 1739              		.loc 2 659 11
 1740 012e 4885C0   		testq	%rax, %rax
 1741 0131 7451     		je	.L132
 660:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
 661:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             if( cur->next != NULL )
 1742              		.loc 2 661 20
 1743 0133 488B45E8 		movq	-24(%rbp), %rax
 1744 0137 488B4018 		movq	24(%rax), %rax
 1745              		.loc 2 661 15
 1746 013b 4885C0   		testq	%rax, %rax
 1747 013e 740A     		je	.L133
 662:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS );
 1748              		.loc 2 662 23
 1749 0140 B800DBFF 		movl	$-9472, %eax
 1749      FF
 1750 0145 E9B60000 		jmp	.L137
 1750      00
 1751              	.L133:
GAS LISTING /tmp/ccnlqVtp.s 			page 50


 663:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 664:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             cur->next = mbedtls_calloc( 1, sizeof( mbedtls_asn1_sequence ) );
 1752              		.loc 2 664 25
 1753 014a BE200000 		movl	$32, %esi
 1753      00
 1754 014f BF010000 		movl	$1, %edi
 1754      00
 1755 0154 E8000000 		call	mbedtls_calloc@PLT
 1755      00
 1756              		.loc 2 664 23
 1757 0159 488B55E8 		movq	-24(%rbp), %rdx
 1758 015d 48894218 		movq	%rax, 24(%rdx)
 665:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 666:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             if( cur->next == NULL )
 1759              		.loc 2 666 20
 1760 0161 488B45E8 		movq	-24(%rbp), %rax
 1761 0165 488B4018 		movq	24(%rax), %rax
 1762              		.loc 2 666 15
 1763 0169 4885C0   		testq	%rax, %rax
 1764 016c 750A     		jne	.L134
 667:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS +
 1765              		.loc 2 667 23
 1766 016e B896DAFF 		movl	$-9578, %eax
 1766      FF
 1767 0173 E9880000 		jmp	.L137
 1767      00
 1768              	.L134:
 668:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         MBEDTLS_ERR_ASN1_ALLOC_FAILED );
 669:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 670:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             cur = cur->next;
 1769              		.loc 2 670 17
 1770 0178 488B45E8 		movq	-24(%rbp), %rax
 1771 017c 488B4018 		movq	24(%rax), %rax
 1772 0180 488945E8 		movq	%rax, -24(%rbp)
 1773              	.L132:
 671:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
 672:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 673:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         buf = &(cur->buf);
 1774              		.loc 2 673 13
 1775 0184 488B45E8 		movq	-24(%rbp), %rax
 1776 0188 488945F0 		movq	%rax, -16(%rbp)
 674:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         buf->tag = tag;
 1777              		.loc 2 674 18
 1778 018c 0FB655D3 		movzbl	-45(%rbp), %edx
 1779 0190 488B45F0 		movq	-16(%rbp), %rax
 1780 0194 8910     		movl	%edx, (%rax)
 675:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         buf->p = *p;
 1781              		.loc 2 675 18
 1782 0196 488B45C8 		movq	-56(%rbp), %rax
 1783 019a 488B10   		movq	(%rax), %rdx
 1784              		.loc 2 675 16
 1785 019d 488B45F0 		movq	-16(%rbp), %rax
 1786 01a1 48895010 		movq	%rdx, 16(%rax)
 676:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         buf->len = tag_len;
 1787              		.loc 2 676 18
 1788 01a5 488B55E0 		movq	-32(%rbp), %rdx
 1789 01a9 488B45F0 		movq	-16(%rbp), %rax
GAS LISTING /tmp/ccnlqVtp.s 			page 51


 1790 01ad 48895008 		movq	%rdx, 8(%rax)
 677:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         *p += buf->len;
 1791              		.loc 2 677 12
 1792 01b1 488B45C8 		movq	-56(%rbp), %rax
 1793 01b5 488B10   		movq	(%rax), %rdx
 1794              		.loc 2 677 18
 1795 01b8 488B45F0 		movq	-16(%rbp), %rax
 1796 01bc 488B4008 		movq	8(%rax), %rax
 1797              		.loc 2 677 12
 1798 01c0 4801C2   		addq	%rax, %rdx
 1799 01c3 488B45C8 		movq	-56(%rbp), %rax
 1800 01c7 488910   		movq	%rdx, (%rax)
 1801              	.L127:
 633:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 1802              		.loc 2 633 12
 1803 01ca 488B45C8 		movq	-56(%rbp), %rax
 1804 01ce 488B00   		movq	(%rax), %rax
 633:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 1805              		.loc 2 633 10
 1806 01d1 483945C0 		cmpq	%rax, -64(%rbp)
 1807 01d5 0F87A5FE 		ja	.L135
 1807      FFFF
 678:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 679:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 680:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Set final sequence entry's next pointer to NULL */
 681:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     cur->next = NULL;
 1808              		.loc 2 681 15
 1809 01db 488B45E8 		movq	-24(%rbp), %rax
 1810 01df 48C74018 		movq	$0, 24(%rax)
 1810      00000000 
 682:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 683:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( *p != end )
 1811              		.loc 2 683 9
 1812 01e7 488B45C8 		movq	-56(%rbp), %rax
 1813 01eb 488B00   		movq	(%rax), %rax
 1814              		.loc 2 683 7
 1815 01ee 483945C0 		cmpq	%rax, -64(%rbp)
 1816 01f2 7407     		je	.L136
 684:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS +
 1817              		.loc 2 684 15
 1818 01f4 B89ADAFF 		movl	$-9574, %eax
 1818      FF
 1819 01f9 EB05     		jmp	.L137
 1820              	.L136:
 685:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 MBEDTLS_ERR_ASN1_LENGTH_MISMATCH );
 686:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 687:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 1821              		.loc 2 687 11
 1822 01fb B8000000 		movl	$0, %eax
 1822      00
 1823              	.L137:
 688:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 1824              		.loc 2 688 1 discriminator 1
 1825 0200 488B4DF8 		movq	-8(%rbp), %rcx
 1826 0204 6448330C 		xorq	%fs:40, %rcx
 1826      25280000 
 1826      00
GAS LISTING /tmp/ccnlqVtp.s 			page 52


 1827 020d 7405     		je	.L138
 1828              		.loc 2 688 1 is_stmt 0
 1829 020f E8000000 		call	__stack_chk_fail@PLT
 1829      00
 1830              	.L138:
 1831 0214 C9       		leave
 1832              	.LCFI50:
 1833              		.cfi_def_cfa 7, 8
 1834 0215 C3       		ret
 1835              		.cfi_endproc
 1836              	.LFE31:
 1838              		.section	.text.x509_get_crt_ext,"ax",@progbits
 1840              	x509_get_crt_ext:
 1841              	.LFB32:
 689:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 690:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
 691:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * X.509 v3 extensions
 692:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
 693:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
 694:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_get_crt_ext( unsigned char **p,
 695:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                              const unsigned char *end,
 696:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                              mbedtls_x509_crt *crt )
 697:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 1842              		.loc 2 697 1 is_stmt 1
 1843              		.cfi_startproc
 1844 0000 F30F1EFA 		endbr64
 1845 0004 55       		pushq	%rbp
 1846              	.LCFI51:
 1847              		.cfi_def_cfa_offset 16
 1848              		.cfi_offset 6, -16
 1849 0005 4889E5   		movq	%rsp, %rbp
 1850              	.LCFI52:
 1851              		.cfi_def_cfa_register 6
 1852 0008 4883EC70 		subq	$112, %rsp
 1853 000c 48897DA8 		movq	%rdi, -88(%rbp)
 1854 0010 488975A0 		movq	%rsi, -96(%rbp)
 1855 0014 48895598 		movq	%rdx, -104(%rbp)
 1856              		.loc 2 697 1
 1857 0018 64488B04 		movq	%fs:40, %rax
 1857      25280000 
 1857      00
 1858 0021 488945F8 		movq	%rax, -8(%rbp)
 1859 0025 31C0     		xorl	%eax, %eax
 698:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int ret;
 699:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     size_t len;
 700:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     unsigned char *end_ext_data, *end_ext_octet;
 701:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 702:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( *p == end )
 1860              		.loc 2 702 9
 1861 0027 488B45A8 		movq	-88(%rbp), %rax
 1862 002b 488B00   		movq	(%rax), %rax
 1863              		.loc 2 702 7
 1864 002e 483945A0 		cmpq	%rax, -96(%rbp)
 1865 0032 750A     		jne	.L140
 703:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( 0 );
 1866              		.loc 2 703 15
 1867 0034 B8000000 		movl	$0, %eax
GAS LISTING /tmp/ccnlqVtp.s 			page 53


 1867      00
 1868 0039 E9940300 		jmp	.L167
 1868      00
 1869              	.L140:
 704:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 705:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_x509_get_ext( p, end, &crt->v3_ext, 3 ) ) != 0 )
 1870              		.loc 2 705 17
 1871 003e 488B4598 		movq	-104(%rbp), %rax
 1872 0042 488D9088 		leaq	392(%rax), %rdx
 1872      010000
 1873 0049 488B75A0 		movq	-96(%rbp), %rsi
 1874 004d 488B45A8 		movq	-88(%rbp), %rax
 1875 0051 B9030000 		movl	$3, %ecx
 1875      00
 1876 0056 4889C7   		movq	%rax, %rdi
 1877 0059 E8000000 		call	mbedtls_x509_get_ext@PLT
 1877      00
 1878 005e 8945C4   		movl	%eax, -60(%rbp)
 1879              		.loc 2 705 7
 1880 0061 837DC400 		cmpl	$0, -60(%rbp)
 1881 0065 7408     		je	.L142
 706:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( ret );
 1882              		.loc 2 706 15
 1883 0067 8B45C4   		movl	-60(%rbp), %eax
 1884 006a E9630300 		jmp	.L167
 1884      00
 1885              	.L142:
 707:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 708:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     end = crt->v3_ext.p + crt->v3_ext.len;
 1886              		.loc 2 708 22
 1887 006f 488B4598 		movq	-104(%rbp), %rax
 1888 0073 488B9098 		movq	408(%rax), %rdx
 1888      010000
 1889              		.loc 2 708 38
 1890 007a 488B4598 		movq	-104(%rbp), %rax
 1891 007e 488B8090 		movq	400(%rax), %rax
 1891      010000
 1892              		.loc 2 708 9
 1893 0085 4801D0   		addq	%rdx, %rax
 1894 0088 488945A0 		movq	%rax, -96(%rbp)
 709:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     while( *p < end )
 1895              		.loc 2 709 10
 1896 008c E9170300 		jmp	.L143
 1896      00
 1897              	.L165:
 1898              	.LBB3:
 710:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 711:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /*
 712:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****          * Extension  ::=  SEQUENCE  {
 713:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****          *      extnID      OBJECT IDENTIFIER,
 714:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****          *      critical    BOOLEAN DEFAULT FALSE,
 715:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****          *      extnValue   OCTET STRING  }
 716:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****          */
 717:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_x509_buf extn_oid = {0, 0, NULL};
 1899              		.loc 2 717 26
 1900 0091 C745E000 		movl	$0, -32(%rbp)
 1900      000000
GAS LISTING /tmp/ccnlqVtp.s 			page 54


 1901 0098 48C745E8 		movq	$0, -24(%rbp)
 1901      00000000 
 1902 00a0 48C745F0 		movq	$0, -16(%rbp)
 1902      00000000 
 718:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         int is_critical = 0; /* DEFAULT FALSE */
 1903              		.loc 2 718 13
 1904 00a8 C745BC00 		movl	$0, -68(%rbp)
 1904      000000
 719:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         int ext_type = 0;
 1905              		.loc 2 719 13
 1906 00af C745C000 		movl	$0, -64(%rbp)
 1906      000000
 720:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 721:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ( ret = mbedtls_asn1_get_tag( p, end, &len,
 1907              		.loc 2 721 21
 1908 00b6 488D55C8 		leaq	-56(%rbp), %rdx
 1909 00ba 488B75A0 		movq	-96(%rbp), %rsi
 1910 00be 488B45A8 		movq	-88(%rbp), %rax
 1911 00c2 B9300000 		movl	$48, %ecx
 1911      00
 1912 00c7 4889C7   		movq	%rax, %rdi
 1913 00ca E8000000 		call	mbedtls_asn1_get_tag@PLT
 1913      00
 1914 00cf 8945C4   		movl	%eax, -60(%rbp)
 1915              		.loc 2 721 11
 1916 00d2 837DC400 		cmpl	$0, -60(%rbp)
 1917 00d6 740D     		je	.L144
 722:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 MBEDTLS_ASN1_CONSTRUCTED | MBEDTLS_ASN1_SEQUENCE ) ) != 0 )
 723:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS + ret );
 1918              		.loc 2 723 57
 1919 00d8 8B45C4   		movl	-60(%rbp), %eax
 1920 00db 2D002500 		subl	$9472, %eax
 1920      00
 1921 00e0 E9ED0200 		jmp	.L167
 1921      00
 1922              	.L144:
 724:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 725:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         end_ext_data = *p + len;
 1923              		.loc 2 725 24
 1924 00e5 488B45A8 		movq	-88(%rbp), %rax
 1925 00e9 488B10   		movq	(%rax), %rdx
 1926              		.loc 2 725 27
 1927 00ec 488B45C8 		movq	-56(%rbp), %rax
 1928              		.loc 2 725 22
 1929 00f0 4801D0   		addq	%rdx, %rax
 1930 00f3 488945D0 		movq	%rax, -48(%rbp)
 726:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 727:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* Get extension ID */
 728:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ( ret = mbedtls_asn1_get_tag( p, end_ext_data, &extn_oid.len,
 1931              		.loc 2 728 21
 1932 00f7 488D45E0 		leaq	-32(%rbp), %rax
 1933 00fb 488D5008 		leaq	8(%rax), %rdx
 1934 00ff 488B75D0 		movq	-48(%rbp), %rsi
 1935 0103 488B45A8 		movq	-88(%rbp), %rax
 1936 0107 B9060000 		movl	$6, %ecx
 1936      00
 1937 010c 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/ccnlqVtp.s 			page 55


 1938 010f E8000000 		call	mbedtls_asn1_get_tag@PLT
 1938      00
 1939 0114 8945C4   		movl	%eax, -60(%rbp)
 1940              		.loc 2 728 11
 1941 0117 837DC400 		cmpl	$0, -60(%rbp)
 1942 011b 740D     		je	.L146
 729:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                           MBEDTLS_ASN1_OID ) ) != 0 )
 730:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS + ret );
 1943              		.loc 2 730 57
 1944 011d 8B45C4   		movl	-60(%rbp), %eax
 1945 0120 2D002500 		subl	$9472, %eax
 1945      00
 1946 0125 E9A80200 		jmp	.L167
 1946      00
 1947              	.L146:
 731:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 732:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         extn_oid.tag = MBEDTLS_ASN1_OID;
 1948              		.loc 2 732 22
 1949 012a C745E006 		movl	$6, -32(%rbp)
 1949      000000
 733:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         extn_oid.p = *p;
 1950              		.loc 2 733 22
 1951 0131 488B45A8 		movq	-88(%rbp), %rax
 1952 0135 488B00   		movq	(%rax), %rax
 1953              		.loc 2 733 20
 1954 0138 488945F0 		movq	%rax, -16(%rbp)
 734:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         *p += extn_oid.len;
 1955              		.loc 2 734 12
 1956 013c 488B45A8 		movq	-88(%rbp), %rax
 1957 0140 488B10   		movq	(%rax), %rdx
 1958              		.loc 2 734 23
 1959 0143 488B45E8 		movq	-24(%rbp), %rax
 1960              		.loc 2 734 12
 1961 0147 4801C2   		addq	%rax, %rdx
 1962 014a 488B45A8 		movq	-88(%rbp), %rax
 1963 014e 488910   		movq	%rdx, (%rax)
 735:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 736:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* Get optional critical */
 737:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ( ret = mbedtls_asn1_get_bool( p, end_ext_data, &is_critical ) ) != 0 &&
 1964              		.loc 2 737 21
 1965 0151 488D55BC 		leaq	-68(%rbp), %rdx
 1966 0155 488B4DD0 		movq	-48(%rbp), %rcx
 1967 0159 488B45A8 		movq	-88(%rbp), %rax
 1968 015d 4889CE   		movq	%rcx, %rsi
 1969 0160 4889C7   		movq	%rax, %rdi
 1970 0163 E8000000 		call	mbedtls_asn1_get_bool@PLT
 1970      00
 1971 0168 8945C4   		movl	%eax, -60(%rbp)
 1972              		.loc 2 737 11
 1973 016b 837DC400 		cmpl	$0, -60(%rbp)
 1974 016f 7413     		je	.L147
 1975              		.loc 2 737 83 discriminator 1
 1976 0171 837DC49E 		cmpl	$-98, -60(%rbp)
 1977 0175 740D     		je	.L147
 738:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             ( ret != MBEDTLS_ERR_ASN1_UNEXPECTED_TAG ) )
 739:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS + ret );
 1978              		.loc 2 739 57
GAS LISTING /tmp/ccnlqVtp.s 			page 56


 1979 0177 8B45C4   		movl	-60(%rbp), %eax
 1980 017a 2D002500 		subl	$9472, %eax
 1980      00
 1981 017f E94E0200 		jmp	.L167
 1981      00
 1982              	.L147:
 740:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 741:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* Data should be octet string type */
 742:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ( ret = mbedtls_asn1_get_tag( p, end_ext_data, &len,
 1983              		.loc 2 742 21
 1984 0184 488D55C8 		leaq	-56(%rbp), %rdx
 1985 0188 488B75D0 		movq	-48(%rbp), %rsi
 1986 018c 488B45A8 		movq	-88(%rbp), %rax
 1987 0190 B9040000 		movl	$4, %ecx
 1987      00
 1988 0195 4889C7   		movq	%rax, %rdi
 1989 0198 E8000000 		call	mbedtls_asn1_get_tag@PLT
 1989      00
 1990 019d 8945C4   		movl	%eax, -60(%rbp)
 1991              		.loc 2 742 11
 1992 01a0 837DC400 		cmpl	$0, -60(%rbp)
 1993 01a4 740D     		je	.L148
 743:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 MBEDTLS_ASN1_OCTET_STRING ) ) != 0 )
 744:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS + ret );
 1994              		.loc 2 744 57
 1995 01a6 8B45C4   		movl	-60(%rbp), %eax
 1996 01a9 2D002500 		subl	$9472, %eax
 1996      00
 1997 01ae E91F0200 		jmp	.L167
 1997      00
 1998              	.L148:
 745:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 746:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         end_ext_octet = *p + len;
 1999              		.loc 2 746 25
 2000 01b3 488B45A8 		movq	-88(%rbp), %rax
 2001 01b7 488B10   		movq	(%rax), %rdx
 2002              		.loc 2 746 28
 2003 01ba 488B45C8 		movq	-56(%rbp), %rax
 2004              		.loc 2 746 23
 2005 01be 4801D0   		addq	%rdx, %rax
 2006 01c1 488945D8 		movq	%rax, -40(%rbp)
 747:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 748:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( end_ext_octet != end_ext_data )
 2007              		.loc 2 748 11
 2008 01c5 488B45D8 		movq	-40(%rbp), %rax
 2009 01c9 483B45D0 		cmpq	-48(%rbp), %rax
 2010 01cd 740A     		je	.L149
 749:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS +
 2011              		.loc 2 749 19
 2012 01cf B89ADAFF 		movl	$-9574, %eax
 2012      FF
 2013 01d4 E9F90100 		jmp	.L167
 2013      00
 2014              	.L149:
 750:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                     MBEDTLS_ERR_ASN1_LENGTH_MISMATCH );
 751:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 752:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /*
GAS LISTING /tmp/ccnlqVtp.s 			page 57


 753:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****          * Detect supported extensions
 754:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****          */
 755:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ret = mbedtls_oid_get_x509_ext_type( &extn_oid, &ext_type );
 2015              		.loc 2 755 15
 2016 01d9 488D55C0 		leaq	-64(%rbp), %rdx
 2017 01dd 488D45E0 		leaq	-32(%rbp), %rax
 2018 01e1 4889D6   		movq	%rdx, %rsi
 2019 01e4 4889C7   		movq	%rax, %rdi
 2020 01e7 E8000000 		call	mbedtls_oid_get_x509_ext_type@PLT
 2020      00
 2021 01ec 8945C4   		movl	%eax, -60(%rbp)
 756:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 757:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ret != 0 )
 2022              		.loc 2 757 11
 2023 01ef 837DC400 		cmpl	$0, -60(%rbp)
 2024 01f3 7420     		je	.L150
 758:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
 759:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             /* No parser found, skip extension */
 760:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             *p = end_ext_octet;
 2025              		.loc 2 760 16
 2026 01f5 488B45A8 		movq	-88(%rbp), %rax
 2027 01f9 488B55D8 		movq	-40(%rbp), %rdx
 2028 01fd 488910   		movq	%rdx, (%rax)
 761:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 762:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if !defined(MBEDTLS_X509_ALLOW_UNSUPPORTED_CRITICAL_EXTENSION)
 763:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             if( is_critical )
 2029              		.loc 2 763 17
 2030 0200 8B45BC   		movl	-68(%rbp), %eax
 2031              		.loc 2 763 15
 2032 0203 85C0     		testl	%eax, %eax
 2033 0205 0F849D01 		je	.L143
 2033      0000
 764:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             {
 765:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 /* Data is marked as critical: fail */
 766:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS +
 2034              		.loc 2 766 23
 2035 020b B89EDAFF 		movl	$-9570, %eax
 2035      FF
 2036 0210 E9BD0100 		jmp	.L167
 2036      00
 2037              	.L150:
 767:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         MBEDTLS_ERR_ASN1_UNEXPECTED_TAG );
 768:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             }
 769:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
 770:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             continue;
 771:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
 772:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 773:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* Forbid repeated extensions */
 774:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ( crt->ext_types & ext_type ) != 0 )
 2038              		.loc 2 774 18
 2039 0215 488B4598 		movq	-104(%rbp), %rax
 2040 0219 8B90C001 		movl	448(%rax), %edx
 2040      0000
 2041              		.loc 2 774 30
 2042 021f 8B45C0   		movl	-64(%rbp), %eax
 2043 0222 21D0     		andl	%edx, %eax
 2044              		.loc 2 774 11
GAS LISTING /tmp/ccnlqVtp.s 			page 58


 2045 0224 85C0     		testl	%eax, %eax
 2046 0226 740A     		je	.L152
 775:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS );
 2047              		.loc 2 775 19
 2048 0228 B800DBFF 		movl	$-9472, %eax
 2048      FF
 2049 022d E9A00100 		jmp	.L167
 2049      00
 2050              	.L152:
 776:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 777:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         crt->ext_types |= ext_type;
 2051              		.loc 2 777 24
 2052 0232 488B4598 		movq	-104(%rbp), %rax
 2053 0236 8B90C001 		movl	448(%rax), %edx
 2053      0000
 2054 023c 8B45C0   		movl	-64(%rbp), %eax
 2055 023f 09C2     		orl	%eax, %edx
 2056 0241 488B4598 		movq	-104(%rbp), %rax
 2057 0245 8990C001 		movl	%edx, 448(%rax)
 2057      0000
 778:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 779:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         switch( ext_type )
 2058              		.loc 2 779 9
 2059 024b 8B45C0   		movl	-64(%rbp), %eax
 2060 024e 3D000001 		cmpl	$65536, %eax
 2060      00
 2061 0253 0F840F01 		je	.L153
 2061      0000
 2062 0259 3D000001 		cmpl	$65536, %eax
 2062      00
 2063 025e 0F8F3001 		jg	.L154
 2063      0000
 2064 0264 3D000800 		cmpl	$2048, %eax
 2064      00
 2065 0269 0F849E00 		je	.L155
 2065      0000
 2066 026f 3D000800 		cmpl	$2048, %eax
 2066      00
 2067 0274 0F8F1A01 		jg	.L154
 2067      0000
 2068 027a 3D000100 		cmpl	$256, %eax
 2068      00
 2069 027f 741E     		je	.L156
 2070 0281 3D000100 		cmpl	$256, %eax
 2070      00
 2071 0286 0F8F0801 		jg	.L154
 2071      0000
 2072 028c 83F804   		cmpl	$4, %eax
 2073 028f 7449     		je	.L157
 2074 0291 83F820   		cmpl	$32, %eax
 2075 0294 0F84A200 		je	.L158
 2075      0000
 2076 029a E9F50000 		jmp	.L154
 2076      00
 2077              	.L156:
 780:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
 781:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         case MBEDTLS_X509_EXT_BASIC_CONSTRAINTS:
GAS LISTING /tmp/ccnlqVtp.s 			page 59


 782:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             /* Parse basic constraints */
 783:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             if( ( ret = x509_get_basic_constraints( p, end_ext_octet,
 2078              		.loc 2 783 25
 2079 029f 488B4598 		movq	-104(%rbp), %rax
 2080 02a3 488D88C8 		leaq	456(%rax), %rcx
 2080      010000
 2081 02aa 488B4598 		movq	-104(%rbp), %rax
 2082 02ae 488D90C4 		leaq	452(%rax), %rdx
 2082      010000
 2083 02b5 488B75D8 		movq	-40(%rbp), %rsi
 2084 02b9 488B45A8 		movq	-88(%rbp), %rax
 2085 02bd 4889C7   		movq	%rax, %rdi
 2086 02c0 E8000000 		call	x509_get_basic_constraints
 2086      00
 2087 02c5 8945C4   		movl	%eax, -60(%rbp)
 2088              		.loc 2 783 15
 2089 02c8 837DC400 		cmpl	$0, -60(%rbp)
 2090 02cc 0F84C900 		je	.L169
 2090      0000
 784:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                     &crt->ca_istrue, &crt->max_pathlen ) ) != 0 )
 785:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 return( ret );
 2091              		.loc 2 785 23
 2092 02d2 8B45C4   		movl	-60(%rbp), %eax
 2093 02d5 E9F80000 		jmp	.L167
 2093      00
 2094              	.L157:
 786:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             break;
 787:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 788:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         case MBEDTLS_X509_EXT_KEY_USAGE:
 789:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             /* Parse key usage */
 790:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             if( ( ret = x509_get_key_usage( p, end_ext_octet,
 2095              		.loc 2 790 25
 2096 02da 488B4598 		movq	-104(%rbp), %rax
 2097 02de 488D90CC 		leaq	460(%rax), %rdx
 2097      010000
 2098 02e5 488B4DD8 		movq	-40(%rbp), %rcx
 2099 02e9 488B45A8 		movq	-88(%rbp), %rax
 2100 02ed 4889CE   		movq	%rcx, %rsi
 2101 02f0 4889C7   		movq	%rax, %rdi
 2102 02f3 E8000000 		call	x509_get_key_usage
 2102      00
 2103 02f8 8945C4   		movl	%eax, -60(%rbp)
 2104              		.loc 2 790 15
 2105 02fb 837DC400 		cmpl	$0, -60(%rbp)
 2106 02ff 0F849900 		je	.L170
 2106      0000
 791:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                     &crt->key_usage ) ) != 0 )
 792:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 return( ret );
 2107              		.loc 2 792 23
 2108 0305 8B45C4   		movl	-60(%rbp), %eax
 2109 0308 E9C50000 		jmp	.L167
 2109      00
 2110              	.L155:
 793:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             break;
 794:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 795:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         case MBEDTLS_X509_EXT_EXTENDED_KEY_USAGE:
 796:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             /* Parse extended key usage */
GAS LISTING /tmp/ccnlqVtp.s 			page 60


 797:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             if( ( ret = x509_get_ext_key_usage( p, end_ext_octet,
 2111              		.loc 2 797 25
 2112 030d 488B4598 		movq	-104(%rbp), %rax
 2113 0311 488D90D0 		leaq	464(%rax), %rdx
 2113      010000
 2114 0318 488B4DD8 		movq	-40(%rbp), %rcx
 2115 031c 488B45A8 		movq	-88(%rbp), %rax
 2116 0320 4889CE   		movq	%rcx, %rsi
 2117 0323 4889C7   		movq	%rax, %rdi
 2118 0326 E8000000 		call	x509_get_ext_key_usage
 2118      00
 2119 032b 8945C4   		movl	%eax, -60(%rbp)
 2120              		.loc 2 797 15
 2121 032e 837DC400 		cmpl	$0, -60(%rbp)
 2122 0332 746D     		je	.L171
 798:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                     &crt->ext_key_usage ) ) != 0 )
 799:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 return( ret );
 2123              		.loc 2 799 23
 2124 0334 8B45C4   		movl	-60(%rbp), %eax
 2125 0337 E9960000 		jmp	.L167
 2125      00
 2126              	.L158:
 800:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             break;
 801:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 802:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         case MBEDTLS_X509_EXT_SUBJECT_ALT_NAME:
 803:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             /* Parse subject alt name */
 804:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             if( ( ret = x509_get_subject_alt_name( p, end_ext_octet,
 2127              		.loc 2 804 25
 2128 033c 488B4598 		movq	-104(%rbp), %rax
 2129 0340 488D90A0 		leaq	416(%rax), %rdx
 2129      010000
 2130 0347 488B4DD8 		movq	-40(%rbp), %rcx
 2131 034b 488B45A8 		movq	-88(%rbp), %rax
 2132 034f 4889CE   		movq	%rcx, %rsi
 2133 0352 4889C7   		movq	%rax, %rdi
 2134 0355 E8000000 		call	x509_get_subject_alt_name
 2134      00
 2135 035a 8945C4   		movl	%eax, -60(%rbp)
 2136              		.loc 2 804 15
 2137 035d 837DC400 		cmpl	$0, -60(%rbp)
 2138 0361 7441     		je	.L172
 805:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                     &crt->subject_alt_names ) ) != 0 )
 806:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 return( ret );
 2139              		.loc 2 806 23
 2140 0363 8B45C4   		movl	-60(%rbp), %eax
 2141 0366 EB6A     		jmp	.L167
 2142              	.L153:
 807:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             break;
 808:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 809:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         case MBEDTLS_X509_EXT_NS_CERT_TYPE:
 810:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             /* Parse netscape certificate type */
 811:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             if( ( ret = x509_get_ns_cert_type( p, end_ext_octet,
 2143              		.loc 2 811 25
 2144 0368 488B4598 		movq	-104(%rbp), %rax
 2145 036c 488D90F0 		leaq	496(%rax), %rdx
 2145      010000
 2146 0373 488B4DD8 		movq	-40(%rbp), %rcx
GAS LISTING /tmp/ccnlqVtp.s 			page 61


 2147 0377 488B45A8 		movq	-88(%rbp), %rax
 2148 037b 4889CE   		movq	%rcx, %rsi
 2149 037e 4889C7   		movq	%rax, %rdi
 2150 0381 E8000000 		call	x509_get_ns_cert_type
 2150      00
 2151 0386 8945C4   		movl	%eax, -60(%rbp)
 2152              		.loc 2 811 15
 2153 0389 837DC400 		cmpl	$0, -60(%rbp)
 2154 038d 7418     		je	.L173
 812:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                     &crt->ns_cert_type ) ) != 0 )
 813:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 return( ret );
 2155              		.loc 2 813 23
 2156 038f 8B45C4   		movl	-60(%rbp), %eax
 2157 0392 EB3E     		jmp	.L167
 2158              	.L154:
 814:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             break;
 815:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 816:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         default:
 817:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( MBEDTLS_ERR_X509_FEATURE_UNAVAILABLE );
 2159              		.loc 2 817 19
 2160 0394 B880DFFF 		movl	$-8320, %eax
 2160      FF
 2161 0399 EB37     		jmp	.L167
 2162              	.L169:
 786:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 2163              		.loc 2 786 13
 2164 039b 90       		nop
 2165 039c EB0A     		jmp	.L143
 2166              	.L170:
 793:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 2167              		.loc 2 793 13
 2168 039e 90       		nop
 2169 039f EB07     		jmp	.L143
 2170              	.L171:
 800:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 2171              		.loc 2 800 13
 2172 03a1 90       		nop
 2173 03a2 EB04     		jmp	.L143
 2174              	.L172:
 807:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 2175              		.loc 2 807 13
 2176 03a4 90       		nop
 2177 03a5 EB01     		jmp	.L143
 2178              	.L173:
 814:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 2179              		.loc 2 814 13
 2180 03a7 90       		nop
 2181              	.L143:
 2182              	.LBE3:
 709:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 2183              		.loc 2 709 12
 2184 03a8 488B45A8 		movq	-88(%rbp), %rax
 2185 03ac 488B00   		movq	(%rax), %rax
 709:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 2186              		.loc 2 709 10
 2187 03af 483945A0 		cmpq	%rax, -96(%rbp)
 2188 03b3 0F87D8FC 		ja	.L165
GAS LISTING /tmp/ccnlqVtp.s 			page 62


 2188      FFFF
 818:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
 819:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 820:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 821:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( *p != end )
 2189              		.loc 2 821 9
 2190 03b9 488B45A8 		movq	-88(%rbp), %rax
 2191 03bd 488B00   		movq	(%rax), %rax
 2192              		.loc 2 821 7
 2193 03c0 483945A0 		cmpq	%rax, -96(%rbp)
 2194 03c4 7407     		je	.L166
 822:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_EXTENSIONS +
 2195              		.loc 2 822 15
 2196 03c6 B89ADAFF 		movl	$-9574, %eax
 2196      FF
 2197 03cb EB05     		jmp	.L167
 2198              	.L166:
 823:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 MBEDTLS_ERR_ASN1_LENGTH_MISMATCH );
 824:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 825:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 2199              		.loc 2 825 11
 2200 03cd B8000000 		movl	$0, %eax
 2200      00
 2201              	.L167:
 826:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 2202              		.loc 2 826 1 discriminator 6
 2203 03d2 488B7DF8 		movq	-8(%rbp), %rdi
 2204 03d6 6448333C 		xorq	%fs:40, %rdi
 2204      25280000 
 2204      00
 2205 03df 7405     		je	.L168
 2206              		.loc 2 826 1 is_stmt 0
 2207 03e1 E8000000 		call	__stack_chk_fail@PLT
 2207      00
 2208              	.L168:
 2209 03e6 C9       		leave
 2210              	.LCFI53:
 2211              		.cfi_def_cfa 7, 8
 2212 03e7 C3       		ret
 2213              		.cfi_endproc
 2214              	.LFE32:
 2216              		.section	.text.x509_crt_parse_der_core,"ax",@progbits
 2218              	x509_crt_parse_der_core:
 2219              	.LFB33:
 827:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 828:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
 829:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Parse and fill a single X.509 certificate in DER format
 830:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
 831:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_crt_parse_der_core( mbedtls_x509_crt *crt, const unsigned char *buf,
 832:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                     size_t buflen )
 833:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 2220              		.loc 2 833 1 is_stmt 1
 2221              		.cfi_startproc
 2222 0000 F30F1EFA 		endbr64
 2223 0004 55       		pushq	%rbp
 2224              	.LCFI54:
 2225              		.cfi_def_cfa_offset 16
GAS LISTING /tmp/ccnlqVtp.s 			page 63


 2226              		.cfi_offset 6, -16
 2227 0005 4889E5   		movq	%rsp, %rbp
 2228              	.LCFI55:
 2229              		.cfi_def_cfa_register 6
 2230 0008 4881ECB0 		subq	$176, %rsp
 2230      000000
 2231 000f 4889BD68 		movq	%rdi, -152(%rbp)
 2231      FFFFFF
 2232 0016 4889B560 		movq	%rsi, -160(%rbp)
 2232      FFFFFF
 2233 001d 48899558 		movq	%rdx, -168(%rbp)
 2233      FFFFFF
 2234              		.loc 2 833 1
 2235 0024 64488B04 		movq	%fs:40, %rax
 2235      25280000 
 2235      00
 2236 002d 488945F8 		movq	%rax, -8(%rbp)
 2237 0031 31C0     		xorl	%eax, %eax
 834:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int ret;
 835:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     size_t len;
 836:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     unsigned char *p, *end, *crt_end;
 837:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_x509_buf sig_params1, sig_params2, sig_oid2;
 838:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 839:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     memset( &sig_params1, 0, sizeof( mbedtls_x509_buf ) );
 2238              		.loc 2 839 5
 2239 0033 488D45A0 		leaq	-96(%rbp), %rax
 2240 0037 BA180000 		movl	$24, %edx
 2240      00
 2241 003c BE000000 		movl	$0, %esi
 2241      00
 2242 0041 4889C7   		movq	%rax, %rdi
 2243 0044 E8000000 		call	memset@PLT
 2243      00
 840:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     memset( &sig_params2, 0, sizeof( mbedtls_x509_buf ) );
 2244              		.loc 2 840 5
 2245 0049 488D45C0 		leaq	-64(%rbp), %rax
 2246 004d BA180000 		movl	$24, %edx
 2246      00
 2247 0052 BE000000 		movl	$0, %esi
 2247      00
 2248 0057 4889C7   		movq	%rax, %rdi
 2249 005a E8000000 		call	memset@PLT
 2249      00
 841:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     memset( &sig_oid2, 0, sizeof( mbedtls_x509_buf ) );
 2250              		.loc 2 841 5
 2251 005f 488D45E0 		leaq	-32(%rbp), %rax
 2252 0063 BA180000 		movl	$24, %edx
 2252      00
 2253 0068 BE000000 		movl	$0, %esi
 2253      00
 2254 006d 4889C7   		movq	%rax, %rdi
 2255 0070 E8000000 		call	memset@PLT
 2255      00
 842:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 843:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /*
 844:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      * Check for valid input
 845:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      */
GAS LISTING /tmp/ccnlqVtp.s 			page 64


 846:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( crt == NULL || buf == NULL )
 2256              		.loc 2 846 7
 2257 0075 4883BD68 		cmpq	$0, -152(%rbp)
 2257      FFFFFF00 
 2258 007d 740A     		je	.L175
 2259              		.loc 2 846 21 discriminator 1
 2260 007f 4883BD60 		cmpq	$0, -160(%rbp)
 2260      FFFFFF00 
 2261 0087 750A     		jne	.L176
 2262              	.L175:
 847:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_BAD_INPUT_DATA );
 2263              		.loc 2 847 15
 2264 0089 B800D8FF 		movl	$-10240, %eax
 2264      FF
 2265 008e E9080800 		jmp	.L204
 2265      00
 2266              	.L176:
 848:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 849:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     // Use the original buffer until we figure out actual length
 850:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     p = (unsigned char*) buf;
 2267              		.loc 2 850 7
 2268 0093 488B8560 		movq	-160(%rbp), %rax
 2268      FFFFFF
 2269 009a 48894588 		movq	%rax, -120(%rbp)
 851:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     len = buflen;
 2270              		.loc 2 851 9
 2271 009e 488B8558 		movq	-168(%rbp), %rax
 2271      FFFFFF
 2272 00a5 48894580 		movq	%rax, -128(%rbp)
 852:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     end = p + len;
 2273              		.loc 2 852 13
 2274 00a9 488B5588 		movq	-120(%rbp), %rdx
 2275 00ad 488B4580 		movq	-128(%rbp), %rax
 2276              		.loc 2 852 9
 2277 00b1 4801D0   		addq	%rdx, %rax
 2278 00b4 48894590 		movq	%rax, -112(%rbp)
 853:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 854:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /*
 855:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      * Certificate  ::=  SEQUENCE  {
 856:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      *      tbsCertificate       TBSCertificate,
 857:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      *      signatureAlgorithm   AlgorithmIdentifier,
 858:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      *      signatureValue       BIT STRING  }
 859:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      */
 860:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_asn1_get_tag( &p, end, &len,
 2279              		.loc 2 860 17
 2280 00b8 488D5580 		leaq	-128(%rbp), %rdx
 2281 00bc 488B7590 		movq	-112(%rbp), %rsi
 2282 00c0 488D4588 		leaq	-120(%rbp), %rax
 2283 00c4 B9300000 		movl	$48, %ecx
 2283      00
 2284 00c9 4889C7   		movq	%rax, %rdi
 2285 00cc E8000000 		call	mbedtls_asn1_get_tag@PLT
 2285      00
 2286 00d1 89857CFF 		movl	%eax, -132(%rbp)
 2286      FFFF
 2287              		.loc 2 860 7
 2288 00d7 83BD7CFF 		cmpl	$0, -132(%rbp)
GAS LISTING /tmp/ccnlqVtp.s 			page 65


 2288      FFFF00
 2289 00de 7419     		je	.L178
 861:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             MBEDTLS_ASN1_CONSTRUCTED | MBEDTLS_ASN1_SEQUENCE ) ) != 0 )
 862:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 863:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_x509_crt_free( crt );
 2290              		.loc 2 863 9
 2291 00e0 488B8568 		movq	-152(%rbp), %rax
 2291      FFFFFF
 2292 00e7 4889C7   		movq	%rax, %rdi
 2293 00ea E8000000 		call	mbedtls_x509_crt_free
 2293      00
 864:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_FORMAT );
 2294              		.loc 2 864 15
 2295 00ef B880DEFF 		movl	$-8576, %eax
 2295      FF
 2296 00f4 E9A20700 		jmp	.L204
 2296      00
 2297              	.L178:
 865:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 866:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 867:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( len > (size_t) ( end - p ) )
 2298              		.loc 2 867 30
 2299 00f9 488B4588 		movq	-120(%rbp), %rax
 2300 00fd 488B5590 		movq	-112(%rbp), %rdx
 2301 0101 4829C2   		subq	%rax, %rdx
 2302 0104 4889D0   		movq	%rdx, %rax
 2303              		.loc 2 867 15
 2304 0107 4889C2   		movq	%rax, %rdx
 2305              		.loc 2 867 13
 2306 010a 488B4580 		movq	-128(%rbp), %rax
 2307              		.loc 2 867 7
 2308 010e 4839C2   		cmpq	%rax, %rdx
 2309 0111 7319     		jnb	.L179
 868:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 869:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_x509_crt_free( crt );
 2310              		.loc 2 869 9
 2311 0113 488B8568 		movq	-152(%rbp), %rax
 2311      FFFFFF
 2312 011a 4889C7   		movq	%rax, %rdi
 2313 011d E8000000 		call	mbedtls_x509_crt_free
 2313      00
 870:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_FORMAT +
 2314              		.loc 2 870 15
 2315 0122 B81ADEFF 		movl	$-8678, %eax
 2315      FF
 2316 0127 E96F0700 		jmp	.L204
 2316      00
 2317              	.L179:
 871:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 MBEDTLS_ERR_ASN1_LENGTH_MISMATCH );
 872:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 873:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     crt_end = p + len;
 2318              		.loc 2 873 17
 2319 012c 488B5588 		movq	-120(%rbp), %rdx
 2320 0130 488B4580 		movq	-128(%rbp), %rax
 2321              		.loc 2 873 13
 2322 0134 4801D0   		addq	%rdx, %rax
 2323 0137 48894598 		movq	%rax, -104(%rbp)
GAS LISTING /tmp/ccnlqVtp.s 			page 66


 874:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 875:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     // Create and populate a new buffer for the raw field
 876:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     crt->raw.len = crt_end - buf;
 2324              		.loc 2 876 28
 2325 013b 488B4598 		movq	-104(%rbp), %rax
 2326 013f 482B8560 		subq	-160(%rbp), %rax
 2326      FFFFFF
 2327 0146 4889C2   		movq	%rax, %rdx
 2328              		.loc 2 876 18
 2329 0149 488B8568 		movq	-152(%rbp), %rax
 2329      FFFFFF
 2330 0150 48895008 		movq	%rdx, 8(%rax)
 877:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     crt->raw.p = p = mbedtls_calloc( 1, crt->raw.len );
 2331              		.loc 2 877 22
 2332 0154 488B8568 		movq	-152(%rbp), %rax
 2332      FFFFFF
 2333 015b 488B4008 		movq	8(%rax), %rax
 2334 015f 4889C6   		movq	%rax, %rsi
 2335 0162 BF010000 		movl	$1, %edi
 2335      00
 2336 0167 E8000000 		call	mbedtls_calloc@PLT
 2336      00
 2337              		.loc 2 877 20
 2338 016c 48894588 		movq	%rax, -120(%rbp)
 2339              		.loc 2 877 16
 2340 0170 488B5588 		movq	-120(%rbp), %rdx
 2341 0174 488B8568 		movq	-152(%rbp), %rax
 2341      FFFFFF
 2342 017b 48895010 		movq	%rdx, 16(%rax)
 878:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( p == NULL )
 2343              		.loc 2 878 11
 2344 017f 488B4588 		movq	-120(%rbp), %rax
 2345              		.loc 2 878 7
 2346 0183 4885C0   		testq	%rax, %rax
 2347 0186 750A     		jne	.L180
 879:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_ALLOC_FAILED );
 2348              		.loc 2 879 15
 2349 0188 B880D7FF 		movl	$-10368, %eax
 2349      FF
 2350 018d E9090700 		jmp	.L204
 2350      00
 2351              	.L180:
 880:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 881:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     memcpy( p, buf, crt->raw.len );
 2352              		.loc 2 881 5
 2353 0192 488B8568 		movq	-152(%rbp), %rax
 2353      FFFFFF
 2354 0199 488B5008 		movq	8(%rax), %rdx
 2355 019d 488B4588 		movq	-120(%rbp), %rax
 2356 01a1 488B8D60 		movq	-160(%rbp), %rcx
 2356      FFFFFF
 2357 01a8 4889CE   		movq	%rcx, %rsi
 2358 01ab 4889C7   		movq	%rax, %rdi
 2359 01ae E8000000 		call	memcpy@PLT
 2359      00
 882:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 883:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     // Direct pointers to the new buffer
GAS LISTING /tmp/ccnlqVtp.s 			page 67


 884:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     p += crt->raw.len - len;
 2360              		.loc 2 884 7
 2361 01b3 488B5588 		movq	-120(%rbp), %rdx
 2362              		.loc 2 884 18
 2363 01b7 488B8568 		movq	-152(%rbp), %rax
 2363      FFFFFF
 2364 01be 488B4808 		movq	8(%rax), %rcx
 2365              		.loc 2 884 23
 2366 01c2 488B4580 		movq	-128(%rbp), %rax
 2367 01c6 4829C1   		subq	%rax, %rcx
 2368 01c9 4889C8   		movq	%rcx, %rax
 2369              		.loc 2 884 7
 2370 01cc 4801D0   		addq	%rdx, %rax
 2371 01cf 48894588 		movq	%rax, -120(%rbp)
 885:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     end = crt_end = p + len;
 2372              		.loc 2 885 23
 2373 01d3 488B5588 		movq	-120(%rbp), %rdx
 2374 01d7 488B4580 		movq	-128(%rbp), %rax
 2375              		.loc 2 885 19
 2376 01db 4801D0   		addq	%rdx, %rax
 2377 01de 48894598 		movq	%rax, -104(%rbp)
 2378              		.loc 2 885 9
 2379 01e2 488B4598 		movq	-104(%rbp), %rax
 2380 01e6 48894590 		movq	%rax, -112(%rbp)
 886:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 887:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /*
 888:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      * TBSCertificate  ::=  SEQUENCE  {
 889:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      */
 890:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     crt->tbs.p = p;
 2381              		.loc 2 890 16
 2382 01ea 488B5588 		movq	-120(%rbp), %rdx
 2383 01ee 488B8568 		movq	-152(%rbp), %rax
 2383      FFFFFF
 2384 01f5 48895028 		movq	%rdx, 40(%rax)
 891:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 892:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_asn1_get_tag( &p, end, &len,
 2385              		.loc 2 892 17
 2386 01f9 488D5580 		leaq	-128(%rbp), %rdx
 2387 01fd 488B7590 		movq	-112(%rbp), %rsi
 2388 0201 488D4588 		leaq	-120(%rbp), %rax
 2389 0205 B9300000 		movl	$48, %ecx
 2389      00
 2390 020a 4889C7   		movq	%rax, %rdi
 2391 020d E8000000 		call	mbedtls_asn1_get_tag@PLT
 2391      00
 2392 0212 89857CFF 		movl	%eax, -132(%rbp)
 2392      FFFF
 2393              		.loc 2 892 7
 2394 0218 83BD7CFF 		cmpl	$0, -132(%rbp)
 2394      FFFF00
 2395 021f 741F     		je	.L181
 893:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             MBEDTLS_ASN1_CONSTRUCTED | MBEDTLS_ASN1_SEQUENCE ) ) != 0 )
 894:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 895:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_x509_crt_free( crt );
 2396              		.loc 2 895 9
 2397 0221 488B8568 		movq	-152(%rbp), %rax
 2397      FFFFFF
GAS LISTING /tmp/ccnlqVtp.s 			page 68


 2398 0228 4889C7   		movq	%rax, %rdi
 2399 022b E8000000 		call	mbedtls_x509_crt_free
 2399      00
 896:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_FORMAT + ret );
 2400              		.loc 2 896 49
 2401 0230 8B857CFF 		movl	-132(%rbp), %eax
 2401      FFFF
 2402 0236 2D802100 		subl	$8576, %eax
 2402      00
 2403 023b E95B0600 		jmp	.L204
 2403      00
 2404              	.L181:
 897:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 898:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 899:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     end = p + len;
 2405              		.loc 2 899 13
 2406 0240 488B5588 		movq	-120(%rbp), %rdx
 2407 0244 488B4580 		movq	-128(%rbp), %rax
 2408              		.loc 2 899 9
 2409 0248 4801D0   		addq	%rdx, %rax
 2410 024b 48894590 		movq	%rax, -112(%rbp)
 900:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     crt->tbs.len = end - crt->tbs.p;
 2411              		.loc 2 900 34
 2412 024f 488B8568 		movq	-152(%rbp), %rax
 2412      FFFFFF
 2413 0256 488B4028 		movq	40(%rax), %rax
 2414              		.loc 2 900 24
 2415 025a 488B5590 		movq	-112(%rbp), %rdx
 2416 025e 4829C2   		subq	%rax, %rdx
 2417 0261 4889D0   		movq	%rdx, %rax
 2418 0264 4889C2   		movq	%rax, %rdx
 2419              		.loc 2 900 18
 2420 0267 488B8568 		movq	-152(%rbp), %rax
 2420      FFFFFF
 2421 026e 48895020 		movq	%rdx, 32(%rax)
 901:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 902:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /*
 903:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      * Version  ::=  INTEGER  {  v1(0), v2(1), v3(2)  }
 904:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      *
 905:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      * CertificateSerialNumber  ::=  INTEGER
 906:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      *
 907:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      * signature            AlgorithmIdentifier
 908:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      */
 909:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = x509_get_version(  &p, end, &crt->version  ) ) != 0 ||
 2422              		.loc 2 909 17
 2423 0272 488B8568 		movq	-152(%rbp), %rax
 2423      FFFFFF
 2424 0279 488D5030 		leaq	48(%rax), %rdx
 2425 027d 488B4D90 		movq	-112(%rbp), %rcx
 2426 0281 488D4588 		leaq	-120(%rbp), %rax
 2427 0285 4889CE   		movq	%rcx, %rsi
 2428 0288 4889C7   		movq	%rax, %rdi
 2429 028b E8000000 		call	x509_get_version
 2429      00
 2430 0290 89857CFF 		movl	%eax, -132(%rbp)
 2430      FFFF
 2431              		.loc 2 909 7
GAS LISTING /tmp/ccnlqVtp.s 			page 69


 2432 0296 83BD7CFF 		cmpl	$0, -132(%rbp)
 2432      FFFF00
 2433 029d 7561     		jne	.L182
 910:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ( ret = mbedtls_x509_get_serial(   &p, end, &crt->serial   ) ) != 0 ||
 2434              		.loc 2 910 17 discriminator 1
 2435 029f 488B8568 		movq	-152(%rbp), %rax
 2435      FFFFFF
 2436 02a6 488D5038 		leaq	56(%rax), %rdx
 2437 02aa 488B4D90 		movq	-112(%rbp), %rcx
 2438 02ae 488D4588 		leaq	-120(%rbp), %rax
 2439 02b2 4889CE   		movq	%rcx, %rsi
 2440 02b5 4889C7   		movq	%rax, %rdi
 2441 02b8 E8000000 		call	mbedtls_x509_get_serial@PLT
 2441      00
 2442 02bd 89857CFF 		movl	%eax, -132(%rbp)
 2442      FFFF
 909:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ( ret = mbedtls_x509_get_serial(   &p, end, &crt->serial   ) ) != 0 ||
 2443              		.loc 2 909 69 discriminator 1
 2444 02c3 83BD7CFF 		cmpl	$0, -132(%rbp)
 2444      FFFF00
 2445 02ca 7534     		jne	.L182
 911:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ( ret = mbedtls_x509_get_alg(      &p, end, &crt->sig_oid,
 2446              		.loc 2 911 17
 2447 02cc 488B8568 		movq	-152(%rbp), %rax
 2447      FFFFFF
 2448 02d3 488D7850 		leaq	80(%rax), %rdi
 2449 02d7 488D55A0 		leaq	-96(%rbp), %rdx
 2450 02db 488B7590 		movq	-112(%rbp), %rsi
 2451 02df 488D4588 		leaq	-120(%rbp), %rax
 2452 02e3 4889D1   		movq	%rdx, %rcx
 2453 02e6 4889FA   		movq	%rdi, %rdx
 2454 02e9 4889C7   		movq	%rax, %rdi
 2455 02ec E8000000 		call	mbedtls_x509_get_alg@PLT
 2455      00
 2456 02f1 89857CFF 		movl	%eax, -132(%rbp)
 2456      FFFF
 910:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ( ret = mbedtls_x509_get_serial(   &p, end, &crt->serial   ) ) != 0 ||
 2457              		.loc 2 910 77
 2458 02f7 83BD7CFF 		cmpl	$0, -132(%rbp)
 2458      FFFF00
 2459 02fe 741A     		je	.L183
 2460              	.L182:
 912:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                             &sig_params1 ) ) != 0 )
 913:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 914:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_x509_crt_free( crt );
 2461              		.loc 2 914 9
 2462 0300 488B8568 		movq	-152(%rbp), %rax
 2462      FFFFFF
 2463 0307 4889C7   		movq	%rax, %rdi
 2464 030a E8000000 		call	mbedtls_x509_crt_free
 2464      00
 915:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( ret );
 2465              		.loc 2 915 15
 2466 030f 8B857CFF 		movl	-132(%rbp), %eax
 2466      FFFF
 2467 0315 E9810500 		jmp	.L204
 2467      00
GAS LISTING /tmp/ccnlqVtp.s 			page 70


 2468              	.L183:
 916:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 917:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 918:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( crt->version < 0 || crt->version > 2 )
 2469              		.loc 2 918 12
 2470 031a 488B8568 		movq	-152(%rbp), %rax
 2470      FFFFFF
 2471 0321 8B4030   		movl	48(%rax), %eax
 2472              		.loc 2 918 7
 2473 0324 85C0     		testl	%eax, %eax
 2474 0326 780F     		js	.L184
 2475              		.loc 2 918 32 discriminator 1
 2476 0328 488B8568 		movq	-152(%rbp), %rax
 2476      FFFFFF
 2477 032f 8B4030   		movl	48(%rax), %eax
 2478              		.loc 2 918 26 discriminator 1
 2479 0332 83F802   		cmpl	$2, %eax
 2480 0335 7E19     		jle	.L185
 2481              	.L184:
 919:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 920:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_x509_crt_free( crt );
 2482              		.loc 2 920 9
 2483 0337 488B8568 		movq	-152(%rbp), %rax
 2483      FFFFFF
 2484 033e 4889C7   		movq	%rax, %rdi
 2485 0341 E8000000 		call	mbedtls_x509_crt_free
 2485      00
 921:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_UNKNOWN_VERSION );
 2486              		.loc 2 921 15
 2487 0346 B880DAFF 		movl	$-9600, %eax
 2487      FF
 2488 034b E94B0500 		jmp	.L204
 2488      00
 2489              	.L185:
 922:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 923:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 924:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     crt->version++;
 2490              		.loc 2 924 8
 2491 0350 488B8568 		movq	-152(%rbp), %rax
 2491      FFFFFF
 2492 0357 8B4030   		movl	48(%rax), %eax
 2493              		.loc 2 924 17
 2494 035a 8D5001   		leal	1(%rax), %edx
 2495 035d 488B8568 		movq	-152(%rbp), %rax
 2495      FFFFFF
 2496 0364 895030   		movl	%edx, 48(%rax)
 925:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 926:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_x509_get_sig_alg( &crt->sig_oid, &sig_params1,
 2497              		.loc 2 926 17
 2498 0367 488B8568 		movq	-152(%rbp), %rax
 2498      FFFFFF
 2499 036e 488DB018 		leaq	536(%rax), %rsi
 2499      020000
 2500 0375 488B8568 		movq	-152(%rbp), %rax
 2500      FFFFFF
 2501 037c 488D8814 		leaq	532(%rax), %rcx
 2501      020000
GAS LISTING /tmp/ccnlqVtp.s 			page 71


 2502 0383 488B8568 		movq	-152(%rbp), %rax
 2502      FFFFFF
 2503 038a 488D9010 		leaq	528(%rax), %rdx
 2503      020000
 2504              		.loc 2 926 43
 2505 0391 488B8568 		movq	-152(%rbp), %rax
 2505      FFFFFF
 2506 0398 488D7850 		leaq	80(%rax), %rdi
 2507              		.loc 2 926 17
 2508 039c 488D45A0 		leaq	-96(%rbp), %rax
 2509 03a0 4989F0   		movq	%rsi, %r8
 2510 03a3 4889C6   		movq	%rax, %rsi
 2511 03a6 E8000000 		call	mbedtls_x509_get_sig_alg@PLT
 2511      00
 2512 03ab 89857CFF 		movl	%eax, -132(%rbp)
 2512      FFFF
 2513              		.loc 2 926 7
 2514 03b1 83BD7CFF 		cmpl	$0, -132(%rbp)
 2514      FFFF00
 2515 03b8 741A     		je	.L186
 927:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                   &crt->sig_md, &crt->sig_pk,
 928:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                   &crt->sig_opts ) ) != 0 )
 929:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 930:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_x509_crt_free( crt );
 2516              		.loc 2 930 9
 2517 03ba 488B8568 		movq	-152(%rbp), %rax
 2517      FFFFFF
 2518 03c1 4889C7   		movq	%rax, %rdi
 2519 03c4 E8000000 		call	mbedtls_x509_crt_free
 2519      00
 931:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( ret );
 2520              		.loc 2 931 15
 2521 03c9 8B857CFF 		movl	-132(%rbp), %eax
 2521      FFFF
 2522 03cf E9C70400 		jmp	.L204
 2522      00
 2523              	.L186:
 932:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 933:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 934:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /*
 935:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      * issuer               Name
 936:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      */
 937:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     crt->issuer_raw.p = p;
 2524              		.loc 2 937 23
 2525 03d4 488B5588 		movq	-120(%rbp), %rdx
 2526 03d8 488B8568 		movq	-152(%rbp), %rax
 2526      FFFFFF
 2527 03df 48895078 		movq	%rdx, 120(%rax)
 938:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 939:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_asn1_get_tag( &p, end, &len,
 2528              		.loc 2 939 17
 2529 03e3 488D5580 		leaq	-128(%rbp), %rdx
 2530 03e7 488B7590 		movq	-112(%rbp), %rsi
 2531 03eb 488D4588 		leaq	-120(%rbp), %rax
 2532 03ef B9300000 		movl	$48, %ecx
 2532      00
 2533 03f4 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/ccnlqVtp.s 			page 72


 2534 03f7 E8000000 		call	mbedtls_asn1_get_tag@PLT
 2534      00
 2535 03fc 89857CFF 		movl	%eax, -132(%rbp)
 2535      FFFF
 2536              		.loc 2 939 7
 2537 0402 83BD7CFF 		cmpl	$0, -132(%rbp)
 2537      FFFF00
 2538 0409 741F     		je	.L187
 940:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             MBEDTLS_ASN1_CONSTRUCTED | MBEDTLS_ASN1_SEQUENCE ) ) != 0 )
 941:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 942:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_x509_crt_free( crt );
 2539              		.loc 2 942 9
 2540 040b 488B8568 		movq	-152(%rbp), %rax
 2540      FFFFFF
 2541 0412 4889C7   		movq	%rax, %rdi
 2542 0415 E8000000 		call	mbedtls_x509_crt_free
 2542      00
 943:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_FORMAT + ret );
 2543              		.loc 2 943 49
 2544 041a 8B857CFF 		movl	-132(%rbp), %eax
 2544      FFFF
 2545 0420 2D802100 		subl	$8576, %eax
 2545      00
 2546 0425 E9710400 		jmp	.L204
 2546      00
 2547              	.L187:
 944:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 945:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 946:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_x509_get_name( &p, p + len, &crt->issuer ) ) != 0 )
 2548              		.loc 2 946 17
 2549 042a 488B8568 		movq	-152(%rbp), %rax
 2549      FFFFFF
 2550 0431 488D9098 		leaq	152(%rax), %rdx
 2550      000000
 2551 0438 488B4D88 		movq	-120(%rbp), %rcx
 2552 043c 488B4580 		movq	-128(%rbp), %rax
 2553              		.loc 2 946 46
 2554 0440 4801C1   		addq	%rax, %rcx
 2555              		.loc 2 946 17
 2556 0443 488D4588 		leaq	-120(%rbp), %rax
 2557 0447 4889CE   		movq	%rcx, %rsi
 2558 044a 4889C7   		movq	%rax, %rdi
 2559 044d E8000000 		call	mbedtls_x509_get_name@PLT
 2559      00
 2560 0452 89857CFF 		movl	%eax, -132(%rbp)
 2560      FFFF
 2561              		.loc 2 946 7
 2562 0458 83BD7CFF 		cmpl	$0, -132(%rbp)
 2562      FFFF00
 2563 045f 741A     		je	.L188
 947:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 948:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_x509_crt_free( crt );
 2564              		.loc 2 948 9
 2565 0461 488B8568 		movq	-152(%rbp), %rax
 2565      FFFFFF
 2566 0468 4889C7   		movq	%rax, %rdi
 2567 046b E8000000 		call	mbedtls_x509_crt_free
GAS LISTING /tmp/ccnlqVtp.s 			page 73


 2567      00
 949:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( ret );
 2568              		.loc 2 949 15
 2569 0470 8B857CFF 		movl	-132(%rbp), %eax
 2569      FFFF
 2570 0476 E9200400 		jmp	.L204
 2570      00
 2571              	.L188:
 950:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 951:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 952:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     crt->issuer_raw.len = p - crt->issuer_raw.p;
 2572              		.loc 2 952 29
 2573 047b 488B5588 		movq	-120(%rbp), %rdx
 2574              		.loc 2 952 46
 2575 047f 488B8568 		movq	-152(%rbp), %rax
 2575      FFFFFF
 2576 0486 488B4078 		movq	120(%rax), %rax
 2577              		.loc 2 952 29
 2578 048a 4829C2   		subq	%rax, %rdx
 2579 048d 4889D0   		movq	%rdx, %rax
 2580 0490 4889C2   		movq	%rax, %rdx
 2581              		.loc 2 952 25
 2582 0493 488B8568 		movq	-152(%rbp), %rax
 2582      FFFFFF
 2583 049a 48895070 		movq	%rdx, 112(%rax)
 953:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 954:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /*
 955:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      * Validity ::= SEQUENCE {
 956:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      *      notBefore      Time,
 957:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      *      notAfter       Time }
 958:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      *
 959:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      */
 960:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = x509_get_dates( &p, end, &crt->valid_from,
 2584              		.loc 2 960 17
 2585 049e 488B8568 		movq	-152(%rbp), %rax
 2585      FFFFFF
 2586 04a5 488D8830 		leaq	304(%rax), %rcx
 2586      010000
 2587 04ac 488B8568 		movq	-152(%rbp), %rax
 2587      FFFFFF
 2588 04b3 488D9018 		leaq	280(%rax), %rdx
 2588      010000
 2589 04ba 488B7590 		movq	-112(%rbp), %rsi
 2590 04be 488D4588 		leaq	-120(%rbp), %rax
 2591 04c2 4889C7   		movq	%rax, %rdi
 2592 04c5 E8000000 		call	x509_get_dates
 2592      00
 2593 04ca 89857CFF 		movl	%eax, -132(%rbp)
 2593      FFFF
 2594              		.loc 2 960 7
 2595 04d0 83BD7CFF 		cmpl	$0, -132(%rbp)
 2595      FFFF00
 2596 04d7 741A     		je	.L189
 961:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                          &crt->valid_to ) ) != 0 )
 962:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 963:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_x509_crt_free( crt );
 2597              		.loc 2 963 9
GAS LISTING /tmp/ccnlqVtp.s 			page 74


 2598 04d9 488B8568 		movq	-152(%rbp), %rax
 2598      FFFFFF
 2599 04e0 4889C7   		movq	%rax, %rdi
 2600 04e3 E8000000 		call	mbedtls_x509_crt_free
 2600      00
 964:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( ret );
 2601              		.loc 2 964 15
 2602 04e8 8B857CFF 		movl	-132(%rbp), %eax
 2602      FFFF
 2603 04ee E9A80300 		jmp	.L204
 2603      00
 2604              	.L189:
 965:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 966:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 967:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /*
 968:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      * subject              Name
 969:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      */
 970:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     crt->subject_raw.p = p;
 2605              		.loc 2 970 24
 2606 04f3 488B5588 		movq	-120(%rbp), %rdx
 2607 04f7 488B8568 		movq	-152(%rbp), %rax
 2607      FFFFFF
 2608 04fe 48899090 		movq	%rdx, 144(%rax)
 2608      000000
 971:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 972:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_asn1_get_tag( &p, end, &len,
 2609              		.loc 2 972 17
 2610 0505 488D5580 		leaq	-128(%rbp), %rdx
 2611 0509 488B7590 		movq	-112(%rbp), %rsi
 2612 050d 488D4588 		leaq	-120(%rbp), %rax
 2613 0511 B9300000 		movl	$48, %ecx
 2613      00
 2614 0516 4889C7   		movq	%rax, %rdi
 2615 0519 E8000000 		call	mbedtls_asn1_get_tag@PLT
 2615      00
 2616 051e 89857CFF 		movl	%eax, -132(%rbp)
 2616      FFFF
 2617              		.loc 2 972 7
 2618 0524 83BD7CFF 		cmpl	$0, -132(%rbp)
 2618      FFFF00
 2619 052b 741F     		je	.L190
 973:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             MBEDTLS_ASN1_CONSTRUCTED | MBEDTLS_ASN1_SEQUENCE ) ) != 0 )
 974:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 975:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_x509_crt_free( crt );
 2620              		.loc 2 975 9
 2621 052d 488B8568 		movq	-152(%rbp), %rax
 2621      FFFFFF
 2622 0534 4889C7   		movq	%rax, %rdi
 2623 0537 E8000000 		call	mbedtls_x509_crt_free
 2623      00
 976:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_FORMAT + ret );
 2624              		.loc 2 976 49
 2625 053c 8B857CFF 		movl	-132(%rbp), %eax
 2625      FFFF
 2626 0542 2D802100 		subl	$8576, %eax
 2626      00
 2627 0547 E94F0300 		jmp	.L204
GAS LISTING /tmp/ccnlqVtp.s 			page 75


 2627      00
 2628              	.L190:
 977:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 978:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 979:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( len && ( ret = mbedtls_x509_get_name( &p, p + len, &crt->subject ) ) != 0 )
 2629              		.loc 2 979 9
 2630 054c 488B4580 		movq	-128(%rbp), %rax
 2631              		.loc 2 979 7
 2632 0550 4885C0   		testq	%rax, %rax
 2633 0553 7451     		je	.L191
 2634              		.loc 2 979 24 discriminator 1
 2635 0555 488B8568 		movq	-152(%rbp), %rax
 2635      FFFFFF
 2636 055c 488D90D8 		leaq	216(%rax), %rdx
 2636      000000
 2637 0563 488B4D88 		movq	-120(%rbp), %rcx
 2638 0567 488B4580 		movq	-128(%rbp), %rax
 2639              		.loc 2 979 53 discriminator 1
 2640 056b 4801C1   		addq	%rax, %rcx
 2641              		.loc 2 979 24 discriminator 1
 2642 056e 488D4588 		leaq	-120(%rbp), %rax
 2643 0572 4889CE   		movq	%rcx, %rsi
 2644 0575 4889C7   		movq	%rax, %rdi
 2645 0578 E8000000 		call	mbedtls_x509_get_name@PLT
 2645      00
 2646 057d 89857CFF 		movl	%eax, -132(%rbp)
 2646      FFFF
 2647              		.loc 2 979 13 discriminator 1
 2648 0583 83BD7CFF 		cmpl	$0, -132(%rbp)
 2648      FFFF00
 2649 058a 741A     		je	.L191
 980:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 981:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_x509_crt_free( crt );
 2650              		.loc 2 981 9
 2651 058c 488B8568 		movq	-152(%rbp), %rax
 2651      FFFFFF
 2652 0593 4889C7   		movq	%rax, %rdi
 2653 0596 E8000000 		call	mbedtls_x509_crt_free
 2653      00
 982:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( ret );
 2654              		.loc 2 982 15
 2655 059b 8B857CFF 		movl	-132(%rbp), %eax
 2655      FFFF
 2656 05a1 E9F50200 		jmp	.L204
 2656      00
 2657              	.L191:
 983:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 984:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 985:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     crt->subject_raw.len = p - crt->subject_raw.p;
 2658              		.loc 2 985 30
 2659 05a6 488B5588 		movq	-120(%rbp), %rdx
 2660              		.loc 2 985 48
 2661 05aa 488B8568 		movq	-152(%rbp), %rax
 2661      FFFFFF
 2662 05b1 488B8090 		movq	144(%rax), %rax
 2662      000000
 2663              		.loc 2 985 30
GAS LISTING /tmp/ccnlqVtp.s 			page 76


 2664 05b8 4829C2   		subq	%rax, %rdx
 2665 05bb 4889D0   		movq	%rdx, %rax
 2666 05be 4889C2   		movq	%rax, %rdx
 2667              		.loc 2 985 26
 2668 05c1 488B8568 		movq	-152(%rbp), %rax
 2668      FFFFFF
 2669 05c8 48899088 		movq	%rdx, 136(%rax)
 2669      000000
 986:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 987:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /*
 988:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      * SubjectPublicKeyInfo
 989:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      */
 990:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_pk_parse_subpubkey( &p, end, &crt->pk ) ) != 0 )
 2670              		.loc 2 990 17
 2671 05cf 488B8568 		movq	-152(%rbp), %rax
 2671      FFFFFF
 2672 05d6 488D9048 		leaq	328(%rax), %rdx
 2672      010000
 2673 05dd 488B4D90 		movq	-112(%rbp), %rcx
 2674 05e1 488D4588 		leaq	-120(%rbp), %rax
 2675 05e5 4889CE   		movq	%rcx, %rsi
 2676 05e8 4889C7   		movq	%rax, %rdi
 2677 05eb E8000000 		call	mbedtls_pk_parse_subpubkey@PLT
 2677      00
 2678 05f0 89857CFF 		movl	%eax, -132(%rbp)
 2678      FFFF
 2679              		.loc 2 990 7
 2680 05f6 83BD7CFF 		cmpl	$0, -132(%rbp)
 2680      FFFF00
 2681 05fd 741A     		je	.L192
 991:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 992:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_x509_crt_free( crt );
 2682              		.loc 2 992 9
 2683 05ff 488B8568 		movq	-152(%rbp), %rax
 2683      FFFFFF
 2684 0606 4889C7   		movq	%rax, %rdi
 2685 0609 E8000000 		call	mbedtls_x509_crt_free
 2685      00
 993:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( ret );
 2686              		.loc 2 993 15
 2687 060e 8B857CFF 		movl	-132(%rbp), %eax
 2687      FFFF
 2688 0614 E9820200 		jmp	.L204
 2688      00
 2689              	.L192:
 994:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 995:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 996:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /*
 997:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      *  issuerUniqueID  [1]  IMPLICIT UniqueIdentifier OPTIONAL,
 998:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      *                       -- If present, version shall be v2 or v3
 999:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      *  subjectUniqueID [2]  IMPLICIT UniqueIdentifier OPTIONAL,
1000:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      *                       -- If present, version shall be v2 or v3
1001:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      *  extensions      [3]  EXPLICIT Extensions OPTIONAL
1002:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      *                       -- If present, version shall be v3
1003:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      */
1004:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( crt->version == 2 || crt->version == 3 )
 2690              		.loc 2 1004 12
GAS LISTING /tmp/ccnlqVtp.s 			page 77


 2691 0619 488B8568 		movq	-152(%rbp), %rax
 2691      FFFFFF
 2692 0620 8B4030   		movl	48(%rax), %eax
 2693              		.loc 2 1004 7
 2694 0623 83F802   		cmpl	$2, %eax
 2695 0626 740F     		je	.L193
 2696              		.loc 2 1004 33 discriminator 1
 2697 0628 488B8568 		movq	-152(%rbp), %rax
 2697      FFFFFF
 2698 062f 8B4030   		movl	48(%rax), %eax
 2699              		.loc 2 1004 27 discriminator 1
 2700 0632 83F803   		cmpl	$3, %eax
 2701 0635 754C     		jne	.L194
 2702              	.L193:
1005:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1006:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ret = x509_get_uid( &p, end, &crt->issuer_id,  1 );
 2703              		.loc 2 1006 15
 2704 0637 488B8568 		movq	-152(%rbp), %rax
 2704      FFFFFF
 2705 063e 488D9058 		leaq	344(%rax), %rdx
 2705      010000
 2706 0645 488B7590 		movq	-112(%rbp), %rsi
 2707 0649 488D4588 		leaq	-120(%rbp), %rax
 2708 064d B9010000 		movl	$1, %ecx
 2708      00
 2709 0652 4889C7   		movq	%rax, %rdi
 2710 0655 E8000000 		call	x509_get_uid
 2710      00
 2711 065a 89857CFF 		movl	%eax, -132(%rbp)
 2711      FFFF
1007:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ret != 0 )
 2712              		.loc 2 1007 11
 2713 0660 83BD7CFF 		cmpl	$0, -132(%rbp)
 2713      FFFF00
 2714 0667 741A     		je	.L194
1008:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
1009:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             mbedtls_x509_crt_free( crt );
 2715              		.loc 2 1009 13
 2716 0669 488B8568 		movq	-152(%rbp), %rax
 2716      FFFFFF
 2717 0670 4889C7   		movq	%rax, %rdi
 2718 0673 E8000000 		call	mbedtls_x509_crt_free
 2718      00
1010:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( ret );
 2719              		.loc 2 1010 19
 2720 0678 8B857CFF 		movl	-132(%rbp), %eax
 2720      FFFF
 2721 067e E9180200 		jmp	.L204
 2721      00
 2722              	.L194:
1011:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
1012:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1013:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1014:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( crt->version == 2 || crt->version == 3 )
 2723              		.loc 2 1014 12
 2724 0683 488B8568 		movq	-152(%rbp), %rax
 2724      FFFFFF
GAS LISTING /tmp/ccnlqVtp.s 			page 78


 2725 068a 8B4030   		movl	48(%rax), %eax
 2726              		.loc 2 1014 7
 2727 068d 83F802   		cmpl	$2, %eax
 2728 0690 740F     		je	.L195
 2729              		.loc 2 1014 33 discriminator 1
 2730 0692 488B8568 		movq	-152(%rbp), %rax
 2730      FFFFFF
 2731 0699 8B4030   		movl	48(%rax), %eax
 2732              		.loc 2 1014 27 discriminator 1
 2733 069c 83F803   		cmpl	$3, %eax
 2734 069f 754C     		jne	.L196
 2735              	.L195:
1015:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1016:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ret = x509_get_uid( &p, end, &crt->subject_id,  2 );
 2736              		.loc 2 1016 15
 2737 06a1 488B8568 		movq	-152(%rbp), %rax
 2737      FFFFFF
 2738 06a8 488D9070 		leaq	368(%rax), %rdx
 2738      010000
 2739 06af 488B7590 		movq	-112(%rbp), %rsi
 2740 06b3 488D4588 		leaq	-120(%rbp), %rax
 2741 06b7 B9020000 		movl	$2, %ecx
 2741      00
 2742 06bc 4889C7   		movq	%rax, %rdi
 2743 06bf E8000000 		call	x509_get_uid
 2743      00
 2744 06c4 89857CFF 		movl	%eax, -132(%rbp)
 2744      FFFF
1017:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ret != 0 )
 2745              		.loc 2 1017 11
 2746 06ca 83BD7CFF 		cmpl	$0, -132(%rbp)
 2746      FFFF00
 2747 06d1 741A     		je	.L196
1018:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
1019:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             mbedtls_x509_crt_free( crt );
 2748              		.loc 2 1019 13
 2749 06d3 488B8568 		movq	-152(%rbp), %rax
 2749      FFFFFF
 2750 06da 4889C7   		movq	%rax, %rdi
 2751 06dd E8000000 		call	mbedtls_x509_crt_free
 2751      00
1020:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( ret );
 2752              		.loc 2 1020 19
 2753 06e2 8B857CFF 		movl	-132(%rbp), %eax
 2753      FFFF
 2754 06e8 E9AE0100 		jmp	.L204
 2754      00
 2755              	.L196:
1021:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
1022:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1023:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1024:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if !defined(MBEDTLS_X509_ALLOW_EXTENSIONS_NON_V3)
1025:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( crt->version == 3 )
 2756              		.loc 2 1025 12
 2757 06ed 488B8568 		movq	-152(%rbp), %rax
 2757      FFFFFF
 2758 06f4 8B4030   		movl	48(%rax), %eax
GAS LISTING /tmp/ccnlqVtp.s 			page 79


 2759              		.loc 2 1025 7
 2760 06f7 83F803   		cmpl	$3, %eax
 2761 06fa 7543     		jne	.L197
1026:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
1027:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1028:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ret = x509_get_crt_ext( &p, end, crt );
 2762              		.loc 2 1028 15
 2763 06fc 488B9568 		movq	-152(%rbp), %rdx
 2763      FFFFFF
 2764 0703 488B4D90 		movq	-112(%rbp), %rcx
 2765 0707 488D4588 		leaq	-120(%rbp), %rax
 2766 070b 4889CE   		movq	%rcx, %rsi
 2767 070e 4889C7   		movq	%rax, %rdi
 2768 0711 E8000000 		call	x509_get_crt_ext
 2768      00
 2769 0716 89857CFF 		movl	%eax, -132(%rbp)
 2769      FFFF
1029:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ret != 0 )
 2770              		.loc 2 1029 11
 2771 071c 83BD7CFF 		cmpl	$0, -132(%rbp)
 2771      FFFF00
 2772 0723 741A     		je	.L197
1030:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
1031:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             mbedtls_x509_crt_free( crt );
 2773              		.loc 2 1031 13
 2774 0725 488B8568 		movq	-152(%rbp), %rax
 2774      FFFFFF
 2775 072c 4889C7   		movq	%rax, %rdi
 2776 072f E8000000 		call	mbedtls_x509_crt_free
 2776      00
1032:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( ret );
 2777              		.loc 2 1032 19
 2778 0734 8B857CFF 		movl	-132(%rbp), %eax
 2778      FFFF
 2779 073a E95C0100 		jmp	.L204
 2779      00
 2780              	.L197:
1033:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
1034:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1035:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1036:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( p != end )
 2781              		.loc 2 1036 11
 2782 073f 488B4588 		movq	-120(%rbp), %rax
 2783              		.loc 2 1036 7
 2784 0743 48394590 		cmpq	%rax, -112(%rbp)
 2785 0747 7419     		je	.L198
1037:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1038:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_x509_crt_free( crt );
 2786              		.loc 2 1038 9
 2787 0749 488B8568 		movq	-152(%rbp), %rax
 2787      FFFFFF
 2788 0750 4889C7   		movq	%rax, %rdi
 2789 0753 E8000000 		call	mbedtls_x509_crt_free
 2789      00
1039:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_FORMAT +
 2790              		.loc 2 1039 15
 2791 0758 B81ADEFF 		movl	$-8678, %eax
GAS LISTING /tmp/ccnlqVtp.s 			page 80


 2791      FF
 2792 075d E9390100 		jmp	.L204
 2792      00
 2793              	.L198:
1040:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 MBEDTLS_ERR_ASN1_LENGTH_MISMATCH );
1041:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1042:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1043:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     end = crt_end;
 2794              		.loc 2 1043 9
 2795 0762 488B4598 		movq	-104(%rbp), %rax
 2796 0766 48894590 		movq	%rax, -112(%rbp)
1044:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1045:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /*
1046:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      *  }
1047:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      *  -- end of TBSCertificate
1048:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      *
1049:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      *  signatureAlgorithm   AlgorithmIdentifier,
1050:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      *  signatureValue       BIT STRING
1051:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      */
1052:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_x509_get_alg( &p, end, &sig_oid2, &sig_params2 ) ) != 0 )
 2797              		.loc 2 1052 17
 2798 076a 488D4DC0 		leaq	-64(%rbp), %rcx
 2799 076e 488D55E0 		leaq	-32(%rbp), %rdx
 2800 0772 488B7590 		movq	-112(%rbp), %rsi
 2801 0776 488D4588 		leaq	-120(%rbp), %rax
 2802 077a 4889C7   		movq	%rax, %rdi
 2803 077d E8000000 		call	mbedtls_x509_get_alg@PLT
 2803      00
 2804 0782 89857CFF 		movl	%eax, -132(%rbp)
 2804      FFFF
 2805              		.loc 2 1052 7
 2806 0788 83BD7CFF 		cmpl	$0, -132(%rbp)
 2806      FFFF00
 2807 078f 741A     		je	.L199
1053:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1054:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_x509_crt_free( crt );
 2808              		.loc 2 1054 9
 2809 0791 488B8568 		movq	-152(%rbp), %rax
 2809      FFFFFF
 2810 0798 4889C7   		movq	%rax, %rdi
 2811 079b E8000000 		call	mbedtls_x509_crt_free
 2811      00
1055:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( ret );
 2812              		.loc 2 1055 15
 2813 07a0 8B857CFF 		movl	-132(%rbp), %eax
 2813      FFFF
 2814 07a6 E9F00000 		jmp	.L204
 2814      00
 2815              	.L199:
1056:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1057:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1058:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( crt->sig_oid.len != sig_oid2.len ||
 2816              		.loc 2 1058 21
 2817 07ab 488B8568 		movq	-152(%rbp), %rax
 2817      FFFFFF
 2818 07b2 488B5058 		movq	88(%rax), %rdx
 2819              		.loc 2 1058 37
GAS LISTING /tmp/ccnlqVtp.s 			page 81


 2820 07b6 488B45E8 		movq	-24(%rbp), %rax
 2821              		.loc 2 1058 7
 2822 07ba 4839C2   		cmpq	%rax, %rdx
 2823 07bd 755A     		jne	.L200
1059:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         memcmp( crt->sig_oid.p, sig_oid2.p, crt->sig_oid.len ) != 0 ||
 2824              		.loc 2 1059 9 discriminator 1
 2825 07bf 488B8568 		movq	-152(%rbp), %rax
 2825      FFFFFF
 2826 07c6 488B5058 		movq	88(%rax), %rdx
 2827              		.loc 2 1059 41 discriminator 1
 2828 07ca 488B4DF0 		movq	-16(%rbp), %rcx
 2829              		.loc 2 1059 29 discriminator 1
 2830 07ce 488B8568 		movq	-152(%rbp), %rax
 2830      FFFFFF
 2831 07d5 488B4060 		movq	96(%rax), %rax
 2832              		.loc 2 1059 9 discriminator 1
 2833 07d9 4889CE   		movq	%rcx, %rsi
 2834 07dc 4889C7   		movq	%rax, %rdi
 2835 07df E8000000 		call	memcmp@PLT
 2835      00
1058:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         memcmp( crt->sig_oid.p, sig_oid2.p, crt->sig_oid.len ) != 0 ||
 2836              		.loc 2 1058 42 discriminator 1
 2837 07e4 85C0     		testl	%eax, %eax
 2838 07e6 7531     		jne	.L200
1060:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         sig_params1.len != sig_params2.len ||
 2839              		.loc 2 1060 20
 2840 07e8 488B55A8 		movq	-88(%rbp), %rdx
 2841              		.loc 2 1060 39
 2842 07ec 488B45C8 		movq	-56(%rbp), %rax
1059:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         memcmp( crt->sig_oid.p, sig_oid2.p, crt->sig_oid.len ) != 0 ||
 2843              		.loc 2 1059 69
 2844 07f0 4839C2   		cmpq	%rax, %rdx
 2845 07f3 7524     		jne	.L200
1061:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ( sig_params1.len != 0 &&
 2846              		.loc 2 1061 22
 2847 07f5 488B45A8 		movq	-88(%rbp), %rax
1060:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         sig_params1.len != sig_params2.len ||
 2848              		.loc 2 1060 44
 2849 07f9 4885C0   		testq	%rax, %rax
 2850 07fc 7431     		je	.L201
1062:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****           memcmp( sig_params1.p, sig_params2.p, sig_params1.len ) != 0 ) )
 2851              		.loc 2 1062 11
 2852 07fe 488B55A8 		movq	-88(%rbp), %rdx
 2853              		.loc 2 1062 45
 2854 0802 488B4DD0 		movq	-48(%rbp), %rcx
 2855              		.loc 2 1062 30
 2856 0806 488B45B0 		movq	-80(%rbp), %rax
 2857              		.loc 2 1062 11
 2858 080a 4889CE   		movq	%rcx, %rsi
 2859 080d 4889C7   		movq	%rax, %rdi
 2860 0810 E8000000 		call	memcmp@PLT
 2860      00
1061:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ( sig_params1.len != 0 &&
 2861              		.loc 2 1061 32
 2862 0815 85C0     		testl	%eax, %eax
 2863 0817 7416     		je	.L201
 2864              	.L200:
GAS LISTING /tmp/ccnlqVtp.s 			page 82


1063:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1064:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_x509_crt_free( crt );
 2865              		.loc 2 1064 9
 2866 0819 488B8568 		movq	-152(%rbp), %rax
 2866      FFFFFF
 2867 0820 4889C7   		movq	%rax, %rdi
 2868 0823 E8000000 		call	mbedtls_x509_crt_free
 2868      00
1065:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_SIG_MISMATCH );
 2869              		.loc 2 1065 15
 2870 0828 B880D9FF 		movl	$-9856, %eax
 2870      FF
 2871 082d EB6C     		jmp	.L204
 2872              	.L201:
1066:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1067:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1068:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_x509_get_sig( &p, end, &crt->sig ) ) != 0 )
 2873              		.loc 2 1068 17
 2874 082f 488B8568 		movq	-152(%rbp), %rax
 2874      FFFFFF
 2875 0836 488D90F8 		leaq	504(%rax), %rdx
 2875      010000
 2876 083d 488B4D90 		movq	-112(%rbp), %rcx
 2877 0841 488D4588 		leaq	-120(%rbp), %rax
 2878 0845 4889CE   		movq	%rcx, %rsi
 2879 0848 4889C7   		movq	%rax, %rdi
 2880 084b E8000000 		call	mbedtls_x509_get_sig@PLT
 2880      00
 2881 0850 89857CFF 		movl	%eax, -132(%rbp)
 2881      FFFF
 2882              		.loc 2 1068 7
 2883 0856 83BD7CFF 		cmpl	$0, -132(%rbp)
 2883      FFFF00
 2884 085d 7417     		je	.L202
1069:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1070:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_x509_crt_free( crt );
 2885              		.loc 2 1070 9
 2886 085f 488B8568 		movq	-152(%rbp), %rax
 2886      FFFFFF
 2887 0866 4889C7   		movq	%rax, %rdi
 2888 0869 E8000000 		call	mbedtls_x509_crt_free
 2888      00
1071:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( ret );
 2889              		.loc 2 1071 15
 2890 086e 8B857CFF 		movl	-132(%rbp), %eax
 2890      FFFF
 2891 0874 EB25     		jmp	.L204
 2892              	.L202:
1072:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1073:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1074:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( p != end )
 2893              		.loc 2 1074 11
 2894 0876 488B4588 		movq	-120(%rbp), %rax
 2895              		.loc 2 1074 7
 2896 087a 48394590 		cmpq	%rax, -112(%rbp)
 2897 087e 7416     		je	.L203
1075:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
GAS LISTING /tmp/ccnlqVtp.s 			page 83


1076:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_x509_crt_free( crt );
 2898              		.loc 2 1076 9
 2899 0880 488B8568 		movq	-152(%rbp), %rax
 2899      FFFFFF
 2900 0887 4889C7   		movq	%rax, %rdi
 2901 088a E8000000 		call	mbedtls_x509_crt_free
 2901      00
1077:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_INVALID_FORMAT +
 2902              		.loc 2 1077 15
 2903 088f B81ADEFF 		movl	$-8678, %eax
 2903      FF
 2904 0894 EB05     		jmp	.L204
 2905              	.L203:
1078:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 MBEDTLS_ERR_ASN1_LENGTH_MISMATCH );
1079:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1080:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1081:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 2906              		.loc 2 1081 11
 2907 0896 B8000000 		movl	$0, %eax
 2907      00
 2908              	.L204:
1082:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 2909              		.loc 2 1082 1 discriminator 1
 2910 089b 488B4DF8 		movq	-8(%rbp), %rcx
 2911 089f 6448330C 		xorq	%fs:40, %rcx
 2911      25280000 
 2911      00
 2912 08a8 7405     		je	.L205
 2913              		.loc 2 1082 1 is_stmt 0
 2914 08aa E8000000 		call	__stack_chk_fail@PLT
 2914      00
 2915              	.L205:
 2916 08af C9       		leave
 2917              	.LCFI56:
 2918              		.cfi_def_cfa 7, 8
 2919 08b0 C3       		ret
 2920              		.cfi_endproc
 2921              	.LFE33:
 2923              		.section	.text.mbedtls_x509_crt_parse_der,"ax",@progbits
 2924              		.globl	mbedtls_x509_crt_parse_der
 2926              	mbedtls_x509_crt_parse_der:
 2927              	.LFB34:
1083:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1084:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
1085:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Parse one X.509 certificate in DER format from a buffer and add them to a
1086:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * chained list
1087:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
1088:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** int mbedtls_x509_crt_parse_der( mbedtls_x509_crt *chain, const unsigned char *buf,
1089:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         size_t buflen )
1090:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 2928              		.loc 2 1090 1 is_stmt 1
 2929              		.cfi_startproc
 2930 0000 F30F1EFA 		endbr64
 2931 0004 55       		pushq	%rbp
 2932              	.LCFI57:
 2933              		.cfi_def_cfa_offset 16
 2934              		.cfi_offset 6, -16
GAS LISTING /tmp/ccnlqVtp.s 			page 84


 2935 0005 4889E5   		movq	%rsp, %rbp
 2936              	.LCFI58:
 2937              		.cfi_def_cfa_register 6
 2938 0008 4883EC40 		subq	$64, %rsp
 2939 000c 48897DD8 		movq	%rdi, -40(%rbp)
 2940 0010 488975D0 		movq	%rsi, -48(%rbp)
 2941 0014 488955C8 		movq	%rdx, -56(%rbp)
 2942              		.loc 2 1090 1
 2943 0018 64488B04 		movq	%fs:40, %rax
 2943      25280000 
 2943      00
 2944 0021 488945F8 		movq	%rax, -8(%rbp)
 2945 0025 31C0     		xorl	%eax, %eax
1091:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int ret;
1092:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_x509_crt *crt = chain, *prev = NULL;
 2946              		.loc 2 1092 23
 2947 0027 488B45D8 		movq	-40(%rbp), %rax
 2948 002b 488945E8 		movq	%rax, -24(%rbp)
 2949              		.loc 2 1092 37
 2950 002f 48C745F0 		movq	$0, -16(%rbp)
 2950      00000000 
1093:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1094:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /*
1095:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      * Check for valid input
1096:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      */
1097:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( crt == NULL || buf == NULL )
 2951              		.loc 2 1097 7
 2952 0037 48837DE8 		cmpq	$0, -24(%rbp)
 2952      00
 2953 003c 7407     		je	.L207
 2954              		.loc 2 1097 21 discriminator 1
 2955 003e 48837DD0 		cmpq	$0, -48(%rbp)
 2955      00
 2956 0043 7521     		jne	.L210
 2957              	.L207:
1098:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_BAD_INPUT_DATA );
 2958              		.loc 2 1098 15
 2959 0045 B800D8FF 		movl	$-10240, %eax
 2959      FF
 2960 004a E9010100 		jmp	.L209
 2960      00
 2961              	.L212:
1099:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1100:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     while( crt->version != 0 && crt->next != NULL )
1101:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1102:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         prev = crt;
 2962              		.loc 2 1102 14
 2963 004f 488B45E8 		movq	-24(%rbp), %rax
 2964 0053 488945F0 		movq	%rax, -16(%rbp)
1103:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         crt = crt->next;
 2965              		.loc 2 1103 13
 2966 0057 488B45E8 		movq	-24(%rbp), %rax
 2967 005b 488B8020 		movq	544(%rax), %rax
 2967      020000
 2968 0062 488945E8 		movq	%rax, -24(%rbp)
 2969              	.L210:
1100:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
GAS LISTING /tmp/ccnlqVtp.s 			page 85


 2970              		.loc 2 1100 15
 2971 0066 488B45E8 		movq	-24(%rbp), %rax
 2972 006a 8B4030   		movl	48(%rax), %eax
1100:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 2973              		.loc 2 1100 10
 2974 006d 85C0     		testl	%eax, %eax
 2975 006f 7410     		je	.L211
1100:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 2976              		.loc 2 1100 36 discriminator 1
 2977 0071 488B45E8 		movq	-24(%rbp), %rax
 2978 0075 488B8020 		movq	544(%rax), %rax
 2978      020000
1100:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 2979              		.loc 2 1100 30 discriminator 1
 2980 007c 4885C0   		testq	%rax, %rax
 2981 007f 75CE     		jne	.L212
 2982              	.L211:
1104:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1105:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1106:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /*
1107:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      * Add new certificate on the end of the chain if needed.
1108:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      */
1109:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( crt->version != 0 && crt->next == NULL )
 2983              		.loc 2 1109 12
 2984 0081 488B45E8 		movq	-24(%rbp), %rax
 2985 0085 8B4030   		movl	48(%rax), %eax
 2986              		.loc 2 1109 7
 2987 0088 85C0     		testl	%eax, %eax
 2988 008a 746E     		je	.L213
 2989              		.loc 2 1109 33 discriminator 1
 2990 008c 488B45E8 		movq	-24(%rbp), %rax
 2991 0090 488B8020 		movq	544(%rax), %rax
 2991      020000
 2992              		.loc 2 1109 27 discriminator 1
 2993 0097 4885C0   		testq	%rax, %rax
 2994 009a 755E     		jne	.L213
1110:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1111:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         crt->next = mbedtls_calloc( 1, sizeof( mbedtls_x509_crt ) );
 2995              		.loc 2 1111 21
 2996 009c BE280200 		movl	$552, %esi
 2996      00
 2997 00a1 BF010000 		movl	$1, %edi
 2997      00
 2998 00a6 E8000000 		call	mbedtls_calloc@PLT
 2998      00
 2999              		.loc 2 1111 19
 3000 00ab 488B55E8 		movq	-24(%rbp), %rdx
 3001 00af 48898220 		movq	%rax, 544(%rdx)
 3001      020000
1112:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1113:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( crt->next == NULL )
 3002              		.loc 2 1113 16
 3003 00b6 488B45E8 		movq	-24(%rbp), %rax
 3004 00ba 488B8020 		movq	544(%rax), %rax
 3004      020000
 3005              		.loc 2 1113 11
 3006 00c1 4885C0   		testq	%rax, %rax
GAS LISTING /tmp/ccnlqVtp.s 			page 86


 3007 00c4 750A     		jne	.L214
1114:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( MBEDTLS_ERR_X509_ALLOC_FAILED );
 3008              		.loc 2 1114 19
 3009 00c6 B880D7FF 		movl	$-10368, %eax
 3009      FF
 3010 00cb E9800000 		jmp	.L209
 3010      00
 3011              	.L214:
1115:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1116:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         prev = crt;
 3012              		.loc 2 1116 14
 3013 00d0 488B45E8 		movq	-24(%rbp), %rax
 3014 00d4 488945F0 		movq	%rax, -16(%rbp)
1117:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_x509_crt_init( crt->next );
 3015              		.loc 2 1117 35
 3016 00d8 488B45E8 		movq	-24(%rbp), %rax
 3017 00dc 488B8020 		movq	544(%rax), %rax
 3017      020000
 3018              		.loc 2 1117 9
 3019 00e3 4889C7   		movq	%rax, %rdi
 3020 00e6 E8000000 		call	mbedtls_x509_crt_init
 3020      00
1118:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         crt = crt->next;
 3021              		.loc 2 1118 13
 3022 00eb 488B45E8 		movq	-24(%rbp), %rax
 3023 00ef 488B8020 		movq	544(%rax), %rax
 3023      020000
 3024 00f6 488945E8 		movq	%rax, -24(%rbp)
 3025              	.L213:
1119:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1120:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1121:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = x509_crt_parse_der_core( crt, buf, buflen ) ) != 0 )
 3026              		.loc 2 1121 17
 3027 00fa 488B55C8 		movq	-56(%rbp), %rdx
 3028 00fe 488B4DD0 		movq	-48(%rbp), %rcx
 3029 0102 488B45E8 		movq	-24(%rbp), %rax
 3030 0106 4889CE   		movq	%rcx, %rsi
 3031 0109 4889C7   		movq	%rax, %rdi
 3032 010c E8000000 		call	x509_crt_parse_der_core
 3032      00
 3033 0111 8945E4   		movl	%eax, -28(%rbp)
 3034              		.loc 2 1121 7
 3035 0114 837DE400 		cmpl	$0, -28(%rbp)
 3036 0118 7431     		je	.L215
1122:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1123:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( prev )
 3037              		.loc 2 1123 11
 3038 011a 48837DF0 		cmpq	$0, -16(%rbp)
 3038      00
 3039 011f 740F     		je	.L216
1124:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             prev->next = NULL;
 3040              		.loc 2 1124 24
 3041 0121 488B45F0 		movq	-16(%rbp), %rax
 3042 0125 48C78020 		movq	$0, 544(%rax)
 3042      02000000 
 3042      000000
 3043              	.L216:
GAS LISTING /tmp/ccnlqVtp.s 			page 87


1125:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1126:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( crt != chain )
 3044              		.loc 2 1126 11
 3045 0130 488B45E8 		movq	-24(%rbp), %rax
 3046 0134 483B45D8 		cmpq	-40(%rbp), %rax
 3047 0138 740C     		je	.L217
1127:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             mbedtls_free( crt );
 3048              		.loc 2 1127 13
 3049 013a 488B45E8 		movq	-24(%rbp), %rax
 3050 013e 4889C7   		movq	%rax, %rdi
 3051 0141 E8000000 		call	mbedtls_free@PLT
 3051      00
 3052              	.L217:
1128:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1129:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( ret );
 3053              		.loc 2 1129 15
 3054 0146 8B45E4   		movl	-28(%rbp), %eax
 3055 0149 EB05     		jmp	.L209
 3056              	.L215:
1130:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1131:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1132:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 3057              		.loc 2 1132 11
 3058 014b B8000000 		movl	$0, %eax
 3058      00
 3059              	.L209:
1133:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 3060              		.loc 2 1133 1
 3061 0150 488B4DF8 		movq	-8(%rbp), %rcx
 3062 0154 6448330C 		xorq	%fs:40, %rcx
 3062      25280000 
 3062      00
 3063 015d 7405     		je	.L218
 3064 015f E8000000 		call	__stack_chk_fail@PLT
 3064      00
 3065              	.L218:
 3066 0164 C9       		leave
 3067              	.LCFI59:
 3068              		.cfi_def_cfa 7, 8
 3069 0165 C3       		ret
 3070              		.cfi_endproc
 3071              	.LFE34:
 3073              		.section	.rodata
 3074              	.LC0:
 3075 0000 2D2D2D2D 		.string	"-----BEGIN CERTIFICATE-----"
 3075      2D424547 
 3075      494E2043 
 3075      45525449 
 3075      46494341 
 3076              	.LC1:
 3077 001c 2D2D2D2D 		.string	"-----END CERTIFICATE-----"
 3077      2D454E44 
 3077      20434552 
 3077      54494649 
 3077      43415445 
 3078              		.section	.text.mbedtls_x509_crt_parse,"ax",@progbits
 3079              		.globl	mbedtls_x509_crt_parse
GAS LISTING /tmp/ccnlqVtp.s 			page 88


 3081              	mbedtls_x509_crt_parse:
 3082              	.LFB35:
1134:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1135:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
1136:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Parse one or more PEM certificates from a buffer and add them to the chained
1137:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * list
1138:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
1139:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** int mbedtls_x509_crt_parse( mbedtls_x509_crt *chain, const unsigned char *buf, size_t buflen )
1140:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 3083              		.loc 2 1140 1
 3084              		.cfi_startproc
 3085 0000 F30F1EFA 		endbr64
 3086 0004 55       		pushq	%rbp
 3087              	.LCFI60:
 3088              		.cfi_def_cfa_offset 16
 3089              		.cfi_offset 6, -16
 3090 0005 4889E5   		movq	%rsp, %rbp
 3091              	.LCFI61:
 3092              		.cfi_def_cfa_register 6
 3093 0008 4883EC60 		subq	$96, %rsp
 3094 000c 48897DB8 		movq	%rdi, -72(%rbp)
 3095 0010 488975B0 		movq	%rsi, -80(%rbp)
 3096 0014 488955A8 		movq	%rdx, -88(%rbp)
 3097              		.loc 2 1140 1
 3098 0018 64488B04 		movq	%fs:40, %rax
 3098      25280000 
 3098      00
 3099 0021 488945F8 		movq	%rax, -8(%rbp)
 3100 0025 31C0     		xorl	%eax, %eax
1141:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_PEM_PARSE_C)
1142:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int success = 0, first_error = 0, total_failed = 0;
 3101              		.loc 2 1142 9
 3102 0027 C745C400 		movl	$0, -60(%rbp)
 3102      000000
 3103              		.loc 2 1142 22
 3104 002e C745C800 		movl	$0, -56(%rbp)
 3104      000000
 3105              		.loc 2 1142 39
 3106 0035 C745CC00 		movl	$0, -52(%rbp)
 3106      000000
1143:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int buf_format = MBEDTLS_X509_FORMAT_DER;
 3107              		.loc 2 1143 9
 3108 003c C745D001 		movl	$1, -48(%rbp)
 3108      000000
1144:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
1145:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1146:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /*
1147:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      * Check for valid input
1148:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      */
1149:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( chain == NULL || buf == NULL )
 3109              		.loc 2 1149 7
 3110 0043 48837DB8 		cmpq	$0, -72(%rbp)
 3110      00
 3111 0048 7407     		je	.L220
 3112              		.loc 2 1149 23 discriminator 1
 3113 004a 48837DB0 		cmpq	$0, -80(%rbp)
 3113      00
GAS LISTING /tmp/ccnlqVtp.s 			page 89


 3114 004f 750A     		jne	.L221
 3115              	.L220:
1150:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_BAD_INPUT_DATA );
 3116              		.loc 2 1150 15
 3117 0051 B800D8FF 		movl	$-10240, %eax
 3117      FF
 3118 0056 E9920100 		jmp	.L222
 3118      00
 3119              	.L221:
1151:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1152:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /*
1153:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      * Determine buffer content. Buffer contains either one DER certificate or
1154:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      * one or more PEM certificates.
1155:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      */
1156:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_PEM_PARSE_C)
1157:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( buflen != 0 && buf[buflen - 1] == '\0' &&
 3120              		.loc 2 1157 7
 3121 005b 48837DA8 		cmpq	$0, -88(%rbp)
 3121      00
 3122 0060 7435     		je	.L223
 3123              		.loc 2 1157 27 discriminator 1
 3124 0062 488B45A8 		movq	-88(%rbp), %rax
 3125 0066 488D50FF 		leaq	-1(%rax), %rdx
 3126 006a 488B45B0 		movq	-80(%rbp), %rax
 3127 006e 4801D0   		addq	%rdx, %rax
 3128 0071 0FB600   		movzbl	(%rax), %eax
 3129              		.loc 2 1157 21 discriminator 1
 3130 0074 84C0     		testb	%al, %al
 3131 0076 751F     		jne	.L223
1158:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         strstr( (const char *) buf, "-----BEGIN CERTIFICATE-----" ) != NULL )
 3132              		.loc 2 1158 9 discriminator 2
 3133 0078 488B45B0 		movq	-80(%rbp), %rax
 3134 007c 488D3500 		leaq	.LC0(%rip), %rsi
 3134      000000
 3135 0083 4889C7   		movq	%rax, %rdi
 3136 0086 E8000000 		call	strstr@PLT
 3136      00
1157:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         strstr( (const char *) buf, "-----BEGIN CERTIFICATE-----" ) != NULL )
 3137              		.loc 2 1157 48 discriminator 2
 3138 008b 4885C0   		testq	%rax, %rax
 3139 008e 7407     		je	.L223
1159:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1160:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         buf_format = MBEDTLS_X509_FORMAT_PEM;
 3140              		.loc 2 1160 20
 3141 0090 C745D002 		movl	$2, -48(%rbp)
 3141      000000
 3142              	.L223:
1161:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1162:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1163:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( buf_format == MBEDTLS_X509_FORMAT_DER )
 3143              		.loc 2 1163 7
 3144 0097 837DD001 		cmpl	$1, -48(%rbp)
 3145 009b 751C     		jne	.L224
1164:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return mbedtls_x509_crt_parse_der( chain, buf, buflen );
 3146              		.loc 2 1164 16
 3147 009d 488B55A8 		movq	-88(%rbp), %rdx
 3148 00a1 488B4DB0 		movq	-80(%rbp), %rcx
GAS LISTING /tmp/ccnlqVtp.s 			page 90


 3149 00a5 488B45B8 		movq	-72(%rbp), %rax
 3150 00a9 4889CE   		movq	%rcx, %rsi
 3151 00ac 4889C7   		movq	%rax, %rdi
 3152 00af E8000000 		call	mbedtls_x509_crt_parse_der
 3152      00
 3153 00b4 E9340100 		jmp	.L222
 3153      00
 3154              	.L224:
1165:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #else
1166:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return mbedtls_x509_crt_parse_der( chain, buf, buflen );
1167:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
1168:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1169:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_PEM_PARSE_C)
1170:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( buf_format == MBEDTLS_X509_FORMAT_PEM )
 3155              		.loc 2 1170 7
 3156 00b9 837DD002 		cmpl	$2, -48(%rbp)
 3157 00bd 0F850F01 		jne	.L225
 3157      0000
 3158              	.LBB4:
1171:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1172:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         int ret;
1173:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_pem_context pem;
1174:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1175:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* 1 rather than 0 since the terminating NULL byte is counted in */
1176:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         while( buflen > 1 )
 3159              		.loc 2 1176 14
 3160 00c3 E9FC0000 		jmp	.L226
 3160      00
 3161              	.L238:
 3162              	.LBB5:
1177:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
1178:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             size_t use_len;
1179:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             mbedtls_pem_init( &pem );
 3163              		.loc 2 1179 13
 3164 00c8 488D45E0 		leaq	-32(%rbp), %rax
 3165 00cc 4889C7   		movq	%rax, %rdi
 3166 00cf E8000000 		call	mbedtls_pem_init@PLT
 3166      00
1180:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1181:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             /* If we get there, we know the string is null-terminated */
1182:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             ret = mbedtls_pem_read_buffer( &pem,
 3167              		.loc 2 1182 19
 3168 00d4 488B55B0 		movq	-80(%rbp), %rdx
 3169 00d8 488D45E0 		leaq	-32(%rbp), %rax
 3170 00dc 4883EC08 		subq	$8, %rsp
 3171 00e0 488D4DD8 		leaq	-40(%rbp), %rcx
 3172 00e4 51       		pushq	%rcx
 3173 00e5 41B90000 		movl	$0, %r9d
 3173      0000
 3174 00eb 41B80000 		movl	$0, %r8d
 3174      0000
 3175 00f1 4889D1   		movq	%rdx, %rcx
 3176 00f4 488D1500 		leaq	.LC1(%rip), %rdx
 3176      000000
 3177 00fb 488D3500 		leaq	.LC0(%rip), %rsi
 3177      000000
 3178 0102 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/ccnlqVtp.s 			page 91


 3179 0105 E8000000 		call	mbedtls_pem_read_buffer@PLT
 3179      00
 3180 010a 4883C410 		addq	$16, %rsp
 3181 010e 8945D4   		movl	%eax, -44(%rbp)
1183:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                            "-----BEGIN CERTIFICATE-----",
1184:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                            "-----END CERTIFICATE-----",
1185:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                            buf, NULL, 0, &use_len );
1186:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1187:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             if( ret == 0 )
 3182              		.loc 2 1187 15
 3183 0111 837DD400 		cmpl	$0, -44(%rbp)
 3184 0115 753E     		jne	.L227
1188:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             {
1189:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 /*
1190:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                  * Was PEM encoded
1191:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                  */
1192:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 buflen -= use_len;
 3185              		.loc 2 1192 24
 3186 0117 488B45D8 		movq	-40(%rbp), %rax
 3187 011b 482945A8 		subq	%rax, -88(%rbp)
1193:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 buf += use_len;
 3188              		.loc 2 1193 21
 3189 011f 488B45D8 		movq	-40(%rbp), %rax
 3190 0123 480145B0 		addq	%rax, -80(%rbp)
1194:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             }
1195:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             else if( ret == MBEDTLS_ERR_PEM_BAD_INPUT_DATA )
1196:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             {
1197:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 return( ret );
1198:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             }
1199:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             else if( ret != MBEDTLS_ERR_PEM_NO_HEADER_FOOTER_PRESENT )
1200:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             {
1201:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 mbedtls_pem_free( &pem );
1202:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1203:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 /*
1204:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                  * PEM header and footer were found
1205:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                  */
1206:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 buflen -= use_len;
1207:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 buf += use_len;
1208:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1209:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 if( first_error == 0 )
1210:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                     first_error = ret;
1211:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1212:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 total_failed++;
1213:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 continue;
1214:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             }
1215:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             else
1216:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 break;
1217:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1218:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             ret = mbedtls_x509_crt_parse_der( chain, pem.buf, pem.buflen );
 3191              		.loc 2 1218 19
 3192 0127 488B55E8 		movq	-24(%rbp), %rdx
 3193              		.loc 2 1218 57
 3194 012b 488B4DE0 		movq	-32(%rbp), %rcx
 3195              		.loc 2 1218 19
 3196 012f 488B45B8 		movq	-72(%rbp), %rax
 3197 0133 4889CE   		movq	%rcx, %rsi
 3198 0136 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/ccnlqVtp.s 			page 92


 3199 0139 E8000000 		call	mbedtls_x509_crt_parse_der
 3199      00
 3200 013e 8945D4   		movl	%eax, -44(%rbp)
1219:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1220:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             mbedtls_pem_free( &pem );
 3201              		.loc 2 1220 13
 3202 0141 488D45E0 		leaq	-32(%rbp), %rax
 3203 0145 4889C7   		movq	%rax, %rdi
 3204 0148 E8000000 		call	mbedtls_pem_free@PLT
 3204      00
1221:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1222:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             if( ret != 0 )
 3205              		.loc 2 1222 15
 3206 014d 837DD400 		cmpl	$0, -44(%rbp)
 3207 0151 746A     		je	.L235
 3208 0153 EB48     		jmp	.L242
 3209              	.L227:
1195:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             {
 3210              		.loc 2 1195 20
 3211 0155 817DD480 		cmpl	$-5248, -44(%rbp)
 3211      EBFFFF
 3212 015c 7508     		jne	.L229
1197:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             }
 3213              		.loc 2 1197 23
 3214 015e 8B45D4   		movl	-44(%rbp), %eax
 3215 0161 E9870000 		jmp	.L222
 3215      00
 3216              	.L229:
1199:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             {
 3217              		.loc 2 1199 20
 3218 0166 817DD480 		cmpl	$-4224, -44(%rbp)
 3218      EFFFFF
 3219 016d 7462     		je	.L243
1201:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 3220              		.loc 2 1201 17
 3221 016f 488D45E0 		leaq	-32(%rbp), %rax
 3222 0173 4889C7   		movq	%rax, %rdi
 3223 0176 E8000000 		call	mbedtls_pem_free@PLT
 3223      00
1206:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 buf += use_len;
 3224              		.loc 2 1206 24
 3225 017b 488B45D8 		movq	-40(%rbp), %rax
 3226 017f 482945A8 		subq	%rax, -88(%rbp)
1207:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 3227              		.loc 2 1207 21
 3228 0183 488B45D8 		movq	-40(%rbp), %rax
 3229 0187 480145B0 		addq	%rax, -80(%rbp)
1209:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                     first_error = ret;
 3230              		.loc 2 1209 19
 3231 018b 837DC800 		cmpl	$0, -56(%rbp)
 3232 018f 7506     		jne	.L232
1210:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 3233              		.loc 2 1210 33
 3234 0191 8B45D4   		movl	-44(%rbp), %eax
 3235 0194 8945C8   		movl	%eax, -56(%rbp)
 3236              	.L232:
1212:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 continue;
GAS LISTING /tmp/ccnlqVtp.s 			page 93


 3237              		.loc 2 1212 29
 3238 0197 8345CC01 		addl	$1, -52(%rbp)
1213:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             }
 3239              		.loc 2 1213 17
 3240 019b EB27     		jmp	.L226
 3241              	.L242:
1223:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             {
1224:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 /*
1225:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                  * Quit parsing on a memory error
1226:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                  */
1227:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 if( ret == MBEDTLS_ERR_X509_ALLOC_FAILED )
 3242              		.loc 2 1227 19
 3243 019d 817DD480 		cmpl	$-10368, -44(%rbp)
 3243      D7FFFF
 3244 01a4 7505     		jne	.L236
1228:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                     return( ret );
 3245              		.loc 2 1228 27
 3246 01a6 8B45D4   		movl	-44(%rbp), %eax
 3247 01a9 EB42     		jmp	.L222
 3248              	.L236:
1229:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1230:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 if( first_error == 0 )
 3249              		.loc 2 1230 19
 3250 01ab 837DC800 		cmpl	$0, -56(%rbp)
 3251 01af 7506     		jne	.L237
1231:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                     first_error = ret;
 3252              		.loc 2 1231 33
 3253 01b1 8B45D4   		movl	-44(%rbp), %eax
 3254 01b4 8945C8   		movl	%eax, -56(%rbp)
 3255              	.L237:
1232:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1233:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 total_failed++;
 3256              		.loc 2 1233 29
 3257 01b7 8345CC01 		addl	$1, -52(%rbp)
1234:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 continue;
 3258              		.loc 2 1234 17
 3259 01bb EB07     		jmp	.L226
 3260              	.L235:
1235:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             }
1236:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1237:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             success = 1;
 3261              		.loc 2 1237 21
 3262 01bd C745C401 		movl	$1, -60(%rbp)
 3262      000000
 3263              	.L226:
 3264              	.LBE5:
1176:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
 3265              		.loc 2 1176 14
 3266 01c4 48837DA8 		cmpq	$1, -88(%rbp)
 3266      01
 3267 01c9 0F87F9FE 		ja	.L238
 3267      FFFF
 3268 01cf EB01     		jmp	.L225
 3269              	.L243:
 3270              	.LBB6:
1216:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 3271              		.loc 2 1216 17
GAS LISTING /tmp/ccnlqVtp.s 			page 94


 3272 01d1 90       		nop
 3273              	.L225:
 3274              	.LBE6:
 3275              	.LBE4:
1238:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
1239:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1240:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1241:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( success )
 3276              		.loc 2 1241 7
 3277 01d2 837DC400 		cmpl	$0, -60(%rbp)
 3278 01d6 7405     		je	.L239
1242:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( total_failed );
 3279              		.loc 2 1242 15
 3280 01d8 8B45CC   		movl	-52(%rbp), %eax
 3281 01db EB10     		jmp	.L222
 3282              	.L239:
1243:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     else if( first_error )
 3283              		.loc 2 1243 12
 3284 01dd 837DC800 		cmpl	$0, -56(%rbp)
 3285 01e1 7405     		je	.L240
1244:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( first_error );
 3286              		.loc 2 1244 15
 3287 01e3 8B45C8   		movl	-56(%rbp), %eax
 3288 01e6 EB05     		jmp	.L222
 3289              	.L240:
1245:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     else
1246:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_CERT_UNKNOWN_FORMAT );
 3290              		.loc 2 1246 15
 3291 01e8 B880D8FF 		movl	$-10112, %eax
 3291      FF
 3292              	.L222:
1247:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif /* MBEDTLS_PEM_PARSE_C */
1248:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 3293              		.loc 2 1248 1 discriminator 1
 3294 01ed 488B75F8 		movq	-8(%rbp), %rsi
 3295 01f1 64483334 		xorq	%fs:40, %rsi
 3295      25280000 
 3295      00
 3296 01fa 7405     		je	.L241
 3297              		.loc 2 1248 1 is_stmt 0
 3298 01fc E8000000 		call	__stack_chk_fail@PLT
 3298      00
 3299              	.L241:
 3300 0201 C9       		leave
 3301              	.LCFI62:
 3302              		.cfi_def_cfa 7, 8
 3303 0202 C3       		ret
 3304              		.cfi_endproc
 3305              	.LFE35:
 3307              		.section	.rodata
 3308              	.LC2:
 3309 0036 00       		.string	""
 3310              	.LC3:
 3311 0037 2C2000   		.string	", "
 3312              		.section	.text.x509_info_subject_alt_name,"ax",@progbits
 3314              	x509_info_subject_alt_name:
 3315              	.LFB36:
GAS LISTING /tmp/ccnlqVtp.s 			page 95


1249:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1250:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_FS_IO)
1251:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
1252:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Load one or more certificates and add them to the chained list
1253:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
1254:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** int mbedtls_x509_crt_parse_file( mbedtls_x509_crt *chain, const char *path )
1255:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
1256:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int ret;
1257:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     size_t n;
1258:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     unsigned char *buf;
1259:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1260:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_pk_load_file( path, &buf, &n ) ) != 0 )
1261:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( ret );
1262:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1263:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     ret = mbedtls_x509_crt_parse( chain, buf, n );
1264:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1265:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_platform_zeroize( buf, n );
1266:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_free( buf );
1267:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1268:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( ret );
1269:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
1270:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1271:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** int mbedtls_x509_crt_parse_path( mbedtls_x509_crt *chain, const char *path )
1272:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
1273:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int ret = 0;
1274:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(_WIN32) && !defined(EFIX64) && !defined(EFI32)
1275:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int w_ret;
1276:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     WCHAR szDir[MAX_PATH];
1277:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     char filename[MAX_PATH];
1278:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     char *p;
1279:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     size_t len = strlen( path );
1280:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1281:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     WIN32_FIND_DATAW file_data;
1282:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     HANDLE hFind;
1283:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1284:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( len > MAX_PATH - 3 )
1285:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_BAD_INPUT_DATA );
1286:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1287:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     memset( szDir, 0, sizeof(szDir) );
1288:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     memset( filename, 0, MAX_PATH );
1289:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     memcpy( filename, path, len );
1290:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     filename[len++] = '\\';
1291:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     p = filename + len;
1292:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     filename[len++] = '*';
1293:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1294:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     w_ret = MultiByteToWideChar( CP_ACP, 0, filename, (int)len, szDir,
1295:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                  MAX_PATH - 3 );
1296:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( w_ret == 0 )
1297:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_BAD_INPUT_DATA );
1298:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1299:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     hFind = FindFirstFileW( szDir, &file_data );
1300:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( hFind == INVALID_HANDLE_VALUE )
1301:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_FILE_IO_ERROR );
1302:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1303:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     len = MAX_PATH - len;
1304:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     do
1305:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
GAS LISTING /tmp/ccnlqVtp.s 			page 96


1306:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         memset( p, 0, len );
1307:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1308:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( file_data.dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY )
1309:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             continue;
1310:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1311:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         w_ret = WideCharToMultiByte( CP_ACP, 0, file_data.cFileName,
1312:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                      lstrlenW( file_data.cFileName ),
1313:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                      p, (int) len - 1,
1314:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                      NULL, NULL );
1315:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( w_ret == 0 )
1316:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
1317:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             ret = MBEDTLS_ERR_X509_FILE_IO_ERROR;
1318:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             goto cleanup;
1319:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
1320:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1321:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         w_ret = mbedtls_x509_crt_parse_file( chain, filename );
1322:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( w_ret < 0 )
1323:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             ret++;
1324:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         else
1325:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             ret += w_ret;
1326:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1327:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     while( FindNextFileW( hFind, &file_data ) != 0 );
1328:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1329:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( GetLastError() != ERROR_NO_MORE_FILES )
1330:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ret = MBEDTLS_ERR_X509_FILE_IO_ERROR;
1331:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1332:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** cleanup:
1333:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     FindClose( hFind );
1334:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #else /* _WIN32 */
1335:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int t_ret;
1336:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int snp_ret;
1337:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     struct stat sb;
1338:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     struct dirent *entry;
1339:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     char entry_name[MBEDTLS_X509_MAX_FILE_PATH_LEN];
1340:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     DIR *dir = opendir( path );
1341:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1342:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( dir == NULL )
1343:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_FILE_IO_ERROR );
1344:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1345:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_THREADING_C)
1346:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_mutex_lock( &mbedtls_threading_readdir_mutex ) ) != 0 )
1347:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1348:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         closedir( dir );
1349:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( ret );
1350:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1351:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif /* MBEDTLS_THREADING_C */
1352:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1353:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     while( ( entry = readdir( dir ) ) != NULL )
1354:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1355:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         snp_ret = mbedtls_snprintf( entry_name, sizeof entry_name,
1356:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                     "%s/%s", path, entry->d_name );
1357:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1358:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( snp_ret < 0 || (size_t)snp_ret >= sizeof entry_name )
1359:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
1360:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             ret = MBEDTLS_ERR_X509_BUFFER_TOO_SMALL;
1361:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             goto cleanup;
1362:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
GAS LISTING /tmp/ccnlqVtp.s 			page 97


1363:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         else if( stat( entry_name, &sb ) == -1 )
1364:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
1365:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             ret = MBEDTLS_ERR_X509_FILE_IO_ERROR;
1366:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             goto cleanup;
1367:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
1368:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1369:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( !S_ISREG( sb.st_mode ) )
1370:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             continue;
1371:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1372:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         // Ignore parse errors
1373:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         //
1374:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         t_ret = mbedtls_x509_crt_parse_file( chain, entry_name );
1375:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( t_ret < 0 )
1376:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             ret++;
1377:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         else
1378:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             ret += t_ret;
1379:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1380:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1381:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** cleanup:
1382:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     closedir( dir );
1383:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1384:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_THREADING_C)
1385:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( mbedtls_mutex_unlock( &mbedtls_threading_readdir_mutex ) != 0 )
1386:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ret = MBEDTLS_ERR_THREADING_MUTEX_ERROR;
1387:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif /* MBEDTLS_THREADING_C */
1388:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1389:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif /* _WIN32 */
1390:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1391:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( ret );
1392:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
1393:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif /* MBEDTLS_FS_IO */
1394:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1395:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_info_subject_alt_name( char **buf, size_t *size,
1396:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                        const mbedtls_x509_sequence *subject_alt_name )
1397:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 3316              		.loc 2 1397 1 is_stmt 1
 3317              		.cfi_startproc
 3318 0000 F30F1EFA 		endbr64
 3319 0004 55       		pushq	%rbp
 3320              	.LCFI63:
 3321              		.cfi_def_cfa_offset 16
 3322              		.cfi_offset 6, -16
 3323 0005 4889E5   		movq	%rsp, %rbp
 3324              	.LCFI64:
 3325              		.cfi_def_cfa_register 6
 3326 0008 4883EC60 		subq	$96, %rsp
 3327 000c 48897DB8 		movq	%rdi, -72(%rbp)
 3328 0010 488975B0 		movq	%rsi, -80(%rbp)
 3329 0014 488955A8 		movq	%rdx, -88(%rbp)
 3330              		.loc 2 1397 1
 3331 0018 64488B04 		movq	%fs:40, %rax
 3331      25280000 
 3331      00
 3332 0021 488945F8 		movq	%rax, -8(%rbp)
 3333 0025 31C0     		xorl	%eax, %eax
1398:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     size_t i;
1399:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     size_t n = *size;
GAS LISTING /tmp/ccnlqVtp.s 			page 98


 3334              		.loc 2 1399 12
 3335 0027 488B45B0 		movq	-80(%rbp), %rax
 3336 002b 488B00   		movq	(%rax), %rax
 3337 002e 488945D0 		movq	%rax, -48(%rbp)
1400:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     char *p = *buf;
 3338              		.loc 2 1400 11
 3339 0032 488B45B8 		movq	-72(%rbp), %rax
 3340 0036 488B00   		movq	(%rax), %rax
 3341 0039 488945D8 		movq	%rax, -40(%rbp)
1401:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     const mbedtls_x509_sequence *cur = subject_alt_name;
 3342              		.loc 2 1401 34
 3343 003d 488B45A8 		movq	-88(%rbp), %rax
 3344 0041 488945E0 		movq	%rax, -32(%rbp)
1402:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     const char *sep = "";
 3345              		.loc 2 1402 17
 3346 0045 488D0500 		leaq	.LC2(%rip), %rax
 3346      000000
 3347 004c 488945E8 		movq	%rax, -24(%rbp)
1403:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     size_t sep_len = 0;
 3348              		.loc 2 1403 12
 3349 0050 48C745F0 		movq	$0, -16(%rbp)
 3349      00000000 
1404:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1405:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     while( cur != NULL )
 3350              		.loc 2 1405 10
 3351 0058 E9CD0000 		jmp	.L245
 3351      00
 3352              	.L252:
1406:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1407:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( cur->buf.len + sep_len >= n )
 3353              		.loc 2 1407 21
 3354 005d 488B45E0 		movq	-32(%rbp), %rax
 3355 0061 488B5008 		movq	8(%rax), %rdx
 3356              		.loc 2 1407 26
 3357 0065 488B45F0 		movq	-16(%rbp), %rax
 3358 0069 4801D0   		addq	%rdx, %rax
 3359              		.loc 2 1407 11
 3360 006c 483945D0 		cmpq	%rax, -48(%rbp)
 3361 0070 7711     		ja	.L246
1408:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
1409:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             *p = '\0';
 3362              		.loc 2 1409 16
 3363 0072 488B45D8 		movq	-40(%rbp), %rax
 3364 0076 C60000   		movb	$0, (%rax)
1410:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( MBEDTLS_ERR_X509_BUFFER_TOO_SMALL );
 3365              		.loc 2 1410 19
 3366 0079 B880D6FF 		movl	$-10624, %eax
 3366      FF
 3367 007e E9D40000 		jmp	.L247
 3367      00
 3368              	.L246:
1411:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
1412:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1413:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         n -= cur->buf.len + sep_len;
 3369              		.loc 2 1413 22
 3370 0083 488B45E0 		movq	-32(%rbp), %rax
 3371 0087 488B5008 		movq	8(%rax), %rdx
GAS LISTING /tmp/ccnlqVtp.s 			page 99


 3372              		.loc 2 1413 27
 3373 008b 488B45F0 		movq	-16(%rbp), %rax
 3374 008f 4801D0   		addq	%rdx, %rax
 3375              		.loc 2 1413 11
 3376 0092 482945D0 		subq	%rax, -48(%rbp)
1414:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         for( i = 0; i < sep_len; i++ )
 3377              		.loc 2 1414 16
 3378 0096 48C745C8 		movq	$0, -56(%rbp)
 3378      00000000 
 3379              		.loc 2 1414 9
 3380 009e EB22     		jmp	.L248
 3381              	.L249:
1415:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             *p++ = sep[i];
 3382              		.loc 2 1415 23 discriminator 3
 3383 00a0 488B55E8 		movq	-24(%rbp), %rdx
 3384 00a4 488B45C8 		movq	-56(%rbp), %rax
 3385 00a8 488D0C02 		leaq	(%rdx,%rax), %rcx
 3386              		.loc 2 1415 15 discriminator 3
 3387 00ac 488B45D8 		movq	-40(%rbp), %rax
 3388 00b0 488D5001 		leaq	1(%rax), %rdx
 3389 00b4 488955D8 		movq	%rdx, -40(%rbp)
 3390              		.loc 2 1415 23 discriminator 3
 3391 00b8 0FB611   		movzbl	(%rcx), %edx
 3392              		.loc 2 1415 18 discriminator 3
 3393 00bb 8810     		movb	%dl, (%rax)
1414:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         for( i = 0; i < sep_len; i++ )
 3394              		.loc 2 1414 35 discriminator 3
 3395 00bd 488345C8 		addq	$1, -56(%rbp)
 3395      01
 3396              	.L248:
1414:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         for( i = 0; i < sep_len; i++ )
 3397              		.loc 2 1414 9 discriminator 1
 3398 00c2 488B45C8 		movq	-56(%rbp), %rax
 3399 00c6 483B45F0 		cmpq	-16(%rbp), %rax
 3400 00ca 72D4     		jb	.L249
1416:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         for( i = 0; i < cur->buf.len; i++ )
 3401              		.loc 2 1416 16
 3402 00cc 48C745C8 		movq	$0, -56(%rbp)
 3402      00000000 
 3403              		.loc 2 1416 9
 3404 00d4 EB27     		jmp	.L250
 3405              	.L251:
1417:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             *p++ = cur->buf.p[i];
 3406              		.loc 2 1417 28 discriminator 3
 3407 00d6 488B45E0 		movq	-32(%rbp), %rax
 3408 00da 488B5010 		movq	16(%rax), %rdx
 3409              		.loc 2 1417 30 discriminator 3
 3410 00de 488B45C8 		movq	-56(%rbp), %rax
 3411 00e2 4801D0   		addq	%rdx, %rax
 3412 00e5 0FB608   		movzbl	(%rax), %ecx
 3413              		.loc 2 1417 15 discriminator 3
 3414 00e8 488B45D8 		movq	-40(%rbp), %rax
 3415 00ec 488D5001 		leaq	1(%rax), %rdx
 3416 00f0 488955D8 		movq	%rdx, -40(%rbp)
 3417              		.loc 2 1417 30 discriminator 3
 3418 00f4 89CA     		movl	%ecx, %edx
 3419              		.loc 2 1417 18 discriminator 3
GAS LISTING /tmp/ccnlqVtp.s 			page 100


 3420 00f6 8810     		movb	%dl, (%rax)
1416:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         for( i = 0; i < cur->buf.len; i++ )
 3421              		.loc 2 1416 40 discriminator 3
 3422 00f8 488345C8 		addq	$1, -56(%rbp)
 3422      01
 3423              	.L250:
1416:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         for( i = 0; i < cur->buf.len; i++ )
 3424              		.loc 2 1416 33 discriminator 1
 3425 00fd 488B45E0 		movq	-32(%rbp), %rax
 3426 0101 488B4008 		movq	8(%rax), %rax
1416:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         for( i = 0; i < cur->buf.len; i++ )
 3427              		.loc 2 1416 9 discriminator 1
 3428 0105 483945C8 		cmpq	%rax, -56(%rbp)
 3429 0109 72CB     		jb	.L251
1418:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1419:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         sep = ", ";
 3430              		.loc 2 1419 13
 3431 010b 488D0500 		leaq	.LC3(%rip), %rax
 3431      000000
 3432 0112 488945E8 		movq	%rax, -24(%rbp)
1420:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         sep_len = 2;
 3433              		.loc 2 1420 17
 3434 0116 48C745F0 		movq	$2, -16(%rbp)
 3434      02000000 
1421:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1422:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         cur = cur->next;
 3435              		.loc 2 1422 13
 3436 011e 488B45E0 		movq	-32(%rbp), %rax
 3437 0122 488B4018 		movq	24(%rax), %rax
 3438 0126 488945E0 		movq	%rax, -32(%rbp)
 3439              	.L245:
1405:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 3440              		.loc 2 1405 10
 3441 012a 48837DE0 		cmpq	$0, -32(%rbp)
 3441      00
 3442 012f 0F8528FF 		jne	.L252
 3442      FFFF
1423:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1424:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1425:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     *p = '\0';
 3443              		.loc 2 1425 8
 3444 0135 488B45D8 		movq	-40(%rbp), %rax
 3445 0139 C60000   		movb	$0, (%rax)
1426:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1427:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     *size = n;
 3446              		.loc 2 1427 11
 3447 013c 488B45B0 		movq	-80(%rbp), %rax
 3448 0140 488B55D0 		movq	-48(%rbp), %rdx
 3449 0144 488910   		movq	%rdx, (%rax)
1428:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     *buf = p;
 3450              		.loc 2 1428 10
 3451 0147 488B45B8 		movq	-72(%rbp), %rax
 3452 014b 488B55D8 		movq	-40(%rbp), %rdx
 3453 014f 488910   		movq	%rdx, (%rax)
1429:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1430:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 3454              		.loc 2 1430 11
GAS LISTING /tmp/ccnlqVtp.s 			page 101


 3455 0152 B8000000 		movl	$0, %eax
 3455      00
 3456              	.L247:
1431:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 3457              		.loc 2 1431 1
 3458 0157 488B75F8 		movq	-8(%rbp), %rsi
 3459 015b 64483334 		xorq	%fs:40, %rsi
 3459      25280000 
 3459      00
 3460 0164 7405     		je	.L253
 3461 0166 E8000000 		call	__stack_chk_fail@PLT
 3461      00
 3462              	.L253:
 3463 016b C9       		leave
 3464              	.LCFI65:
 3465              		.cfi_def_cfa 7, 8
 3466 016c C3       		ret
 3467              		.cfi_endproc
 3468              	.LFE36:
 3470              		.section	.rodata
 3471              	.LC4:
 3472 003a 25735353 		.string	"%sSSL Client"
 3472      4C20436C 
 3472      69656E74 
 3472      00
 3473              	.LC5:
 3474 0047 25735353 		.string	"%sSSL Server"
 3474      4C205365 
 3474      72766572 
 3474      00
 3475              	.LC6:
 3476 0054 2573456D 		.string	"%sEmail"
 3476      61696C00 
 3477              	.LC7:
 3478 005c 25734F62 		.string	"%sObject Signing"
 3478      6A656374 
 3478      20536967 
 3478      6E696E67 
 3478      00
 3479              	.LC8:
 3480 006d 25735265 		.string	"%sReserved"
 3480      73657276 
 3480      656400
 3481              	.LC9:
 3482 0078 25735353 		.string	"%sSSL CA"
 3482      4C204341 
 3482      00
 3483              	.LC10:
 3484 0081 2573456D 		.string	"%sEmail CA"
 3484      61696C20 
 3484      434100
 3485              	.LC11:
 3486 008c 25734F62 		.string	"%sObject Signing CA"
 3486      6A656374 
 3486      20536967 
 3486      6E696E67 
 3486      20434100 
GAS LISTING /tmp/ccnlqVtp.s 			page 102


 3487              		.section	.text.x509_info_cert_type,"ax",@progbits
 3489              	x509_info_cert_type:
 3490              	.LFB37:
1432:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1433:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #define PRINT_ITEM(i)                           \
1434:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {                                           \
1435:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ret = mbedtls_snprintf( p, n, "%s" i, sep );    \
1436:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         MBEDTLS_X509_SAFE_SNPRINTF;                        \
1437:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         sep = ", ";                             \
1438:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1439:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1440:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #define CERT_TYPE(type,name)                    \
1441:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ns_cert_type & (type) )                 \
1442:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         PRINT_ITEM( name );
1443:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1444:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_info_cert_type( char **buf, size_t *size,
1445:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                 unsigned char ns_cert_type )
1446:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 3491              		.loc 2 1446 1
 3492              		.cfi_startproc
 3493 0000 F30F1EFA 		endbr64
 3494 0004 55       		pushq	%rbp
 3495              	.LCFI66:
 3496              		.cfi_def_cfa_offset 16
 3497              		.cfi_offset 6, -16
 3498 0005 4889E5   		movq	%rsp, %rbp
 3499              	.LCFI67:
 3500              		.cfi_def_cfa_register 6
 3501 0008 4883EC50 		subq	$80, %rsp
 3502 000c 48897DC8 		movq	%rdi, -56(%rbp)
 3503 0010 488975C0 		movq	%rsi, -64(%rbp)
 3504 0014 89D0     		movl	%edx, %eax
 3505 0016 8845BC   		movb	%al, -68(%rbp)
 3506              		.loc 2 1446 1
 3507 0019 64488B04 		movq	%fs:40, %rax
 3507      25280000 
 3507      00
 3508 0022 488945F8 		movq	%rax, -8(%rbp)
 3509 0026 31C0     		xorl	%eax, %eax
1447:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int ret;
1448:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     size_t n = *size;
 3510              		.loc 2 1448 12
 3511 0028 488B45C0 		movq	-64(%rbp), %rax
 3512 002c 488B00   		movq	(%rax), %rax
 3513 002f 488945E0 		movq	%rax, -32(%rbp)
1449:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     char *p = *buf;
 3514              		.loc 2 1449 11
 3515 0033 488B45C8 		movq	-56(%rbp), %rax
 3516 0037 488B00   		movq	(%rax), %rax
 3517 003a 488945E8 		movq	%rax, -24(%rbp)
1450:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     const char *sep = "";
 3518              		.loc 2 1450 17
 3519 003e 488D0500 		leaq	.LC2(%rip), %rax
 3519      000000
 3520 0045 488945F0 		movq	%rax, -16(%rbp)
1451:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1452:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     CERT_TYPE( MBEDTLS_X509_NS_CERT_TYPE_SSL_CLIENT,         "SSL Client" );
GAS LISTING /tmp/ccnlqVtp.s 			page 103


 3521              		.loc 2 1452 5
 3522 0049 0FB645BC 		movzbl	-68(%rbp), %eax
 3523 004d 84C0     		testb	%al, %al
 3524 004f 7963     		jns	.L255
 3525              		.loc 2 1452 5 is_stmt 0 discriminator 1
 3526 0051 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 3526      000000
 3527 0058 488B55F0 		movq	-16(%rbp), %rdx
 3528 005c 488B75E0 		movq	-32(%rbp), %rsi
 3529 0060 488B45E8 		movq	-24(%rbp), %rax
 3530 0064 4889D1   		movq	%rdx, %rcx
 3531 0067 488D1500 		leaq	.LC4(%rip), %rdx
 3531      000000
 3532 006e 4889C7   		movq	%rax, %rdi
 3533 0071 B8000000 		movl	$0, %eax
 3533      00
 3534 0076 41FFD0   		call	*%r8
 3535              	.LVL0:
 3536 0079 8945DC   		movl	%eax, -36(%rbp)
 3537 007c 837DDC00 		cmpl	$0, -36(%rbp)
 3538 0080 780B     		js	.L256
 3539              		.loc 2 1452 5 discriminator 3
 3540 0082 8B45DC   		movl	-36(%rbp), %eax
 3541 0085 4898     		cltq
 3542 0087 483945E0 		cmpq	%rax, -32(%rbp)
 3543 008b 770A     		ja	.L257
 3544              	.L256:
 3545              		.loc 2 1452 5 discriminator 4
 3546 008d B880D6FF 		movl	$-10624, %eax
 3546      FF
 3547 0092 E9370300 		jmp	.L258
 3547      00
 3548              	.L257:
 3549              		.loc 2 1452 5 discriminator 5
 3550 0097 8B45DC   		movl	-36(%rbp), %eax
 3551 009a 4898     		cltq
 3552 009c 482945E0 		subq	%rax, -32(%rbp)
 3553 00a0 8B45DC   		movl	-36(%rbp), %eax
 3554 00a3 4898     		cltq
 3555 00a5 480145E8 		addq	%rax, -24(%rbp)
 3556 00a9 488D0500 		leaq	.LC3(%rip), %rax
 3556      000000
 3557 00b0 488945F0 		movq	%rax, -16(%rbp)
 3558              	.L255:
1453:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     CERT_TYPE( MBEDTLS_X509_NS_CERT_TYPE_SSL_SERVER,         "SSL Server" );
 3559              		.loc 2 1453 5 is_stmt 1
 3560 00b4 0FB645BC 		movzbl	-68(%rbp), %eax
 3561 00b8 83E040   		andl	$64, %eax
 3562 00bb 85C0     		testl	%eax, %eax
 3563 00bd 7463     		je	.L259
 3564              		.loc 2 1453 5 is_stmt 0 discriminator 1
 3565 00bf 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 3565      000000
 3566 00c6 488B55F0 		movq	-16(%rbp), %rdx
 3567 00ca 488B75E0 		movq	-32(%rbp), %rsi
 3568 00ce 488B45E8 		movq	-24(%rbp), %rax
 3569 00d2 4889D1   		movq	%rdx, %rcx
GAS LISTING /tmp/ccnlqVtp.s 			page 104


 3570 00d5 488D1500 		leaq	.LC5(%rip), %rdx
 3570      000000
 3571 00dc 4889C7   		movq	%rax, %rdi
 3572 00df B8000000 		movl	$0, %eax
 3572      00
 3573 00e4 41FFD0   		call	*%r8
 3574              	.LVL1:
 3575 00e7 8945DC   		movl	%eax, -36(%rbp)
 3576 00ea 837DDC00 		cmpl	$0, -36(%rbp)
 3577 00ee 780B     		js	.L260
 3578              		.loc 2 1453 5 discriminator 3
 3579 00f0 8B45DC   		movl	-36(%rbp), %eax
 3580 00f3 4898     		cltq
 3581 00f5 483945E0 		cmpq	%rax, -32(%rbp)
 3582 00f9 770A     		ja	.L261
 3583              	.L260:
 3584              		.loc 2 1453 5 discriminator 4
 3585 00fb B880D6FF 		movl	$-10624, %eax
 3585      FF
 3586 0100 E9C90200 		jmp	.L258
 3586      00
 3587              	.L261:
 3588              		.loc 2 1453 5 discriminator 5
 3589 0105 8B45DC   		movl	-36(%rbp), %eax
 3590 0108 4898     		cltq
 3591 010a 482945E0 		subq	%rax, -32(%rbp)
 3592 010e 8B45DC   		movl	-36(%rbp), %eax
 3593 0111 4898     		cltq
 3594 0113 480145E8 		addq	%rax, -24(%rbp)
 3595 0117 488D0500 		leaq	.LC3(%rip), %rax
 3595      000000
 3596 011e 488945F0 		movq	%rax, -16(%rbp)
 3597              	.L259:
1454:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     CERT_TYPE( MBEDTLS_X509_NS_CERT_TYPE_EMAIL,              "Email" );
 3598              		.loc 2 1454 5 is_stmt 1
 3599 0122 0FB645BC 		movzbl	-68(%rbp), %eax
 3600 0126 83E020   		andl	$32, %eax
 3601 0129 85C0     		testl	%eax, %eax
 3602 012b 7463     		je	.L262
 3603              		.loc 2 1454 5 is_stmt 0 discriminator 1
 3604 012d 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 3604      000000
 3605 0134 488B55F0 		movq	-16(%rbp), %rdx
 3606 0138 488B75E0 		movq	-32(%rbp), %rsi
 3607 013c 488B45E8 		movq	-24(%rbp), %rax
 3608 0140 4889D1   		movq	%rdx, %rcx
 3609 0143 488D1500 		leaq	.LC6(%rip), %rdx
 3609      000000
 3610 014a 4889C7   		movq	%rax, %rdi
 3611 014d B8000000 		movl	$0, %eax
 3611      00
 3612 0152 41FFD0   		call	*%r8
 3613              	.LVL2:
 3614 0155 8945DC   		movl	%eax, -36(%rbp)
 3615 0158 837DDC00 		cmpl	$0, -36(%rbp)
 3616 015c 780B     		js	.L263
 3617              		.loc 2 1454 5 discriminator 3
GAS LISTING /tmp/ccnlqVtp.s 			page 105


 3618 015e 8B45DC   		movl	-36(%rbp), %eax
 3619 0161 4898     		cltq
 3620 0163 483945E0 		cmpq	%rax, -32(%rbp)
 3621 0167 770A     		ja	.L264
 3622              	.L263:
 3623              		.loc 2 1454 5 discriminator 4
 3624 0169 B880D6FF 		movl	$-10624, %eax
 3624      FF
 3625 016e E95B0200 		jmp	.L258
 3625      00
 3626              	.L264:
 3627              		.loc 2 1454 5 discriminator 5
 3628 0173 8B45DC   		movl	-36(%rbp), %eax
 3629 0176 4898     		cltq
 3630 0178 482945E0 		subq	%rax, -32(%rbp)
 3631 017c 8B45DC   		movl	-36(%rbp), %eax
 3632 017f 4898     		cltq
 3633 0181 480145E8 		addq	%rax, -24(%rbp)
 3634 0185 488D0500 		leaq	.LC3(%rip), %rax
 3634      000000
 3635 018c 488945F0 		movq	%rax, -16(%rbp)
 3636              	.L262:
1455:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     CERT_TYPE( MBEDTLS_X509_NS_CERT_TYPE_OBJECT_SIGNING,     "Object Signing" );
 3637              		.loc 2 1455 5 is_stmt 1
 3638 0190 0FB645BC 		movzbl	-68(%rbp), %eax
 3639 0194 83E010   		andl	$16, %eax
 3640 0197 85C0     		testl	%eax, %eax
 3641 0199 7463     		je	.L265
 3642              		.loc 2 1455 5 is_stmt 0 discriminator 1
 3643 019b 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 3643      000000
 3644 01a2 488B55F0 		movq	-16(%rbp), %rdx
 3645 01a6 488B75E0 		movq	-32(%rbp), %rsi
 3646 01aa 488B45E8 		movq	-24(%rbp), %rax
 3647 01ae 4889D1   		movq	%rdx, %rcx
 3648 01b1 488D1500 		leaq	.LC7(%rip), %rdx
 3648      000000
 3649 01b8 4889C7   		movq	%rax, %rdi
 3650 01bb B8000000 		movl	$0, %eax
 3650      00
 3651 01c0 41FFD0   		call	*%r8
 3652              	.LVL3:
 3653 01c3 8945DC   		movl	%eax, -36(%rbp)
 3654 01c6 837DDC00 		cmpl	$0, -36(%rbp)
 3655 01ca 780B     		js	.L266
 3656              		.loc 2 1455 5 discriminator 3
 3657 01cc 8B45DC   		movl	-36(%rbp), %eax
 3658 01cf 4898     		cltq
 3659 01d1 483945E0 		cmpq	%rax, -32(%rbp)
 3660 01d5 770A     		ja	.L267
 3661              	.L266:
 3662              		.loc 2 1455 5 discriminator 4
 3663 01d7 B880D6FF 		movl	$-10624, %eax
 3663      FF
 3664 01dc E9ED0100 		jmp	.L258
 3664      00
 3665              	.L267:
GAS LISTING /tmp/ccnlqVtp.s 			page 106


 3666              		.loc 2 1455 5 discriminator 5
 3667 01e1 8B45DC   		movl	-36(%rbp), %eax
 3668 01e4 4898     		cltq
 3669 01e6 482945E0 		subq	%rax, -32(%rbp)
 3670 01ea 8B45DC   		movl	-36(%rbp), %eax
 3671 01ed 4898     		cltq
 3672 01ef 480145E8 		addq	%rax, -24(%rbp)
 3673 01f3 488D0500 		leaq	.LC3(%rip), %rax
 3673      000000
 3674 01fa 488945F0 		movq	%rax, -16(%rbp)
 3675              	.L265:
1456:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     CERT_TYPE( MBEDTLS_X509_NS_CERT_TYPE_RESERVED,           "Reserved" );
 3676              		.loc 2 1456 5 is_stmt 1
 3677 01fe 0FB645BC 		movzbl	-68(%rbp), %eax
 3678 0202 83E008   		andl	$8, %eax
 3679 0205 85C0     		testl	%eax, %eax
 3680 0207 7463     		je	.L268
 3681              		.loc 2 1456 5 is_stmt 0 discriminator 1
 3682 0209 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 3682      000000
 3683 0210 488B55F0 		movq	-16(%rbp), %rdx
 3684 0214 488B75E0 		movq	-32(%rbp), %rsi
 3685 0218 488B45E8 		movq	-24(%rbp), %rax
 3686 021c 4889D1   		movq	%rdx, %rcx
 3687 021f 488D1500 		leaq	.LC8(%rip), %rdx
 3687      000000
 3688 0226 4889C7   		movq	%rax, %rdi
 3689 0229 B8000000 		movl	$0, %eax
 3689      00
 3690 022e 41FFD0   		call	*%r8
 3691              	.LVL4:
 3692 0231 8945DC   		movl	%eax, -36(%rbp)
 3693 0234 837DDC00 		cmpl	$0, -36(%rbp)
 3694 0238 780B     		js	.L269
 3695              		.loc 2 1456 5 discriminator 3
 3696 023a 8B45DC   		movl	-36(%rbp), %eax
 3697 023d 4898     		cltq
 3698 023f 483945E0 		cmpq	%rax, -32(%rbp)
 3699 0243 770A     		ja	.L270
 3700              	.L269:
 3701              		.loc 2 1456 5 discriminator 4
 3702 0245 B880D6FF 		movl	$-10624, %eax
 3702      FF
 3703 024a E97F0100 		jmp	.L258
 3703      00
 3704              	.L270:
 3705              		.loc 2 1456 5 discriminator 5
 3706 024f 8B45DC   		movl	-36(%rbp), %eax
 3707 0252 4898     		cltq
 3708 0254 482945E0 		subq	%rax, -32(%rbp)
 3709 0258 8B45DC   		movl	-36(%rbp), %eax
 3710 025b 4898     		cltq
 3711 025d 480145E8 		addq	%rax, -24(%rbp)
 3712 0261 488D0500 		leaq	.LC3(%rip), %rax
 3712      000000
 3713 0268 488945F0 		movq	%rax, -16(%rbp)
 3714              	.L268:
GAS LISTING /tmp/ccnlqVtp.s 			page 107


1457:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     CERT_TYPE( MBEDTLS_X509_NS_CERT_TYPE_SSL_CA,             "SSL CA" );
 3715              		.loc 2 1457 5 is_stmt 1
 3716 026c 0FB645BC 		movzbl	-68(%rbp), %eax
 3717 0270 83E004   		andl	$4, %eax
 3718 0273 85C0     		testl	%eax, %eax
 3719 0275 7463     		je	.L271
 3720              		.loc 2 1457 5 is_stmt 0 discriminator 1
 3721 0277 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 3721      000000
 3722 027e 488B55F0 		movq	-16(%rbp), %rdx
 3723 0282 488B75E0 		movq	-32(%rbp), %rsi
 3724 0286 488B45E8 		movq	-24(%rbp), %rax
 3725 028a 4889D1   		movq	%rdx, %rcx
 3726 028d 488D1500 		leaq	.LC9(%rip), %rdx
 3726      000000
 3727 0294 4889C7   		movq	%rax, %rdi
 3728 0297 B8000000 		movl	$0, %eax
 3728      00
 3729 029c 41FFD0   		call	*%r8
 3730              	.LVL5:
 3731 029f 8945DC   		movl	%eax, -36(%rbp)
 3732 02a2 837DDC00 		cmpl	$0, -36(%rbp)
 3733 02a6 780B     		js	.L272
 3734              		.loc 2 1457 5 discriminator 3
 3735 02a8 8B45DC   		movl	-36(%rbp), %eax
 3736 02ab 4898     		cltq
 3737 02ad 483945E0 		cmpq	%rax, -32(%rbp)
 3738 02b1 770A     		ja	.L273
 3739              	.L272:
 3740              		.loc 2 1457 5 discriminator 4
 3741 02b3 B880D6FF 		movl	$-10624, %eax
 3741      FF
 3742 02b8 E9110100 		jmp	.L258
 3742      00
 3743              	.L273:
 3744              		.loc 2 1457 5 discriminator 5
 3745 02bd 8B45DC   		movl	-36(%rbp), %eax
 3746 02c0 4898     		cltq
 3747 02c2 482945E0 		subq	%rax, -32(%rbp)
 3748 02c6 8B45DC   		movl	-36(%rbp), %eax
 3749 02c9 4898     		cltq
 3750 02cb 480145E8 		addq	%rax, -24(%rbp)
 3751 02cf 488D0500 		leaq	.LC3(%rip), %rax
 3751      000000
 3752 02d6 488945F0 		movq	%rax, -16(%rbp)
 3753              	.L271:
1458:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     CERT_TYPE( MBEDTLS_X509_NS_CERT_TYPE_EMAIL_CA,           "Email CA" );
 3754              		.loc 2 1458 5 is_stmt 1
 3755 02da 0FB645BC 		movzbl	-68(%rbp), %eax
 3756 02de 83E002   		andl	$2, %eax
 3757 02e1 85C0     		testl	%eax, %eax
 3758 02e3 7463     		je	.L274
 3759              		.loc 2 1458 5 is_stmt 0 discriminator 1
 3760 02e5 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 3760      000000
 3761 02ec 488B55F0 		movq	-16(%rbp), %rdx
 3762 02f0 488B75E0 		movq	-32(%rbp), %rsi
GAS LISTING /tmp/ccnlqVtp.s 			page 108


 3763 02f4 488B45E8 		movq	-24(%rbp), %rax
 3764 02f8 4889D1   		movq	%rdx, %rcx
 3765 02fb 488D1500 		leaq	.LC10(%rip), %rdx
 3765      000000
 3766 0302 4889C7   		movq	%rax, %rdi
 3767 0305 B8000000 		movl	$0, %eax
 3767      00
 3768 030a 41FFD0   		call	*%r8
 3769              	.LVL6:
 3770 030d 8945DC   		movl	%eax, -36(%rbp)
 3771 0310 837DDC00 		cmpl	$0, -36(%rbp)
 3772 0314 780B     		js	.L275
 3773              		.loc 2 1458 5 discriminator 3
 3774 0316 8B45DC   		movl	-36(%rbp), %eax
 3775 0319 4898     		cltq
 3776 031b 483945E0 		cmpq	%rax, -32(%rbp)
 3777 031f 770A     		ja	.L276
 3778              	.L275:
 3779              		.loc 2 1458 5 discriminator 4
 3780 0321 B880D6FF 		movl	$-10624, %eax
 3780      FF
 3781 0326 E9A30000 		jmp	.L258
 3781      00
 3782              	.L276:
 3783              		.loc 2 1458 5 discriminator 5
 3784 032b 8B45DC   		movl	-36(%rbp), %eax
 3785 032e 4898     		cltq
 3786 0330 482945E0 		subq	%rax, -32(%rbp)
 3787 0334 8B45DC   		movl	-36(%rbp), %eax
 3788 0337 4898     		cltq
 3789 0339 480145E8 		addq	%rax, -24(%rbp)
 3790 033d 488D0500 		leaq	.LC3(%rip), %rax
 3790      000000
 3791 0344 488945F0 		movq	%rax, -16(%rbp)
 3792              	.L274:
1459:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     CERT_TYPE( MBEDTLS_X509_NS_CERT_TYPE_OBJECT_SIGNING_CA,  "Object Signing CA" );
 3793              		.loc 2 1459 5 is_stmt 1
 3794 0348 0FB645BC 		movzbl	-68(%rbp), %eax
 3795 034c 83E001   		andl	$1, %eax
 3796 034f 85C0     		testl	%eax, %eax
 3797 0351 7460     		je	.L277
 3798              		.loc 2 1459 5 is_stmt 0 discriminator 1
 3799 0353 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 3799      000000
 3800 035a 488B55F0 		movq	-16(%rbp), %rdx
 3801 035e 488B75E0 		movq	-32(%rbp), %rsi
 3802 0362 488B45E8 		movq	-24(%rbp), %rax
 3803 0366 4889D1   		movq	%rdx, %rcx
 3804 0369 488D1500 		leaq	.LC11(%rip), %rdx
 3804      000000
 3805 0370 4889C7   		movq	%rax, %rdi
 3806 0373 B8000000 		movl	$0, %eax
 3806      00
 3807 0378 41FFD0   		call	*%r8
 3808              	.LVL7:
 3809 037b 8945DC   		movl	%eax, -36(%rbp)
 3810 037e 837DDC00 		cmpl	$0, -36(%rbp)
GAS LISTING /tmp/ccnlqVtp.s 			page 109


 3811 0382 780B     		js	.L278
 3812              		.loc 2 1459 5 discriminator 3
 3813 0384 8B45DC   		movl	-36(%rbp), %eax
 3814 0387 4898     		cltq
 3815 0389 483945E0 		cmpq	%rax, -32(%rbp)
 3816 038d 7707     		ja	.L279
 3817              	.L278:
 3818              		.loc 2 1459 5 discriminator 4
 3819 038f B880D6FF 		movl	$-10624, %eax
 3819      FF
 3820 0394 EB38     		jmp	.L258
 3821              	.L279:
 3822              		.loc 2 1459 5 discriminator 5
 3823 0396 8B45DC   		movl	-36(%rbp), %eax
 3824 0399 4898     		cltq
 3825 039b 482945E0 		subq	%rax, -32(%rbp)
 3826 039f 8B45DC   		movl	-36(%rbp), %eax
 3827 03a2 4898     		cltq
 3828 03a4 480145E8 		addq	%rax, -24(%rbp)
 3829 03a8 488D0500 		leaq	.LC3(%rip), %rax
 3829      000000
 3830 03af 488945F0 		movq	%rax, -16(%rbp)
 3831              	.L277:
1460:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1461:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     *size = n;
 3832              		.loc 2 1461 11 is_stmt 1
 3833 03b3 488B45C0 		movq	-64(%rbp), %rax
 3834 03b7 488B55E0 		movq	-32(%rbp), %rdx
 3835 03bb 488910   		movq	%rdx, (%rax)
1462:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     *buf = p;
 3836              		.loc 2 1462 10
 3837 03be 488B45C8 		movq	-56(%rbp), %rax
 3838 03c2 488B55E8 		movq	-24(%rbp), %rdx
 3839 03c6 488910   		movq	%rdx, (%rax)
1463:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1464:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 3840              		.loc 2 1464 11
 3841 03c9 B8000000 		movl	$0, %eax
 3841      00
 3842              	.L258:
1465:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 3843              		.loc 2 1465 1
 3844 03ce 488B4DF8 		movq	-8(%rbp), %rcx
 3845 03d2 6448330C 		xorq	%fs:40, %rcx
 3845      25280000 
 3845      00
 3846 03db 7405     		je	.L280
 3847 03dd E8000000 		call	__stack_chk_fail@PLT
 3847      00
 3848              	.L280:
 3849 03e2 C9       		leave
 3850              	.LCFI68:
 3851              		.cfi_def_cfa 7, 8
 3852 03e3 C3       		ret
 3853              		.cfi_endproc
 3854              	.LFE37:
 3856              		.section	.rodata
GAS LISTING /tmp/ccnlqVtp.s 			page 110


 3857              	.LC12:
 3858 00a0 25734469 		.string	"%sDigital Signature"
 3858      67697461 
 3858      6C205369 
 3858      676E6174 
 3858      75726500 
 3859              	.LC13:
 3860 00b4 25734E6F 		.string	"%sNon Repudiation"
 3860      6E205265 
 3860      70756469 
 3860      6174696F 
 3860      6E00
 3861              	.LC14:
 3862 00c6 25734B65 		.string	"%sKey Encipherment"
 3862      7920456E 
 3862      63697068 
 3862      65726D65 
 3862      6E7400
 3863              	.LC15:
 3864 00d9 25734461 		.string	"%sData Encipherment"
 3864      74612045 
 3864      6E636970 
 3864      6865726D 
 3864      656E7400 
 3865              	.LC16:
 3866 00ed 25734B65 		.string	"%sKey Agreement"
 3866      79204167 
 3866      7265656D 
 3866      656E7400 
 3867              	.LC17:
 3868 00fd 25734B65 		.string	"%sKey Cert Sign"
 3868      79204365 
 3868      72742053 
 3868      69676E00 
 3869              	.LC18:
 3870 010d 25734352 		.string	"%sCRL Sign"
 3870      4C205369 
 3870      676E00
 3871              	.LC19:
 3872 0118 2573456E 		.string	"%sEncipher Only"
 3872      63697068 
 3872      6572204F 
 3872      6E6C7900 
 3873              	.LC20:
 3874 0128 25734465 		.string	"%sDecipher Only"
 3874      63697068 
 3874      6572204F 
 3874      6E6C7900 
 3875              		.section	.text.x509_info_key_usage,"ax",@progbits
 3877              	x509_info_key_usage:
 3878              	.LFB38:
1466:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1467:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #define KEY_USAGE(code,name)    \
1468:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( key_usage & (code) )    \
1469:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         PRINT_ITEM( name );
1470:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1471:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_info_key_usage( char **buf, size_t *size,
GAS LISTING /tmp/ccnlqVtp.s 			page 111


1472:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                 unsigned int key_usage )
1473:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 3879              		.loc 2 1473 1
 3880              		.cfi_startproc
 3881 0000 F30F1EFA 		endbr64
 3882 0004 55       		pushq	%rbp
 3883              	.LCFI69:
 3884              		.cfi_def_cfa_offset 16
 3885              		.cfi_offset 6, -16
 3886 0005 4889E5   		movq	%rsp, %rbp
 3887              	.LCFI70:
 3888              		.cfi_def_cfa_register 6
 3889 0008 4883EC50 		subq	$80, %rsp
 3890 000c 48897DC8 		movq	%rdi, -56(%rbp)
 3891 0010 488975C0 		movq	%rsi, -64(%rbp)
 3892 0014 8955BC   		movl	%edx, -68(%rbp)
 3893              		.loc 2 1473 1
 3894 0017 64488B04 		movq	%fs:40, %rax
 3894      25280000 
 3894      00
 3895 0020 488945F8 		movq	%rax, -8(%rbp)
 3896 0024 31C0     		xorl	%eax, %eax
1474:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int ret;
1475:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     size_t n = *size;
 3897              		.loc 2 1475 12
 3898 0026 488B45C0 		movq	-64(%rbp), %rax
 3899 002a 488B00   		movq	(%rax), %rax
 3900 002d 488945E0 		movq	%rax, -32(%rbp)
1476:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     char *p = *buf;
 3901              		.loc 2 1476 11
 3902 0031 488B45C8 		movq	-56(%rbp), %rax
 3903 0035 488B00   		movq	(%rax), %rax
 3904 0038 488945E8 		movq	%rax, -24(%rbp)
1477:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     const char *sep = "";
 3905              		.loc 2 1477 17
 3906 003c 488D0500 		leaq	.LC2(%rip), %rax
 3906      000000
 3907 0043 488945F0 		movq	%rax, -16(%rbp)
1478:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1479:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     KEY_USAGE( MBEDTLS_X509_KU_DIGITAL_SIGNATURE,    "Digital Signature" );
 3908              		.loc 2 1479 5
 3909 0047 8B45BC   		movl	-68(%rbp), %eax
 3910 004a 25800000 		andl	$128, %eax
 3910      00
 3911 004f 85C0     		testl	%eax, %eax
 3912 0051 7463     		je	.L282
 3913              		.loc 2 1479 5 is_stmt 0 discriminator 1
 3914 0053 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 3914      000000
 3915 005a 488B55F0 		movq	-16(%rbp), %rdx
 3916 005e 488B75E0 		movq	-32(%rbp), %rsi
 3917 0062 488B45E8 		movq	-24(%rbp), %rax
 3918 0066 4889D1   		movq	%rdx, %rcx
 3919 0069 488D1500 		leaq	.LC12(%rip), %rdx
 3919      000000
 3920 0070 4889C7   		movq	%rax, %rdi
 3921 0073 B8000000 		movl	$0, %eax
GAS LISTING /tmp/ccnlqVtp.s 			page 112


 3921      00
 3922 0078 41FFD0   		call	*%r8
 3923              	.LVL8:
 3924 007b 8945DC   		movl	%eax, -36(%rbp)
 3925 007e 837DDC00 		cmpl	$0, -36(%rbp)
 3926 0082 780B     		js	.L283
 3927              		.loc 2 1479 5 discriminator 3
 3928 0084 8B45DC   		movl	-36(%rbp), %eax
 3929 0087 4898     		cltq
 3930 0089 483945E0 		cmpq	%rax, -32(%rbp)
 3931 008d 770A     		ja	.L284
 3932              	.L283:
 3933              		.loc 2 1479 5 discriminator 4
 3934 008f B880D6FF 		movl	$-10624, %eax
 3934      FF
 3935 0094 E99F0300 		jmp	.L285
 3935      00
 3936              	.L284:
 3937              		.loc 2 1479 5 discriminator 5
 3938 0099 8B45DC   		movl	-36(%rbp), %eax
 3939 009c 4898     		cltq
 3940 009e 482945E0 		subq	%rax, -32(%rbp)
 3941 00a2 8B45DC   		movl	-36(%rbp), %eax
 3942 00a5 4898     		cltq
 3943 00a7 480145E8 		addq	%rax, -24(%rbp)
 3944 00ab 488D0500 		leaq	.LC3(%rip), %rax
 3944      000000
 3945 00b2 488945F0 		movq	%rax, -16(%rbp)
 3946              	.L282:
1480:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     KEY_USAGE( MBEDTLS_X509_KU_NON_REPUDIATION,      "Non Repudiation" );
 3947              		.loc 2 1480 5 is_stmt 1
 3948 00b6 8B45BC   		movl	-68(%rbp), %eax
 3949 00b9 83E040   		andl	$64, %eax
 3950 00bc 85C0     		testl	%eax, %eax
 3951 00be 7463     		je	.L286
 3952              		.loc 2 1480 5 is_stmt 0 discriminator 1
 3953 00c0 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 3953      000000
 3954 00c7 488B55F0 		movq	-16(%rbp), %rdx
 3955 00cb 488B75E0 		movq	-32(%rbp), %rsi
 3956 00cf 488B45E8 		movq	-24(%rbp), %rax
 3957 00d3 4889D1   		movq	%rdx, %rcx
 3958 00d6 488D1500 		leaq	.LC13(%rip), %rdx
 3958      000000
 3959 00dd 4889C7   		movq	%rax, %rdi
 3960 00e0 B8000000 		movl	$0, %eax
 3960      00
 3961 00e5 41FFD0   		call	*%r8
 3962              	.LVL9:
 3963 00e8 8945DC   		movl	%eax, -36(%rbp)
 3964 00eb 837DDC00 		cmpl	$0, -36(%rbp)
 3965 00ef 780B     		js	.L287
 3966              		.loc 2 1480 5 discriminator 3
 3967 00f1 8B45DC   		movl	-36(%rbp), %eax
 3968 00f4 4898     		cltq
 3969 00f6 483945E0 		cmpq	%rax, -32(%rbp)
 3970 00fa 770A     		ja	.L288
GAS LISTING /tmp/ccnlqVtp.s 			page 113


 3971              	.L287:
 3972              		.loc 2 1480 5 discriminator 4
 3973 00fc B880D6FF 		movl	$-10624, %eax
 3973      FF
 3974 0101 E9320300 		jmp	.L285
 3974      00
 3975              	.L288:
 3976              		.loc 2 1480 5 discriminator 5
 3977 0106 8B45DC   		movl	-36(%rbp), %eax
 3978 0109 4898     		cltq
 3979 010b 482945E0 		subq	%rax, -32(%rbp)
 3980 010f 8B45DC   		movl	-36(%rbp), %eax
 3981 0112 4898     		cltq
 3982 0114 480145E8 		addq	%rax, -24(%rbp)
 3983 0118 488D0500 		leaq	.LC3(%rip), %rax
 3983      000000
 3984 011f 488945F0 		movq	%rax, -16(%rbp)
 3985              	.L286:
1481:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     KEY_USAGE( MBEDTLS_X509_KU_KEY_ENCIPHERMENT,     "Key Encipherment" );
 3986              		.loc 2 1481 5 is_stmt 1
 3987 0123 8B45BC   		movl	-68(%rbp), %eax
 3988 0126 83E020   		andl	$32, %eax
 3989 0129 85C0     		testl	%eax, %eax
 3990 012b 7463     		je	.L289
 3991              		.loc 2 1481 5 is_stmt 0 discriminator 1
 3992 012d 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 3992      000000
 3993 0134 488B55F0 		movq	-16(%rbp), %rdx
 3994 0138 488B75E0 		movq	-32(%rbp), %rsi
 3995 013c 488B45E8 		movq	-24(%rbp), %rax
 3996 0140 4889D1   		movq	%rdx, %rcx
 3997 0143 488D1500 		leaq	.LC14(%rip), %rdx
 3997      000000
 3998 014a 4889C7   		movq	%rax, %rdi
 3999 014d B8000000 		movl	$0, %eax
 3999      00
 4000 0152 41FFD0   		call	*%r8
 4001              	.LVL10:
 4002 0155 8945DC   		movl	%eax, -36(%rbp)
 4003 0158 837DDC00 		cmpl	$0, -36(%rbp)
 4004 015c 780B     		js	.L290
 4005              		.loc 2 1481 5 discriminator 3
 4006 015e 8B45DC   		movl	-36(%rbp), %eax
 4007 0161 4898     		cltq
 4008 0163 483945E0 		cmpq	%rax, -32(%rbp)
 4009 0167 770A     		ja	.L291
 4010              	.L290:
 4011              		.loc 2 1481 5 discriminator 4
 4012 0169 B880D6FF 		movl	$-10624, %eax
 4012      FF
 4013 016e E9C50200 		jmp	.L285
 4013      00
 4014              	.L291:
 4015              		.loc 2 1481 5 discriminator 5
 4016 0173 8B45DC   		movl	-36(%rbp), %eax
 4017 0176 4898     		cltq
 4018 0178 482945E0 		subq	%rax, -32(%rbp)
GAS LISTING /tmp/ccnlqVtp.s 			page 114


 4019 017c 8B45DC   		movl	-36(%rbp), %eax
 4020 017f 4898     		cltq
 4021 0181 480145E8 		addq	%rax, -24(%rbp)
 4022 0185 488D0500 		leaq	.LC3(%rip), %rax
 4022      000000
 4023 018c 488945F0 		movq	%rax, -16(%rbp)
 4024              	.L289:
1482:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     KEY_USAGE( MBEDTLS_X509_KU_DATA_ENCIPHERMENT,    "Data Encipherment" );
 4025              		.loc 2 1482 5 is_stmt 1
 4026 0190 8B45BC   		movl	-68(%rbp), %eax
 4027 0193 83E010   		andl	$16, %eax
 4028 0196 85C0     		testl	%eax, %eax
 4029 0198 7463     		je	.L292
 4030              		.loc 2 1482 5 is_stmt 0 discriminator 1
 4031 019a 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 4031      000000
 4032 01a1 488B55F0 		movq	-16(%rbp), %rdx
 4033 01a5 488B75E0 		movq	-32(%rbp), %rsi
 4034 01a9 488B45E8 		movq	-24(%rbp), %rax
 4035 01ad 4889D1   		movq	%rdx, %rcx
 4036 01b0 488D1500 		leaq	.LC15(%rip), %rdx
 4036      000000
 4037 01b7 4889C7   		movq	%rax, %rdi
 4038 01ba B8000000 		movl	$0, %eax
 4038      00
 4039 01bf 41FFD0   		call	*%r8
 4040              	.LVL11:
 4041 01c2 8945DC   		movl	%eax, -36(%rbp)
 4042 01c5 837DDC00 		cmpl	$0, -36(%rbp)
 4043 01c9 780B     		js	.L293
 4044              		.loc 2 1482 5 discriminator 3
 4045 01cb 8B45DC   		movl	-36(%rbp), %eax
 4046 01ce 4898     		cltq
 4047 01d0 483945E0 		cmpq	%rax, -32(%rbp)
 4048 01d4 770A     		ja	.L294
 4049              	.L293:
 4050              		.loc 2 1482 5 discriminator 4
 4051 01d6 B880D6FF 		movl	$-10624, %eax
 4051      FF
 4052 01db E9580200 		jmp	.L285
 4052      00
 4053              	.L294:
 4054              		.loc 2 1482 5 discriminator 5
 4055 01e0 8B45DC   		movl	-36(%rbp), %eax
 4056 01e3 4898     		cltq
 4057 01e5 482945E0 		subq	%rax, -32(%rbp)
 4058 01e9 8B45DC   		movl	-36(%rbp), %eax
 4059 01ec 4898     		cltq
 4060 01ee 480145E8 		addq	%rax, -24(%rbp)
 4061 01f2 488D0500 		leaq	.LC3(%rip), %rax
 4061      000000
 4062 01f9 488945F0 		movq	%rax, -16(%rbp)
 4063              	.L292:
1483:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     KEY_USAGE( MBEDTLS_X509_KU_KEY_AGREEMENT,        "Key Agreement" );
 4064              		.loc 2 1483 5 is_stmt 1
 4065 01fd 8B45BC   		movl	-68(%rbp), %eax
 4066 0200 83E008   		andl	$8, %eax
GAS LISTING /tmp/ccnlqVtp.s 			page 115


 4067 0203 85C0     		testl	%eax, %eax
 4068 0205 7463     		je	.L295
 4069              		.loc 2 1483 5 is_stmt 0 discriminator 1
 4070 0207 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 4070      000000
 4071 020e 488B55F0 		movq	-16(%rbp), %rdx
 4072 0212 488B75E0 		movq	-32(%rbp), %rsi
 4073 0216 488B45E8 		movq	-24(%rbp), %rax
 4074 021a 4889D1   		movq	%rdx, %rcx
 4075 021d 488D1500 		leaq	.LC16(%rip), %rdx
 4075      000000
 4076 0224 4889C7   		movq	%rax, %rdi
 4077 0227 B8000000 		movl	$0, %eax
 4077      00
 4078 022c 41FFD0   		call	*%r8
 4079              	.LVL12:
 4080 022f 8945DC   		movl	%eax, -36(%rbp)
 4081 0232 837DDC00 		cmpl	$0, -36(%rbp)
 4082 0236 780B     		js	.L296
 4083              		.loc 2 1483 5 discriminator 3
 4084 0238 8B45DC   		movl	-36(%rbp), %eax
 4085 023b 4898     		cltq
 4086 023d 483945E0 		cmpq	%rax, -32(%rbp)
 4087 0241 770A     		ja	.L297
 4088              	.L296:
 4089              		.loc 2 1483 5 discriminator 4
 4090 0243 B880D6FF 		movl	$-10624, %eax
 4090      FF
 4091 0248 E9EB0100 		jmp	.L285
 4091      00
 4092              	.L297:
 4093              		.loc 2 1483 5 discriminator 5
 4094 024d 8B45DC   		movl	-36(%rbp), %eax
 4095 0250 4898     		cltq
 4096 0252 482945E0 		subq	%rax, -32(%rbp)
 4097 0256 8B45DC   		movl	-36(%rbp), %eax
 4098 0259 4898     		cltq
 4099 025b 480145E8 		addq	%rax, -24(%rbp)
 4100 025f 488D0500 		leaq	.LC3(%rip), %rax
 4100      000000
 4101 0266 488945F0 		movq	%rax, -16(%rbp)
 4102              	.L295:
1484:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     KEY_USAGE( MBEDTLS_X509_KU_KEY_CERT_SIGN,        "Key Cert Sign" );
 4103              		.loc 2 1484 5 is_stmt 1
 4104 026a 8B45BC   		movl	-68(%rbp), %eax
 4105 026d 83E004   		andl	$4, %eax
 4106 0270 85C0     		testl	%eax, %eax
 4107 0272 7463     		je	.L298
 4108              		.loc 2 1484 5 is_stmt 0 discriminator 1
 4109 0274 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 4109      000000
 4110 027b 488B55F0 		movq	-16(%rbp), %rdx
 4111 027f 488B75E0 		movq	-32(%rbp), %rsi
 4112 0283 488B45E8 		movq	-24(%rbp), %rax
 4113 0287 4889D1   		movq	%rdx, %rcx
 4114 028a 488D1500 		leaq	.LC17(%rip), %rdx
 4114      000000
GAS LISTING /tmp/ccnlqVtp.s 			page 116


 4115 0291 4889C7   		movq	%rax, %rdi
 4116 0294 B8000000 		movl	$0, %eax
 4116      00
 4117 0299 41FFD0   		call	*%r8
 4118              	.LVL13:
 4119 029c 8945DC   		movl	%eax, -36(%rbp)
 4120 029f 837DDC00 		cmpl	$0, -36(%rbp)
 4121 02a3 780B     		js	.L299
 4122              		.loc 2 1484 5 discriminator 3
 4123 02a5 8B45DC   		movl	-36(%rbp), %eax
 4124 02a8 4898     		cltq
 4125 02aa 483945E0 		cmpq	%rax, -32(%rbp)
 4126 02ae 770A     		ja	.L300
 4127              	.L299:
 4128              		.loc 2 1484 5 discriminator 4
 4129 02b0 B880D6FF 		movl	$-10624, %eax
 4129      FF
 4130 02b5 E97E0100 		jmp	.L285
 4130      00
 4131              	.L300:
 4132              		.loc 2 1484 5 discriminator 5
 4133 02ba 8B45DC   		movl	-36(%rbp), %eax
 4134 02bd 4898     		cltq
 4135 02bf 482945E0 		subq	%rax, -32(%rbp)
 4136 02c3 8B45DC   		movl	-36(%rbp), %eax
 4137 02c6 4898     		cltq
 4138 02c8 480145E8 		addq	%rax, -24(%rbp)
 4139 02cc 488D0500 		leaq	.LC3(%rip), %rax
 4139      000000
 4140 02d3 488945F0 		movq	%rax, -16(%rbp)
 4141              	.L298:
1485:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     KEY_USAGE( MBEDTLS_X509_KU_CRL_SIGN,             "CRL Sign" );
 4142              		.loc 2 1485 5 is_stmt 1
 4143 02d7 8B45BC   		movl	-68(%rbp), %eax
 4144 02da 83E002   		andl	$2, %eax
 4145 02dd 85C0     		testl	%eax, %eax
 4146 02df 7463     		je	.L301
 4147              		.loc 2 1485 5 is_stmt 0 discriminator 1
 4148 02e1 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 4148      000000
 4149 02e8 488B55F0 		movq	-16(%rbp), %rdx
 4150 02ec 488B75E0 		movq	-32(%rbp), %rsi
 4151 02f0 488B45E8 		movq	-24(%rbp), %rax
 4152 02f4 4889D1   		movq	%rdx, %rcx
 4153 02f7 488D1500 		leaq	.LC18(%rip), %rdx
 4153      000000
 4154 02fe 4889C7   		movq	%rax, %rdi
 4155 0301 B8000000 		movl	$0, %eax
 4155      00
 4156 0306 41FFD0   		call	*%r8
 4157              	.LVL14:
 4158 0309 8945DC   		movl	%eax, -36(%rbp)
 4159 030c 837DDC00 		cmpl	$0, -36(%rbp)
 4160 0310 780B     		js	.L302
 4161              		.loc 2 1485 5 discriminator 3
 4162 0312 8B45DC   		movl	-36(%rbp), %eax
 4163 0315 4898     		cltq
GAS LISTING /tmp/ccnlqVtp.s 			page 117


 4164 0317 483945E0 		cmpq	%rax, -32(%rbp)
 4165 031b 770A     		ja	.L303
 4166              	.L302:
 4167              		.loc 2 1485 5 discriminator 4
 4168 031d B880D6FF 		movl	$-10624, %eax
 4168      FF
 4169 0322 E9110100 		jmp	.L285
 4169      00
 4170              	.L303:
 4171              		.loc 2 1485 5 discriminator 5
 4172 0327 8B45DC   		movl	-36(%rbp), %eax
 4173 032a 4898     		cltq
 4174 032c 482945E0 		subq	%rax, -32(%rbp)
 4175 0330 8B45DC   		movl	-36(%rbp), %eax
 4176 0333 4898     		cltq
 4177 0335 480145E8 		addq	%rax, -24(%rbp)
 4178 0339 488D0500 		leaq	.LC3(%rip), %rax
 4178      000000
 4179 0340 488945F0 		movq	%rax, -16(%rbp)
 4180              	.L301:
1486:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     KEY_USAGE( MBEDTLS_X509_KU_ENCIPHER_ONLY,        "Encipher Only" );
 4181              		.loc 2 1486 5 is_stmt 1
 4182 0344 8B45BC   		movl	-68(%rbp), %eax
 4183 0347 83E001   		andl	$1, %eax
 4184 034a 85C0     		testl	%eax, %eax
 4185 034c 7463     		je	.L304
 4186              		.loc 2 1486 5 is_stmt 0 discriminator 1
 4187 034e 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 4187      000000
 4188 0355 488B55F0 		movq	-16(%rbp), %rdx
 4189 0359 488B75E0 		movq	-32(%rbp), %rsi
 4190 035d 488B45E8 		movq	-24(%rbp), %rax
 4191 0361 4889D1   		movq	%rdx, %rcx
 4192 0364 488D1500 		leaq	.LC19(%rip), %rdx
 4192      000000
 4193 036b 4889C7   		movq	%rax, %rdi
 4194 036e B8000000 		movl	$0, %eax
 4194      00
 4195 0373 41FFD0   		call	*%r8
 4196              	.LVL15:
 4197 0376 8945DC   		movl	%eax, -36(%rbp)
 4198 0379 837DDC00 		cmpl	$0, -36(%rbp)
 4199 037d 780B     		js	.L305
 4200              		.loc 2 1486 5 discriminator 3
 4201 037f 8B45DC   		movl	-36(%rbp), %eax
 4202 0382 4898     		cltq
 4203 0384 483945E0 		cmpq	%rax, -32(%rbp)
 4204 0388 770A     		ja	.L306
 4205              	.L305:
 4206              		.loc 2 1486 5 discriminator 4
 4207 038a B880D6FF 		movl	$-10624, %eax
 4207      FF
 4208 038f E9A40000 		jmp	.L285
 4208      00
 4209              	.L306:
 4210              		.loc 2 1486 5 discriminator 5
 4211 0394 8B45DC   		movl	-36(%rbp), %eax
GAS LISTING /tmp/ccnlqVtp.s 			page 118


 4212 0397 4898     		cltq
 4213 0399 482945E0 		subq	%rax, -32(%rbp)
 4214 039d 8B45DC   		movl	-36(%rbp), %eax
 4215 03a0 4898     		cltq
 4216 03a2 480145E8 		addq	%rax, -24(%rbp)
 4217 03a6 488D0500 		leaq	.LC3(%rip), %rax
 4217      000000
 4218 03ad 488945F0 		movq	%rax, -16(%rbp)
 4219              	.L304:
1487:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     KEY_USAGE( MBEDTLS_X509_KU_DECIPHER_ONLY,        "Decipher Only" );
 4220              		.loc 2 1487 5 is_stmt 1
 4221 03b1 8B45BC   		movl	-68(%rbp), %eax
 4222 03b4 25008000 		andl	$32768, %eax
 4222      00
 4223 03b9 85C0     		testl	%eax, %eax
 4224 03bb 7460     		je	.L307
 4225              		.loc 2 1487 5 is_stmt 0 discriminator 1
 4226 03bd 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 4226      000000
 4227 03c4 488B55F0 		movq	-16(%rbp), %rdx
 4228 03c8 488B75E0 		movq	-32(%rbp), %rsi
 4229 03cc 488B45E8 		movq	-24(%rbp), %rax
 4230 03d0 4889D1   		movq	%rdx, %rcx
 4231 03d3 488D1500 		leaq	.LC20(%rip), %rdx
 4231      000000
 4232 03da 4889C7   		movq	%rax, %rdi
 4233 03dd B8000000 		movl	$0, %eax
 4233      00
 4234 03e2 41FFD0   		call	*%r8
 4235              	.LVL16:
 4236 03e5 8945DC   		movl	%eax, -36(%rbp)
 4237 03e8 837DDC00 		cmpl	$0, -36(%rbp)
 4238 03ec 780B     		js	.L308
 4239              		.loc 2 1487 5 discriminator 3
 4240 03ee 8B45DC   		movl	-36(%rbp), %eax
 4241 03f1 4898     		cltq
 4242 03f3 483945E0 		cmpq	%rax, -32(%rbp)
 4243 03f7 7707     		ja	.L309
 4244              	.L308:
 4245              		.loc 2 1487 5 discriminator 4
 4246 03f9 B880D6FF 		movl	$-10624, %eax
 4246      FF
 4247 03fe EB38     		jmp	.L285
 4248              	.L309:
 4249              		.loc 2 1487 5 discriminator 5
 4250 0400 8B45DC   		movl	-36(%rbp), %eax
 4251 0403 4898     		cltq
 4252 0405 482945E0 		subq	%rax, -32(%rbp)
 4253 0409 8B45DC   		movl	-36(%rbp), %eax
 4254 040c 4898     		cltq
 4255 040e 480145E8 		addq	%rax, -24(%rbp)
 4256 0412 488D0500 		leaq	.LC3(%rip), %rax
 4256      000000
 4257 0419 488945F0 		movq	%rax, -16(%rbp)
 4258              	.L307:
1488:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1489:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     *size = n;
GAS LISTING /tmp/ccnlqVtp.s 			page 119


 4259              		.loc 2 1489 11 is_stmt 1
 4260 041d 488B45C0 		movq	-64(%rbp), %rax
 4261 0421 488B55E0 		movq	-32(%rbp), %rdx
 4262 0425 488910   		movq	%rdx, (%rax)
1490:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     *buf = p;
 4263              		.loc 2 1490 10
 4264 0428 488B45C8 		movq	-56(%rbp), %rax
 4265 042c 488B55E8 		movq	-24(%rbp), %rdx
 4266 0430 488910   		movq	%rdx, (%rax)
1491:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1492:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 4267              		.loc 2 1492 11
 4268 0433 B8000000 		movl	$0, %eax
 4268      00
 4269              	.L285:
1493:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 4270              		.loc 2 1493 1
 4271 0438 488B4DF8 		movq	-8(%rbp), %rcx
 4272 043c 6448330C 		xorq	%fs:40, %rcx
 4272      25280000 
 4272      00
 4273 0445 7405     		je	.L310
 4274 0447 E8000000 		call	__stack_chk_fail@PLT
 4274      00
 4275              	.L310:
 4276 044c C9       		leave
 4277              	.LCFI71:
 4278              		.cfi_def_cfa 7, 8
 4279 044d C3       		ret
 4280              		.cfi_endproc
 4281              	.LFE38:
 4283              		.section	.rodata
 4284              	.LC21:
 4285 0138 3F3F3F00 		.string	"???"
 4286              	.LC22:
 4287 013c 25732573 		.string	"%s%s"
 4287      00
 4288              		.section	.text.x509_info_ext_key_usage,"ax",@progbits
 4290              	x509_info_ext_key_usage:
 4291              	.LFB39:
1494:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1495:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_info_ext_key_usage( char **buf, size_t *size,
1496:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                     const mbedtls_x509_sequence *extended_key_usage )
1497:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 4292              		.loc 2 1497 1
 4293              		.cfi_startproc
 4294 0000 F30F1EFA 		endbr64
 4295 0004 55       		pushq	%rbp
 4296              	.LCFI72:
 4297              		.cfi_def_cfa_offset 16
 4298              		.cfi_offset 6, -16
 4299 0005 4889E5   		movq	%rsp, %rbp
 4300              	.LCFI73:
 4301              		.cfi_def_cfa_register 6
 4302 0008 4883EC60 		subq	$96, %rsp
 4303 000c 48897DB8 		movq	%rdi, -72(%rbp)
 4304 0010 488975B0 		movq	%rsi, -80(%rbp)
GAS LISTING /tmp/ccnlqVtp.s 			page 120


 4305 0014 488955A8 		movq	%rdx, -88(%rbp)
 4306              		.loc 2 1497 1
 4307 0018 64488B04 		movq	%fs:40, %rax
 4307      25280000 
 4307      00
 4308 0021 488945F8 		movq	%rax, -8(%rbp)
 4309 0025 31C0     		xorl	%eax, %eax
1498:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int ret;
1499:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     const char *desc;
1500:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     size_t n = *size;
 4310              		.loc 2 1500 12
 4311 0027 488B45B0 		movq	-80(%rbp), %rax
 4312 002b 488B00   		movq	(%rax), %rax
 4313 002e 488945D8 		movq	%rax, -40(%rbp)
1501:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     char *p = *buf;
 4314              		.loc 2 1501 11
 4315 0032 488B45B8 		movq	-72(%rbp), %rax
 4316 0036 488B00   		movq	(%rax), %rax
 4317 0039 488945E0 		movq	%rax, -32(%rbp)
1502:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     const mbedtls_x509_sequence *cur = extended_key_usage;
 4318              		.loc 2 1502 34
 4319 003d 488B45A8 		movq	-88(%rbp), %rax
 4320 0041 488945E8 		movq	%rax, -24(%rbp)
1503:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     const char *sep = "";
 4321              		.loc 2 1503 17
 4322 0045 488D0500 		leaq	.LC2(%rip), %rax
 4322      000000
 4323 004c 488945F0 		movq	%rax, -16(%rbp)
1504:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1505:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     while( cur != NULL )
 4324              		.loc 2 1505 10
 4325 0050 E9950000 		jmp	.L312
 4325      00
 4326              	.L317:
1506:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1507:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( mbedtls_oid_get_extended_key_usage( &cur->buf, &desc ) != 0 )
 4327              		.loc 2 1507 13
 4328 0055 488B45E8 		movq	-24(%rbp), %rax
 4329 0059 488D55D0 		leaq	-48(%rbp), %rdx
 4330 005d 4889D6   		movq	%rdx, %rsi
 4331 0060 4889C7   		movq	%rax, %rdi
 4332 0063 E8000000 		call	mbedtls_oid_get_extended_key_usage@PLT
 4332      00
 4333              		.loc 2 1507 11
 4334 0068 85C0     		testl	%eax, %eax
 4335 006a 740B     		je	.L313
1508:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             desc = "???";
 4336              		.loc 2 1508 18
 4337 006c 488D0500 		leaq	.LC21(%rip), %rax
 4337      000000
 4338 0073 488945D0 		movq	%rax, -48(%rbp)
 4339              	.L313:
1509:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1510:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ret = mbedtls_snprintf( p, n, "%s%s", sep, desc );
 4340              		.loc 2 1510 15
 4341 0077 4C8B0D00 		movq	mbedtls_snprintf(%rip), %r9
 4341      000000
GAS LISTING /tmp/ccnlqVtp.s 			page 121


 4342 007e 488B4DD0 		movq	-48(%rbp), %rcx
 4343 0082 488B55F0 		movq	-16(%rbp), %rdx
 4344 0086 488B75D8 		movq	-40(%rbp), %rsi
 4345 008a 488B45E0 		movq	-32(%rbp), %rax
 4346 008e 4989C8   		movq	%rcx, %r8
 4347 0091 4889D1   		movq	%rdx, %rcx
 4348 0094 488D1500 		leaq	.LC22(%rip), %rdx
 4348      000000
 4349 009b 4889C7   		movq	%rax, %rdi
 4350 009e B8000000 		movl	$0, %eax
 4350      00
 4351 00a3 41FFD1   		call	*%r9
 4352              	.LVL17:
 4353 00a6 8945CC   		movl	%eax, -52(%rbp)
1511:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         MBEDTLS_X509_SAFE_SNPRINTF;
 4354              		.loc 2 1511 9
 4355 00a9 837DCC00 		cmpl	$0, -52(%rbp)
 4356 00ad 780B     		js	.L314
 4357              		.loc 2 1511 9 is_stmt 0 discriminator 2
 4358 00af 8B45CC   		movl	-52(%rbp), %eax
 4359 00b2 4898     		cltq
 4360 00b4 483945D8 		cmpq	%rax, -40(%rbp)
 4361 00b8 7707     		ja	.L315
 4362              	.L314:
 4363              		.loc 2 1511 9 discriminator 3
 4364 00ba B880D6FF 		movl	$-10624, %eax
 4364      FF
 4365 00bf EB4F     		jmp	.L318
 4366              	.L315:
 4367              		.loc 2 1511 9 discriminator 4
 4368 00c1 8B45CC   		movl	-52(%rbp), %eax
 4369 00c4 4898     		cltq
 4370 00c6 482945D8 		subq	%rax, -40(%rbp)
 4371 00ca 8B45CC   		movl	-52(%rbp), %eax
 4372 00cd 4898     		cltq
 4373 00cf 480145E0 		addq	%rax, -32(%rbp)
1512:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1513:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         sep = ", ";
 4374              		.loc 2 1513 13 is_stmt 1 discriminator 4
 4375 00d3 488D0500 		leaq	.LC3(%rip), %rax
 4375      000000
 4376 00da 488945F0 		movq	%rax, -16(%rbp)
1514:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1515:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         cur = cur->next;
 4377              		.loc 2 1515 13 discriminator 4
 4378 00de 488B45E8 		movq	-24(%rbp), %rax
 4379 00e2 488B4018 		movq	24(%rax), %rax
 4380 00e6 488945E8 		movq	%rax, -24(%rbp)
 4381              	.L312:
1505:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 4382              		.loc 2 1505 10
 4383 00ea 48837DE8 		cmpq	$0, -24(%rbp)
 4383      00
 4384 00ef 0F8560FF 		jne	.L317
 4384      FFFF
1516:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1517:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
GAS LISTING /tmp/ccnlqVtp.s 			page 122


1518:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     *size = n;
 4385              		.loc 2 1518 11
 4386 00f5 488B45B0 		movq	-80(%rbp), %rax
 4387 00f9 488B55D8 		movq	-40(%rbp), %rdx
 4388 00fd 488910   		movq	%rdx, (%rax)
1519:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     *buf = p;
 4389              		.loc 2 1519 10
 4390 0100 488B45B8 		movq	-72(%rbp), %rax
 4391 0104 488B55E0 		movq	-32(%rbp), %rdx
 4392 0108 488910   		movq	%rdx, (%rax)
1520:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1521:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 4393              		.loc 2 1521 11
 4394 010b B8000000 		movl	$0, %eax
 4394      00
 4395              	.L318:
1522:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 4396              		.loc 2 1522 1 discriminator 1
 4397 0110 488B4DF8 		movq	-8(%rbp), %rcx
 4398 0114 6448330C 		xorq	%fs:40, %rcx
 4398      25280000 
 4398      00
 4399 011d 7405     		je	.L319
 4400              		.loc 2 1522 1 is_stmt 0
 4401 011f E8000000 		call	__stack_chk_fail@PLT
 4401      00
 4402              	.L319:
 4403 0124 C9       		leave
 4404              	.LCFI74:
 4405              		.cfi_def_cfa 7, 8
 4406 0125 C3       		ret
 4407              		.cfi_endproc
 4408              	.LFE39:
 4410              		.section	.rodata
 4411 0141 00000000 		.align 8
 4411      000000
 4412              	.LC23:
 4413 0148 0A436572 		.string	"\nCertificate is uninitialised!\n"
 4413      74696669 
 4413      63617465 
 4413      20697320 
 4413      756E696E 
 4414              	.LC24:
 4415 0168 25736365 		.string	"%scert. version     : %d\n"
 4415      72742E20 
 4415      76657273 
 4415      696F6E20 
 4415      20202020 
 4416              	.LC25:
 4417 0182 25737365 		.string	"%sserial number     : "
 4417      7269616C 
 4417      206E756D 
 4417      62657220 
 4417      20202020 
 4418              	.LC26:
 4419 0199 0A257369 		.string	"\n%sissuer name       : "
 4419      73737565 
GAS LISTING /tmp/ccnlqVtp.s 			page 123


 4419      72206E61 
 4419      6D652020 
 4419      20202020 
 4420              	.LC27:
 4421 01b1 0A257373 		.string	"\n%ssubject name      : "
 4421      75626A65 
 4421      6374206E 
 4421      616D6520 
 4421      20202020 
 4422 01c9 00000000 		.align 8
 4422      000000
 4423              	.LC28:
 4424 01d0 0A257369 		.string	"\n%sissued  on        : %04d-%02d-%02d %02d:%02d:%02d"
 4424      73737565 
 4424      6420206F 
 4424      6E202020 
 4424      20202020 
 4425 0205 000000   		.align 8
 4426              	.LC29:
 4427 0208 0A257365 		.string	"\n%sexpires on        : %04d-%02d-%02d %02d:%02d:%02d"
 4427      78706972 
 4427      6573206F 
 4427      6E202020 
 4427      20202020 
 4428              	.LC30:
 4429 023d 0A257373 		.string	"\n%ssigned using      : "
 4429      69676E65 
 4429      64207573 
 4429      696E6720 
 4429      20202020 
 4430              	.LC31:
 4431 0255 0A257325 		.string	"\n%s%-18s: %d bits"
 4431      2D313873 
 4431      3A202564 
 4431      20626974 
 4431      7300
 4432              	.LC32:
 4433 0267 74727565 		.string	"true"
 4433      00
 4434              	.LC33:
 4435 026c 66616C73 		.string	"false"
 4435      6500
 4436              	.LC34:
 4437 0272 0A257362 		.string	"\n%sbasic constraints : CA=%s"
 4437      61736963 
 4437      20636F6E 
 4437      73747261 
 4437      696E7473 
 4438              	.LC35:
 4439 028f 2C206D61 		.string	", max_pathlen=%d"
 4439      785F7061 
 4439      74686C65 
 4439      6E3D2564 
 4439      00
 4440              	.LC36:
 4441 02a0 0A257373 		.string	"\n%ssubject alt name  : "
 4441      75626A65 
GAS LISTING /tmp/ccnlqVtp.s 			page 124


 4441      63742061 
 4441      6C74206E 
 4441      616D6520 
 4442              	.LC37:
 4443 02b8 0A257363 		.string	"\n%scert. type        : "
 4443      6572742E 
 4443      20747970 
 4443      65202020 
 4443      20202020 
 4444              	.LC38:
 4445 02d0 0A25736B 		.string	"\n%skey usage         : "
 4445      65792075 
 4445      73616765 
 4445      20202020 
 4445      20202020 
 4446              	.LC39:
 4447 02e8 0A257365 		.string	"\n%sext key usage     : "
 4447      7874206B 
 4447      65792075 
 4447      73616765 
 4447      20202020 
 4448              	.LC40:
 4449 0300 0A00     		.string	"\n"
 4450              		.section	.text.mbedtls_x509_crt_info,"ax",@progbits
 4451              		.globl	mbedtls_x509_crt_info
 4453              	mbedtls_x509_crt_info:
 4454              	.LFB40:
1523:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1524:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
1525:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Return an informational string about the certificate.
1526:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
1527:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #define BEFORE_COLON    18
1528:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #define BC              "18"
1529:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** int mbedtls_x509_crt_info( char *buf, size_t size, const char *prefix,
1530:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                    const mbedtls_x509_crt *crt )
1531:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 4455              		.loc 2 1531 1 is_stmt 1
 4456              		.cfi_startproc
 4457 0000 F30F1EFA 		endbr64
 4458 0004 55       		pushq	%rbp
 4459              	.LCFI75:
 4460              		.cfi_def_cfa_offset 16
 4461              		.cfi_offset 6, -16
 4462 0005 4889E5   		movq	%rsp, %rbp
 4463              	.LCFI76:
 4464              		.cfi_def_cfa_register 6
 4465 0008 53       		pushq	%rbx
 4466 0009 4883EC68 		subq	$104, %rsp
 4467              		.cfi_offset 3, -24
 4468 000d 48897DA8 		movq	%rdi, -88(%rbp)
 4469 0011 488975A0 		movq	%rsi, -96(%rbp)
 4470 0015 48895598 		movq	%rdx, -104(%rbp)
 4471 0019 48894D90 		movq	%rcx, -112(%rbp)
 4472              		.loc 2 1531 1
 4473 001d 64488B04 		movq	%fs:40, %rax
 4473      25280000 
 4473      00
GAS LISTING /tmp/ccnlqVtp.s 			page 125


 4474 0026 488945E8 		movq	%rax, -24(%rbp)
 4475 002a 31C0     		xorl	%eax, %eax
1532:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int ret;
1533:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     size_t n;
1534:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     char *p;
1535:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     char key_size_str[BEFORE_COLON];
1536:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1537:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     p = buf;
 4476              		.loc 2 1537 7
 4477 002c 488B45A8 		movq	-88(%rbp), %rax
 4478 0030 488945C8 		movq	%rax, -56(%rbp)
1538:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     n = size;
 4479              		.loc 2 1538 7
 4480 0034 488B45A0 		movq	-96(%rbp), %rax
 4481 0038 488945C0 		movq	%rax, -64(%rbp)
1539:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1540:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( NULL == crt )
 4482              		.loc 2 1540 7
 4483 003c 48837D90 		cmpq	$0, -112(%rbp)
 4483      00
 4484 0041 757C     		jne	.L321
1541:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1542:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ret = mbedtls_snprintf( p, n, "\nCertificate is uninitialised!\n" );
 4485              		.loc 2 1542 15
 4486 0043 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 4486      000000
 4487 004a 488B4DC0 		movq	-64(%rbp), %rcx
 4488 004e 488B45C8 		movq	-56(%rbp), %rax
 4489 0052 488D1500 		leaq	.LC23(%rip), %rdx
 4489      000000
 4490 0059 4889CE   		movq	%rcx, %rsi
 4491 005c 4889C7   		movq	%rax, %rdi
 4492 005f B8000000 		movl	$0, %eax
 4492      00
 4493 0064 41FFD0   		call	*%r8
 4494              	.LVL18:
 4495 0067 8945BC   		movl	%eax, -68(%rbp)
1543:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         MBEDTLS_X509_SAFE_SNPRINTF;
 4496              		.loc 2 1543 9
 4497 006a 837DBC00 		cmpl	$0, -68(%rbp)
 4498 006e 780F     		js	.L322
 4499              		.loc 2 1543 9 is_stmt 0 discriminator 2
 4500 0070 8B45BC   		movl	-68(%rbp), %eax
 4501 0073 4863D0   		movslq	%eax, %rdx
 4502 0076 488B45C0 		movq	-64(%rbp), %rax
 4503 007a 4839C2   		cmpq	%rax, %rdx
 4504 007d 720A     		jb	.L323
 4505              	.L322:
 4506              		.loc 2 1543 9 discriminator 3
 4507 007f B880D6FF 		movl	$-10624, %eax
 4507      FF
 4508 0084 E9A70A00 		jmp	.L371
 4508      00
 4509              	.L323:
 4510              		.loc 2 1543 9 discriminator 4
 4511 0089 488B55C0 		movq	-64(%rbp), %rdx
 4512 008d 8B45BC   		movl	-68(%rbp), %eax
GAS LISTING /tmp/ccnlqVtp.s 			page 126


 4513 0090 4898     		cltq
 4514 0092 4829C2   		subq	%rax, %rdx
 4515 0095 4889D0   		movq	%rdx, %rax
 4516 0098 488945C0 		movq	%rax, -64(%rbp)
 4517 009c 488B55C8 		movq	-56(%rbp), %rdx
 4518 00a0 8B45BC   		movl	-68(%rbp), %eax
 4519 00a3 4898     		cltq
 4520 00a5 4801D0   		addq	%rdx, %rax
 4521 00a8 488945C8 		movq	%rax, -56(%rbp)
1544:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1545:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( (int) ( size - n ) );
 4522              		.loc 2 1545 30 is_stmt 1 discriminator 4
 4523 00ac 488B45A0 		movq	-96(%rbp), %rax
 4524 00b0 89C2     		movl	%eax, %edx
 4525 00b2 488B45C0 		movq	-64(%rbp), %rax
 4526 00b6 29C2     		subl	%eax, %edx
 4527 00b8 89D0     		movl	%edx, %eax
 4528              		.loc 2 1545 17 discriminator 4
 4529 00ba E9710A00 		jmp	.L371
 4529      00
 4530              	.L321:
1546:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1547:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1548:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     ret = mbedtls_snprintf( p, n, "%scert. version     : %d\n",
 4531              		.loc 2 1548 11
 4532 00bf 4C8B0D00 		movq	mbedtls_snprintf(%rip), %r9
 4532      000000
 4533 00c6 488B4590 		movq	-112(%rbp), %rax
 4534 00ca 8B4830   		movl	48(%rax), %ecx
 4535 00cd 488B75C0 		movq	-64(%rbp), %rsi
 4536 00d1 488B45C8 		movq	-56(%rbp), %rax
 4537 00d5 488B5598 		movq	-104(%rbp), %rdx
 4538 00d9 4189C8   		movl	%ecx, %r8d
 4539 00dc 4889D1   		movq	%rdx, %rcx
 4540 00df 488D1500 		leaq	.LC24(%rip), %rdx
 4540      000000
 4541 00e6 4889C7   		movq	%rax, %rdi
 4542 00e9 B8000000 		movl	$0, %eax
 4542      00
 4543 00ee 41FFD1   		call	*%r9
 4544              	.LVL19:
 4545 00f1 8945BC   		movl	%eax, -68(%rbp)
1549:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                prefix, crt->version );
1550:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_SAFE_SNPRINTF;
 4546              		.loc 2 1550 5
 4547 00f4 837DBC00 		cmpl	$0, -68(%rbp)
 4548 00f8 780F     		js	.L325
 4549              		.loc 2 1550 5 is_stmt 0 discriminator 2
 4550 00fa 8B45BC   		movl	-68(%rbp), %eax
 4551 00fd 4863D0   		movslq	%eax, %rdx
 4552 0100 488B45C0 		movq	-64(%rbp), %rax
 4553 0104 4839C2   		cmpq	%rax, %rdx
 4554 0107 720A     		jb	.L326
 4555              	.L325:
 4556              		.loc 2 1550 5 discriminator 3
 4557 0109 B880D6FF 		movl	$-10624, %eax
 4557      FF
GAS LISTING /tmp/ccnlqVtp.s 			page 127


 4558 010e E91D0A00 		jmp	.L371
 4558      00
 4559              	.L326:
 4560              		.loc 2 1550 5 discriminator 4
 4561 0113 488B55C0 		movq	-64(%rbp), %rdx
 4562 0117 8B45BC   		movl	-68(%rbp), %eax
 4563 011a 4898     		cltq
 4564 011c 4829C2   		subq	%rax, %rdx
 4565 011f 4889D0   		movq	%rdx, %rax
 4566 0122 488945C0 		movq	%rax, -64(%rbp)
 4567 0126 488B55C8 		movq	-56(%rbp), %rdx
 4568 012a 8B45BC   		movl	-68(%rbp), %eax
 4569 012d 4898     		cltq
 4570 012f 4801D0   		addq	%rdx, %rax
 4571 0132 488945C8 		movq	%rax, -56(%rbp)
1551:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     ret = mbedtls_snprintf( p, n, "%sserial number     : ",
 4572              		.loc 2 1551 11 is_stmt 1 discriminator 4
 4573 0136 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 4573      000000
 4574 013d 488B75C0 		movq	-64(%rbp), %rsi
 4575 0141 488B45C8 		movq	-56(%rbp), %rax
 4576 0145 488B5598 		movq	-104(%rbp), %rdx
 4577 0149 4889D1   		movq	%rdx, %rcx
 4578 014c 488D1500 		leaq	.LC25(%rip), %rdx
 4578      000000
 4579 0153 4889C7   		movq	%rax, %rdi
 4580 0156 B8000000 		movl	$0, %eax
 4580      00
 4581 015b 41FFD0   		call	*%r8
 4582              	.LVL20:
 4583 015e 8945BC   		movl	%eax, -68(%rbp)
1552:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                prefix );
1553:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_SAFE_SNPRINTF;
 4584              		.loc 2 1553 5 discriminator 4
 4585 0161 837DBC00 		cmpl	$0, -68(%rbp)
 4586 0165 780F     		js	.L327
 4587              		.loc 2 1553 5 is_stmt 0 discriminator 2
 4588 0167 8B45BC   		movl	-68(%rbp), %eax
 4589 016a 4863D0   		movslq	%eax, %rdx
 4590 016d 488B45C0 		movq	-64(%rbp), %rax
 4591 0171 4839C2   		cmpq	%rax, %rdx
 4592 0174 720A     		jb	.L328
 4593              	.L327:
 4594              		.loc 2 1553 5 discriminator 3
 4595 0176 B880D6FF 		movl	$-10624, %eax
 4595      FF
 4596 017b E9B00900 		jmp	.L371
 4596      00
 4597              	.L328:
 4598              		.loc 2 1553 5 discriminator 4
 4599 0180 488B55C0 		movq	-64(%rbp), %rdx
 4600 0184 8B45BC   		movl	-68(%rbp), %eax
 4601 0187 4898     		cltq
 4602 0189 4829C2   		subq	%rax, %rdx
 4603 018c 4889D0   		movq	%rdx, %rax
 4604 018f 488945C0 		movq	%rax, -64(%rbp)
 4605 0193 488B55C8 		movq	-56(%rbp), %rdx
GAS LISTING /tmp/ccnlqVtp.s 			page 128


 4606 0197 8B45BC   		movl	-68(%rbp), %eax
 4607 019a 4898     		cltq
 4608 019c 4801D0   		addq	%rdx, %rax
 4609 019f 488945C8 		movq	%rax, -56(%rbp)
1554:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1555:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     ret = mbedtls_x509_serial_gets( p, n, &crt->serial );
 4610              		.loc 2 1555 11 is_stmt 1 discriminator 4
 4611 01a3 488B4590 		movq	-112(%rbp), %rax
 4612 01a7 488D5038 		leaq	56(%rax), %rdx
 4613 01ab 488B4DC0 		movq	-64(%rbp), %rcx
 4614 01af 488B45C8 		movq	-56(%rbp), %rax
 4615 01b3 4889CE   		movq	%rcx, %rsi
 4616 01b6 4889C7   		movq	%rax, %rdi
 4617 01b9 E8000000 		call	mbedtls_x509_serial_gets@PLT
 4617      00
 4618 01be 8945BC   		movl	%eax, -68(%rbp)
1556:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_SAFE_SNPRINTF;
 4619              		.loc 2 1556 5 discriminator 4
 4620 01c1 837DBC00 		cmpl	$0, -68(%rbp)
 4621 01c5 780F     		js	.L329
 4622              		.loc 2 1556 5 is_stmt 0 discriminator 2
 4623 01c7 8B45BC   		movl	-68(%rbp), %eax
 4624 01ca 4863D0   		movslq	%eax, %rdx
 4625 01cd 488B45C0 		movq	-64(%rbp), %rax
 4626 01d1 4839C2   		cmpq	%rax, %rdx
 4627 01d4 720A     		jb	.L330
 4628              	.L329:
 4629              		.loc 2 1556 5 discriminator 3
 4630 01d6 B880D6FF 		movl	$-10624, %eax
 4630      FF
 4631 01db E9500900 		jmp	.L371
 4631      00
 4632              	.L330:
 4633              		.loc 2 1556 5 discriminator 4
 4634 01e0 488B55C0 		movq	-64(%rbp), %rdx
 4635 01e4 8B45BC   		movl	-68(%rbp), %eax
 4636 01e7 4898     		cltq
 4637 01e9 4829C2   		subq	%rax, %rdx
 4638 01ec 4889D0   		movq	%rdx, %rax
 4639 01ef 488945C0 		movq	%rax, -64(%rbp)
 4640 01f3 488B55C8 		movq	-56(%rbp), %rdx
 4641 01f7 8B45BC   		movl	-68(%rbp), %eax
 4642 01fa 4898     		cltq
 4643 01fc 4801D0   		addq	%rdx, %rax
 4644 01ff 488945C8 		movq	%rax, -56(%rbp)
1557:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1558:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     ret = mbedtls_snprintf( p, n, "\n%sissuer name       : ", prefix );
 4645              		.loc 2 1558 11 is_stmt 1 discriminator 4
 4646 0203 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 4646      000000
 4647 020a 488B75C0 		movq	-64(%rbp), %rsi
 4648 020e 488B45C8 		movq	-56(%rbp), %rax
 4649 0212 488B5598 		movq	-104(%rbp), %rdx
 4650 0216 4889D1   		movq	%rdx, %rcx
 4651 0219 488D1500 		leaq	.LC26(%rip), %rdx
 4651      000000
 4652 0220 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/ccnlqVtp.s 			page 129


 4653 0223 B8000000 		movl	$0, %eax
 4653      00
 4654 0228 41FFD0   		call	*%r8
 4655              	.LVL21:
 4656 022b 8945BC   		movl	%eax, -68(%rbp)
1559:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_SAFE_SNPRINTF;
 4657              		.loc 2 1559 5 discriminator 4
 4658 022e 837DBC00 		cmpl	$0, -68(%rbp)
 4659 0232 780F     		js	.L331
 4660              		.loc 2 1559 5 is_stmt 0 discriminator 2
 4661 0234 8B45BC   		movl	-68(%rbp), %eax
 4662 0237 4863D0   		movslq	%eax, %rdx
 4663 023a 488B45C0 		movq	-64(%rbp), %rax
 4664 023e 4839C2   		cmpq	%rax, %rdx
 4665 0241 720A     		jb	.L332
 4666              	.L331:
 4667              		.loc 2 1559 5 discriminator 3
 4668 0243 B880D6FF 		movl	$-10624, %eax
 4668      FF
 4669 0248 E9E30800 		jmp	.L371
 4669      00
 4670              	.L332:
 4671              		.loc 2 1559 5 discriminator 4
 4672 024d 488B55C0 		movq	-64(%rbp), %rdx
 4673 0251 8B45BC   		movl	-68(%rbp), %eax
 4674 0254 4898     		cltq
 4675 0256 4829C2   		subq	%rax, %rdx
 4676 0259 4889D0   		movq	%rdx, %rax
 4677 025c 488945C0 		movq	%rax, -64(%rbp)
 4678 0260 488B55C8 		movq	-56(%rbp), %rdx
 4679 0264 8B45BC   		movl	-68(%rbp), %eax
 4680 0267 4898     		cltq
 4681 0269 4801D0   		addq	%rdx, %rax
 4682 026c 488945C8 		movq	%rax, -56(%rbp)
1560:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     ret = mbedtls_x509_dn_gets( p, n, &crt->issuer  );
 4683              		.loc 2 1560 11 is_stmt 1 discriminator 4
 4684 0270 488B4590 		movq	-112(%rbp), %rax
 4685 0274 488D9098 		leaq	152(%rax), %rdx
 4685      000000
 4686 027b 488B4DC0 		movq	-64(%rbp), %rcx
 4687 027f 488B45C8 		movq	-56(%rbp), %rax
 4688 0283 4889CE   		movq	%rcx, %rsi
 4689 0286 4889C7   		movq	%rax, %rdi
 4690 0289 E8000000 		call	mbedtls_x509_dn_gets@PLT
 4690      00
 4691 028e 8945BC   		movl	%eax, -68(%rbp)
1561:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_SAFE_SNPRINTF;
 4692              		.loc 2 1561 5 discriminator 4
 4693 0291 837DBC00 		cmpl	$0, -68(%rbp)
 4694 0295 780F     		js	.L333
 4695              		.loc 2 1561 5 is_stmt 0 discriminator 2
 4696 0297 8B45BC   		movl	-68(%rbp), %eax
 4697 029a 4863D0   		movslq	%eax, %rdx
 4698 029d 488B45C0 		movq	-64(%rbp), %rax
 4699 02a1 4839C2   		cmpq	%rax, %rdx
 4700 02a4 720A     		jb	.L334
 4701              	.L333:
GAS LISTING /tmp/ccnlqVtp.s 			page 130


 4702              		.loc 2 1561 5 discriminator 3
 4703 02a6 B880D6FF 		movl	$-10624, %eax
 4703      FF
 4704 02ab E9800800 		jmp	.L371
 4704      00
 4705              	.L334:
 4706              		.loc 2 1561 5 discriminator 4
 4707 02b0 488B55C0 		movq	-64(%rbp), %rdx
 4708 02b4 8B45BC   		movl	-68(%rbp), %eax
 4709 02b7 4898     		cltq
 4710 02b9 4829C2   		subq	%rax, %rdx
 4711 02bc 4889D0   		movq	%rdx, %rax
 4712 02bf 488945C0 		movq	%rax, -64(%rbp)
 4713 02c3 488B55C8 		movq	-56(%rbp), %rdx
 4714 02c7 8B45BC   		movl	-68(%rbp), %eax
 4715 02ca 4898     		cltq
 4716 02cc 4801D0   		addq	%rdx, %rax
 4717 02cf 488945C8 		movq	%rax, -56(%rbp)
1562:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1563:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     ret = mbedtls_snprintf( p, n, "\n%ssubject name      : ", prefix );
 4718              		.loc 2 1563 11 is_stmt 1 discriminator 4
 4719 02d3 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 4719      000000
 4720 02da 488B75C0 		movq	-64(%rbp), %rsi
 4721 02de 488B45C8 		movq	-56(%rbp), %rax
 4722 02e2 488B5598 		movq	-104(%rbp), %rdx
 4723 02e6 4889D1   		movq	%rdx, %rcx
 4724 02e9 488D1500 		leaq	.LC27(%rip), %rdx
 4724      000000
 4725 02f0 4889C7   		movq	%rax, %rdi
 4726 02f3 B8000000 		movl	$0, %eax
 4726      00
 4727 02f8 41FFD0   		call	*%r8
 4728              	.LVL22:
 4729 02fb 8945BC   		movl	%eax, -68(%rbp)
1564:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_SAFE_SNPRINTF;
 4730              		.loc 2 1564 5 discriminator 4
 4731 02fe 837DBC00 		cmpl	$0, -68(%rbp)
 4732 0302 780F     		js	.L335
 4733              		.loc 2 1564 5 is_stmt 0 discriminator 2
 4734 0304 8B45BC   		movl	-68(%rbp), %eax
 4735 0307 4863D0   		movslq	%eax, %rdx
 4736 030a 488B45C0 		movq	-64(%rbp), %rax
 4737 030e 4839C2   		cmpq	%rax, %rdx
 4738 0311 720A     		jb	.L336
 4739              	.L335:
 4740              		.loc 2 1564 5 discriminator 3
 4741 0313 B880D6FF 		movl	$-10624, %eax
 4741      FF
 4742 0318 E9130800 		jmp	.L371
 4742      00
 4743              	.L336:
 4744              		.loc 2 1564 5 discriminator 4
 4745 031d 488B55C0 		movq	-64(%rbp), %rdx
 4746 0321 8B45BC   		movl	-68(%rbp), %eax
 4747 0324 4898     		cltq
 4748 0326 4829C2   		subq	%rax, %rdx
GAS LISTING /tmp/ccnlqVtp.s 			page 131


 4749 0329 4889D0   		movq	%rdx, %rax
 4750 032c 488945C0 		movq	%rax, -64(%rbp)
 4751 0330 488B55C8 		movq	-56(%rbp), %rdx
 4752 0334 8B45BC   		movl	-68(%rbp), %eax
 4753 0337 4898     		cltq
 4754 0339 4801D0   		addq	%rdx, %rax
 4755 033c 488945C8 		movq	%rax, -56(%rbp)
1565:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     ret = mbedtls_x509_dn_gets( p, n, &crt->subject );
 4756              		.loc 2 1565 11 is_stmt 1 discriminator 4
 4757 0340 488B4590 		movq	-112(%rbp), %rax
 4758 0344 488D90D8 		leaq	216(%rax), %rdx
 4758      000000
 4759 034b 488B4DC0 		movq	-64(%rbp), %rcx
 4760 034f 488B45C8 		movq	-56(%rbp), %rax
 4761 0353 4889CE   		movq	%rcx, %rsi
 4762 0356 4889C7   		movq	%rax, %rdi
 4763 0359 E8000000 		call	mbedtls_x509_dn_gets@PLT
 4763      00
 4764 035e 8945BC   		movl	%eax, -68(%rbp)
1566:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_SAFE_SNPRINTF;
 4765              		.loc 2 1566 5 discriminator 4
 4766 0361 837DBC00 		cmpl	$0, -68(%rbp)
 4767 0365 780F     		js	.L337
 4768              		.loc 2 1566 5 is_stmt 0 discriminator 2
 4769 0367 8B45BC   		movl	-68(%rbp), %eax
 4770 036a 4863D0   		movslq	%eax, %rdx
 4771 036d 488B45C0 		movq	-64(%rbp), %rax
 4772 0371 4839C2   		cmpq	%rax, %rdx
 4773 0374 720A     		jb	.L338
 4774              	.L337:
 4775              		.loc 2 1566 5 discriminator 3
 4776 0376 B880D6FF 		movl	$-10624, %eax
 4776      FF
 4777 037b E9B00700 		jmp	.L371
 4777      00
 4778              	.L338:
 4779              		.loc 2 1566 5 discriminator 4
 4780 0380 488B55C0 		movq	-64(%rbp), %rdx
 4781 0384 8B45BC   		movl	-68(%rbp), %eax
 4782 0387 4898     		cltq
 4783 0389 4829C2   		subq	%rax, %rdx
 4784 038c 4889D0   		movq	%rdx, %rax
 4785 038f 488945C0 		movq	%rax, -64(%rbp)
 4786 0393 488B55C8 		movq	-56(%rbp), %rdx
 4787 0397 8B45BC   		movl	-68(%rbp), %eax
 4788 039a 4898     		cltq
 4789 039c 4801D0   		addq	%rdx, %rax
 4790 039f 488945C8 		movq	%rax, -56(%rbp)
1567:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1568:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     ret = mbedtls_snprintf( p, n, "\n%sissued  on        : " \
 4791              		.loc 2 1568 11 is_stmt 1 discriminator 4
 4792 03a3 4C8B1500 		movq	mbedtls_snprintf(%rip), %r10
 4792      000000
 4793 03aa 488B4590 		movq	-112(%rbp), %rax
 4794 03ae 448B882C 		movl	300(%rax), %r9d
 4794      010000
 4795 03b5 488B4590 		movq	-112(%rbp), %rax
GAS LISTING /tmp/ccnlqVtp.s 			page 132


 4796 03b9 448B8028 		movl	296(%rax), %r8d
 4796      010000
 4797 03c0 488B4590 		movq	-112(%rbp), %rax
 4798 03c4 8BB82401 		movl	292(%rax), %edi
 4798      0000
 4799 03ca 488B4590 		movq	-112(%rbp), %rax
 4800 03ce 8B882001 		movl	288(%rax), %ecx
 4800      0000
 4801 03d4 488B4590 		movq	-112(%rbp), %rax
 4802 03d8 8B981C01 		movl	284(%rax), %ebx
 4802      0000
 4803 03de 488B4590 		movq	-112(%rbp), %rax
 4804 03e2 448B9818 		movl	280(%rax), %r11d
 4804      010000
 4805 03e9 488B75C0 		movq	-64(%rbp), %rsi
 4806 03ed 488B45C8 		movq	-56(%rbp), %rax
 4807 03f1 488B5598 		movq	-104(%rbp), %rdx
 4808 03f5 4151     		pushq	%r9
 4809 03f7 4150     		pushq	%r8
 4810 03f9 57       		pushq	%rdi
 4811 03fa 51       		pushq	%rcx
 4812 03fb 4189D9   		movl	%ebx, %r9d
 4813 03fe 4589D8   		movl	%r11d, %r8d
 4814 0401 4889D1   		movq	%rdx, %rcx
 4815 0404 488D1500 		leaq	.LC28(%rip), %rdx
 4815      000000
 4816 040b 4889C7   		movq	%rax, %rdi
 4817 040e B8000000 		movl	$0, %eax
 4817      00
 4818 0413 41FFD2   		call	*%r10
 4819              	.LVL23:
 4820 0416 4883C420 		addq	$32, %rsp
 4821 041a 8945BC   		movl	%eax, -68(%rbp)
1569:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                    "%04d-%02d-%02d %02d:%02d:%02d", prefix,
1570:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                    crt->valid_from.year, crt->valid_from.mon,
1571:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                    crt->valid_from.day,  crt->valid_from.hour,
1572:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                    crt->valid_from.min,  crt->valid_from.sec );
1573:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_SAFE_SNPRINTF;
 4822              		.loc 2 1573 5 discriminator 4
 4823 041d 837DBC00 		cmpl	$0, -68(%rbp)
 4824 0421 780F     		js	.L339
 4825              		.loc 2 1573 5 is_stmt 0 discriminator 2
 4826 0423 8B45BC   		movl	-68(%rbp), %eax
 4827 0426 4863D0   		movslq	%eax, %rdx
 4828 0429 488B45C0 		movq	-64(%rbp), %rax
 4829 042d 4839C2   		cmpq	%rax, %rdx
 4830 0430 720A     		jb	.L340
 4831              	.L339:
 4832              		.loc 2 1573 5 discriminator 3
 4833 0432 B880D6FF 		movl	$-10624, %eax
 4833      FF
 4834 0437 E9F40600 		jmp	.L371
 4834      00
 4835              	.L340:
 4836              		.loc 2 1573 5 discriminator 4
 4837 043c 488B55C0 		movq	-64(%rbp), %rdx
 4838 0440 8B45BC   		movl	-68(%rbp), %eax
GAS LISTING /tmp/ccnlqVtp.s 			page 133


 4839 0443 4898     		cltq
 4840 0445 4829C2   		subq	%rax, %rdx
 4841 0448 4889D0   		movq	%rdx, %rax
 4842 044b 488945C0 		movq	%rax, -64(%rbp)
 4843 044f 488B55C8 		movq	-56(%rbp), %rdx
 4844 0453 8B45BC   		movl	-68(%rbp), %eax
 4845 0456 4898     		cltq
 4846 0458 4801D0   		addq	%rdx, %rax
 4847 045b 488945C8 		movq	%rax, -56(%rbp)
1574:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1575:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     ret = mbedtls_snprintf( p, n, "\n%sexpires on        : " \
 4848              		.loc 2 1575 11 is_stmt 1 discriminator 4
 4849 045f 4C8B1500 		movq	mbedtls_snprintf(%rip), %r10
 4849      000000
 4850 0466 488B4590 		movq	-112(%rbp), %rax
 4851 046a 448B8844 		movl	324(%rax), %r9d
 4851      010000
 4852 0471 488B4590 		movq	-112(%rbp), %rax
 4853 0475 448B8040 		movl	320(%rax), %r8d
 4853      010000
 4854 047c 488B4590 		movq	-112(%rbp), %rax
 4855 0480 8BB83C01 		movl	316(%rax), %edi
 4855      0000
 4856 0486 488B4590 		movq	-112(%rbp), %rax
 4857 048a 8B883801 		movl	312(%rax), %ecx
 4857      0000
 4858 0490 488B4590 		movq	-112(%rbp), %rax
 4859 0494 8B983401 		movl	308(%rax), %ebx
 4859      0000
 4860 049a 488B4590 		movq	-112(%rbp), %rax
 4861 049e 448B9830 		movl	304(%rax), %r11d
 4861      010000
 4862 04a5 488B75C0 		movq	-64(%rbp), %rsi
 4863 04a9 488B45C8 		movq	-56(%rbp), %rax
 4864 04ad 488B5598 		movq	-104(%rbp), %rdx
 4865 04b1 4151     		pushq	%r9
 4866 04b3 4150     		pushq	%r8
 4867 04b5 57       		pushq	%rdi
 4868 04b6 51       		pushq	%rcx
 4869 04b7 4189D9   		movl	%ebx, %r9d
 4870 04ba 4589D8   		movl	%r11d, %r8d
 4871 04bd 4889D1   		movq	%rdx, %rcx
 4872 04c0 488D1500 		leaq	.LC29(%rip), %rdx
 4872      000000
 4873 04c7 4889C7   		movq	%rax, %rdi
 4874 04ca B8000000 		movl	$0, %eax
 4874      00
 4875 04cf 41FFD2   		call	*%r10
 4876              	.LVL24:
 4877 04d2 4883C420 		addq	$32, %rsp
 4878 04d6 8945BC   		movl	%eax, -68(%rbp)
1576:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                    "%04d-%02d-%02d %02d:%02d:%02d", prefix,
1577:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                    crt->valid_to.year, crt->valid_to.mon,
1578:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                    crt->valid_to.day,  crt->valid_to.hour,
1579:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                    crt->valid_to.min,  crt->valid_to.sec );
1580:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_SAFE_SNPRINTF;
 4879              		.loc 2 1580 5 discriminator 4
GAS LISTING /tmp/ccnlqVtp.s 			page 134


 4880 04d9 837DBC00 		cmpl	$0, -68(%rbp)
 4881 04dd 780F     		js	.L341
 4882              		.loc 2 1580 5 is_stmt 0 discriminator 2
 4883 04df 8B45BC   		movl	-68(%rbp), %eax
 4884 04e2 4863D0   		movslq	%eax, %rdx
 4885 04e5 488B45C0 		movq	-64(%rbp), %rax
 4886 04e9 4839C2   		cmpq	%rax, %rdx
 4887 04ec 720A     		jb	.L342
 4888              	.L341:
 4889              		.loc 2 1580 5 discriminator 3
 4890 04ee B880D6FF 		movl	$-10624, %eax
 4890      FF
 4891 04f3 E9380600 		jmp	.L371
 4891      00
 4892              	.L342:
 4893              		.loc 2 1580 5 discriminator 4
 4894 04f8 488B55C0 		movq	-64(%rbp), %rdx
 4895 04fc 8B45BC   		movl	-68(%rbp), %eax
 4896 04ff 4898     		cltq
 4897 0501 4829C2   		subq	%rax, %rdx
 4898 0504 4889D0   		movq	%rdx, %rax
 4899 0507 488945C0 		movq	%rax, -64(%rbp)
 4900 050b 488B55C8 		movq	-56(%rbp), %rdx
 4901 050f 8B45BC   		movl	-68(%rbp), %eax
 4902 0512 4898     		cltq
 4903 0514 4801D0   		addq	%rdx, %rax
 4904 0517 488945C8 		movq	%rax, -56(%rbp)
1581:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1582:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     ret = mbedtls_snprintf( p, n, "\n%ssigned using      : ", prefix );
 4905              		.loc 2 1582 11 is_stmt 1 discriminator 4
 4906 051b 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 4906      000000
 4907 0522 488B75C0 		movq	-64(%rbp), %rsi
 4908 0526 488B45C8 		movq	-56(%rbp), %rax
 4909 052a 488B5598 		movq	-104(%rbp), %rdx
 4910 052e 4889D1   		movq	%rdx, %rcx
 4911 0531 488D1500 		leaq	.LC30(%rip), %rdx
 4911      000000
 4912 0538 4889C7   		movq	%rax, %rdi
 4913 053b B8000000 		movl	$0, %eax
 4913      00
 4914 0540 41FFD0   		call	*%r8
 4915              	.LVL25:
 4916 0543 8945BC   		movl	%eax, -68(%rbp)
1583:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_SAFE_SNPRINTF;
 4917              		.loc 2 1583 5 discriminator 4
 4918 0546 837DBC00 		cmpl	$0, -68(%rbp)
 4919 054a 780F     		js	.L343
 4920              		.loc 2 1583 5 is_stmt 0 discriminator 2
 4921 054c 8B45BC   		movl	-68(%rbp), %eax
 4922 054f 4863D0   		movslq	%eax, %rdx
 4923 0552 488B45C0 		movq	-64(%rbp), %rax
 4924 0556 4839C2   		cmpq	%rax, %rdx
 4925 0559 720A     		jb	.L344
 4926              	.L343:
 4927              		.loc 2 1583 5 discriminator 3
 4928 055b B880D6FF 		movl	$-10624, %eax
GAS LISTING /tmp/ccnlqVtp.s 			page 135


 4928      FF
 4929 0560 E9CB0500 		jmp	.L371
 4929      00
 4930              	.L344:
 4931              		.loc 2 1583 5 discriminator 4
 4932 0565 488B55C0 		movq	-64(%rbp), %rdx
 4933 0569 8B45BC   		movl	-68(%rbp), %eax
 4934 056c 4898     		cltq
 4935 056e 4829C2   		subq	%rax, %rdx
 4936 0571 4889D0   		movq	%rdx, %rax
 4937 0574 488945C0 		movq	%rax, -64(%rbp)
 4938 0578 488B55C8 		movq	-56(%rbp), %rdx
 4939 057c 8B45BC   		movl	-68(%rbp), %eax
 4940 057f 4898     		cltq
 4941 0581 4801D0   		addq	%rdx, %rax
 4942 0584 488945C8 		movq	%rax, -56(%rbp)
1584:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1585:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     ret = mbedtls_x509_sig_alg_gets( p, n, &crt->sig_oid, crt->sig_pk,
1586:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                              crt->sig_md, crt->sig_opts );
 4943              		.loc 2 1586 46 is_stmt 1 discriminator 4
 4944 0588 488B4590 		movq	-112(%rbp), %rax
 4945 058c 4C8B8018 		movq	536(%rax), %r8
 4945      020000
1585:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                              crt->sig_md, crt->sig_opts );
 4946              		.loc 2 1585 11 discriminator 4
 4947 0593 488B4590 		movq	-112(%rbp), %rax
 4948 0597 8B881002 		movl	528(%rax), %ecx
 4948      0000
 4949 059d 488B4590 		movq	-112(%rbp), %rax
 4950 05a1 8B901402 		movl	532(%rax), %edx
 4950      0000
 4951 05a7 488B4590 		movq	-112(%rbp), %rax
 4952 05ab 488D7850 		leaq	80(%rax), %rdi
 4953 05af 488B75C0 		movq	-64(%rbp), %rsi
 4954 05b3 488B45C8 		movq	-56(%rbp), %rax
 4955 05b7 4D89C1   		movq	%r8, %r9
 4956 05ba 4189C8   		movl	%ecx, %r8d
 4957 05bd 89D1     		movl	%edx, %ecx
 4958 05bf 4889FA   		movq	%rdi, %rdx
 4959 05c2 4889C7   		movq	%rax, %rdi
 4960 05c5 E8000000 		call	mbedtls_x509_sig_alg_gets@PLT
 4960      00
 4961 05ca 8945BC   		movl	%eax, -68(%rbp)
1587:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_SAFE_SNPRINTF;
 4962              		.loc 2 1587 5 discriminator 4
 4963 05cd 837DBC00 		cmpl	$0, -68(%rbp)
 4964 05d1 780F     		js	.L345
 4965              		.loc 2 1587 5 is_stmt 0 discriminator 2
 4966 05d3 8B45BC   		movl	-68(%rbp), %eax
 4967 05d6 4863D0   		movslq	%eax, %rdx
 4968 05d9 488B45C0 		movq	-64(%rbp), %rax
 4969 05dd 4839C2   		cmpq	%rax, %rdx
 4970 05e0 720A     		jb	.L346
 4971              	.L345:
 4972              		.loc 2 1587 5 discriminator 3
 4973 05e2 B880D6FF 		movl	$-10624, %eax
 4973      FF
GAS LISTING /tmp/ccnlqVtp.s 			page 136


 4974 05e7 E9440500 		jmp	.L371
 4974      00
 4975              	.L346:
 4976              		.loc 2 1587 5 discriminator 4
 4977 05ec 488B55C0 		movq	-64(%rbp), %rdx
 4978 05f0 8B45BC   		movl	-68(%rbp), %eax
 4979 05f3 4898     		cltq
 4980 05f5 4829C2   		subq	%rax, %rdx
 4981 05f8 4889D0   		movq	%rdx, %rax
 4982 05fb 488945C0 		movq	%rax, -64(%rbp)
 4983 05ff 488B55C8 		movq	-56(%rbp), %rdx
 4984 0603 8B45BC   		movl	-68(%rbp), %eax
 4985 0606 4898     		cltq
 4986 0608 4801D0   		addq	%rdx, %rax
 4987 060b 488945C8 		movq	%rax, -56(%rbp)
1588:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1589:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Key size */
1590:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ret = mbedtls_x509_key_size_helper( key_size_str, BEFORE_COLON,
 4988              		.loc 2 1590 17 is_stmt 1 discriminator 4
 4989 060f 488B4590 		movq	-112(%rbp), %rax
 4990 0613 48054801 		addq	$328, %rax
 4990      0000
 4991 0619 4889C7   		movq	%rax, %rdi
 4992 061c E8000000 		call	mbedtls_pk_get_name@PLT
 4992      00
 4993 0621 4889C2   		movq	%rax, %rdx
 4994 0624 488D45D0 		leaq	-48(%rbp), %rax
 4995 0628 BE120000 		movl	$18, %esi
 4995      00
 4996 062d 4889C7   		movq	%rax, %rdi
 4997 0630 E8000000 		call	mbedtls_x509_key_size_helper@PLT
 4997      00
 4998 0635 8945BC   		movl	%eax, -68(%rbp)
 4999              		.loc 2 1590 7 discriminator 4
 5000 0638 837DBC00 		cmpl	$0, -68(%rbp)
 5001 063c 7408     		je	.L347
1591:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                       mbedtls_pk_get_name( &crt->pk ) ) ) != 0 )
1592:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1593:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( ret );
 5002              		.loc 2 1593 15
 5003 063e 8B45BC   		movl	-68(%rbp), %eax
 5004 0641 E9EA0400 		jmp	.L371
 5004      00
 5005              	.L347:
1594:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1595:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1596:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     ret = mbedtls_snprintf( p, n, "\n%s%-" BC "s: %d bits", prefix, key_size_str,
 5006              		.loc 2 1596 11
 5007 0646 488B1D00 		movq	mbedtls_snprintf(%rip), %rbx
 5007      000000
1597:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                           (int) mbedtls_pk_get_bitlen( &crt->pk ) );
 5008              		.loc 2 1597 33
 5009 064d 488B4590 		movq	-112(%rbp), %rax
 5010 0651 48054801 		addq	$328, %rax
 5010      0000
 5011 0657 4889C7   		movq	%rax, %rdi
 5012 065a E8000000 		call	mbedtls_pk_get_bitlen@PLT
GAS LISTING /tmp/ccnlqVtp.s 			page 137


 5012      00
1596:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                           (int) mbedtls_pk_get_bitlen( &crt->pk ) );
 5013              		.loc 2 1596 11
 5014 065f 89C7     		movl	%eax, %edi
 5015 0661 488B75C0 		movq	-64(%rbp), %rsi
 5016 0665 488B45C8 		movq	-56(%rbp), %rax
 5017 0669 488D4DD0 		leaq	-48(%rbp), %rcx
 5018 066d 488B5598 		movq	-104(%rbp), %rdx
 5019 0671 4189F9   		movl	%edi, %r9d
 5020 0674 4989C8   		movq	%rcx, %r8
 5021 0677 4889D1   		movq	%rdx, %rcx
 5022 067a 488D1500 		leaq	.LC31(%rip), %rdx
 5022      000000
 5023 0681 4889C7   		movq	%rax, %rdi
 5024 0684 B8000000 		movl	$0, %eax
 5024      00
 5025 0689 FFD3     		call	*%rbx
 5026              	.LVL26:
 5027 068b 8945BC   		movl	%eax, -68(%rbp)
1598:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_SAFE_SNPRINTF;
 5028              		.loc 2 1598 5
 5029 068e 837DBC00 		cmpl	$0, -68(%rbp)
 5030 0692 780F     		js	.L348
 5031              		.loc 2 1598 5 is_stmt 0 discriminator 2
 5032 0694 8B45BC   		movl	-68(%rbp), %eax
 5033 0697 4863D0   		movslq	%eax, %rdx
 5034 069a 488B45C0 		movq	-64(%rbp), %rax
 5035 069e 4839C2   		cmpq	%rax, %rdx
 5036 06a1 720A     		jb	.L349
 5037              	.L348:
 5038              		.loc 2 1598 5 discriminator 3
 5039 06a3 B880D6FF 		movl	$-10624, %eax
 5039      FF
 5040 06a8 E9830400 		jmp	.L371
 5040      00
 5041              	.L349:
 5042              		.loc 2 1598 5 discriminator 4
 5043 06ad 488B55C0 		movq	-64(%rbp), %rdx
 5044 06b1 8B45BC   		movl	-68(%rbp), %eax
 5045 06b4 4898     		cltq
 5046 06b6 4829C2   		subq	%rax, %rdx
 5047 06b9 4889D0   		movq	%rdx, %rax
 5048 06bc 488945C0 		movq	%rax, -64(%rbp)
 5049 06c0 488B55C8 		movq	-56(%rbp), %rdx
 5050 06c4 8B45BC   		movl	-68(%rbp), %eax
 5051 06c7 4898     		cltq
 5052 06c9 4801D0   		addq	%rdx, %rax
 5053 06cc 488945C8 		movq	%rax, -56(%rbp)
1599:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1600:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /*
1601:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      * Optional extensions
1602:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      */
1603:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1604:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( crt->ext_types & MBEDTLS_X509_EXT_BASIC_CONSTRAINTS )
 5054              		.loc 2 1604 12 is_stmt 1 discriminator 4
 5055 06d0 488B4590 		movq	-112(%rbp), %rax
 5056 06d4 8B80C001 		movl	448(%rax), %eax
GAS LISTING /tmp/ccnlqVtp.s 			page 138


 5056      0000
 5057              		.loc 2 1604 24 discriminator 4
 5058 06da 25000100 		andl	$256, %eax
 5058      00
 5059              		.loc 2 1604 7 discriminator 4
 5060 06df 85C0     		testl	%eax, %eax
 5061 06e1 0F840E01 		je	.L350
 5061      0000
1605:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1606:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ret = mbedtls_snprintf( p, n, "\n%sbasic constraints : CA=%s", prefix,
 5062              		.loc 2 1606 15
 5063 06e7 4C8B0D00 		movq	mbedtls_snprintf(%rip), %r9
 5063      000000
1607:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         crt->ca_istrue ? "true" : "false" );
 5064              		.loc 2 1607 28
 5065 06ee 488B4590 		movq	-112(%rbp), %rax
 5066 06f2 8B80C401 		movl	452(%rax), %eax
 5066      0000
1606:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         crt->ca_istrue ? "true" : "false" );
 5067              		.loc 2 1606 15
 5068 06f8 85C0     		testl	%eax, %eax
 5069 06fa 7409     		je	.L351
1606:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         crt->ca_istrue ? "true" : "false" );
 5070              		.loc 2 1606 15 is_stmt 0 discriminator 1
 5071 06fc 488D0500 		leaq	.LC32(%rip), %rax
 5071      000000
 5072 0703 EB07     		jmp	.L352
 5073              	.L351:
1606:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         crt->ca_istrue ? "true" : "false" );
 5074              		.loc 2 1606 15 discriminator 2
 5075 0705 488D0500 		leaq	.LC33(%rip), %rax
 5075      000000
 5076              	.L352:
1606:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         crt->ca_istrue ? "true" : "false" );
 5077              		.loc 2 1606 15 discriminator 4
 5078 070c 488B75C0 		movq	-64(%rbp), %rsi
 5079 0710 488B7DC8 		movq	-56(%rbp), %rdi
 5080 0714 488B5598 		movq	-104(%rbp), %rdx
 5081 0718 4989C0   		movq	%rax, %r8
 5082 071b 4889D1   		movq	%rdx, %rcx
 5083 071e 488D1500 		leaq	.LC34(%rip), %rdx
 5083      000000
 5084 0725 B8000000 		movl	$0, %eax
 5084      00
 5085 072a 41FFD1   		call	*%r9
 5086              	.LVL27:
 5087 072d 8945BC   		movl	%eax, -68(%rbp)
1608:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         MBEDTLS_X509_SAFE_SNPRINTF;
 5088              		.loc 2 1608 9 is_stmt 1 discriminator 4
 5089 0730 837DBC00 		cmpl	$0, -68(%rbp)
 5090 0734 780F     		js	.L353
 5091              		.loc 2 1608 9 is_stmt 0 discriminator 2
 5092 0736 8B45BC   		movl	-68(%rbp), %eax
 5093 0739 4863D0   		movslq	%eax, %rdx
 5094 073c 488B45C0 		movq	-64(%rbp), %rax
 5095 0740 4839C2   		cmpq	%rax, %rdx
 5096 0743 720A     		jb	.L354
GAS LISTING /tmp/ccnlqVtp.s 			page 139


 5097              	.L353:
 5098              		.loc 2 1608 9 discriminator 3
 5099 0745 B880D6FF 		movl	$-10624, %eax
 5099      FF
 5100 074a E9E10300 		jmp	.L371
 5100      00
 5101              	.L354:
 5102              		.loc 2 1608 9 discriminator 4
 5103 074f 488B55C0 		movq	-64(%rbp), %rdx
 5104 0753 8B45BC   		movl	-68(%rbp), %eax
 5105 0756 4898     		cltq
 5106 0758 4829C2   		subq	%rax, %rdx
 5107 075b 4889D0   		movq	%rdx, %rax
 5108 075e 488945C0 		movq	%rax, -64(%rbp)
 5109 0762 488B55C8 		movq	-56(%rbp), %rdx
 5110 0766 8B45BC   		movl	-68(%rbp), %eax
 5111 0769 4898     		cltq
 5112 076b 4801D0   		addq	%rdx, %rax
 5113 076e 488945C8 		movq	%rax, -56(%rbp)
1609:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1610:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( crt->max_pathlen > 0 )
 5114              		.loc 2 1610 16 is_stmt 1 discriminator 4
 5115 0772 488B4590 		movq	-112(%rbp), %rax
 5116 0776 8B80C801 		movl	456(%rax), %eax
 5116      0000
 5117              		.loc 2 1610 11 discriminator 4
 5118 077c 85C0     		testl	%eax, %eax
 5119 077e 7E75     		jle	.L350
1611:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
1612:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             ret = mbedtls_snprintf( p, n, ", max_pathlen=%d", crt->max_pathlen - 1 );
 5120              		.loc 2 1612 19
 5121 0780 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 5121      000000
 5122              		.loc 2 1612 66
 5123 0787 488B4590 		movq	-112(%rbp), %rax
 5124 078b 8B80C801 		movl	456(%rax), %eax
 5124      0000
 5125              		.loc 2 1612 19
 5126 0791 8D50FF   		leal	-1(%rax), %edx
 5127 0794 488B75C0 		movq	-64(%rbp), %rsi
 5128 0798 488B45C8 		movq	-56(%rbp), %rax
 5129 079c 89D1     		movl	%edx, %ecx
 5130 079e 488D1500 		leaq	.LC35(%rip), %rdx
 5130      000000
 5131 07a5 4889C7   		movq	%rax, %rdi
 5132 07a8 B8000000 		movl	$0, %eax
 5132      00
 5133 07ad 41FFD0   		call	*%r8
 5134              	.LVL28:
 5135 07b0 8945BC   		movl	%eax, -68(%rbp)
1613:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             MBEDTLS_X509_SAFE_SNPRINTF;
 5136              		.loc 2 1613 13
 5137 07b3 837DBC00 		cmpl	$0, -68(%rbp)
 5138 07b7 780F     		js	.L355
 5139              		.loc 2 1613 13 is_stmt 0 discriminator 2
 5140 07b9 8B45BC   		movl	-68(%rbp), %eax
 5141 07bc 4863D0   		movslq	%eax, %rdx
GAS LISTING /tmp/ccnlqVtp.s 			page 140


 5142 07bf 488B45C0 		movq	-64(%rbp), %rax
 5143 07c3 4839C2   		cmpq	%rax, %rdx
 5144 07c6 720A     		jb	.L356
 5145              	.L355:
 5146              		.loc 2 1613 13 discriminator 3
 5147 07c8 B880D6FF 		movl	$-10624, %eax
 5147      FF
 5148 07cd E95E0300 		jmp	.L371
 5148      00
 5149              	.L356:
 5150              		.loc 2 1613 13 discriminator 4
 5151 07d2 488B55C0 		movq	-64(%rbp), %rdx
 5152 07d6 8B45BC   		movl	-68(%rbp), %eax
 5153 07d9 4898     		cltq
 5154 07db 4829C2   		subq	%rax, %rdx
 5155 07de 4889D0   		movq	%rdx, %rax
 5156 07e1 488945C0 		movq	%rax, -64(%rbp)
 5157 07e5 488B55C8 		movq	-56(%rbp), %rdx
 5158 07e9 8B45BC   		movl	-68(%rbp), %eax
 5159 07ec 4898     		cltq
 5160 07ee 4801D0   		addq	%rdx, %rax
 5161 07f1 488945C8 		movq	%rax, -56(%rbp)
 5162              	.L350:
1614:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
1615:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1616:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1617:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( crt->ext_types & MBEDTLS_X509_EXT_SUBJECT_ALT_NAME )
 5163              		.loc 2 1617 12 is_stmt 1
 5164 07f5 488B4590 		movq	-112(%rbp), %rax
 5165 07f9 8B80C001 		movl	448(%rax), %eax
 5165      0000
 5166              		.loc 2 1617 24
 5167 07ff 83E020   		andl	$32, %eax
 5168              		.loc 2 1617 7
 5169 0802 85C0     		testl	%eax, %eax
 5170 0804 0F849C00 		je	.L357
 5170      0000
1618:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1619:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ret = mbedtls_snprintf( p, n, "\n%ssubject alt name  : ", prefix );
 5171              		.loc 2 1619 15
 5172 080a 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 5172      000000
 5173 0811 488B75C0 		movq	-64(%rbp), %rsi
 5174 0815 488B45C8 		movq	-56(%rbp), %rax
 5175 0819 488B5598 		movq	-104(%rbp), %rdx
 5176 081d 4889D1   		movq	%rdx, %rcx
 5177 0820 488D1500 		leaq	.LC36(%rip), %rdx
 5177      000000
 5178 0827 4889C7   		movq	%rax, %rdi
 5179 082a B8000000 		movl	$0, %eax
 5179      00
 5180 082f 41FFD0   		call	*%r8
 5181              	.LVL29:
 5182 0832 8945BC   		movl	%eax, -68(%rbp)
1620:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         MBEDTLS_X509_SAFE_SNPRINTF;
 5183              		.loc 2 1620 9
 5184 0835 837DBC00 		cmpl	$0, -68(%rbp)
GAS LISTING /tmp/ccnlqVtp.s 			page 141


 5185 0839 780F     		js	.L358
 5186              		.loc 2 1620 9 is_stmt 0 discriminator 2
 5187 083b 8B45BC   		movl	-68(%rbp), %eax
 5188 083e 4863D0   		movslq	%eax, %rdx
 5189 0841 488B45C0 		movq	-64(%rbp), %rax
 5190 0845 4839C2   		cmpq	%rax, %rdx
 5191 0848 720A     		jb	.L359
 5192              	.L358:
 5193              		.loc 2 1620 9 discriminator 3
 5194 084a B880D6FF 		movl	$-10624, %eax
 5194      FF
 5195 084f E9DC0200 		jmp	.L371
 5195      00
 5196              	.L359:
 5197              		.loc 2 1620 9 discriminator 4
 5198 0854 488B55C0 		movq	-64(%rbp), %rdx
 5199 0858 8B45BC   		movl	-68(%rbp), %eax
 5200 085b 4898     		cltq
 5201 085d 4829C2   		subq	%rax, %rdx
 5202 0860 4889D0   		movq	%rdx, %rax
 5203 0863 488945C0 		movq	%rax, -64(%rbp)
 5204 0867 488B55C8 		movq	-56(%rbp), %rdx
 5205 086b 8B45BC   		movl	-68(%rbp), %eax
 5206 086e 4898     		cltq
 5207 0870 4801D0   		addq	%rdx, %rax
 5208 0873 488945C8 		movq	%rax, -56(%rbp)
1621:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1622:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ( ret = x509_info_subject_alt_name( &p, &n,
 5209              		.loc 2 1622 21 is_stmt 1 discriminator 4
 5210 0877 488B4590 		movq	-112(%rbp), %rax
 5211 087b 488D90A0 		leaq	416(%rax), %rdx
 5211      010000
 5212 0882 488D4DC0 		leaq	-64(%rbp), %rcx
 5213 0886 488D45C8 		leaq	-56(%rbp), %rax
 5214 088a 4889CE   		movq	%rcx, %rsi
 5215 088d 4889C7   		movq	%rax, %rdi
 5216 0890 E8000000 		call	x509_info_subject_alt_name
 5216      00
 5217 0895 8945BC   		movl	%eax, -68(%rbp)
 5218              		.loc 2 1622 11 discriminator 4
 5219 0898 837DBC00 		cmpl	$0, -68(%rbp)
 5220 089c 7408     		je	.L357
1623:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                             &crt->subject_alt_names ) ) != 0 )
1624:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( ret );
 5221              		.loc 2 1624 19
 5222 089e 8B45BC   		movl	-68(%rbp), %eax
 5223 08a1 E98A0200 		jmp	.L371
 5223      00
 5224              	.L357:
1625:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1626:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1627:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( crt->ext_types & MBEDTLS_X509_EXT_NS_CERT_TYPE )
 5225              		.loc 2 1627 12
 5226 08a6 488B4590 		movq	-112(%rbp), %rax
 5227 08aa 8B80C001 		movl	448(%rax), %eax
 5227      0000
 5228              		.loc 2 1627 24
GAS LISTING /tmp/ccnlqVtp.s 			page 142


 5229 08b0 25000001 		andl	$65536, %eax
 5229      00
 5230              		.loc 2 1627 7
 5231 08b5 85C0     		testl	%eax, %eax
 5232 08b7 0F849F00 		je	.L360
 5232      0000
1628:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1629:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ret = mbedtls_snprintf( p, n, "\n%scert. type        : ", prefix );
 5233              		.loc 2 1629 15
 5234 08bd 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 5234      000000
 5235 08c4 488B75C0 		movq	-64(%rbp), %rsi
 5236 08c8 488B45C8 		movq	-56(%rbp), %rax
 5237 08cc 488B5598 		movq	-104(%rbp), %rdx
 5238 08d0 4889D1   		movq	%rdx, %rcx
 5239 08d3 488D1500 		leaq	.LC37(%rip), %rdx
 5239      000000
 5240 08da 4889C7   		movq	%rax, %rdi
 5241 08dd B8000000 		movl	$0, %eax
 5241      00
 5242 08e2 41FFD0   		call	*%r8
 5243              	.LVL30:
 5244 08e5 8945BC   		movl	%eax, -68(%rbp)
1630:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         MBEDTLS_X509_SAFE_SNPRINTF;
 5245              		.loc 2 1630 9
 5246 08e8 837DBC00 		cmpl	$0, -68(%rbp)
 5247 08ec 780F     		js	.L361
 5248              		.loc 2 1630 9 is_stmt 0 discriminator 2
 5249 08ee 8B45BC   		movl	-68(%rbp), %eax
 5250 08f1 4863D0   		movslq	%eax, %rdx
 5251 08f4 488B45C0 		movq	-64(%rbp), %rax
 5252 08f8 4839C2   		cmpq	%rax, %rdx
 5253 08fb 720A     		jb	.L362
 5254              	.L361:
 5255              		.loc 2 1630 9 discriminator 3
 5256 08fd B880D6FF 		movl	$-10624, %eax
 5256      FF
 5257 0902 E9290200 		jmp	.L371
 5257      00
 5258              	.L362:
 5259              		.loc 2 1630 9 discriminator 4
 5260 0907 488B55C0 		movq	-64(%rbp), %rdx
 5261 090b 8B45BC   		movl	-68(%rbp), %eax
 5262 090e 4898     		cltq
 5263 0910 4829C2   		subq	%rax, %rdx
 5264 0913 4889D0   		movq	%rdx, %rax
 5265 0916 488945C0 		movq	%rax, -64(%rbp)
 5266 091a 488B55C8 		movq	-56(%rbp), %rdx
 5267 091e 8B45BC   		movl	-68(%rbp), %eax
 5268 0921 4898     		cltq
 5269 0923 4801D0   		addq	%rdx, %rax
 5270 0926 488945C8 		movq	%rax, -56(%rbp)
1631:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1632:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ( ret = x509_info_cert_type( &p, &n, crt->ns_cert_type ) ) != 0 )
 5271              		.loc 2 1632 53 is_stmt 1 discriminator 4
 5272 092a 488B4590 		movq	-112(%rbp), %rax
 5273 092e 0FB680F0 		movzbl	496(%rax), %eax
GAS LISTING /tmp/ccnlqVtp.s 			page 143


 5273      010000
 5274              		.loc 2 1632 21 discriminator 4
 5275 0935 0FB6D0   		movzbl	%al, %edx
 5276 0938 488D4DC0 		leaq	-64(%rbp), %rcx
 5277 093c 488D45C8 		leaq	-56(%rbp), %rax
 5278 0940 4889CE   		movq	%rcx, %rsi
 5279 0943 4889C7   		movq	%rax, %rdi
 5280 0946 E8000000 		call	x509_info_cert_type
 5280      00
 5281 094b 8945BC   		movl	%eax, -68(%rbp)
 5282              		.loc 2 1632 11 discriminator 4
 5283 094e 837DBC00 		cmpl	$0, -68(%rbp)
 5284 0952 7408     		je	.L360
1633:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( ret );
 5285              		.loc 2 1633 19
 5286 0954 8B45BC   		movl	-68(%rbp), %eax
 5287 0957 E9D40100 		jmp	.L371
 5287      00
 5288              	.L360:
1634:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1635:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1636:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( crt->ext_types & MBEDTLS_X509_EXT_KEY_USAGE )
 5289              		.loc 2 1636 12
 5290 095c 488B4590 		movq	-112(%rbp), %rax
 5291 0960 8B80C001 		movl	448(%rax), %eax
 5291      0000
 5292              		.loc 2 1636 24
 5293 0966 83E004   		andl	$4, %eax
 5294              		.loc 2 1636 7
 5295 0969 85C0     		testl	%eax, %eax
 5296 096b 0F849B00 		je	.L363
 5296      0000
1637:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1638:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ret = mbedtls_snprintf( p, n, "\n%skey usage         : ", prefix );
 5297              		.loc 2 1638 15
 5298 0971 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 5298      000000
 5299 0978 488B75C0 		movq	-64(%rbp), %rsi
 5300 097c 488B45C8 		movq	-56(%rbp), %rax
 5301 0980 488B5598 		movq	-104(%rbp), %rdx
 5302 0984 4889D1   		movq	%rdx, %rcx
 5303 0987 488D1500 		leaq	.LC38(%rip), %rdx
 5303      000000
 5304 098e 4889C7   		movq	%rax, %rdi
 5305 0991 B8000000 		movl	$0, %eax
 5305      00
 5306 0996 41FFD0   		call	*%r8
 5307              	.LVL31:
 5308 0999 8945BC   		movl	%eax, -68(%rbp)
1639:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         MBEDTLS_X509_SAFE_SNPRINTF;
 5309              		.loc 2 1639 9
 5310 099c 837DBC00 		cmpl	$0, -68(%rbp)
 5311 09a0 780F     		js	.L364
 5312              		.loc 2 1639 9 is_stmt 0 discriminator 2
 5313 09a2 8B45BC   		movl	-68(%rbp), %eax
 5314 09a5 4863D0   		movslq	%eax, %rdx
 5315 09a8 488B45C0 		movq	-64(%rbp), %rax
GAS LISTING /tmp/ccnlqVtp.s 			page 144


 5316 09ac 4839C2   		cmpq	%rax, %rdx
 5317 09af 720A     		jb	.L365
 5318              	.L364:
 5319              		.loc 2 1639 9 discriminator 3
 5320 09b1 B880D6FF 		movl	$-10624, %eax
 5320      FF
 5321 09b6 E9750100 		jmp	.L371
 5321      00
 5322              	.L365:
 5323              		.loc 2 1639 9 discriminator 4
 5324 09bb 488B55C0 		movq	-64(%rbp), %rdx
 5325 09bf 8B45BC   		movl	-68(%rbp), %eax
 5326 09c2 4898     		cltq
 5327 09c4 4829C2   		subq	%rax, %rdx
 5328 09c7 4889D0   		movq	%rdx, %rax
 5329 09ca 488945C0 		movq	%rax, -64(%rbp)
 5330 09ce 488B55C8 		movq	-56(%rbp), %rdx
 5331 09d2 8B45BC   		movl	-68(%rbp), %eax
 5332 09d5 4898     		cltq
 5333 09d7 4801D0   		addq	%rdx, %rax
 5334 09da 488945C8 		movq	%rax, -56(%rbp)
1640:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1641:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ( ret = x509_info_key_usage( &p, &n, crt->key_usage ) ) != 0 )
 5335              		.loc 2 1641 21 is_stmt 1 discriminator 4
 5336 09de 488B4590 		movq	-112(%rbp), %rax
 5337 09e2 8B90CC01 		movl	460(%rax), %edx
 5337      0000
 5338 09e8 488D4DC0 		leaq	-64(%rbp), %rcx
 5339 09ec 488D45C8 		leaq	-56(%rbp), %rax
 5340 09f0 4889CE   		movq	%rcx, %rsi
 5341 09f3 4889C7   		movq	%rax, %rdi
 5342 09f6 E8000000 		call	x509_info_key_usage
 5342      00
 5343 09fb 8945BC   		movl	%eax, -68(%rbp)
 5344              		.loc 2 1641 11 discriminator 4
 5345 09fe 837DBC00 		cmpl	$0, -68(%rbp)
 5346 0a02 7408     		je	.L363
1642:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( ret );
 5347              		.loc 2 1642 19
 5348 0a04 8B45BC   		movl	-68(%rbp), %eax
 5349 0a07 E9240100 		jmp	.L371
 5349      00
 5350              	.L363:
1643:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1644:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1645:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( crt->ext_types & MBEDTLS_X509_EXT_EXTENDED_KEY_USAGE )
 5351              		.loc 2 1645 12
 5352 0a0c 488B4590 		movq	-112(%rbp), %rax
 5353 0a10 8B80C001 		movl	448(%rax), %eax
 5353      0000
 5354              		.loc 2 1645 24
 5355 0a16 25000800 		andl	$2048, %eax
 5355      00
 5356              		.loc 2 1645 7
 5357 0a1b 85C0     		testl	%eax, %eax
 5358 0a1d 0F849900 		je	.L366
 5358      0000
GAS LISTING /tmp/ccnlqVtp.s 			page 145


1646:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1647:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ret = mbedtls_snprintf( p, n, "\n%sext key usage     : ", prefix );
 5359              		.loc 2 1647 15
 5360 0a23 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 5360      000000
 5361 0a2a 488B75C0 		movq	-64(%rbp), %rsi
 5362 0a2e 488B45C8 		movq	-56(%rbp), %rax
 5363 0a32 488B5598 		movq	-104(%rbp), %rdx
 5364 0a36 4889D1   		movq	%rdx, %rcx
 5365 0a39 488D1500 		leaq	.LC39(%rip), %rdx
 5365      000000
 5366 0a40 4889C7   		movq	%rax, %rdi
 5367 0a43 B8000000 		movl	$0, %eax
 5367      00
 5368 0a48 41FFD0   		call	*%r8
 5369              	.LVL32:
 5370 0a4b 8945BC   		movl	%eax, -68(%rbp)
1648:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         MBEDTLS_X509_SAFE_SNPRINTF;
 5371              		.loc 2 1648 9
 5372 0a4e 837DBC00 		cmpl	$0, -68(%rbp)
 5373 0a52 780F     		js	.L367
 5374              		.loc 2 1648 9 is_stmt 0 discriminator 2
 5375 0a54 8B45BC   		movl	-68(%rbp), %eax
 5376 0a57 4863D0   		movslq	%eax, %rdx
 5377 0a5a 488B45C0 		movq	-64(%rbp), %rax
 5378 0a5e 4839C2   		cmpq	%rax, %rdx
 5379 0a61 720A     		jb	.L368
 5380              	.L367:
 5381              		.loc 2 1648 9 discriminator 3
 5382 0a63 B880D6FF 		movl	$-10624, %eax
 5382      FF
 5383 0a68 E9C30000 		jmp	.L371
 5383      00
 5384              	.L368:
 5385              		.loc 2 1648 9 discriminator 4
 5386 0a6d 488B55C0 		movq	-64(%rbp), %rdx
 5387 0a71 8B45BC   		movl	-68(%rbp), %eax
 5388 0a74 4898     		cltq
 5389 0a76 4829C2   		subq	%rax, %rdx
 5390 0a79 4889D0   		movq	%rdx, %rax
 5391 0a7c 488945C0 		movq	%rax, -64(%rbp)
 5392 0a80 488B55C8 		movq	-56(%rbp), %rdx
 5393 0a84 8B45BC   		movl	-68(%rbp), %eax
 5394 0a87 4898     		cltq
 5395 0a89 4801D0   		addq	%rdx, %rax
 5396 0a8c 488945C8 		movq	%rax, -56(%rbp)
1649:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1650:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ( ret = x509_info_ext_key_usage( &p, &n,
 5397              		.loc 2 1650 21 is_stmt 1 discriminator 4
 5398 0a90 488B4590 		movq	-112(%rbp), %rax
 5399 0a94 488D90D0 		leaq	464(%rax), %rdx
 5399      010000
 5400 0a9b 488D4DC0 		leaq	-64(%rbp), %rcx
 5401 0a9f 488D45C8 		leaq	-56(%rbp), %rax
 5402 0aa3 4889CE   		movq	%rcx, %rsi
 5403 0aa6 4889C7   		movq	%rax, %rdi
 5404 0aa9 E8000000 		call	x509_info_ext_key_usage
GAS LISTING /tmp/ccnlqVtp.s 			page 146


 5404      00
 5405 0aae 8945BC   		movl	%eax, -68(%rbp)
 5406              		.loc 2 1650 11 discriminator 4
 5407 0ab1 837DBC00 		cmpl	$0, -68(%rbp)
 5408 0ab5 7405     		je	.L366
1651:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                              &crt->ext_key_usage ) ) != 0 )
1652:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( ret );
 5409              		.loc 2 1652 19
 5410 0ab7 8B45BC   		movl	-68(%rbp), %eax
 5411 0aba EB74     		jmp	.L371
 5412              	.L366:
1653:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1654:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1655:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     ret = mbedtls_snprintf( p, n, "\n" );
 5413              		.loc 2 1655 11
 5414 0abc 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 5414      000000
 5415 0ac3 488B4DC0 		movq	-64(%rbp), %rcx
 5416 0ac7 488B45C8 		movq	-56(%rbp), %rax
 5417 0acb 488D1500 		leaq	.LC40(%rip), %rdx
 5417      000000
 5418 0ad2 4889CE   		movq	%rcx, %rsi
 5419 0ad5 4889C7   		movq	%rax, %rdi
 5420 0ad8 B8000000 		movl	$0, %eax
 5420      00
 5421 0add 41FFD0   		call	*%r8
 5422              	.LVL33:
 5423 0ae0 8945BC   		movl	%eax, -68(%rbp)
1656:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     MBEDTLS_X509_SAFE_SNPRINTF;
 5424              		.loc 2 1656 5
 5425 0ae3 837DBC00 		cmpl	$0, -68(%rbp)
 5426 0ae7 780F     		js	.L369
 5427              		.loc 2 1656 5 is_stmt 0 discriminator 2
 5428 0ae9 8B45BC   		movl	-68(%rbp), %eax
 5429 0aec 4863D0   		movslq	%eax, %rdx
 5430 0aef 488B45C0 		movq	-64(%rbp), %rax
 5431 0af3 4839C2   		cmpq	%rax, %rdx
 5432 0af6 7207     		jb	.L370
 5433              	.L369:
 5434              		.loc 2 1656 5 discriminator 3
 5435 0af8 B880D6FF 		movl	$-10624, %eax
 5435      FF
 5436 0afd EB31     		jmp	.L371
 5437              	.L370:
 5438              		.loc 2 1656 5 discriminator 4
 5439 0aff 488B55C0 		movq	-64(%rbp), %rdx
 5440 0b03 8B45BC   		movl	-68(%rbp), %eax
 5441 0b06 4898     		cltq
 5442 0b08 4829C2   		subq	%rax, %rdx
 5443 0b0b 4889D0   		movq	%rdx, %rax
 5444 0b0e 488945C0 		movq	%rax, -64(%rbp)
 5445 0b12 488B55C8 		movq	-56(%rbp), %rdx
 5446 0b16 8B45BC   		movl	-68(%rbp), %eax
 5447 0b19 4898     		cltq
 5448 0b1b 4801D0   		addq	%rdx, %rax
 5449 0b1e 488945C8 		movq	%rax, -56(%rbp)
1657:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
GAS LISTING /tmp/ccnlqVtp.s 			page 147


1658:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( (int) ( size - n ) );
 5450              		.loc 2 1658 26 is_stmt 1 discriminator 4
 5451 0b22 488B45A0 		movq	-96(%rbp), %rax
 5452 0b26 89C2     		movl	%eax, %edx
 5453 0b28 488B45C0 		movq	-64(%rbp), %rax
 5454 0b2c 29C2     		subl	%eax, %edx
 5455 0b2e 89D0     		movl	%edx, %eax
 5456              	.L371:
1659:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 5457              		.loc 2 1659 1 discriminator 1
 5458 0b30 488B5DE8 		movq	-24(%rbp), %rbx
 5459 0b34 6448331C 		xorq	%fs:40, %rbx
 5459      25280000 
 5459      00
 5460 0b3d 7405     		je	.L372
 5461              		.loc 2 1659 1 is_stmt 0
 5462 0b3f E8000000 		call	__stack_chk_fail@PLT
 5462      00
 5463              	.L372:
 5464 0b44 488B5DF8 		movq	-8(%rbp), %rbx
 5465 0b48 C9       		leave
 5466              	.LCFI77:
 5467              		.cfi_def_cfa 7, 8
 5468 0b49 C3       		ret
 5469              		.cfi_endproc
 5470              	.LFE40:
 5472              		.section	.rodata
 5473 0302 00000000 		.align 8
 5473      0000
 5474              	.LC41:
 5475 0308 54686520 		.string	"The certificate validity has expired"
 5475      63657274 
 5475      69666963 
 5475      61746520 
 5475      76616C69 
 5476 032d 000000   		.align 8
 5477              	.LC42:
 5478 0330 54686520 		.string	"The certificate has been revoked (is on a CRL)"
 5478      63657274 
 5478      69666963 
 5478      61746520 
 5478      68617320 
 5479 035f 00       		.align 8
 5480              	.LC43:
 5481 0360 54686520 		.string	"The certificate Common Name (CN) does not match with the expected CN"
 5481      63657274 
 5481      69666963 
 5481      61746520 
 5481      436F6D6D 
 5482 03a5 000000   		.align 8
 5483              	.LC44:
 5484 03a8 54686520 		.string	"The certificate is not correctly signed by the trusted CA"
 5484      63657274 
 5484      69666963 
 5484      61746520 
 5484      6973206E 
 5485 03e2 00000000 		.align 8
GAS LISTING /tmp/ccnlqVtp.s 			page 148


 5485      0000
 5486              	.LC45:
 5487 03e8 54686520 		.string	"The CRL is not correctly signed by the trusted CA"
 5487      43524C20 
 5487      6973206E 
 5487      6F742063 
 5487      6F727265 
 5488              	.LC46:
 5489 041a 54686520 		.string	"The CRL is expired"
 5489      43524C20 
 5489      69732065 
 5489      78706972 
 5489      656400
 5490              	.LC47:
 5491 042d 43657274 		.string	"Certificate was missing"
 5491      69666963 
 5491      61746520 
 5491      77617320 
 5491      6D697373 
 5492 0445 000000   		.align 8
 5493              	.LC48:
 5494 0448 43657274 		.string	"Certificate verification was skipped"
 5494      69666963 
 5494      61746520 
 5494      76657269 
 5494      66696361 
 5495 046d 000000   		.align 8
 5496              	.LC49:
 5497 0470 4F746865 		.string	"Other reason (can be used by verify callback)"
 5497      72207265 
 5497      61736F6E 
 5497      20286361 
 5497      6E206265 
 5498 049e 0000     		.align 8
 5499              	.LC50:
 5500 04a0 54686520 		.string	"The certificate validity starts in the future"
 5500      63657274 
 5500      69666963 
 5500      61746520 
 5500      76616C69 
 5501              	.LC51:
 5502 04ce 54686520 		.string	"The CRL is from the future"
 5502      43524C20 
 5502      69732066 
 5502      726F6D20 
 5502      74686520 
 5503 04e9 00000000 		.align 8
 5503      000000
 5504              	.LC52:
 5505 04f0 55736167 		.string	"Usage does not match the keyUsage extension"
 5505      6520646F 
 5505      6573206E 
 5505      6F74206D 
 5505      61746368 
 5506 051c 00000000 		.align 8
 5507              	.LC53:
 5508 0520 55736167 		.string	"Usage does not match the extendedKeyUsage extension"
GAS LISTING /tmp/ccnlqVtp.s 			page 149


 5508      6520646F 
 5508      6573206E 
 5508      6F74206D 
 5508      61746368 
 5509 0554 00000000 		.align 8
 5510              	.LC54:
 5511 0558 55736167 		.string	"Usage does not match the nsCertType extension"
 5511      6520646F 
 5511      6573206E 
 5511      6F74206D 
 5511      61746368 
 5512 0586 0000     		.align 8
 5513              	.LC55:
 5514 0588 54686520 		.string	"The certificate is signed with an unacceptable hash."
 5514      63657274 
 5514      69666963 
 5514      61746520 
 5514      69732073 
 5515 05bd 000000   		.align 8
 5516              	.LC56:
 5517 05c0 54686520 		.string	"The certificate is signed with an unacceptable PK alg (eg RSA vs ECDSA)."
 5517      63657274 
 5517      69666963 
 5517      61746520 
 5517      69732073 
 5518 0609 00000000 		.align 8
 5518      000000
 5519              	.LC57:
 5520 0610 54686520 		.string	"The certificate is signed with an unacceptable key (eg bad curve, RSA too short)."
 5520      63657274 
 5520      69666963 
 5520      61746520 
 5520      69732073 
 5521 0662 00000000 		.align 8
 5521      0000
 5522              	.LC58:
 5523 0668 54686520 		.string	"The CRL is signed with an unacceptable hash."
 5523      43524C20 
 5523      69732073 
 5523      69676E65 
 5523      64207769 
 5524 0695 000000   		.align 8
 5525              	.LC59:
 5526 0698 54686520 		.string	"The CRL is signed with an unacceptable PK alg (eg RSA vs ECDSA)."
 5526      43524C20 
 5526      69732073 
 5526      69676E65 
 5526      64207769 
 5527 06d9 00000000 		.align 8
 5527      000000
 5528              	.LC60:
 5529 06e0 54686520 		.string	"The CRL is signed with an unacceptable key (eg bad curve, RSA too short)."
 5529      43524C20 
 5529      69732073 
 5529      69676E65 
 5529      64207769 
 5530              		.section	.data.rel.ro.local.x509_crt_verify_strings,"aw"
GAS LISTING /tmp/ccnlqVtp.s 			page 150


 5531              		.align 32
 5534              	x509_crt_verify_strings:
 5535 0000 01000000 		.long	1
 5536 0004 00000000 		.zero	4
 5537 0008 00000000 		.quad	.LC41
 5537      00000000 
 5538 0010 02000000 		.long	2
 5539 0014 00000000 		.zero	4
 5540 0018 00000000 		.quad	.LC42
 5540      00000000 
 5541 0020 04000000 		.long	4
 5542 0024 00000000 		.zero	4
 5543 0028 00000000 		.quad	.LC43
 5543      00000000 
 5544 0030 08000000 		.long	8
 5545 0034 00000000 		.zero	4
 5546 0038 00000000 		.quad	.LC44
 5546      00000000 
 5547 0040 10000000 		.long	16
 5548 0044 00000000 		.zero	4
 5549 0048 00000000 		.quad	.LC45
 5549      00000000 
 5550 0050 20000000 		.long	32
 5551 0054 00000000 		.zero	4
 5552 0058 00000000 		.quad	.LC46
 5552      00000000 
 5553 0060 40000000 		.long	64
 5554 0064 00000000 		.zero	4
 5555 0068 00000000 		.quad	.LC47
 5555      00000000 
 5556 0070 80000000 		.long	128
 5557 0074 00000000 		.zero	4
 5558 0078 00000000 		.quad	.LC48
 5558      00000000 
 5559 0080 00010000 		.long	256
 5560 0084 00000000 		.zero	4
 5561 0088 00000000 		.quad	.LC49
 5561      00000000 
 5562 0090 00020000 		.long	512
 5563 0094 00000000 		.zero	4
 5564 0098 00000000 		.quad	.LC50
 5564      00000000 
 5565 00a0 00040000 		.long	1024
 5566 00a4 00000000 		.zero	4
 5567 00a8 00000000 		.quad	.LC51
 5567      00000000 
 5568 00b0 00080000 		.long	2048
 5569 00b4 00000000 		.zero	4
 5570 00b8 00000000 		.quad	.LC52
 5570      00000000 
 5571 00c0 00100000 		.long	4096
 5572 00c4 00000000 		.zero	4
 5573 00c8 00000000 		.quad	.LC53
 5573      00000000 
 5574 00d0 00200000 		.long	8192
 5575 00d4 00000000 		.zero	4
 5576 00d8 00000000 		.quad	.LC54
GAS LISTING /tmp/ccnlqVtp.s 			page 151


 5576      00000000 
 5577 00e0 00400000 		.long	16384
 5578 00e4 00000000 		.zero	4
 5579 00e8 00000000 		.quad	.LC55
 5579      00000000 
 5580 00f0 00800000 		.long	32768
 5581 00f4 00000000 		.zero	4
 5582 00f8 00000000 		.quad	.LC56
 5582      00000000 
 5583 0100 00000100 		.long	65536
 5584 0104 00000000 		.zero	4
 5585 0108 00000000 		.quad	.LC57
 5585      00000000 
 5586 0110 00000200 		.long	131072
 5587 0114 00000000 		.zero	4
 5588 0118 00000000 		.quad	.LC58
 5588      00000000 
 5589 0120 00000400 		.long	262144
 5590 0124 00000000 		.zero	4
 5591 0128 00000000 		.quad	.LC59
 5591      00000000 
 5592 0130 00000800 		.long	524288
 5593 0134 00000000 		.zero	4
 5594 0138 00000000 		.quad	.LC60
 5594      00000000 
 5595 0140 00000000 		.long	0
 5596 0144 00000000 		.zero	4
 5597 0148 00000000 		.quad	0
 5597      00000000 
 5598              		.section	.rodata
 5599              	.LC61:
 5600 072a 25732573 		.string	"%s%s\n"
 5600      0A00
 5601              		.align 8
 5602              	.LC62:
 5603 0730 2573556E 		.string	"%sUnknown reason (this should not happen)\n"
 5603      6B6E6F77 
 5603      6E207265 
 5603      61736F6E 
 5603      20287468 
 5604              		.section	.text.mbedtls_x509_crt_verify_info,"ax",@progbits
 5605              		.globl	mbedtls_x509_crt_verify_info
 5607              	mbedtls_x509_crt_verify_info:
 5608              	.LFB41:
1660:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1661:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** struct x509_crt_verify_string {
1662:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int code;
1663:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     const char *string;
1664:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** };
1665:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1666:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static const struct x509_crt_verify_string x509_crt_verify_strings[] = {
1667:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     { MBEDTLS_X509_BADCERT_EXPIRED,       "The certificate validity has expired" },
1668:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     { MBEDTLS_X509_BADCERT_REVOKED,       "The certificate has been revoked (is on a CRL)" },
1669:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     { MBEDTLS_X509_BADCERT_CN_MISMATCH,   "The certificate Common Name (CN) does not match with the
1670:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     { MBEDTLS_X509_BADCERT_NOT_TRUSTED,   "The certificate is not correctly signed by the trusted C
1671:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     { MBEDTLS_X509_BADCRL_NOT_TRUSTED,    "The CRL is not correctly signed by the trusted CA" },
1672:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     { MBEDTLS_X509_BADCRL_EXPIRED,        "The CRL is expired" },
GAS LISTING /tmp/ccnlqVtp.s 			page 152


1673:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     { MBEDTLS_X509_BADCERT_MISSING,       "Certificate was missing" },
1674:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     { MBEDTLS_X509_BADCERT_SKIP_VERIFY,   "Certificate verification was skipped" },
1675:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     { MBEDTLS_X509_BADCERT_OTHER,         "Other reason (can be used by verify callback)" },
1676:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     { MBEDTLS_X509_BADCERT_FUTURE,        "The certificate validity starts in the future" },
1677:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     { MBEDTLS_X509_BADCRL_FUTURE,         "The CRL is from the future" },
1678:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     { MBEDTLS_X509_BADCERT_KEY_USAGE,     "Usage does not match the keyUsage extension" },
1679:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     { MBEDTLS_X509_BADCERT_EXT_KEY_USAGE, "Usage does not match the extendedKeyUsage extension" },
1680:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     { MBEDTLS_X509_BADCERT_NS_CERT_TYPE,  "Usage does not match the nsCertType extension" },
1681:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     { MBEDTLS_X509_BADCERT_BAD_MD,        "The certificate is signed with an unacceptable hash." },
1682:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     { MBEDTLS_X509_BADCERT_BAD_PK,        "The certificate is signed with an unacceptable PK alg (e
1683:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     { MBEDTLS_X509_BADCERT_BAD_KEY,       "The certificate is signed with an unacceptable key (eg b
1684:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     { MBEDTLS_X509_BADCRL_BAD_MD,         "The CRL is signed with an unacceptable hash." },
1685:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     { MBEDTLS_X509_BADCRL_BAD_PK,         "The CRL is signed with an unacceptable PK alg (eg RSA vs
1686:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     { MBEDTLS_X509_BADCRL_BAD_KEY,        "The CRL is signed with an unacceptable key (eg bad curve
1687:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     { 0, NULL }
1688:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** };
1689:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1690:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** int mbedtls_x509_crt_verify_info( char *buf, size_t size, const char *prefix,
1691:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                           uint32_t flags )
1692:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 5609              		.loc 2 1692 1 is_stmt 1
 5610              		.cfi_startproc
 5611 0000 F30F1EFA 		endbr64
 5612 0004 55       		pushq	%rbp
 5613              	.LCFI78:
 5614              		.cfi_def_cfa_offset 16
 5615              		.cfi_offset 6, -16
 5616 0005 4889E5   		movq	%rsp, %rbp
 5617              	.LCFI79:
 5618              		.cfi_def_cfa_register 6
 5619 0008 4883EC50 		subq	$80, %rsp
 5620 000c 48897DC8 		movq	%rdi, -56(%rbp)
 5621 0010 488975C0 		movq	%rsi, -64(%rbp)
 5622 0014 488955B8 		movq	%rdx, -72(%rbp)
 5623 0018 894DB4   		movl	%ecx, -76(%rbp)
 5624              		.loc 2 1692 1
 5625 001b 64488B04 		movq	%fs:40, %rax
 5625      25280000 
 5625      00
 5626 0024 488945F8 		movq	%rax, -8(%rbp)
 5627 0028 31C0     		xorl	%eax, %eax
1693:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int ret;
1694:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     const struct x509_crt_verify_string *cur;
1695:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     char *p = buf;
 5628              		.loc 2 1695 11
 5629 002a 488B45C8 		movq	-56(%rbp), %rax
 5630 002e 488945E8 		movq	%rax, -24(%rbp)
1696:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     size_t n = size;
 5631              		.loc 2 1696 12
 5632 0032 488B45C0 		movq	-64(%rbp), %rax
 5633 0036 488945F0 		movq	%rax, -16(%rbp)
1697:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1698:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     for( cur = x509_crt_verify_strings; cur->string != NULL ; cur++ )
 5634              		.loc 2 1698 14
 5635 003a 488D0500 		leaq	x509_crt_verify_strings(%rip), %rax
 5635      000000
 5636 0041 488945E0 		movq	%rax, -32(%rbp)
GAS LISTING /tmp/ccnlqVtp.s 			page 153


 5637              		.loc 2 1698 5
 5638 0045 E9810000 		jmp	.L374
 5638      00
 5639              	.L380:
1699:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1700:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ( flags & cur->code ) == 0 )
 5640              		.loc 2 1700 26
 5641 004a 488B45E0 		movq	-32(%rbp), %rax
 5642 004e 8B00     		movl	(%rax), %eax
 5643              		.loc 2 1700 21
 5644 0050 2345B4   		andl	-76(%rbp), %eax
 5645              		.loc 2 1700 11
 5646 0053 85C0     		testl	%eax, %eax
 5647 0055 746E     		je	.L385
1701:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             continue;
1702:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1703:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ret = mbedtls_snprintf( p, n, "%s%s\n", prefix, cur->string );
 5648              		.loc 2 1703 15
 5649 0057 4C8B0D00 		movq	mbedtls_snprintf(%rip), %r9
 5649      000000
 5650 005e 488B45E0 		movq	-32(%rbp), %rax
 5651 0062 488B4808 		movq	8(%rax), %rcx
 5652 0066 488B55B8 		movq	-72(%rbp), %rdx
 5653 006a 488B75F0 		movq	-16(%rbp), %rsi
 5654 006e 488B45E8 		movq	-24(%rbp), %rax
 5655 0072 4989C8   		movq	%rcx, %r8
 5656 0075 4889D1   		movq	%rdx, %rcx
 5657 0078 488D1500 		leaq	.LC61(%rip), %rdx
 5657      000000
 5658 007f 4889C7   		movq	%rax, %rdi
 5659 0082 B8000000 		movl	$0, %eax
 5659      00
 5660 0087 41FFD1   		call	*%r9
 5661              	.LVL34:
 5662 008a 8945DC   		movl	%eax, -36(%rbp)
1704:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         MBEDTLS_X509_SAFE_SNPRINTF;
 5663              		.loc 2 1704 9
 5664 008d 837DDC00 		cmpl	$0, -36(%rbp)
 5665 0091 780B     		js	.L377
 5666              		.loc 2 1704 9 is_stmt 0 discriminator 2
 5667 0093 8B45DC   		movl	-36(%rbp), %eax
 5668 0096 4898     		cltq
 5669 0098 483945F0 		cmpq	%rax, -16(%rbp)
 5670 009c 770A     		ja	.L378
 5671              	.L377:
 5672              		.loc 2 1704 9 discriminator 3
 5673 009e B880D6FF 		movl	$-10624, %eax
 5673      FF
 5674 00a3 E99D0000 		jmp	.L379
 5674      00
 5675              	.L378:
 5676              		.loc 2 1704 9 discriminator 4
 5677 00a8 8B45DC   		movl	-36(%rbp), %eax
 5678 00ab 4898     		cltq
 5679 00ad 482945F0 		subq	%rax, -16(%rbp)
 5680 00b1 8B45DC   		movl	-36(%rbp), %eax
 5681 00b4 4898     		cltq
GAS LISTING /tmp/ccnlqVtp.s 			page 154


 5682 00b6 480145E8 		addq	%rax, -24(%rbp)
1705:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         flags ^= cur->code;
 5683              		.loc 2 1705 21 is_stmt 1 discriminator 4
 5684 00ba 488B45E0 		movq	-32(%rbp), %rax
 5685 00be 8B00     		movl	(%rax), %eax
 5686              		.loc 2 1705 15 discriminator 4
 5687 00c0 3145B4   		xorl	%eax, -76(%rbp)
 5688 00c3 EB01     		jmp	.L376
 5689              	.L385:
1701:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             continue;
 5690              		.loc 2 1701 13
 5691 00c5 90       		nop
 5692              	.L376:
1698:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 5693              		.loc 2 1698 66 discriminator 2
 5694 00c6 488345E0 		addq	$16, -32(%rbp)
 5694      10
 5695              	.L374:
1698:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 5696              		.loc 2 1698 44 discriminator 1
 5697 00cb 488B45E0 		movq	-32(%rbp), %rax
 5698 00cf 488B4008 		movq	8(%rax), %rax
1698:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 5699              		.loc 2 1698 5 discriminator 1
 5700 00d3 4885C0   		testq	%rax, %rax
 5701 00d6 0F856EFF 		jne	.L380
 5701      FFFF
1706:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1707:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1708:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( flags != 0 )
 5702              		.loc 2 1708 7
 5703 00dc 837DB400 		cmpl	$0, -76(%rbp)
 5704 00e0 7455     		je	.L381
1709:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1710:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ret = mbedtls_snprintf( p, n, "%sUnknown reason "
 5705              		.loc 2 1710 15
 5706 00e2 4C8B0500 		movq	mbedtls_snprintf(%rip), %r8
 5706      000000
 5707 00e9 488B55B8 		movq	-72(%rbp), %rdx
 5708 00ed 488B75F0 		movq	-16(%rbp), %rsi
 5709 00f1 488B45E8 		movq	-24(%rbp), %rax
 5710 00f5 4889D1   		movq	%rdx, %rcx
 5711 00f8 488D1500 		leaq	.LC62(%rip), %rdx
 5711      000000
 5712 00ff 4889C7   		movq	%rax, %rdi
 5713 0102 B8000000 		movl	$0, %eax
 5713      00
 5714 0107 41FFD0   		call	*%r8
 5715              	.LVL35:
 5716 010a 8945DC   		movl	%eax, -36(%rbp)
1711:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                        "(this should not happen)\n", prefix );
1712:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         MBEDTLS_X509_SAFE_SNPRINTF;
 5717              		.loc 2 1712 9
 5718 010d 837DDC00 		cmpl	$0, -36(%rbp)
 5719 0111 780B     		js	.L382
 5720              		.loc 2 1712 9 is_stmt 0 discriminator 2
 5721 0113 8B45DC   		movl	-36(%rbp), %eax
GAS LISTING /tmp/ccnlqVtp.s 			page 155


 5722 0116 4898     		cltq
 5723 0118 483945F0 		cmpq	%rax, -16(%rbp)
 5724 011c 7707     		ja	.L383
 5725              	.L382:
 5726              		.loc 2 1712 9 discriminator 3
 5727 011e B880D6FF 		movl	$-10624, %eax
 5727      FF
 5728 0123 EB20     		jmp	.L379
 5729              	.L383:
 5730              		.loc 2 1712 9 discriminator 4
 5731 0125 8B45DC   		movl	-36(%rbp), %eax
 5732 0128 4898     		cltq
 5733 012a 482945F0 		subq	%rax, -16(%rbp)
 5734 012e 8B45DC   		movl	-36(%rbp), %eax
 5735 0131 4898     		cltq
 5736 0133 480145E8 		addq	%rax, -24(%rbp)
 5737              	.L381:
1713:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1714:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1715:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( (int) ( size - n ) );
 5738              		.loc 2 1715 26 is_stmt 1
 5739 0137 488B45C0 		movq	-64(%rbp), %rax
 5740 013b 89C2     		movl	%eax, %edx
 5741 013d 488B45F0 		movq	-16(%rbp), %rax
 5742 0141 29C2     		subl	%eax, %edx
 5743 0143 89D0     		movl	%edx, %eax
 5744              	.L379:
1716:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 5745              		.loc 2 1716 1
 5746 0145 488B7DF8 		movq	-8(%rbp), %rdi
 5747 0149 6448333C 		xorq	%fs:40, %rdi
 5747      25280000 
 5747      00
 5748 0152 7405     		je	.L384
 5749 0154 E8000000 		call	__stack_chk_fail@PLT
 5749      00
 5750              	.L384:
 5751 0159 C9       		leave
 5752              	.LCFI80:
 5753              		.cfi_def_cfa 7, 8
 5754 015a C3       		ret
 5755              		.cfi_endproc
 5756              	.LFE41:
 5758              		.section	.text.mbedtls_x509_crt_check_key_usage,"ax",@progbits
 5759              		.globl	mbedtls_x509_crt_check_key_usage
 5761              	mbedtls_x509_crt_check_key_usage:
 5762              	.LFB42:
1717:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1718:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_X509_CHECK_KEY_USAGE)
1719:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** int mbedtls_x509_crt_check_key_usage( const mbedtls_x509_crt *crt,
1720:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                       unsigned int usage )
1721:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 5763              		.loc 2 1721 1
 5764              		.cfi_startproc
 5765 0000 F30F1EFA 		endbr64
 5766 0004 55       		pushq	%rbp
 5767              	.LCFI81:
GAS LISTING /tmp/ccnlqVtp.s 			page 156


 5768              		.cfi_def_cfa_offset 16
 5769              		.cfi_offset 6, -16
 5770 0005 4889E5   		movq	%rsp, %rbp
 5771              	.LCFI82:
 5772              		.cfi_def_cfa_register 6
 5773 0008 4883EC30 		subq	$48, %rsp
 5774 000c 48897DD8 		movq	%rdi, -40(%rbp)
 5775 0010 8975D4   		movl	%esi, -44(%rbp)
 5776              		.loc 2 1721 1
 5777 0013 64488B04 		movq	%fs:40, %rax
 5777      25280000 
 5777      00
 5778 001c 488945F8 		movq	%rax, -8(%rbp)
 5779 0020 31C0     		xorl	%eax, %eax
1722:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     unsigned int usage_must, usage_may;
1723:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     unsigned int may_mask = MBEDTLS_X509_KU_ENCIPHER_ONLY
 5780              		.loc 2 1723 18
 5781 0022 C745EC01 		movl	$32769, -20(%rbp)
 5781      800000
1724:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                           | MBEDTLS_X509_KU_DECIPHER_ONLY;
1725:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1726:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( crt->ext_types & MBEDTLS_X509_EXT_KEY_USAGE ) == 0 )
 5782              		.loc 2 1726 14
 5783 0029 488B45D8 		movq	-40(%rbp), %rax
 5784 002d 8B80C001 		movl	448(%rax), %eax
 5784      0000
 5785              		.loc 2 1726 26
 5786 0033 83E004   		andl	$4, %eax
 5787              		.loc 2 1726 7
 5788 0036 85C0     		testl	%eax, %eax
 5789 0038 7507     		jne	.L387
1727:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( 0 );
 5790              		.loc 2 1727 15
 5791 003a B8000000 		movl	$0, %eax
 5791      00
 5792 003f EB55     		jmp	.L388
 5793              	.L387:
1728:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1729:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     usage_must = usage & ~may_mask;
 5794              		.loc 2 1729 26
 5795 0041 8B45EC   		movl	-20(%rbp), %eax
 5796 0044 F7D0     		notl	%eax
 5797              		.loc 2 1729 16
 5798 0046 2345D4   		andl	-44(%rbp), %eax
 5799 0049 8945F0   		movl	%eax, -16(%rbp)
1730:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1731:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ( crt->key_usage & ~may_mask ) & usage_must ) != usage_must )
 5800              		.loc 2 1731 16
 5801 004c 488B45D8 		movq	-40(%rbp), %rax
 5802 0050 8B80CC01 		movl	460(%rax), %eax
 5802      0000
 5803              		.loc 2 1731 30
 5804 0056 8B55EC   		movl	-20(%rbp), %edx
 5805 0059 F7D2     		notl	%edx
 5806              		.loc 2 1731 28
 5807 005b 21D0     		andl	%edx, %eax
 5808              		.loc 2 1731 42
GAS LISTING /tmp/ccnlqVtp.s 			page 157


 5809 005d 2345F0   		andl	-16(%rbp), %eax
 5810              		.loc 2 1731 7
 5811 0060 3945F0   		cmpl	%eax, -16(%rbp)
 5812 0063 7407     		je	.L389
1732:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_BAD_INPUT_DATA );
 5813              		.loc 2 1732 15
 5814 0065 B800D8FF 		movl	$-10240, %eax
 5814      FF
 5815 006a EB2A     		jmp	.L388
 5816              	.L389:
1733:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1734:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     usage_may = usage & may_mask;
 5817              		.loc 2 1734 15
 5818 006c 8B45D4   		movl	-44(%rbp), %eax
 5819 006f 2345EC   		andl	-20(%rbp), %eax
 5820 0072 8945F4   		movl	%eax, -12(%rbp)
1735:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1736:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( ( crt->key_usage & may_mask ) | usage_may ) != usage_may )
 5821              		.loc 2 1736 16
 5822 0075 488B45D8 		movq	-40(%rbp), %rax
 5823 0079 8B80CC01 		movl	460(%rax), %eax
 5823      0000
 5824              		.loc 2 1736 28
 5825 007f 2345EC   		andl	-20(%rbp), %eax
 5826              		.loc 2 1736 41
 5827 0082 0B45F4   		orl	-12(%rbp), %eax
 5828              		.loc 2 1736 7
 5829 0085 3945F4   		cmpl	%eax, -12(%rbp)
 5830 0088 7407     		je	.L390
1737:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_BAD_INPUT_DATA );
 5831              		.loc 2 1737 15
 5832 008a B800D8FF 		movl	$-10240, %eax
 5832      FF
 5833 008f EB05     		jmp	.L388
 5834              	.L390:
1738:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1739:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 5835              		.loc 2 1739 11
 5836 0091 B8000000 		movl	$0, %eax
 5836      00
 5837              	.L388:
1740:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 5838              		.loc 2 1740 1
 5839 0096 488B4DF8 		movq	-8(%rbp), %rcx
 5840 009a 6448330C 		xorq	%fs:40, %rcx
 5840      25280000 
 5840      00
 5841 00a3 7405     		je	.L391
 5842 00a5 E8000000 		call	__stack_chk_fail@PLT
 5842      00
 5843              	.L391:
 5844 00aa C9       		leave
 5845              	.LCFI83:
 5846              		.cfi_def_cfa 7, 8
 5847 00ab C3       		ret
 5848              		.cfi_endproc
 5849              	.LFE42:
GAS LISTING /tmp/ccnlqVtp.s 			page 158


 5851              		.section	.rodata
 5852              	.LC63:
 5853 075b 551D2500 		.string	"U\035%"
 5854 075f 00       		.string	""
 5855              		.section	.text.mbedtls_x509_crt_check_extended_key_usage,"ax",@progbits
 5856              		.globl	mbedtls_x509_crt_check_extended_key_usage
 5858              	mbedtls_x509_crt_check_extended_key_usage:
 5859              	.LFB43:
1741:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
1742:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1743:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_X509_CHECK_EXTENDED_KEY_USAGE)
1744:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** int mbedtls_x509_crt_check_extended_key_usage( const mbedtls_x509_crt *crt,
1745:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                        const char *usage_oid,
1746:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                        size_t usage_len )
1747:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 5860              		.loc 2 1747 1
 5861              		.cfi_startproc
 5862 0000 F30F1EFA 		endbr64
 5863 0004 55       		pushq	%rbp
 5864              	.LCFI84:
 5865              		.cfi_def_cfa_offset 16
 5866              		.cfi_offset 6, -16
 5867 0005 4889E5   		movq	%rsp, %rbp
 5868              	.LCFI85:
 5869              		.cfi_def_cfa_register 6
 5870 0008 4883EC40 		subq	$64, %rsp
 5871 000c 48897DD8 		movq	%rdi, -40(%rbp)
 5872 0010 488975D0 		movq	%rsi, -48(%rbp)
 5873 0014 488955C8 		movq	%rdx, -56(%rbp)
 5874              		.loc 2 1747 1
 5875 0018 64488B04 		movq	%fs:40, %rax
 5875      25280000 
 5875      00
 5876 0021 488945F8 		movq	%rax, -8(%rbp)
 5877 0025 31C0     		xorl	%eax, %eax
1748:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     const mbedtls_x509_sequence *cur;
1749:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1750:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Extension is not mandatory, absent means no restriction */
1751:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ( crt->ext_types & MBEDTLS_X509_EXT_EXTENDED_KEY_USAGE ) == 0 )
 5878              		.loc 2 1751 14
 5879 0027 488B45D8 		movq	-40(%rbp), %rax
 5880 002b 8B80C001 		movl	448(%rax), %eax
 5880      0000
 5881              		.loc 2 1751 26
 5882 0031 25000800 		andl	$2048, %eax
 5882      00
 5883              		.loc 2 1751 7
 5884 0036 85C0     		testl	%eax, %eax
 5885 0038 750A     		jne	.L393
1752:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( 0 );
 5886              		.loc 2 1752 15
 5887 003a B8000000 		movl	$0, %eax
 5887      00
 5888 003f E9B30000 		jmp	.L394
 5888      00
 5889              	.L393:
1753:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
GAS LISTING /tmp/ccnlqVtp.s 			page 159


1754:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /*
1755:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      * Look for the requested usage (or wildcard ANY) in our list
1756:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      */
1757:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     for( cur = &crt->ext_key_usage; cur != NULL; cur = cur->next )
 5890              		.loc 2 1757 14
 5891 0044 488B45D8 		movq	-40(%rbp), %rax
 5892 0048 4805D001 		addq	$464, %rax
 5892      0000
 5893 004e 488945E8 		movq	%rax, -24(%rbp)
 5894              		.loc 2 1757 5
 5895 0052 E9900000 		jmp	.L395
 5895      00
 5896              	.L401:
 5897              	.LBB7:
1758:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1759:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         const mbedtls_x509_buf *cur_oid = &cur->buf;
 5898              		.loc 2 1759 33
 5899 0057 488B45E8 		movq	-24(%rbp), %rax
 5900 005b 488945F0 		movq	%rax, -16(%rbp)
1760:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1761:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( cur_oid->len == usage_len &&
 5901              		.loc 2 1761 20
 5902 005f 488B45F0 		movq	-16(%rbp), %rax
 5903 0063 488B4008 		movq	8(%rax), %rax
 5904              		.loc 2 1761 11
 5905 0067 483945C8 		cmpq	%rax, -56(%rbp)
 5906 006b 7526     		jne	.L396
1762:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             memcmp( cur_oid->p, usage_oid, usage_len ) == 0 )
 5907              		.loc 2 1762 28 discriminator 1
 5908 006d 488B45F0 		movq	-16(%rbp), %rax
 5909 0071 488B4010 		movq	16(%rax), %rax
 5910              		.loc 2 1762 13 discriminator 1
 5911 0075 488B55C8 		movq	-56(%rbp), %rdx
 5912 0079 488B4DD0 		movq	-48(%rbp), %rcx
 5913 007d 4889CE   		movq	%rcx, %rsi
 5914 0080 4889C7   		movq	%rax, %rdi
 5915 0083 E8000000 		call	memcmp@PLT
 5915      00
1761:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             memcmp( cur_oid->p, usage_oid, usage_len ) == 0 )
 5916              		.loc 2 1761 39 discriminator 1
 5917 0088 85C0     		testl	%eax, %eax
 5918 008a 7507     		jne	.L396
1763:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
1764:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( 0 );
 5919              		.loc 2 1764 19
 5920 008c B8000000 		movl	$0, %eax
 5920      00
 5921 0091 EB64     		jmp	.L394
 5922              	.L396:
1765:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
1766:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1767:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( MBEDTLS_OID_CMP( MBEDTLS_OID_ANY_EXTENDED_KEY_USAGE, cur_oid ) == 0 )
 5923              		.loc 2 1767 13
 5924 0093 488B45F0 		movq	-16(%rbp), %rax
 5925 0097 488B4008 		movq	8(%rax), %rax
 5926 009b 4883F804 		cmpq	$4, %rax
 5927 009f 7523     		jne	.L397
GAS LISTING /tmp/ccnlqVtp.s 			page 160


 5928              		.loc 2 1767 13 is_stmt 0 discriminator 2
 5929 00a1 488B45F0 		movq	-16(%rbp), %rax
 5930 00a5 488B5008 		movq	8(%rax), %rdx
 5931 00a9 488B45F0 		movq	-16(%rbp), %rax
 5932 00ad 488B4010 		movq	16(%rax), %rax
 5933 00b1 4889C6   		movq	%rax, %rsi
 5934 00b4 488D3D00 		leaq	.LC63(%rip), %rdi
 5934      000000
 5935 00bb E8000000 		call	memcmp@PLT
 5935      00
 5936 00c0 85C0     		testl	%eax, %eax
 5937 00c2 7407     		je	.L398
 5938              	.L397:
 5939              		.loc 2 1767 13 discriminator 3
 5940 00c4 B8010000 		movl	$1, %eax
 5940      00
 5941 00c9 EB05     		jmp	.L399
 5942              	.L398:
 5943              		.loc 2 1767 13 discriminator 4
 5944 00cb B8000000 		movl	$0, %eax
 5944      00
 5945              	.L399:
 5946              		.loc 2 1767 11 is_stmt 1 discriminator 6
 5947 00d0 85C0     		testl	%eax, %eax
 5948 00d2 7507     		jne	.L400
1768:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( 0 );
 5949              		.loc 2 1768 19
 5950 00d4 B8000000 		movl	$0, %eax
 5950      00
 5951 00d9 EB1C     		jmp	.L394
 5952              	.L400:
 5953              	.LBE7:
1757:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 5954              		.loc 2 1757 54 discriminator 2
 5955 00db 488B45E8 		movq	-24(%rbp), %rax
 5956 00df 488B4018 		movq	24(%rax), %rax
 5957 00e3 488945E8 		movq	%rax, -24(%rbp)
 5958              	.L395:
1757:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 5959              		.loc 2 1757 5 discriminator 1
 5960 00e7 48837DE8 		cmpq	$0, -24(%rbp)
 5960      00
 5961 00ec 0F8565FF 		jne	.L401
 5961      FFFF
1769:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1770:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1771:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( MBEDTLS_ERR_X509_BAD_INPUT_DATA );
 5962              		.loc 2 1771 11
 5963 00f2 B800D8FF 		movl	$-10240, %eax
 5963      FF
 5964              	.L394:
1772:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 5965              		.loc 2 1772 1
 5966 00f7 488B4DF8 		movq	-8(%rbp), %rcx
 5967 00fb 6448330C 		xorq	%fs:40, %rcx
 5967      25280000 
 5967      00
GAS LISTING /tmp/ccnlqVtp.s 			page 161


 5968 0104 7405     		je	.L402
 5969 0106 E8000000 		call	__stack_chk_fail@PLT
 5969      00
 5970              	.L402:
 5971 010b C9       		leave
 5972              	.LCFI86:
 5973              		.cfi_def_cfa 7, 8
 5974 010c C3       		ret
 5975              		.cfi_endproc
 5976              	.LFE43:
 5978              		.section	.text.mbedtls_x509_crt_is_revoked,"ax",@progbits
 5979              		.globl	mbedtls_x509_crt_is_revoked
 5981              	mbedtls_x509_crt_is_revoked:
 5982              	.LFB44:
1773:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif /* MBEDTLS_X509_CHECK_EXTENDED_KEY_USAGE */
1774:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1775:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_X509_CRL_PARSE_C)
1776:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
1777:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Return 1 if the certificate is revoked, or 0 otherwise.
1778:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
1779:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** int mbedtls_x509_crt_is_revoked( const mbedtls_x509_crt *crt, const mbedtls_x509_crl *crl )
1780:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 5983              		.loc 2 1780 1
 5984              		.cfi_startproc
 5985 0000 F30F1EFA 		endbr64
 5986 0004 55       		pushq	%rbp
 5987              	.LCFI87:
 5988              		.cfi_def_cfa_offset 16
 5989              		.cfi_offset 6, -16
 5990 0005 4889E5   		movq	%rsp, %rbp
 5991              	.LCFI88:
 5992              		.cfi_def_cfa_register 6
 5993 0008 4883EC20 		subq	$32, %rsp
 5994 000c 48897DE8 		movq	%rdi, -24(%rbp)
 5995 0010 488975E0 		movq	%rsi, -32(%rbp)
 5996              		.loc 2 1780 1
 5997 0014 64488B04 		movq	%fs:40, %rax
 5997      25280000 
 5997      00
 5998 001d 488945F8 		movq	%rax, -8(%rbp)
 5999 0021 31C0     		xorl	%eax, %eax
1781:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     const mbedtls_x509_crl_entry *cur = &crl->entry;
 6000              		.loc 2 1781 35
 6001 0023 488B45E0 		movq	-32(%rbp), %rax
 6002 0027 4805D800 		addq	$216, %rax
 6002      0000
 6003 002d 488945F0 		movq	%rax, -16(%rbp)
1782:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1783:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     while( cur != NULL && cur->serial.len != 0 )
 6004              		.loc 2 1783 10
 6005 0031 EB63     		jmp	.L404
 6006              	.L408:
1784:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1785:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( crt->serial.len == cur->serial.len &&
 6007              		.loc 2 1785 24
 6008 0033 488B45E8 		movq	-24(%rbp), %rax
 6009 0037 488B5040 		movq	64(%rax), %rdx
GAS LISTING /tmp/ccnlqVtp.s 			page 162


 6010              		.loc 2 1785 43
 6011 003b 488B45F0 		movq	-16(%rbp), %rax
 6012 003f 488B4020 		movq	32(%rax), %rax
 6013              		.loc 2 1785 11
 6014 0043 4839C2   		cmpq	%rax, %rdx
 6015 0046 7542     		jne	.L405
1786:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             memcmp( crt->serial.p, cur->serial.p, crt->serial.len ) == 0 )
 6016              		.loc 2 1786 13 discriminator 1
 6017 0048 488B45E8 		movq	-24(%rbp), %rax
 6018 004c 488B5040 		movq	64(%rax), %rdx
 6019              		.loc 2 1786 47 discriminator 1
 6020 0050 488B45F0 		movq	-16(%rbp), %rax
 6021 0054 488B4828 		movq	40(%rax), %rcx
 6022              		.loc 2 1786 32 discriminator 1
 6023 0058 488B45E8 		movq	-24(%rbp), %rax
 6024 005c 488B4048 		movq	72(%rax), %rax
 6025              		.loc 2 1786 13 discriminator 1
 6026 0060 4889CE   		movq	%rcx, %rsi
 6027 0063 4889C7   		movq	%rax, %rdi
 6028 0066 E8000000 		call	memcmp@PLT
 6028      00
1785:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             memcmp( crt->serial.p, cur->serial.p, crt->serial.len ) == 0 )
 6029              		.loc 2 1785 48 discriminator 1
 6030 006b 85C0     		testl	%eax, %eax
 6031 006d 751B     		jne	.L405
1787:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
1788:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             if( mbedtls_x509_time_is_past( &cur->revocation_date ) )
 6032              		.loc 2 1788 17
 6033 006f 488B45F0 		movq	-16(%rbp), %rax
 6034 0073 4883C030 		addq	$48, %rax
 6035 0077 4889C7   		movq	%rax, %rdi
 6036 007a E8000000 		call	mbedtls_x509_time_is_past@PLT
 6036      00
 6037              		.loc 2 1788 15
 6038 007f 85C0     		testl	%eax, %eax
 6039 0081 7407     		je	.L405
1789:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 return( 1 );
 6040              		.loc 2 1789 23
 6041 0083 B8010000 		movl	$1, %eax
 6041      00
 6042 0088 EB25     		jmp	.L406
 6043              	.L405:
1790:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
1791:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1792:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         cur = cur->next;
 6044              		.loc 2 1792 13
 6045 008a 488B45F0 		movq	-16(%rbp), %rax
 6046 008e 488B4060 		movq	96(%rax), %rax
 6047 0092 488945F0 		movq	%rax, -16(%rbp)
 6048              	.L404:
1783:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 6049              		.loc 2 1783 10
 6050 0096 48837DF0 		cmpq	$0, -16(%rbp)
 6050      00
 6051 009b 740D     		je	.L407
1783:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 6052              		.loc 2 1783 38 discriminator 1
GAS LISTING /tmp/ccnlqVtp.s 			page 163


 6053 009d 488B45F0 		movq	-16(%rbp), %rax
 6054 00a1 488B4020 		movq	32(%rax), %rax
1783:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 6055              		.loc 2 1783 24 discriminator 1
 6056 00a5 4885C0   		testq	%rax, %rax
 6057 00a8 7589     		jne	.L408
 6058              	.L407:
1793:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1794:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1795:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 6059              		.loc 2 1795 11
 6060 00aa B8000000 		movl	$0, %eax
 6060      00
 6061              	.L406:
1796:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 6062              		.loc 2 1796 1
 6063 00af 488B4DF8 		movq	-8(%rbp), %rcx
 6064 00b3 6448330C 		xorq	%fs:40, %rcx
 6064      25280000 
 6064      00
 6065 00bc 7405     		je	.L409
 6066 00be E8000000 		call	__stack_chk_fail@PLT
 6066      00
 6067              	.L409:
 6068 00c3 C9       		leave
 6069              	.LCFI89:
 6070              		.cfi_def_cfa 7, 8
 6071 00c4 C3       		ret
 6072              		.cfi_endproc
 6073              	.LFE44:
 6075              		.section	.text.x509_crt_verifycrl,"ax",@progbits
 6077              	x509_crt_verifycrl:
 6078              	.LFB45:
1797:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1798:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
1799:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Check that the given certificate is not revoked according to the CRL.
1800:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Skip validation if no CRL for the given CA is present.
1801:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
1802:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_crt_verifycrl( mbedtls_x509_crt *crt, mbedtls_x509_crt *ca,
1803:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                mbedtls_x509_crl *crl_list,
1804:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                const mbedtls_x509_crt_profile *profile )
1805:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 6079              		.loc 2 1805 1
 6080              		.cfi_startproc
 6081 0000 F30F1EFA 		endbr64
 6082 0004 55       		pushq	%rbp
 6083              	.LCFI90:
 6084              		.cfi_def_cfa_offset 16
 6085              		.cfi_offset 6, -16
 6086 0005 4889E5   		movq	%rsp, %rbp
 6087              	.LCFI91:
 6088              		.cfi_def_cfa_register 6
 6089 0008 4154     		pushq	%r12
 6090 000a 53       		pushq	%rbx
 6091 000b 4883EC60 		subq	$96, %rsp
 6092              		.cfi_offset 12, -24
 6093              		.cfi_offset 3, -32
GAS LISTING /tmp/ccnlqVtp.s 			page 164


 6094 000f 48897DA8 		movq	%rdi, -88(%rbp)
 6095 0013 488975A0 		movq	%rsi, -96(%rbp)
 6096 0017 48895598 		movq	%rdx, -104(%rbp)
 6097 001b 48894D90 		movq	%rcx, -112(%rbp)
 6098              		.loc 2 1805 1
 6099 001f 64488B04 		movq	%fs:40, %rax
 6099      25280000 
 6099      00
 6100 0028 488945E8 		movq	%rax, -24(%rbp)
 6101 002c 31C0     		xorl	%eax, %eax
1806:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int flags = 0;
 6102              		.loc 2 1806 9
 6103 002e C745B400 		movl	$0, -76(%rbp)
 6103      000000
1807:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     unsigned char hash[MBEDTLS_MD_MAX_SIZE];
1808:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     const mbedtls_md_info_t *md_info;
1809:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1810:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ca == NULL )
 6104              		.loc 2 1810 7
 6105 0035 48837DA0 		cmpq	$0, -96(%rbp)
 6105      00
 6106 003a 0F85EE01 		jne	.L413
 6106      0000
1811:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( flags );
 6107              		.loc 2 1811 15
 6108 0040 8B45B4   		movl	-76(%rbp), %eax
 6109 0043 E9F40100 		jmp	.L427
 6109      00
 6110              	.L426:
1812:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1813:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     while( crl_list != NULL )
1814:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1815:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( crl_list->version == 0 ||
 6111              		.loc 2 1815 21
 6112 0048 488B4598 		movq	-104(%rbp), %rax
 6113 004c 8B4030   		movl	48(%rax), %eax
 6114              		.loc 2 1815 11
 6115 004f 85C0     		testl	%eax, %eax
 6116 0051 7422     		je	.L414
1816:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             x509_name_cmp( &crl_list->issuer, &ca->subject ) != 0 )
 6117              		.loc 2 1816 47 discriminator 1
 6118 0053 488B45A0 		movq	-96(%rbp), %rax
 6119 0057 488D90D8 		leaq	216(%rax), %rdx
 6119      000000
 6120              		.loc 2 1816 28 discriminator 1
 6121 005e 488B4598 		movq	-104(%rbp), %rax
 6122 0062 4883C068 		addq	$104, %rax
 6123              		.loc 2 1816 13 discriminator 1
 6124 0066 4889D6   		movq	%rdx, %rsi
 6125 0069 4889C7   		movq	%rax, %rdi
 6126 006c E8000000 		call	x509_name_cmp
 6126      00
1815:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             x509_name_cmp( &crl_list->issuer, &ca->subject ) != 0 )
 6127              		.loc 2 1815 36 discriminator 1
 6128 0071 85C0     		testl	%eax, %eax
 6129 0073 7414     		je	.L415
 6130              	.L414:
GAS LISTING /tmp/ccnlqVtp.s 			page 165


1817:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
1818:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             crl_list = crl_list->next;
 6131              		.loc 2 1818 22
 6132 0075 488B4598 		movq	-104(%rbp), %rax
 6133 0079 488B8098 		movq	408(%rax), %rax
 6133      010000
 6134 0080 48894598 		movq	%rax, -104(%rbp)
1819:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             continue;
 6135              		.loc 2 1819 13
 6136 0084 E9A50100 		jmp	.L413
 6136      00
 6137              	.L415:
1820:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
1821:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1822:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /*
1823:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****          * Check if the CA is configured to sign CRLs
1824:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****          */
1825:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_X509_CHECK_KEY_USAGE)
1826:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( mbedtls_x509_crt_check_key_usage( ca,
 6138              		.loc 2 1826 13
 6139 0089 488B45A0 		movq	-96(%rbp), %rax
 6140 008d BE020000 		movl	$2, %esi
 6140      00
 6141 0092 4889C7   		movq	%rax, %rdi
 6142 0095 E8000000 		call	mbedtls_x509_crt_check_key_usage
 6142      00
 6143              		.loc 2 1826 11
 6144 009a 85C0     		testl	%eax, %eax
 6145 009c 7409     		je	.L416
1827:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                               MBEDTLS_X509_KU_CRL_SIGN ) != 0 )
1828:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
1829:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             flags |= MBEDTLS_X509_BADCRL_NOT_TRUSTED;
 6146              		.loc 2 1829 19
 6147 009e 834DB410 		orl	$16, -76(%rbp)
1830:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             break;
 6148              		.loc 2 1830 13
 6149 00a2 E9920100 		jmp	.L417
 6149      00
 6150              	.L416:
1831:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
1832:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
1833:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1834:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /*
1835:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****          * Check if CRL is correctly signed by the trusted CA
1836:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****          */
1837:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( x509_profile_check_md_alg( profile, crl_list->sig_md ) != 0 )
 6151              		.loc 2 1837 13
 6152 00a7 488B4598 		movq	-104(%rbp), %rax
 6153 00ab 8B908801 		movl	392(%rax), %edx
 6153      0000
 6154 00b1 488B4590 		movq	-112(%rbp), %rax
 6155 00b5 89D6     		movl	%edx, %esi
 6156 00b7 4889C7   		movq	%rax, %rdi
 6157 00ba E8000000 		call	x509_profile_check_md_alg
 6157      00
 6158              		.loc 2 1837 11
 6159 00bf 85C0     		testl	%eax, %eax
GAS LISTING /tmp/ccnlqVtp.s 			page 166


 6160 00c1 7407     		je	.L418
1838:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             flags |= MBEDTLS_X509_BADCRL_BAD_MD;
 6161              		.loc 2 1838 19
 6162 00c3 814DB400 		orl	$131072, -76(%rbp)
 6162      000200
 6163              	.L418:
1839:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1840:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( x509_profile_check_pk_alg( profile, crl_list->sig_pk ) != 0 )
 6164              		.loc 2 1840 13
 6165 00ca 488B4598 		movq	-104(%rbp), %rax
 6166 00ce 8B908C01 		movl	396(%rax), %edx
 6166      0000
 6167 00d4 488B4590 		movq	-112(%rbp), %rax
 6168 00d8 89D6     		movl	%edx, %esi
 6169 00da 4889C7   		movq	%rax, %rdi
 6170 00dd E8000000 		call	x509_profile_check_pk_alg
 6170      00
 6171              		.loc 2 1840 11
 6172 00e2 85C0     		testl	%eax, %eax
 6173 00e4 7407     		je	.L419
1841:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             flags |= MBEDTLS_X509_BADCRL_BAD_PK;
 6174              		.loc 2 1841 19
 6175 00e6 814DB400 		orl	$262144, -76(%rbp)
 6175      000400
 6176              	.L419:
1842:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1843:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         md_info = mbedtls_md_info_from_type( crl_list->sig_md );
 6177              		.loc 2 1843 19
 6178 00ed 488B4598 		movq	-104(%rbp), %rax
 6179 00f1 8B808801 		movl	392(%rax), %eax
 6179      0000
 6180 00f7 89C7     		movl	%eax, %edi
 6181 00f9 E8000000 		call	mbedtls_md_info_from_type@PLT
 6181      00
 6182 00fe 488945B8 		movq	%rax, -72(%rbp)
1844:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( mbedtls_md( md_info, crl_list->tbs.p, crl_list->tbs.len, hash ) != 0 )
 6183              		.loc 2 1844 13
 6184 0102 488B4598 		movq	-104(%rbp), %rax
 6185 0106 488B5020 		movq	32(%rax), %rdx
 6186              		.loc 2 1844 47
 6187 010a 488B4598 		movq	-104(%rbp), %rax
 6188 010e 488B7028 		movq	40(%rax), %rsi
 6189              		.loc 2 1844 13
 6190 0112 488D4DC0 		leaq	-64(%rbp), %rcx
 6191 0116 488B45B8 		movq	-72(%rbp), %rax
 6192 011a 4889C7   		movq	%rax, %rdi
 6193 011d E8000000 		call	mbedtls_md@PLT
 6193      00
 6194              		.loc 2 1844 11
 6195 0122 85C0     		testl	%eax, %eax
 6196 0124 7409     		je	.L420
1845:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
1846:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             /* Note: this can't happen except after an internal error */
1847:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             flags |= MBEDTLS_X509_BADCRL_NOT_TRUSTED;
 6197              		.loc 2 1847 19
 6198 0126 834DB410 		orl	$16, -76(%rbp)
1848:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             break;
GAS LISTING /tmp/ccnlqVtp.s 			page 167


 6199              		.loc 2 1848 13
 6200 012a E90A0100 		jmp	.L417
 6200      00
 6201              	.L420:
1849:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
1850:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1851:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( x509_profile_check_key( profile, &ca->pk ) != 0 )
 6202              		.loc 2 1851 46
 6203 012f 488B45A0 		movq	-96(%rbp), %rax
 6204 0133 488D9048 		leaq	328(%rax), %rdx
 6204      010000
 6205              		.loc 2 1851 13
 6206 013a 488B4590 		movq	-112(%rbp), %rax
 6207 013e 4889D6   		movq	%rdx, %rsi
 6208 0141 4889C7   		movq	%rax, %rdi
 6209 0144 E8000000 		call	x509_profile_check_key
 6209      00
 6210              		.loc 2 1851 11
 6211 0149 85C0     		testl	%eax, %eax
 6212 014b 7407     		je	.L421
1852:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             flags |= MBEDTLS_X509_BADCERT_BAD_KEY;
 6213              		.loc 2 1852 19
 6214 014d 814DB400 		orl	$65536, -76(%rbp)
 6214      000100
 6215              	.L421:
1853:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1854:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( mbedtls_pk_verify_ext( crl_list->sig_pk, crl_list->sig_opts, &ca->pk,
 6216              		.loc 2 1854 13
 6217 0154 488B4598 		movq	-104(%rbp), %rax
 6218 0158 4C8BA078 		movq	376(%rax), %r12
 6218      010000
1855:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                            crl_list->sig_md, hash, mbedtls_md_get_size( md_info ),
1856:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                            crl_list->sig.p, crl_list->sig.len ) != 0 )
 6219              		.loc 2 1856 41
 6220 015f 488B4598 		movq	-104(%rbp), %rax
 6221 0163 488B9880 		movq	384(%rax), %rbx
 6221      010000
1855:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                            crl_list->sig_md, hash, mbedtls_md_get_size( md_info ),
 6222              		.loc 2 1855 52
 6223 016a 488B45B8 		movq	-72(%rbp), %rax
 6224 016e 4889C7   		movq	%rax, %rdi
 6225 0171 E8000000 		call	mbedtls_md_get_size@PLT
 6225      00
1854:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                            crl_list->sig_md, hash, mbedtls_md_get_size( md_info ),
 6226              		.loc 2 1854 13
 6227 0176 440FB6C0 		movzbl	%al, %r8d
 6228 017a 488B4598 		movq	-104(%rbp), %rax
 6229 017e 8B908801 		movl	392(%rax), %edx
 6229      0000
 6230 0184 488B45A0 		movq	-96(%rbp), %rax
 6231 0188 488DB848 		leaq	328(%rax), %rdi
 6231      010000
1854:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                            crl_list->sig_md, hash, mbedtls_md_get_size( md_info ),
 6232              		.loc 2 1854 62
 6233 018f 488B4598 		movq	-104(%rbp), %rax
 6234 0193 488BB090 		movq	400(%rax), %rsi
 6234      010000
GAS LISTING /tmp/ccnlqVtp.s 			page 168


1854:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                            crl_list->sig_md, hash, mbedtls_md_get_size( md_info ),
 6235              		.loc 2 1854 13
 6236 019a 488B4598 		movq	-104(%rbp), %rax
 6237 019e 8B808C01 		movl	396(%rax), %eax
 6237      0000
 6238 01a4 488D4DC0 		leaq	-64(%rbp), %rcx
 6239 01a8 4154     		pushq	%r12
 6240 01aa 53       		pushq	%rbx
 6241 01ab 4D89C1   		movq	%r8, %r9
 6242 01ae 4989C8   		movq	%rcx, %r8
 6243 01b1 89D1     		movl	%edx, %ecx
 6244 01b3 4889FA   		movq	%rdi, %rdx
 6245 01b6 89C7     		movl	%eax, %edi
 6246 01b8 E8000000 		call	mbedtls_pk_verify_ext@PLT
 6246      00
 6247 01bd 4883C410 		addq	$16, %rsp
1854:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                            crl_list->sig_md, hash, mbedtls_md_get_size( md_info ),
 6248              		.loc 2 1854 11
 6249 01c1 85C0     		testl	%eax, %eax
 6250 01c3 7406     		je	.L422
1857:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
1858:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             flags |= MBEDTLS_X509_BADCRL_NOT_TRUSTED;
 6251              		.loc 2 1858 19
 6252 01c5 834DB410 		orl	$16, -76(%rbp)
1859:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             break;
 6253              		.loc 2 1859 13
 6254 01c9 EB6E     		jmp	.L417
 6255              	.L422:
1860:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
1861:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1862:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /*
1863:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****          * Check for validity of CRL (Do not drop out)
1864:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****          */
1865:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( mbedtls_x509_time_is_past( &crl_list->next_update ) )
 6256              		.loc 2 1865 40
 6257 01cb 488B4598 		movq	-104(%rbp), %rax
 6258 01cf 4805C000 		addq	$192, %rax
 6258      0000
 6259              		.loc 2 1865 13
 6260 01d5 4889C7   		movq	%rax, %rdi
 6261 01d8 E8000000 		call	mbedtls_x509_time_is_past@PLT
 6261      00
 6262              		.loc 2 1865 11
 6263 01dd 85C0     		testl	%eax, %eax
 6264 01df 7404     		je	.L423
1866:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             flags |= MBEDTLS_X509_BADCRL_EXPIRED;
 6265              		.loc 2 1866 19
 6266 01e1 834DB420 		orl	$32, -76(%rbp)
 6267              	.L423:
1867:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1868:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( mbedtls_x509_time_is_future( &crl_list->this_update ) )
 6268              		.loc 2 1868 42
 6269 01e5 488B4598 		movq	-104(%rbp), %rax
 6270 01e9 4805A800 		addq	$168, %rax
 6270      0000
 6271              		.loc 2 1868 13
 6272 01ef 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/ccnlqVtp.s 			page 169


 6273 01f2 E8000000 		call	mbedtls_x509_time_is_future@PLT
 6273      00
 6274              		.loc 2 1868 11
 6275 01f7 85C0     		testl	%eax, %eax
 6276 01f9 7407     		je	.L424
1869:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             flags |= MBEDTLS_X509_BADCRL_FUTURE;
 6277              		.loc 2 1869 19
 6278 01fb 814DB400 		orl	$1024, -76(%rbp)
 6278      040000
 6279              	.L424:
1870:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1871:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /*
1872:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****          * Check if certificate is revoked
1873:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****          */
1874:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( mbedtls_x509_crt_is_revoked( crt, crl_list ) )
 6280              		.loc 2 1874 13
 6281 0202 488B5598 		movq	-104(%rbp), %rdx
 6282 0206 488B45A8 		movq	-88(%rbp), %rax
 6283 020a 4889D6   		movq	%rdx, %rsi
 6284 020d 4889C7   		movq	%rax, %rdi
 6285 0210 E8000000 		call	mbedtls_x509_crt_is_revoked
 6285      00
 6286              		.loc 2 1874 11
 6287 0215 85C0     		testl	%eax, %eax
 6288 0217 7406     		je	.L425
1875:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
1876:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             flags |= MBEDTLS_X509_BADCERT_REVOKED;
 6289              		.loc 2 1876 19
 6290 0219 834DB402 		orl	$2, -76(%rbp)
1877:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             break;
 6291              		.loc 2 1877 13
 6292 021d EB1A     		jmp	.L417
 6293              	.L425:
1878:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
1879:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1880:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         crl_list = crl_list->next;
 6294              		.loc 2 1880 18
 6295 021f 488B4598 		movq	-104(%rbp), %rax
 6296 0223 488B8098 		movq	408(%rax), %rax
 6296      010000
 6297 022a 48894598 		movq	%rax, -104(%rbp)
 6298              	.L413:
1813:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 6299              		.loc 2 1813 10
 6300 022e 48837D98 		cmpq	$0, -104(%rbp)
 6300      00
 6301 0233 0F850FFE 		jne	.L426
 6301      FFFF
 6302              	.L417:
1881:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1882:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1883:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( flags );
 6303              		.loc 2 1883 11
 6304 0239 8B45B4   		movl	-76(%rbp), %eax
 6305              	.L427:
1884:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 6306              		.loc 2 1884 1 discriminator 1
GAS LISTING /tmp/ccnlqVtp.s 			page 170


 6307 023c 488B5DE8 		movq	-24(%rbp), %rbx
 6308 0240 6448331C 		xorq	%fs:40, %rbx
 6308      25280000 
 6308      00
 6309 0249 7405     		je	.L428
 6310              		.loc 2 1884 1 is_stmt 0
 6311 024b E8000000 		call	__stack_chk_fail@PLT
 6311      00
 6312              	.L428:
 6313 0250 488D65F0 		leaq	-16(%rbp), %rsp
 6314 0254 5B       		popq	%rbx
 6315 0255 415C     		popq	%r12
 6316 0257 5D       		popq	%rbp
 6317              	.LCFI92:
 6318              		.cfi_def_cfa 7, 8
 6319 0258 C3       		ret
 6320              		.cfi_endproc
 6321              	.LFE45:
 6323              		.section	.text.x509_crt_check_signature,"ax",@progbits
 6325              	x509_crt_check_signature:
 6326              	.LFB46:
1885:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif /* MBEDTLS_X509_CRL_PARSE_C */
1886:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1887:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
1888:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Check the signature of a certificate by its parent
1889:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
1890:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_crt_check_signature( const mbedtls_x509_crt *child,
1891:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                      mbedtls_x509_crt *parent,
1892:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                      mbedtls_x509_crt_restart_ctx *rs_ctx )
1893:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 6327              		.loc 2 1893 1 is_stmt 1
 6328              		.cfi_startproc
 6329 0000 F30F1EFA 		endbr64
 6330 0004 55       		pushq	%rbp
 6331              	.LCFI93:
 6332              		.cfi_def_cfa_offset 16
 6333              		.cfi_offset 6, -16
 6334 0005 4889E5   		movq	%rsp, %rbp
 6335              	.LCFI94:
 6336              		.cfi_def_cfa_register 6
 6337 0008 4154     		pushq	%r12
 6338 000a 53       		pushq	%rbx
 6339 000b 4883EC60 		subq	$96, %rsp
 6340              		.cfi_offset 12, -24
 6341              		.cfi_offset 3, -32
 6342 000f 48897DA8 		movq	%rdi, -88(%rbp)
 6343 0013 488975A0 		movq	%rsi, -96(%rbp)
 6344 0017 48895598 		movq	%rdx, -104(%rbp)
 6345              		.loc 2 1893 1
 6346 001b 64488B04 		movq	%fs:40, %rax
 6346      25280000 
 6346      00
 6347 0024 488945E8 		movq	%rax, -24(%rbp)
 6348 0028 31C0     		xorl	%eax, %eax
1894:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     const mbedtls_md_info_t *md_info;
1895:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     unsigned char hash[MBEDTLS_MD_MAX_SIZE];
1896:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
GAS LISTING /tmp/ccnlqVtp.s 			page 171


1897:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     md_info = mbedtls_md_info_from_type( child->sig_md );
 6349              		.loc 2 1897 15
 6350 002a 488B45A8 		movq	-88(%rbp), %rax
 6351 002e 8B801002 		movl	528(%rax), %eax
 6351      0000
 6352 0034 89C7     		movl	%eax, %edi
 6353 0036 E8000000 		call	mbedtls_md_info_from_type@PLT
 6353      00
 6354 003b 488945B8 		movq	%rax, -72(%rbp)
1898:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( mbedtls_md( md_info, child->tbs.p, child->tbs.len, hash ) != 0 )
 6355              		.loc 2 1898 9
 6356 003f 488B45A8 		movq	-88(%rbp), %rax
 6357 0043 488B5020 		movq	32(%rax), %rdx
 6358              		.loc 2 1898 40
 6359 0047 488B45A8 		movq	-88(%rbp), %rax
 6360 004b 488B7028 		movq	40(%rax), %rsi
 6361              		.loc 2 1898 9
 6362 004f 488D4DC0 		leaq	-64(%rbp), %rcx
 6363 0053 488B45B8 		movq	-72(%rbp), %rax
 6364 0057 4889C7   		movq	%rax, %rdi
 6365 005a E8000000 		call	mbedtls_md@PLT
 6365      00
 6366              		.loc 2 1898 7
 6367 005f 85C0     		testl	%eax, %eax
 6368 0061 740A     		je	.L430
1899:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1900:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* Note: this can't happen except after an internal error */
1901:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( -1 );
 6369              		.loc 2 1901 15
 6370 0063 B8FFFFFF 		movl	$-1, %eax
 6370      FF
 6371 0068 E9970000 		jmp	.L433
 6371      00
 6372              	.L430:
1902:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1903:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1904:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Skip expensive computation on obvious mismatch */
1905:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ! mbedtls_pk_can_do( &parent->pk, child->sig_pk ) )
 6373              		.loc 2 1905 11
 6374 006d 488B45A8 		movq	-88(%rbp), %rax
 6375 0071 8B801402 		movl	532(%rax), %eax
 6375      0000
 6376              		.loc 2 1905 30
 6377 0077 488B55A0 		movq	-96(%rbp), %rdx
 6378 007b 4881C248 		addq	$328, %rdx
 6378      010000
 6379              		.loc 2 1905 11
 6380 0082 89C6     		movl	%eax, %esi
 6381 0084 4889D7   		movq	%rdx, %rdi
 6382 0087 E8000000 		call	mbedtls_pk_can_do@PLT
 6382      00
 6383              		.loc 2 1905 7
 6384 008c 85C0     		testl	%eax, %eax
 6385 008e 7507     		jne	.L432
1906:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( -1 );
 6386              		.loc 2 1906 15
 6387 0090 B8FFFFFF 		movl	$-1, %eax
GAS LISTING /tmp/ccnlqVtp.s 			page 172


 6387      FF
 6388 0095 EB6D     		jmp	.L433
 6389              	.L432:
1907:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1908:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_ECDSA_C) && defined(MBEDTLS_ECP_RESTARTABLE)
1909:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( rs_ctx != NULL && child->sig_pk == MBEDTLS_PK_ECDSA )
1910:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1911:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( mbedtls_pk_verify_restartable( &parent->pk,
1912:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                     child->sig_md, hash, mbedtls_md_get_size( md_info ),
1913:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                     child->sig.p, child->sig.len, &rs_ctx->pk ) );
1914:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1915:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #else
1916:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     (void) rs_ctx;
1917:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
1918:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1919:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( mbedtls_pk_verify_ext( child->sig_pk, child->sig_opts, &parent->pk,
 6390              		.loc 2 1919 13
 6391 0097 488B45A8 		movq	-88(%rbp), %rax
 6392 009b 4C8BA000 		movq	512(%rax), %r12
 6392      020000
1920:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 child->sig_md, hash, mbedtls_md_get_size( md_info ),
1921:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 child->sig.p, child->sig.len ) );
 6393              		.loc 2 1921 27
 6394 00a2 488B45A8 		movq	-88(%rbp), %rax
 6395 00a6 488B9808 		movq	520(%rax), %rbx
 6395      020000
1920:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 child->sig_md, hash, mbedtls_md_get_size( md_info ),
 6396              		.loc 2 1920 38
 6397 00ad 488B45B8 		movq	-72(%rbp), %rax
 6398 00b1 4889C7   		movq	%rax, %rdi
 6399 00b4 E8000000 		call	mbedtls_md_get_size@PLT
 6399      00
1919:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 child->sig_md, hash, mbedtls_md_get_size( md_info ),
 6400              		.loc 2 1919 13
 6401 00b9 440FB6C0 		movzbl	%al, %r8d
 6402 00bd 488B45A8 		movq	-88(%rbp), %rax
 6403 00c1 8B901002 		movl	528(%rax), %edx
 6403      0000
 6404 00c7 488B45A0 		movq	-96(%rbp), %rax
 6405 00cb 488DB848 		leaq	328(%rax), %rdi
 6405      010000
1919:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 child->sig_md, hash, mbedtls_md_get_size( md_info ),
 6406              		.loc 2 1919 56
 6407 00d2 488B45A8 		movq	-88(%rbp), %rax
 6408 00d6 488BB018 		movq	536(%rax), %rsi
 6408      020000
1919:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 child->sig_md, hash, mbedtls_md_get_size( md_info ),
 6409              		.loc 2 1919 13
 6410 00dd 488B45A8 		movq	-88(%rbp), %rax
 6411 00e1 8B801402 		movl	532(%rax), %eax
 6411      0000
 6412 00e7 488D4DC0 		leaq	-64(%rbp), %rcx
 6413 00eb 4154     		pushq	%r12
 6414 00ed 53       		pushq	%rbx
 6415 00ee 4D89C1   		movq	%r8, %r9
 6416 00f1 4989C8   		movq	%rcx, %r8
 6417 00f4 89D1     		movl	%edx, %ecx
GAS LISTING /tmp/ccnlqVtp.s 			page 173


 6418 00f6 4889FA   		movq	%rdi, %rdx
 6419 00f9 89C7     		movl	%eax, %edi
 6420 00fb E8000000 		call	mbedtls_pk_verify_ext@PLT
 6420      00
 6421 0100 4883C410 		addq	$16, %rsp
 6422              	.L433:
1922:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 6423              		.loc 2 1922 1 discriminator 1
 6424 0104 488B5DE8 		movq	-24(%rbp), %rbx
 6425 0108 6448331C 		xorq	%fs:40, %rbx
 6425      25280000 
 6425      00
 6426 0111 7405     		je	.L434
 6427              		.loc 2 1922 1 is_stmt 0
 6428 0113 E8000000 		call	__stack_chk_fail@PLT
 6428      00
 6429              	.L434:
 6430 0118 488D65F0 		leaq	-16(%rbp), %rsp
 6431 011c 5B       		popq	%rbx
 6432 011d 415C     		popq	%r12
 6433 011f 5D       		popq	%rbp
 6434              	.LCFI95:
 6435              		.cfi_def_cfa 7, 8
 6436 0120 C3       		ret
 6437              		.cfi_endproc
 6438              	.LFE46:
 6440              		.section	.text.x509_crt_check_parent,"ax",@progbits
 6442              	x509_crt_check_parent:
 6443              	.LFB47:
1923:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1924:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
1925:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Check if 'parent' is a suitable parent (signing CA) for 'child'.
1926:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Return 0 if yes, -1 if not.
1927:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
1928:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * top means parent is a locally-trusted certificate
1929:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
1930:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_crt_check_parent( const mbedtls_x509_crt *child,
1931:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                   const mbedtls_x509_crt *parent,
1932:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                   int top )
1933:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 6444              		.loc 2 1933 1 is_stmt 1
 6445              		.cfi_startproc
 6446 0000 F30F1EFA 		endbr64
 6447 0004 55       		pushq	%rbp
 6448              	.LCFI96:
 6449              		.cfi_def_cfa_offset 16
 6450              		.cfi_offset 6, -16
 6451 0005 4889E5   		movq	%rsp, %rbp
 6452              	.LCFI97:
 6453              		.cfi_def_cfa_register 6
 6454 0008 4883EC30 		subq	$48, %rsp
 6455 000c 48897DE8 		movq	%rdi, -24(%rbp)
 6456 0010 488975E0 		movq	%rsi, -32(%rbp)
 6457 0014 8955DC   		movl	%edx, -36(%rbp)
 6458              		.loc 2 1933 1
 6459 0017 64488B04 		movq	%fs:40, %rax
 6459      25280000 
GAS LISTING /tmp/ccnlqVtp.s 			page 174


 6459      00
 6460 0020 488945F8 		movq	%rax, -8(%rbp)
 6461 0024 31C0     		xorl	%eax, %eax
1934:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int need_ca_bit;
1935:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1936:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Parent must be the issuer */
1937:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( x509_name_cmp( &child->issuer, &parent->subject ) != 0 )
 6462              		.loc 2 1937 9
 6463 0026 488B45E0 		movq	-32(%rbp), %rax
 6464 002a 488D90D8 		leaq	216(%rax), %rdx
 6464      000000
 6465 0031 488B45E8 		movq	-24(%rbp), %rax
 6466 0035 48059800 		addq	$152, %rax
 6466      0000
 6467 003b 4889D6   		movq	%rdx, %rsi
 6468 003e 4889C7   		movq	%rax, %rdi
 6469 0041 E8000000 		call	x509_name_cmp
 6469      00
 6470              		.loc 2 1937 7
 6471 0046 85C0     		testl	%eax, %eax
 6472 0048 7407     		je	.L436
1938:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( -1 );
 6473              		.loc 2 1938 15
 6474 004a B8FFFFFF 		movl	$-1, %eax
 6474      FF
 6475 004f EB62     		jmp	.L437
 6476              	.L436:
1939:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1940:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Parent must have the basicConstraints CA bit set as a general rule */
1941:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     need_ca_bit = 1;
 6477              		.loc 2 1941 17
 6478 0051 C745F401 		movl	$1, -12(%rbp)
 6478      000000
1942:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1943:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Exception: v1/v2 certificates that are locally trusted. */
1944:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( top && parent->version < 3 )
 6479              		.loc 2 1944 7
 6480 0058 837DDC00 		cmpl	$0, -36(%rbp)
 6481 005c 7413     		je	.L438
 6482              		.loc 2 1944 22 discriminator 1
 6483 005e 488B45E0 		movq	-32(%rbp), %rax
 6484 0062 8B4030   		movl	48(%rax), %eax
 6485              		.loc 2 1944 13 discriminator 1
 6486 0065 83F802   		cmpl	$2, %eax
 6487 0068 7F07     		jg	.L438
1945:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         need_ca_bit = 0;
 6488              		.loc 2 1945 21
 6489 006a C745F400 		movl	$0, -12(%rbp)
 6489      000000
 6490              	.L438:
1946:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1947:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( need_ca_bit && ! parent->ca_istrue )
 6491              		.loc 2 1947 7
 6492 0071 837DF400 		cmpl	$0, -12(%rbp)
 6493 0075 7415     		je	.L439
 6494              		.loc 2 1947 32 discriminator 1
 6495 0077 488B45E0 		movq	-32(%rbp), %rax
GAS LISTING /tmp/ccnlqVtp.s 			page 175


 6496 007b 8B80C401 		movl	452(%rax), %eax
 6496      0000
 6497              		.loc 2 1947 21 discriminator 1
 6498 0081 85C0     		testl	%eax, %eax
 6499 0083 7507     		jne	.L439
1948:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( -1 );
 6500              		.loc 2 1948 15
 6501 0085 B8FFFFFF 		movl	$-1, %eax
 6501      FF
 6502 008a EB27     		jmp	.L437
 6503              	.L439:
1949:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1950:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_X509_CHECK_KEY_USAGE)
1951:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( need_ca_bit &&
 6504              		.loc 2 1951 7
 6505 008c 837DF400 		cmpl	$0, -12(%rbp)
 6506 0090 741C     		je	.L440
1952:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_x509_crt_check_key_usage( parent, MBEDTLS_X509_KU_KEY_CERT_SIGN ) != 0 )
 6507              		.loc 2 1952 9 discriminator 1
 6508 0092 488B45E0 		movq	-32(%rbp), %rax
 6509 0096 BE040000 		movl	$4, %esi
 6509      00
 6510 009b 4889C7   		movq	%rax, %rdi
 6511 009e E8000000 		call	mbedtls_x509_crt_check_key_usage
 6511      00
1951:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_x509_crt_check_key_usage( parent, MBEDTLS_X509_KU_KEY_CERT_SIGN ) != 0 )
 6512              		.loc 2 1951 21 discriminator 1
 6513 00a3 85C0     		testl	%eax, %eax
 6514 00a5 7407     		je	.L440
1953:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
1954:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( -1 );
 6515              		.loc 2 1954 15
 6516 00a7 B8FFFFFF 		movl	$-1, %eax
 6516      FF
 6517 00ac EB05     		jmp	.L437
 6518              	.L440:
1955:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
1956:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
1957:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1958:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 6519              		.loc 2 1958 11
 6520 00ae B8000000 		movl	$0, %eax
 6520      00
 6521              	.L437:
1959:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 6522              		.loc 2 1959 1
 6523 00b3 488B4DF8 		movq	-8(%rbp), %rcx
 6524 00b7 6448330C 		xorq	%fs:40, %rcx
 6524      25280000 
 6524      00
 6525 00c0 7405     		je	.L441
 6526 00c2 E8000000 		call	__stack_chk_fail@PLT
 6526      00
 6527              	.L441:
 6528 00c7 C9       		leave
 6529              	.LCFI98:
 6530              		.cfi_def_cfa 7, 8
GAS LISTING /tmp/ccnlqVtp.s 			page 176


 6531 00c8 C3       		ret
 6532              		.cfi_endproc
 6533              	.LFE47:
 6535              		.section	.text.x509_crt_find_parent_in,"ax",@progbits
 6537              	x509_crt_find_parent_in:
 6538              	.LFB48:
1960:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
1961:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
1962:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Find a suitable parent for child in candidates, or return NULL.
1963:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
1964:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Here suitable is defined as:
1965:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  1. subject name matches child's issuer
1966:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  2. if necessary, the CA bit is set and key usage allows signing certs
1967:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  3. for trusted roots, the signature is correct
1968:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *     (for intermediates, the signature is checked and the result reported)
1969:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  4. pathlen constraints are satisfied
1970:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
1971:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * If there's a suitable candidate which is also time-valid, return the first
1972:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * such. Otherwise, return the first suitable candidate (or NULL if there is
1973:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * none).
1974:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
1975:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * The rationale for this rule is that someone could have a list of trusted
1976:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * roots with two versions on the same root with different validity periods.
1977:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * (At least one user reported having such a list and wanted it to just work.)
1978:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * The reason we don't just require time-validity is that generally there is
1979:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * only one version, and if it's expired we want the flags to state that
1980:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * rather than NOT_TRUSTED, as would be the case if we required it here.
1981:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
1982:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * The rationale for rule 3 (signature for trusted roots) is that users might
1983:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * have two versions of the same CA with different keys in their list, and the
1984:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * way we select the correct one is by checking the signature (as we don't
1985:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * rely on key identifier extensions). (This is one way users might choose to
1986:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * handle key rollover, another relies on self-issued certs, see [SIRO].)
1987:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
1988:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Arguments:
1989:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - [in] child: certificate for which we're looking for a parent
1990:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - [in] candidates: chained list of potential parents
1991:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - [out] r_parent: parent found (or NULL)
1992:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - [out] r_signature_is_good: 1 if child signature by parent is valid, or 0
1993:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - [in] top: 1 if candidates consists of trusted roots, ie we're at the top
1994:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *         of the chain, 0 otherwise
1995:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - [in] path_cnt: number of intermediates seen so far
1996:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - [in] self_cnt: number of self-signed intermediates seen so far
1997:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *         (will never be greater than path_cnt)
1998:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - [in-out] rs_ctx: context for restarting operations
1999:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
2000:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Return value:
2001:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - 0 on success
2002:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - MBEDTLS_ERR_ECP_IN_PROGRESS otherwise
2003:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
2004:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_crt_find_parent_in(
2005:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         mbedtls_x509_crt *child,
2006:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         mbedtls_x509_crt *candidates,
2007:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         mbedtls_x509_crt **r_parent,
2008:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         int *r_signature_is_good,
2009:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         int top,
2010:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         unsigned path_cnt,
GAS LISTING /tmp/ccnlqVtp.s 			page 177


2011:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         unsigned self_cnt,
2012:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         mbedtls_x509_crt_restart_ctx *rs_ctx )
2013:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 6539              		.loc 2 2013 1
 6540              		.cfi_startproc
 6541 0000 F30F1EFA 		endbr64
 6542 0004 55       		pushq	%rbp
 6543              	.LCFI99:
 6544              		.cfi_def_cfa_offset 16
 6545              		.cfi_offset 6, -16
 6546 0005 4889E5   		movq	%rsp, %rbp
 6547              	.LCFI100:
 6548              		.cfi_def_cfa_register 6
 6549 0008 4883EC70 		subq	$112, %rsp
 6550 000c 48897DC8 		movq	%rdi, -56(%rbp)
 6551 0010 488975C0 		movq	%rsi, -64(%rbp)
 6552 0014 488955B8 		movq	%rdx, -72(%rbp)
 6553 0018 48894DB0 		movq	%rcx, -80(%rbp)
 6554 001c 448945AC 		movl	%r8d, -84(%rbp)
 6555 0020 44894DA8 		movl	%r9d, -88(%rbp)
 6556 0024 8B4510   		movl	16(%rbp), %eax
 6557 0027 8945A4   		movl	%eax, -92(%rbp)
 6558 002a 488B4518 		movq	24(%rbp), %rax
 6559 002e 48894598 		movq	%rax, -104(%rbp)
 6560              		.loc 2 2013 1
 6561 0032 64488B04 		movq	%fs:40, %rax
 6561      25280000 
 6561      00
 6562 003b 488945F8 		movq	%rax, -8(%rbp)
 6563 003f 31C0     		xorl	%eax, %eax
2014:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int ret;
2015:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_x509_crt *parent, *fallback_parent;
2016:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int signature_is_good, fallback_signature_is_good;
2017:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2018:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_ECDSA_C) && defined(MBEDTLS_ECP_RESTARTABLE)
2019:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* did we have something in progress? */
2020:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( rs_ctx != NULL && rs_ctx->parent != NULL )
2021:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
2022:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* restore saved state */
2023:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         parent = rs_ctx->parent;
2024:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         fallback_parent = rs_ctx->fallback_parent;
2025:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         fallback_signature_is_good = rs_ctx->fallback_signature_is_good;
2026:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2027:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* clear saved state */
2028:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         rs_ctx->parent = NULL;
2029:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         rs_ctx->fallback_parent = NULL;
2030:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         rs_ctx->fallback_signature_is_good = 0;
2031:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2032:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* resume where we left */
2033:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         goto check_signature;
2034:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
2035:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
2036:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2037:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     fallback_parent = NULL;
 6564              		.loc 2 2037 21
 6565 0041 48C745F0 		movq	$0, -16(%rbp)
 6565      00000000 
GAS LISTING /tmp/ccnlqVtp.s 			page 178


2038:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     fallback_signature_is_good = 0;
 6566              		.loc 2 2038 32
 6567 0049 C745E000 		movl	$0, -32(%rbp)
 6567      000000
2039:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2040:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     for( parent = candidates; parent != NULL; parent = parent->next )
 6568              		.loc 2 2040 17
 6569 0050 488B45C0 		movq	-64(%rbp), %rax
 6570 0054 488945E8 		movq	%rax, -24(%rbp)
 6571              		.loc 2 2040 5
 6572 0058 E9D80000 		jmp	.L443
 6572      00
 6573              	.L452:
2041:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
2042:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* basic parenting skills (name, CA bit, key usage) */
2043:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( x509_crt_check_parent( child, parent, top ) != 0 )
 6574              		.loc 2 2043 13
 6575 005d 8B55AC   		movl	-84(%rbp), %edx
 6576 0060 488B4DE8 		movq	-24(%rbp), %rcx
 6577 0064 488B45C8 		movq	-56(%rbp), %rax
 6578 0068 4889CE   		movq	%rcx, %rsi
 6579 006b 4889C7   		movq	%rax, %rdi
 6580 006e E8000000 		call	x509_crt_check_parent
 6580      00
 6581              		.loc 2 2043 11
 6582 0073 85C0     		testl	%eax, %eax
 6583 0075 0F85A100 		jne	.L457
 6583      0000
2044:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             continue;
2045:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2046:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* +1 because stored max_pathlen is 1 higher that the actual value */
2047:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( parent->max_pathlen > 0 &&
 6584              		.loc 2 2047 19
 6585 007b 488B45E8 		movq	-24(%rbp), %rax
 6586 007f 8B80C801 		movl	456(%rax), %eax
 6586      0000
 6587              		.loc 2 2047 11
 6588 0085 85C0     		testl	%eax, %eax
 6589 0087 7E1D     		jle	.L446
2048:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             (size_t) parent->max_pathlen < 1 + path_cnt - self_cnt )
 6590              		.loc 2 2048 28 discriminator 1
 6591 0089 488B45E8 		movq	-24(%rbp), %rax
 6592 008d 8B80C801 		movl	456(%rax), %eax
 6592      0000
 6593              		.loc 2 2048 13 discriminator 1
 6594 0093 4863D0   		movslq	%eax, %rdx
 6595              		.loc 2 2048 57 discriminator 1
 6596 0096 8B45A8   		movl	-88(%rbp), %eax
 6597 0099 2B45A4   		subl	-92(%rbp), %eax
 6598 009c 83C001   		addl	$1, %eax
 6599 009f 89C0     		movl	%eax, %eax
2047:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             (size_t) parent->max_pathlen < 1 + path_cnt - self_cnt )
 6600              		.loc 2 2047 37 discriminator 1
 6601 00a1 4839C2   		cmpq	%rax, %rdx
 6602 00a4 7279     		jb	.L458
 6603              	.L446:
2049:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
GAS LISTING /tmp/ccnlqVtp.s 			page 179


2050:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             continue;
2051:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
2052:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2053:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* Signature */
2054:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_ECDSA_C) && defined(MBEDTLS_ECP_RESTARTABLE)
2055:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** check_signature:
2056:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
2057:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ret = x509_crt_check_signature( child, parent, rs_ctx );
 6604              		.loc 2 2057 15
 6605 00a6 488B5598 		movq	-104(%rbp), %rdx
 6606 00aa 488B4DE8 		movq	-24(%rbp), %rcx
 6607 00ae 488B45C8 		movq	-56(%rbp), %rax
 6608 00b2 4889CE   		movq	%rcx, %rsi
 6609 00b5 4889C7   		movq	%rax, %rdi
 6610 00b8 E8000000 		call	x509_crt_check_signature
 6610      00
 6611 00bd 8945E4   		movl	%eax, -28(%rbp)
2058:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2059:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_ECDSA_C) && defined(MBEDTLS_ECP_RESTARTABLE)
2060:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( rs_ctx != NULL && ret == MBEDTLS_ERR_ECP_IN_PROGRESS )
2061:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
2062:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             /* save state */
2063:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             rs_ctx->parent = parent;
2064:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             rs_ctx->fallback_parent = fallback_parent;
2065:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             rs_ctx->fallback_signature_is_good = fallback_signature_is_good;
2066:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2067:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( ret );
2068:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
2069:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #else
2070:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         (void) ret;
2071:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
2072:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2073:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         signature_is_good = ret == 0;
 6612              		.loc 2 2073 33
 6613 00c0 837DE400 		cmpl	$0, -28(%rbp)
 6614 00c4 0F94C0   		sete	%al
 6615              		.loc 2 2073 27
 6616 00c7 0FB6C0   		movzbl	%al, %eax
 6617 00ca 8945DC   		movl	%eax, -36(%rbp)
2074:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( top && ! signature_is_good )
 6618              		.loc 2 2074 11
 6619 00cd 837DAC00 		cmpl	$0, -84(%rbp)
 6620 00d1 7406     		je	.L447
 6621              		.loc 2 2074 17 discriminator 1
 6622 00d3 837DDC00 		cmpl	$0, -36(%rbp)
 6623 00d7 7449     		je	.L459
 6624              	.L447:
2075:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             continue;
2076:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2077:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* optional time check */
2078:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( mbedtls_x509_time_is_past( &parent->valid_to ) ||
 6625              		.loc 2 2078 40
 6626 00d9 488B45E8 		movq	-24(%rbp), %rax
 6627 00dd 48053001 		addq	$304, %rax
 6627      0000
 6628              		.loc 2 2078 13
 6629 00e3 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/ccnlqVtp.s 			page 180


 6630 00e6 E8000000 		call	mbedtls_x509_time_is_past@PLT
 6630      00
 6631              		.loc 2 2078 11
 6632 00eb 85C0     		testl	%eax, %eax
 6633 00ed 7516     		jne	.L448
2079:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             mbedtls_x509_time_is_future( &parent->valid_from ) )
 6634              		.loc 2 2079 42 discriminator 1
 6635 00ef 488B45E8 		movq	-24(%rbp), %rax
 6636 00f3 48051801 		addq	$280, %rax
 6636      0000
 6637              		.loc 2 2079 13 discriminator 1
 6638 00f9 4889C7   		movq	%rax, %rdi
 6639 00fc E8000000 		call	mbedtls_x509_time_is_future@PLT
 6639      00
2078:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             mbedtls_x509_time_is_future( &parent->valid_from ) )
 6640              		.loc 2 2078 60 discriminator 1
 6641 0101 85C0     		testl	%eax, %eax
 6642 0103 743D     		je	.L460
 6643              	.L448:
2080:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
2081:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             if( fallback_parent == NULL )
 6644              		.loc 2 2081 15
 6645 0105 48837DF0 		cmpq	$0, -16(%rbp)
 6645      00
 6646 010a 7519     		jne	.L461
2082:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             {
2083:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 fallback_parent = parent;
 6647              		.loc 2 2083 33
 6648 010c 488B45E8 		movq	-24(%rbp), %rax
 6649 0110 488945F0 		movq	%rax, -16(%rbp)
2084:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 fallback_signature_is_good = signature_is_good;
 6650              		.loc 2 2084 44
 6651 0114 8B45DC   		movl	-36(%rbp), %eax
 6652 0117 8945E0   		movl	%eax, -32(%rbp)
2085:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             }
2086:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2087:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             continue;
 6653              		.loc 2 2087 13
 6654 011a EB09     		jmp	.L461
 6655              	.L457:
2044:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 6656              		.loc 2 2044 13
 6657 011c 90       		nop
 6658 011d EB07     		jmp	.L445
 6659              	.L458:
2050:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
 6660              		.loc 2 2050 13
 6661 011f 90       		nop
 6662 0120 EB04     		jmp	.L445
 6663              	.L459:
2075:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 6664              		.loc 2 2075 13
 6665 0122 90       		nop
 6666 0123 EB01     		jmp	.L445
 6667              	.L461:
 6668              		.loc 2 2087 13
 6669 0125 90       		nop
GAS LISTING /tmp/ccnlqVtp.s 			page 181


 6670              	.L445:
2040:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 6671              		.loc 2 2040 54 discriminator 2
 6672 0126 488B45E8 		movq	-24(%rbp), %rax
 6673 012a 488B8020 		movq	544(%rax), %rax
 6673      020000
 6674 0131 488945E8 		movq	%rax, -24(%rbp)
 6675              	.L443:
2040:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 6676              		.loc 2 2040 5 discriminator 1
 6677 0135 48837DE8 		cmpq	$0, -24(%rbp)
 6677      00
 6678 013a 0F851DFF 		jne	.L452
 6678      FFFF
 6679 0140 EB01     		jmp	.L451
 6680              	.L460:
2088:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
2089:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2090:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         break;
 6681              		.loc 2 2090 9
 6682 0142 90       		nop
 6683              	.L451:
2091:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
2092:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2093:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( parent != NULL )
 6684              		.loc 2 2093 7
 6685 0143 48837DE8 		cmpq	$0, -24(%rbp)
 6685      00
 6686 0148 7416     		je	.L453
2094:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
2095:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         *r_parent = parent;
 6687              		.loc 2 2095 19
 6688 014a 488B45B8 		movq	-72(%rbp), %rax
 6689 014e 488B55E8 		movq	-24(%rbp), %rdx
 6690 0152 488910   		movq	%rdx, (%rax)
2096:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         *r_signature_is_good = signature_is_good;
 6691              		.loc 2 2096 30
 6692 0155 488B45B0 		movq	-80(%rbp), %rax
 6693 0159 8B55DC   		movl	-36(%rbp), %edx
 6694 015c 8910     		movl	%edx, (%rax)
 6695 015e EB14     		jmp	.L454
 6696              	.L453:
2097:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
2098:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     else
2099:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
2100:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         *r_parent = fallback_parent;
 6697              		.loc 2 2100 19
 6698 0160 488B45B8 		movq	-72(%rbp), %rax
 6699 0164 488B55F0 		movq	-16(%rbp), %rdx
 6700 0168 488910   		movq	%rdx, (%rax)
2101:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         *r_signature_is_good = fallback_signature_is_good;
 6701              		.loc 2 2101 30
 6702 016b 488B45B0 		movq	-80(%rbp), %rax
 6703 016f 8B55E0   		movl	-32(%rbp), %edx
 6704 0172 8910     		movl	%edx, (%rax)
 6705              	.L454:
2102:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
GAS LISTING /tmp/ccnlqVtp.s 			page 182


2103:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2104:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 6706              		.loc 2 2104 11
 6707 0174 B8000000 		movl	$0, %eax
 6707      00
2105:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 6708              		.loc 2 2105 1
 6709 0179 488B75F8 		movq	-8(%rbp), %rsi
 6710 017d 64483334 		xorq	%fs:40, %rsi
 6710      25280000 
 6710      00
 6711 0186 7405     		je	.L456
 6712 0188 E8000000 		call	__stack_chk_fail@PLT
 6712      00
 6713              	.L456:
 6714 018d C9       		leave
 6715              	.LCFI101:
 6716              		.cfi_def_cfa 7, 8
 6717 018e C3       		ret
 6718              		.cfi_endproc
 6719              	.LFE48:
 6721              		.section	.text.x509_crt_find_parent,"ax",@progbits
 6723              	x509_crt_find_parent:
 6724              	.LFB49:
2106:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2107:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
2108:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Find a parent in trusted CAs or the provided chain, or return NULL.
2109:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
2110:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Searches in trusted CAs first, and return the first suitable parent found
2111:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * (see find_parent_in() for definition of suitable).
2112:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
2113:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Arguments:
2114:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - [in] child: certificate for which we're looking for a parent, followed
2115:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *         by a chain of possible intermediates
2116:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - [in] trust_ca: list of locally trusted certificates
2117:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - [out] parent: parent found (or NULL)
2118:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - [out] parent_is_trusted: 1 if returned `parent` is trusted, or 0
2119:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - [out] signature_is_good: 1 if child signature by parent is valid, or 0
2120:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - [in] path_cnt: number of links in the chain so far (EE -> ... -> child)
2121:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - [in] self_cnt: number of self-signed certs in the chain so far
2122:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *         (will always be no greater than path_cnt)
2123:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - [in-out] rs_ctx: context for restarting operations
2124:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
2125:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Return value:
2126:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - 0 on success
2127:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - MBEDTLS_ERR_ECP_IN_PROGRESS otherwise
2128:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
2129:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_crt_find_parent(
2130:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         mbedtls_x509_crt *child,
2131:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         mbedtls_x509_crt *trust_ca,
2132:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         mbedtls_x509_crt **parent,
2133:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         int *parent_is_trusted,
2134:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         int *signature_is_good,
2135:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         unsigned path_cnt,
2136:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         unsigned self_cnt,
2137:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                         mbedtls_x509_crt_restart_ctx *rs_ctx )
2138:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
GAS LISTING /tmp/ccnlqVtp.s 			page 183


 6725              		.loc 2 2138 1
 6726              		.cfi_startproc
 6727 0000 F30F1EFA 		endbr64
 6728 0004 55       		pushq	%rbp
 6729              	.LCFI102:
 6730              		.cfi_def_cfa_offset 16
 6731              		.cfi_offset 6, -16
 6732 0005 4889E5   		movq	%rsp, %rbp
 6733              	.LCFI103:
 6734              		.cfi_def_cfa_register 6
 6735 0008 4883EC60 		subq	$96, %rsp
 6736 000c 48897DD8 		movq	%rdi, -40(%rbp)
 6737 0010 488975D0 		movq	%rsi, -48(%rbp)
 6738 0014 488955C8 		movq	%rdx, -56(%rbp)
 6739 0018 48894DC0 		movq	%rcx, -64(%rbp)
 6740 001c 4C8945B8 		movq	%r8, -72(%rbp)
 6741 0020 44894DB4 		movl	%r9d, -76(%rbp)
 6742 0024 8B4510   		movl	16(%rbp), %eax
 6743 0027 8945B0   		movl	%eax, -80(%rbp)
 6744 002a 488B4518 		movq	24(%rbp), %rax
 6745 002e 488945A8 		movq	%rax, -88(%rbp)
 6746              		.loc 2 2138 1
 6747 0032 64488B04 		movq	%fs:40, %rax
 6747      25280000 
 6747      00
 6748 003b 488945F8 		movq	%rax, -8(%rbp)
 6749 003f 31C0     		xorl	%eax, %eax
2139:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int ret;
2140:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_x509_crt *search_list;
2141:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2142:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     *parent_is_trusted = 1;
 6750              		.loc 2 2142 24
 6751 0041 488B45C0 		movq	-64(%rbp), %rax
 6752 0045 C7000100 		movl	$1, (%rax)
 6752      0000
 6753              	.L466:
2143:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2144:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_ECDSA_C) && defined(MBEDTLS_ECP_RESTARTABLE)
2145:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* restore then clear saved state if we have some stored */
2146:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( rs_ctx != NULL && rs_ctx->parent_is_trusted != -1 )
2147:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
2148:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         *parent_is_trusted = rs_ctx->parent_is_trusted;
2149:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         rs_ctx->parent_is_trusted = -1;
2150:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
2151:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
2152:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2153:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     while( 1 ) {
2154:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         search_list = *parent_is_trusted ? trust_ca : child->next;
 6754              		.loc 2 2154 23
 6755 004b 488B45C0 		movq	-64(%rbp), %rax
 6756 004f 8B00     		movl	(%rax), %eax
 6757              		.loc 2 2154 53
 6758 0051 85C0     		testl	%eax, %eax
 6759 0053 750D     		jne	.L463
 6760              		.loc 2 2154 53 is_stmt 0 discriminator 1
 6761 0055 488B45D8 		movq	-40(%rbp), %rax
 6762 0059 488B8020 		movq	544(%rax), %rax
GAS LISTING /tmp/ccnlqVtp.s 			page 184


 6762      020000
 6763 0060 EB04     		jmp	.L464
 6764              	.L463:
 6765              		.loc 2 2154 53 discriminator 2
 6766 0062 488B45D0 		movq	-48(%rbp), %rax
 6767              	.L464:
 6768              		.loc 2 2154 21 is_stmt 1 discriminator 4
 6769 0066 488945F0 		movq	%rax, -16(%rbp)
2155:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2156:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ret = x509_crt_find_parent_in( child, search_list,
 6770              		.loc 2 2156 15 discriminator 4
 6771 006a 488B45C0 		movq	-64(%rbp), %rax
 6772 006e 448B00   		movl	(%rax), %r8d
 6773 0071 448B4DB4 		movl	-76(%rbp), %r9d
 6774 0075 488B4DB8 		movq	-72(%rbp), %rcx
 6775 0079 488B55C8 		movq	-56(%rbp), %rdx
 6776 007d 488B75F0 		movq	-16(%rbp), %rsi
 6777 0081 488B45D8 		movq	-40(%rbp), %rax
 6778 0085 FF75A8   		pushq	-88(%rbp)
 6779 0088 8B7DB0   		movl	-80(%rbp), %edi
 6780 008b 57       		pushq	%rdi
 6781 008c 4889C7   		movq	%rax, %rdi
 6782 008f E8000000 		call	x509_crt_find_parent_in
 6782      00
 6783 0094 4883C410 		addq	$16, %rsp
 6784 0098 8945EC   		movl	%eax, -20(%rbp)
2157:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                        parent, signature_is_good,
2158:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                        *parent_is_trusted,
2159:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                        path_cnt, self_cnt, rs_ctx );
2160:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2161:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_ECDSA_C) && defined(MBEDTLS_ECP_RESTARTABLE)
2162:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( rs_ctx != NULL && ret == MBEDTLS_ERR_ECP_IN_PROGRESS )
2163:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
2164:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             /* save state */
2165:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             rs_ctx->parent_is_trusted = *parent_is_trusted;
2166:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( ret );
2167:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
2168:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #else
2169:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         (void) ret;
2170:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
2171:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2172:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* stop here if found or already in second iteration */
2173:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( *parent != NULL || *parent_is_trusted == 0 )
 6785              		.loc 2 2173 13 discriminator 4
 6786 009b 488B45C8 		movq	-56(%rbp), %rax
 6787 009f 488B00   		movq	(%rax), %rax
 6788              		.loc 2 2173 11 discriminator 4
 6789 00a2 4885C0   		testq	%rax, %rax
 6790 00a5 7516     		jne	.L465
 6791              		.loc 2 2173 32 discriminator 1
 6792 00a7 488B45C0 		movq	-64(%rbp), %rax
 6793 00ab 8B00     		movl	(%rax), %eax
 6794              		.loc 2 2173 29 discriminator 1
 6795 00ad 85C0     		testl	%eax, %eax
 6796 00af 740C     		je	.L465
2174:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             break;
2175:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
GAS LISTING /tmp/ccnlqVtp.s 			page 185


2176:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* prepare second iteration */
2177:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         *parent_is_trusted = 0;
 6797              		.loc 2 2177 28
 6798 00b1 488B45C0 		movq	-64(%rbp), %rax
 6799 00b5 C7000000 		movl	$0, (%rax)
 6799      0000
2154:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 6800              		.loc 2 2154 21
 6801 00bb EB8E     		jmp	.L466
 6802              	.L465:
2178:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
2179:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2180:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* extra precaution against mistakes in the caller */
2181:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( *parent == NULL )
 6803              		.loc 2 2181 9
 6804 00bd 488B45C8 		movq	-56(%rbp), %rax
 6805 00c1 488B00   		movq	(%rax), %rax
 6806              		.loc 2 2181 7
 6807 00c4 4885C0   		testq	%rax, %rax
 6808 00c7 7514     		jne	.L467
2182:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
2183:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         *parent_is_trusted = 0;
 6809              		.loc 2 2183 28
 6810 00c9 488B45C0 		movq	-64(%rbp), %rax
 6811 00cd C7000000 		movl	$0, (%rax)
 6811      0000
2184:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         *signature_is_good = 0;
 6812              		.loc 2 2184 28
 6813 00d3 488B45B8 		movq	-72(%rbp), %rax
 6814 00d7 C7000000 		movl	$0, (%rax)
 6814      0000
 6815              	.L467:
2185:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
2186:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2187:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 6816              		.loc 2 2187 11
 6817 00dd B8000000 		movl	$0, %eax
 6817      00
2188:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 6818              		.loc 2 2188 1
 6819 00e2 488B55F8 		movq	-8(%rbp), %rdx
 6820 00e6 64483314 		xorq	%fs:40, %rdx
 6820      25280000 
 6820      00
 6821 00ef 7405     		je	.L469
 6822 00f1 E8000000 		call	__stack_chk_fail@PLT
 6822      00
 6823              	.L469:
 6824 00f6 C9       		leave
 6825              	.LCFI104:
 6826              		.cfi_def_cfa 7, 8
 6827 00f7 C3       		ret
 6828              		.cfi_endproc
 6829              	.LFE49:
 6831              		.section	.text.x509_crt_check_ee_locally_trusted,"ax",@progbits
 6833              	x509_crt_check_ee_locally_trusted:
 6834              	.LFB50:
GAS LISTING /tmp/ccnlqVtp.s 			page 186


2189:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2190:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
2191:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Check if an end-entity certificate is locally trusted
2192:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
2193:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Currently we require such certificates to be self-signed (actually only
2194:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * check for self-issued as self-signatures are not checked)
2195:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
2196:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_crt_check_ee_locally_trusted(
2197:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                     mbedtls_x509_crt *crt,
2198:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                     mbedtls_x509_crt *trust_ca )
2199:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 6835              		.loc 2 2199 1
 6836              		.cfi_startproc
 6837 0000 F30F1EFA 		endbr64
 6838 0004 55       		pushq	%rbp
 6839              	.LCFI105:
 6840              		.cfi_def_cfa_offset 16
 6841              		.cfi_offset 6, -16
 6842 0005 4889E5   		movq	%rsp, %rbp
 6843              	.LCFI106:
 6844              		.cfi_def_cfa_register 6
 6845 0008 4883EC20 		subq	$32, %rsp
 6846 000c 48897DE8 		movq	%rdi, -24(%rbp)
 6847 0010 488975E0 		movq	%rsi, -32(%rbp)
 6848              		.loc 2 2199 1
 6849 0014 64488B04 		movq	%fs:40, %rax
 6849      25280000 
 6849      00
 6850 001d 488945F8 		movq	%rax, -8(%rbp)
 6851 0021 31C0     		xorl	%eax, %eax
2200:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_x509_crt *cur;
2201:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2202:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* must be self-issued */
2203:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( x509_name_cmp( &crt->issuer, &crt->subject ) != 0 )
 6852              		.loc 2 2203 38
 6853 0023 488B45E8 		movq	-24(%rbp), %rax
 6854 0027 488D90D8 		leaq	216(%rax), %rdx
 6854      000000
 6855              		.loc 2 2203 24
 6856 002e 488B45E8 		movq	-24(%rbp), %rax
 6857 0032 48059800 		addq	$152, %rax
 6857      0000
 6858              		.loc 2 2203 9
 6859 0038 4889D6   		movq	%rdx, %rsi
 6860 003b 4889C7   		movq	%rax, %rdi
 6861 003e E8000000 		call	x509_name_cmp
 6861      00
 6862              		.loc 2 2203 7
 6863 0043 85C0     		testl	%eax, %eax
 6864 0045 7407     		je	.L471
2204:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( -1 );
 6865              		.loc 2 2204 15
 6866 0047 B8FFFFFF 		movl	$-1, %eax
 6866      FF
 6867 004c EB68     		jmp	.L472
 6868              	.L471:
2205:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
GAS LISTING /tmp/ccnlqVtp.s 			page 187


2206:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* look for an exact match with trusted cert */
2207:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     for( cur = trust_ca; cur != NULL; cur = cur->next )
 6869              		.loc 2 2207 14
 6870 004e 488B45E0 		movq	-32(%rbp), %rax
 6871 0052 488945F0 		movq	%rax, -16(%rbp)
 6872              		.loc 2 2207 5
 6873 0056 EB52     		jmp	.L473
 6874              	.L475:
2208:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
2209:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( crt->raw.len == cur->raw.len &&
 6875              		.loc 2 2209 21
 6876 0058 488B45E8 		movq	-24(%rbp), %rax
 6877 005c 488B5008 		movq	8(%rax), %rdx
 6878              		.loc 2 2209 37
 6879 0060 488B45F0 		movq	-16(%rbp), %rax
 6880 0064 488B4008 		movq	8(%rax), %rax
 6881              		.loc 2 2209 11
 6882 0068 4839C2   		cmpq	%rax, %rdx
 6883 006b 752E     		jne	.L474
2210:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             memcmp( crt->raw.p, cur->raw.p, crt->raw.len ) == 0 )
 6884              		.loc 2 2210 13 discriminator 1
 6885 006d 488B45E8 		movq	-24(%rbp), %rax
 6886 0071 488B5008 		movq	8(%rax), %rdx
 6887              		.loc 2 2210 41 discriminator 1
 6888 0075 488B45F0 		movq	-16(%rbp), %rax
 6889 0079 488B4810 		movq	16(%rax), %rcx
 6890              		.loc 2 2210 29 discriminator 1
 6891 007d 488B45E8 		movq	-24(%rbp), %rax
 6892 0081 488B4010 		movq	16(%rax), %rax
 6893              		.loc 2 2210 13 discriminator 1
 6894 0085 4889CE   		movq	%rcx, %rsi
 6895 0088 4889C7   		movq	%rax, %rdi
 6896 008b E8000000 		call	memcmp@PLT
 6896      00
2209:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             memcmp( crt->raw.p, cur->raw.p, crt->raw.len ) == 0 )
 6897              		.loc 2 2209 42 discriminator 1
 6898 0090 85C0     		testl	%eax, %eax
 6899 0092 7507     		jne	.L474
2211:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
2212:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( 0 );
 6900              		.loc 2 2212 19
 6901 0094 B8000000 		movl	$0, %eax
 6901      00
 6902 0099 EB1B     		jmp	.L472
 6903              	.L474:
2207:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 6904              		.loc 2 2207 43 discriminator 2
 6905 009b 488B45F0 		movq	-16(%rbp), %rax
 6906 009f 488B8020 		movq	544(%rax), %rax
 6906      020000
 6907 00a6 488945F0 		movq	%rax, -16(%rbp)
 6908              	.L473:
2207:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 6909              		.loc 2 2207 5 discriminator 1
 6910 00aa 48837DF0 		cmpq	$0, -16(%rbp)
 6910      00
 6911 00af 75A7     		jne	.L475
GAS LISTING /tmp/ccnlqVtp.s 			page 188


2213:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
2214:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
2215:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2216:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* too bad */
2217:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( -1 );
 6912              		.loc 2 2217 11
 6913 00b1 B8FFFFFF 		movl	$-1, %eax
 6913      FF
 6914              	.L472:
2218:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 6915              		.loc 2 2218 1
 6916 00b6 488B4DF8 		movq	-8(%rbp), %rcx
 6917 00ba 6448330C 		xorq	%fs:40, %rcx
 6917      25280000 
 6917      00
 6918 00c3 7405     		je	.L476
 6919 00c5 E8000000 		call	__stack_chk_fail@PLT
 6919      00
 6920              	.L476:
 6921 00ca C9       		leave
 6922              	.LCFI107:
 6923              		.cfi_def_cfa 7, 8
 6924 00cb C3       		ret
 6925              		.cfi_endproc
 6926              	.LFE50:
 6928              		.section	.text.x509_crt_verify_chain,"ax",@progbits
 6930              	x509_crt_verify_chain:
 6931              	.LFB51:
2219:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2220:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
2221:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Build and verify a certificate chain
2222:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
2223:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Given a peer-provided list of certificates EE, C1, ..., Cn and
2224:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * a list of trusted certs R1, ... Rp, try to build and verify a chain
2225:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *      EE, Ci1, ... Ciq [, Rj]
2226:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * such that every cert in the chain is a child of the next one,
2227:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * jumping to a trusted root as early as possible.
2228:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
2229:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Verify that chain and return it with flags for all issues found.
2230:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
2231:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Special cases:
2232:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * - EE == Rj -> return a one-element list containing it
2233:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * - EE, Ci1, ..., Ciq cannot be continued with a trusted root
2234:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *   -> return that chain with NOT_TRUSTED set on Ciq
2235:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
2236:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Tests for (aspects of) this function should include at least:
2237:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * - trusted EE
2238:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * - EE -> trusted root
2239:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * - EE -> intermedate CA -> trusted root
2240:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * - if relevant: EE untrusted
2241:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * - if relevant: EE -> intermediate, untrusted
2242:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * with the aspect under test checked at each relevant level (EE, int, root).
2243:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * For some aspects longer chains are required, but usually length 2 is
2244:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * enough (but length 1 is not in general).
2245:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
2246:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Arguments:
2247:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - [in] crt: the cert list EE, C1, ..., Cn
GAS LISTING /tmp/ccnlqVtp.s 			page 189


2248:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - [in] trust_ca: the trusted list R1, ..., Rp
2249:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - [in] ca_crl, profile: as in verify_with_profile()
2250:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - [out] ver_chain: the built and verified chain
2251:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *      Only valid when return value is 0, may contain garbage otherwise!
2252:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *      Restart note: need not be the same when calling again to resume.
2253:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - [in-out] rs_ctx: context for restarting operations
2254:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
2255:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Return value:
2256:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - non-zero if the chain could not be fully built and examined
2257:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - 0 is the chain was successfully built and examined,
2258:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *      even if it was found to be invalid
2259:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
2260:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_crt_verify_chain(
2261:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 mbedtls_x509_crt *crt,
2262:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 mbedtls_x509_crt *trust_ca,
2263:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 mbedtls_x509_crl *ca_crl,
2264:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 const mbedtls_x509_crt_profile *profile,
2265:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 mbedtls_x509_crt_verify_chain *ver_chain,
2266:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 mbedtls_x509_crt_restart_ctx *rs_ctx )
2267:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 6932              		.loc 2 2267 1
 6933              		.cfi_startproc
 6934 0000 F30F1EFA 		endbr64
 6935 0004 55       		pushq	%rbp
 6936              	.LCFI108:
 6937              		.cfi_def_cfa_offset 16
 6938              		.cfi_offset 6, -16
 6939 0005 4889E5   		movq	%rsp, %rbp
 6940              	.LCFI109:
 6941              		.cfi_def_cfa_register 6
 6942 0008 4883EC70 		subq	$112, %rsp
 6943 000c 48897DB8 		movq	%rdi, -72(%rbp)
 6944 0010 488975B0 		movq	%rsi, -80(%rbp)
 6945 0014 488955A8 		movq	%rdx, -88(%rbp)
 6946 0018 48894DA0 		movq	%rcx, -96(%rbp)
 6947 001c 4C894598 		movq	%r8, -104(%rbp)
 6948 0020 4C894D90 		movq	%r9, -112(%rbp)
 6949              		.loc 2 2267 1
 6950 0024 64488B04 		movq	%fs:40, %rax
 6950      25280000 
 6950      00
 6951 002d 488945F8 		movq	%rax, -8(%rbp)
 6952 0031 31C0     		xorl	%eax, %eax
2268:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Don't initialize any of those variables here, so that the compiler can
2269:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      * catch potential issues with jumping ahead when restarting */
2270:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int ret;
2271:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     uint32_t *flags;
2272:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_x509_crt_verify_chain_item *cur;
2273:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_x509_crt *child;
2274:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_x509_crt *parent;
2275:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int parent_is_trusted;
2276:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int child_is_trusted;
2277:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int signature_is_good;
2278:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     unsigned self_cnt;
2279:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2280:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_ECDSA_C) && defined(MBEDTLS_ECP_RESTARTABLE)
2281:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* resume if we had an operation in progress */
GAS LISTING /tmp/ccnlqVtp.s 			page 190


2282:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( rs_ctx != NULL && rs_ctx->in_progress == x509_crt_rs_find_parent )
2283:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
2284:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* restore saved state */
2285:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         *ver_chain = rs_ctx->ver_chain; /* struct copy */
2286:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         self_cnt = rs_ctx->self_cnt;
2287:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2288:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* restore derived state */
2289:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         cur = &ver_chain->items[ver_chain->len - 1];
2290:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         child = cur->crt;
2291:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         flags = &cur->flags;
2292:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2293:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         goto find_parent;
2294:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
2295:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif /* MBEDTLS_ECDSA_C && MBEDTLS_ECP_RESTARTABLE */
2296:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2297:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     child = crt;
 6953              		.loc 2 2297 11
 6954 0033 488B45B8 		movq	-72(%rbp), %rax
 6955 0037 488945E0 		movq	%rax, -32(%rbp)
2298:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     self_cnt = 0;
 6956              		.loc 2 2298 14
 6957 003b C745D000 		movl	$0, -48(%rbp)
 6957      000000
2299:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     parent_is_trusted = 0;
 6958              		.loc 2 2299 23
 6959 0042 C745C400 		movl	$0, -60(%rbp)
 6959      000000
2300:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     child_is_trusted = 0;
 6960              		.loc 2 2300 22
 6961 0049 C745CC00 		movl	$0, -52(%rbp)
 6961      000000
 6962              	.L490:
2301:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2302:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     while( 1 ) {
2303:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* Add certificate to the verification chain */
2304:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         cur = &ver_chain->items[ver_chain->len];
 6963              		.loc 2 2304 42
 6964 0050 488B4598 		movq	-104(%rbp), %rax
 6965 0054 8B80A000 		movl	160(%rax), %eax
 6965      0000
 6966              		.loc 2 2304 13
 6967 005a 89C0     		movl	%eax, %eax
 6968 005c 48C1E004 		salq	$4, %rax
 6969 0060 4889C2   		movq	%rax, %rdx
 6970 0063 488B4598 		movq	-104(%rbp), %rax
 6971 0067 4801D0   		addq	%rdx, %rax
 6972 006a 488945E8 		movq	%rax, -24(%rbp)
2305:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         cur->crt = child;
 6973              		.loc 2 2305 18
 6974 006e 488B45E8 		movq	-24(%rbp), %rax
 6975 0072 488B55E0 		movq	-32(%rbp), %rdx
 6976 0076 488910   		movq	%rdx, (%rax)
2306:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         cur->flags = 0;
 6977              		.loc 2 2306 20
 6978 0079 488B45E8 		movq	-24(%rbp), %rax
 6979 007d C7400800 		movl	$0, 8(%rax)
 6979      000000
GAS LISTING /tmp/ccnlqVtp.s 			page 191


2307:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ver_chain->len++;
 6980              		.loc 2 2307 18
 6981 0084 488B4598 		movq	-104(%rbp), %rax
 6982 0088 8B80A000 		movl	160(%rax), %eax
 6982      0000
 6983              		.loc 2 2307 23
 6984 008e 8D5001   		leal	1(%rax), %edx
 6985 0091 488B4598 		movq	-104(%rbp), %rax
 6986 0095 8990A000 		movl	%edx, 160(%rax)
 6986      0000
2308:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         flags = &cur->flags;
 6987              		.loc 2 2308 15
 6988 009b 488B45E8 		movq	-24(%rbp), %rax
 6989 009f 4883C008 		addq	$8, %rax
 6990 00a3 488945F0 		movq	%rax, -16(%rbp)
2309:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2310:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* Check time-validity (all certificates) */
2311:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( mbedtls_x509_time_is_past( &child->valid_to ) )
 6991              		.loc 2 2311 40
 6992 00a7 488B45E0 		movq	-32(%rbp), %rax
 6993 00ab 48053001 		addq	$304, %rax
 6993      0000
 6994              		.loc 2 2311 13
 6995 00b1 4889C7   		movq	%rax, %rdi
 6996 00b4 E8000000 		call	mbedtls_x509_time_is_past@PLT
 6996      00
 6997              		.loc 2 2311 11
 6998 00b9 85C0     		testl	%eax, %eax
 6999 00bb 7411     		je	.L478
2312:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             *flags |= MBEDTLS_X509_BADCERT_EXPIRED;
 7000              		.loc 2 2312 20
 7001 00bd 488B45F0 		movq	-16(%rbp), %rax
 7002 00c1 8B00     		movl	(%rax), %eax
 7003 00c3 83C801   		orl	$1, %eax
 7004 00c6 89C2     		movl	%eax, %edx
 7005 00c8 488B45F0 		movq	-16(%rbp), %rax
 7006 00cc 8910     		movl	%edx, (%rax)
 7007              	.L478:
2313:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2314:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( mbedtls_x509_time_is_future( &child->valid_from ) )
 7008              		.loc 2 2314 42
 7009 00ce 488B45E0 		movq	-32(%rbp), %rax
 7010 00d2 48051801 		addq	$280, %rax
 7010      0000
 7011              		.loc 2 2314 13
 7012 00d8 4889C7   		movq	%rax, %rdi
 7013 00db E8000000 		call	mbedtls_x509_time_is_future@PLT
 7013      00
 7014              		.loc 2 2314 11
 7015 00e0 85C0     		testl	%eax, %eax
 7016 00e2 7411     		je	.L479
2315:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             *flags |= MBEDTLS_X509_BADCERT_FUTURE;
 7017              		.loc 2 2315 20
 7018 00e4 488B45F0 		movq	-16(%rbp), %rax
 7019 00e8 8B00     		movl	(%rax), %eax
 7020 00ea 80CC02   		orb	$2, %ah
 7021 00ed 89C2     		movl	%eax, %edx
GAS LISTING /tmp/ccnlqVtp.s 			page 192


 7022 00ef 488B45F0 		movq	-16(%rbp), %rax
 7023 00f3 8910     		movl	%edx, (%rax)
 7024              	.L479:
2316:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2317:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* Stop here for trusted roots (but not for trusted EE certs) */
2318:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( child_is_trusted )
 7025              		.loc 2 2318 11
 7026 00f5 837DCC00 		cmpl	$0, -52(%rbp)
 7027 00f9 740A     		je	.L480
2319:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( 0 );
 7028              		.loc 2 2319 19
 7029 00fb B8000000 		movl	$0, %eax
 7029      00
 7030 0100 E9CE0100 		jmp	.L491
 7030      00
 7031              	.L480:
2320:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2321:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* Check signature algorithm: MD & PK algs */
2322:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( x509_profile_check_md_alg( profile, child->sig_md ) != 0 )
 7032              		.loc 2 2322 13
 7033 0105 488B45E0 		movq	-32(%rbp), %rax
 7034 0109 8B901002 		movl	528(%rax), %edx
 7034      0000
 7035 010f 488B45A0 		movq	-96(%rbp), %rax
 7036 0113 89D6     		movl	%edx, %esi
 7037 0115 4889C7   		movq	%rax, %rdi
 7038 0118 E8000000 		call	x509_profile_check_md_alg
 7038      00
 7039              		.loc 2 2322 11
 7040 011d 85C0     		testl	%eax, %eax
 7041 011f 7411     		je	.L482
2323:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             *flags |= MBEDTLS_X509_BADCERT_BAD_MD;
 7042              		.loc 2 2323 20
 7043 0121 488B45F0 		movq	-16(%rbp), %rax
 7044 0125 8B00     		movl	(%rax), %eax
 7045 0127 80CC40   		orb	$64, %ah
 7046 012a 89C2     		movl	%eax, %edx
 7047 012c 488B45F0 		movq	-16(%rbp), %rax
 7048 0130 8910     		movl	%edx, (%rax)
 7049              	.L482:
2324:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2325:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( x509_profile_check_pk_alg( profile, child->sig_pk ) != 0 )
 7050              		.loc 2 2325 13
 7051 0132 488B45E0 		movq	-32(%rbp), %rax
 7052 0136 8B901402 		movl	532(%rax), %edx
 7052      0000
 7053 013c 488B45A0 		movq	-96(%rbp), %rax
 7054 0140 89D6     		movl	%edx, %esi
 7055 0142 4889C7   		movq	%rax, %rdi
 7056 0145 E8000000 		call	x509_profile_check_pk_alg
 7056      00
 7057              		.loc 2 2325 11
 7058 014a 85C0     		testl	%eax, %eax
 7059 014c 7411     		je	.L483
2326:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             *flags |= MBEDTLS_X509_BADCERT_BAD_PK;
 7060              		.loc 2 2326 20
 7061 014e 488B45F0 		movq	-16(%rbp), %rax
GAS LISTING /tmp/ccnlqVtp.s 			page 193


 7062 0152 8B00     		movl	(%rax), %eax
 7063 0154 80CC80   		orb	$-128, %ah
 7064 0157 89C2     		movl	%eax, %edx
 7065 0159 488B45F0 		movq	-16(%rbp), %rax
 7066 015d 8910     		movl	%edx, (%rax)
 7067              	.L483:
2327:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2328:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* Special case: EE certs that are locally trusted */
2329:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ver_chain->len == 1 &&
 7068              		.loc 2 2329 22
 7069 015f 488B4598 		movq	-104(%rbp), %rax
 7070 0163 8B80A000 		movl	160(%rax), %eax
 7070      0000
 7071              		.loc 2 2329 11
 7072 0169 83F801   		cmpl	$1, %eax
 7073 016c 7521     		jne	.L484
2330:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             x509_crt_check_ee_locally_trusted( child, trust_ca ) == 0 )
 7074              		.loc 2 2330 13 discriminator 1
 7075 016e 488B55B0 		movq	-80(%rbp), %rdx
 7076 0172 488B45E0 		movq	-32(%rbp), %rax
 7077 0176 4889D6   		movq	%rdx, %rsi
 7078 0179 4889C7   		movq	%rax, %rdi
 7079 017c E8000000 		call	x509_crt_check_ee_locally_trusted
 7079      00
2329:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             x509_crt_check_ee_locally_trusted( child, trust_ca ) == 0 )
 7080              		.loc 2 2329 33 discriminator 1
 7081 0181 85C0     		testl	%eax, %eax
 7082 0183 750A     		jne	.L484
2331:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
2332:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( 0 );
 7083              		.loc 2 2332 19
 7084 0185 B8000000 		movl	$0, %eax
 7084      00
 7085 018a E9440100 		jmp	.L491
 7085      00
 7086              	.L484:
2333:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
2334:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2335:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_ECDSA_C) && defined(MBEDTLS_ECP_RESTARTABLE)
2336:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** find_parent:
2337:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
2338:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* Look for a parent in trusted CAs or up the chain */
2339:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ret = x509_crt_find_parent( child, trust_ca, &parent,
2340:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                        &parent_is_trusted, &signature_is_good,
2341:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                        ver_chain->len - 1, self_cnt, rs_ctx );
 7087              		.loc 2 2341 49
 7088 018f 488B4598 		movq	-104(%rbp), %rax
 7089 0193 8B80A000 		movl	160(%rax), %eax
 7089      0000
2339:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                        &parent_is_trusted, &signature_is_good,
 7090              		.loc 2 2339 15
 7091 0199 448D48FF 		leal	-1(%rax), %r9d
 7092 019d 4C8D45C8 		leaq	-56(%rbp), %r8
 7093 01a1 488D4DC4 		leaq	-60(%rbp), %rcx
 7094 01a5 488D55D8 		leaq	-40(%rbp), %rdx
 7095 01a9 488B75B0 		movq	-80(%rbp), %rsi
 7096 01ad 488B45E0 		movq	-32(%rbp), %rax
GAS LISTING /tmp/ccnlqVtp.s 			page 194


 7097 01b1 FF7590   		pushq	-112(%rbp)
 7098 01b4 8B7DD0   		movl	-48(%rbp), %edi
 7099 01b7 57       		pushq	%rdi
 7100 01b8 4889C7   		movq	%rax, %rdi
 7101 01bb E8000000 		call	x509_crt_find_parent
 7101      00
 7102 01c0 4883C410 		addq	$16, %rsp
 7103 01c4 8945D4   		movl	%eax, -44(%rbp)
2342:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2343:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_ECDSA_C) && defined(MBEDTLS_ECP_RESTARTABLE)
2344:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( rs_ctx != NULL && ret == MBEDTLS_ERR_ECP_IN_PROGRESS )
2345:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
2346:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             /* save state */
2347:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             rs_ctx->in_progress = x509_crt_rs_find_parent;
2348:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             rs_ctx->self_cnt = self_cnt;
2349:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             rs_ctx->ver_chain = *ver_chain; /* struct copy */
2350:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2351:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( ret );
2352:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
2353:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #else
2354:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         (void) ret;
2355:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
2356:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2357:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* No parent? We're done here */
2358:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( parent == NULL )
 7104              		.loc 2 2358 20
 7105 01c7 488B45D8 		movq	-40(%rbp), %rax
 7106              		.loc 2 2358 11
 7107 01cb 4885C0   		testq	%rax, %rax
 7108 01ce 751B     		jne	.L485
2359:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
2360:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             *flags |= MBEDTLS_X509_BADCERT_NOT_TRUSTED;
 7109              		.loc 2 2360 20
 7110 01d0 488B45F0 		movq	-16(%rbp), %rax
 7111 01d4 8B00     		movl	(%rax), %eax
 7112 01d6 83C808   		orl	$8, %eax
 7113 01d9 89C2     		movl	%eax, %edx
 7114 01db 488B45F0 		movq	-16(%rbp), %rax
 7115 01df 8910     		movl	%edx, (%rax)
2361:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( 0 );
 7116              		.loc 2 2361 19
 7117 01e1 B8000000 		movl	$0, %eax
 7117      00
 7118 01e6 E9E80000 		jmp	.L491
 7118      00
 7119              	.L485:
2362:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
2363:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2364:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* Count intermediate self-issued (not necessarily self-signed) certs.
2365:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****          * These can occur with some strategies for key rollover, see [SIRO],
2366:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****          * and should be excluded from max_pathlen checks. */
2367:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ver_chain->len != 1 &&
 7120              		.loc 2 2367 22
 7121 01eb 488B4598 		movq	-104(%rbp), %rax
 7122 01ef 8B80A000 		movl	160(%rax), %eax
 7122      0000
 7123              		.loc 2 2367 11
GAS LISTING /tmp/ccnlqVtp.s 			page 195


 7124 01f5 83F801   		cmpl	$1, %eax
 7125 01f8 7428     		je	.L486
2368:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             x509_name_cmp( &child->issuer, &child->subject ) == 0 )
 7126              		.loc 2 2368 44 discriminator 1
 7127 01fa 488B45E0 		movq	-32(%rbp), %rax
 7128 01fe 488D90D8 		leaq	216(%rax), %rdx
 7128      000000
 7129              		.loc 2 2368 28 discriminator 1
 7130 0205 488B45E0 		movq	-32(%rbp), %rax
 7131 0209 48059800 		addq	$152, %rax
 7131      0000
 7132              		.loc 2 2368 13 discriminator 1
 7133 020f 4889D6   		movq	%rdx, %rsi
 7134 0212 4889C7   		movq	%rax, %rdi
 7135 0215 E8000000 		call	x509_name_cmp
 7135      00
2367:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             x509_name_cmp( &child->issuer, &child->subject ) == 0 )
 7136              		.loc 2 2367 33 discriminator 1
 7137 021a 85C0     		testl	%eax, %eax
 7138 021c 7504     		jne	.L486
2369:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
2370:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             self_cnt++;
 7139              		.loc 2 2370 21
 7140 021e 8345D001 		addl	$1, -48(%rbp)
 7141              	.L486:
2371:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
2372:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2373:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* path_cnt is 0 for the first intermediate CA,
2374:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****          * and if parent is trusted it's not an intermediate CA */
2375:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ! parent_is_trusted &&
 7142              		.loc 2 2375 13
 7143 0222 8B45C4   		movl	-60(%rbp), %eax
 7144              		.loc 2 2375 11
 7145 0225 85C0     		testl	%eax, %eax
 7146 0227 7519     		jne	.L487
2376:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             ver_chain->len > MBEDTLS_X509_MAX_INTERMEDIATE_CA )
 7147              		.loc 2 2376 22 discriminator 1
 7148 0229 488B4598 		movq	-104(%rbp), %rax
 7149 022d 8B80A000 		movl	160(%rax), %eax
 7149      0000
2375:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             ver_chain->len > MBEDTLS_X509_MAX_INTERMEDIATE_CA )
 7150              		.loc 2 2375 33 discriminator 1
 7151 0233 83F808   		cmpl	$8, %eax
 7152 0236 760A     		jbe	.L487
2377:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
2378:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             /* return immediately to avoid overflow the chain array */
2379:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             return( MBEDTLS_ERR_X509_FATAL_ERROR );
 7153              		.loc 2 2379 19
 7154 0238 B800D0FF 		movl	$-12288, %eax
 7154      FF
 7155 023d E9910000 		jmp	.L491
 7155      00
 7156              	.L487:
2380:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
2381:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2382:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* signature was checked while searching parent */
2383:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( ! signature_is_good )
GAS LISTING /tmp/ccnlqVtp.s 			page 196


 7157              		.loc 2 2383 13
 7158 0242 8B45C8   		movl	-56(%rbp), %eax
 7159              		.loc 2 2383 11
 7160 0245 85C0     		testl	%eax, %eax
 7161 0247 7511     		jne	.L488
2384:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             *flags |= MBEDTLS_X509_BADCERT_NOT_TRUSTED;
 7162              		.loc 2 2384 20
 7163 0249 488B45F0 		movq	-16(%rbp), %rax
 7164 024d 8B00     		movl	(%rax), %eax
 7165 024f 83C808   		orl	$8, %eax
 7166 0252 89C2     		movl	%eax, %edx
 7167 0254 488B45F0 		movq	-16(%rbp), %rax
 7168 0258 8910     		movl	%edx, (%rax)
 7169              	.L488:
2385:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2386:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* check size of signing key */
2387:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( x509_profile_check_key( profile, &parent->pk ) != 0 )
 7170              		.loc 2 2387 53
 7171 025a 488B45D8 		movq	-40(%rbp), %rax
 7172              		.loc 2 2387 46
 7173 025e 488D9048 		leaq	328(%rax), %rdx
 7173      010000
 7174              		.loc 2 2387 13
 7175 0265 488B45A0 		movq	-96(%rbp), %rax
 7176 0269 4889D6   		movq	%rdx, %rsi
 7177 026c 4889C7   		movq	%rax, %rdi
 7178 026f E8000000 		call	x509_profile_check_key
 7178      00
 7179              		.loc 2 2387 11
 7180 0274 85C0     		testl	%eax, %eax
 7181 0276 7413     		je	.L489
2388:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             *flags |= MBEDTLS_X509_BADCERT_BAD_KEY;
 7182              		.loc 2 2388 20
 7183 0278 488B45F0 		movq	-16(%rbp), %rax
 7184 027c 8B00     		movl	(%rax), %eax
 7185 027e 0D000001 		orl	$65536, %eax
 7185      00
 7186 0283 89C2     		movl	%eax, %edx
 7187 0285 488B45F0 		movq	-16(%rbp), %rax
 7188 0289 8910     		movl	%edx, (%rax)
 7189              	.L489:
2389:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2390:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_X509_CRL_PARSE_C)
2391:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* Check trusted CA's CRL for the given crt */
2392:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         *flags |= x509_crt_verifycrl( child, parent, ca_crl, profile );
 7190              		.loc 2 2392 19
 7191 028b 488B75D8 		movq	-40(%rbp), %rsi
 7192 028f 488B4DA0 		movq	-96(%rbp), %rcx
 7193 0293 488B55A8 		movq	-88(%rbp), %rdx
 7194 0297 488B45E0 		movq	-32(%rbp), %rax
 7195 029b 4889C7   		movq	%rax, %rdi
 7196 029e E8000000 		call	x509_crt_verifycrl
 7196      00
 7197              		.loc 2 2392 16
 7198 02a3 488B55F0 		movq	-16(%rbp), %rdx
 7199 02a7 8B12     		movl	(%rdx), %edx
 7200 02a9 09C2     		orl	%eax, %edx
GAS LISTING /tmp/ccnlqVtp.s 			page 197


 7201 02ab 488B45F0 		movq	-16(%rbp), %rax
 7202 02af 8910     		movl	%edx, (%rax)
2393:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #else
2394:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         (void) ca_crl;
2395:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
2396:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2397:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         /* prepare for next iteration */
2398:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         child = parent;
 7203              		.loc 2 2398 15
 7204 02b1 488B45D8 		movq	-40(%rbp), %rax
 7205 02b5 488945E0 		movq	%rax, -32(%rbp)
2399:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         parent = NULL;
 7206              		.loc 2 2399 16
 7207 02b9 48C745D8 		movq	$0, -40(%rbp)
 7207      00000000 
2400:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         child_is_trusted = parent_is_trusted;
 7208              		.loc 2 2400 26
 7209 02c1 8B45C4   		movl	-60(%rbp), %eax
 7210 02c4 8945CC   		movl	%eax, -52(%rbp)
2401:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         signature_is_good = 0;
 7211              		.loc 2 2401 27
 7212 02c7 C745C800 		movl	$0, -56(%rbp)
 7212      000000
2304:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         cur->crt = child;
 7213              		.loc 2 2304 13
 7214 02ce E97DFDFF 		jmp	.L490
 7214      FF
 7215              	.L491:
2402:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
2403:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 7216              		.loc 2 2403 1 discriminator 1
 7217 02d3 488B4DF8 		movq	-8(%rbp), %rcx
 7218 02d7 6448330C 		xorq	%fs:40, %rcx
 7218      25280000 
 7218      00
 7219 02e0 7405     		je	.L492
 7220              		.loc 2 2403 1 is_stmt 0
 7221 02e2 E8000000 		call	__stack_chk_fail@PLT
 7221      00
 7222              	.L492:
 7223 02e7 C9       		leave
 7224              	.LCFI110:
 7225              		.cfi_def_cfa 7, 8
 7226 02e8 C3       		ret
 7227              		.cfi_endproc
 7228              	.LFE51:
 7230              		.section	.text.x509_crt_check_cn,"ax",@progbits
 7232              	x509_crt_check_cn:
 7233              	.LFB52:
2404:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2405:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
2406:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Check for CN match
2407:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
2408:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_crt_check_cn( const mbedtls_x509_buf *name,
2409:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                               const char *cn, size_t cn_len )
2410:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 7234              		.loc 2 2410 1 is_stmt 1
GAS LISTING /tmp/ccnlqVtp.s 			page 198


 7235              		.cfi_startproc
 7236 0000 F30F1EFA 		endbr64
 7237 0004 55       		pushq	%rbp
 7238              	.LCFI111:
 7239              		.cfi_def_cfa_offset 16
 7240              		.cfi_offset 6, -16
 7241 0005 4889E5   		movq	%rsp, %rbp
 7242              	.LCFI112:
 7243              		.cfi_def_cfa_register 6
 7244 0008 4883EC30 		subq	$48, %rsp
 7245 000c 48897DE8 		movq	%rdi, -24(%rbp)
 7246 0010 488975E0 		movq	%rsi, -32(%rbp)
 7247 0014 488955D8 		movq	%rdx, -40(%rbp)
 7248              		.loc 2 2410 1
 7249 0018 64488B04 		movq	%fs:40, %rax
 7249      25280000 
 7249      00
 7250 0021 488945F8 		movq	%rax, -8(%rbp)
 7251 0025 31C0     		xorl	%eax, %eax
2411:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* try exact match */
2412:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( name->len == cn_len &&
 7252              		.loc 2 2412 13
 7253 0027 488B45E8 		movq	-24(%rbp), %rax
 7254 002b 488B4008 		movq	8(%rax), %rax
 7255              		.loc 2 2412 7
 7256 002f 483945D8 		cmpq	%rax, -40(%rbp)
 7257 0033 7526     		jne	.L494
2413:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         x509_memcasecmp( cn, name->p, cn_len ) == 0 )
 7258              		.loc 2 2413 34 discriminator 1
 7259 0035 488B45E8 		movq	-24(%rbp), %rax
 7260 0039 488B4810 		movq	16(%rax), %rcx
 7261              		.loc 2 2413 9 discriminator 1
 7262 003d 488B55D8 		movq	-40(%rbp), %rdx
 7263 0041 488B45E0 		movq	-32(%rbp), %rax
 7264 0045 4889CE   		movq	%rcx, %rsi
 7265 0048 4889C7   		movq	%rax, %rdi
 7266 004b E8000000 		call	x509_memcasecmp
 7266      00
2412:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         x509_memcasecmp( cn, name->p, cn_len ) == 0 )
 7267              		.loc 2 2412 29 discriminator 1
 7268 0050 85C0     		testl	%eax, %eax
 7269 0052 7507     		jne	.L494
2414:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
2415:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( 0 );
 7270              		.loc 2 2415 15
 7271 0054 B8000000 		movl	$0, %eax
 7271      00
 7272 0059 EB23     		jmp	.L495
 7273              	.L494:
2416:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
2417:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2418:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* try wildcard match */
2419:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( x509_check_wildcard( cn, name ) == 0 )
 7274              		.loc 2 2419 9
 7275 005b 488B55E8 		movq	-24(%rbp), %rdx
 7276 005f 488B45E0 		movq	-32(%rbp), %rax
 7277 0063 4889D6   		movq	%rdx, %rsi
GAS LISTING /tmp/ccnlqVtp.s 			page 199


 7278 0066 4889C7   		movq	%rax, %rdi
 7279 0069 E8000000 		call	x509_check_wildcard
 7279      00
 7280              		.loc 2 2419 7
 7281 006e 85C0     		testl	%eax, %eax
 7282 0070 7507     		jne	.L496
2420:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
2421:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( 0 );
 7283              		.loc 2 2421 15
 7284 0072 B8000000 		movl	$0, %eax
 7284      00
 7285 0077 EB05     		jmp	.L495
 7286              	.L496:
2422:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
2423:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2424:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( -1 );
 7287              		.loc 2 2424 11
 7288 0079 B8FFFFFF 		movl	$-1, %eax
 7288      FF
 7289              	.L495:
2425:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 7290              		.loc 2 2425 1
 7291 007e 488B4DF8 		movq	-8(%rbp), %rcx
 7292 0082 6448330C 		xorq	%fs:40, %rcx
 7292      25280000 
 7292      00
 7293 008b 7405     		je	.L497
 7294 008d E8000000 		call	__stack_chk_fail@PLT
 7294      00
 7295              	.L497:
 7296 0092 C9       		leave
 7297              	.LCFI113:
 7298              		.cfi_def_cfa 7, 8
 7299 0093 C3       		ret
 7300              		.cfi_endproc
 7301              	.LFE52:
 7303              		.section	.rodata
 7304              	.LC64:
 7305 0760 55040300 		.string	"U\004\003"
 7306              		.section	.text.x509_crt_verify_name,"ax",@progbits
 7308              	x509_crt_verify_name:
 7309              	.LFB53:
2426:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2427:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
2428:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Verify the requested CN - only call this if cn is not NULL!
2429:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
2430:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static void x509_crt_verify_name( const mbedtls_x509_crt *crt,
2431:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                   const char *cn,
2432:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                   uint32_t *flags )
2433:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 7310              		.loc 2 2433 1
 7311              		.cfi_startproc
 7312 0000 F30F1EFA 		endbr64
 7313 0004 55       		pushq	%rbp
 7314              	.LCFI114:
 7315              		.cfi_def_cfa_offset 16
 7316              		.cfi_offset 6, -16
GAS LISTING /tmp/ccnlqVtp.s 			page 200


 7317 0005 4889E5   		movq	%rsp, %rbp
 7318              	.LCFI115:
 7319              		.cfi_def_cfa_register 6
 7320 0008 4883EC40 		subq	$64, %rsp
 7321 000c 48897DD8 		movq	%rdi, -40(%rbp)
 7322 0010 488975D0 		movq	%rsi, -48(%rbp)
 7323 0014 488955C8 		movq	%rdx, -56(%rbp)
 7324              		.loc 2 2433 1
 7325 0018 64488B04 		movq	%fs:40, %rax
 7325      25280000 
 7325      00
 7326 0021 488945F8 		movq	%rax, -8(%rbp)
 7327 0025 31C0     		xorl	%eax, %eax
2434:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     const mbedtls_x509_name *name;
2435:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     const mbedtls_x509_sequence *cur;
2436:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     size_t cn_len = strlen( cn );
 7328              		.loc 2 2436 21
 7329 0027 488B45D0 		movq	-48(%rbp), %rax
 7330 002b 4889C7   		movq	%rax, %rdi
 7331 002e E8000000 		call	strlen@PLT
 7331      00
 7332 0033 488945F0 		movq	%rax, -16(%rbp)
2437:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2438:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( crt->ext_types & MBEDTLS_X509_EXT_SUBJECT_ALT_NAME )
 7333              		.loc 2 2438 12
 7334 0037 488B45D8 		movq	-40(%rbp), %rax
 7335 003b 8B80C001 		movl	448(%rax), %eax
 7335      0000
 7336              		.loc 2 2438 24
 7337 0041 83E020   		andl	$32, %eax
 7338              		.loc 2 2438 7
 7339 0044 85C0     		testl	%eax, %eax
 7340 0046 7462     		je	.L499
2439:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
2440:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         for( cur = &crt->subject_alt_names; cur != NULL; cur = cur->next )
 7341              		.loc 2 2440 18
 7342 0048 488B45D8 		movq	-40(%rbp), %rax
 7343 004c 4805A001 		addq	$416, %rax
 7343      0000
 7344 0052 488945E8 		movq	%rax, -24(%rbp)
 7345              		.loc 2 2440 9
 7346 0056 EB27     		jmp	.L500
 7347              	.L503:
2441:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
2442:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             if( x509_crt_check_cn( &cur->buf, cn, cn_len ) == 0 )
 7348              		.loc 2 2442 36
 7349 0058 488B45E8 		movq	-24(%rbp), %rax
 7350              		.loc 2 2442 17
 7351 005c 488B55F0 		movq	-16(%rbp), %rdx
 7352 0060 488B4DD0 		movq	-48(%rbp), %rcx
 7353 0064 4889CE   		movq	%rcx, %rsi
 7354 0067 4889C7   		movq	%rax, %rdi
 7355 006a E8000000 		call	x509_crt_check_cn
 7355      00
 7356              		.loc 2 2442 15
 7357 006f 85C0     		testl	%eax, %eax
 7358 0071 7415     		je	.L513
GAS LISTING /tmp/ccnlqVtp.s 			page 201


2440:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
 7359              		.loc 2 2440 62 discriminator 2
 7360 0073 488B45E8 		movq	-24(%rbp), %rax
 7361 0077 488B4018 		movq	24(%rax), %rax
 7362 007b 488945E8 		movq	%rax, -24(%rbp)
 7363              	.L500:
2440:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
 7364              		.loc 2 2440 9 discriminator 1
 7365 007f 48837DE8 		cmpq	$0, -24(%rbp)
 7365      00
 7366 0084 75D2     		jne	.L503
 7367 0086 EB01     		jmp	.L502
 7368              	.L513:
2443:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 break;
 7369              		.loc 2 2443 17
 7370 0088 90       		nop
 7371              	.L502:
2444:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
2445:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2446:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( cur == NULL )
 7372              		.loc 2 2446 11
 7373 0089 48837DE8 		cmpq	$0, -24(%rbp)
 7373      00
 7374 008e 0F85B400 		jne	.L514
 7374      0000
2447:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             *flags |= MBEDTLS_X509_BADCERT_CN_MISMATCH;
 7375              		.loc 2 2447 20
 7376 0094 488B45C8 		movq	-56(%rbp), %rax
 7377 0098 8B00     		movl	(%rax), %eax
 7378 009a 83C804   		orl	$4, %eax
 7379 009d 89C2     		movl	%eax, %edx
 7380 009f 488B45C8 		movq	-56(%rbp), %rax
 7381 00a3 8910     		movl	%edx, (%rax)
2448:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
2449:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     else
2450:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
2451:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         for( name = &crt->subject; name != NULL; name = name->next )
2452:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
2453:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             if( MBEDTLS_OID_CMP( MBEDTLS_OID_AT_CN, &name->oid ) == 0 &&
2454:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 x509_crt_check_cn( &name->val, cn, cn_len ) == 0 )
2455:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             {
2456:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 break;
2457:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             }
2458:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
2459:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2460:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( name == NULL )
2461:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             *flags |= MBEDTLS_X509_BADCERT_CN_MISMATCH;
2462:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
2463:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 7382              		.loc 2 2463 1
 7383 00a5 E99E0000 		jmp	.L514
 7383      00
 7384              	.L499:
2451:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
 7385              		.loc 2 2451 19
 7386 00aa 488B45D8 		movq	-40(%rbp), %rax
 7387 00ae 4805D800 		addq	$216, %rax
GAS LISTING /tmp/ccnlqVtp.s 			page 202


 7387      0000
 7388 00b4 488945E0 		movq	%rax, -32(%rbp)
2451:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
 7389              		.loc 2 2451 9
 7390 00b8 EB6C     		jmp	.L505
 7391              	.L511:
2453:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 x509_crt_check_cn( &name->val, cn, cn_len ) == 0 )
 7392              		.loc 2 2453 17
 7393 00ba 488B45E0 		movq	-32(%rbp), %rax
 7394 00be 488B4008 		movq	8(%rax), %rax
 7395 00c2 4883F803 		cmpq	$3, %rax
 7396 00c6 7523     		jne	.L506
2453:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 x509_crt_check_cn( &name->val, cn, cn_len ) == 0 )
 7397              		.loc 2 2453 17 is_stmt 0 discriminator 2
 7398 00c8 488B45E0 		movq	-32(%rbp), %rax
 7399 00cc 488B5008 		movq	8(%rax), %rdx
 7400 00d0 488B45E0 		movq	-32(%rbp), %rax
 7401 00d4 488B4010 		movq	16(%rax), %rax
 7402 00d8 4889C6   		movq	%rax, %rsi
 7403 00db 488D3D00 		leaq	.LC64(%rip), %rdi
 7403      000000
 7404 00e2 E8000000 		call	memcmp@PLT
 7404      00
 7405 00e7 85C0     		testl	%eax, %eax
 7406 00e9 7407     		je	.L507
 7407              	.L506:
2453:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 x509_crt_check_cn( &name->val, cn, cn_len ) == 0 )
 7408              		.loc 2 2453 17 discriminator 3
 7409 00eb B8010000 		movl	$1, %eax
 7409      00
 7410 00f0 EB05     		jmp	.L508
 7411              	.L507:
2453:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 x509_crt_check_cn( &name->val, cn, cn_len ) == 0 )
 7412              		.loc 2 2453 17 discriminator 4
 7413 00f2 B8000000 		movl	$0, %eax
 7413      00
 7414              	.L508:
2453:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 x509_crt_check_cn( &name->val, cn, cn_len ) == 0 )
 7415              		.loc 2 2453 15 is_stmt 1 discriminator 6
 7416 00f7 85C0     		testl	%eax, %eax
 7417 00f9 751F     		jne	.L509
2454:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             {
 7418              		.loc 2 2454 36 discriminator 7
 7419 00fb 488B45E0 		movq	-32(%rbp), %rax
 7420 00ff 488D4818 		leaq	24(%rax), %rcx
2454:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             {
 7421              		.loc 2 2454 17 discriminator 7
 7422 0103 488B55F0 		movq	-16(%rbp), %rdx
 7423 0107 488B45D0 		movq	-48(%rbp), %rax
 7424 010b 4889C6   		movq	%rax, %rsi
 7425 010e 4889CF   		movq	%rcx, %rdi
 7426 0111 E8000000 		call	x509_crt_check_cn
 7426      00
2453:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 x509_crt_check_cn( &name->val, cn, cn_len ) == 0 )
 7427              		.loc 2 2453 71 discriminator 7
 7428 0116 85C0     		testl	%eax, %eax
 7429 0118 7415     		je	.L515
GAS LISTING /tmp/ccnlqVtp.s 			page 203


 7430              	.L509:
2451:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
 7431              		.loc 2 2451 55 discriminator 2
 7432 011a 488B45E0 		movq	-32(%rbp), %rax
 7433 011e 488B4030 		movq	48(%rax), %rax
 7434 0122 488945E0 		movq	%rax, -32(%rbp)
 7435              	.L505:
2451:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
 7436              		.loc 2 2451 9 discriminator 1
 7437 0126 48837DE0 		cmpq	$0, -32(%rbp)
 7437      00
 7438 012b 758D     		jne	.L511
 7439 012d EB01     		jmp	.L510
 7440              	.L515:
2456:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             }
 7441              		.loc 2 2456 17
 7442 012f 90       		nop
 7443              	.L510:
2460:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             *flags |= MBEDTLS_X509_BADCERT_CN_MISMATCH;
 7444              		.loc 2 2460 11
 7445 0130 48837DE0 		cmpq	$0, -32(%rbp)
 7445      00
 7446 0135 7511     		jne	.L514
2461:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
 7447              		.loc 2 2461 20
 7448 0137 488B45C8 		movq	-56(%rbp), %rax
 7449 013b 8B00     		movl	(%rax), %eax
 7450 013d 83C804   		orl	$4, %eax
 7451 0140 89C2     		movl	%eax, %edx
 7452 0142 488B45C8 		movq	-56(%rbp), %rax
 7453 0146 8910     		movl	%edx, (%rax)
 7454              	.L514:
 7455              		.loc 2 2463 1
 7456 0148 90       		nop
 7457 0149 488B45F8 		movq	-8(%rbp), %rax
 7458 014d 64483304 		xorq	%fs:40, %rax
 7458      25280000 
 7458      00
 7459 0156 7405     		je	.L512
 7460 0158 E8000000 		call	__stack_chk_fail@PLT
 7460      00
 7461              	.L512:
 7462 015d C9       		leave
 7463              	.LCFI116:
 7464              		.cfi_def_cfa 7, 8
 7465 015e C3       		ret
 7466              		.cfi_endproc
 7467              	.LFE53:
 7469              		.section	.text.x509_crt_merge_flags_with_cb,"ax",@progbits
 7471              	x509_crt_merge_flags_with_cb:
 7472              	.LFB54:
2464:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2465:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
2466:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Merge the flags for all certs in the chain, after calling callback
2467:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
2468:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** static int x509_crt_merge_flags_with_cb(
2469:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****            uint32_t *flags,
GAS LISTING /tmp/ccnlqVtp.s 			page 204


2470:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****            const mbedtls_x509_crt_verify_chain *ver_chain,
2471:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****            int (*f_vrfy)(void *, mbedtls_x509_crt *, int, uint32_t *),
2472:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****            void *p_vrfy )
2473:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 7473              		.loc 2 2473 1
 7474              		.cfi_startproc
 7475 0000 F30F1EFA 		endbr64
 7476 0004 55       		pushq	%rbp
 7477              	.LCFI117:
 7478              		.cfi_def_cfa_offset 16
 7479              		.cfi_offset 6, -16
 7480 0005 4889E5   		movq	%rsp, %rbp
 7481              	.LCFI118:
 7482              		.cfi_def_cfa_register 6
 7483 0008 4883EC40 		subq	$64, %rsp
 7484 000c 48897DD8 		movq	%rdi, -40(%rbp)
 7485 0010 488975D0 		movq	%rsi, -48(%rbp)
 7486 0014 488955C8 		movq	%rdx, -56(%rbp)
 7487 0018 48894DC0 		movq	%rcx, -64(%rbp)
 7488              		.loc 2 2473 1
 7489 001c 64488B04 		movq	%fs:40, %rax
 7489      25280000 
 7489      00
 7490 0025 488945F8 		movq	%rax, -8(%rbp)
 7491 0029 31C0     		xorl	%eax, %eax
2474:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int ret;
2475:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     unsigned i;
2476:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     uint32_t cur_flags;
2477:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     const mbedtls_x509_crt_verify_chain_item *cur;
2478:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2479:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     for( i = ver_chain->len; i != 0; --i )
 7492              		.loc 2 2479 12
 7493 002b 488B45D0 		movq	-48(%rbp), %rax
 7494 002f 8B80A000 		movl	160(%rax), %eax
 7494      0000
 7495 0035 8945E8   		movl	%eax, -24(%rbp)
 7496              		.loc 2 2479 5
 7497 0038 EB72     		jmp	.L517
 7498              	.L520:
2480:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
2481:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         cur = &ver_chain->items[i-1];
 7499              		.loc 2 2481 34
 7500 003a 8B45E8   		movl	-24(%rbp), %eax
 7501 003d 83E801   		subl	$1, %eax
 7502              		.loc 2 2481 13
 7503 0040 89C0     		movl	%eax, %eax
 7504 0042 48C1E004 		salq	$4, %rax
 7505 0046 4889C2   		movq	%rax, %rdx
 7506 0049 488B45D0 		movq	-48(%rbp), %rax
 7507 004d 4801D0   		addq	%rdx, %rax
 7508 0050 488945F0 		movq	%rax, -16(%rbp)
2482:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         cur_flags = cur->flags;
 7509              		.loc 2 2482 24
 7510 0054 488B45F0 		movq	-16(%rbp), %rax
 7511 0058 8B4008   		movl	8(%rax), %eax
 7512              		.loc 2 2482 19
 7513 005b 8945E4   		movl	%eax, -28(%rbp)
GAS LISTING /tmp/ccnlqVtp.s 			page 205


2483:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2484:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( NULL != f_vrfy )
 7514              		.loc 2 2484 11
 7515 005e 48837DC8 		cmpq	$0, -56(%rbp)
 7515      00
 7516 0063 7432     		je	.L518
2485:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             if( ( ret = f_vrfy( p_vrfy, cur->crt, (int) i-1, &cur_flags ) ) != 0 )
 7517              		.loc 2 2485 51
 7518 0065 8B45E8   		movl	-24(%rbp), %eax
 7519              		.loc 2 2485 25
 7520 0068 8D78FF   		leal	-1(%rax), %edi
 7521 006b 488B45F0 		movq	-16(%rbp), %rax
 7522 006f 488B30   		movq	(%rax), %rsi
 7523 0072 488D55E4 		leaq	-28(%rbp), %rdx
 7524 0076 488B45C0 		movq	-64(%rbp), %rax
 7525 007a 4C8B45C8 		movq	-56(%rbp), %r8
 7526 007e 4889D1   		movq	%rdx, %rcx
 7527 0081 89FA     		movl	%edi, %edx
 7528 0083 4889C7   		movq	%rax, %rdi
 7529 0086 41FFD0   		call	*%r8
 7530              	.LVL36:
 7531 0089 8945EC   		movl	%eax, -20(%rbp)
 7532              		.loc 2 2485 15
 7533 008c 837DEC00 		cmpl	$0, -20(%rbp)
 7534 0090 7405     		je	.L518
2486:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 return( ret );
 7535              		.loc 2 2486 23
 7536 0092 8B45EC   		movl	-20(%rbp), %eax
 7537 0095 EB20     		jmp	.L521
 7538              	.L518:
2487:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2488:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         *flags |= cur_flags;
 7539              		.loc 2 2488 16 discriminator 2
 7540 0097 488B45D8 		movq	-40(%rbp), %rax
 7541 009b 8B10     		movl	(%rax), %edx
 7542 009d 8B45E4   		movl	-28(%rbp), %eax
 7543 00a0 09C2     		orl	%eax, %edx
 7544 00a2 488B45D8 		movq	-40(%rbp), %rax
 7545 00a6 8910     		movl	%edx, (%rax)
2479:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 7546              		.loc 2 2479 38 discriminator 2
 7547 00a8 836DE801 		subl	$1, -24(%rbp)
 7548              	.L517:
2479:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
 7549              		.loc 2 2479 5 discriminator 1
 7550 00ac 837DE800 		cmpl	$0, -24(%rbp)
 7551 00b0 7588     		jne	.L520
2489:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
2490:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2491:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 7552              		.loc 2 2491 11
 7553 00b2 B8000000 		movl	$0, %eax
 7553      00
 7554              	.L521:
2492:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 7555              		.loc 2 2492 1 discriminator 1
 7556 00b7 488B4DF8 		movq	-8(%rbp), %rcx
GAS LISTING /tmp/ccnlqVtp.s 			page 206


 7557 00bb 6448330C 		xorq	%fs:40, %rcx
 7557      25280000 
 7557      00
 7558 00c4 7405     		je	.L522
 7559              		.loc 2 2492 1 is_stmt 0
 7560 00c6 E8000000 		call	__stack_chk_fail@PLT
 7560      00
 7561              	.L522:
 7562 00cb C9       		leave
 7563              	.LCFI119:
 7564              		.cfi_def_cfa 7, 8
 7565 00cc C3       		ret
 7566              		.cfi_endproc
 7567              	.LFE54:
 7569              		.section	.text.mbedtls_x509_crt_verify,"ax",@progbits
 7570              		.globl	mbedtls_x509_crt_verify
 7572              	mbedtls_x509_crt_verify:
 7573              	.LFB55:
2493:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2494:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
2495:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Verify the certificate validity (default profile, not restartable)
2496:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
2497:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** int mbedtls_x509_crt_verify( mbedtls_x509_crt *crt,
2498:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                      mbedtls_x509_crt *trust_ca,
2499:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                      mbedtls_x509_crl *ca_crl,
2500:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                      const char *cn, uint32_t *flags,
2501:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                      int (*f_vrfy)(void *, mbedtls_x509_crt *, int, uint32_t *),
2502:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                      void *p_vrfy )
2503:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 7574              		.loc 2 2503 1 is_stmt 1
 7575              		.cfi_startproc
 7576 0000 F30F1EFA 		endbr64
 7577 0004 55       		pushq	%rbp
 7578              	.LCFI120:
 7579              		.cfi_def_cfa_offset 16
 7580              		.cfi_offset 6, -16
 7581 0005 4889E5   		movq	%rsp, %rbp
 7582              	.LCFI121:
 7583              		.cfi_def_cfa_register 6
 7584 0008 4883EC50 		subq	$80, %rsp
 7585 000c 48897DE8 		movq	%rdi, -24(%rbp)
 7586 0010 488975E0 		movq	%rsi, -32(%rbp)
 7587 0014 488955D8 		movq	%rdx, -40(%rbp)
 7588 0018 48894DD0 		movq	%rcx, -48(%rbp)
 7589 001c 4C8945C8 		movq	%r8, -56(%rbp)
 7590 0020 4C894DC0 		movq	%r9, -64(%rbp)
 7591 0024 488B4510 		movq	16(%rbp), %rax
 7592 0028 488945B8 		movq	%rax, -72(%rbp)
 7593              		.loc 2 2503 1
 7594 002c 64488B04 		movq	%fs:40, %rax
 7594      25280000 
 7594      00
 7595 0035 488945F8 		movq	%rax, -8(%rbp)
 7596 0039 31C0     		xorl	%eax, %eax
2504:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( mbedtls_x509_crt_verify_restartable( crt, trust_ca, ca_crl,
 7597              		.loc 2 2504 13
 7598 003b 488B7DC8 		movq	-56(%rbp), %rdi
GAS LISTING /tmp/ccnlqVtp.s 			page 207


 7599 003f 488B4DD0 		movq	-48(%rbp), %rcx
 7600 0043 488B55D8 		movq	-40(%rbp), %rdx
 7601 0047 488B75E0 		movq	-32(%rbp), %rsi
 7602 004b 488B45E8 		movq	-24(%rbp), %rax
 7603 004f 4883EC08 		subq	$8, %rsp
 7604 0053 6A00     		pushq	$0
 7605 0055 FF75B8   		pushq	-72(%rbp)
 7606 0058 FF75C0   		pushq	-64(%rbp)
 7607 005b 4989F9   		movq	%rdi, %r9
 7608 005e 4989C8   		movq	%rcx, %r8
 7609 0061 488D0D00 		leaq	mbedtls_x509_crt_profile_default(%rip), %rcx
 7609      000000
 7610 0068 4889C7   		movq	%rax, %rdi
 7611 006b E8000000 		call	mbedtls_x509_crt_verify_restartable
 7611      00
 7612 0070 4883C420 		addq	$32, %rsp
2505:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 &mbedtls_x509_crt_profile_default, cn, flags,
2506:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 f_vrfy, p_vrfy, NULL ) );
2507:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 7613              		.loc 2 2507 1
 7614 0074 488B55F8 		movq	-8(%rbp), %rdx
 7615 0078 64483314 		xorq	%fs:40, %rdx
 7615      25280000 
 7615      00
 7616 0081 7405     		je	.L525
 7617 0083 E8000000 		call	__stack_chk_fail@PLT
 7617      00
 7618              	.L525:
 7619 0088 C9       		leave
 7620              	.LCFI122:
 7621              		.cfi_def_cfa 7, 8
 7622 0089 C3       		ret
 7623              		.cfi_endproc
 7624              	.LFE55:
 7626              		.section	.text.mbedtls_x509_crt_verify_with_profile,"ax",@progbits
 7627              		.globl	mbedtls_x509_crt_verify_with_profile
 7629              	mbedtls_x509_crt_verify_with_profile:
 7630              	.LFB56:
2508:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2509:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
2510:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Verify the certificate validity (user-chosen profile, not restartable)
2511:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
2512:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** int mbedtls_x509_crt_verify_with_profile( mbedtls_x509_crt *crt,
2513:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                      mbedtls_x509_crt *trust_ca,
2514:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                      mbedtls_x509_crl *ca_crl,
2515:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                      const mbedtls_x509_crt_profile *profile,
2516:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                      const char *cn, uint32_t *flags,
2517:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                      int (*f_vrfy)(void *, mbedtls_x509_crt *, int, uint32_t *),
2518:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                      void *p_vrfy )
2519:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 7631              		.loc 2 2519 1
 7632              		.cfi_startproc
 7633 0000 F30F1EFA 		endbr64
 7634 0004 55       		pushq	%rbp
 7635              	.LCFI123:
 7636              		.cfi_def_cfa_offset 16
 7637              		.cfi_offset 6, -16
GAS LISTING /tmp/ccnlqVtp.s 			page 208


 7638 0005 4889E5   		movq	%rsp, %rbp
 7639              	.LCFI124:
 7640              		.cfi_def_cfa_register 6
 7641 0008 4883EC50 		subq	$80, %rsp
 7642 000c 48897DE8 		movq	%rdi, -24(%rbp)
 7643 0010 488975E0 		movq	%rsi, -32(%rbp)
 7644 0014 488955D8 		movq	%rdx, -40(%rbp)
 7645 0018 48894DD0 		movq	%rcx, -48(%rbp)
 7646 001c 4C8945C8 		movq	%r8, -56(%rbp)
 7647 0020 4C894DC0 		movq	%r9, -64(%rbp)
 7648 0024 488B4510 		movq	16(%rbp), %rax
 7649 0028 488945B8 		movq	%rax, -72(%rbp)
 7650 002c 488B4518 		movq	24(%rbp), %rax
 7651 0030 488945B0 		movq	%rax, -80(%rbp)
 7652              		.loc 2 2519 1
 7653 0034 64488B04 		movq	%fs:40, %rax
 7653      25280000 
 7653      00
 7654 003d 488945F8 		movq	%rax, -8(%rbp)
 7655 0041 31C0     		xorl	%eax, %eax
2520:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( mbedtls_x509_crt_verify_restartable( crt, trust_ca, ca_crl,
 7656              		.loc 2 2520 13
 7657 0043 4C8B45C0 		movq	-64(%rbp), %r8
 7658 0047 488B7DC8 		movq	-56(%rbp), %rdi
 7659 004b 488B4DD0 		movq	-48(%rbp), %rcx
 7660 004f 488B55D8 		movq	-40(%rbp), %rdx
 7661 0053 488B75E0 		movq	-32(%rbp), %rsi
 7662 0057 488B45E8 		movq	-24(%rbp), %rax
 7663 005b 4883EC08 		subq	$8, %rsp
 7664 005f 6A00     		pushq	$0
 7665 0061 FF75B0   		pushq	-80(%rbp)
 7666 0064 FF75B8   		pushq	-72(%rbp)
 7667 0067 4D89C1   		movq	%r8, %r9
 7668 006a 4989F8   		movq	%rdi, %r8
 7669 006d 4889C7   		movq	%rax, %rdi
 7670 0070 E8000000 		call	mbedtls_x509_crt_verify_restartable
 7670      00
 7671 0075 4883C420 		addq	$32, %rsp
2521:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                 profile, cn, flags, f_vrfy, p_vrfy, NULL ) );
2522:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 7672              		.loc 2 2522 1
 7673 0079 488B55F8 		movq	-8(%rbp), %rdx
 7674 007d 64483314 		xorq	%fs:40, %rdx
 7674      25280000 
 7674      00
 7675 0086 7405     		je	.L528
 7676 0088 E8000000 		call	__stack_chk_fail@PLT
 7676      00
 7677              	.L528:
 7678 008d C9       		leave
 7679              	.LCFI125:
 7680              		.cfi_def_cfa 7, 8
 7681 008e C3       		ret
 7682              		.cfi_endproc
 7683              	.LFE56:
 7685              		.section	.text.mbedtls_x509_crt_verify_restartable,"ax",@progbits
 7686              		.globl	mbedtls_x509_crt_verify_restartable
GAS LISTING /tmp/ccnlqVtp.s 			page 209


 7688              	mbedtls_x509_crt_verify_restartable:
 7689              	.LFB57:
2523:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2524:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
2525:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Verify the certificate validity, with profile, restartable version
2526:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *
2527:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * This function:
2528:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - checks the requested CN (if any)
2529:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - checks the type and size of the EE cert's key,
2530:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *    as that isn't done as part of chain building/verification currently
2531:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - builds and verifies the chain
2532:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  *  - then calls the callback and merges the flags
2533:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
2534:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** int mbedtls_x509_crt_verify_restartable( mbedtls_x509_crt *crt,
2535:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                      mbedtls_x509_crt *trust_ca,
2536:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                      mbedtls_x509_crl *ca_crl,
2537:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                      const mbedtls_x509_crt_profile *profile,
2538:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                      const char *cn, uint32_t *flags,
2539:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                      int (*f_vrfy)(void *, mbedtls_x509_crt *, int, uint32_t *),
2540:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                      void *p_vrfy,
2541:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                      mbedtls_x509_crt_restart_ctx *rs_ctx )
2542:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 7690              		.loc 2 2542 1
 7691              		.cfi_startproc
 7692 0000 F30F1EFA 		endbr64
 7693 0004 55       		pushq	%rbp
 7694              	.LCFI126:
 7695              		.cfi_def_cfa_offset 16
 7696              		.cfi_offset 6, -16
 7697 0005 4889E5   		movq	%rsp, %rbp
 7698              	.LCFI127:
 7699              		.cfi_def_cfa_register 6
 7700 0008 4881EC10 		subq	$272, %rsp
 7700      010000
 7701 000f 4889BD38 		movq	%rdi, -200(%rbp)
 7701      FFFFFF
 7702 0016 4889B530 		movq	%rsi, -208(%rbp)
 7702      FFFFFF
 7703 001d 48899528 		movq	%rdx, -216(%rbp)
 7703      FFFFFF
 7704 0024 48898D20 		movq	%rcx, -224(%rbp)
 7704      FFFFFF
 7705 002b 4C898518 		movq	%r8, -232(%rbp)
 7705      FFFFFF
 7706 0032 4C898D10 		movq	%r9, -240(%rbp)
 7706      FFFFFF
 7707 0039 488B4510 		movq	16(%rbp), %rax
 7708 003d 48898508 		movq	%rax, -248(%rbp)
 7708      FFFFFF
 7709 0044 488B4518 		movq	24(%rbp), %rax
 7710 0048 48898500 		movq	%rax, -256(%rbp)
 7710      FFFFFF
 7711 004f 488B4520 		movq	32(%rbp), %rax
 7712 0053 488985F8 		movq	%rax, -264(%rbp)
 7712      FEFFFF
 7713              		.loc 2 2542 1
 7714 005a 64488B04 		movq	%fs:40, %rax
GAS LISTING /tmp/ccnlqVtp.s 			page 210


 7714      25280000 
 7714      00
 7715 0063 488945F8 		movq	%rax, -8(%rbp)
 7716 0067 31C0     		xorl	%eax, %eax
2543:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     int ret;
2544:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_pk_type_t pk_type;
2545:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_x509_crt_verify_chain ver_chain;
2546:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     uint32_t ee_flags;
2547:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2548:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     *flags = 0;
 7717              		.loc 2 2548 12
 7718 0069 488B8510 		movq	-240(%rbp), %rax
 7718      FFFFFF
 7719 0070 C7000000 		movl	$0, (%rax)
 7719      0000
2549:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     ee_flags = 0;
 7720              		.loc 2 2549 14
 7721 0076 C78544FF 		movl	$0, -188(%rbp)
 7721      FFFF0000 
 7721      0000
2550:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     x509_crt_verify_chain_reset( &ver_chain );
 7722              		.loc 2 2550 5
 7723 0080 488D8550 		leaq	-176(%rbp), %rax
 7723      FFFFFF
 7724 0087 4889C7   		movq	%rax, %rdi
 7725 008a E8000000 		call	x509_crt_verify_chain_reset
 7725      00
2551:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2552:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( profile == NULL )
 7726              		.loc 2 2552 7
 7727 008f 4883BD20 		cmpq	$0, -224(%rbp)
 7727      FFFFFF00 
 7728 0097 750F     		jne	.L530
2553:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
2554:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ret = MBEDTLS_ERR_X509_BAD_INPUT_DATA;
 7729              		.loc 2 2554 13
 7730 0099 C78548FF 		movl	$-10240, -184(%rbp)
 7730      FFFF00D8 
 7730      FFFF
2555:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         goto exit;
 7731              		.loc 2 2555 9
 7732 00a3 E92C0100 		jmp	.L531
 7732      00
 7733              	.L530:
2556:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
2557:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2558:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* check name if requested */
2559:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( cn != NULL )
 7734              		.loc 2 2559 7
 7735 00a8 4883BD18 		cmpq	$0, -232(%rbp)
 7735      FFFFFF00 
 7736 00b0 7420     		je	.L532
2560:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         x509_crt_verify_name( crt, cn, &ee_flags );
 7737              		.loc 2 2560 9
 7738 00b2 488D9544 		leaq	-188(%rbp), %rdx
 7738      FFFFFF
 7739 00b9 488B8D18 		movq	-232(%rbp), %rcx
GAS LISTING /tmp/ccnlqVtp.s 			page 211


 7739      FFFFFF
 7740 00c0 488B8538 		movq	-200(%rbp), %rax
 7740      FFFFFF
 7741 00c7 4889CE   		movq	%rcx, %rsi
 7742 00ca 4889C7   		movq	%rax, %rdi
 7743 00cd E8000000 		call	x509_crt_verify_name
 7743      00
 7744              	.L532:
2561:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2562:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Check the type and size of the key */
2563:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     pk_type = mbedtls_pk_get_type( &crt->pk );
 7745              		.loc 2 2563 36
 7746 00d2 488B8538 		movq	-200(%rbp), %rax
 7746      FFFFFF
 7747 00d9 48054801 		addq	$328, %rax
 7747      0000
 7748              		.loc 2 2563 15
 7749 00df 4889C7   		movq	%rax, %rdi
 7750 00e2 E8000000 		call	mbedtls_pk_get_type@PLT
 7750      00
 7751 00e7 89854CFF 		movl	%eax, -180(%rbp)
 7751      FFFF
2564:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2565:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( x509_profile_check_pk_alg( profile, pk_type ) != 0 )
 7752              		.loc 2 2565 9
 7753 00ed 8B954CFF 		movl	-180(%rbp), %edx
 7753      FFFF
 7754 00f3 488B8520 		movq	-224(%rbp), %rax
 7754      FFFFFF
 7755 00fa 89D6     		movl	%edx, %esi
 7756 00fc 4889C7   		movq	%rax, %rdi
 7757 00ff E8000000 		call	x509_profile_check_pk_alg
 7757      00
 7758              		.loc 2 2565 7
 7759 0104 85C0     		testl	%eax, %eax
 7760 0106 740F     		je	.L533
2566:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ee_flags |= MBEDTLS_X509_BADCERT_BAD_PK;
 7761              		.loc 2 2566 18
 7762 0108 8B8544FF 		movl	-188(%rbp), %eax
 7762      FFFF
 7763 010e 80CC80   		orb	$-128, %ah
 7764 0111 898544FF 		movl	%eax, -188(%rbp)
 7764      FFFF
 7765              	.L533:
2567:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2568:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( x509_profile_check_key( profile, &crt->pk ) != 0 )
 7766              		.loc 2 2568 42
 7767 0117 488B8538 		movq	-200(%rbp), %rax
 7767      FFFFFF
 7768 011e 488D9048 		leaq	328(%rax), %rdx
 7768      010000
 7769              		.loc 2 2568 9
 7770 0125 488B8520 		movq	-224(%rbp), %rax
 7770      FFFFFF
 7771 012c 4889D6   		movq	%rdx, %rsi
 7772 012f 4889C7   		movq	%rax, %rdi
 7773 0132 E8000000 		call	x509_profile_check_key
GAS LISTING /tmp/ccnlqVtp.s 			page 212


 7773      00
 7774              		.loc 2 2568 7
 7775 0137 85C0     		testl	%eax, %eax
 7776 0139 7411     		je	.L534
2569:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ee_flags |= MBEDTLS_X509_BADCERT_BAD_KEY;
 7777              		.loc 2 2569 18
 7778 013b 8B8544FF 		movl	-188(%rbp), %eax
 7778      FFFF
 7779 0141 0D000001 		orl	$65536, %eax
 7779      00
 7780 0146 898544FF 		movl	%eax, -188(%rbp)
 7780      FFFF
 7781              	.L534:
2570:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2571:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Check the chain */
2572:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     ret = x509_crt_verify_chain( crt, trust_ca, ca_crl, profile,
 7782              		.loc 2 2572 11
 7783 014c 4C8B85F8 		movq	-264(%rbp), %r8
 7783      FEFFFF
 7784 0153 488DBD50 		leaq	-176(%rbp), %rdi
 7784      FFFFFF
 7785 015a 488B8D20 		movq	-224(%rbp), %rcx
 7785      FFFFFF
 7786 0161 488B9528 		movq	-216(%rbp), %rdx
 7786      FFFFFF
 7787 0168 488BB530 		movq	-208(%rbp), %rsi
 7787      FFFFFF
 7788 016f 488B8538 		movq	-200(%rbp), %rax
 7788      FFFFFF
 7789 0176 4D89C1   		movq	%r8, %r9
 7790 0179 4989F8   		movq	%rdi, %r8
 7791 017c 4889C7   		movq	%rax, %rdi
 7792 017f E8000000 		call	x509_crt_verify_chain
 7792      00
 7793 0184 898548FF 		movl	%eax, -184(%rbp)
 7793      FFFF
2573:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                  &ver_chain, rs_ctx );
2574:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2575:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ret != 0 )
 7794              		.loc 2 2575 7
 7795 018a 83BD48FF 		cmpl	$0, -184(%rbp)
 7795      FFFF00
 7796 0191 7540     		jne	.L542
2576:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         goto exit;
2577:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2578:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Merge end-entity flags */
2579:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     ver_chain.items[0].flags |= ee_flags;
 7797              		.loc 2 2579 30
 7798 0193 8B9558FF 		movl	-168(%rbp), %edx
 7798      FFFF
 7799 0199 8B8544FF 		movl	-188(%rbp), %eax
 7799      FFFF
 7800 019f 09D0     		orl	%edx, %eax
 7801 01a1 898558FF 		movl	%eax, -168(%rbp)
 7801      FFFF
2580:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2581:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* Build final flags, calling callback on the way if any */
GAS LISTING /tmp/ccnlqVtp.s 			page 213


2582:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     ret = x509_crt_merge_flags_with_cb( flags, &ver_chain, f_vrfy, p_vrfy );
 7802              		.loc 2 2582 11
 7803 01a7 488B8D00 		movq	-256(%rbp), %rcx
 7803      FFFFFF
 7804 01ae 488B9508 		movq	-248(%rbp), %rdx
 7804      FFFFFF
 7805 01b5 488DB550 		leaq	-176(%rbp), %rsi
 7805      FFFFFF
 7806 01bc 488B8510 		movq	-240(%rbp), %rax
 7806      FFFFFF
 7807 01c3 4889C7   		movq	%rax, %rdi
 7808 01c6 E8000000 		call	x509_crt_merge_flags_with_cb
 7808      00
 7809 01cb 898548FF 		movl	%eax, -184(%rbp)
 7809      FFFF
 7810 01d1 EB01     		jmp	.L531
 7811              	.L542:
2576:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         goto exit;
 7812              		.loc 2 2576 9
 7813 01d3 90       		nop
 7814              	.L531:
2583:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2584:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** exit:
2585:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_ECDSA_C) && defined(MBEDTLS_ECP_RESTARTABLE)
2586:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( rs_ctx != NULL && ret != MBEDTLS_ERR_ECP_IN_PROGRESS )
2587:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_x509_crt_restart_free( rs_ctx );
2588:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
2589:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2590:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     /* prevent misuse of the vrfy callback - VERIFY_FAILED would be ignored by
2591:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      * the SSL module for authmode optional, but non-zero return from the
2592:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****      * callback means a fatal error so it shouldn't be ignored */
2593:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ret == MBEDTLS_ERR_X509_CERT_VERIFY_FAILED )
 7815              		.loc 2 2593 7
 7816 01d4 81BD48FF 		cmpl	$-9984, -184(%rbp)
 7816      FFFF00D9 
 7816      FFFF
 7817 01de 750A     		jne	.L536
2594:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         ret = MBEDTLS_ERR_X509_FATAL_ERROR;
 7818              		.loc 2 2594 13
 7819 01e0 C78548FF 		movl	$-12288, -184(%rbp)
 7819      FFFF00D0 
 7819      FFFF
 7820              	.L536:
2595:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2596:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( ret != 0 )
 7821              		.loc 2 2596 7
 7822 01ea 83BD48FF 		cmpl	$0, -184(%rbp)
 7822      FFFF00
 7823 01f1 7415     		je	.L537
2597:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
2598:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         *flags = (uint32_t) -1;
 7824              		.loc 2 2598 16
 7825 01f3 488B8510 		movq	-240(%rbp), %rax
 7825      FFFFFF
 7826 01fa C700FFFF 		movl	$-1, (%rax)
 7826      FFFF
2599:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( ret );
GAS LISTING /tmp/ccnlqVtp.s 			page 214


 7827              		.loc 2 2599 15
 7828 0200 8B8548FF 		movl	-184(%rbp), %eax
 7828      FFFF
 7829 0206 EB19     		jmp	.L540
 7830              	.L537:
2600:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
2601:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2602:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( *flags != 0 )
 7831              		.loc 2 2602 9
 7832 0208 488B8510 		movq	-240(%rbp), %rax
 7832      FFFFFF
 7833 020f 8B00     		movl	(%rax), %eax
 7834              		.loc 2 2602 7
 7835 0211 85C0     		testl	%eax, %eax
 7836 0213 7407     		je	.L539
2603:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return( MBEDTLS_ERR_X509_CERT_VERIFY_FAILED );
 7837              		.loc 2 2603 15
 7838 0215 B800D9FF 		movl	$-9984, %eax
 7838      FF
 7839 021a EB05     		jmp	.L540
 7840              	.L539:
2604:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2605:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     return( 0 );
 7841              		.loc 2 2605 11
 7842 021c B8000000 		movl	$0, %eax
 7842      00
 7843              	.L540:
2606:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 7844              		.loc 2 2606 1 discriminator 1
 7845 0221 488B4DF8 		movq	-8(%rbp), %rcx
 7846 0225 6448330C 		xorq	%fs:40, %rcx
 7846      25280000 
 7846      00
 7847 022e 7405     		je	.L541
 7848              		.loc 2 2606 1 is_stmt 0
 7849 0230 E8000000 		call	__stack_chk_fail@PLT
 7849      00
 7850              	.L541:
 7851 0235 C9       		leave
 7852              	.LCFI128:
 7853              		.cfi_def_cfa 7, 8
 7854 0236 C3       		ret
 7855              		.cfi_endproc
 7856              	.LFE57:
 7858              		.section	.text.mbedtls_x509_crt_init,"ax",@progbits
 7859              		.globl	mbedtls_x509_crt_init
 7861              	mbedtls_x509_crt_init:
 7862              	.LFB58:
2607:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2608:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
2609:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Initialize a certificate chain
2610:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
2611:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** void mbedtls_x509_crt_init( mbedtls_x509_crt *crt )
2612:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 7863              		.loc 2 2612 1 is_stmt 1
 7864              		.cfi_startproc
 7865 0000 F30F1EFA 		endbr64
GAS LISTING /tmp/ccnlqVtp.s 			page 215


 7866 0004 55       		pushq	%rbp
 7867              	.LCFI129:
 7868              		.cfi_def_cfa_offset 16
 7869              		.cfi_offset 6, -16
 7870 0005 4889E5   		movq	%rsp, %rbp
 7871              	.LCFI130:
 7872              		.cfi_def_cfa_register 6
 7873 0008 4883EC20 		subq	$32, %rsp
 7874 000c 48897DE8 		movq	%rdi, -24(%rbp)
 7875              		.loc 2 2612 1
 7876 0010 64488B04 		movq	%fs:40, %rax
 7876      25280000 
 7876      00
 7877 0019 488945F8 		movq	%rax, -8(%rbp)
 7878 001d 31C0     		xorl	%eax, %eax
2613:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     memset( crt, 0, sizeof(mbedtls_x509_crt) );
 7879              		.loc 2 2613 5
 7880 001f 488B45E8 		movq	-24(%rbp), %rax
 7881 0023 BA280200 		movl	$552, %edx
 7881      00
 7882 0028 BE000000 		movl	$0, %esi
 7882      00
 7883 002d 4889C7   		movq	%rax, %rdi
 7884 0030 E8000000 		call	memset@PLT
 7884      00
2614:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 7885              		.loc 2 2614 1
 7886 0035 90       		nop
 7887 0036 488B45F8 		movq	-8(%rbp), %rax
 7888 003a 64483304 		xorq	%fs:40, %rax
 7888      25280000 
 7888      00
 7889 0043 7405     		je	.L544
 7890 0045 E8000000 		call	__stack_chk_fail@PLT
 7890      00
 7891              	.L544:
 7892 004a C9       		leave
 7893              	.LCFI131:
 7894              		.cfi_def_cfa 7, 8
 7895 004b C3       		ret
 7896              		.cfi_endproc
 7897              	.LFE58:
 7899              		.section	.text.mbedtls_x509_crt_free,"ax",@progbits
 7900              		.globl	mbedtls_x509_crt_free
 7902              	mbedtls_x509_crt_free:
 7903              	.LFB59:
2615:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2616:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** /*
2617:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  * Unallocate all certificate data
2618:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****  */
2619:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** void mbedtls_x509_crt_free( mbedtls_x509_crt *crt )
2620:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** {
 7904              		.loc 2 2620 1
 7905              		.cfi_startproc
 7906 0000 F30F1EFA 		endbr64
 7907 0004 55       		pushq	%rbp
 7908              	.LCFI132:
GAS LISTING /tmp/ccnlqVtp.s 			page 216


 7909              		.cfi_def_cfa_offset 16
 7910              		.cfi_offset 6, -16
 7911 0005 4889E5   		movq	%rsp, %rbp
 7912              	.LCFI133:
 7913              		.cfi_def_cfa_register 6
 7914 0008 4883EC50 		subq	$80, %rsp
 7915 000c 48897DB8 		movq	%rdi, -72(%rbp)
 7916              		.loc 2 2620 1
 7917 0010 64488B04 		movq	%fs:40, %rax
 7917      25280000 
 7917      00
 7918 0019 488945F8 		movq	%rax, -8(%rbp)
 7919 001d 31C0     		xorl	%eax, %eax
2621:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_x509_crt *cert_cur = crt;
 7920              		.loc 2 2621 23
 7921 001f 488B45B8 		movq	-72(%rbp), %rax
 7922 0023 488945C8 		movq	%rax, -56(%rbp)
2622:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_x509_crt *cert_prv;
2623:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_x509_name *name_cur;
2624:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_x509_name *name_prv;
2625:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_x509_sequence *seq_cur;
2626:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     mbedtls_x509_sequence *seq_prv;
2627:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2628:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     if( crt == NULL )
 7923              		.loc 2 2628 7
 7924 0027 48837DB8 		cmpq	$0, -72(%rbp)
 7924      00
 7925 002c 0F84EA01 		je	.L560
 7925      0000
 7926              	.L546:
2629:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         return;
2630:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2631:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     do
2632:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
2633:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_pk_free( &cert_cur->pk );
 7927              		.loc 2 2633 9
 7928 0032 488B45C8 		movq	-56(%rbp), %rax
 7929 0036 48054801 		addq	$328, %rax
 7929      0000
 7930 003c 4889C7   		movq	%rax, %rdi
 7931 003f E8000000 		call	mbedtls_pk_free@PLT
 7931      00
2634:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2635:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #if defined(MBEDTLS_X509_RSASSA_PSS_SUPPORT)
2636:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_free( cert_cur->sig_opts );
 7932              		.loc 2 2636 9
 7933 0044 488B45C8 		movq	-56(%rbp), %rax
 7934 0048 488B8018 		movq	536(%rax), %rax
 7934      020000
 7935 004f 4889C7   		movq	%rax, %rdi
 7936 0052 E8000000 		call	mbedtls_free@PLT
 7936      00
2637:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** #endif
2638:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2639:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         name_cur = cert_cur->issuer.next;
 7937              		.loc 2 2639 18
 7938 0057 488B45C8 		movq	-56(%rbp), %rax
GAS LISTING /tmp/ccnlqVtp.s 			page 217


 7939 005b 488B80C8 		movq	200(%rax), %rax
 7939      000000
 7940 0062 488945D0 		movq	%rax, -48(%rbp)
2640:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         while( name_cur != NULL )
 7941              		.loc 2 2640 14
 7942 0066 EB31     		jmp	.L548
 7943              	.L549:
2641:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
2642:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             name_prv = name_cur;
 7944              		.loc 2 2642 22
 7945 0068 488B45D0 		movq	-48(%rbp), %rax
 7946 006c 488945F0 		movq	%rax, -16(%rbp)
2643:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             name_cur = name_cur->next;
 7947              		.loc 2 2643 22
 7948 0070 488B45D0 		movq	-48(%rbp), %rax
 7949 0074 488B4030 		movq	48(%rax), %rax
 7950 0078 488945D0 		movq	%rax, -48(%rbp)
2644:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             mbedtls_platform_zeroize( name_prv, sizeof( mbedtls_x509_name ) );
 7951              		.loc 2 2644 13
 7952 007c 488B45F0 		movq	-16(%rbp), %rax
 7953 0080 BE400000 		movl	$64, %esi
 7953      00
 7954 0085 4889C7   		movq	%rax, %rdi
 7955 0088 E8000000 		call	mbedtls_platform_zeroize@PLT
 7955      00
2645:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             mbedtls_free( name_prv );
 7956              		.loc 2 2645 13
 7957 008d 488B45F0 		movq	-16(%rbp), %rax
 7958 0091 4889C7   		movq	%rax, %rdi
 7959 0094 E8000000 		call	mbedtls_free@PLT
 7959      00
 7960              	.L548:
2640:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
 7961              		.loc 2 2640 14
 7962 0099 48837DD0 		cmpq	$0, -48(%rbp)
 7962      00
 7963 009e 75C8     		jne	.L549
2646:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
2647:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2648:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         name_cur = cert_cur->subject.next;
 7964              		.loc 2 2648 18
 7965 00a0 488B45C8 		movq	-56(%rbp), %rax
 7966 00a4 488B8008 		movq	264(%rax), %rax
 7966      010000
 7967 00ab 488945D0 		movq	%rax, -48(%rbp)
2649:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         while( name_cur != NULL )
 7968              		.loc 2 2649 14
 7969 00af EB31     		jmp	.L550
 7970              	.L551:
2650:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
2651:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             name_prv = name_cur;
 7971              		.loc 2 2651 22
 7972 00b1 488B45D0 		movq	-48(%rbp), %rax
 7973 00b5 488945F0 		movq	%rax, -16(%rbp)
2652:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             name_cur = name_cur->next;
 7974              		.loc 2 2652 22
 7975 00b9 488B45D0 		movq	-48(%rbp), %rax
GAS LISTING /tmp/ccnlqVtp.s 			page 218


 7976 00bd 488B4030 		movq	48(%rax), %rax
 7977 00c1 488945D0 		movq	%rax, -48(%rbp)
2653:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             mbedtls_platform_zeroize( name_prv, sizeof( mbedtls_x509_name ) );
 7978              		.loc 2 2653 13
 7979 00c5 488B45F0 		movq	-16(%rbp), %rax
 7980 00c9 BE400000 		movl	$64, %esi
 7980      00
 7981 00ce 4889C7   		movq	%rax, %rdi
 7982 00d1 E8000000 		call	mbedtls_platform_zeroize@PLT
 7982      00
2654:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             mbedtls_free( name_prv );
 7983              		.loc 2 2654 13
 7984 00d6 488B45F0 		movq	-16(%rbp), %rax
 7985 00da 4889C7   		movq	%rax, %rdi
 7986 00dd E8000000 		call	mbedtls_free@PLT
 7986      00
 7987              	.L550:
2649:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
 7988              		.loc 2 2649 14
 7989 00e2 48837DD0 		cmpq	$0, -48(%rbp)
 7989      00
 7990 00e7 75C8     		jne	.L551
2655:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
2656:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2657:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         seq_cur = cert_cur->ext_key_usage.next;
 7991              		.loc 2 2657 17
 7992 00e9 488B45C8 		movq	-56(%rbp), %rax
 7993 00ed 488B80E8 		movq	488(%rax), %rax
 7993      010000
 7994 00f4 488945D8 		movq	%rax, -40(%rbp)
2658:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         while( seq_cur != NULL )
 7995              		.loc 2 2658 14
 7996 00f8 EB31     		jmp	.L552
 7997              	.L553:
2659:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
2660:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             seq_prv = seq_cur;
 7998              		.loc 2 2660 21
 7999 00fa 488B45D8 		movq	-40(%rbp), %rax
 8000 00fe 488945E8 		movq	%rax, -24(%rbp)
2661:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             seq_cur = seq_cur->next;
 8001              		.loc 2 2661 21
 8002 0102 488B45D8 		movq	-40(%rbp), %rax
 8003 0106 488B4018 		movq	24(%rax), %rax
 8004 010a 488945D8 		movq	%rax, -40(%rbp)
2662:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             mbedtls_platform_zeroize( seq_prv,
 8005              		.loc 2 2662 13
 8006 010e 488B45E8 		movq	-24(%rbp), %rax
 8007 0112 BE200000 		movl	$32, %esi
 8007      00
 8008 0117 4889C7   		movq	%rax, %rdi
 8009 011a E8000000 		call	mbedtls_platform_zeroize@PLT
 8009      00
2663:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                       sizeof( mbedtls_x509_sequence ) );
2664:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             mbedtls_free( seq_prv );
 8010              		.loc 2 2664 13
 8011 011f 488B45E8 		movq	-24(%rbp), %rax
 8012 0123 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/ccnlqVtp.s 			page 219


 8013 0126 E8000000 		call	mbedtls_free@PLT
 8013      00
 8014              	.L552:
2658:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
 8015              		.loc 2 2658 14
 8016 012b 48837DD8 		cmpq	$0, -40(%rbp)
 8016      00
 8017 0130 75C8     		jne	.L553
2665:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
2666:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2667:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         seq_cur = cert_cur->subject_alt_names.next;
 8018              		.loc 2 2667 17
 8019 0132 488B45C8 		movq	-56(%rbp), %rax
 8020 0136 488B80B8 		movq	440(%rax), %rax
 8020      010000
 8021 013d 488945D8 		movq	%rax, -40(%rbp)
2668:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         while( seq_cur != NULL )
 8022              		.loc 2 2668 14
 8023 0141 EB31     		jmp	.L554
 8024              	.L555:
2669:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
2670:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             seq_prv = seq_cur;
 8025              		.loc 2 2670 21
 8026 0143 488B45D8 		movq	-40(%rbp), %rax
 8027 0147 488945E8 		movq	%rax, -24(%rbp)
2671:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             seq_cur = seq_cur->next;
 8028              		.loc 2 2671 21
 8029 014b 488B45D8 		movq	-40(%rbp), %rax
 8030 014f 488B4018 		movq	24(%rax), %rax
 8031 0153 488945D8 		movq	%rax, -40(%rbp)
2672:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             mbedtls_platform_zeroize( seq_prv,
 8032              		.loc 2 2672 13
 8033 0157 488B45E8 		movq	-24(%rbp), %rax
 8034 015b BE200000 		movl	$32, %esi
 8034      00
 8035 0160 4889C7   		movq	%rax, %rdi
 8036 0163 E8000000 		call	mbedtls_platform_zeroize@PLT
 8036      00
2673:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****                                       sizeof( mbedtls_x509_sequence ) );
2674:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             mbedtls_free( seq_prv );
 8037              		.loc 2 2674 13
 8038 0168 488B45E8 		movq	-24(%rbp), %rax
 8039 016c 4889C7   		movq	%rax, %rdi
 8040 016f E8000000 		call	mbedtls_free@PLT
 8040      00
 8041              	.L554:
2668:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
 8042              		.loc 2 2668 14
 8043 0174 48837DD8 		cmpq	$0, -40(%rbp)
 8043      00
 8044 0179 75C8     		jne	.L555
2675:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
2676:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2677:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( cert_cur->raw.p != NULL )
 8045              		.loc 2 2677 26
 8046 017b 488B45C8 		movq	-56(%rbp), %rax
 8047 017f 488B4010 		movq	16(%rax), %rax
GAS LISTING /tmp/ccnlqVtp.s 			page 220


 8048              		.loc 2 2677 11
 8049 0183 4885C0   		testq	%rax, %rax
 8050 0186 742B     		je	.L556
2678:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         {
2679:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             mbedtls_platform_zeroize( cert_cur->raw.p, cert_cur->raw.len );
 8051              		.loc 2 2679 13
 8052 0188 488B45C8 		movq	-56(%rbp), %rax
 8053 018c 488B5008 		movq	8(%rax), %rdx
 8054              		.loc 2 2679 52
 8055 0190 488B45C8 		movq	-56(%rbp), %rax
 8056 0194 488B4010 		movq	16(%rax), %rax
 8057              		.loc 2 2679 13
 8058 0198 4889D6   		movq	%rdx, %rsi
 8059 019b 4889C7   		movq	%rax, %rdi
 8060 019e E8000000 		call	mbedtls_platform_zeroize@PLT
 8060      00
2680:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             mbedtls_free( cert_cur->raw.p );
 8061              		.loc 2 2680 40
 8062 01a3 488B45C8 		movq	-56(%rbp), %rax
 8063 01a7 488B4010 		movq	16(%rax), %rax
 8064              		.loc 2 2680 13
 8065 01ab 4889C7   		movq	%rax, %rdi
 8066 01ae E8000000 		call	mbedtls_free@PLT
 8066      00
 8067              	.L556:
2681:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         }
2682:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2683:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         cert_cur = cert_cur->next;
 8068              		.loc 2 2683 18
 8069 01b3 488B45C8 		movq	-56(%rbp), %rax
 8070 01b7 488B8020 		movq	544(%rax), %rax
 8070      020000
 8071 01be 488945C8 		movq	%rax, -56(%rbp)
2684:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
2685:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     while( cert_cur != NULL );
 8072              		.loc 2 2685 5
 8073 01c2 48837DC8 		cmpq	$0, -56(%rbp)
 8073      00
 8074 01c7 0F8565FE 		jne	.L546
 8074      FFFF
2686:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2687:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     cert_cur = crt;
 8075              		.loc 2 2687 14
 8076 01cd 488B45B8 		movq	-72(%rbp), %rax
 8077 01d1 488945C8 		movq	%rax, -56(%rbp)
 8078              	.L558:
2688:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     do
2689:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     {
2690:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         cert_prv = cert_cur;
 8079              		.loc 2 2690 18
 8080 01d5 488B45C8 		movq	-56(%rbp), %rax
 8081 01d9 488945E0 		movq	%rax, -32(%rbp)
2691:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         cert_cur = cert_cur->next;
 8082              		.loc 2 2691 18
 8083 01dd 488B45C8 		movq	-56(%rbp), %rax
 8084 01e1 488B8020 		movq	544(%rax), %rax
 8084      020000
GAS LISTING /tmp/ccnlqVtp.s 			page 221


 8085 01e8 488945C8 		movq	%rax, -56(%rbp)
2692:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
2693:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         mbedtls_platform_zeroize( cert_prv, sizeof( mbedtls_x509_crt ) );
 8086              		.loc 2 2693 9
 8087 01ec 488B45E0 		movq	-32(%rbp), %rax
 8088 01f0 BE280200 		movl	$552, %esi
 8088      00
 8089 01f5 4889C7   		movq	%rax, %rdi
 8090 01f8 E8000000 		call	mbedtls_platform_zeroize@PLT
 8090      00
2694:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****         if( cert_prv != crt )
 8091              		.loc 2 2694 11
 8092 01fd 488B45E0 		movq	-32(%rbp), %rax
 8093 0201 483B45B8 		cmpq	-72(%rbp), %rax
 8094 0205 740C     		je	.L557
2695:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****             mbedtls_free( cert_prv );
 8095              		.loc 2 2695 13
 8096 0207 488B45E0 		movq	-32(%rbp), %rax
 8097 020b 4889C7   		movq	%rax, %rdi
 8098 020e E8000000 		call	mbedtls_free@PLT
 8098      00
 8099              	.L557:
2696:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     }
2697:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c ****     while( cert_cur != NULL );
 8100              		.loc 2 2697 5
 8101 0213 48837DC8 		cmpq	$0, -56(%rbp)
 8101      00
 8102 0218 75BB     		jne	.L558
 8103 021a EB01     		jmp	.L545
 8104              	.L560:
2629:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** 
 8105              		.loc 2 2629 9
 8106 021c 90       		nop
 8107              	.L545:
2698:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/x509_crt.c **** }
 8108              		.loc 2 2698 1
 8109 021d 488B45F8 		movq	-8(%rbp), %rax
 8110 0221 64483304 		xorq	%fs:40, %rax
 8110      25280000 
 8110      00
 8111 022a 7405     		je	.L559
 8112 022c E8000000 		call	__stack_chk_fail@PLT
 8112      00
 8113              	.L559:
 8114 0231 C9       		leave
 8115              	.LCFI134:
 8116              		.cfi_def_cfa 7, 8
 8117 0232 C3       		ret
 8118              		.cfi_endproc
 8119              	.LFE59:
 8121              		.text
 8122              	.Letext0:
 8123              		.file 3 "/usr/lib/gcc/x86_64-linux-gnu/9/include/stddef.h"
 8124              		.file 4 "/usr/include/x86_64-linux-gnu/bits/types.h"
 8125              		.file 5 "/usr/include/x86_64-linux-gnu/bits/stdint-uintn.h"
 8126              		.file 6 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/bignum.
 8127              		.file 7 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/asn1.h"
GAS LISTING /tmp/ccnlqVtp.s 			page 222


 8128              		.file 8 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/md.h"
 8129              		.file 9 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ecp.h"
 8130              		.file 10 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/x509.h
 8131              		.file 11 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/x509_c
 8132              		.file 12 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/x509_c
 8133              		.file 13 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pem.h"
 8134              		.file 14 "/usr/include/x86_64-linux-gnu/bits/types/struct_FILE.h"
 8135              		.file 15 "/usr/include/x86_64-linux-gnu/bits/types/FILE.h"
 8136              		.file 16 "/usr/include/stdio.h"
 8137              		.file 17 "/usr/include/x86_64-linux-gnu/bits/sys_errlist.h"
 8138              		.file 18 "/usr/include/time.h"
 8139              		.file 19 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/platfo
 16076              		.section	.note.gnu.property,"a"
 16077              		.align 8
 16078 0000 04000000 		.long	 1f - 0f
 16079 0004 10000000 		.long	 4f - 1f
 16080 0008 05000000 		.long	 5
 16081              	0:
 16082 000c 474E5500 		.string	 "GNU"
 16083              	1:
 16084              		.align 8
 16085 0010 020000C0 		.long	 0xc0000002
 16086 0014 04000000 		.long	 3f - 2f
 16087              	2:
 16088 0018 03000000 		.long	 0x3
 16089              	3:
 16090 001c 00000000 		.align 8
 16091              	4:
GAS LISTING /tmp/ccnlqVtp.s 			page 223


DEFINED SYMBOLS
                            *ABS*:0000000000000000 x509_crt.c
     /tmp/ccnlqVtp.s:6      .text.mbedtls_pk_ec:0000000000000000 mbedtls_pk_ec
     /tmp/ccnlqVtp.s:48     .rodata.mbedtls_x509_crt_profile_default:0000000000000000 mbedtls_x509_crt_profile_default
     /tmp/ccnlqVtp.s:58     .rodata.mbedtls_x509_crt_profile_next:0000000000000000 mbedtls_x509_crt_profile_next
     /tmp/ccnlqVtp.s:68     .rodata.mbedtls_x509_crt_profile_suiteb:0000000000000000 mbedtls_x509_crt_profile_suiteb
     /tmp/ccnlqVtp.s:75     .text.x509_profile_check_md_alg:0000000000000000 x509_profile_check_md_alg
     /tmp/ccnlqVtp.s:139    .text.x509_profile_check_pk_alg:0000000000000000 x509_profile_check_pk_alg
     /tmp/ccnlqVtp.s:202    .text.x509_profile_check_key:0000000000000000 x509_profile_check_key
     /tmp/ccnlqVtp.s:322    .text.x509_memcasecmp:0000000000000000 x509_memcasecmp
     /tmp/ccnlqVtp.s:442    .text.x509_check_wildcard:0000000000000000 x509_check_wildcard
     /tmp/ccnlqVtp.s:585    .text.x509_string_cmp:0000000000000000 x509_string_cmp
     /tmp/ccnlqVtp.s:715    .text.x509_name_cmp:0000000000000000 x509_name_cmp
     /tmp/ccnlqVtp.s:850    .text.x509_crt_verify_chain_reset:0000000000000000 x509_crt_verify_chain_reset
     /tmp/ccnlqVtp.s:911    .text.x509_get_version:0000000000000000 x509_get_version
     /tmp/ccnlqVtp.s:1010   .text.x509_get_dates:0000000000000000 x509_get_dates
     /tmp/ccnlqVtp.s:1114   .text.x509_get_uid:0000000000000000 x509_get_uid
     /tmp/ccnlqVtp.s:1214   .text.x509_get_basic_constraints:0000000000000000 x509_get_basic_constraints
     /tmp/ccnlqVtp.s:1370   .text.x509_get_ns_cert_type:0000000000000000 x509_get_ns_cert_type
     /tmp/ccnlqVtp.s:1445   .text.x509_get_key_usage:0000000000000000 x509_get_key_usage
     /tmp/ccnlqVtp.s:1554   .text.x509_get_ext_key_usage:0000000000000000 x509_get_ext_key_usage
     /tmp/ccnlqVtp.s:1618   .text.x509_get_subject_alt_name:0000000000000000 x509_get_subject_alt_name
     /tmp/ccnlqVtp.s:1840   .text.x509_get_crt_ext:0000000000000000 x509_get_crt_ext
     /tmp/ccnlqVtp.s:2218   .text.x509_crt_parse_der_core:0000000000000000 x509_crt_parse_der_core
     /tmp/ccnlqVtp.s:7902   .text.mbedtls_x509_crt_free:0000000000000000 mbedtls_x509_crt_free
     /tmp/ccnlqVtp.s:2926   .text.mbedtls_x509_crt_parse_der:0000000000000000 mbedtls_x509_crt_parse_der
     /tmp/ccnlqVtp.s:7861   .text.mbedtls_x509_crt_init:0000000000000000 mbedtls_x509_crt_init
     /tmp/ccnlqVtp.s:3081   .text.mbedtls_x509_crt_parse:0000000000000000 mbedtls_x509_crt_parse
     /tmp/ccnlqVtp.s:3314   .text.x509_info_subject_alt_name:0000000000000000 x509_info_subject_alt_name
     /tmp/ccnlqVtp.s:3489   .text.x509_info_cert_type:0000000000000000 x509_info_cert_type
     /tmp/ccnlqVtp.s:3877   .text.x509_info_key_usage:0000000000000000 x509_info_key_usage
     /tmp/ccnlqVtp.s:4290   .text.x509_info_ext_key_usage:0000000000000000 x509_info_ext_key_usage
     /tmp/ccnlqVtp.s:4453   .text.mbedtls_x509_crt_info:0000000000000000 mbedtls_x509_crt_info
     /tmp/ccnlqVtp.s:5534   .data.rel.ro.local.x509_crt_verify_strings:0000000000000000 x509_crt_verify_strings
     /tmp/ccnlqVtp.s:5607   .text.mbedtls_x509_crt_verify_info:0000000000000000 mbedtls_x509_crt_verify_info
     /tmp/ccnlqVtp.s:5761   .text.mbedtls_x509_crt_check_key_usage:0000000000000000 mbedtls_x509_crt_check_key_usage
     /tmp/ccnlqVtp.s:5858   .text.mbedtls_x509_crt_check_extended_key_usage:0000000000000000 mbedtls_x509_crt_check_extended_key_usage
     /tmp/ccnlqVtp.s:5981   .text.mbedtls_x509_crt_is_revoked:0000000000000000 mbedtls_x509_crt_is_revoked
     /tmp/ccnlqVtp.s:6077   .text.x509_crt_verifycrl:0000000000000000 x509_crt_verifycrl
     /tmp/ccnlqVtp.s:6325   .text.x509_crt_check_signature:0000000000000000 x509_crt_check_signature
     /tmp/ccnlqVtp.s:6442   .text.x509_crt_check_parent:0000000000000000 x509_crt_check_parent
     /tmp/ccnlqVtp.s:6537   .text.x509_crt_find_parent_in:0000000000000000 x509_crt_find_parent_in
     /tmp/ccnlqVtp.s:6723   .text.x509_crt_find_parent:0000000000000000 x509_crt_find_parent
     /tmp/ccnlqVtp.s:6833   .text.x509_crt_check_ee_locally_trusted:0000000000000000 x509_crt_check_ee_locally_trusted
     /tmp/ccnlqVtp.s:6930   .text.x509_crt_verify_chain:0000000000000000 x509_crt_verify_chain
     /tmp/ccnlqVtp.s:7232   .text.x509_crt_check_cn:0000000000000000 x509_crt_check_cn
     /tmp/ccnlqVtp.s:7308   .text.x509_crt_verify_name:0000000000000000 x509_crt_verify_name
     /tmp/ccnlqVtp.s:7471   .text.x509_crt_merge_flags_with_cb:0000000000000000 x509_crt_merge_flags_with_cb
     /tmp/ccnlqVtp.s:7572   .text.mbedtls_x509_crt_verify:0000000000000000 mbedtls_x509_crt_verify
     /tmp/ccnlqVtp.s:7688   .text.mbedtls_x509_crt_verify_restartable:0000000000000000 mbedtls_x509_crt_verify_restartable
     /tmp/ccnlqVtp.s:7629   .text.mbedtls_x509_crt_verify_with_profile:0000000000000000 mbedtls_x509_crt_verify_with_profile

UNDEFINED SYMBOLS
_GLOBAL_OFFSET_TABLE_
__stack_chk_fail
mbedtls_pk_get_type
mbedtls_pk_get_bitlen
GAS LISTING /tmp/ccnlqVtp.s 			page 224


strlen
memcmp
mbedtls_asn1_get_tag
mbedtls_asn1_get_int
mbedtls_x509_get_time
mbedtls_asn1_get_bool
mbedtls_asn1_get_bitstring
mbedtls_asn1_get_sequence_of
mbedtls_asn1_get_len
mbedtls_calloc
mbedtls_x509_get_ext
mbedtls_oid_get_x509_ext_type
memset
memcpy
mbedtls_x509_get_serial
mbedtls_x509_get_alg
mbedtls_x509_get_sig_alg
mbedtls_x509_get_name
mbedtls_pk_parse_subpubkey
mbedtls_x509_get_sig
mbedtls_free
strstr
mbedtls_pem_init
mbedtls_pem_read_buffer
mbedtls_pem_free
mbedtls_snprintf
mbedtls_oid_get_extended_key_usage
mbedtls_x509_serial_gets
mbedtls_x509_dn_gets
mbedtls_x509_sig_alg_gets
mbedtls_pk_get_name
mbedtls_x509_key_size_helper
mbedtls_x509_time_is_past
mbedtls_md_info_from_type
mbedtls_md
mbedtls_md_get_size
mbedtls_pk_verify_ext
mbedtls_x509_time_is_future
mbedtls_pk_can_do
mbedtls_pk_free
mbedtls_platform_zeroize
