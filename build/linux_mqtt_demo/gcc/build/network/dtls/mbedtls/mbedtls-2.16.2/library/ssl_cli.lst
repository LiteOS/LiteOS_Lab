GAS LISTING /tmp/cc8psT5X.s 			page 1


   1              		.file	"ssl_cli.c"
   2              		.text
   3              	.Ltext0:
   4              		.section	.text.mbedtls_ssl_ciphersuite_cert_req_allowed,"ax",@progbits
   6              	mbedtls_ssl_ciphersuite_cert_req_allowed:
   7              	.LFB18:
   8              		.file 1 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphe
   1:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** /**
   2:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  * \file ssl_ciphersuites.h
   3:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  *
   4:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  * \brief SSL Ciphersuites for mbed TLS
   5:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  */
   6:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** /*
   7:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  *  Copyright (C) 2006-2015, ARM Limited, All Rights Reserved
   8:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  *  SPDX-License-Identifier: Apache-2.0
   9:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  *
  10:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  *  Licensed under the Apache License, Version 2.0 (the "License"); you may
  11:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  *  not use this file except in compliance with the License.
  12:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  *  You may obtain a copy of the License at
  13:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  *
  14:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  *  http://www.apache.org/licenses/LICENSE-2.0
  15:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  *
  16:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  *  Unless required by applicable law or agreed to in writing, software
  17:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  *  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  18:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  19:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  *  See the License for the specific language governing permissions and
  20:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  *  limitations under the License.
  21:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  *
  22:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  *  This file is part of mbed TLS (https://tls.mbed.org)
  23:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  */
  24:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #ifndef MBEDTLS_SSL_CIPHERSUITES_H
  25:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_SSL_CIPHERSUITES_H
  26:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
  27:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #if !defined(MBEDTLS_CONFIG_FILE)
  28:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #include "config.h"
  29:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #else
  30:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #include MBEDTLS_CONFIG_FILE
  31:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #endif
  32:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
  33:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #include "pk.h"
  34:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #include "cipher.h"
  35:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #include "md.h"
  36:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
  37:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #ifdef __cplusplus
  38:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** extern "C" {
  39:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #endif
  40:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
  41:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** /*
  42:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  * Supported ciphersuites (Official IANA names)
  43:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  */
  44:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_NULL_MD5                    0x01   /**< Weak! */
  45:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_NULL_SHA                    0x02   /**< Weak! */
  46:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
  47:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_RC4_128_MD5                 0x04
  48:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_RC4_128_SHA                 0x05
  49:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_DES_CBC_SHA                 0x09   /**< Weak! Not in TLS 1.2 */
  50:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
GAS LISTING /tmp/cc8psT5X.s 			page 2


  51:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_3DES_EDE_CBC_SHA            0x0A
  52:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
  53:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_RSA_WITH_DES_CBC_SHA             0x15   /**< Weak! Not in TLS 1.2 */
  54:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA        0x16
  55:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
  56:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_NULL_SHA                    0x2C   /**< Weak! */
  57:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_NULL_SHA                0x2D   /**< Weak! */
  58:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_PSK_WITH_NULL_SHA                0x2E   /**< Weak! */
  59:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_AES_128_CBC_SHA             0x2F
  60:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
  61:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_RSA_WITH_AES_128_CBC_SHA         0x33
  62:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_AES_256_CBC_SHA             0x35
  63:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_RSA_WITH_AES_256_CBC_SHA         0x39
  64:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
  65:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_NULL_SHA256                 0x3B   /**< Weak! */
  66:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_AES_128_CBC_SHA256          0x3C   /**< TLS 1.2 */
  67:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_AES_256_CBC_SHA256          0x3D   /**< TLS 1.2 */
  68:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
  69:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_CAMELLIA_128_CBC_SHA        0x41
  70:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA    0x45
  71:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
  72:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_RSA_WITH_AES_128_CBC_SHA256      0x67   /**< TLS 1.2 */
  73:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_RSA_WITH_AES_256_CBC_SHA256      0x6B   /**< TLS 1.2 */
  74:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
  75:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_CAMELLIA_256_CBC_SHA        0x84
  76:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA    0x88
  77:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
  78:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_RC4_128_SHA                 0x8A
  79:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_3DES_EDE_CBC_SHA            0x8B
  80:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_AES_128_CBC_SHA             0x8C
  81:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_AES_256_CBC_SHA             0x8D
  82:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
  83:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_RC4_128_SHA             0x8E
  84:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_3DES_EDE_CBC_SHA        0x8F
  85:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_AES_128_CBC_SHA         0x90
  86:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_AES_256_CBC_SHA         0x91
  87:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
  88:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_PSK_WITH_RC4_128_SHA             0x92
  89:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_PSK_WITH_3DES_EDE_CBC_SHA        0x93
  90:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_PSK_WITH_AES_128_CBC_SHA         0x94
  91:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_PSK_WITH_AES_256_CBC_SHA         0x95
  92:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
  93:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_AES_128_GCM_SHA256          0x9C   /**< TLS 1.2 */
  94:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_AES_256_GCM_SHA384          0x9D   /**< TLS 1.2 */
  95:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_RSA_WITH_AES_128_GCM_SHA256      0x9E   /**< TLS 1.2 */
  96:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_RSA_WITH_AES_256_GCM_SHA384      0x9F   /**< TLS 1.2 */
  97:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
  98:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_AES_128_GCM_SHA256          0xA8   /**< TLS 1.2 */
  99:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_AES_256_GCM_SHA384          0xA9   /**< TLS 1.2 */
 100:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_AES_128_GCM_SHA256      0xAA   /**< TLS 1.2 */
 101:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_AES_256_GCM_SHA384      0xAB   /**< TLS 1.2 */
 102:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_PSK_WITH_AES_128_GCM_SHA256      0xAC   /**< TLS 1.2 */
 103:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_PSK_WITH_AES_256_GCM_SHA384      0xAD   /**< TLS 1.2 */
 104:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 105:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_AES_128_CBC_SHA256          0xAE
 106:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_AES_256_CBC_SHA384          0xAF
 107:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_NULL_SHA256                 0xB0   /**< Weak! */
GAS LISTING /tmp/cc8psT5X.s 			page 3


 108:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_NULL_SHA384                 0xB1   /**< Weak! */
 109:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 110:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_AES_128_CBC_SHA256      0xB2
 111:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_AES_256_CBC_SHA384      0xB3
 112:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_NULL_SHA256             0xB4   /**< Weak! */
 113:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_NULL_SHA384             0xB5   /**< Weak! */
 114:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 115:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_PSK_WITH_AES_128_CBC_SHA256      0xB6
 116:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_PSK_WITH_AES_256_CBC_SHA384      0xB7
 117:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_PSK_WITH_NULL_SHA256             0xB8   /**< Weak! */
 118:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_PSK_WITH_NULL_SHA384             0xB9   /**< Weak! */
 119:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 120:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_CAMELLIA_128_CBC_SHA256     0xBA   /**< TLS 1.2 */
 121:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256 0xBE   /**< TLS 1.2 */
 122:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_CAMELLIA_256_CBC_SHA256     0xC0   /**< TLS 1.2 */
 124:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256 0xC4   /**< TLS 1.2 */
 125:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 126:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_ECDSA_WITH_NULL_SHA             0xC001 /**< Weak! */
 127:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_ECDSA_WITH_RC4_128_SHA          0xC002 /**< Not in SSL3! */
 128:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA     0xC003 /**< Not in SSL3! */
 129:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA      0xC004 /**< Not in SSL3! */
 130:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA      0xC005 /**< Not in SSL3! */
 131:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 132:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_ECDSA_WITH_NULL_SHA            0xC006 /**< Weak! */
 133:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_ECDSA_WITH_RC4_128_SHA         0xC007 /**< Not in SSL3! */
 134:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA    0xC008 /**< Not in SSL3! */
 135:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA     0xC009 /**< Not in SSL3! */
 136:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA     0xC00A /**< Not in SSL3! */
 137:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 138:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_RSA_WITH_NULL_SHA               0xC00B /**< Weak! */
 139:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_RSA_WITH_RC4_128_SHA            0xC00C /**< Not in SSL3! */
 140:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA       0xC00D /**< Not in SSL3! */
 141:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_RSA_WITH_AES_128_CBC_SHA        0xC00E /**< Not in SSL3! */
 142:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_RSA_WITH_AES_256_CBC_SHA        0xC00F /**< Not in SSL3! */
 143:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 144:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_RSA_WITH_NULL_SHA              0xC010 /**< Weak! */
 145:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_RSA_WITH_RC4_128_SHA           0xC011 /**< Not in SSL3! */
 146:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA      0xC012 /**< Not in SSL3! */
 147:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA       0xC013 /**< Not in SSL3! */
 148:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA       0xC014 /**< Not in SSL3! */
 149:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 150:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256  0xC023 /**< TLS 1.2 */
 151:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384  0xC024 /**< TLS 1.2 */
 152:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256   0xC025 /**< TLS 1.2 */
 153:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384   0xC026 /**< TLS 1.2 */
 154:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256    0xC027 /**< TLS 1.2 */
 155:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384    0xC028 /**< TLS 1.2 */
 156:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256     0xC029 /**< TLS 1.2 */
 157:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384     0xC02A /**< TLS 1.2 */
 158:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 159:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256  0xC02B /**< TLS 1.2 */
 160:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384  0xC02C /**< TLS 1.2 */
 161:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256   0xC02D /**< TLS 1.2 */
 162:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384   0xC02E /**< TLS 1.2 */
 163:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256    0xC02F /**< TLS 1.2 */
 164:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384    0xC030 /**< TLS 1.2 */
GAS LISTING /tmp/cc8psT5X.s 			page 4


 165:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256     0xC031 /**< TLS 1.2 */
 166:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384     0xC032 /**< TLS 1.2 */
 167:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 168:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_PSK_WITH_RC4_128_SHA           0xC033 /**< Not in SSL3! */
 169:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_PSK_WITH_3DES_EDE_CBC_SHA      0xC034 /**< Not in SSL3! */
 170:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA       0xC035 /**< Not in SSL3! */
 171:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA       0xC036 /**< Not in SSL3! */
 172:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA256    0xC037 /**< Not in SSL3! */
 173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA384    0xC038 /**< Not in SSL3! */
 174:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_PSK_WITH_NULL_SHA              0xC039 /**< Weak! No SSL3! */
 175:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_PSK_WITH_NULL_SHA256           0xC03A /**< Weak! No SSL3! */
 176:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_PSK_WITH_NULL_SHA384           0xC03B /**< Weak! No SSL3! */
 177:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 178:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_ARIA_128_CBC_SHA256         0xC03C /**< TLS 1.2 */
 179:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_ARIA_256_CBC_SHA384         0xC03D /**< TLS 1.2 */
 180:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_RSA_WITH_ARIA_128_CBC_SHA256     0xC044 /**< TLS 1.2 */
 181:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_RSA_WITH_ARIA_256_CBC_SHA384     0xC045 /**< TLS 1.2 */
 182:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_ECDSA_WITH_ARIA_128_CBC_SHA256 0xC048 /**< TLS 1.2 */
 183:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_ECDSA_WITH_ARIA_256_CBC_SHA384 0xC049 /**< TLS 1.2 */
 184:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_ECDSA_WITH_ARIA_128_CBC_SHA256  0xC04A /**< TLS 1.2 */
 185:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_ECDSA_WITH_ARIA_256_CBC_SHA384  0xC04B /**< TLS 1.2 */
 186:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_RSA_WITH_ARIA_128_CBC_SHA256   0xC04C /**< TLS 1.2 */
 187:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_RSA_WITH_ARIA_256_CBC_SHA384   0xC04D /**< TLS 1.2 */
 188:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_RSA_WITH_ARIA_128_CBC_SHA256    0xC04E /**< TLS 1.2 */
 189:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_RSA_WITH_ARIA_256_CBC_SHA384    0xC04F /**< TLS 1.2 */
 190:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_ARIA_128_GCM_SHA256         0xC050 /**< TLS 1.2 */
 191:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_ARIA_256_GCM_SHA384         0xC051 /**< TLS 1.2 */
 192:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_RSA_WITH_ARIA_128_GCM_SHA256     0xC052 /**< TLS 1.2 */
 193:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_RSA_WITH_ARIA_256_GCM_SHA384     0xC053 /**< TLS 1.2 */
 194:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_ECDSA_WITH_ARIA_128_GCM_SHA256 0xC05C /**< TLS 1.2 */
 195:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_ECDSA_WITH_ARIA_256_GCM_SHA384 0xC05D /**< TLS 1.2 */
 196:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_ECDSA_WITH_ARIA_128_GCM_SHA256  0xC05E /**< TLS 1.2 */
 197:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_ECDSA_WITH_ARIA_256_GCM_SHA384  0xC05F /**< TLS 1.2 */
 198:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_RSA_WITH_ARIA_128_GCM_SHA256   0xC060 /**< TLS 1.2 */
 199:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_RSA_WITH_ARIA_256_GCM_SHA384   0xC061 /**< TLS 1.2 */
 200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_RSA_WITH_ARIA_128_GCM_SHA256    0xC062 /**< TLS 1.2 */
 201:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_RSA_WITH_ARIA_256_GCM_SHA384    0xC063 /**< TLS 1.2 */
 202:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_ARIA_128_CBC_SHA256         0xC064 /**< TLS 1.2 */
 203:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_ARIA_256_CBC_SHA384         0xC065 /**< TLS 1.2 */
 204:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_ARIA_128_CBC_SHA256     0xC066 /**< TLS 1.2 */
 205:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_ARIA_256_CBC_SHA384     0xC067 /**< TLS 1.2 */
 206:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_PSK_WITH_ARIA_128_CBC_SHA256     0xC068 /**< TLS 1.2 */
 207:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_PSK_WITH_ARIA_256_CBC_SHA384     0xC069 /**< TLS 1.2 */
 208:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_ARIA_128_GCM_SHA256         0xC06A /**< TLS 1.2 */
 209:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_ARIA_256_GCM_SHA384         0xC06B /**< TLS 1.2 */
 210:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_ARIA_128_GCM_SHA256     0xC06C /**< TLS 1.2 */
 211:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_ARIA_256_GCM_SHA384     0xC06D /**< TLS 1.2 */
 212:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_PSK_WITH_ARIA_128_GCM_SHA256     0xC06E /**< TLS 1.2 */
 213:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_PSK_WITH_ARIA_256_GCM_SHA384     0xC06F /**< TLS 1.2 */
 214:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_PSK_WITH_ARIA_128_CBC_SHA256   0xC070 /**< TLS 1.2 */
 215:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_PSK_WITH_ARIA_256_CBC_SHA384   0xC071 /**< TLS 1.2 */
 216:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 217:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256 0xC072 /**< Not in SSL3! */
 218:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384 0xC073 /**< Not in SSL3! */
 219:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_ECDSA_WITH_CAMELLIA_128_CBC_SHA256  0xC074 /**< Not in SSL3! */
 220:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_ECDSA_WITH_CAMELLIA_256_CBC_SHA384  0xC075 /**< Not in SSL3! */
 221:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256   0xC076 /**< Not in SSL3! */
GAS LISTING /tmp/cc8psT5X.s 			page 5


 222:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384   0xC077 /**< Not in SSL3! */
 223:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_RSA_WITH_CAMELLIA_128_CBC_SHA256    0xC078 /**< Not in SSL3! */
 224:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_RSA_WITH_CAMELLIA_256_CBC_SHA384    0xC079 /**< Not in SSL3! */
 225:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 226:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_CAMELLIA_128_GCM_SHA256         0xC07A /**< TLS 1.2 */
 227:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_CAMELLIA_256_GCM_SHA384         0xC07B /**< TLS 1.2 */
 228:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_RSA_WITH_CAMELLIA_128_GCM_SHA256     0xC07C /**< TLS 1.2 */
 229:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_RSA_WITH_CAMELLIA_256_GCM_SHA384     0xC07D /**< TLS 1.2 */
 230:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_GCM_SHA256 0xC086 /**< TLS 1.2 */
 231:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_GCM_SHA384 0xC087 /**< TLS 1.2 */
 232:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_ECDSA_WITH_CAMELLIA_128_GCM_SHA256  0xC088 /**< TLS 1.2 */
 233:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_ECDSA_WITH_CAMELLIA_256_GCM_SHA384  0xC089 /**< TLS 1.2 */
 234:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_RSA_WITH_CAMELLIA_128_GCM_SHA256   0xC08A /**< TLS 1.2 */
 235:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_RSA_WITH_CAMELLIA_256_GCM_SHA384   0xC08B /**< TLS 1.2 */
 236:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_RSA_WITH_CAMELLIA_128_GCM_SHA256    0xC08C /**< TLS 1.2 */
 237:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDH_RSA_WITH_CAMELLIA_256_GCM_SHA384    0xC08D /**< TLS 1.2 */
 238:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 239:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_CAMELLIA_128_GCM_SHA256       0xC08E /**< TLS 1.2 */
 240:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_CAMELLIA_256_GCM_SHA384       0xC08F /**< TLS 1.2 */
 241:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_CAMELLIA_128_GCM_SHA256   0xC090 /**< TLS 1.2 */
 242:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_CAMELLIA_256_GCM_SHA384   0xC091 /**< TLS 1.2 */
 243:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_PSK_WITH_CAMELLIA_128_GCM_SHA256   0xC092 /**< TLS 1.2 */
 244:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_PSK_WITH_CAMELLIA_256_GCM_SHA384   0xC093 /**< TLS 1.2 */
 245:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 246:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_CAMELLIA_128_CBC_SHA256       0xC094
 247:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_CAMELLIA_256_CBC_SHA384       0xC095
 248:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_CAMELLIA_128_CBC_SHA256   0xC096
 249:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_CAMELLIA_256_CBC_SHA384   0xC097
 250:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_PSK_WITH_CAMELLIA_128_CBC_SHA256   0xC098
 251:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_PSK_WITH_CAMELLIA_256_CBC_SHA384   0xC099
 252:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_PSK_WITH_CAMELLIA_128_CBC_SHA256 0xC09A /**< Not in SSL3! */
 253:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_PSK_WITH_CAMELLIA_256_CBC_SHA384 0xC09B /**< Not in SSL3! */
 254:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 255:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_AES_128_CCM                0xC09C  /**< TLS 1.2 */
 256:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_AES_256_CCM                0xC09D  /**< TLS 1.2 */
 257:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_RSA_WITH_AES_128_CCM            0xC09E  /**< TLS 1.2 */
 258:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_RSA_WITH_AES_256_CCM            0xC09F  /**< TLS 1.2 */
 259:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_AES_128_CCM_8              0xC0A0  /**< TLS 1.2 */
 260:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_WITH_AES_256_CCM_8              0xC0A1  /**< TLS 1.2 */
 261:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_RSA_WITH_AES_128_CCM_8          0xC0A2  /**< TLS 1.2 */
 262:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_RSA_WITH_AES_256_CCM_8          0xC0A3  /**< TLS 1.2 */
 263:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_AES_128_CCM                0xC0A4  /**< TLS 1.2 */
 264:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_AES_256_CCM                0xC0A5  /**< TLS 1.2 */
 265:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_AES_128_CCM            0xC0A6  /**< TLS 1.2 */
 266:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_AES_256_CCM            0xC0A7  /**< TLS 1.2 */
 267:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_AES_128_CCM_8              0xC0A8  /**< TLS 1.2 */
 268:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_AES_256_CCM_8              0xC0A9  /**< TLS 1.2 */
 269:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_AES_128_CCM_8          0xC0AA  /**< TLS 1.2 */
 270:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_AES_256_CCM_8          0xC0AB  /**< TLS 1.2 */
 271:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** /* The last two are named with PSK_DHE in the RFC, which looks like a typo */
 272:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 273:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_128_CCM        0xC0AC  /**< TLS 1.2 */
 274:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_256_CCM        0xC0AD  /**< TLS 1.2 */
 275:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8      0xC0AE  /**< TLS 1.2 */
 276:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_256_CCM_8      0xC0AF  /**< TLS 1.2 */
 277:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 278:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECJPAKE_WITH_AES_128_CCM_8          0xC0FF  /**< experimental */
GAS LISTING /tmp/cc8psT5X.s 			page 6


 279:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 280:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** /* RFC 7905 */
 281:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256   0xCCA8 /**< TLS 1.2 */
 282:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 0xCCA9 /**< TLS 1.2 */
 283:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256     0xCCAA /**< TLS 1.2 */
 284:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_PSK_WITH_CHACHA20_POLY1305_SHA256         0xCCAB /**< TLS 1.2 */
 285:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_ECDHE_PSK_WITH_CHACHA20_POLY1305_SHA256   0xCCAC /**< TLS 1.2 */
 286:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_DHE_PSK_WITH_CHACHA20_POLY1305_SHA256     0xCCAD /**< TLS 1.2 */
 287:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_TLS_RSA_PSK_WITH_CHACHA20_POLY1305_SHA256     0xCCAE /**< TLS 1.2 */
 288:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 289:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** /* Reminder: update mbedtls_ssl_premaster_secret when adding a new key exchange.
 290:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  * Reminder: update MBEDTLS_KEY_EXCHANGE__xxx below
 291:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  */
 292:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** typedef enum {
 293:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     MBEDTLS_KEY_EXCHANGE_NONE = 0,
 294:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     MBEDTLS_KEY_EXCHANGE_RSA,
 295:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     MBEDTLS_KEY_EXCHANGE_DHE_RSA,
 296:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     MBEDTLS_KEY_EXCHANGE_ECDHE_RSA,
 297:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA,
 298:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     MBEDTLS_KEY_EXCHANGE_PSK,
 299:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     MBEDTLS_KEY_EXCHANGE_DHE_PSK,
 300:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     MBEDTLS_KEY_EXCHANGE_RSA_PSK,
 301:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     MBEDTLS_KEY_EXCHANGE_ECDHE_PSK,
 302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     MBEDTLS_KEY_EXCHANGE_ECDH_RSA,
 303:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA,
 304:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     MBEDTLS_KEY_EXCHANGE_ECJPAKE,
 305:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** } mbedtls_key_exchange_type_t;
 306:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 307:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** /* Key exchanges using a certificate */
 308:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #if defined(MBEDTLS_KEY_EXCHANGE_RSA_ENABLED)           || \
 309:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_DHE_RSA_ENABLED)       || \
 310:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED)     || \
 311:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED)   || \
 312:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_RSA_PSK_ENABLED)       || \
 313:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_ECDH_RSA_ENABLED)      || \
 314:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA_ENABLED)
 315:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED
 316:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #endif
 317:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 318:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** /* Key exchanges allowing client certificate requests */
 319:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #if defined(MBEDTLS_KEY_EXCHANGE_RSA_ENABLED)           ||       \
 320:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_DHE_RSA_ENABLED)       ||       \
 321:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_ECDH_RSA_ENABLED)      ||       \
 322:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED)     ||       \
 323:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA_ENABLED)    ||       \
 324:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED)
 325:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_KEY_EXCHANGE__CERT_REQ_ALLOWED__ENABLED
 326:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #endif
 327:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 328:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** /* Key exchanges involving server signature in ServerKeyExchange */
 329:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #if defined(MBEDTLS_KEY_EXCHANGE_DHE_RSA_ENABLED)       || \
 330:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED)     || \
 331:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED)
 332:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_KEY_EXCHANGE__WITH_SERVER_SIGNATURE__ENABLED
 333:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #endif
 334:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 335:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** /* Key exchanges using ECDH */
GAS LISTING /tmp/cc8psT5X.s 			page 7


 336:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #if defined(MBEDTLS_KEY_EXCHANGE_ECDH_RSA_ENABLED)      || \
 337:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA_ENABLED)
 338:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_KEY_EXCHANGE__SOME__ECDH_ENABLED
 339:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #endif
 340:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 341:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** /* Key exchanges that don't involve ephemeral keys */
 342:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #if defined(MBEDTLS_KEY_EXCHANGE_RSA_ENABLED)           || \
 343:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_PSK_ENABLED)           || \
 344:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_RSA_PSK_ENABLED)       || \
 345:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE__SOME__ECDH_ENABLED)
 346:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_KEY_EXCHANGE__SOME_NON_PFS__ENABLED
 347:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #endif
 348:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 349:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** /* Key exchanges that involve ephemeral keys */
 350:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #if defined(MBEDTLS_KEY_EXCHANGE_DHE_RSA_ENABLED)       || \
 351:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_DHE_PSK_ENABLED)       || \
 352:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED)     || \
 353:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_ECDHE_PSK_ENABLED)     || \
 354:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED)   || \
 355:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
 356:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_KEY_EXCHANGE__SOME_PFS__ENABLED
 357:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #endif
 358:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 359:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** /* Key exchanges using a PSK */
 360:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #if defined(MBEDTLS_KEY_EXCHANGE_PSK_ENABLED)           || \
 361:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_RSA_PSK_ENABLED)       || \
 362:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_DHE_PSK_ENABLED)       || \
 363:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_ECDHE_PSK_ENABLED)
 364:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED
 365:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #endif
 366:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 367:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** /* Key exchanges using DHE */
 368:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #if defined(MBEDTLS_KEY_EXCHANGE_DHE_RSA_ENABLED)       || \
 369:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_DHE_PSK_ENABLED)
 370:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_KEY_EXCHANGE__SOME__DHE_ENABLED
 371:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #endif
 372:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 373:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** /* Key exchanges using ECDHE */
 374:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #if defined(MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED)     || \
 375:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED)   || \
 376:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     defined(MBEDTLS_KEY_EXCHANGE_ECDHE_PSK_ENABLED)
 377:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_KEY_EXCHANGE__SOME__ECDHE_ENABLED
 378:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #endif
 379:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 380:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** typedef struct mbedtls_ssl_ciphersuite_t mbedtls_ssl_ciphersuite_t;
 381:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 382:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_CIPHERSUITE_WEAK       0x01    /**< Weak ciphersuite flag  */
 383:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_CIPHERSUITE_SHORT_TAG  0x02    /**< Short authentication tag,
 384:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****                                                      eg for CCM_8 */
 385:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #define MBEDTLS_CIPHERSUITE_NODTLS     0x04    /**< Can't be used with DTLS */
 386:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 387:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** /**
 388:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  * \brief   This structure is used for storing ciphersuite information
 389:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****  */
 390:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** struct mbedtls_ssl_ciphersuite_t
 391:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** {
 392:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     int id;
GAS LISTING /tmp/cc8psT5X.s 			page 8


 393:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     const char * name;
 394:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 395:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     mbedtls_cipher_type_t cipher;
 396:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     mbedtls_md_type_t mac;
 397:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     mbedtls_key_exchange_type_t key_exchange;
 398:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 399:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     int min_major_ver;
 400:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     int min_minor_ver;
 401:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     int max_major_ver;
 402:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     int max_minor_ver;
 403:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 404:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     unsigned char flags;
 405:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** };
 406:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 407:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** const int *mbedtls_ssl_list_ciphersuites( void );
 408:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 409:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** const mbedtls_ssl_ciphersuite_t *mbedtls_ssl_ciphersuite_from_string( const char *ciphersuite_name 
 410:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** const mbedtls_ssl_ciphersuite_t *mbedtls_ssl_ciphersuite_from_id( int ciphersuite_id );
 411:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 412:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #if defined(MBEDTLS_PK_C)
 413:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** mbedtls_pk_type_t mbedtls_ssl_get_ciphersuite_sig_pk_alg( const mbedtls_ssl_ciphersuite_t *info );
 414:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** mbedtls_pk_type_t mbedtls_ssl_get_ciphersuite_sig_alg( const mbedtls_ssl_ciphersuite_t *info );
 415:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #endif
 416:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 417:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** int mbedtls_ssl_ciphersuite_uses_ec( const mbedtls_ssl_ciphersuite_t *info );
 418:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** int mbedtls_ssl_ciphersuite_uses_psk( const mbedtls_ssl_ciphersuite_t *info );
 419:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 420:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #if defined(MBEDTLS_KEY_EXCHANGE__SOME_PFS__ENABLED)
 421:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** static inline int mbedtls_ssl_ciphersuite_has_pfs( const mbedtls_ssl_ciphersuite_t *info )
 422:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** {
 423:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     switch( info->key_exchange )
 424:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     {
 425:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_DHE_RSA:
 426:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_DHE_PSK:
 427:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_ECDHE_RSA:
 428:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_ECDHE_PSK:
 429:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA:
 430:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_ECJPAKE:
 431:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****             return( 1 );
 432:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 433:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         default:
 434:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****             return( 0 );
 435:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     }
 436:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** }
 437:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #endif /* MBEDTLS_KEY_EXCHANGE__SOME_PFS__ENABLED */
 438:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 439:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #if defined(MBEDTLS_KEY_EXCHANGE__SOME_NON_PFS__ENABLED)
 440:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** static inline int mbedtls_ssl_ciphersuite_no_pfs( const mbedtls_ssl_ciphersuite_t *info )
 441:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** {
 442:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     switch( info->key_exchange )
 443:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     {
 444:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_ECDH_RSA:
 445:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA:
 446:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_RSA:
 447:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_PSK:
 448:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_RSA_PSK:
 449:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****             return( 1 );
GAS LISTING /tmp/cc8psT5X.s 			page 9


 450:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 451:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         default:
 452:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****             return( 0 );
 453:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     }
 454:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** }
 455:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #endif /* MBEDTLS_KEY_EXCHANGE__SOME_NON_PFS__ENABLED */
 456:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 457:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #if defined(MBEDTLS_KEY_EXCHANGE__SOME__ECDH_ENABLED)
 458:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** static inline int mbedtls_ssl_ciphersuite_uses_ecdh( const mbedtls_ssl_ciphersuite_t *info )
 459:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** {
 460:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     switch( info->key_exchange )
 461:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     {
 462:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_ECDH_RSA:
 463:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA:
 464:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****             return( 1 );
 465:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 466:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         default:
 467:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****             return( 0 );
 468:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     }
 469:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** }
 470:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #endif /* MBEDTLS_KEY_EXCHANGE__SOME__ECDH_ENABLED */
 471:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 472:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** static inline int mbedtls_ssl_ciphersuite_cert_req_allowed( const mbedtls_ssl_ciphersuite_t *info )
 473:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** {
   9              		.loc 1 473 1
  10              		.cfi_startproc
  11 0000 55       		pushq	%rbp
  12              	.LCFI0:
  13              		.cfi_def_cfa_offset 16
  14              		.cfi_offset 6, -16
  15 0001 4889E5   		movq	%rsp, %rbp
  16              	.LCFI1:
  17              		.cfi_def_cfa_register 6
  18 0004 4883EC20 		subq	$32, %rsp
  19 0008 48897DE8 		movq	%rdi, -24(%rbp)
  20              		.loc 1 473 1
  21 000c 64488B04 		movq	%fs:40, %rax
  21      25280000 
  21      00
  22 0015 488945F8 		movq	%rax, -8(%rbp)
  23 0019 31C0     		xorl	%eax, %eax
 474:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     switch( info->key_exchange )
  24              		.loc 1 474 17
  25 001b 488B45E8 		movq	-24(%rbp), %rax
  26 001f 8B4018   		movl	24(%rax), %eax
  27              		.loc 1 474 5
  28 0022 83F804   		cmpl	$4, %eax
  29 0025 7706     		ja	.L2
  30 0027 85C0     		testl	%eax, %eax
  31 0029 750A     		jne	.L3
  32 002b EB0F     		jmp	.L4
  33              	.L2:
  34 002d 83E809   		subl	$9, %eax
  35 0030 83F801   		cmpl	$1, %eax
  36 0033 7707     		ja	.L4
  37              	.L3:
 475:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     {
GAS LISTING /tmp/cc8psT5X.s 			page 10


 476:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_RSA:
 477:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_DHE_RSA:
 478:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_ECDH_RSA:
 479:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_ECDHE_RSA:
 480:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA:
 481:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA:
 482:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****             return( 1 );
  38              		.loc 1 482 19
  39 0035 B8010000 		movl	$1, %eax
  39      00
  40 003a EB05     		jmp	.L5
  41              	.L4:
 483:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 484:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         default:
 485:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****             return( 0 );
  42              		.loc 1 485 19
  43 003c B8000000 		movl	$0, %eax
  43      00
  44              	.L5:
 486:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     }
 487:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** }
  45              		.loc 1 487 1
  46 0041 488B55F8 		movq	-8(%rbp), %rdx
  47 0045 64483314 		xorq	%fs:40, %rdx
  47      25280000 
  47      00
  48 004e 7405     		je	.L6
  49 0050 E8000000 		call	__stack_chk_fail@PLT
  49      00
  50              	.L6:
  51 0055 C9       		leave
  52              	.LCFI2:
  53              		.cfi_def_cfa 7, 8
  54 0056 C3       		ret
  55              		.cfi_endproc
  56              	.LFE18:
  58              		.section	.text.mbedtls_ssl_ciphersuite_uses_server_signature,"ax",@progbits
  60              	mbedtls_ssl_ciphersuite_uses_server_signature:
  61              	.LFB20:
 488:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 489:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #if defined(MBEDTLS_KEY_EXCHANGE__SOME__DHE_ENABLED)
 490:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** static inline int mbedtls_ssl_ciphersuite_uses_dhe( const mbedtls_ssl_ciphersuite_t *info )
 491:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** {
 492:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     switch( info->key_exchange )
 493:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     {
 494:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_DHE_RSA:
 495:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_DHE_PSK:
 496:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****             return( 1 );
 497:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 498:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         default:
 499:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****             return( 0 );
 500:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     }
 501:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** }
 502:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #endif /* MBEDTLS_KEY_EXCHANGE__SOME__DHE_ENABLED) */
 503:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 504:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #if defined(MBEDTLS_KEY_EXCHANGE__SOME__ECDHE_ENABLED)
 505:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** static inline int mbedtls_ssl_ciphersuite_uses_ecdhe( const mbedtls_ssl_ciphersuite_t *info )
GAS LISTING /tmp/cc8psT5X.s 			page 11


 506:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** {
 507:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     switch( info->key_exchange )
 508:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     {
 509:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA:
 510:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_ECDHE_RSA:
 511:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_ECDHE_PSK:
 512:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****             return( 1 );
 513:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 514:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         default:
 515:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****             return( 0 );
 516:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     }
 517:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** }
 518:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #endif /* MBEDTLS_KEY_EXCHANGE__SOME__ECDHE_ENABLED) */
 519:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 520:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** #if defined(MBEDTLS_KEY_EXCHANGE__WITH_SERVER_SIGNATURE__ENABLED)
 521:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** static inline int mbedtls_ssl_ciphersuite_uses_server_signature( const mbedtls_ssl_ciphersuite_t *i
 522:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** {
  62              		.loc 1 522 1
  63              		.cfi_startproc
  64 0000 55       		pushq	%rbp
  65              	.LCFI3:
  66              		.cfi_def_cfa_offset 16
  67              		.cfi_offset 6, -16
  68 0001 4889E5   		movq	%rsp, %rbp
  69              	.LCFI4:
  70              		.cfi_def_cfa_register 6
  71 0004 4883EC20 		subq	$32, %rsp
  72 0008 48897DE8 		movq	%rdi, -24(%rbp)
  73              		.loc 1 522 1
  74 000c 64488B04 		movq	%fs:40, %rax
  74      25280000 
  74      00
  75 0015 488945F8 		movq	%rax, -8(%rbp)
  76 0019 31C0     		xorl	%eax, %eax
 523:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     switch( info->key_exchange )
  77              		.loc 1 523 17
  78 001b 488B45E8 		movq	-24(%rbp), %rax
  79 001f 8B4018   		movl	24(%rax), %eax
  80 0022 83E802   		subl	$2, %eax
  81              		.loc 1 523 5
  82 0025 83F802   		cmpl	$2, %eax
  83 0028 7707     		ja	.L8
 524:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     {
 525:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_DHE_RSA:
 526:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_ECDHE_RSA:
 527:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         case MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA:
 528:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****             return( 1 );
  84              		.loc 1 528 19
  85 002a B8010000 		movl	$1, %eax
  85      00
  86 002f EB05     		jmp	.L9
  87              	.L8:
 529:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** 
 530:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****         default:
 531:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****             return( 0 );
  88              		.loc 1 531 19
  89 0031 B8000000 		movl	$0, %eax
GAS LISTING /tmp/cc8psT5X.s 			page 12


  89      00
  90              	.L9:
 532:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h ****     }
 533:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_ciphersuites.h **** }
  91              		.loc 1 533 1
  92 0036 488B55F8 		movq	-8(%rbp), %rdx
  93 003a 64483314 		xorq	%fs:40, %rdx
  93      25280000 
  93      00
  94 0043 7405     		je	.L10
  95 0045 E8000000 		call	__stack_chk_fail@PLT
  95      00
  96              	.L10:
  97 004a C9       		leave
  98              	.LCFI5:
  99              		.cfi_def_cfa 7, 8
 100 004b C3       		ret
 101              		.cfi_endproc
 102              	.LFE20:
 104              		.section	.text.mbedtls_ssl_own_key,"ax",@progbits
 106              	mbedtls_ssl_own_key:
 107              	.LFB22:
 108              		.file 2 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_inter
   1:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /**
   2:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \file ssl_internal.h
   3:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
   4:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \brief Internal functions shared by the SSL modules
   5:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
   6:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /*
   7:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  Copyright (C) 2006-2015, ARM Limited, All Rights Reserved
   8:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  SPDX-License-Identifier: Apache-2.0
   9:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
  10:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  Licensed under the Apache License, Version 2.0 (the "License"); you may
  11:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  not use this file except in compliance with the License.
  12:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  You may obtain a copy of the License at
  13:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
  14:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  http://www.apache.org/licenses/LICENSE-2.0
  15:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
  16:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  Unless required by applicable law or agreed to in writing, software
  17:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  18:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  19:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  See the License for the specific language governing permissions and
  20:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  limitations under the License.
  21:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
  22:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *  This file is part of mbed TLS (https://tls.mbed.org)
  23:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
  24:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #ifndef MBEDTLS_SSL_INTERNAL_H
  25:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_INTERNAL_H
  26:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  27:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if !defined(MBEDTLS_CONFIG_FILE)
  28:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #include "config.h"
  29:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
  30:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #include MBEDTLS_CONFIG_FILE
  31:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
  32:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  33:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #include "ssl.h"
  34:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #include "cipher.h"
GAS LISTING /tmp/cc8psT5X.s 			page 13


  35:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  36:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_MD5_C)
  37:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #include "md5.h"
  38:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
  39:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  40:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SHA1_C)
  41:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #include "sha1.h"
  42:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
  43:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  44:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SHA256_C)
  45:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #include "sha256.h"
  46:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
  47:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  48:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SHA512_C)
  49:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #include "sha512.h"
  50:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
  51:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  52:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
  53:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #include "ecjpake.h"
  54:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
  55:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  56:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if ( defined(__ARMCC_VERSION) || defined(_MSC_VER) ) && \
  57:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     !defined(inline) && !defined(__cplusplus)
  58:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define inline __inline
  59:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
  60:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  61:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Determine minimum supported version */
  62:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MIN_MAJOR_VERSION           MBEDTLS_SSL_MAJOR_VERSION_3
  63:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  64:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
  65:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MIN_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_0
  66:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
  67:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1)
  68:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MIN_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_1
  69:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
  70:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_1)
  71:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MIN_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_2
  72:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
  73:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
  74:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MIN_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_3
  75:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
  76:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1_1 */
  77:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1   */
  78:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_SSL3   */
  79:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  80:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MIN_VALID_MINOR_VERSION MBEDTLS_SSL_MINOR_VERSION_1
  81:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MIN_VALID_MAJOR_VERSION MBEDTLS_SSL_MAJOR_VERSION_3
  82:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  83:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Determine maximum supported version */
  84:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MAX_MAJOR_VERSION           MBEDTLS_SSL_MAJOR_VERSION_3
  85:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
  86:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
  87:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MAX_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_3
  88:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
  89:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_1)
  90:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MAX_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_2
  91:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
GAS LISTING /tmp/cc8psT5X.s 			page 14


  92:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1)
  93:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MAX_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_1
  94:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
  95:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
  96:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MAX_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_0
  97:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_SSL3   */
  98:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1   */
  99:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1_1 */
 100:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
 101:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 102:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Shorthand for restartable ECC */
 103:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_ECP_RESTARTABLE) && \
 104:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     defined(MBEDTLS_SSL_CLI_C) && \
 105:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     defined(MBEDTLS_SSL_PROTO_TLS1_2) && \
 106:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     defined(MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED)
 107:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL__ECP_RESTARTABLE
 108:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 109:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 110:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_INITIAL_HANDSHAKE           0
 111:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_RENEGOTIATION_IN_PROGRESS   1   /* In progress */
 112:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_RENEGOTIATION_DONE          2   /* Done or aborted */
 113:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_RENEGOTIATION_PENDING       3   /* Requested (server only) */
 114:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 115:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /*
 116:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * DTLS retransmission states, see RFC 6347 4.2.4
 117:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 118:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * The SENDING state is merged in PREPARING for initial sends,
 119:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * but is distinct for resends.
 120:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 121:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * Note: initial state is wrong for server, but is not used anyway.
 122:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_RETRANS_PREPARING       0
 124:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_RETRANS_SENDING         1
 125:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_RETRANS_WAITING         2
 126:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_RETRANS_FINISHED        3
 127:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 128:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /*
 129:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * Allow extra bytes for record, authentication and encryption overhead:
 130:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * counter (8) + header (5) + IV(16) + MAC (16-48) + padding (0-256)
 131:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * and allow for a maximum of 1024 of compression expansion if
 132:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * enabled.
 133:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 134:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_ZLIB_SUPPORT)
 135:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_COMPRESSION_ADD          1024
 136:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
 137:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_COMPRESSION_ADD             0
 138:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 139:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 140:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_ARC4_C) || defined(MBEDTLS_CIPHER_MODE_CBC)
 141:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Ciphersuites using HMAC */
 142:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SHA512_C)
 143:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MAC_ADD                 48  /* SHA-384 used for HMAC */
 144:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #elif defined(MBEDTLS_SHA256_C)
 145:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MAC_ADD                 32  /* SHA-256 used for HMAC */
 146:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
 147:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MAC_ADD                 20  /* SHA-1   used for HMAC */
 148:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
GAS LISTING /tmp/cc8psT5X.s 			page 15


 149:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
 150:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* AEAD ciphersuites: GCM and CCM use a 128 bits tag */
 151:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MAC_ADD                 16
 152:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 153:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 154:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_CIPHER_MODE_CBC)
 155:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_PADDING_ADD            256
 156:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
 157:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_PADDING_ADD              0
 158:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 159:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 160:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_PAYLOAD_OVERHEAD ( MBEDTLS_SSL_COMPRESSION_ADD +    \
 161:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                        MBEDTLS_MAX_IV_LENGTH +          \
 162:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                        MBEDTLS_SSL_MAC_ADD +            \
 163:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                        MBEDTLS_SSL_PADDING_ADD          \
 164:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                        )
 165:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 166:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_IN_PAYLOAD_LEN ( MBEDTLS_SSL_PAYLOAD_OVERHEAD + \
 167:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                      ( MBEDTLS_SSL_IN_CONTENT_LEN ) )
 168:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 169:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_OUT_PAYLOAD_LEN ( MBEDTLS_SSL_PAYLOAD_OVERHEAD + \
 170:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                       ( MBEDTLS_SSL_OUT_CONTENT_LEN ) )
 171:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 172:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* The maximum number of buffered handshake messages. */
 173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_MAX_BUFFERED_HS 4
 174:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 175:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Maximum length we can advertise as our max content length for
 176:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****    RFC 6066 max_fragment_length extension negotiation purposes
 177:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****    (the lesser of both sizes, if they are unequal.)
 178:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 179:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_TLS_EXT_ADV_CONTENT_LEN (                            \
 180:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         (MBEDTLS_SSL_IN_CONTENT_LEN > MBEDTLS_SSL_OUT_CONTENT_LEN)   \
 181:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         ? ( MBEDTLS_SSL_OUT_CONTENT_LEN )                            \
 182:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         : ( MBEDTLS_SSL_IN_CONTENT_LEN )                             \
 183:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         )
 184:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 185:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /*
 186:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * Check that we obey the standard's message size bounds
 187:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 188:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 189:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if MBEDTLS_SSL_MAX_CONTENT_LEN > 16384
 190:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #error "Bad configuration - record content too large."
 191:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 192:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 193:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if MBEDTLS_SSL_IN_CONTENT_LEN > MBEDTLS_SSL_MAX_CONTENT_LEN
 194:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #error "Bad configuration - incoming record content should not be larger than MBEDTLS_SSL_MAX_CONTE
 195:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 196:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 197:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if MBEDTLS_SSL_OUT_CONTENT_LEN > MBEDTLS_SSL_MAX_CONTENT_LEN
 198:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #error "Bad configuration - outgoing record content should not be larger than MBEDTLS_SSL_MAX_CONTE
 199:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 201:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if MBEDTLS_SSL_IN_PAYLOAD_LEN > MBEDTLS_SSL_MAX_CONTENT_LEN + 2048
 202:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #error "Bad configuration - incoming protected record payload too large."
 203:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 204:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 205:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if MBEDTLS_SSL_OUT_PAYLOAD_LEN > MBEDTLS_SSL_MAX_CONTENT_LEN + 2048
GAS LISTING /tmp/cc8psT5X.s 			page 16


 206:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #error "Bad configuration - outgoing protected record payload too large."
 207:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 208:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 209:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Calculate buffer sizes */
 210:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 211:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Note: Even though the TLS record header is only 5 bytes
 212:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****    long, we're internally using 8 bytes to store the
 213:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****    implicit sequence number. */
 214:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_HEADER_LEN 13
 215:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 216:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_IN_BUFFER_LEN  \
 217:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     ( ( MBEDTLS_SSL_HEADER_LEN ) + ( MBEDTLS_SSL_IN_PAYLOAD_LEN ) )
 218:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 219:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_OUT_BUFFER_LEN  \
 220:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     ( ( MBEDTLS_SSL_HEADER_LEN ) + ( MBEDTLS_SSL_OUT_PAYLOAD_LEN ) )
 221:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 222:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #ifdef MBEDTLS_ZLIB_SUPPORT
 223:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Compression buffer holds both IN and OUT buffers, so should be size of the larger */
 224:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_SSL_COMPRESS_BUFFER_LEN (                               \
 225:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         ( MBEDTLS_SSL_IN_BUFFER_LEN > MBEDTLS_SSL_OUT_BUFFER_LEN )      \
 226:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         ? MBEDTLS_SSL_IN_BUFFER_LEN                                     \
 227:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         : MBEDTLS_SSL_OUT_BUFFER_LEN                                    \
 228:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         )
 229:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 230:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 231:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /*
 232:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * TLS extension flags (for extensions with outgoing ServerHello content
 233:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * that need it (e.g. for RENEGOTIATION_INFO the server already knows because
 234:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * of state of the renegotiation flag, so no indicator is required)
 235:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 236:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_TLS_EXT_SUPPORTED_POINT_FORMATS_PRESENT (1 << 0)
 237:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #define MBEDTLS_TLS_EXT_ECJPAKE_KKPP_OK                 (1 << 1)
 238:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 239:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #ifdef __cplusplus
 240:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** extern "C" {
 241:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 242:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 243:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2) && \
 244:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
 245:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /*
 246:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * Abstraction for a grid of allowed signature-hash-algorithm pairs.
 247:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 248:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** struct mbedtls_ssl_sig_hash_set_t
 249:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** {
 250:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     /* At the moment, we only need to remember a single suitable
 251:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * hash algorithm per signature algorithm. As long as that's
 252:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * the case - and we don't need a general lookup function -
 253:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * we can implement the sig-hash-set as a map from signatures
 254:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * to hash algorithms. */
 255:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_md_type_t rsa;
 256:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_md_type_t ecdsa;
 257:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** };
 258:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 &&
 259:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****           MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED */
 260:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 261:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /*
 262:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * This structure contains the parameters only needed during handshake.
GAS LISTING /tmp/cc8psT5X.s 			page 17


 263:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 264:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** struct mbedtls_ssl_handshake_params
 265:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** {
 266:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     /*
 267:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * Handshake specific crypto variables
 268:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      */
 269:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 270:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2) && \
 271:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
 272:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ssl_sig_hash_set_t hash_algs;             /*!<  Set of suitable sig-hash pairs */
 273:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 274:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_DHM_C)
 275:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_dhm_context dhm_ctx;                /*!<  DHM key exchange        */
 276:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 277:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_ECDH_C)
 278:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ecdh_context ecdh_ctx;              /*!<  ECDH key exchange       */
 279:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 280:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
 281:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ecjpake_context ecjpake_ctx;        /*!< EC J-PAKE key exchange */
 282:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_CLI_C)
 283:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char *ecjpake_cache;               /*!< Cache for ClientHello ext */
 284:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     size_t ecjpake_cache_len;                   /*!< Length of cached data */
 285:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 286:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED */
 287:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_ECDH_C) || defined(MBEDTLS_ECDSA_C) || \
 288:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
 289:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     const mbedtls_ecp_curve_info **curves;      /*!<  Supported elliptic curves */
 290:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 291:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED)
 292:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char *psk;                 /*!<  PSK from the callback         */
 293:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     size_t psk_len;                     /*!<  Length of PSK from callback   */
 294:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 295:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
 296:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ssl_key_cert *key_cert;     /*!< chosen key/cert pair (server)  */
 297:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_SERVER_NAME_INDICATION)
 298:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     int sni_authmode;                   /*!< authmode from SNI callback     */
 299:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ssl_key_cert *sni_key_cert; /*!< key/cert list from SNI         */
 300:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_x509_crt *sni_ca_chain;     /*!< trusted CAs from SNI callback  */
 301:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_x509_crl *sni_ca_crl;       /*!< trusted CAs CRLs from SNI      */
 302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_SERVER_NAME_INDICATION */
 303:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
 304:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL__ECP_RESTARTABLE)
 305:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     int ecrs_enabled;                   /*!< Handshake supports EC restart? */
 306:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_x509_crt_restart_ctx ecrs_ctx;  /*!< restart context            */
 307:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     enum { /* this complements ssl->state with info on intra-state operations */
 308:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         ssl_ecrs_none = 0,              /*!< nothing going on (yet)         */
 309:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         ssl_ecrs_crt_verify,            /*!< Certificate: crt_verify()      */
 310:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         ssl_ecrs_ske_start_processing,  /*!< ServerKeyExchange: pk_verify() */
 311:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         ssl_ecrs_cke_ecdh_calc_secret,  /*!< ClientKeyExchange: ECDH step 2 */
 312:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         ssl_ecrs_crt_vrfy_sign,         /*!< CertificateVerify: pk_sign()   */
 313:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     } ecrs_state;                       /*!< current (or last) operation    */
 314:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     size_t ecrs_n;                      /*!< place for saving a length      */
 315:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 316:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 317:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned int out_msg_seq;           /*!<  Outgoing handshake sequence number */
 318:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned int in_msg_seq;            /*!<  Incoming handshake sequence number */
 319:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
GAS LISTING /tmp/cc8psT5X.s 			page 18


 320:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char *verify_cookie;       /*!<  Cli: HelloVerifyRequest cookie
 321:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                               Srv: unused                    */
 322:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char verify_cookie_len;    /*!<  Cli: cookie length
 323:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                               Srv: flag for sending a cookie */
 324:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 325:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     uint32_t retransmit_timeout;        /*!<  Current value of timeout       */
 326:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char retransmit_state;     /*!<  Retransmission state           */
 327:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ssl_flight_item *flight;    /*!<  Current outgoing flight        */
 328:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ssl_flight_item *cur_msg;   /*!<  Current message in flight      */
 329:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char *cur_msg_p;           /*!<  Position in current message    */
 330:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned int in_flight_start_seq;   /*!<  Minimum message sequence in the
 331:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                               flight being received          */
 332:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ssl_transform *alt_transform_out;   /*!<  Alternative transform for
 333:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                               resending messages             */
 334:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char alt_out_ctr[8];       /*!<  Alternative record epoch/counter
 335:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                               for resending messages         */
 336:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 337:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     struct
 338:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     {
 339:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         size_t total_bytes_buffered; /*!< Cumulative size of heap allocated
 340:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                       *   buffers used for message buffering. */
 341:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 342:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         uint8_t seen_ccs;               /*!< Indicates if a CCS message has
 343:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                          *   been seen in the current flight. */
 344:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 345:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         struct mbedtls_ssl_hs_buffer
 346:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         {
 347:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****             unsigned is_valid      : 1;
 348:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****             unsigned is_fragmented : 1;
 349:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****             unsigned is_complete   : 1;
 350:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****             unsigned char *data;
 351:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****             size_t data_len;
 352:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         } hs[MBEDTLS_SSL_MAX_BUFFERED_HS];
 353:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 354:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         struct
 355:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         {
 356:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****             unsigned char *data;
 357:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****             size_t len;
 358:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****             unsigned epoch;
 359:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         } future_record;
 360:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 361:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     } buffering;
 362:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 363:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     uint16_t mtu;                       /*!<  Handshake mtu, used to fragment outgoing messages */
 364:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
 365:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 366:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     /*
 367:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * Checksum contexts
 368:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      */
 369:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1) || \
 370:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     defined(MBEDTLS_SSL_PROTO_TLS1_1)
 371:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****        mbedtls_md5_context fin_md5;
 372:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****       mbedtls_sha1_context fin_sha1;
 373:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 374:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
 375:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SHA256_C)
 376:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_sha256_context fin_sha256;
GAS LISTING /tmp/cc8psT5X.s 			page 19


 377:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 378:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SHA512_C)
 379:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_sha512_context fin_sha512;
 380:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 381:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
 382:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 383:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     void (*update_checksum)(mbedtls_ssl_context *, const unsigned char *, size_t);
 384:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     void (*calc_verify)(mbedtls_ssl_context *, unsigned char *);
 385:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     void (*calc_finished)(mbedtls_ssl_context *, unsigned char *, int);
 386:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     int  (*tls_prf)(const unsigned char *, size_t, const char *,
 387:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                     const unsigned char *, size_t,
 388:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                     unsigned char *, size_t);
 389:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 390:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     size_t pmslen;                      /*!<  premaster length        */
 391:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 392:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char randbytes[64];        /*!<  random bytes            */
 393:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char premaster[MBEDTLS_PREMASTER_SIZE];
 394:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                         /*!<  premaster secret        */
 395:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 396:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     int resume;                         /*!<  session resume indicator*/
 397:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     int max_major_ver;                  /*!< max. major version client*/
 398:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     int max_minor_ver;                  /*!< max. minor version client*/
 399:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     int cli_exts;                       /*!< client extension presence*/
 400:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 401:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_SESSION_TICKETS)
 402:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     int new_session_ticket;             /*!< use NewSessionTicket?    */
 403:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_SESSION_TICKETS */
 404:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_EXTENDED_MASTER_SECRET)
 405:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     int extended_ms;                    /*!< use Extended Master Secret? */
 406:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 407:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 408:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_ASYNC_PRIVATE)
 409:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned int async_in_progress : 1; /*!< an asynchronous operation is in progress */
 410:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_ASYNC_PRIVATE */
 411:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 412:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_ASYNC_PRIVATE)
 413:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     /** Asynchronous operation context. This field is meant for use by the
 414:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * asynchronous operation callbacks (mbedtls_ssl_config::f_async_sign_start,
 415:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * mbedtls_ssl_config::f_async_decrypt_start,
 416:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * mbedtls_ssl_config::f_async_resume, mbedtls_ssl_config::f_async_cancel).
 417:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * The library does not use it internally. */
 418:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     void *user_async_ctx;
 419:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_ASYNC_PRIVATE */
 420:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** };
 421:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 422:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** typedef struct mbedtls_ssl_hs_buffer mbedtls_ssl_hs_buffer;
 423:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 424:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /*
 425:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * This structure contains a full set of runtime transform parameters
 426:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * either in negotiation or active.
 427:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 428:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** struct mbedtls_ssl_transform
 429:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** {
 430:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     /*
 431:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * Session specific crypto layer
 432:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      */
 433:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     const mbedtls_ssl_ciphersuite_t *ciphersuite_info;
GAS LISTING /tmp/cc8psT5X.s 			page 20


 434:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                         /*!<  Chosen cipersuite_info  */
 435:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned int keylen;                /*!<  symmetric key length (bytes)  */
 436:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     size_t minlen;                      /*!<  min. ciphertext length  */
 437:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     size_t ivlen;                       /*!<  IV length               */
 438:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     size_t fixed_ivlen;                 /*!<  Fixed part of IV (AEAD) */
 439:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     size_t maclen;                      /*!<  MAC length              */
 440:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 441:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char iv_enc[16];           /*!<  IV (encryption)         */
 442:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char iv_dec[16];           /*!<  IV (decryption)         */
 443:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 444:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
 445:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     /* Needed only for SSL v3.0 secret */
 446:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char mac_enc[20];          /*!<  SSL v3.0 secret (enc)   */
 447:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char mac_dec[20];          /*!<  SSL v3.0 secret (dec)   */
 448:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_SSL3 */
 449:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 450:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_md_context_t md_ctx_enc;            /*!<  MAC (encryption)        */
 451:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_md_context_t md_ctx_dec;            /*!<  MAC (decryption)        */
 452:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 453:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_cipher_context_t cipher_ctx_enc;    /*!<  encryption context      */
 454:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_cipher_context_t cipher_ctx_dec;    /*!<  decryption context      */
 455:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 456:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     /*
 457:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      * Session specific compression layer
 458:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****      */
 459:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_ZLIB_SUPPORT)
 460:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     z_stream ctx_deflate;               /*!<  compression context     */
 461:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     z_stream ctx_inflate;               /*!<  decompression context   */
 462:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 463:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** };
 464:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 465:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
 466:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /*
 467:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * List of certificate + private key pairs
 468:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 469:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** struct mbedtls_ssl_key_cert
 470:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** {
 471:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_x509_crt *cert;                 /*!< cert                       */
 472:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_pk_context *key;                /*!< private key                */
 473:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ssl_key_cert *next;             /*!< next key/cert pair         */
 474:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** };
 475:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
 476:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 477:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 478:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /*
 479:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * List of handshake messages kept around for resending
 480:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 481:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** struct mbedtls_ssl_flight_item
 482:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** {
 483:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char *p;       /*!< message, including handshake headers   */
 484:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     size_t len;             /*!< length of p                            */
 485:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     unsigned char type;     /*!< type of the message: handshake or CCS  */
 486:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ssl_flight_item *next;  /*!< next handshake message(s)              */
 487:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** };
 488:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
 489:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 490:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2) && \
GAS LISTING /tmp/cc8psT5X.s 			page 21


 491:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
 492:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 493:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Find an entry in a signature-hash set matching a given hash algorithm. */
 494:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** mbedtls_md_type_t mbedtls_ssl_sig_hash_set_find( mbedtls_ssl_sig_hash_set_t *set,
 495:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                                  mbedtls_pk_type_t sig_alg );
 496:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Add a signature-hash-pair to a signature-hash set */
 497:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_sig_hash_set_add( mbedtls_ssl_sig_hash_set_t *set,
 498:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                    mbedtls_pk_type_t sig_alg,
 499:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                    mbedtls_md_type_t md_alg );
 500:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Allow exactly one hash algorithm for each signature. */
 501:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_sig_hash_set_const_hash( mbedtls_ssl_sig_hash_set_t *set,
 502:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                           mbedtls_md_type_t md_alg );
 503:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 504:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Setup an empty signature-hash set */
 505:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** static inline void mbedtls_ssl_sig_hash_set_init( mbedtls_ssl_sig_hash_set_t *set )
 506:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** {
 507:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ssl_sig_hash_set_const_hash( set, MBEDTLS_MD_NONE );
 508:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** }
 509:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 510:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2) &&
 511:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****           MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED */
 512:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 513:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /**
 514:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \brief           Free referenced items in an SSL transform context and clear
 515:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                  memory
 516:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 517:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \param transform SSL transform context
 518:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 519:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_transform_free( mbedtls_ssl_transform *transform );
 520:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 521:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /**
 522:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \brief           Free referenced items in an SSL handshake context and clear
 523:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                  memory
 524:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 525:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \param ssl       SSL context
 526:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 527:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_handshake_free( mbedtls_ssl_context *ssl );
 528:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 529:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_handshake_client_step( mbedtls_ssl_context *ssl );
 530:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_handshake_server_step( mbedtls_ssl_context *ssl );
 531:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_handshake_wrapup( mbedtls_ssl_context *ssl );
 532:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 533:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_send_fatal_handshake_failure( mbedtls_ssl_context *ssl );
 534:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 535:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_reset_checksum( mbedtls_ssl_context *ssl );
 536:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_derive_keys( mbedtls_ssl_context *ssl );
 537:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 538:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_handle_message_type( mbedtls_ssl_context *ssl );
 539:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_prepare_handshake_record( mbedtls_ssl_context *ssl );
 540:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_update_handshake_status( mbedtls_ssl_context *ssl );
 541:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 542:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /**
 543:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \brief       Update record layer
 544:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 545:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              This function roughly separates the implementation
 546:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              of the logic of (D)TLS from the implementation
 547:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              of the secure transport.
GAS LISTING /tmp/cc8psT5X.s 			page 22


 548:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 549:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \param  ssl              The SSL context to use.
 550:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \param  update_hs_digest This indicates if the handshake digest
 551:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                          should be automatically updated in case
 552:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                          a handshake message is found.
 553:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 554:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \return      0 or non-zero error code.
 555:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 556:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \note        A clarification on what is called 'record layer' here
 557:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              is in order, as many sensible definitions are possible:
 558:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 559:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              The record layer takes as input an untrusted underlying
 560:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              transport (stream or datagram) and transforms it into
 561:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              a serially multiplexed, secure transport, which
 562:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              conceptually provides the following:
 563:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 564:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              (1) Three datagram based, content-agnostic transports
 565:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                  for handshake, alert and CCS messages.
 566:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              (2) One stream- or datagram-based transport
 567:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                  for application data.
 568:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              (3) Functionality for changing the underlying transform
 569:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                  securing the contents.
 570:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 571:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              The interface to this functionality is given as follows:
 572:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 573:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              a Updating
 574:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                [Currently implemented by mbedtls_ssl_read_record]
 575:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 576:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                Check if and on which of the four 'ports' data is pending:
 577:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                Nothing, a controlling datagram of type (1), or application
 578:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                data (2). In any case data is present, internal buffers
 579:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                provide access to the data for the user to process it.
 580:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                Consumption of type (1) datagrams is done automatically
 581:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                on the next update, invalidating that the internal buffers
 582:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                for previous datagrams, while consumption of application
 583:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                data (2) is user-controlled.
 584:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 585:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              b Reading of application data
 586:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                [Currently manual adaption of ssl->in_offt pointer]
 587:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 588:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                As mentioned in the last paragraph, consumption of data
 589:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                is different from the automatic consumption of control
 590:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                datagrams (1) because application data is treated as a stream.
 591:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 592:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              c Tracking availability of application data
 593:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                [Currently manually through decreasing ssl->in_msglen]
 594:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 595:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                For efficiency and to retain datagram semantics for
 596:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                application data in case of DTLS, the record layer
 597:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                provides functionality for checking how much application
 598:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *                data is still available in the internal buffer.
 599:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 600:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              d Changing the transformation securing the communication.
 601:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 602:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              Given an opaque implementation of the record layer in the
 603:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              above sense, it should be possible to implement the logic
 604:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              of (D)TLS on top of it without the need to know anything
GAS LISTING /tmp/cc8psT5X.s 			page 23


 605:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              about the record layer's internals. This is done e.g.
 606:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              in all the handshake handling functions, and in the
 607:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              application data reading function mbedtls_ssl_read.
 608:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 609:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * \note        The above tries to give a conceptual picture of the
 610:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              record layer, but the current implementation deviates
 611:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              from it in some places. For example, our implementation of
 612:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              the update functionality through mbedtls_ssl_read_record
 613:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              discards datagrams depending on the current state, which
 614:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              wouldn't fall under the record layer's responsibility
 615:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *              following the above definition.
 616:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 617:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 618:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_read_record( mbedtls_ssl_context *ssl,
 619:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                              unsigned update_hs_digest );
 620:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_fetch_input( mbedtls_ssl_context *ssl, size_t nb_want );
 621:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 622:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_write_handshake_msg( mbedtls_ssl_context *ssl );
 623:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_write_record( mbedtls_ssl_context *ssl, uint8_t force_flush );
 624:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_flush_output( mbedtls_ssl_context *ssl );
 625:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 626:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_parse_certificate( mbedtls_ssl_context *ssl );
 627:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_write_certificate( mbedtls_ssl_context *ssl );
 628:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 629:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_parse_change_cipher_spec( mbedtls_ssl_context *ssl );
 630:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_write_change_cipher_spec( mbedtls_ssl_context *ssl );
 631:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 632:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_parse_finished( mbedtls_ssl_context *ssl );
 633:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_write_finished( mbedtls_ssl_context *ssl );
 634:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 635:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_optimize_checksum( mbedtls_ssl_context *ssl,
 636:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                             const mbedtls_ssl_ciphersuite_t *ciphersuite_info );
 637:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 638:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED)
 639:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_psk_derive_premaster( mbedtls_ssl_context *ssl, mbedtls_key_exchange_type_t key_ex 
 640:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 641:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 642:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_PK_C)
 643:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** unsigned char mbedtls_ssl_sig_from_pk( mbedtls_pk_context *pk );
 644:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** unsigned char mbedtls_ssl_sig_from_pk_alg( mbedtls_pk_type_t type );
 645:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** mbedtls_pk_type_t mbedtls_ssl_pk_alg_from_sig( unsigned char sig );
 646:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 647:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 648:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** mbedtls_md_type_t mbedtls_ssl_md_alg_from_hash( unsigned char hash );
 649:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** unsigned char mbedtls_ssl_hash_from_md_alg( int md );
 650:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_set_calc_verify_md( mbedtls_ssl_context *ssl, int md );
 651:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 652:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_ECP_C)
 653:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_check_curve( const mbedtls_ssl_context *ssl, mbedtls_ecp_group_id grp_id );
 654:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 655:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 656:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
 657:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_check_sig_hash( const mbedtls_ssl_context *ssl,
 658:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                                 mbedtls_md_type_t md );
 659:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 660:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 661:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
GAS LISTING /tmp/cc8psT5X.s 			page 24


 662:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** static inline mbedtls_pk_context *mbedtls_ssl_own_key( mbedtls_ssl_context *ssl )
 663:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** {
 109              		.loc 2 663 1
 110              		.cfi_startproc
 111 0000 55       		pushq	%rbp
 112              	.LCFI6:
 113              		.cfi_def_cfa_offset 16
 114              		.cfi_offset 6, -16
 115 0001 4889E5   		movq	%rsp, %rbp
 116              	.LCFI7:
 117              		.cfi_def_cfa_register 6
 118 0004 4883EC20 		subq	$32, %rsp
 119 0008 48897DE8 		movq	%rdi, -24(%rbp)
 120              		.loc 2 663 1
 121 000c 64488B04 		movq	%fs:40, %rax
 121      25280000 
 121      00
 122 0015 488945F8 		movq	%rax, -8(%rbp)
 123 0019 31C0     		xorl	%eax, %eax
 664:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ssl_key_cert *key_cert;
 665:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 666:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     if( ssl->handshake != NULL && ssl->handshake->key_cert != NULL )
 124              		.loc 2 666 12
 125 001b 488B45E8 		movq	-24(%rbp), %rax
 126 001f 488B4060 		movq	96(%rax), %rax
 127              		.loc 2 666 7
 128 0023 4885C0   		testq	%rax, %rax
 129 0026 7429     		je	.L12
 130              		.loc 2 666 38 discriminator 1
 131 0028 488B45E8 		movq	-24(%rbp), %rax
 132 002c 488B4060 		movq	96(%rax), %rax
 133              		.loc 2 666 49 discriminator 1
 134 0030 488B8078 		movq	632(%rax), %rax
 134      020000
 135              		.loc 2 666 32 discriminator 1
 136 0037 4885C0   		testq	%rax, %rax
 137 003a 7415     		je	.L12
 667:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         key_cert = ssl->handshake->key_cert;
 138              		.loc 2 667 23
 139 003c 488B45E8 		movq	-24(%rbp), %rax
 140 0040 488B4060 		movq	96(%rax), %rax
 141              		.loc 2 667 18
 142 0044 488B8078 		movq	632(%rax), %rax
 142      020000
 143 004b 488945F0 		movq	%rax, -16(%rbp)
 144 004f EB12     		jmp	.L13
 145              	.L12:
 668:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     else
 669:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         key_cert = ssl->conf->key_cert;
 146              		.loc 2 669 23
 147 0051 488B45E8 		movq	-24(%rbp), %rax
 148 0055 488B00   		movq	(%rax), %rax
 149              		.loc 2 669 18
 150 0058 488B8080 		movq	128(%rax), %rax
 150      000000
 151 005f 488945F0 		movq	%rax, -16(%rbp)
 152              	.L13:
GAS LISTING /tmp/cc8psT5X.s 			page 25


 670:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 671:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     return( key_cert == NULL ? NULL : key_cert->key );
 153              		.loc 2 671 37
 154 0063 48837DF0 		cmpq	$0, -16(%rbp)
 154      00
 155 0068 740A     		je	.L14
 156              		.loc 2 671 37 is_stmt 0 discriminator 1
 157 006a 488B45F0 		movq	-16(%rbp), %rax
 158 006e 488B4008 		movq	8(%rax), %rax
 159 0072 EB05     		jmp	.L16
 160              	.L14:
 161              		.loc 2 671 37 discriminator 2
 162 0074 B8000000 		movl	$0, %eax
 162      00
 163              	.L16:
 672:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** }
 164              		.loc 2 672 1 is_stmt 1 discriminator 5
 165 0079 488B55F8 		movq	-8(%rbp), %rdx
 166 007d 64483314 		xorq	%fs:40, %rdx
 166      25280000 
 166      00
 167 0086 7405     		je	.L17
 168              		.loc 2 672 1 is_stmt 0
 169 0088 E8000000 		call	__stack_chk_fail@PLT
 169      00
 170              	.L17:
 171 008d C9       		leave
 172              	.LCFI8:
 173              		.cfi_def_cfa 7, 8
 174 008e C3       		ret
 175              		.cfi_endproc
 176              	.LFE22:
 178              		.section	.text.mbedtls_ssl_own_cert,"ax",@progbits
 180              	mbedtls_ssl_own_cert:
 181              	.LFB23:
 673:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 674:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** static inline mbedtls_x509_crt *mbedtls_ssl_own_cert( mbedtls_ssl_context *ssl )
 675:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** {
 182              		.loc 2 675 1 is_stmt 1
 183              		.cfi_startproc
 184 0000 55       		pushq	%rbp
 185              	.LCFI9:
 186              		.cfi_def_cfa_offset 16
 187              		.cfi_offset 6, -16
 188 0001 4889E5   		movq	%rsp, %rbp
 189              	.LCFI10:
 190              		.cfi_def_cfa_register 6
 191 0004 4883EC20 		subq	$32, %rsp
 192 0008 48897DE8 		movq	%rdi, -24(%rbp)
 193              		.loc 2 675 1
 194 000c 64488B04 		movq	%fs:40, %rax
 194      25280000 
 194      00
 195 0015 488945F8 		movq	%rax, -8(%rbp)
 196 0019 31C0     		xorl	%eax, %eax
 676:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     mbedtls_ssl_key_cert *key_cert;
 677:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
GAS LISTING /tmp/cc8psT5X.s 			page 26


 678:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     if( ssl->handshake != NULL && ssl->handshake->key_cert != NULL )
 197              		.loc 2 678 12
 198 001b 488B45E8 		movq	-24(%rbp), %rax
 199 001f 488B4060 		movq	96(%rax), %rax
 200              		.loc 2 678 7
 201 0023 4885C0   		testq	%rax, %rax
 202 0026 7429     		je	.L19
 203              		.loc 2 678 38 discriminator 1
 204 0028 488B45E8 		movq	-24(%rbp), %rax
 205 002c 488B4060 		movq	96(%rax), %rax
 206              		.loc 2 678 49 discriminator 1
 207 0030 488B8078 		movq	632(%rax), %rax
 207      020000
 208              		.loc 2 678 32 discriminator 1
 209 0037 4885C0   		testq	%rax, %rax
 210 003a 7415     		je	.L19
 679:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         key_cert = ssl->handshake->key_cert;
 211              		.loc 2 679 23
 212 003c 488B45E8 		movq	-24(%rbp), %rax
 213 0040 488B4060 		movq	96(%rax), %rax
 214              		.loc 2 679 18
 215 0044 488B8078 		movq	632(%rax), %rax
 215      020000
 216 004b 488945F0 		movq	%rax, -16(%rbp)
 217 004f EB12     		jmp	.L20
 218              	.L19:
 680:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     else
 681:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         key_cert = ssl->conf->key_cert;
 219              		.loc 2 681 23
 220 0051 488B45E8 		movq	-24(%rbp), %rax
 221 0055 488B00   		movq	(%rax), %rax
 222              		.loc 2 681 18
 223 0058 488B8080 		movq	128(%rax), %rax
 223      000000
 224 005f 488945F0 		movq	%rax, -16(%rbp)
 225              	.L20:
 682:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 683:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     return( key_cert == NULL ? NULL : key_cert->cert );
 226              		.loc 2 683 37
 227 0063 48837DF0 		cmpq	$0, -16(%rbp)
 227      00
 228 0068 7409     		je	.L21
 229              		.loc 2 683 37 is_stmt 0 discriminator 1
 230 006a 488B45F0 		movq	-16(%rbp), %rax
 231 006e 488B00   		movq	(%rax), %rax
 232 0071 EB05     		jmp	.L23
 233              	.L21:
 234              		.loc 2 683 37 discriminator 2
 235 0073 B8000000 		movl	$0, %eax
 235      00
 236              	.L23:
 684:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** }
 237              		.loc 2 684 1 is_stmt 1 discriminator 5
 238 0078 488B55F8 		movq	-8(%rbp), %rdx
 239 007c 64483314 		xorq	%fs:40, %rdx
 239      25280000 
 239      00
GAS LISTING /tmp/cc8psT5X.s 			page 27


 240 0085 7405     		je	.L24
 241              		.loc 2 684 1 is_stmt 0
 242 0087 E8000000 		call	__stack_chk_fail@PLT
 242      00
 243              	.L24:
 244 008c C9       		leave
 245              	.LCFI11:
 246              		.cfi_def_cfa 7, 8
 247 008d C3       		ret
 248              		.cfi_endproc
 249              	.LFE23:
 251              		.section	.text.mbedtls_ssl_hs_hdr_len,"ax",@progbits
 253              	mbedtls_ssl_hs_hdr_len:
 254              	.LFB25:
 685:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 686:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /*
 687:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * Check usage of a certificate wrt extensions:
 688:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * keyUsage, extendedKeyUsage (later), and nSCertType (later).
 689:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 690:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * Warning: cert_endpoint is the endpoint of the cert (ie, of our peer when we
 691:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * check a cert we received from them)!
 692:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  *
 693:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  * Return 0 if everything is OK, -1 if not.
 694:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****  */
 695:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_check_cert_usage( const mbedtls_x509_crt *cert,
 696:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                           const mbedtls_ssl_ciphersuite_t *ciphersuite,
 697:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                           int cert_endpoint,
 698:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                           uint32_t *flags );
 699:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
 700:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 701:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_write_version( int major, int minor, int transport,
 702:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                         unsigned char ver[2] );
 703:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_read_version( int *major, int *minor, int transport,
 704:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****                        const unsigned char ver[2] );
 705:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 706:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** static inline size_t mbedtls_ssl_hdr_len( const mbedtls_ssl_context *ssl )
 707:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** {
 708:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 709:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
 710:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         return( 13 );
 711:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
 712:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     ((void) ssl);
 713:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 714:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     return( 5 );
 715:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** }
 716:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 717:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** static inline size_t mbedtls_ssl_hs_hdr_len( const mbedtls_ssl_context *ssl )
 718:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** {
 255              		.loc 2 718 1 is_stmt 1
 256              		.cfi_startproc
 257 0000 55       		pushq	%rbp
 258              	.LCFI12:
 259              		.cfi_def_cfa_offset 16
 260              		.cfi_offset 6, -16
 261 0001 4889E5   		movq	%rsp, %rbp
 262              	.LCFI13:
 263              		.cfi_def_cfa_register 6
GAS LISTING /tmp/cc8psT5X.s 			page 28


 264 0004 4883EC20 		subq	$32, %rsp
 265 0008 48897DE8 		movq	%rdi, -24(%rbp)
 266              		.loc 2 718 1
 267 000c 64488B04 		movq	%fs:40, %rax
 267      25280000 
 267      00
 268 0015 488945F8 		movq	%rax, -8(%rbp)
 269 0019 31C0     		xorl	%eax, %eax
 719:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 720:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
 721:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         return( 12 );
 722:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #else
 723:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     ((void) ssl);
 724:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 725:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     return( 4 );
 270              		.loc 2 725 11
 271 001b B8040000 		movl	$4, %eax
 271      00
 726:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** }
 272              		.loc 2 726 1
 273 0020 488B55F8 		movq	-8(%rbp), %rdx
 274 0024 64483314 		xorq	%fs:40, %rdx
 274      25280000 
 274      00
 275 002d 7405     		je	.L27
 276 002f E8000000 		call	__stack_chk_fail@PLT
 276      00
 277              	.L27:
 278 0034 C9       		leave
 279              	.LCFI14:
 280              		.cfi_def_cfa 7, 8
 281 0035 C3       		ret
 282              		.cfi_endproc
 283              	.LFE25:
 285              		.section	.text.mbedtls_ssl_safer_memcmp,"ax",@progbits
 287              	mbedtls_ssl_safer_memcmp:
 288              	.LFB26:
 727:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 728:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 729:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_send_flight_completed( mbedtls_ssl_context *ssl );
 730:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_recv_flight_completed( mbedtls_ssl_context *ssl );
 731:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_resend( mbedtls_ssl_context *ssl );
 732:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_flight_transmit( mbedtls_ssl_context *ssl );
 733:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 734:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 735:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* Visible for testing purposes only */
 736:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #if defined(MBEDTLS_SSL_DTLS_ANTI_REPLAY)
 737:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** int mbedtls_ssl_dtls_replay_check( mbedtls_ssl_context *ssl );
 738:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** void mbedtls_ssl_dtls_replay_update( mbedtls_ssl_context *ssl );
 739:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** #endif
 740:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 741:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** /* constant-time buffer comparison */
 742:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** static inline int mbedtls_ssl_safer_memcmp( const void *a, const void *b, size_t n )
 743:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** {
 289              		.loc 2 743 1
 290              		.cfi_startproc
 291 0000 55       		pushq	%rbp
GAS LISTING /tmp/cc8psT5X.s 			page 29


 292              	.LCFI15:
 293              		.cfi_def_cfa_offset 16
 294              		.cfi_offset 6, -16
 295 0001 4889E5   		movq	%rsp, %rbp
 296              	.LCFI16:
 297              		.cfi_def_cfa_register 6
 298 0004 4883EC50 		subq	$80, %rsp
 299 0008 48897DC8 		movq	%rdi, -56(%rbp)
 300 000c 488975C0 		movq	%rsi, -64(%rbp)
 301 0010 488955B8 		movq	%rdx, -72(%rbp)
 302              		.loc 2 743 1
 303 0014 64488B04 		movq	%fs:40, %rax
 303      25280000 
 303      00
 304 001d 488945F8 		movq	%rax, -8(%rbp)
 305 0021 31C0     		xorl	%eax, %eax
 744:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     size_t i;
 745:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     volatile const unsigned char *A = (volatile const unsigned char *) a;
 306              		.loc 2 745 35
 307 0023 488B45C8 		movq	-56(%rbp), %rax
 308 0027 488945E8 		movq	%rax, -24(%rbp)
 746:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     volatile const unsigned char *B = (volatile const unsigned char *) b;
 309              		.loc 2 746 35
 310 002b 488B45C0 		movq	-64(%rbp), %rax
 311 002f 488945F0 		movq	%rax, -16(%rbp)
 747:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     volatile unsigned char diff = 0;
 312              		.loc 2 747 28
 313 0033 C645DD00 		movb	$0, -35(%rbp)
 748:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 749:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     for( i = 0; i < n; i++ )
 314              		.loc 2 749 12
 315 0037 48C745E0 		movq	$0, -32(%rbp)
 315      00000000 
 316              		.loc 2 749 5
 317 003f EB39     		jmp	.L29
 318              	.L30:
 319              	.LBB2:
 750:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     {
 751:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         /* Read volatile data in order before computing diff.
 752:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****          * This avoids IAR compiler warning:
 753:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****          * 'the order of volatile accesses is undefined ..' */
 754:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         unsigned char x = A[i], y = B[i];
 320              		.loc 2 754 28 discriminator 3
 321 0041 488B55E8 		movq	-24(%rbp), %rdx
 322 0045 488B45E0 		movq	-32(%rbp), %rax
 323 0049 4801D0   		addq	%rdx, %rax
 324              		.loc 2 754 23 discriminator 3
 325 004c 0FB600   		movzbl	(%rax), %eax
 326 004f 8845DE   		movb	%al, -34(%rbp)
 327              		.loc 2 754 38 discriminator 3
 328 0052 488B55F0 		movq	-16(%rbp), %rdx
 329 0056 488B45E0 		movq	-32(%rbp), %rax
 330 005a 4801D0   		addq	%rdx, %rax
 331              		.loc 2 754 33 discriminator 3
 332 005d 0FB600   		movzbl	(%rax), %eax
 333 0060 8845DF   		movb	%al, -33(%rbp)
 755:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****         diff |= x ^ y;
GAS LISTING /tmp/cc8psT5X.s 			page 30


 334              		.loc 2 755 14 discriminator 3
 335 0063 0FB645DE 		movzbl	-34(%rbp), %eax
 336 0067 3245DF   		xorb	-33(%rbp), %al
 337 006a 89C2     		movl	%eax, %edx
 338 006c 0FB645DD 		movzbl	-35(%rbp), %eax
 339 0070 09D0     		orl	%edx, %eax
 340 0072 8845DD   		movb	%al, -35(%rbp)
 341              	.LBE2:
 749:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     {
 342              		.loc 2 749 25 discriminator 3
 343 0075 488345E0 		addq	$1, -32(%rbp)
 343      01
 344              	.L29:
 749:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     {
 345              		.loc 2 749 5 discriminator 1
 346 007a 488B45E0 		movq	-32(%rbp), %rax
 347 007e 483B45B8 		cmpq	-72(%rbp), %rax
 348 0082 72BD     		jb	.L30
 756:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     }
 757:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** 
 758:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h ****     return( diff );
 349              		.loc 2 758 11
 350 0084 0FB645DD 		movzbl	-35(%rbp), %eax
 351 0088 0FB6C0   		movzbl	%al, %eax
 759:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl_internal.h **** }
 352              		.loc 2 759 1
 353 008b 488B4DF8 		movq	-8(%rbp), %rcx
 354 008f 6448330C 		xorq	%fs:40, %rcx
 354      25280000 
 354      00
 355 0098 7405     		je	.L32
 356 009a E8000000 		call	__stack_chk_fail@PLT
 356      00
 357              	.L32:
 358 009f C9       		leave
 359              	.LCFI17:
 360              		.cfi_def_cfa 7, 8
 361 00a0 C3       		ret
 362              		.cfi_endproc
 363              	.LFE26:
 365              		.section	.text.ssl_write_renegotiation_ext,"ax",@progbits
 367              	ssl_write_renegotiation_ext:
 368              	.LFB27:
 369              		.file 3 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c"
   1:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** /*
   2:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  *  SSLv3/TLSv1 client-side functions
   3:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  *
   4:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  *  Copyright (C) 2006-2015, ARM Limited, All Rights Reserved
   5:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  *  SPDX-License-Identifier: Apache-2.0
   6:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  *
   7:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  *  Licensed under the Apache License, Version 2.0 (the "License"); you may
   8:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  *  not use this file except in compliance with the License.
   9:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  *  You may obtain a copy of the License at
  10:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  *
  11:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  *  http://www.apache.org/licenses/LICENSE-2.0
  12:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  *
  13:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  *  Unless required by applicable law or agreed to in writing, software
GAS LISTING /tmp/cc8psT5X.s 			page 31


  14:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  *  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  15:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  16:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  *  See the License for the specific language governing permissions and
  17:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  *  limitations under the License.
  18:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  *
  19:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  *  This file is part of mbed TLS (https://tls.mbed.org)
  20:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  */
  21:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
  22:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if !defined(MBEDTLS_CONFIG_FILE)
  23:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #include "mbedtls/config.h"
  24:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #else
  25:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #include MBEDTLS_CONFIG_FILE
  26:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
  27:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
  28:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_CLI_C)
  29:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
  30:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_PLATFORM_C)
  31:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #include "mbedtls/platform.h"
  32:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #else
  33:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #include <stdlib.h>
  34:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #define mbedtls_calloc    calloc
  35:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #define mbedtls_free      free
  36:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
  37:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
  38:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #include "mbedtls/debug.h"
  39:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #include "mbedtls/ssl.h"
  40:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #include "mbedtls/ssl_internal.h"
  41:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
  42:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #include <string.h>
  43:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
  44:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #include <stdint.h>
  45:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
  46:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_HAVE_TIME)
  47:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #include "mbedtls/platform_time.h"
  48:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
  49:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
  50:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_SESSION_TICKETS)
  51:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #include "mbedtls/platform_util.h"
  52:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
  53:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
  54:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_SERVER_NAME_INDICATION)
  55:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static void ssl_write_hostname_ext( mbedtls_ssl_context *ssl,
  56:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                     unsigned char *buf,
  57:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                     size_t *olen )
  58:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
  59:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char *p = buf;
  60:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const unsigned char *end = ssl->out_msg + MBEDTLS_SSL_OUT_CONTENT_LEN;
  61:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     size_t hostname_len;
  62:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
  63:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = 0;
  64:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
  65:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->hostname == NULL )
  66:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
  67:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
  68:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "client hello, adding server name extension: %s",
  69:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                    ssl->hostname ) );
  70:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
GAS LISTING /tmp/cc8psT5X.s 			page 32


  71:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     hostname_len = strlen( ssl->hostname );
  72:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
  73:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( end < p || (size_t)( end - p ) < hostname_len + 9 )
  74:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
  75:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "buffer too small" ) );
  76:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
  77:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
  78:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
  79:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
  80:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * Sect. 3, RFC 6066 (TLS Extensions Definitions)
  81:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *
  82:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * In order to provide any of the server names, clients MAY include an
  83:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * extension of type "server_name" in the (extended) client hello. The
  84:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * "extension_data" field of this extension SHALL contain
  85:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * "ServerNameList" where:
  86:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *
  87:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * struct {
  88:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     NameType name_type;
  89:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     select (name_type) {
  90:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *         case host_name: HostName;
  91:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     } name;
  92:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * } ServerName;
  93:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *
  94:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * enum {
  95:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     host_name(0), (255)
  96:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * } NameType;
  97:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *
  98:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * opaque HostName<1..2^16-1>;
  99:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *
 100:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * struct {
 101:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     ServerName server_name_list<1..2^16-1>
 102:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * } ServerNameList;
 103:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *
 104:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
 105:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_SERVERNAME >> 8 ) & 0xFF );
 106:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_SERVERNAME      ) & 0xFF );
 107:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 108:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( (hostname_len + 5) >> 8 ) & 0xFF );
 109:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( (hostname_len + 5)      ) & 0xFF );
 110:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 111:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( (hostname_len + 3) >> 8 ) & 0xFF );
 112:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( (hostname_len + 3)      ) & 0xFF );
 113:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 114:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_SERVERNAME_HOSTNAME ) & 0xFF );
 115:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( hostname_len >> 8 ) & 0xFF );
 116:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( hostname_len      ) & 0xFF );
 117:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 118:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     memcpy( p, ssl->hostname, hostname_len );
 119:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 120:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = hostname_len + 9;
 121:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 122:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_SERVER_NAME_INDICATION */
 123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 124:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
 125:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static void ssl_write_renegotiation_ext( mbedtls_ssl_context *ssl,
 126:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                          unsigned char *buf,
 127:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                          size_t *olen )
GAS LISTING /tmp/cc8psT5X.s 			page 33


 128:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 370              		.loc 3 128 1
 371              		.cfi_startproc
 372 0000 F30F1EFA 		endbr64
 373 0004 55       		pushq	%rbp
 374              	.LCFI18:
 375              		.cfi_def_cfa_offset 16
 376              		.cfi_offset 6, -16
 377 0005 4889E5   		movq	%rsp, %rbp
 378              	.LCFI19:
 379              		.cfi_def_cfa_register 6
 380 0008 4883EC40 		subq	$64, %rsp
 381 000c 48897DD8 		movq	%rdi, -40(%rbp)
 382 0010 488975D0 		movq	%rsi, -48(%rbp)
 383 0014 488955C8 		movq	%rdx, -56(%rbp)
 384              		.loc 3 128 1
 385 0018 64488B04 		movq	%fs:40, %rax
 385      25280000 
 385      00
 386 0021 488945F8 		movq	%rax, -8(%rbp)
 387 0025 31C0     		xorl	%eax, %eax
 129:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char *p = buf;
 388              		.loc 3 129 20
 389 0027 488B45D0 		movq	-48(%rbp), %rax
 390 002b 488945E8 		movq	%rax, -24(%rbp)
 130:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const unsigned char *end = ssl->out_msg + MBEDTLS_SSL_OUT_CONTENT_LEN;
 391              		.loc 3 130 35
 392 002f 488B45D8 		movq	-40(%rbp), %rax
 393 0033 488B8028 		movq	296(%rax), %rax
 393      010000
 394              		.loc 3 130 26
 395 003a 4805803E 		addq	$16000, %rax
 395      0000
 396 0040 488945F0 		movq	%rax, -16(%rbp)
 131:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 132:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = 0;
 397              		.loc 3 132 11
 398 0044 488B45C8 		movq	-56(%rbp), %rax
 399 0048 48C70000 		movq	$0, (%rax)
 399      000000
 133:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 134:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /* We're always including an TLS_EMPTY_RENEGOTIATION_INFO_SCSV in the
 135:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * initial ClientHello, in which case also adding the renegotiation
 136:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * info extension is NOT RECOMMENDED as per RFC 5746 Section 3.4. */
 137:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->renego_status != MBEDTLS_SSL_RENEGOTIATION_IN_PROGRESS )
 400              		.loc 3 137 12
 401 004f 488B45D8 		movq	-40(%rbp), %rax
 402 0053 8B400C   		movl	12(%rax), %eax
 403              		.loc 3 137 7
 404 0056 83F801   		cmpl	$1, %eax
 405 0059 0F85D400 		jne	.L39
 405      0000
 138:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
 139:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 140:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "client hello, adding renegotiation extension" ) );
 141:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 142:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( end < p || (size_t)( end - p ) < 5 + ssl->verify_data_len )
GAS LISTING /tmp/cc8psT5X.s 			page 34


 406              		.loc 3 142 7
 407 005f 488B45F0 		movq	-16(%rbp), %rax
 408 0063 483B45E8 		cmpq	-24(%rbp), %rax
 409 0067 0F82C900 		jb	.L40
 409      0000
 410              		.loc 3 142 34 discriminator 1
 411 006d 488B45F0 		movq	-16(%rbp), %rax
 412 0071 482B45E8 		subq	-24(%rbp), %rax
 413              		.loc 3 142 20 discriminator 1
 414 0075 4889C2   		movq	%rax, %rdx
 415              		.loc 3 142 49 discriminator 1
 416 0078 488B45D8 		movq	-40(%rbp), %rax
 417 007c 488B8068 		movq	360(%rax), %rax
 417      010000
 418              		.loc 3 142 44 discriminator 1
 419 0083 4883C005 		addq	$5, %rax
 420              		.loc 3 142 17 discriminator 1
 421 0087 4839C2   		cmpq	%rax, %rdx
 422 008a 0F82A600 		jb	.L40
 422      0000
 143:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 144:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "buffer too small" ) );
 145:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
 146:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 147:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 148:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
 149:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * Secure renegotiation
 150:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
 151:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_RENEGOTIATION_INFO >> 8 ) & 0xFF );
 423              		.loc 3 151 7
 424 0090 488B45E8 		movq	-24(%rbp), %rax
 425 0094 488D5001 		leaq	1(%rax), %rdx
 426 0098 488955E8 		movq	%rdx, -24(%rbp)
 427              		.loc 3 151 10
 428 009c C600FF   		movb	$-1, (%rax)
 152:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_RENEGOTIATION_INFO      ) & 0xFF );
 429              		.loc 3 152 7
 430 009f 488B45E8 		movq	-24(%rbp), %rax
 431 00a3 488D5001 		leaq	1(%rax), %rdx
 432 00a7 488955E8 		movq	%rdx, -24(%rbp)
 433              		.loc 3 152 10
 434 00ab C60001   		movb	$1, (%rax)
 153:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 154:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = 0x00;
 435              		.loc 3 154 7
 436 00ae 488B45E8 		movq	-24(%rbp), %rax
 437 00b2 488D5001 		leaq	1(%rax), %rdx
 438 00b6 488955E8 		movq	%rdx, -24(%rbp)
 439              		.loc 3 154 10
 440 00ba C60000   		movb	$0, (%rax)
 155:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = ( ssl->verify_data_len + 1 ) & 0xFF;
 441              		.loc 3 155 17
 442 00bd 488B45D8 		movq	-40(%rbp), %rax
 443 00c1 488B8068 		movq	360(%rax), %rax
 443      010000
 444              		.loc 3 155 35
 445 00c8 89C1     		movl	%eax, %ecx
GAS LISTING /tmp/cc8psT5X.s 			page 35


 446              		.loc 3 155 7
 447 00ca 488B45E8 		movq	-24(%rbp), %rax
 448 00ce 488D5001 		leaq	1(%rax), %rdx
 449 00d2 488955E8 		movq	%rdx, -24(%rbp)
 450              		.loc 3 155 35
 451 00d6 8D5101   		leal	1(%rcx), %edx
 452              		.loc 3 155 10
 453 00d9 8810     		movb	%dl, (%rax)
 156:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = ssl->verify_data_len & 0xFF;
 454              		.loc 3 156 15
 455 00db 488B45D8 		movq	-40(%rbp), %rax
 456 00df 488B8868 		movq	360(%rax), %rcx
 456      010000
 457              		.loc 3 156 7
 458 00e6 488B45E8 		movq	-24(%rbp), %rax
 459 00ea 488D5001 		leaq	1(%rax), %rdx
 460 00ee 488955E8 		movq	%rdx, -24(%rbp)
 461              		.loc 3 156 10
 462 00f2 89CA     		movl	%ecx, %edx
 463 00f4 8810     		movb	%dl, (%rax)
 157:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 158:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     memcpy( p, ssl->own_verify_data, ssl->verify_data_len );
 464              		.loc 3 158 5
 465 00f6 488B45D8 		movq	-40(%rbp), %rax
 466 00fa 488B9068 		movq	360(%rax), %rdx
 466      010000
 467              		.loc 3 158 19
 468 0101 488B45D8 		movq	-40(%rbp), %rax
 469 0105 488D8870 		leaq	368(%rax), %rcx
 469      010000
 470              		.loc 3 158 5
 471 010c 488B45E8 		movq	-24(%rbp), %rax
 472 0110 4889CE   		movq	%rcx, %rsi
 473 0113 4889C7   		movq	%rax, %rdi
 474 0116 E8000000 		call	memcpy@PLT
 474      00
 159:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 160:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = 5 + ssl->verify_data_len;
 475              		.loc 3 160 20
 476 011b 488B45D8 		movq	-40(%rbp), %rax
 477 011f 488B8068 		movq	360(%rax), %rax
 477      010000
 478              		.loc 3 160 15
 479 0126 488D5005 		leaq	5(%rax), %rdx
 480              		.loc 3 160 11
 481 012a 488B45C8 		movq	-56(%rbp), %rax
 482 012e 488910   		movq	%rdx, (%rax)
 483 0131 EB04     		jmp	.L33
 484              	.L39:
 138:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 485              		.loc 3 138 9
 486 0133 90       		nop
 487 0134 EB01     		jmp	.L33
 488              	.L40:
 145:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 489              		.loc 3 145 9
 490 0136 90       		nop
GAS LISTING /tmp/cc8psT5X.s 			page 36


 491              	.L33:
 161:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 492              		.loc 3 161 1
 493 0137 488B45F8 		movq	-8(%rbp), %rax
 494 013b 64483304 		xorq	%fs:40, %rax
 494      25280000 
 494      00
 495 0144 7405     		je	.L38
 496 0146 E8000000 		call	__stack_chk_fail@PLT
 496      00
 497              	.L38:
 498 014b C9       		leave
 499              	.LCFI20:
 500              		.cfi_def_cfa 7, 8
 501 014c C3       		ret
 502              		.cfi_endproc
 503              	.LFE27:
 505              		.section	.text.ssl_write_signature_algorithms_ext,"ax",@progbits
 507              	ssl_write_signature_algorithms_ext:
 508              	.LFB28:
 162:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_RENEGOTIATION */
 163:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 164:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** /*
 165:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  * Only if we handle at least one key exchange that needs signatures.
 166:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  */
 167:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2) && \
 168:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
 169:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static void ssl_write_signature_algorithms_ext( mbedtls_ssl_context *ssl,
 170:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                                 unsigned char *buf,
 171:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                                 size_t *olen )
 172:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 509              		.loc 3 172 1
 510              		.cfi_startproc
 511 0000 F30F1EFA 		endbr64
 512 0004 55       		pushq	%rbp
 513              	.LCFI21:
 514              		.cfi_def_cfa_offset 16
 515              		.cfi_offset 6, -16
 516 0005 4889E5   		movq	%rsp, %rbp
 517              	.LCFI22:
 518              		.cfi_def_cfa_register 6
 519 0008 53       		pushq	%rbx
 520 0009 4883EC58 		subq	$88, %rsp
 521              		.cfi_offset 3, -24
 522 000d 48897DB8 		movq	%rdi, -72(%rbp)
 523 0011 488975B0 		movq	%rsi, -80(%rbp)
 524 0015 488955A8 		movq	%rdx, -88(%rbp)
 525              		.loc 3 172 1
 526 0019 64488B04 		movq	%fs:40, %rax
 526      25280000 
 526      00
 527 0022 488945E8 		movq	%rax, -24(%rbp)
 528 0026 31C0     		xorl	%eax, %eax
 173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char *p = buf;
 529              		.loc 3 173 20
 530 0028 488B45B0 		movq	-80(%rbp), %rax
 531 002c 488945D0 		movq	%rax, -48(%rbp)
GAS LISTING /tmp/cc8psT5X.s 			page 37


 174:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const unsigned char *end = ssl->out_msg + MBEDTLS_SSL_OUT_CONTENT_LEN;
 532              		.loc 3 174 35
 533 0030 488B45B8 		movq	-72(%rbp), %rax
 534 0034 488B8028 		movq	296(%rax), %rax
 534      010000
 535              		.loc 3 174 26
 536 003b 4805803E 		addq	$16000, %rax
 536      0000
 537 0041 488945D8 		movq	%rax, -40(%rbp)
 175:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     size_t sig_alg_len = 0;
 538              		.loc 3 175 12
 539 0045 48C745C0 		movq	$0, -64(%rbp)
 539      00000000 
 176:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const int *md;
 177:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_RSA_C) || defined(MBEDTLS_ECDSA_C)
 178:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char *sig_alg_list = buf + 6;
 540              		.loc 3 178 20
 541 004d 488B45B0 		movq	-80(%rbp), %rax
 542 0051 4883C006 		addq	$6, %rax
 543 0055 488945E0 		movq	%rax, -32(%rbp)
 179:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 180:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 181:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = 0;
 544              		.loc 3 181 11
 545 0059 488B45A8 		movq	-88(%rbp), %rax
 546 005d 48C70000 		movq	$0, (%rax)
 546      000000
 182:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 183:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->max_minor_ver != MBEDTLS_SSL_MINOR_VERSION_3 )
 547              		.loc 3 183 12
 548 0064 488B45B8 		movq	-72(%rbp), %rax
 549 0068 488B00   		movq	(%rax), %rax
 550              		.loc 3 183 18
 551 006b 0FB680B9 		movzbl	185(%rax), %eax
 551      000000
 552              		.loc 3 183 7
 553 0072 3C03     		cmpb	$3, %al
 554 0074 0F858A01 		jne	.L51
 554      0000
 184:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
 185:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 186:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "client hello, adding signature_algorithms extension" ) );
 187:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 188:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     for( md = ssl->conf->sig_hashes; *md != MBEDTLS_MD_NONE; md++ )
 555              		.loc 3 188 18
 556 007a 488B45B8 		movq	-72(%rbp), %rax
 557 007e 488B00   		movq	(%rax), %rax
 558              		.loc 3 188 13
 559 0081 488B8098 		movq	152(%rax), %rax
 559      000000
 560 0088 488945C8 		movq	%rax, -56(%rbp)
 561              		.loc 3 188 5
 562 008c EB0F     		jmp	.L44
 563              	.L45:
 189:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 190:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_ECDSA_C)
 191:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         sig_alg_len += 2;
GAS LISTING /tmp/cc8psT5X.s 			page 38


 564              		.loc 3 191 21 discriminator 3
 565 008e 488345C0 		addq	$2, -64(%rbp)
 565      02
 192:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 193:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_RSA_C)
 194:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         sig_alg_len += 2;
 566              		.loc 3 194 21 discriminator 3
 567 0093 488345C0 		addq	$2, -64(%rbp)
 567      02
 188:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 568              		.loc 3 188 64 discriminator 3
 569 0098 488345C8 		addq	$4, -56(%rbp)
 569      04
 570              	.L44:
 188:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 571              		.loc 3 188 38 discriminator 1
 572 009d 488B45C8 		movq	-56(%rbp), %rax
 573 00a1 8B00     		movl	(%rax), %eax
 188:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 574              		.loc 3 188 5 discriminator 1
 575 00a3 85C0     		testl	%eax, %eax
 576 00a5 75E7     		jne	.L45
 195:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 196:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 197:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 198:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( end < p || (size_t)( end - p ) < sig_alg_len + 6 )
 577              		.loc 3 198 7
 578 00a7 488B45D8 		movq	-40(%rbp), %rax
 579 00ab 483B45D0 		cmpq	-48(%rbp), %rax
 580 00af 0F825201 		jb	.L52
 580      0000
 581              		.loc 3 198 34 discriminator 1
 582 00b5 488B45D8 		movq	-40(%rbp), %rax
 583 00b9 482B45D0 		subq	-48(%rbp), %rax
 584              		.loc 3 198 20 discriminator 1
 585 00bd 4889C2   		movq	%rax, %rdx
 586              		.loc 3 198 54 discriminator 1
 587 00c0 488B45C0 		movq	-64(%rbp), %rax
 588 00c4 4883C006 		addq	$6, %rax
 589              		.loc 3 198 17 discriminator 1
 590 00c8 4839C2   		cmpq	%rax, %rdx
 591 00cb 0F823601 		jb	.L52
 591      0000
 199:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "buffer too small" ) );
 201:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
 202:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 203:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 204:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
 205:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * Prepare signature_algorithms extension (TLS 1.2)
 206:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
 207:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     sig_alg_len = 0;
 592              		.loc 3 207 17
 593 00d1 48C745C0 		movq	$0, -64(%rbp)
 593      00000000 
 208:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 209:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     for( md = ssl->conf->sig_hashes; *md != MBEDTLS_MD_NONE; md++ )
GAS LISTING /tmp/cc8psT5X.s 			page 39


 594              		.loc 3 209 18
 595 00d9 488B45B8 		movq	-72(%rbp), %rax
 596 00dd 488B00   		movq	(%rax), %rax
 597              		.loc 3 209 13
 598 00e0 488B8098 		movq	152(%rax), %rax
 598      000000
 599 00e7 488945C8 		movq	%rax, -56(%rbp)
 600              		.loc 3 209 5
 601 00eb EB77     		jmp	.L48
 602              	.L49:
 210:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 211:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_ECDSA_C)
 212:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         sig_alg_list[sig_alg_len++] = mbedtls_ssl_hash_from_md_alg( *md );
 603              		.loc 3 212 39 discriminator 3
 604 00ed 488B45C8 		movq	-56(%rbp), %rax
 605 00f1 8B10     		movl	(%rax), %edx
 606              		.loc 3 212 33 discriminator 3
 607 00f3 488B45C0 		movq	-64(%rbp), %rax
 608 00f7 488D4801 		leaq	1(%rax), %rcx
 609 00fb 48894DC0 		movq	%rcx, -64(%rbp)
 610              		.loc 3 212 21 discriminator 3
 611 00ff 488B4DE0 		movq	-32(%rbp), %rcx
 612 0103 488D1C08 		leaq	(%rax,%rcx), %rbx
 613              		.loc 3 212 39 discriminator 3
 614 0107 89D7     		movl	%edx, %edi
 615 0109 E8000000 		call	mbedtls_ssl_hash_from_md_alg@PLT
 615      00
 616              		.loc 3 212 37 discriminator 3
 617 010e 8803     		movb	%al, (%rbx)
 213:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         sig_alg_list[sig_alg_len++] = MBEDTLS_SSL_SIG_ECDSA;
 618              		.loc 3 213 33 discriminator 3
 619 0110 488B45C0 		movq	-64(%rbp), %rax
 620 0114 488D5001 		leaq	1(%rax), %rdx
 621 0118 488955C0 		movq	%rdx, -64(%rbp)
 622              		.loc 3 213 21 discriminator 3
 623 011c 488B55E0 		movq	-32(%rbp), %rdx
 624 0120 4801D0   		addq	%rdx, %rax
 625              		.loc 3 213 37 discriminator 3
 626 0123 C60003   		movb	$3, (%rax)
 214:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 215:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_RSA_C)
 216:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         sig_alg_list[sig_alg_len++] = mbedtls_ssl_hash_from_md_alg( *md );
 627              		.loc 3 216 39 discriminator 3
 628 0126 488B45C8 		movq	-56(%rbp), %rax
 629 012a 8B10     		movl	(%rax), %edx
 630              		.loc 3 216 33 discriminator 3
 631 012c 488B45C0 		movq	-64(%rbp), %rax
 632 0130 488D4801 		leaq	1(%rax), %rcx
 633 0134 48894DC0 		movq	%rcx, -64(%rbp)
 634              		.loc 3 216 21 discriminator 3
 635 0138 488B4DE0 		movq	-32(%rbp), %rcx
 636 013c 488D1C08 		leaq	(%rax,%rcx), %rbx
 637              		.loc 3 216 39 discriminator 3
 638 0140 89D7     		movl	%edx, %edi
 639 0142 E8000000 		call	mbedtls_ssl_hash_from_md_alg@PLT
 639      00
 640              		.loc 3 216 37 discriminator 3
GAS LISTING /tmp/cc8psT5X.s 			page 40


 641 0147 8803     		movb	%al, (%rbx)
 217:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         sig_alg_list[sig_alg_len++] = MBEDTLS_SSL_SIG_RSA;
 642              		.loc 3 217 33 discriminator 3
 643 0149 488B45C0 		movq	-64(%rbp), %rax
 644 014d 488D5001 		leaq	1(%rax), %rdx
 645 0151 488955C0 		movq	%rdx, -64(%rbp)
 646              		.loc 3 217 21 discriminator 3
 647 0155 488B55E0 		movq	-32(%rbp), %rdx
 648 0159 4801D0   		addq	%rdx, %rax
 649              		.loc 3 217 37 discriminator 3
 650 015c C60001   		movb	$1, (%rax)
 209:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 651              		.loc 3 209 64 discriminator 3
 652 015f 488345C8 		addq	$4, -56(%rbp)
 652      04
 653              	.L48:
 209:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 654              		.loc 3 209 38 discriminator 1
 655 0164 488B45C8 		movq	-56(%rbp), %rax
 656 0168 8B00     		movl	(%rax), %eax
 209:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 657              		.loc 3 209 5 discriminator 1
 658 016a 85C0     		testl	%eax, %eax
 659 016c 0F857BFF 		jne	.L49
 659      FFFF
 218:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 219:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 220:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 221:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
 222:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * enum {
 223:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     none(0), md5(1), sha1(2), sha224(3), sha256(4), sha384(5),
 224:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     sha512(6), (255)
 225:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * } HashAlgorithm;
 226:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *
 227:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * enum { anonymous(0), rsa(1), dsa(2), ecdsa(3), (255) }
 228:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *   SignatureAlgorithm;
 229:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *
 230:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * struct {
 231:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     HashAlgorithm hash;
 232:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     SignatureAlgorithm signature;
 233:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * } SignatureAndHashAlgorithm;
 234:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *
 235:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * SignatureAndHashAlgorithm
 236:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *   supported_signature_algorithms<2..2^16-2>;
 237:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
 238:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_SIG_ALG >> 8 ) & 0xFF );
 660              		.loc 3 238 7
 661 0172 488B45D0 		movq	-48(%rbp), %rax
 662 0176 488D5001 		leaq	1(%rax), %rdx
 663 017a 488955D0 		movq	%rdx, -48(%rbp)
 664              		.loc 3 238 10
 665 017e C60000   		movb	$0, (%rax)
 239:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_SIG_ALG      ) & 0xFF );
 666              		.loc 3 239 7
 667 0181 488B45D0 		movq	-48(%rbp), %rax
 668 0185 488D5001 		leaq	1(%rax), %rdx
 669 0189 488955D0 		movq	%rdx, -48(%rbp)
GAS LISTING /tmp/cc8psT5X.s 			page 41


 670              		.loc 3 239 10
 671 018d C6000D   		movb	$13, (%rax)
 240:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 241:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( ( sig_alg_len + 2 ) >> 8 ) & 0xFF );
 672              		.loc 3 241 45
 673 0190 488B45C0 		movq	-64(%rbp), %rax
 674 0194 4883C002 		addq	$2, %rax
 675              		.loc 3 241 51
 676 0198 48C1E808 		shrq	$8, %rax
 677 019c 4889C1   		movq	%rax, %rcx
 678              		.loc 3 241 7
 679 019f 488B45D0 		movq	-48(%rbp), %rax
 680 01a3 488D5001 		leaq	1(%rax), %rdx
 681 01a7 488955D0 		movq	%rdx, -48(%rbp)
 682              		.loc 3 241 12
 683 01ab 89CA     		movl	%ecx, %edx
 684              		.loc 3 241 10
 685 01ad 8810     		movb	%dl, (%rax)
 242:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( ( sig_alg_len + 2 )      ) & 0xFF );
 686              		.loc 3 242 12
 687 01af 488B45C0 		movq	-64(%rbp), %rax
 688 01b3 89C1     		movl	%eax, %ecx
 689              		.loc 3 242 7
 690 01b5 488B45D0 		movq	-48(%rbp), %rax
 691 01b9 488D5001 		leaq	1(%rax), %rdx
 692 01bd 488955D0 		movq	%rdx, -48(%rbp)
 693              		.loc 3 242 12
 694 01c1 8D5102   		leal	2(%rcx), %edx
 695              		.loc 3 242 10
 696 01c4 8810     		movb	%dl, (%rax)
 243:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 244:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( sig_alg_len >> 8 ) & 0xFF );
 697              		.loc 3 244 43
 698 01c6 488B45C0 		movq	-64(%rbp), %rax
 699 01ca 48C1E808 		shrq	$8, %rax
 700 01ce 4889C1   		movq	%rax, %rcx
 701              		.loc 3 244 7
 702 01d1 488B45D0 		movq	-48(%rbp), %rax
 703 01d5 488D5001 		leaq	1(%rax), %rdx
 704 01d9 488955D0 		movq	%rdx, -48(%rbp)
 705              		.loc 3 244 12
 706 01dd 89CA     		movl	%ecx, %edx
 707              		.loc 3 244 10
 708 01df 8810     		movb	%dl, (%rax)
 245:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( sig_alg_len      ) & 0xFF );
 709              		.loc 3 245 7
 710 01e1 488B45D0 		movq	-48(%rbp), %rax
 711 01e5 488D5001 		leaq	1(%rax), %rdx
 712 01e9 488955D0 		movq	%rdx, -48(%rbp)
 713              		.loc 3 245 12
 714 01ed 488B55C0 		movq	-64(%rbp), %rdx
 715              		.loc 3 245 10
 716 01f1 8810     		movb	%dl, (%rax)
 246:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 247:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = 6 + sig_alg_len;
 717              		.loc 3 247 15
 718 01f3 488B45C0 		movq	-64(%rbp), %rax
GAS LISTING /tmp/cc8psT5X.s 			page 42


 719 01f7 488D5006 		leaq	6(%rax), %rdx
 720              		.loc 3 247 11
 721 01fb 488B45A8 		movq	-88(%rbp), %rax
 722 01ff 488910   		movq	%rdx, (%rax)
 723 0202 EB04     		jmp	.L41
 724              	.L51:
 184:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 725              		.loc 3 184 9
 726 0204 90       		nop
 727 0205 EB01     		jmp	.L41
 728              	.L52:
 201:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 729              		.loc 3 201 9
 730 0207 90       		nop
 731              	.L41:
 248:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 732              		.loc 3 248 1
 733 0208 488B45E8 		movq	-24(%rbp), %rax
 734 020c 64483304 		xorq	%fs:40, %rax
 734      25280000 
 734      00
 735 0215 7405     		je	.L50
 736 0217 E8000000 		call	__stack_chk_fail@PLT
 736      00
 737              	.L50:
 738 021c 4883C458 		addq	$88, %rsp
 739 0220 5B       		popq	%rbx
 740 0221 5D       		popq	%rbp
 741              	.LCFI23:
 742              		.cfi_def_cfa 7, 8
 743 0222 C3       		ret
 744              		.cfi_endproc
 745              	.LFE28:
 747              		.section	.text.ssl_write_supported_elliptic_curves_ext,"ax",@progbits
 749              	ssl_write_supported_elliptic_curves_ext:
 750              	.LFB29:
 249:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 &&
 250:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED */
 251:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 252:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_ECDH_C) || defined(MBEDTLS_ECDSA_C) || \
 253:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
 254:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static void ssl_write_supported_elliptic_curves_ext( mbedtls_ssl_context *ssl,
 255:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                                      unsigned char *buf,
 256:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                                      size_t *olen )
 257:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 751              		.loc 3 257 1
 752              		.cfi_startproc
 753 0000 F30F1EFA 		endbr64
 754 0004 55       		pushq	%rbp
 755              	.LCFI24:
 756              		.cfi_def_cfa_offset 16
 757              		.cfi_offset 6, -16
 758 0005 4889E5   		movq	%rsp, %rbp
 759              	.LCFI25:
 760              		.cfi_def_cfa_register 6
 761 0008 4883EC60 		subq	$96, %rsp
 762 000c 48897DB8 		movq	%rdi, -72(%rbp)
GAS LISTING /tmp/cc8psT5X.s 			page 43


 763 0010 488975B0 		movq	%rsi, -80(%rbp)
 764 0014 488955A8 		movq	%rdx, -88(%rbp)
 765              		.loc 3 257 1
 766 0018 64488B04 		movq	%fs:40, %rax
 766      25280000 
 766      00
 767 0021 488945F8 		movq	%rax, -8(%rbp)
 768 0025 31C0     		xorl	%eax, %eax
 258:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char *p = buf;
 769              		.loc 3 258 20
 770 0027 488B45B0 		movq	-80(%rbp), %rax
 771 002b 488945D8 		movq	%rax, -40(%rbp)
 259:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const unsigned char *end = ssl->out_msg + MBEDTLS_SSL_OUT_CONTENT_LEN;
 772              		.loc 3 259 35
 773 002f 488B45B8 		movq	-72(%rbp), %rax
 774 0033 488B8028 		movq	296(%rax), %rax
 774      010000
 775              		.loc 3 259 26
 776 003a 4805803E 		addq	$16000, %rax
 776      0000
 777 0040 488945E0 		movq	%rax, -32(%rbp)
 260:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char *elliptic_curve_list = p + 6;
 778              		.loc 3 260 20
 779 0044 488B45D8 		movq	-40(%rbp), %rax
 780 0048 4883C006 		addq	$6, %rax
 781 004c 488945E8 		movq	%rax, -24(%rbp)
 261:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     size_t elliptic_curve_len = 0;
 782              		.loc 3 261 12
 783 0050 48C745C8 		movq	$0, -56(%rbp)
 783      00000000 
 262:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const mbedtls_ecp_curve_info *info;
 263:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_ECP_C)
 264:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const mbedtls_ecp_group_id *grp_id;
 265:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #else
 266:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ((void) ssl);
 267:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 268:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 269:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = 0;
 784              		.loc 3 269 11
 785 0058 488B45A8 		movq	-88(%rbp), %rax
 786 005c 48C70000 		movq	$0, (%rax)
 786      000000
 270:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 271:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "client hello, adding supported_elliptic_curves extension" ) );
 272:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 273:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_ECP_C)
 274:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     for( grp_id = ssl->conf->curve_list; *grp_id != MBEDTLS_ECP_DP_NONE; grp_id++ )
 787              		.loc 3 274 22
 788 0063 488B45B8 		movq	-72(%rbp), %rax
 789 0067 488B00   		movq	(%rax), %rax
 790              		.loc 3 274 17
 791 006a 488B80A0 		movq	160(%rax), %rax
 791      000000
 792 0071 488945D0 		movq	%rax, -48(%rbp)
 793              		.loc 3 274 5
 794 0075 EB26     		jmp	.L54
 795              	.L57:
GAS LISTING /tmp/cc8psT5X.s 			page 44


 275:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #else
 276:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     for( info = mbedtls_ecp_curve_list(); info->grp_id != MBEDTLS_ECP_DP_NONE; info++ )
 277:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 278:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 279:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_ECP_C)
 280:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         info = mbedtls_ecp_curve_info_from_grp_id( *grp_id );
 796              		.loc 3 280 16
 797 0077 488B45D0 		movq	-48(%rbp), %rax
 798 007b 8B00     		movl	(%rax), %eax
 799 007d 89C7     		movl	%eax, %edi
 800 007f E8000000 		call	mbedtls_ecp_curve_info_from_grp_id@PLT
 800      00
 801 0084 488945F0 		movq	%rax, -16(%rbp)
 281:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 282:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( info == NULL )
 802              		.loc 3 282 11
 803 0088 48837DF0 		cmpq	$0, -16(%rbp)
 803      00
 804 008d 0F845B01 		je	.L64
 804      0000
 283:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
 284:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "invalid curve in ssl configuration" ) );
 285:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return;
 286:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
 287:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 288:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         elliptic_curve_len += 2;
 805              		.loc 3 288 28 discriminator 2
 806 0093 488345C8 		addq	$2, -56(%rbp)
 806      02
 274:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #else
 807              		.loc 3 274 80 discriminator 2
 808 0098 488345D0 		addq	$4, -48(%rbp)
 808      04
 809              	.L54:
 274:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #else
 810              		.loc 3 274 42 discriminator 1
 811 009d 488B45D0 		movq	-48(%rbp), %rax
 812 00a1 8B00     		movl	(%rax), %eax
 274:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #else
 813              		.loc 3 274 5 discriminator 1
 814 00a3 85C0     		testl	%eax, %eax
 815 00a5 75D0     		jne	.L57
 289:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 290:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 291:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( end < p || (size_t)( end - p ) < 6 + elliptic_curve_len )
 816              		.loc 3 291 7
 817 00a7 488B45E0 		movq	-32(%rbp), %rax
 818 00ab 483B45D8 		cmpq	-40(%rbp), %rax
 819 00af 0F823C01 		jb	.L65
 819      0000
 820              		.loc 3 291 34 discriminator 1
 821 00b5 488B45E0 		movq	-32(%rbp), %rax
 822 00b9 482B45D8 		subq	-40(%rbp), %rax
 823              		.loc 3 291 20 discriminator 1
 824 00bd 4889C2   		movq	%rax, %rdx
 825              		.loc 3 291 44 discriminator 1
 826 00c0 488B45C8 		movq	-56(%rbp), %rax
GAS LISTING /tmp/cc8psT5X.s 			page 45


 827 00c4 4883C006 		addq	$6, %rax
 828              		.loc 3 291 17 discriminator 1
 829 00c8 4839C2   		cmpq	%rax, %rdx
 830 00cb 0F822001 		jb	.L65
 830      0000
 292:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 293:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "buffer too small" ) );
 294:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
 295:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 296:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 297:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     elliptic_curve_len = 0;
 831              		.loc 3 297 24
 832 00d1 48C745C8 		movq	$0, -56(%rbp)
 832      00000000 
 298:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 299:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_ECP_C)
 300:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     for( grp_id = ssl->conf->curve_list; *grp_id != MBEDTLS_ECP_DP_NONE; grp_id++ )
 833              		.loc 3 300 22
 834 00d9 488B45B8 		movq	-72(%rbp), %rax
 835 00dd 488B00   		movq	(%rax), %rax
 836              		.loc 3 300 17
 837 00e0 488B80A0 		movq	160(%rax), %rax
 837      000000
 838 00e7 488945D0 		movq	%rax, -48(%rbp)
 839              		.loc 3 300 5
 840 00eb EB5A     		jmp	.L60
 841              	.L61:
 301:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #else
 302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     for( info = mbedtls_ecp_curve_list(); info->grp_id != MBEDTLS_ECP_DP_NONE; info++ )
 303:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 304:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 305:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_ECP_C)
 306:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         info = mbedtls_ecp_curve_info_from_grp_id( *grp_id );
 842              		.loc 3 306 16 discriminator 3
 843 00ed 488B45D0 		movq	-48(%rbp), %rax
 844 00f1 8B00     		movl	(%rax), %eax
 845 00f3 89C7     		movl	%eax, %edi
 846 00f5 E8000000 		call	mbedtls_ecp_curve_info_from_grp_id@PLT
 846      00
 847 00fa 488945F0 		movq	%rax, -16(%rbp)
 307:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 308:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         elliptic_curve_list[elliptic_curve_len++] = info->tls_id >> 8;
 848              		.loc 3 308 57 discriminator 3
 849 00fe 488B45F0 		movq	-16(%rbp), %rax
 850 0102 0FB74004 		movzwl	4(%rax), %eax
 851              		.loc 3 308 51 discriminator 3
 852 0106 66C1E808 		shrw	$8, %ax
 853 010a 89C1     		movl	%eax, %ecx
 854              		.loc 3 308 47 discriminator 3
 855 010c 488B45C8 		movq	-56(%rbp), %rax
 856 0110 488D5001 		leaq	1(%rax), %rdx
 857 0114 488955C8 		movq	%rdx, -56(%rbp)
 858              		.loc 3 308 28 discriminator 3
 859 0118 488B55E8 		movq	-24(%rbp), %rdx
 860 011c 4801D0   		addq	%rdx, %rax
 861              		.loc 3 308 51 discriminator 3
 862 011f 89CA     		movl	%ecx, %edx
GAS LISTING /tmp/cc8psT5X.s 			page 46


 863 0121 8810     		movb	%dl, (%rax)
 309:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         elliptic_curve_list[elliptic_curve_len++] = info->tls_id & 0xFF;
 864              		.loc 3 309 57 discriminator 3
 865 0123 488B45F0 		movq	-16(%rbp), %rax
 866 0127 0FB74804 		movzwl	4(%rax), %ecx
 867              		.loc 3 309 47 discriminator 3
 868 012b 488B45C8 		movq	-56(%rbp), %rax
 869 012f 488D5001 		leaq	1(%rax), %rdx
 870 0133 488955C8 		movq	%rdx, -56(%rbp)
 871              		.loc 3 309 28 discriminator 3
 872 0137 488B55E8 		movq	-24(%rbp), %rdx
 873 013b 4801D0   		addq	%rdx, %rax
 874              		.loc 3 309 51 discriminator 3
 875 013e 89CA     		movl	%ecx, %edx
 876 0140 8810     		movb	%dl, (%rax)
 300:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #else
 877              		.loc 3 300 80 discriminator 3
 878 0142 488345D0 		addq	$4, -48(%rbp)
 878      04
 879              	.L60:
 300:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #else
 880              		.loc 3 300 42 discriminator 1
 881 0147 488B45D0 		movq	-48(%rbp), %rax
 882 014b 8B00     		movl	(%rax), %eax
 300:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #else
 883              		.loc 3 300 5 discriminator 1
 884 014d 85C0     		testl	%eax, %eax
 885 014f 759C     		jne	.L61
 310:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 311:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 312:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( elliptic_curve_len == 0 )
 886              		.loc 3 312 7
 887 0151 48837DC8 		cmpq	$0, -56(%rbp)
 887      00
 888 0156 0F849800 		je	.L66
 888      0000
 313:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
 314:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 315:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_SUPPORTED_ELLIPTIC_CURVES >> 8 ) & 0xFF );
 889              		.loc 3 315 7
 890 015c 488B45D8 		movq	-40(%rbp), %rax
 891 0160 488D5001 		leaq	1(%rax), %rdx
 892 0164 488955D8 		movq	%rdx, -40(%rbp)
 893              		.loc 3 315 10
 894 0168 C60000   		movb	$0, (%rax)
 316:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_SUPPORTED_ELLIPTIC_CURVES      ) & 0xFF );
 895              		.loc 3 316 7
 896 016b 488B45D8 		movq	-40(%rbp), %rax
 897 016f 488D5001 		leaq	1(%rax), %rdx
 898 0173 488955D8 		movq	%rdx, -40(%rbp)
 899              		.loc 3 316 10
 900 0177 C6000A   		movb	$10, (%rax)
 317:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 318:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( ( elliptic_curve_len + 2 ) >> 8 ) & 0xFF );
 901              		.loc 3 318 52
 902 017a 488B45C8 		movq	-56(%rbp), %rax
 903 017e 4883C002 		addq	$2, %rax
GAS LISTING /tmp/cc8psT5X.s 			page 47


 904              		.loc 3 318 58
 905 0182 48C1E808 		shrq	$8, %rax
 906 0186 4889C1   		movq	%rax, %rcx
 907              		.loc 3 318 7
 908 0189 488B45D8 		movq	-40(%rbp), %rax
 909 018d 488D5001 		leaq	1(%rax), %rdx
 910 0191 488955D8 		movq	%rdx, -40(%rbp)
 911              		.loc 3 318 12
 912 0195 89CA     		movl	%ecx, %edx
 913              		.loc 3 318 10
 914 0197 8810     		movb	%dl, (%rax)
 319:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( ( elliptic_curve_len + 2 )      ) & 0xFF );
 915              		.loc 3 319 12
 916 0199 488B45C8 		movq	-56(%rbp), %rax
 917 019d 89C1     		movl	%eax, %ecx
 918              		.loc 3 319 7
 919 019f 488B45D8 		movq	-40(%rbp), %rax
 920 01a3 488D5001 		leaq	1(%rax), %rdx
 921 01a7 488955D8 		movq	%rdx, -40(%rbp)
 922              		.loc 3 319 12
 923 01ab 8D5102   		leal	2(%rcx), %edx
 924              		.loc 3 319 10
 925 01ae 8810     		movb	%dl, (%rax)
 320:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 321:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( ( elliptic_curve_len     ) >> 8 ) & 0xFF );
 926              		.loc 3 321 58
 927 01b0 488B45C8 		movq	-56(%rbp), %rax
 928 01b4 48C1E808 		shrq	$8, %rax
 929 01b8 4889C1   		movq	%rax, %rcx
 930              		.loc 3 321 7
 931 01bb 488B45D8 		movq	-40(%rbp), %rax
 932 01bf 488D5001 		leaq	1(%rax), %rdx
 933 01c3 488955D8 		movq	%rdx, -40(%rbp)
 934              		.loc 3 321 12
 935 01c7 89CA     		movl	%ecx, %edx
 936              		.loc 3 321 10
 937 01c9 8810     		movb	%dl, (%rax)
 322:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( ( elliptic_curve_len     )      ) & 0xFF );
 938              		.loc 3 322 7
 939 01cb 488B45D8 		movq	-40(%rbp), %rax
 940 01cf 488D5001 		leaq	1(%rax), %rdx
 941 01d3 488955D8 		movq	%rdx, -40(%rbp)
 942              		.loc 3 322 12
 943 01d7 488B55C8 		movq	-56(%rbp), %rdx
 944              		.loc 3 322 10
 945 01db 8810     		movb	%dl, (%rax)
 323:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 324:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = 6 + elliptic_curve_len;
 946              		.loc 3 324 15
 947 01dd 488B45C8 		movq	-56(%rbp), %rax
 948 01e1 488D5006 		leaq	6(%rax), %rdx
 949              		.loc 3 324 11
 950 01e5 488B45A8 		movq	-88(%rbp), %rax
 951 01e9 488910   		movq	%rdx, (%rax)
 952 01ec EB07     		jmp	.L53
 953              	.L64:
 285:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
GAS LISTING /tmp/cc8psT5X.s 			page 48


 954              		.loc 3 285 13
 955 01ee 90       		nop
 956 01ef EB04     		jmp	.L53
 957              	.L65:
 294:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 958              		.loc 3 294 9
 959 01f1 90       		nop
 960 01f2 EB01     		jmp	.L53
 961              	.L66:
 313:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 962              		.loc 3 313 9
 963 01f4 90       		nop
 964              	.L53:
 325:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 965              		.loc 3 325 1
 966 01f5 488B45F8 		movq	-8(%rbp), %rax
 967 01f9 64483304 		xorq	%fs:40, %rax
 967      25280000 
 967      00
 968 0202 7405     		je	.L63
 969 0204 E8000000 		call	__stack_chk_fail@PLT
 969      00
 970              	.L63:
 971 0209 C9       		leave
 972              	.LCFI26:
 973              		.cfi_def_cfa 7, 8
 974 020a C3       		ret
 975              		.cfi_endproc
 976              	.LFE29:
 978              		.section	.text.ssl_write_supported_point_formats_ext,"ax",@progbits
 980              	ssl_write_supported_point_formats_ext:
 981              	.LFB30:
 326:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 327:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static void ssl_write_supported_point_formats_ext( mbedtls_ssl_context *ssl,
 328:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                                    unsigned char *buf,
 329:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                                    size_t *olen )
 330:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 982              		.loc 3 330 1
 983              		.cfi_startproc
 984 0000 F30F1EFA 		endbr64
 985 0004 55       		pushq	%rbp
 986              	.LCFI27:
 987              		.cfi_def_cfa_offset 16
 988              		.cfi_offset 6, -16
 989 0005 4889E5   		movq	%rsp, %rbp
 990              	.LCFI28:
 991              		.cfi_def_cfa_register 6
 992 0008 4883EC40 		subq	$64, %rsp
 993 000c 48897DD8 		movq	%rdi, -40(%rbp)
 994 0010 488975D0 		movq	%rsi, -48(%rbp)
 995 0014 488955C8 		movq	%rdx, -56(%rbp)
 996              		.loc 3 330 1
 997 0018 64488B04 		movq	%fs:40, %rax
 997      25280000 
 997      00
 998 0021 488945F8 		movq	%rax, -8(%rbp)
 999 0025 31C0     		xorl	%eax, %eax
GAS LISTING /tmp/cc8psT5X.s 			page 49


 331:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char *p = buf;
 1000              		.loc 3 331 20
 1001 0027 488B45D0 		movq	-48(%rbp), %rax
 1002 002b 488945E8 		movq	%rax, -24(%rbp)
 332:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const unsigned char *end = ssl->out_msg + MBEDTLS_SSL_OUT_CONTENT_LEN;
 1003              		.loc 3 332 35
 1004 002f 488B45D8 		movq	-40(%rbp), %rax
 1005 0033 488B8028 		movq	296(%rax), %rax
 1005      010000
 1006              		.loc 3 332 26
 1007 003a 4805803E 		addq	$16000, %rax
 1007      0000
 1008 0040 488945F0 		movq	%rax, -16(%rbp)
 333:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 334:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = 0;
 1009              		.loc 3 334 11
 1010 0044 488B45C8 		movq	-56(%rbp), %rax
 1011 0048 48C70000 		movq	$0, (%rax)
 1011      000000
 335:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 336:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "client hello, adding supported_point_formats extension" ) );
 337:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 338:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( end < p || (size_t)( end - p ) < 6 )
 1012              		.loc 3 338 7
 1013 004f 488B45F0 		movq	-16(%rbp), %rax
 1014 0053 483B45E8 		cmpq	-24(%rbp), %rax
 1015 0057 7275     		jb	.L72
 1016              		.loc 3 338 34 discriminator 1
 1017 0059 488B45F0 		movq	-16(%rbp), %rax
 1018 005d 482B45E8 		subq	-24(%rbp), %rax
 1019              		.loc 3 338 17 discriminator 1
 1020 0061 4883F805 		cmpq	$5, %rax
 1021 0065 7667     		jbe	.L72
 339:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 340:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "buffer too small" ) );
 341:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
 342:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 343:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 344:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_SUPPORTED_POINT_FORMATS >> 8 ) & 0xFF );
 1022              		.loc 3 344 7
 1023 0067 488B45E8 		movq	-24(%rbp), %rax
 1024 006b 488D5001 		leaq	1(%rax), %rdx
 1025 006f 488955E8 		movq	%rdx, -24(%rbp)
 1026              		.loc 3 344 10
 1027 0073 C60000   		movb	$0, (%rax)
 345:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_SUPPORTED_POINT_FORMATS      ) & 0xFF );
 1028              		.loc 3 345 7
 1029 0076 488B45E8 		movq	-24(%rbp), %rax
 1030 007a 488D5001 		leaq	1(%rax), %rdx
 1031 007e 488955E8 		movq	%rdx, -24(%rbp)
 1032              		.loc 3 345 10
 1033 0082 C6000B   		movb	$11, (%rax)
 346:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 347:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = 0x00;
 1034              		.loc 3 347 7
 1035 0085 488B45E8 		movq	-24(%rbp), %rax
 1036 0089 488D5001 		leaq	1(%rax), %rdx
GAS LISTING /tmp/cc8psT5X.s 			page 50


 1037 008d 488955E8 		movq	%rdx, -24(%rbp)
 1038              		.loc 3 347 10
 1039 0091 C60000   		movb	$0, (%rax)
 348:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = 2;
 1040              		.loc 3 348 7
 1041 0094 488B45E8 		movq	-24(%rbp), %rax
 1042 0098 488D5001 		leaq	1(%rax), %rdx
 1043 009c 488955E8 		movq	%rdx, -24(%rbp)
 1044              		.loc 3 348 10
 1045 00a0 C60002   		movb	$2, (%rax)
 349:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 350:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = 1;
 1046              		.loc 3 350 7
 1047 00a3 488B45E8 		movq	-24(%rbp), %rax
 1048 00a7 488D5001 		leaq	1(%rax), %rdx
 1049 00ab 488955E8 		movq	%rdx, -24(%rbp)
 1050              		.loc 3 350 10
 1051 00af C60001   		movb	$1, (%rax)
 351:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = MBEDTLS_ECP_PF_UNCOMPRESSED;
 1052              		.loc 3 351 7
 1053 00b2 488B45E8 		movq	-24(%rbp), %rax
 1054 00b6 488D5001 		leaq	1(%rax), %rdx
 1055 00ba 488955E8 		movq	%rdx, -24(%rbp)
 1056              		.loc 3 351 10
 1057 00be C60000   		movb	$0, (%rax)
 352:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 353:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = 6;
 1058              		.loc 3 353 11
 1059 00c1 488B45C8 		movq	-56(%rbp), %rax
 1060 00c5 48C70006 		movq	$6, (%rax)
 1060      000000
 1061 00cc EB01     		jmp	.L67
 1062              	.L72:
 341:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 1063              		.loc 3 341 9
 1064 00ce 90       		nop
 1065              	.L67:
 354:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 1066              		.loc 3 354 1
 1067 00cf 488B45F8 		movq	-8(%rbp), %rax
 1068 00d3 64483304 		xorq	%fs:40, %rax
 1068      25280000 
 1068      00
 1069 00dc 7405     		je	.L71
 1070 00de E8000000 		call	__stack_chk_fail@PLT
 1070      00
 1071              	.L71:
 1072 00e3 C9       		leave
 1073              	.LCFI29:
 1074              		.cfi_def_cfa 7, 8
 1075 00e4 C3       		ret
 1076              		.cfi_endproc
 1077              	.LFE30:
 1079              		.section	.text.ssl_write_max_fragment_length_ext,"ax",@progbits
 1081              	ssl_write_max_fragment_length_ext:
 1082              	.LFB31:
 355:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_ECDH_C || MBEDTLS_ECDSA_C ||
GAS LISTING /tmp/cc8psT5X.s 			page 51


 356:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED */
 357:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 358:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
 359:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static void ssl_write_ecjpake_kkpp_ext( mbedtls_ssl_context *ssl,
 360:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         unsigned char *buf,
 361:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         size_t *olen )
 362:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 363:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     int ret;
 364:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char *p = buf;
 365:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const unsigned char *end = ssl->out_msg + MBEDTLS_SSL_OUT_CONTENT_LEN;
 366:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     size_t kkpp_len;
 367:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 368:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = 0;
 369:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 370:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /* Skip costly extension if we can't use EC J-PAKE anyway */
 371:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( mbedtls_ecjpake_check( &ssl->handshake->ecjpake_ctx ) != 0 )
 372:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
 373:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 374:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "client hello, adding ecjpake_kkpp extension" ) );
 375:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 376:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( end - p < 4 )
 377:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 378:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "buffer too small" ) );
 379:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
 380:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 381:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 382:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_ECJPAKE_KKPP >> 8 ) & 0xFF );
 383:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_ECJPAKE_KKPP      ) & 0xFF );
 384:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 385:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
 386:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * We may need to send ClientHello multiple times for Hello verification.
 387:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * We don't want to compute fresh values every time (both for performance
 388:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * and consistency reasons), so cache the extension content.
 389:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
 390:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->handshake->ecjpake_cache == NULL ||
 391:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->handshake->ecjpake_cache_len == 0 )
 392:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 393:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "generating new ecjpake parameters" ) );
 394:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 395:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ret = mbedtls_ecjpake_write_round_one( &ssl->handshake->ecjpake_ctx,
 396:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         p + 2, end - p - 2, &kkpp_len,
 397:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         ssl->conf->f_rng, ssl->conf->p_rng );
 398:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ret != 0 )
 399:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
 400:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_RET( 1 , "mbedtls_ecjpake_write_round_one", ret );
 401:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return;
 402:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
 403:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 404:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->handshake->ecjpake_cache = mbedtls_calloc( 1, kkpp_len );
 405:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ssl->handshake->ecjpake_cache == NULL )
 406:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
 407:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "allocation failed" ) );
 408:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return;
 409:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
 410:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 411:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         memcpy( ssl->handshake->ecjpake_cache, p + 2, kkpp_len );
 412:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->handshake->ecjpake_cache_len = kkpp_len;
GAS LISTING /tmp/cc8psT5X.s 			page 52


 413:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 414:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     else
 415:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 416:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "re-using cached ecjpake parameters" ) );
 417:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 418:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         kkpp_len = ssl->handshake->ecjpake_cache_len;
 419:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 420:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( (size_t)( end - p - 2 ) < kkpp_len )
 421:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
 422:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "buffer too small" ) );
 423:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return;
 424:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
 425:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 426:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         memcpy( p + 2, ssl->handshake->ecjpake_cache, kkpp_len );
 427:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 428:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 429:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( kkpp_len >> 8 ) & 0xFF );
 430:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( kkpp_len      ) & 0xFF );
 431:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 432:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = kkpp_len + 4;
 433:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 434:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED */
 435:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 436:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_MAX_FRAGMENT_LENGTH)
 437:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static void ssl_write_max_fragment_length_ext( mbedtls_ssl_context *ssl,
 438:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                                unsigned char *buf,
 439:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                                size_t *olen )
 440:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 1083              		.loc 3 440 1
 1084              		.cfi_startproc
 1085 0000 F30F1EFA 		endbr64
 1086 0004 55       		pushq	%rbp
 1087              	.LCFI30:
 1088              		.cfi_def_cfa_offset 16
 1089              		.cfi_offset 6, -16
 1090 0005 4889E5   		movq	%rsp, %rbp
 1091              	.LCFI31:
 1092              		.cfi_def_cfa_register 6
 1093 0008 4883EC40 		subq	$64, %rsp
 1094 000c 48897DD8 		movq	%rdi, -40(%rbp)
 1095 0010 488975D0 		movq	%rsi, -48(%rbp)
 1096 0014 488955C8 		movq	%rdx, -56(%rbp)
 1097              		.loc 3 440 1
 1098 0018 64488B04 		movq	%fs:40, %rax
 1098      25280000 
 1098      00
 1099 0021 488945F8 		movq	%rax, -8(%rbp)
 1100 0025 31C0     		xorl	%eax, %eax
 441:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char *p = buf;
 1101              		.loc 3 441 20
 1102 0027 488B45D0 		movq	-48(%rbp), %rax
 1103 002b 488945E8 		movq	%rax, -24(%rbp)
 442:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const unsigned char *end = ssl->out_msg + MBEDTLS_SSL_OUT_CONTENT_LEN;
 1104              		.loc 3 442 35
 1105 002f 488B45D8 		movq	-40(%rbp), %rax
 1106 0033 488B8028 		movq	296(%rax), %rax
 1106      010000
GAS LISTING /tmp/cc8psT5X.s 			page 53


 1107              		.loc 3 442 26
 1108 003a 4805803E 		addq	$16000, %rax
 1108      0000
 1109 0040 488945F0 		movq	%rax, -16(%rbp)
 443:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 444:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = 0;
 1110              		.loc 3 444 11
 1111 0044 488B45C8 		movq	-56(%rbp), %rax
 1112 0048 48C70000 		movq	$0, (%rax)
 1112      000000
 445:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 446:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->mfl_code == MBEDTLS_SSL_MAX_FRAG_LEN_NONE ) {
 1113              		.loc 3 446 12
 1114 004f 488B45D8 		movq	-40(%rbp), %rax
 1115 0053 488B00   		movq	(%rax), %rax
 1116              		.loc 3 446 29
 1117 0056 0FB780BC 		movzwl	188(%rax), %eax
 1117      000000
 1118 005d 6625C001 		andw	$448, %ax
 1119              		.loc 3 446 7
 1120 0061 6685C0   		testw	%ax, %ax
 1121 0064 0F848C00 		je	.L79
 1121      0000
 447:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
 448:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 449:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 450:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "client hello, adding max_fragment_length extension" ) );
 451:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 452:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( end < p || (size_t)( end - p ) < 5 )
 1122              		.loc 3 452 7
 1123 006a 488B45F0 		movq	-16(%rbp), %rax
 1124 006e 483B45E8 		cmpq	-24(%rbp), %rax
 1125 0072 0F828100 		jb	.L80
 1125      0000
 1126              		.loc 3 452 34 discriminator 1
 1127 0078 488B45F0 		movq	-16(%rbp), %rax
 1128 007c 482B45E8 		subq	-24(%rbp), %rax
 1129              		.loc 3 452 17 discriminator 1
 1130 0080 4883F804 		cmpq	$4, %rax
 1131 0084 7673     		jbe	.L80
 453:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 454:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "buffer too small" ) );
 455:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
 456:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 457:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 458:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_MAX_FRAGMENT_LENGTH >> 8 ) & 0xFF );
 1132              		.loc 3 458 7
 1133 0086 488B45E8 		movq	-24(%rbp), %rax
 1134 008a 488D5001 		leaq	1(%rax), %rdx
 1135 008e 488955E8 		movq	%rdx, -24(%rbp)
 1136              		.loc 3 458 10
 1137 0092 C60000   		movb	$0, (%rax)
 459:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_MAX_FRAGMENT_LENGTH      ) & 0xFF );
 1138              		.loc 3 459 7
 1139 0095 488B45E8 		movq	-24(%rbp), %rax
 1140 0099 488D5001 		leaq	1(%rax), %rdx
 1141 009d 488955E8 		movq	%rdx, -24(%rbp)
GAS LISTING /tmp/cc8psT5X.s 			page 54


 1142              		.loc 3 459 10
 1143 00a1 C60001   		movb	$1, (%rax)
 460:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 461:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = 0x00;
 1144              		.loc 3 461 7
 1145 00a4 488B45E8 		movq	-24(%rbp), %rax
 1146 00a8 488D5001 		leaq	1(%rax), %rdx
 1147 00ac 488955E8 		movq	%rdx, -24(%rbp)
 1148              		.loc 3 461 10
 1149 00b0 C60000   		movb	$0, (%rax)
 462:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = 1;
 1150              		.loc 3 462 7
 1151 00b3 488B45E8 		movq	-24(%rbp), %rax
 1152 00b7 488D5001 		leaq	1(%rax), %rdx
 1153 00bb 488955E8 		movq	%rdx, -24(%rbp)
 1154              		.loc 3 462 10
 1155 00bf C60001   		movb	$1, (%rax)
 463:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 464:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = ssl->conf->mfl_code;
 1156              		.loc 3 464 15
 1157 00c2 488B45D8 		movq	-40(%rbp), %rax
 1158 00c6 488B00   		movq	(%rax), %rax
 1159              		.loc 3 464 21
 1160 00c9 0FB780BC 		movzwl	188(%rax), %eax
 1160      000000
 1161 00d0 66C1E806 		shrw	$6, %ax
 1162 00d4 89C1     		movl	%eax, %ecx
 1163 00d6 83E107   		andl	$7, %ecx
 1164              		.loc 3 464 7
 1165 00d9 488B45E8 		movq	-24(%rbp), %rax
 1166 00dd 488D5001 		leaq	1(%rax), %rdx
 1167 00e1 488955E8 		movq	%rdx, -24(%rbp)
 1168              		.loc 3 464 21
 1169 00e5 89CA     		movl	%ecx, %edx
 1170              		.loc 3 464 10
 1171 00e7 8810     		movb	%dl, (%rax)
 465:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 466:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = 5;
 1172              		.loc 3 466 11
 1173 00e9 488B45C8 		movq	-56(%rbp), %rax
 1174 00ed 48C70005 		movq	$5, (%rax)
 1174      000000
 1175 00f4 EB04     		jmp	.L73
 1176              	.L79:
 447:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 1177              		.loc 3 447 9
 1178 00f6 90       		nop
 1179 00f7 EB01     		jmp	.L73
 1180              	.L80:
 455:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 1181              		.loc 3 455 9
 1182 00f9 90       		nop
 1183              	.L73:
 467:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 1184              		.loc 3 467 1
 1185 00fa 488B45F8 		movq	-8(%rbp), %rax
 1186 00fe 64483304 		xorq	%fs:40, %rax
GAS LISTING /tmp/cc8psT5X.s 			page 55


 1186      25280000 
 1186      00
 1187 0107 7405     		je	.L78
 1188 0109 E8000000 		call	__stack_chk_fail@PLT
 1188      00
 1189              	.L78:
 1190 010e C9       		leave
 1191              	.LCFI32:
 1192              		.cfi_def_cfa 7, 8
 1193 010f C3       		ret
 1194              		.cfi_endproc
 1195              	.LFE31:
 1197              		.section	.text.ssl_write_extended_ms_ext,"ax",@progbits
 1199              	ssl_write_extended_ms_ext:
 1200              	.LFB32:
 468:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_MAX_FRAGMENT_LENGTH */
 469:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 470:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_TRUNCATED_HMAC)
 471:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static void ssl_write_truncated_hmac_ext( mbedtls_ssl_context *ssl,
 472:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                           unsigned char *buf, size_t *olen )
 473:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 474:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char *p = buf;
 475:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const unsigned char *end = ssl->out_msg + MBEDTLS_SSL_OUT_CONTENT_LEN;
 476:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 477:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = 0;
 478:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 479:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->trunc_hmac == MBEDTLS_SSL_TRUNC_HMAC_DISABLED )
 480:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 481:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
 482:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 483:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 484:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "client hello, adding truncated_hmac extension" ) );
 485:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 486:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( end < p || (size_t)( end - p ) < 4 )
 487:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 488:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "buffer too small" ) );
 489:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
 490:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 491:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 492:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_TRUNCATED_HMAC >> 8 ) & 0xFF );
 493:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_TRUNCATED_HMAC      ) & 0xFF );
 494:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 495:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = 0x00;
 496:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = 0x00;
 497:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 498:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = 4;
 499:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 500:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_TRUNCATED_HMAC */
 501:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 502:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_ENCRYPT_THEN_MAC)
 503:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static void ssl_write_encrypt_then_mac_ext( mbedtls_ssl_context *ssl,
 504:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                        unsigned char *buf, size_t *olen )
 505:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 506:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char *p = buf;
 507:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const unsigned char *end = ssl->out_msg + MBEDTLS_SSL_OUT_CONTENT_LEN;
 508:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 509:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = 0;
GAS LISTING /tmp/cc8psT5X.s 			page 56


 510:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 511:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->encrypt_then_mac == MBEDTLS_SSL_ETM_DISABLED ||
 512:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->conf->max_minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 )
 513:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 514:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
 515:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 516:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 517:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "client hello, adding encrypt_then_mac "
 518:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                         "extension" ) );
 519:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 520:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( end < p || (size_t)( end - p ) < 4 )
 521:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 522:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "buffer too small" ) );
 523:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
 524:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 525:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 526:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_ENCRYPT_THEN_MAC >> 8 ) & 0xFF );
 527:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_ENCRYPT_THEN_MAC      ) & 0xFF );
 528:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 529:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = 0x00;
 530:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = 0x00;
 531:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 532:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = 4;
 533:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 534:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_ENCRYPT_THEN_MAC */
 535:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 536:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_EXTENDED_MASTER_SECRET)
 537:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static void ssl_write_extended_ms_ext( mbedtls_ssl_context *ssl,
 538:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                        unsigned char *buf, size_t *olen )
 539:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 1201              		.loc 3 539 1
 1202              		.cfi_startproc
 1203 0000 F30F1EFA 		endbr64
 1204 0004 55       		pushq	%rbp
 1205              	.LCFI33:
 1206              		.cfi_def_cfa_offset 16
 1207              		.cfi_offset 6, -16
 1208 0005 4889E5   		movq	%rsp, %rbp
 1209              	.LCFI34:
 1210              		.cfi_def_cfa_register 6
 1211 0008 4883EC40 		subq	$64, %rsp
 1212 000c 48897DD8 		movq	%rdi, -40(%rbp)
 1213 0010 488975D0 		movq	%rsi, -48(%rbp)
 1214 0014 488955C8 		movq	%rdx, -56(%rbp)
 1215              		.loc 3 539 1
 1216 0018 64488B04 		movq	%fs:40, %rax
 1216      25280000 
 1216      00
 1217 0021 488945F8 		movq	%rax, -8(%rbp)
 1218 0025 31C0     		xorl	%eax, %eax
 540:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char *p = buf;
 1219              		.loc 3 540 20
 1220 0027 488B45D0 		movq	-48(%rbp), %rax
 1221 002b 488945E8 		movq	%rax, -24(%rbp)
 541:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const unsigned char *end = ssl->out_msg + MBEDTLS_SSL_OUT_CONTENT_LEN;
 1222              		.loc 3 541 35
 1223 002f 488B45D8 		movq	-40(%rbp), %rax
GAS LISTING /tmp/cc8psT5X.s 			page 57


 1224 0033 488B8028 		movq	296(%rax), %rax
 1224      010000
 1225              		.loc 3 541 26
 1226 003a 4805803E 		addq	$16000, %rax
 1226      0000
 1227 0040 488945F0 		movq	%rax, -16(%rbp)
 542:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 543:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = 0;
 1228              		.loc 3 543 11
 1229 0044 488B45C8 		movq	-56(%rbp), %rax
 1230 0048 48C70000 		movq	$0, (%rax)
 1230      000000
 544:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 545:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->extended_ms == MBEDTLS_SSL_EXTENDED_MS_DISABLED ||
 1231              		.loc 3 545 12
 1232 004f 488B45D8 		movq	-40(%rbp), %rax
 1233 0053 488B00   		movq	(%rax), %rax
 1234              		.loc 3 545 32
 1235 0056 0FB680BD 		movzbl	189(%rax), %eax
 1235      000000
 1236 005d 83E002   		andl	$2, %eax
 1237              		.loc 3 545 7
 1238 0060 84C0     		testb	%al, %al
 1239 0062 7473     		je	.L88
 546:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->conf->max_minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 )
 1240              		.loc 3 546 12 discriminator 1
 1241 0064 488B45D8 		movq	-40(%rbp), %rax
 1242 0068 488B00   		movq	(%rax), %rax
 1243              		.loc 3 546 18 discriminator 1
 1244 006b 0FB680B9 		movzbl	185(%rax), %eax
 1244      000000
 545:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->conf->max_minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 )
 1245              		.loc 3 545 68 discriminator 1
 1246 0072 84C0     		testb	%al, %al
 1247 0074 7461     		je	.L88
 547:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 548:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
 549:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 550:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 551:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "client hello, adding extended_master_secret "
 552:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                         "extension" ) );
 553:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 554:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( end < p || (size_t)( end - p ) < 4 )
 1248              		.loc 3 554 7
 1249 0076 488B45F0 		movq	-16(%rbp), %rax
 1250 007a 483B45E8 		cmpq	-24(%rbp), %rax
 1251 007e 725A     		jb	.L89
 1252              		.loc 3 554 34 discriminator 1
 1253 0080 488B45F0 		movq	-16(%rbp), %rax
 1254 0084 482B45E8 		subq	-24(%rbp), %rax
 1255              		.loc 3 554 17 discriminator 1
 1256 0088 4883F803 		cmpq	$3, %rax
 1257 008c 764C     		jbe	.L89
 555:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 556:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "buffer too small" ) );
 557:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
 558:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
GAS LISTING /tmp/cc8psT5X.s 			page 58


 559:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 560:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_EXTENDED_MASTER_SECRET >> 8 ) & 0xFF );
 1258              		.loc 3 560 7
 1259 008e 488B45E8 		movq	-24(%rbp), %rax
 1260 0092 488D5001 		leaq	1(%rax), %rdx
 1261 0096 488955E8 		movq	%rdx, -24(%rbp)
 1262              		.loc 3 560 10
 1263 009a C60000   		movb	$0, (%rax)
 561:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_EXTENDED_MASTER_SECRET      ) & 0xFF );
 1264              		.loc 3 561 7
 1265 009d 488B45E8 		movq	-24(%rbp), %rax
 1266 00a1 488D5001 		leaq	1(%rax), %rdx
 1267 00a5 488955E8 		movq	%rdx, -24(%rbp)
 1268              		.loc 3 561 10
 1269 00a9 C60017   		movb	$23, (%rax)
 562:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 563:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = 0x00;
 1270              		.loc 3 563 7
 1271 00ac 488B45E8 		movq	-24(%rbp), %rax
 1272 00b0 488D5001 		leaq	1(%rax), %rdx
 1273 00b4 488955E8 		movq	%rdx, -24(%rbp)
 1274              		.loc 3 563 10
 1275 00b8 C60000   		movb	$0, (%rax)
 564:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = 0x00;
 1276              		.loc 3 564 7
 1277 00bb 488B45E8 		movq	-24(%rbp), %rax
 1278 00bf 488D5001 		leaq	1(%rax), %rdx
 1279 00c3 488955E8 		movq	%rdx, -24(%rbp)
 1280              		.loc 3 564 10
 1281 00c7 C60000   		movb	$0, (%rax)
 565:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 566:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = 4;
 1282              		.loc 3 566 11
 1283 00ca 488B45C8 		movq	-56(%rbp), %rax
 1284 00ce 48C70004 		movq	$4, (%rax)
 1284      000000
 1285 00d5 EB04     		jmp	.L81
 1286              	.L88:
 548:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 1287              		.loc 3 548 9
 1288 00d7 90       		nop
 1289 00d8 EB01     		jmp	.L81
 1290              	.L89:
 557:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 1291              		.loc 3 557 9
 1292 00da 90       		nop
 1293              	.L81:
 567:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 1294              		.loc 3 567 1
 1295 00db 488B45F8 		movq	-8(%rbp), %rax
 1296 00df 64483304 		xorq	%fs:40, %rax
 1296      25280000 
 1296      00
 1297 00e8 7405     		je	.L87
 1298 00ea E8000000 		call	__stack_chk_fail@PLT
 1298      00
 1299              	.L87:
GAS LISTING /tmp/cc8psT5X.s 			page 59


 1300 00ef C9       		leave
 1301              	.LCFI35:
 1302              		.cfi_def_cfa 7, 8
 1303 00f0 C3       		ret
 1304              		.cfi_endproc
 1305              	.LFE32:
 1307              		.section	.text.ssl_write_session_ticket_ext,"ax",@progbits
 1309              	ssl_write_session_ticket_ext:
 1310              	.LFB33:
 568:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_EXTENDED_MASTER_SECRET */
 569:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 570:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_SESSION_TICKETS)
 571:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static void ssl_write_session_ticket_ext( mbedtls_ssl_context *ssl,
 572:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                           unsigned char *buf, size_t *olen )
 573:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 1311              		.loc 3 573 1
 1312              		.cfi_startproc
 1313 0000 F30F1EFA 		endbr64
 1314 0004 55       		pushq	%rbp
 1315              	.LCFI36:
 1316              		.cfi_def_cfa_offset 16
 1317              		.cfi_offset 6, -16
 1318 0005 4889E5   		movq	%rsp, %rbp
 1319              	.LCFI37:
 1320              		.cfi_def_cfa_register 6
 1321 0008 4883EC40 		subq	$64, %rsp
 1322 000c 48897DD8 		movq	%rdi, -40(%rbp)
 1323 0010 488975D0 		movq	%rsi, -48(%rbp)
 1324 0014 488955C8 		movq	%rdx, -56(%rbp)
 1325              		.loc 3 573 1
 1326 0018 64488B04 		movq	%fs:40, %rax
 1326      25280000 
 1326      00
 1327 0021 488945F8 		movq	%rax, -8(%rbp)
 1328 0025 31C0     		xorl	%eax, %eax
 574:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char *p = buf;
 1329              		.loc 3 574 20
 1330 0027 488B45D0 		movq	-48(%rbp), %rax
 1331 002b 488945E0 		movq	%rax, -32(%rbp)
 575:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const unsigned char *end = ssl->out_msg + MBEDTLS_SSL_OUT_CONTENT_LEN;
 1332              		.loc 3 575 35
 1333 002f 488B45D8 		movq	-40(%rbp), %rax
 1334 0033 488B8028 		movq	296(%rax), %rax
 1334      010000
 1335              		.loc 3 575 26
 1336 003a 4805803E 		addq	$16000, %rax
 1336      0000
 1337 0040 488945E8 		movq	%rax, -24(%rbp)
 576:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     size_t tlen = ssl->session_negotiate->ticket_len;
 1338              		.loc 3 576 22
 1339 0044 488B45D8 		movq	-40(%rbp), %rax
 1340 0048 488B4058 		movq	88(%rax), %rax
 1341              		.loc 3 576 12
 1342 004c 488B4078 		movq	120(%rax), %rax
 1343 0050 488945F0 		movq	%rax, -16(%rbp)
 577:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 578:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = 0;
GAS LISTING /tmp/cc8psT5X.s 			page 60


 1344              		.loc 3 578 11
 1345 0054 488B45C8 		movq	-56(%rbp), %rax
 1346 0058 48C70000 		movq	$0, (%rax)
 1346      000000
 579:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 580:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->session_tickets == MBEDTLS_SSL_SESSION_TICKETS_DISABLED )
 1347              		.loc 3 580 12
 1348 005f 488B45D8 		movq	-40(%rbp), %rax
 1349 0063 488B00   		movq	(%rax), %rax
 1350              		.loc 3 580 36
 1351 0066 0FB680BD 		movzbl	189(%rax), %eax
 1351      000000
 1352 006d 83E008   		andl	$8, %eax
 1353              		.loc 3 580 7
 1354 0070 84C0     		testb	%al, %al
 1355 0072 0F84CE00 		je	.L98
 1355      0000
 581:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 582:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
 583:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 584:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 585:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "client hello, adding session ticket extension" ) );
 586:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 587:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( end < p || (size_t)( end - p ) < 4 + tlen )
 1356              		.loc 3 587 7
 1357 0078 488B45E8 		movq	-24(%rbp), %rax
 1358 007c 483B45E0 		cmpq	-32(%rbp), %rax
 1359 0080 0F82C300 		jb	.L99
 1359      0000
 1360              		.loc 3 587 34 discriminator 1
 1361 0086 488B45E8 		movq	-24(%rbp), %rax
 1362 008a 482B45E0 		subq	-32(%rbp), %rax
 1363              		.loc 3 587 20 discriminator 1
 1364 008e 4889C2   		movq	%rax, %rdx
 1365              		.loc 3 587 44 discriminator 1
 1366 0091 488B45F0 		movq	-16(%rbp), %rax
 1367 0095 4883C004 		addq	$4, %rax
 1368              		.loc 3 587 17 discriminator 1
 1369 0099 4839C2   		cmpq	%rax, %rdx
 1370 009c 0F82A700 		jb	.L99
 1370      0000
 588:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 589:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "buffer too small" ) );
 590:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
 591:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 592:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 593:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_SESSION_TICKET >> 8 ) & 0xFF );
 1371              		.loc 3 593 7
 1372 00a2 488B45E0 		movq	-32(%rbp), %rax
 1373 00a6 488D5001 		leaq	1(%rax), %rdx
 1374 00aa 488955E0 		movq	%rdx, -32(%rbp)
 1375              		.loc 3 593 10
 1376 00ae C60000   		movb	$0, (%rax)
 594:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_SESSION_TICKET      ) & 0xFF );
 1377              		.loc 3 594 7
 1378 00b1 488B45E0 		movq	-32(%rbp), %rax
 1379 00b5 488D5001 		leaq	1(%rax), %rdx
GAS LISTING /tmp/cc8psT5X.s 			page 61


 1380 00b9 488955E0 		movq	%rdx, -32(%rbp)
 1381              		.loc 3 594 10
 1382 00bd C60023   		movb	$35, (%rax)
 595:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 596:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( tlen >> 8 ) & 0xFF );
 1383              		.loc 3 596 36
 1384 00c0 488B45F0 		movq	-16(%rbp), %rax
 1385 00c4 48C1E808 		shrq	$8, %rax
 1386 00c8 4889C1   		movq	%rax, %rcx
 1387              		.loc 3 596 7
 1388 00cb 488B45E0 		movq	-32(%rbp), %rax
 1389 00cf 488D5001 		leaq	1(%rax), %rdx
 1390 00d3 488955E0 		movq	%rdx, -32(%rbp)
 1391              		.loc 3 596 12
 1392 00d7 89CA     		movl	%ecx, %edx
 1393              		.loc 3 596 10
 1394 00d9 8810     		movb	%dl, (%rax)
 597:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( tlen      ) & 0xFF );
 1395              		.loc 3 597 7
 1396 00db 488B45E0 		movq	-32(%rbp), %rax
 1397 00df 488D5001 		leaq	1(%rax), %rdx
 1398 00e3 488955E0 		movq	%rdx, -32(%rbp)
 1399              		.loc 3 597 12
 1400 00e7 488B55F0 		movq	-16(%rbp), %rdx
 1401              		.loc 3 597 10
 1402 00eb 8810     		movb	%dl, (%rax)
 598:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 599:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = 4;
 1403              		.loc 3 599 11
 1404 00ed 488B45C8 		movq	-56(%rbp), %rax
 1405 00f1 48C70004 		movq	$4, (%rax)
 1405      000000
 600:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 601:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->session_negotiate->ticket == NULL || tlen == 0 )
 1406              		.loc 3 601 12
 1407 00f8 488B45D8 		movq	-40(%rbp), %rax
 1408 00fc 488B4058 		movq	88(%rax), %rax
 1409              		.loc 3 601 31
 1410 0100 488B4070 		movq	112(%rax), %rax
 1411              		.loc 3 601 7
 1412 0104 4885C0   		testq	%rax, %rax
 1413 0107 7443     		je	.L100
 1414              		.loc 3 601 48 discriminator 1
 1415 0109 48837DF0 		cmpq	$0, -16(%rbp)
 1415      00
 1416 010e 743C     		je	.L100
 602:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 603:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
 604:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 605:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 606:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "sending session ticket of length %d", tlen ) );
 607:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 608:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     memcpy( p, ssl->session_negotiate->ticket, tlen );
 1417              		.loc 3 608 19
 1418 0110 488B45D8 		movq	-40(%rbp), %rax
 1419 0114 488B4058 		movq	88(%rax), %rax
 1420              		.loc 3 608 38
GAS LISTING /tmp/cc8psT5X.s 			page 62


 1421 0118 488B4870 		movq	112(%rax), %rcx
 1422              		.loc 3 608 5
 1423 011c 488B55F0 		movq	-16(%rbp), %rdx
 1424 0120 488B45E0 		movq	-32(%rbp), %rax
 1425 0124 4889CE   		movq	%rcx, %rsi
 1426 0127 4889C7   		movq	%rax, %rdi
 1427 012a E8000000 		call	memcpy@PLT
 1427      00
 609:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 610:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen += tlen;
 1428              		.loc 3 610 11
 1429 012f 488B45C8 		movq	-56(%rbp), %rax
 1430 0133 488B10   		movq	(%rax), %rdx
 1431 0136 488B45F0 		movq	-16(%rbp), %rax
 1432 013a 4801C2   		addq	%rax, %rdx
 1433 013d 488B45C8 		movq	-56(%rbp), %rax
 1434 0141 488910   		movq	%rdx, (%rax)
 1435 0144 EB07     		jmp	.L90
 1436              	.L98:
 582:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 1437              		.loc 3 582 9
 1438 0146 90       		nop
 1439 0147 EB04     		jmp	.L90
 1440              	.L99:
 590:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 1441              		.loc 3 590 9
 1442 0149 90       		nop
 1443 014a EB01     		jmp	.L90
 1444              	.L100:
 603:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 1445              		.loc 3 603 9
 1446 014c 90       		nop
 1447              	.L90:
 611:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 1448              		.loc 3 611 1
 1449 014d 488B45F8 		movq	-8(%rbp), %rax
 1450 0151 64483304 		xorq	%fs:40, %rax
 1450      25280000 
 1450      00
 1451 015a 7405     		je	.L97
 1452 015c E8000000 		call	__stack_chk_fail@PLT
 1452      00
 1453              	.L97:
 1454 0161 C9       		leave
 1455              	.LCFI38:
 1456              		.cfi_def_cfa 7, 8
 1457 0162 C3       		ret
 1458              		.cfi_endproc
 1459              	.LFE33:
 1461              		.section	.text.ssl_generate_random,"ax",@progbits
 1463              	ssl_generate_random:
 1464              	.LFB34:
 612:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_SESSION_TICKETS */
 613:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 614:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_ALPN)
 615:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static void ssl_write_alpn_ext( mbedtls_ssl_context *ssl,
 616:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                 unsigned char *buf, size_t *olen )
GAS LISTING /tmp/cc8psT5X.s 			page 63


 617:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 618:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char *p = buf;
 619:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const unsigned char *end = ssl->out_msg + MBEDTLS_SSL_OUT_CONTENT_LEN;
 620:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     size_t alpnlen = 0;
 621:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const char **cur;
 622:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 623:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = 0;
 624:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 625:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->alpn_list == NULL )
 626:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 627:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
 628:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 629:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 630:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "client hello, adding alpn extension" ) );
 631:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 632:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     for( cur = ssl->conf->alpn_list; *cur != NULL; cur++ )
 633:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         alpnlen += (unsigned char)( strlen( *cur ) & 0xFF ) + 1;
 634:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 635:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( end < p || (size_t)( end - p ) < 6 + alpnlen )
 636:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 637:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "buffer too small" ) );
 638:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return;
 639:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 640:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 641:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_ALPN >> 8 ) & 0xFF );
 642:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( ( MBEDTLS_TLS_EXT_ALPN      ) & 0xFF );
 643:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 644:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
 645:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * opaque ProtocolName<1..2^8-1>;
 646:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *
 647:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * struct {
 648:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     ProtocolName protocol_name_list<2..2^16-1>
 649:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * } ProtocolNameList;
 650:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
 651:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 652:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /* Skip writing extension and list length for now */
 653:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     p += 4;
 654:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 655:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     for( cur = ssl->conf->alpn_list; *cur != NULL; cur++ )
 656:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 657:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *p = (unsigned char)( strlen( *cur ) & 0xFF );
 658:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         memcpy( p + 1, *cur, *p );
 659:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         p += 1 + *p;
 660:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 661:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 662:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *olen = p - buf;
 663:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 664:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /* List length = olen - 2 (ext_type) - 2 (ext_len) - 2 (list_len) */
 665:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     buf[4] = (unsigned char)( ( ( *olen - 6 ) >> 8 ) & 0xFF );
 666:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     buf[5] = (unsigned char)( ( ( *olen - 6 )      ) & 0xFF );
 667:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 668:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /* Extension length = olen - 2 (ext_type) - 2 (ext_len) */
 669:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     buf[2] = (unsigned char)( ( ( *olen - 4 ) >> 8 ) & 0xFF );
 670:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     buf[3] = (unsigned char)( ( ( *olen - 4 )      ) & 0xFF );
 671:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 672:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_ALPN */
 673:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
GAS LISTING /tmp/cc8psT5X.s 			page 64


 674:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** /*
 675:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  * Generate random bytes for ClientHello
 676:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  */
 677:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_generate_random( mbedtls_ssl_context *ssl )
 678:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 1465              		.loc 3 678 1
 1466              		.cfi_startproc
 1467 0000 F30F1EFA 		endbr64
 1468 0004 55       		pushq	%rbp
 1469              	.LCFI39:
 1470              		.cfi_def_cfa_offset 16
 1471              		.cfi_offset 6, -16
 1472 0005 4889E5   		movq	%rsp, %rbp
 1473              	.LCFI40:
 1474              		.cfi_def_cfa_register 6
 1475 0008 4883EC30 		subq	$48, %rsp
 1476 000c 48897DD8 		movq	%rdi, -40(%rbp)
 1477              		.loc 3 678 1
 1478 0010 64488B04 		movq	%fs:40, %rax
 1478      25280000 
 1478      00
 1479 0019 488945F8 		movq	%rax, -8(%rbp)
 1480 001d 31C0     		xorl	%eax, %eax
 679:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     int ret;
 680:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char *p = ssl->handshake->randbytes;
 1481              		.loc 3 680 27
 1482 001f 488B45D8 		movq	-40(%rbp), %rax
 1483 0023 488B4060 		movq	96(%rax), %rax
 1484              		.loc 3 680 20
 1485 0027 48051803 		addq	$792, %rax
 1485      0000
 1486 002d 488945F0 		movq	%rax, -16(%rbp)
 681:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_HAVE_TIME)
 682:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     mbedtls_time_t t;
 683:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 684:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 685:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
 686:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * When responding to a verify request, MUST reuse random (RFC 6347 4.2.1)
 687:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
 688:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 689:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
 690:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->handshake->verify_cookie != NULL )
 691:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 692:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( 0 );
 693:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 694:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 695:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 696:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_HAVE_TIME)
 697:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     t = mbedtls_time( NULL );
 698:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( t >> 24 );
 699:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( t >> 16 );
 700:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( t >>  8 );
 701:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char)( t       );
 702:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 703:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "client hello, current time: %lu", t ) );
 704:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #else
 705:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( ret = ssl->conf->f_rng( ssl->conf->p_rng, p, 4 ) ) != 0 )
GAS LISTING /tmp/cc8psT5X.s 			page 65


 1487              		.loc 3 705 20
 1488 0031 488B45D8 		movq	-40(%rbp), %rax
 1489 0035 488B00   		movq	(%rax), %rax
 1490              		.loc 3 705 26
 1491 0038 4C8B4030 		movq	48(%rax), %r8
 1492              		.loc 3 705 38
 1493 003c 488B45D8 		movq	-40(%rbp), %rax
 1494 0040 488B00   		movq	(%rax), %rax
 1495              		.loc 3 705 17
 1496 0043 488B4038 		movq	56(%rax), %rax
 1497 0047 488B4DF0 		movq	-16(%rbp), %rcx
 1498 004b BA040000 		movl	$4, %edx
 1498      00
 1499 0050 4889CE   		movq	%rcx, %rsi
 1500 0053 4889C7   		movq	%rax, %rdi
 1501 0056 41FFD0   		call	*%r8
 1502              	.LVL0:
 1503 0059 8945EC   		movl	%eax, -20(%rbp)
 1504              		.loc 3 705 7
 1505 005c 837DEC00 		cmpl	$0, -20(%rbp)
 1506 0060 7405     		je	.L102
 706:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( ret );
 1507              		.loc 3 706 15
 1508 0062 8B45EC   		movl	-20(%rbp), %eax
 1509 0065 EB40     		jmp	.L103
 1510              	.L102:
 707:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 708:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     p += 4;
 1511              		.loc 3 708 7
 1512 0067 488345F0 		addq	$4, -16(%rbp)
 1512      04
 709:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_HAVE_TIME */
 710:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 711:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( ret = ssl->conf->f_rng( ssl->conf->p_rng, p, 28 ) ) != 0 )
 1513              		.loc 3 711 20
 1514 006c 488B45D8 		movq	-40(%rbp), %rax
 1515 0070 488B00   		movq	(%rax), %rax
 1516              		.loc 3 711 26
 1517 0073 4C8B4030 		movq	48(%rax), %r8
 1518              		.loc 3 711 38
 1519 0077 488B45D8 		movq	-40(%rbp), %rax
 1520 007b 488B00   		movq	(%rax), %rax
 1521              		.loc 3 711 17
 1522 007e 488B4038 		movq	56(%rax), %rax
 1523 0082 488B4DF0 		movq	-16(%rbp), %rcx
 1524 0086 BA1C0000 		movl	$28, %edx
 1524      00
 1525 008b 4889CE   		movq	%rcx, %rsi
 1526 008e 4889C7   		movq	%rax, %rdi
 1527 0091 41FFD0   		call	*%r8
 1528              	.LVL1:
 1529 0094 8945EC   		movl	%eax, -20(%rbp)
 1530              		.loc 3 711 7
 1531 0097 837DEC00 		cmpl	$0, -20(%rbp)
 1532 009b 7405     		je	.L104
 712:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( ret );
 1533              		.loc 3 712 15
GAS LISTING /tmp/cc8psT5X.s 			page 66


 1534 009d 8B45EC   		movl	-20(%rbp), %eax
 1535 00a0 EB05     		jmp	.L103
 1536              	.L104:
 713:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 714:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( 0 );
 1537              		.loc 3 714 11
 1538 00a2 B8000000 		movl	$0, %eax
 1538      00
 1539              	.L103:
 715:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 1540              		.loc 3 715 1
 1541 00a7 488B55F8 		movq	-8(%rbp), %rdx
 1542 00ab 64483314 		xorq	%fs:40, %rdx
 1542      25280000 
 1542      00
 1543 00b4 7405     		je	.L105
 1544 00b6 E8000000 		call	__stack_chk_fail@PLT
 1544      00
 1545              	.L105:
 1546 00bb C9       		leave
 1547              	.LCFI41:
 1548              		.cfi_def_cfa 7, 8
 1549 00bc C3       		ret
 1550              		.cfi_endproc
 1551              	.LFE34:
 1553              		.section	.text.ssl_validate_ciphersuite,"ax",@progbits
 1555              	ssl_validate_ciphersuite:
 1556              	.LFB35:
 716:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 717:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** /**
 718:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  * \brief           Validate cipher suite against config in SSL context.
 719:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  *
 720:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  * \param suite_info    cipher suite to validate
 721:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  * \param ssl           SSL context
 722:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  * \param min_minor_ver Minimal minor version to accept a cipher suite
 723:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  * \param max_minor_ver Maximal minor version to accept a cipher suite
 724:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  *
 725:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  * \return          0 if valid, else 1
 726:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  */
 727:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_validate_ciphersuite( const mbedtls_ssl_ciphersuite_t * suite_info,
 728:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                      const mbedtls_ssl_context * ssl,
 729:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                      int min_minor_ver, int max_minor_ver )
 730:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 1557              		.loc 3 730 1
 1558              		.cfi_startproc
 1559 0000 F30F1EFA 		endbr64
 1560 0004 55       		pushq	%rbp
 1561              	.LCFI42:
 1562              		.cfi_def_cfa_offset 16
 1563              		.cfi_offset 6, -16
 1564 0005 4889E5   		movq	%rsp, %rbp
 1565              	.LCFI43:
 1566              		.cfi_def_cfa_register 6
 1567 0008 4883EC30 		subq	$48, %rsp
 1568 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1569 0010 488975E0 		movq	%rsi, -32(%rbp)
 1570 0014 8955DC   		movl	%edx, -36(%rbp)
GAS LISTING /tmp/cc8psT5X.s 			page 67


 1571 0017 894DD8   		movl	%ecx, -40(%rbp)
 1572              		.loc 3 730 1
 1573 001a 64488B04 		movq	%fs:40, %rax
 1573      25280000 
 1573      00
 1574 0023 488945F8 		movq	%rax, -8(%rbp)
 1575 0027 31C0     		xorl	%eax, %eax
 731:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     (void) ssl;
 732:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( suite_info == NULL )
 1576              		.loc 3 732 7
 1577 0029 48837DE8 		cmpq	$0, -24(%rbp)
 1577      00
 1578 002e 7507     		jne	.L107
 733:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( 1 );
 1579              		.loc 3 733 15
 1580 0030 B8010000 		movl	$1, %eax
 1580      00
 1581 0035 EB24     		jmp	.L108
 1582              	.L107:
 734:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 735:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( suite_info->min_minor_ver > max_minor_ver ||
 1583              		.loc 3 735 19
 1584 0037 488B45E8 		movq	-24(%rbp), %rax
 1585 003b 8B4020   		movl	32(%rax), %eax
 1586              		.loc 3 735 7
 1587 003e 3945D8   		cmpl	%eax, -40(%rbp)
 1588 0041 7C0C     		jl	.L109
 736:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             suite_info->max_minor_ver < min_minor_ver )
 1589              		.loc 3 736 23 discriminator 1
 1590 0043 488B45E8 		movq	-24(%rbp), %rax
 1591 0047 8B4028   		movl	40(%rax), %eax
 735:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             suite_info->max_minor_ver < min_minor_ver )
 1592              		.loc 3 735 51 discriminator 1
 1593 004a 3945DC   		cmpl	%eax, -36(%rbp)
 1594 004d 7E07     		jle	.L110
 1595              	.L109:
 737:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( 1 );
 1596              		.loc 3 737 15
 1597 004f B8010000 		movl	$1, %eax
 1597      00
 1598 0054 EB05     		jmp	.L108
 1599              	.L110:
 738:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 739:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 740:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
 741:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ( suite_info->flags & MBEDTLS_CIPHERSUITE_NODTLS ) )
 742:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( 1 );
 743:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 744:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 745:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_ARC4_C)
 746:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->arc4_disabled == MBEDTLS_SSL_ARC4_DISABLED &&
 747:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             suite_info->cipher == MBEDTLS_CIPHER_ARC4_128 )
 748:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( 1 );
 749:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 750:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 751:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
 752:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( suite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECJPAKE &&
GAS LISTING /tmp/cc8psT5X.s 			page 68


 753:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ecjpake_check( &ssl->handshake->ecjpake_ctx ) != 0 )
 754:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( 1 );
 755:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 756:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 757:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( 0 );
 1600              		.loc 3 757 11
 1601 0056 B8000000 		movl	$0, %eax
 1601      00
 1602              	.L108:
 758:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 1603              		.loc 3 758 1
 1604 005b 488B55F8 		movq	-8(%rbp), %rdx
 1605 005f 64483314 		xorq	%fs:40, %rdx
 1605      25280000 
 1605      00
 1606 0068 7405     		je	.L111
 1607 006a E8000000 		call	__stack_chk_fail@PLT
 1607      00
 1608              	.L111:
 1609 006f C9       		leave
 1610              	.LCFI44:
 1611              		.cfi_def_cfa 7, 8
 1612 0070 C3       		ret
 1613              		.cfi_endproc
 1614              	.LFE35:
 1616              		.section	.text.ssl_write_client_hello,"ax",@progbits
 1618              	ssl_write_client_hello:
 1619              	.LFB36:
 759:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 760:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_write_client_hello( mbedtls_ssl_context *ssl )
 761:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 1620              		.loc 3 761 1
 1621              		.cfi_startproc
 1622 0000 F30F1EFA 		endbr64
 1623 0004 55       		pushq	%rbp
 1624              	.LCFI45:
 1625              		.cfi_def_cfa_offset 16
 1626              		.cfi_offset 6, -16
 1627 0005 4889E5   		movq	%rsp, %rbp
 1628              	.LCFI46:
 1629              		.cfi_def_cfa_register 6
 1630 0008 4883EC70 		subq	$112, %rsp
 1631 000c 48897D98 		movq	%rdi, -104(%rbp)
 1632              		.loc 3 761 1
 1633 0010 64488B04 		movq	%fs:40, %rax
 1633      25280000 
 1633      00
 1634 0019 488945F8 		movq	%rax, -8(%rbp)
 1635 001d 31C0     		xorl	%eax, %eax
 762:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     int ret;
 763:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     size_t i, n, olen, ext_len = 0;
 1636              		.loc 3 763 24
 1637 001f 48C745C8 		movq	$0, -56(%rbp)
 1637      00000000 
 764:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char *buf;
 765:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char *p, *q;
 766:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char offer_compress;
GAS LISTING /tmp/cc8psT5X.s 			page 69


 767:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const int *ciphersuites;
 768:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const mbedtls_ssl_ciphersuite_t *ciphersuite_info;
 769:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_ECDH_C) || defined(MBEDTLS_ECDSA_C) || \
 770:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
 771:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     int uses_ec = 0;
 1638              		.loc 3 771 9
 1639 0027 C745A800 		movl	$0, -88(%rbp)
 1639      000000
 772:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 773:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 774:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> write client hello" ) );
 775:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 776:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->f_rng == NULL )
 1640              		.loc 3 776 12
 1641 002e 488B4598 		movq	-104(%rbp), %rax
 1642 0032 488B00   		movq	(%rax), %rax
 1643              		.loc 3 776 18
 1644 0035 488B4030 		movq	48(%rax), %rax
 1645              		.loc 3 776 7
 1646 0039 4885C0   		testq	%rax, %rax
 1647 003c 750A     		jne	.L113
 777:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 778:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "no RNG provided") );
 779:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_NO_RNG );
 1648              		.loc 3 779 15
 1649 003e B8008CFF 		movl	$-29696, %eax
 1649      FF
 1650 0043 E9EC0500 		jmp	.L135
 1650      00
 1651              	.L113:
 780:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 781:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 782:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
 783:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->renego_status == MBEDTLS_SSL_INITIAL_HANDSHAKE )
 1652              		.loc 3 783 12
 1653 0048 488B4598 		movq	-104(%rbp), %rax
 1654 004c 8B400C   		movl	12(%rax), %eax
 1655              		.loc 3 783 7
 1656 004f 85C0     		testl	%eax, %eax
 1657 0051 7530     		jne	.L115
 784:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 785:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 786:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->major_ver = ssl->conf->min_major_ver;
 1658              		.loc 3 786 29
 1659 0053 488B4598 		movq	-104(%rbp), %rax
 1660 0057 488B00   		movq	(%rax), %rax
 1661              		.loc 3 786 35
 1662 005a 0FB680BA 		movzbl	186(%rax), %eax
 1662      000000
 1663 0061 0FB6D0   		movzbl	%al, %edx
 1664              		.loc 3 786 24
 1665 0064 488B4598 		movq	-104(%rbp), %rax
 1666 0068 895014   		movl	%edx, 20(%rax)
 787:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->minor_ver = ssl->conf->min_minor_ver;
 1667              		.loc 3 787 29
 1668 006b 488B4598 		movq	-104(%rbp), %rax
 1669 006f 488B00   		movq	(%rax), %rax
GAS LISTING /tmp/cc8psT5X.s 			page 70


 1670              		.loc 3 787 35
 1671 0072 0FB680BB 		movzbl	187(%rax), %eax
 1671      000000
 1672 0079 0FB6D0   		movzbl	%al, %edx
 1673              		.loc 3 787 24
 1674 007c 488B4598 		movq	-104(%rbp), %rax
 1675 0080 895018   		movl	%edx, 24(%rax)
 1676              	.L115:
 788:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 789:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 790:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->max_major_ver == 0 )
 1677              		.loc 3 790 12
 1678 0083 488B4598 		movq	-104(%rbp), %rax
 1679 0087 488B00   		movq	(%rax), %rax
 1680              		.loc 3 790 18
 1681 008a 0FB680B8 		movzbl	184(%rax), %eax
 1681      000000
 1682              		.loc 3 790 7
 1683 0091 84C0     		testb	%al, %al
 1684 0093 750A     		jne	.L116
 791:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 792:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "configured max major version is invalid, "
 793:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             "consider using mbedtls_ssl_config_defaults()" ) );
 794:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 1685              		.loc 3 794 15
 1686 0095 B8008FFF 		movl	$-28928, %eax
 1686      FF
 1687 009a E9950500 		jmp	.L135
 1687      00
 1688              	.L116:
 795:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 796:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 797:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
 798:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     0  .   0   handshake type
 799:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     1  .   3   handshake length
 800:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     4  .   5   highest version supported
 801:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     6  .   9   current UNIX time
 802:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *    10  .  37   random bytes
 803:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
 804:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     buf = ssl->out_msg;
 1689              		.loc 3 804 9
 1690 009f 488B4598 		movq	-104(%rbp), %rax
 1691 00a3 488B8028 		movq	296(%rax), %rax
 1691      010000
 1692 00aa 488945D8 		movq	%rax, -40(%rbp)
 805:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     p = buf + 4;
 1693              		.loc 3 805 7
 1694 00ae 488B45D8 		movq	-40(%rbp), %rax
 1695 00b2 4883C004 		addq	$4, %rax
 1696 00b6 488945D0 		movq	%rax, -48(%rbp)
 806:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 807:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     mbedtls_ssl_write_version( ssl->conf->max_major_ver, ssl->conf->max_minor_ver,
 808:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                        ssl->conf->transport, p );
 1697              		.loc 3 808 27
 1698 00ba 488B4598 		movq	-104(%rbp), %rax
 1699 00be 488B00   		movq	(%rax), %rax
 1700              		.loc 3 808 33
GAS LISTING /tmp/cc8psT5X.s 			page 71


 1701 00c1 0FB680BC 		movzbl	188(%rax), %eax
 1701      000000
 1702 00c8 D0E8     		shrb	%al
 1703 00ca 83E001   		andl	$1, %eax
 807:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                        ssl->conf->transport, p );
 1704              		.loc 3 807 5
 1705 00cd 0FB6D0   		movzbl	%al, %edx
 807:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                        ssl->conf->transport, p );
 1706              		.loc 3 807 61
 1707 00d0 488B4598 		movq	-104(%rbp), %rax
 1708 00d4 488B00   		movq	(%rax), %rax
 807:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                        ssl->conf->transport, p );
 1709              		.loc 3 807 67
 1710 00d7 0FB680B9 		movzbl	185(%rax), %eax
 1710      000000
 807:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                        ssl->conf->transport, p );
 1711              		.loc 3 807 5
 1712 00de 0FB6F0   		movzbl	%al, %esi
 807:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                        ssl->conf->transport, p );
 1713              		.loc 3 807 35
 1714 00e1 488B4598 		movq	-104(%rbp), %rax
 1715 00e5 488B00   		movq	(%rax), %rax
 807:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                        ssl->conf->transport, p );
 1716              		.loc 3 807 41
 1717 00e8 0FB680B8 		movzbl	184(%rax), %eax
 1717      000000
 807:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                        ssl->conf->transport, p );
 1718              		.loc 3 807 5
 1719 00ef 0FB6C0   		movzbl	%al, %eax
 1720 00f2 488B4DD0 		movq	-48(%rbp), %rcx
 1721 00f6 89C7     		movl	%eax, %edi
 1722 00f8 E8000000 		call	mbedtls_ssl_write_version@PLT
 1722      00
 809:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     p += 2;
 1723              		.loc 3 809 7
 1724 00fd 488345D0 		addq	$2, -48(%rbp)
 1724      02
 810:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 811:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "client hello, max version: [%d:%d]",
 812:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                    buf[4], buf[5] ) );
 813:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 814:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( ret = ssl_generate_random( ssl ) ) != 0 )
 1725              		.loc 3 814 17
 1726 0102 488B4598 		movq	-104(%rbp), %rax
 1727 0106 4889C7   		movq	%rax, %rdi
 1728 0109 E8000000 		call	ssl_generate_random
 1728      00
 1729 010e 8945AC   		movl	%eax, -84(%rbp)
 1730              		.loc 3 814 7
 1731 0111 837DAC00 		cmpl	$0, -84(%rbp)
 1732 0115 7408     		je	.L117
 815:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 816:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "ssl_generate_random", ret );
 817:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( ret );
 1733              		.loc 3 817 15
 1734 0117 8B45AC   		movl	-84(%rbp), %eax
 1735 011a E9150500 		jmp	.L135
GAS LISTING /tmp/cc8psT5X.s 			page 72


 1735      00
 1736              	.L117:
 818:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 819:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 820:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     memcpy( p, ssl->handshake->randbytes, 32 );
 1737              		.loc 3 820 19
 1738 011f 488B4598 		movq	-104(%rbp), %rax
 1739 0123 488B4060 		movq	96(%rax), %rax
 1740              		.loc 3 820 30
 1741 0127 488D8818 		leaq	792(%rax), %rcx
 1741      030000
 1742              		.loc 3 820 5
 1743 012e 488B45D0 		movq	-48(%rbp), %rax
 1744 0132 BA200000 		movl	$32, %edx
 1744      00
 1745 0137 4889CE   		movq	%rcx, %rsi
 1746 013a 4889C7   		movq	%rax, %rdi
 1747 013d E8000000 		call	memcpy@PLT
 1747      00
 821:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "client hello, random bytes", p, 32 );
 822:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     p += 32;
 1748              		.loc 3 822 7
 1749 0142 488345D0 		addq	$32, -48(%rbp)
 1749      20
 823:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 824:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
 825:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *    38  .  38   session id length
 826:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *    39  . 39+n  session id
 827:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *   39+n . 39+n  DTLS only: cookie length (1 byte)
 828:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *   40+n .  ..   DTSL only: cookie
 829:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *   ..   . ..    ciphersuitelist length (2 bytes)
 830:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *   ..   . ..    ciphersuitelist
 831:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *   ..   . ..    compression methods length (1 byte)
 832:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *   ..   . ..    compression methods
 833:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *   ..   . ..    extensions length (2 bytes)
 834:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *   ..   . ..    extensions
 835:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
 836:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     n = ssl->session_negotiate->id_len;
 1750              		.loc 3 836 12
 1751 0147 488B4598 		movq	-104(%rbp), %rax
 1752 014b 488B4058 		movq	88(%rax), %rax
 1753              		.loc 3 836 7
 1754 014f 488B4008 		movq	8(%rax), %rax
 1755 0153 488945C0 		movq	%rax, -64(%rbp)
 837:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 838:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( n < 16 || n > 32 ||
 1756              		.loc 3 838 7
 1757 0157 48837DC0 		cmpq	$15, -64(%rbp)
 1757      0F
 1758 015c 7624     		jbe	.L118
 1759              		.loc 3 838 16 discriminator 1
 1760 015e 48837DC0 		cmpq	$32, -64(%rbp)
 1760      20
 1761 0163 771D     		ja	.L118
 839:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
 840:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->renego_status != MBEDTLS_SSL_INITIAL_HANDSHAKE ||
 1762              		.loc 3 840 12 discriminator 2
GAS LISTING /tmp/cc8psT5X.s 			page 73


 1763 0165 488B4598 		movq	-104(%rbp), %rax
 1764 0169 8B400C   		movl	12(%rax), %eax
 838:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
 1765              		.loc 3 838 26 discriminator 2
 1766 016c 85C0     		testl	%eax, %eax
 1767 016e 7512     		jne	.L118
 841:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 842:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->handshake->resume == 0 )
 1768              		.loc 3 842 12
 1769 0170 488B4598 		movq	-104(%rbp), %rax
 1770 0174 488B4060 		movq	96(%rax), %rax
 1771              		.loc 3 842 23
 1772 0178 8B809C03 		movl	924(%rax), %eax
 1772      0000
 840:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 1773              		.loc 3 840 61
 1774 017e 85C0     		testl	%eax, %eax
 1775 0180 7508     		jne	.L119
 1776              	.L118:
 843:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 844:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         n = 0;
 1777              		.loc 3 844 11
 1778 0182 48C745C0 		movq	$0, -64(%rbp)
 1778      00000000 
 1779              	.L119:
 845:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 846:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 847:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_SESSION_TICKETS)
 848:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
 849:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * RFC 5077 section 3.4: "When presenting a ticket, the client MAY
 850:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * generate and include a Session ID in the TLS ClientHello."
 851:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
 852:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
 853:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->renego_status == MBEDTLS_SSL_INITIAL_HANDSHAKE )
 1780              		.loc 3 853 12
 1781 018a 488B4598 		movq	-104(%rbp), %rax
 1782 018e 8B400C   		movl	12(%rax), %eax
 1783              		.loc 3 853 7
 1784 0191 85C0     		testl	%eax, %eax
 1785 0193 7577     		jne	.L120
 854:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 855:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 856:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ssl->session_negotiate->ticket != NULL &&
 1786              		.loc 3 856 16
 1787 0195 488B4598 		movq	-104(%rbp), %rax
 1788 0199 488B4058 		movq	88(%rax), %rax
 1789              		.loc 3 856 35
 1790 019d 488B4070 		movq	112(%rax), %rax
 1791              		.loc 3 856 11
 1792 01a1 4885C0   		testq	%rax, %rax
 1793 01a4 7466     		je	.L120
 857:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 ssl->session_negotiate->ticket_len != 0 )
 1794              		.loc 3 857 20 discriminator 1
 1795 01a6 488B4598 		movq	-104(%rbp), %rax
 1796 01aa 488B4058 		movq	88(%rax), %rax
 1797              		.loc 3 857 39 discriminator 1
 1798 01ae 488B4078 		movq	120(%rax), %rax
GAS LISTING /tmp/cc8psT5X.s 			page 74


 856:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 ssl->session_negotiate->ticket_len != 0 )
 1799              		.loc 3 856 52 discriminator 1
 1800 01b2 4885C0   		testq	%rax, %rax
 1801 01b5 7455     		je	.L120
 858:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
 859:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ret = ssl->conf->f_rng( ssl->conf->p_rng, ssl->session_negotiate->id, 32 );
 1802              		.loc 3 859 22
 1803 01b7 488B4598 		movq	-104(%rbp), %rax
 1804 01bb 488B00   		movq	(%rax), %rax
 1805              		.loc 3 859 28
 1806 01be 488B4830 		movq	48(%rax), %rcx
 1807              		.loc 3 859 58
 1808 01c2 488B4598 		movq	-104(%rbp), %rax
 1809 01c6 488B4058 		movq	88(%rax), %rax
 1810              		.loc 3 859 77
 1811 01ca 488D7010 		leaq	16(%rax), %rsi
 1812              		.loc 3 859 40
 1813 01ce 488B4598 		movq	-104(%rbp), %rax
 1814 01d2 488B00   		movq	(%rax), %rax
 1815              		.loc 3 859 19
 1816 01d5 488B4038 		movq	56(%rax), %rax
 1817 01d9 BA200000 		movl	$32, %edx
 1817      00
 1818 01de 4889C7   		movq	%rax, %rdi
 1819 01e1 FFD1     		call	*%rcx
 1820              	.LVL2:
 1821 01e3 8945AC   		movl	%eax, -84(%rbp)
 860:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 861:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( ret != 0 )
 1822              		.loc 3 861 15
 1823 01e6 837DAC00 		cmpl	$0, -84(%rbp)
 1824 01ea 7408     		je	.L121
 862:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 return( ret );
 1825              		.loc 3 862 23
 1826 01ec 8B45AC   		movl	-84(%rbp), %eax
 1827 01ef E9400400 		jmp	.L135
 1827      00
 1828              	.L121:
 863:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 864:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ssl->session_negotiate->id_len = n = 32;
 1829              		.loc 3 864 48
 1830 01f4 48C745C0 		movq	$32, -64(%rbp)
 1830      20000000 
 1831              		.loc 3 864 16
 1832 01fc 488B4598 		movq	-104(%rbp), %rax
 1833 0200 488B4058 		movq	88(%rax), %rax
 1834              		.loc 3 864 44
 1835 0204 488B55C0 		movq	-64(%rbp), %rdx
 1836 0208 48895008 		movq	%rdx, 8(%rax)
 1837              	.L120:
 865:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
 866:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 867:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_SESSION_TICKETS */
 868:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 869:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p++ = (unsigned char) n;
 1838              		.loc 3 869 7
 1839 020c 488B45D0 		movq	-48(%rbp), %rax
GAS LISTING /tmp/cc8psT5X.s 			page 75


 1840 0210 488D5001 		leaq	1(%rax), %rdx
 1841 0214 488955D0 		movq	%rdx, -48(%rbp)
 1842              		.loc 3 869 12
 1843 0218 488B55C0 		movq	-64(%rbp), %rdx
 1844              		.loc 3 869 10
 1845 021c 8810     		movb	%dl, (%rax)
 870:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 871:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     for( i = 0; i < n; i++ )
 1846              		.loc 3 871 12
 1847 021e 48C745B8 		movq	$0, -72(%rbp)
 1847      00000000 
 1848              		.loc 3 871 5
 1849 0226 EB29     		jmp	.L122
 1850              	.L123:
 872:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *p++ = ssl->session_negotiate->id[i];
 1851              		.loc 3 872 19 discriminator 3
 1852 0228 488B4598 		movq	-104(%rbp), %rax
 1853 022c 488B4858 		movq	88(%rax), %rcx
 1854              		.loc 3 872 11 discriminator 3
 1855 0230 488B45D0 		movq	-48(%rbp), %rax
 1856 0234 488D5001 		leaq	1(%rax), %rdx
 1857 0238 488955D0 		movq	%rdx, -48(%rbp)
 1858              		.loc 3 872 42 discriminator 3
 1859 023c 488B55B8 		movq	-72(%rbp), %rdx
 1860 0240 4801CA   		addq	%rcx, %rdx
 1861 0243 4883C210 		addq	$16, %rdx
 1862 0247 0FB612   		movzbl	(%rdx), %edx
 1863              		.loc 3 872 14 discriminator 3
 1864 024a 8810     		movb	%dl, (%rax)
 871:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *p++ = ssl->session_negotiate->id[i];
 1865              		.loc 3 871 25 discriminator 3
 1866 024c 488345B8 		addq	$1, -72(%rbp)
 1866      01
 1867              	.L122:
 871:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *p++ = ssl->session_negotiate->id[i];
 1868              		.loc 3 871 5 discriminator 1
 1869 0251 488B45B8 		movq	-72(%rbp), %rax
 1870 0255 483B45C0 		cmpq	-64(%rbp), %rax
 1871 0259 72CD     		jb	.L123
 873:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 874:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "client hello, session id len.: %d", n ) );
 875:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_BUF( 3,   "client hello, session id", buf + 39, n );
 876:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 877:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
 878:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * DTLS cookie
 879:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
 880:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 881:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
 882:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 883:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ssl->handshake->verify_cookie == NULL )
 884:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
 885:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "no verify cookie to send" ) );
 886:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             *p++ = 0;
 887:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
 888:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         else
 889:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
 890:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_BUF( 3, "client hello, cookie",
GAS LISTING /tmp/cc8psT5X.s 			page 76


 891:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                               ssl->handshake->verify_cookie,
 892:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                               ssl->handshake->verify_cookie_len );
 893:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 894:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             *p++ = ssl->handshake->verify_cookie_len;
 895:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             memcpy( p, ssl->handshake->verify_cookie,
 896:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                        ssl->handshake->verify_cookie_len );
 897:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             p += ssl->handshake->verify_cookie_len;
 898:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
 899:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 900:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 901:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 902:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
 903:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * Ciphersuite list
 904:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
 905:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ciphersuites = ssl->conf->ciphersuite_list[ssl->minor_ver];
 1872              		.loc 3 905 23
 1873 025b 488B4598 		movq	-104(%rbp), %rax
 1874 025f 488B00   		movq	(%rax), %rax
 1875              		.loc 3 905 51
 1876 0262 488B5598 		movq	-104(%rbp), %rdx
 1877 0266 8B5218   		movl	24(%rdx), %edx
 1878              		.loc 3 905 18
 1879 0269 4863D2   		movslq	%edx, %rdx
 1880 026c 488B04D0 		movq	(%rax,%rdx,8), %rax
 1881 0270 488945E0 		movq	%rax, -32(%rbp)
 906:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 907:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /* Skip writing ciphersuite length for now */
 908:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     n = 0;
 1882              		.loc 3 908 7
 1883 0274 48C745C0 		movq	$0, -64(%rbp)
 1883      00000000 
 909:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     q = p;
 1884              		.loc 3 909 7
 1885 027c 488B45D0 		movq	-48(%rbp), %rax
 1886 0280 488945E8 		movq	%rax, -24(%rbp)
 910:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     p += 2;
 1887              		.loc 3 910 7
 1888 0284 488345D0 		addq	$2, -48(%rbp)
 1888      02
 911:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 912:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     for( i = 0; ciphersuites[i] != 0; i++ )
 1889              		.loc 3 912 12
 1890 0289 48C745B8 		movq	$0, -72(%rbp)
 1890      00000000 
 1891              		.loc 3 912 5
 1892 0291 E9C10000 		jmp	.L124
 1892      00
 1893              	.L127:
 913:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 914:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info = mbedtls_ssl_ciphersuite_from_id( ciphersuites[i] );
 1894              		.loc 3 914 73
 1895 0296 488B45B8 		movq	-72(%rbp), %rax
 1896 029a 488D1485 		leaq	0(,%rax,4), %rdx
 1896      00000000 
 1897 02a2 488B45E0 		movq	-32(%rbp), %rax
 1898 02a6 4801D0   		addq	%rdx, %rax
 1899              		.loc 3 914 28
GAS LISTING /tmp/cc8psT5X.s 			page 77


 1900 02a9 8B00     		movl	(%rax), %eax
 1901 02ab 89C7     		movl	%eax, %edi
 1902 02ad E8000000 		call	mbedtls_ssl_ciphersuite_from_id@PLT
 1902      00
 1903 02b2 488945F0 		movq	%rax, -16(%rbp)
 915:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 916:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ssl_validate_ciphersuite( ciphersuite_info, ssl,
 917:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                       ssl->conf->min_minor_ver,
 918:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                       ssl->conf->max_minor_ver ) != 0 )
 1904              		.loc 3 918 42
 1905 02b6 488B4598 		movq	-104(%rbp), %rax
 1906 02ba 488B00   		movq	(%rax), %rax
 1907              		.loc 3 918 48
 1908 02bd 0FB680B9 		movzbl	185(%rax), %eax
 1908      000000
 916:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                       ssl->conf->min_minor_ver,
 1909              		.loc 3 916 13
 1910 02c4 0FB6C8   		movzbl	%al, %ecx
 917:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                       ssl->conf->max_minor_ver ) != 0 )
 1911              		.loc 3 917 42
 1912 02c7 488B4598 		movq	-104(%rbp), %rax
 1913 02cb 488B00   		movq	(%rax), %rax
 917:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                       ssl->conf->max_minor_ver ) != 0 )
 1914              		.loc 3 917 48
 1915 02ce 0FB680BB 		movzbl	187(%rax), %eax
 1915      000000
 916:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                       ssl->conf->min_minor_ver,
 1916              		.loc 3 916 13
 1917 02d5 0FB6D0   		movzbl	%al, %edx
 1918 02d8 488B7598 		movq	-104(%rbp), %rsi
 1919 02dc 488B45F0 		movq	-16(%rbp), %rax
 1920 02e0 4889C7   		movq	%rax, %rdi
 1921 02e3 E8000000 		call	ssl_validate_ciphersuite
 1921      00
 916:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                       ssl->conf->min_minor_ver,
 1922              		.loc 3 916 11
 1923 02e8 85C0     		testl	%eax, %eax
 1924 02ea 7565     		jne	.L137
 919:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             continue;
 920:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 921:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "client hello, add ciphersuite: %04x",
 922:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                     ciphersuites[i] ) );
 923:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 924:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_ECDH_C) || defined(MBEDTLS_ECDSA_C) || \
 925:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
 926:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         uses_ec |= mbedtls_ssl_ciphersuite_uses_ec( ciphersuite_info );
 1925              		.loc 3 926 20
 1926 02ec 488B45F0 		movq	-16(%rbp), %rax
 1927 02f0 4889C7   		movq	%rax, %rdi
 1928 02f3 E8000000 		call	mbedtls_ssl_ciphersuite_uses_ec@PLT
 1928      00
 1929              		.loc 3 926 17
 1930 02f8 0945A8   		orl	%eax, -88(%rbp)
 927:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 928:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 929:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         n++;
 1931              		.loc 3 929 10
GAS LISTING /tmp/cc8psT5X.s 			page 78


 1932 02fb 488345C0 		addq	$1, -64(%rbp)
 1932      01
 930:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *p++ = (unsigned char)( ciphersuites[i] >> 8 );
 1933              		.loc 3 930 45
 1934 0300 488B45B8 		movq	-72(%rbp), %rax
 1935 0304 488D1485 		leaq	0(,%rax,4), %rdx
 1935      00000000 
 1936 030c 488B45E0 		movq	-32(%rbp), %rax
 1937 0310 4801D0   		addq	%rdx, %rax
 1938 0313 8B00     		movl	(%rax), %eax
 1939              		.loc 3 930 49
 1940 0315 C1F808   		sarl	$8, %eax
 1941 0318 89C1     		movl	%eax, %ecx
 1942              		.loc 3 930 11
 1943 031a 488B45D0 		movq	-48(%rbp), %rax
 1944 031e 488D5001 		leaq	1(%rax), %rdx
 1945 0322 488955D0 		movq	%rdx, -48(%rbp)
 1946              		.loc 3 930 16
 1947 0326 89CA     		movl	%ecx, %edx
 1948              		.loc 3 930 14
 1949 0328 8810     		movb	%dl, (%rax)
 931:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *p++ = (unsigned char)( ciphersuites[i]      );
 1950              		.loc 3 931 45
 1951 032a 488B45B8 		movq	-72(%rbp), %rax
 1952 032e 488D1485 		leaq	0(,%rax,4), %rdx
 1952      00000000 
 1953 0336 488B45E0 		movq	-32(%rbp), %rax
 1954 033a 4801D0   		addq	%rdx, %rax
 1955 033d 8B08     		movl	(%rax), %ecx
 1956              		.loc 3 931 11
 1957 033f 488B45D0 		movq	-48(%rbp), %rax
 1958 0343 488D5001 		leaq	1(%rax), %rdx
 1959 0347 488955D0 		movq	%rdx, -48(%rbp)
 1960              		.loc 3 931 16
 1961 034b 89CA     		movl	%ecx, %edx
 1962              		.loc 3 931 14
 1963 034d 8810     		movb	%dl, (%rax)
 1964 034f EB01     		jmp	.L126
 1965              	.L137:
 919:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 1966              		.loc 3 919 13
 1967 0351 90       		nop
 1968              	.L126:
 912:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 1969              		.loc 3 912 40 discriminator 2
 1970 0352 488345B8 		addq	$1, -72(%rbp)
 1970      01
 1971              	.L124:
 912:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 1972              		.loc 3 912 29 discriminator 1
 1973 0357 488B45B8 		movq	-72(%rbp), %rax
 1974 035b 488D1485 		leaq	0(,%rax,4), %rdx
 1974      00000000 
 1975 0363 488B45E0 		movq	-32(%rbp), %rax
 1976 0367 4801D0   		addq	%rdx, %rax
 1977 036a 8B00     		movl	(%rax), %eax
 912:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
GAS LISTING /tmp/cc8psT5X.s 			page 79


 1978              		.loc 3 912 5 discriminator 1
 1979 036c 85C0     		testl	%eax, %eax
 1980 036e 0F8522FF 		jne	.L127
 1980      FFFF
 932:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 933:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 934:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "client hello, got %d ciphersuites (excluding SCSVs)", n ) );
 935:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 936:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
 937:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * Add TLS_EMPTY_RENEGOTIATION_INFO_SCSV
 938:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
 939:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
 940:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->renego_status == MBEDTLS_SSL_INITIAL_HANDSHAKE )
 1981              		.loc 3 940 12
 1982 0374 488B4598 		movq	-104(%rbp), %rax
 1983 0378 8B400C   		movl	12(%rax), %eax
 1984              		.loc 3 940 7
 1985 037b 85C0     		testl	%eax, %eax
 1986 037d 7523     		jne	.L128
 941:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 942:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 943:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "adding EMPTY_RENEGOTIATION_INFO_SCSV" ) );
 944:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *p++ = (unsigned char)( MBEDTLS_SSL_EMPTY_RENEGOTIATION_INFO >> 8 );
 1987              		.loc 3 944 11
 1988 037f 488B45D0 		movq	-48(%rbp), %rax
 1989 0383 488D5001 		leaq	1(%rax), %rdx
 1990 0387 488955D0 		movq	%rdx, -48(%rbp)
 1991              		.loc 3 944 14
 1992 038b C60000   		movb	$0, (%rax)
 945:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *p++ = (unsigned char)( MBEDTLS_SSL_EMPTY_RENEGOTIATION_INFO      );
 1993              		.loc 3 945 11
 1994 038e 488B45D0 		movq	-48(%rbp), %rax
 1995 0392 488D5001 		leaq	1(%rax), %rdx
 1996 0396 488955D0 		movq	%rdx, -48(%rbp)
 1997              		.loc 3 945 14
 1998 039a C600FF   		movb	$-1, (%rax)
 946:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         n++;
 1999              		.loc 3 946 10
 2000 039d 488345C0 		addq	$1, -64(%rbp)
 2000      01
 2001              	.L128:
 947:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 948:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 949:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /* Some versions of OpenSSL don't handle it correctly if not at end */
 950:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_FALLBACK_SCSV)
 951:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->fallback == MBEDTLS_SSL_IS_FALLBACK )
 2002              		.loc 3 951 12
 2003 03a2 488B4598 		movq	-104(%rbp), %rax
 2004 03a6 488B00   		movq	(%rax), %rax
 2005              		.loc 3 951 29
 2006 03a9 0FB680BD 		movzbl	189(%rax), %eax
 2006      000000
 2007 03b0 83E010   		andl	$16, %eax
 2008              		.loc 3 951 7
 2009 03b3 84C0     		testb	%al, %al
 2010 03b5 7423     		je	.L129
 952:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
GAS LISTING /tmp/cc8psT5X.s 			page 80


 953:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "adding FALLBACK_SCSV" ) );
 954:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *p++ = (unsigned char)( MBEDTLS_SSL_FALLBACK_SCSV_VALUE >> 8 );
 2011              		.loc 3 954 11
 2012 03b7 488B45D0 		movq	-48(%rbp), %rax
 2013 03bb 488D5001 		leaq	1(%rax), %rdx
 2014 03bf 488955D0 		movq	%rdx, -48(%rbp)
 2015              		.loc 3 954 14
 2016 03c3 C60056   		movb	$86, (%rax)
 955:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *p++ = (unsigned char)( MBEDTLS_SSL_FALLBACK_SCSV_VALUE      );
 2017              		.loc 3 955 11
 2018 03c6 488B45D0 		movq	-48(%rbp), %rax
 2019 03ca 488D5001 		leaq	1(%rax), %rdx
 2020 03ce 488955D0 		movq	%rdx, -48(%rbp)
 2021              		.loc 3 955 14
 2022 03d2 C60000   		movb	$0, (%rax)
 956:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         n++;
 2023              		.loc 3 956 10
 2024 03d5 488345C0 		addq	$1, -64(%rbp)
 2024      01
 2025              	.L129:
 957:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 958:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 959:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 960:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *q++ = (unsigned char)( n >> 7 );
 2026              		.loc 3 960 31
 2027 03da 488B45C0 		movq	-64(%rbp), %rax
 2028 03de 48C1E807 		shrq	$7, %rax
 2029 03e2 4889C1   		movq	%rax, %rcx
 2030              		.loc 3 960 7
 2031 03e5 488B45E8 		movq	-24(%rbp), %rax
 2032 03e9 488D5001 		leaq	1(%rax), %rdx
 2033 03ed 488955E8 		movq	%rdx, -24(%rbp)
 2034              		.loc 3 960 12
 2035 03f1 89CA     		movl	%ecx, %edx
 2036              		.loc 3 960 10
 2037 03f3 8810     		movb	%dl, (%rax)
 961:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *q++ = (unsigned char)( n << 1 );
 2038              		.loc 3 961 12
 2039 03f5 488B45C0 		movq	-64(%rbp), %rax
 2040 03f9 89C1     		movl	%eax, %ecx
 2041              		.loc 3 961 7
 2042 03fb 488B45E8 		movq	-24(%rbp), %rax
 2043 03ff 488D5001 		leaq	1(%rax), %rdx
 2044 0403 488955E8 		movq	%rdx, -24(%rbp)
 2045              		.loc 3 961 12
 2046 0407 8D1409   		leal	(%rcx,%rcx), %edx
 2047              		.loc 3 961 10
 2048 040a 8810     		movb	%dl, (%rax)
 962:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 963:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_ZLIB_SUPPORT)
 964:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     offer_compress = 1;
 965:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #else
 966:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     offer_compress = 0;
 2049              		.loc 3 966 20
 2050 040c C645A700 		movb	$0, -89(%rbp)
 967:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 968:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
GAS LISTING /tmp/cc8psT5X.s 			page 81


 969:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
 970:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * We don't support compression with DTLS right now: if many records come
 971:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * in the same datagram, uncompressing one could overwrite the next one.
 972:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * We don't want to add complexity for handling that case unless there is
 973:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * an actual need for it.
 974:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
 975:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 976:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
 977:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         offer_compress = 0;
 978:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 979:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 980:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( offer_compress )
 2051              		.loc 3 980 7
 2052 0410 807DA700 		cmpb	$0, -89(%rbp)
 2053 0414 742F     		je	.L130
 981:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 982:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "client hello, compress len.: %d", 2 ) );
 983:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "client hello, compress alg.: %d %d",
 984:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             MBEDTLS_SSL_COMPRESS_DEFLATE, MBEDTLS_SSL_COMPRESS_NULL ) );
 985:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 986:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *p++ = 2;
 2054              		.loc 3 986 11
 2055 0416 488B45D0 		movq	-48(%rbp), %rax
 2056 041a 488D5001 		leaq	1(%rax), %rdx
 2057 041e 488955D0 		movq	%rdx, -48(%rbp)
 2058              		.loc 3 986 14
 2059 0422 C60002   		movb	$2, (%rax)
 987:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *p++ = MBEDTLS_SSL_COMPRESS_DEFLATE;
 2060              		.loc 3 987 11
 2061 0425 488B45D0 		movq	-48(%rbp), %rax
 2062 0429 488D5001 		leaq	1(%rax), %rdx
 2063 042d 488955D0 		movq	%rdx, -48(%rbp)
 2064              		.loc 3 987 14
 2065 0431 C60001   		movb	$1, (%rax)
 988:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *p++ = MBEDTLS_SSL_COMPRESS_NULL;
 2066              		.loc 3 988 11
 2067 0434 488B45D0 		movq	-48(%rbp), %rax
 2068 0438 488D5001 		leaq	1(%rax), %rdx
 2069 043c 488955D0 		movq	%rdx, -48(%rbp)
 2070              		.loc 3 988 14
 2071 0440 C60000   		movb	$0, (%rax)
 2072 0443 EB1E     		jmp	.L131
 2073              	.L130:
 989:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 990:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     else
 991:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 992:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "client hello, compress len.: %d", 1 ) );
 993:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "client hello, compress alg.: %d",
 994:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             MBEDTLS_SSL_COMPRESS_NULL ) );
 995:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 996:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *p++ = 1;
 2074              		.loc 3 996 11
 2075 0445 488B45D0 		movq	-48(%rbp), %rax
 2076 0449 488D5001 		leaq	1(%rax), %rdx
 2077 044d 488955D0 		movq	%rdx, -48(%rbp)
 2078              		.loc 3 996 14
 2079 0451 C60001   		movb	$1, (%rax)
GAS LISTING /tmp/cc8psT5X.s 			page 82


 997:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *p++ = MBEDTLS_SSL_COMPRESS_NULL;
 2080              		.loc 3 997 11
 2081 0454 488B45D0 		movq	-48(%rbp), %rax
 2082 0458 488D5001 		leaq	1(%rax), %rdx
 2083 045c 488955D0 		movq	%rdx, -48(%rbp)
 2084              		.loc 3 997 14
 2085 0460 C60000   		movb	$0, (%rax)
 2086              	.L131:
 998:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 999:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1000:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     // First write extensions, then the total length
1001:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     //
1002:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_SERVER_NAME_INDICATION)
1003:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl_write_hostname_ext( ssl, p + 2 + ext_len, &olen );
1004:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ext_len += olen;
1005:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
1006:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1007:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /* Note that TLS_EMPTY_RENEGOTIATION_INFO_SCSV is always added
1008:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * even if MBEDTLS_SSL_RENEGOTIATION is not defined. */
1009:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
1010:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl_write_renegotiation_ext( ssl, p + 2 + ext_len, &olen );
 2087              		.loc 3 1010 45
 2088 0463 488B45C8 		movq	-56(%rbp), %rax
 2089 0467 488D5002 		leaq	2(%rax), %rdx
 2090              		.loc 3 1010 5
 2091 046b 488B45D0 		movq	-48(%rbp), %rax
 2092 046f 488D0C02 		leaq	(%rdx,%rax), %rcx
 2093 0473 488D55B0 		leaq	-80(%rbp), %rdx
 2094 0477 488B4598 		movq	-104(%rbp), %rax
 2095 047b 4889CE   		movq	%rcx, %rsi
 2096 047e 4889C7   		movq	%rax, %rdi
 2097 0481 E8000000 		call	ssl_write_renegotiation_ext
 2097      00
1011:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ext_len += olen;
 2098              		.loc 3 1011 13
 2099 0486 488B45B0 		movq	-80(%rbp), %rax
 2100 048a 480145C8 		addq	%rax, -56(%rbp)
1012:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
1013:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1014:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2) && \
1015:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
1016:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl_write_signature_algorithms_ext( ssl, p + 2 + ext_len, &olen );
 2101              		.loc 3 1016 52
 2102 048e 488B45C8 		movq	-56(%rbp), %rax
 2103 0492 488D5002 		leaq	2(%rax), %rdx
 2104              		.loc 3 1016 5
 2105 0496 488B45D0 		movq	-48(%rbp), %rax
 2106 049a 488D0C02 		leaq	(%rdx,%rax), %rcx
 2107 049e 488D55B0 		leaq	-80(%rbp), %rdx
 2108 04a2 488B4598 		movq	-104(%rbp), %rax
 2109 04a6 4889CE   		movq	%rcx, %rsi
 2110 04a9 4889C7   		movq	%rax, %rdi
 2111 04ac E8000000 		call	ssl_write_signature_algorithms_ext
 2111      00
1017:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ext_len += olen;
 2112              		.loc 3 1017 13
 2113 04b1 488B45B0 		movq	-80(%rbp), %rax
GAS LISTING /tmp/cc8psT5X.s 			page 83


 2114 04b5 480145C8 		addq	%rax, -56(%rbp)
1018:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
1019:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1020:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_ECDH_C) || defined(MBEDTLS_ECDSA_C) || \
1021:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
1022:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( uses_ec )
 2115              		.loc 3 1022 7
 2116 04b9 837DA800 		cmpl	$0, -88(%rbp)
 2117 04bd 7456     		je	.L132
1023:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1024:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl_write_supported_elliptic_curves_ext( ssl, p + 2 + ext_len, &olen );
 2118              		.loc 3 1024 61
 2119 04bf 488B45C8 		movq	-56(%rbp), %rax
 2120 04c3 488D5002 		leaq	2(%rax), %rdx
 2121              		.loc 3 1024 9
 2122 04c7 488B45D0 		movq	-48(%rbp), %rax
 2123 04cb 488D0C02 		leaq	(%rdx,%rax), %rcx
 2124 04cf 488D55B0 		leaq	-80(%rbp), %rdx
 2125 04d3 488B4598 		movq	-104(%rbp), %rax
 2126 04d7 4889CE   		movq	%rcx, %rsi
 2127 04da 4889C7   		movq	%rax, %rdi
 2128 04dd E8000000 		call	ssl_write_supported_elliptic_curves_ext
 2128      00
1025:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ext_len += olen;
 2129              		.loc 3 1025 17
 2130 04e2 488B45B0 		movq	-80(%rbp), %rax
 2131 04e6 480145C8 		addq	%rax, -56(%rbp)
1026:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1027:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl_write_supported_point_formats_ext( ssl, p + 2 + ext_len, &olen );
 2132              		.loc 3 1027 59
 2133 04ea 488B45C8 		movq	-56(%rbp), %rax
 2134 04ee 488D5002 		leaq	2(%rax), %rdx
 2135              		.loc 3 1027 9
 2136 04f2 488B45D0 		movq	-48(%rbp), %rax
 2137 04f6 488D0C02 		leaq	(%rdx,%rax), %rcx
 2138 04fa 488D55B0 		leaq	-80(%rbp), %rdx
 2139 04fe 488B4598 		movq	-104(%rbp), %rax
 2140 0502 4889CE   		movq	%rcx, %rsi
 2141 0505 4889C7   		movq	%rax, %rdi
 2142 0508 E8000000 		call	ssl_write_supported_point_formats_ext
 2142      00
1028:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ext_len += olen;
 2143              		.loc 3 1028 17
 2144 050d 488B45B0 		movq	-80(%rbp), %rax
 2145 0511 480145C8 		addq	%rax, -56(%rbp)
 2146              	.L132:
1029:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1030:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
1031:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1032:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
1033:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl_write_ecjpake_kkpp_ext( ssl, p + 2 + ext_len, &olen );
1034:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ext_len += olen;
1035:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
1036:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1037:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_MAX_FRAGMENT_LENGTH)
1038:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl_write_max_fragment_length_ext( ssl, p + 2 + ext_len, &olen );
 2147              		.loc 3 1038 51
GAS LISTING /tmp/cc8psT5X.s 			page 84


 2148 0515 488B45C8 		movq	-56(%rbp), %rax
 2149 0519 488D5002 		leaq	2(%rax), %rdx
 2150              		.loc 3 1038 5
 2151 051d 488B45D0 		movq	-48(%rbp), %rax
 2152 0521 488D0C02 		leaq	(%rdx,%rax), %rcx
 2153 0525 488D55B0 		leaq	-80(%rbp), %rdx
 2154 0529 488B4598 		movq	-104(%rbp), %rax
 2155 052d 4889CE   		movq	%rcx, %rsi
 2156 0530 4889C7   		movq	%rax, %rdi
 2157 0533 E8000000 		call	ssl_write_max_fragment_length_ext
 2157      00
1039:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ext_len += olen;
 2158              		.loc 3 1039 13
 2159 0538 488B45B0 		movq	-80(%rbp), %rax
 2160 053c 480145C8 		addq	%rax, -56(%rbp)
1040:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
1041:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1042:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_TRUNCATED_HMAC)
1043:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl_write_truncated_hmac_ext( ssl, p + 2 + ext_len, &olen );
1044:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ext_len += olen;
1045:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
1046:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1047:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_ENCRYPT_THEN_MAC)
1048:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl_write_encrypt_then_mac_ext( ssl, p + 2 + ext_len, &olen );
1049:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ext_len += olen;
1050:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
1051:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1052:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_EXTENDED_MASTER_SECRET)
1053:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl_write_extended_ms_ext( ssl, p + 2 + ext_len, &olen );
 2161              		.loc 3 1053 43
 2162 0540 488B45C8 		movq	-56(%rbp), %rax
 2163 0544 488D5002 		leaq	2(%rax), %rdx
 2164              		.loc 3 1053 5
 2165 0548 488B45D0 		movq	-48(%rbp), %rax
 2166 054c 488D0C02 		leaq	(%rdx,%rax), %rcx
 2167 0550 488D55B0 		leaq	-80(%rbp), %rdx
 2168 0554 488B4598 		movq	-104(%rbp), %rax
 2169 0558 4889CE   		movq	%rcx, %rsi
 2170 055b 4889C7   		movq	%rax, %rdi
 2171 055e E8000000 		call	ssl_write_extended_ms_ext
 2171      00
1054:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ext_len += olen;
 2172              		.loc 3 1054 13
 2173 0563 488B45B0 		movq	-80(%rbp), %rax
 2174 0567 480145C8 		addq	%rax, -56(%rbp)
1055:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
1056:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1057:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_ALPN)
1058:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl_write_alpn_ext( ssl, p + 2 + ext_len, &olen );
1059:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ext_len += olen;
1060:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
1061:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1062:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_SESSION_TICKETS)
1063:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl_write_session_ticket_ext( ssl, p + 2 + ext_len, &olen );
 2175              		.loc 3 1063 46
 2176 056b 488B45C8 		movq	-56(%rbp), %rax
 2177 056f 488D5002 		leaq	2(%rax), %rdx
GAS LISTING /tmp/cc8psT5X.s 			page 85


 2178              		.loc 3 1063 5
 2179 0573 488B45D0 		movq	-48(%rbp), %rax
 2180 0577 488D0C02 		leaq	(%rdx,%rax), %rcx
 2181 057b 488D55B0 		leaq	-80(%rbp), %rdx
 2182 057f 488B4598 		movq	-104(%rbp), %rax
 2183 0583 4889CE   		movq	%rcx, %rsi
 2184 0586 4889C7   		movq	%rax, %rdi
 2185 0589 E8000000 		call	ssl_write_session_ticket_ext
 2185      00
1064:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ext_len += olen;
 2186              		.loc 3 1064 13
 2187 058e 488B45B0 		movq	-80(%rbp), %rax
 2188 0592 480145C8 		addq	%rax, -56(%rbp)
1065:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
1066:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1067:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /* olen unused if all extensions are disabled */
1068:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ((void) olen);
1069:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1070:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "client hello, total extension length: %d",
1071:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                    ext_len ) );
1072:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1073:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ext_len > 0 )
 2189              		.loc 3 1073 7
 2190 0596 48837DC8 		cmpq	$0, -56(%rbp)
 2190      00
 2191 059b 7435     		je	.L133
1074:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1075:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *p++ = (unsigned char)( ( ext_len >> 8 ) & 0xFF );
 2192              		.loc 3 1075 43
 2193 059d 488B45C8 		movq	-56(%rbp), %rax
 2194 05a1 48C1E808 		shrq	$8, %rax
 2195 05a5 4889C1   		movq	%rax, %rcx
 2196              		.loc 3 1075 11
 2197 05a8 488B45D0 		movq	-48(%rbp), %rax
 2198 05ac 488D5001 		leaq	1(%rax), %rdx
 2199 05b0 488955D0 		movq	%rdx, -48(%rbp)
 2200              		.loc 3 1075 16
 2201 05b4 89CA     		movl	%ecx, %edx
 2202              		.loc 3 1075 14
 2203 05b6 8810     		movb	%dl, (%rax)
1076:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *p++ = (unsigned char)( ( ext_len      ) & 0xFF );
 2204              		.loc 3 1076 11
 2205 05b8 488B45D0 		movq	-48(%rbp), %rax
 2206 05bc 488D5001 		leaq	1(%rax), %rdx
 2207 05c0 488955D0 		movq	%rdx, -48(%rbp)
 2208              		.loc 3 1076 16
 2209 05c4 488B55C8 		movq	-56(%rbp), %rdx
 2210              		.loc 3 1076 14
 2211 05c8 8810     		movb	%dl, (%rax)
1077:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         p += ext_len;
 2212              		.loc 3 1077 11
 2213 05ca 488B45C8 		movq	-56(%rbp), %rax
 2214 05ce 480145D0 		addq	%rax, -48(%rbp)
 2215              	.L133:
1078:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1079:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1080:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->out_msglen  = p - buf;
GAS LISTING /tmp/cc8psT5X.s 			page 86


 2216              		.loc 3 1080 26
 2217 05d2 488B45D0 		movq	-48(%rbp), %rax
 2218 05d6 482B45D8 		subq	-40(%rbp), %rax
 2219 05da 4889C2   		movq	%rax, %rdx
 2220              		.loc 3 1080 22
 2221 05dd 488B4598 		movq	-104(%rbp), %rax
 2222 05e1 48899038 		movq	%rdx, 312(%rax)
 2222      010000
1081:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->out_msgtype = MBEDTLS_SSL_MSG_HANDSHAKE;
 2223              		.loc 3 1081 22
 2224 05e8 488B4598 		movq	-104(%rbp), %rax
 2225 05ec C7803001 		movl	$22, 304(%rax)
 2225      00001600 
 2225      0000
1082:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->out_msg[0]  = MBEDTLS_SSL_HS_CLIENT_HELLO;
 2226              		.loc 3 1082 8
 2227 05f6 488B4598 		movq	-104(%rbp), %rax
 2228 05fa 488B8028 		movq	296(%rax), %rax
 2228      010000
 2229              		.loc 3 1082 22
 2230 0601 C60001   		movb	$1, (%rax)
1083:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1084:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->state++;
 2231              		.loc 3 1084 8
 2232 0604 488B4598 		movq	-104(%rbp), %rax
 2233 0608 8B4008   		movl	8(%rax), %eax
 2234              		.loc 3 1084 15
 2235 060b 8D5001   		leal	1(%rax), %edx
 2236 060e 488B4598 		movq	-104(%rbp), %rax
 2237 0612 895008   		movl	%edx, 8(%rax)
1085:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1086:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
1087:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
1088:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_flight_completed( ssl );
1089:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
1090:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1091:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( ret = mbedtls_ssl_write_handshake_msg( ssl ) ) != 0 )
 2238              		.loc 3 1091 17
 2239 0615 488B4598 		movq	-104(%rbp), %rax
 2240 0619 4889C7   		movq	%rax, %rdi
 2241 061c E8000000 		call	mbedtls_ssl_write_handshake_msg@PLT
 2241      00
 2242 0621 8945AC   		movl	%eax, -84(%rbp)
 2243              		.loc 3 1091 7
 2244 0624 837DAC00 		cmpl	$0, -84(%rbp)
 2245 0628 7405     		je	.L134
1092:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1093:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_write_handshake_msg", ret );
1094:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( ret );
 2246              		.loc 3 1094 15
 2247 062a 8B45AC   		movl	-84(%rbp), %eax
 2248 062d EB05     		jmp	.L135
 2249              	.L134:
1095:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1096:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1097:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
1098:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
GAS LISTING /tmp/cc8psT5X.s 			page 87


1099:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ( ret = mbedtls_ssl_flight_transmit( ssl ) ) != 0 )
1100:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1101:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_flight_transmit", ret );
1102:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( ret );
1103:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1104:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
1105:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1106:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= write client hello" ) );
1107:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1108:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( 0 );
 2250              		.loc 3 1108 11
 2251 062f B8000000 		movl	$0, %eax
 2251      00
 2252              	.L135:
1109:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 2253              		.loc 3 1109 1 discriminator 1
 2254 0634 488B7DF8 		movq	-8(%rbp), %rdi
 2255 0638 6448333C 		xorq	%fs:40, %rdi
 2255      25280000 
 2255      00
 2256 0641 7405     		je	.L136
 2257              		.loc 3 1109 1 is_stmt 0
 2258 0643 E8000000 		call	__stack_chk_fail@PLT
 2258      00
 2259              	.L136:
 2260 0648 C9       		leave
 2261              	.LCFI47:
 2262              		.cfi_def_cfa 7, 8
 2263 0649 C3       		ret
 2264              		.cfi_endproc
 2265              	.LFE36:
 2267              		.section	.text.ssl_parse_renegotiation_info,"ax",@progbits
 2269              	ssl_parse_renegotiation_info:
 2270              	.LFB37:
1110:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1111:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_parse_renegotiation_info( mbedtls_ssl_context *ssl,
1112:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                          const unsigned char *buf,
1113:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                          size_t len )
1114:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 2271              		.loc 3 1114 1 is_stmt 1
 2272              		.cfi_startproc
 2273 0000 F30F1EFA 		endbr64
 2274 0004 55       		pushq	%rbp
 2275              	.LCFI48:
 2276              		.cfi_def_cfa_offset 16
 2277              		.cfi_offset 6, -16
 2278 0005 4889E5   		movq	%rsp, %rbp
 2279              	.LCFI49:
 2280              		.cfi_def_cfa_register 6
 2281 0008 4883EC30 		subq	$48, %rsp
 2282 000c 48897DE8 		movq	%rdi, -24(%rbp)
 2283 0010 488975E0 		movq	%rsi, -32(%rbp)
 2284 0014 488955D8 		movq	%rdx, -40(%rbp)
 2285              		.loc 3 1114 1
 2286 0018 64488B04 		movq	%fs:40, %rax
 2286      25280000 
 2286      00
GAS LISTING /tmp/cc8psT5X.s 			page 88


 2287 0021 488945F8 		movq	%rax, -8(%rbp)
 2288 0025 31C0     		xorl	%eax, %eax
1115:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
1116:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->renego_status != MBEDTLS_SSL_INITIAL_HANDSHAKE )
 2289              		.loc 3 1116 12
 2290 0027 488B45E8 		movq	-24(%rbp), %rax
 2291 002b 8B400C   		movl	12(%rax), %eax
 2292              		.loc 3 1116 7
 2293 002e 85C0     		testl	%eax, %eax
 2294 0030 0F84BE00 		je	.L139
 2294      0000
1117:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1118:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         /* Check verify-data in constant-time. The length OTOH is no secret */
1119:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( len    != 1 + ssl->verify_data_len * 2 ||
 2295              		.loc 3 1119 30
 2296 0036 488B45E8 		movq	-24(%rbp), %rax
 2297 003a 488B8068 		movq	360(%rax), %rax
 2297      010000
 2298              		.loc 3 1119 48
 2299 0041 4801C0   		addq	%rax, %rax
 2300              		.loc 3 1119 25
 2301 0044 4883C001 		addq	$1, %rax
 2302              		.loc 3 1119 11
 2303 0048 483945D8 		cmpq	%rax, -40(%rbp)
 2304 004c 0F858500 		jne	.L140
 2304      0000
1120:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             buf[0] !=     ssl->verify_data_len * 2 ||
 2305              		.loc 3 1120 16 discriminator 1
 2306 0052 488B45E0 		movq	-32(%rbp), %rax
 2307 0056 0FB600   		movzbl	(%rax), %eax
 2308 0059 0FB6D0   		movzbl	%al, %edx
 2309              		.loc 3 1120 30 discriminator 1
 2310 005c 488B45E8 		movq	-24(%rbp), %rax
 2311 0060 488B8068 		movq	360(%rax), %rax
 2311      010000
 2312              		.loc 3 1120 48 discriminator 1
 2313 0067 4801C0   		addq	%rax, %rax
1119:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             buf[0] !=     ssl->verify_data_len * 2 ||
 2314              		.loc 3 1119 52 discriminator 1
 2315 006a 4839C2   		cmpq	%rax, %rdx
 2316 006d 7568     		jne	.L140
1121:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_safer_memcmp( buf + 1,
 2317              		.loc 3 1121 13
 2318 006f 488B45E8 		movq	-24(%rbp), %rax
 2319 0073 488B8068 		movq	360(%rax), %rax
 2319      010000
1122:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                           ssl->own_verify_data, ssl->verify_data_len ) != 0 ||
 2320              		.loc 3 1122 30
 2321 007a 488B55E8 		movq	-24(%rbp), %rdx
 2322 007e 488DB270 		leaq	368(%rdx), %rsi
 2322      010000
1121:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_safer_memcmp( buf + 1,
 2323              		.loc 3 1121 43
 2324 0085 488B55E0 		movq	-32(%rbp), %rdx
 2325 0089 488D4A01 		leaq	1(%rdx), %rcx
1121:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_safer_memcmp( buf + 1,
 2326              		.loc 3 1121 13
GAS LISTING /tmp/cc8psT5X.s 			page 89


 2327 008d 4889C2   		movq	%rax, %rdx
 2328 0090 4889CF   		movq	%rcx, %rdi
 2329 0093 E8000000 		call	mbedtls_ssl_safer_memcmp
 2329      00
1120:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_safer_memcmp( buf + 1,
 2330              		.loc 3 1120 52
 2331 0098 85C0     		testl	%eax, %eax
 2332 009a 753B     		jne	.L140
1123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_safer_memcmp( buf + 1 + ssl->verify_data_len,
 2333              		.loc 3 1123 13
 2334 009c 488B45E8 		movq	-24(%rbp), %rax
 2335 00a0 488B8068 		movq	360(%rax), %rax
 2335      010000
1124:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                           ssl->peer_verify_data, ssl->verify_data_len ) != 0 )
 2336              		.loc 3 1124 30
 2337 00a7 488B55E8 		movq	-24(%rbp), %rdx
 2338 00ab 488DB27C 		leaq	380(%rdx), %rsi
 2338      010000
1123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_safer_memcmp( buf + 1 + ssl->verify_data_len,
 2339              		.loc 3 1123 52
 2340 00b2 488B55E8 		movq	-24(%rbp), %rdx
 2341 00b6 488B9268 		movq	360(%rdx), %rdx
 2341      010000
1123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_safer_memcmp( buf + 1 + ssl->verify_data_len,
 2342              		.loc 3 1123 47
 2343 00bd 488D4A01 		leaq	1(%rdx), %rcx
 2344 00c1 488B55E0 		movq	-32(%rbp), %rdx
 2345 00c5 4801D1   		addq	%rdx, %rcx
1123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_safer_memcmp( buf + 1 + ssl->verify_data_len,
 2346              		.loc 3 1123 13
 2347 00c8 4889C2   		movq	%rax, %rdx
 2348 00cb 4889CF   		movq	%rcx, %rdi
 2349 00ce E8000000 		call	mbedtls_ssl_safer_memcmp
 2349      00
1122:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_safer_memcmp( buf + 1 + ssl->verify_data_len,
 2350              		.loc 3 1122 77
 2351 00d3 85C0     		testl	%eax, %eax
 2352 00d5 745A     		je	.L141
 2353              	.L140:
1125:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
1126:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "non-matching renegotiation info" ) );
1127:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 2354              		.loc 3 1127 13
 2355 00d7 488B45E8 		movq	-24(%rbp), %rax
 2356 00db BA280000 		movl	$40, %edx
 2356      00
 2357 00e0 BE020000 		movl	$2, %esi
 2357      00
 2358 00e5 4889C7   		movq	%rax, %rdi
 2359 00e8 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 2359      00
1128:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                             MBEDTLS_SSL_ALERT_MSG_HANDSHAKE_FAILURE );
1129:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
 2360              		.loc 3 1129 19
 2361 00ed B88086FF 		movl	$-31104, %eax
 2361      FF
 2362 00f2 EB42     		jmp	.L142
GAS LISTING /tmp/cc8psT5X.s 			page 90


 2363              	.L139:
1130:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
1131:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1132:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     else
1133:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_RENEGOTIATION */
1134:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1135:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( len != 1 || buf[0] != 0x00 )
 2364              		.loc 3 1135 11
 2365 00f4 48837DD8 		cmpq	$1, -40(%rbp)
 2365      01
 2366 00f9 750B     		jne	.L143
 2367              		.loc 3 1135 28 discriminator 1
 2368 00fb 488B45E0 		movq	-32(%rbp), %rax
 2369 00ff 0FB600   		movzbl	(%rax), %eax
 2370              		.loc 3 1135 22 discriminator 1
 2371 0102 84C0     		testb	%al, %al
 2372 0104 741D     		je	.L144
 2373              	.L143:
1136:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
1137:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "non-zero length renegotiation info" ) );
1138:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 2374              		.loc 3 1138 13
 2375 0106 488B45E8 		movq	-24(%rbp), %rax
 2376 010a BA280000 		movl	$40, %edx
 2376      00
 2377 010f BE020000 		movl	$2, %esi
 2377      00
 2378 0114 4889C7   		movq	%rax, %rdi
 2379 0117 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 2379      00
1139:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                             MBEDTLS_SSL_ALERT_MSG_HANDSHAKE_FAILURE );
1140:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
 2380              		.loc 3 1140 19
 2381 011c B88086FF 		movl	$-31104, %eax
 2381      FF
 2382 0121 EB13     		jmp	.L142
 2383              	.L144:
1141:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
1142:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1143:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->secure_renegotiation = MBEDTLS_SSL_SECURE_RENEGOTIATION;
 2384              		.loc 3 1143 35
 2385 0123 488B45E8 		movq	-24(%rbp), %rax
 2386 0127 C7806001 		movl	$1, 352(%rax)
 2386      00000100 
 2386      0000
 2387              	.L141:
1144:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1145:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1146:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( 0 );
 2388              		.loc 3 1146 11
 2389 0131 B8000000 		movl	$0, %eax
 2389      00
 2390              	.L142:
1147:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 2391              		.loc 3 1147 1
 2392 0136 488B7DF8 		movq	-8(%rbp), %rdi
 2393 013a 6448333C 		xorq	%fs:40, %rdi
GAS LISTING /tmp/cc8psT5X.s 			page 91


 2393      25280000 
 2393      00
 2394 0143 7405     		je	.L145
 2395 0145 E8000000 		call	__stack_chk_fail@PLT
 2395      00
 2396              	.L145:
 2397 014a C9       		leave
 2398              	.LCFI50:
 2399              		.cfi_def_cfa 7, 8
 2400 014b C3       		ret
 2401              		.cfi_endproc
 2402              	.LFE37:
 2404              		.section	.text.ssl_parse_max_fragment_length_ext,"ax",@progbits
 2406              	ssl_parse_max_fragment_length_ext:
 2407              	.LFB38:
1148:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1149:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_MAX_FRAGMENT_LENGTH)
1150:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_parse_max_fragment_length_ext( mbedtls_ssl_context *ssl,
1151:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                               const unsigned char *buf,
1152:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                               size_t len )
1153:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 2408              		.loc 3 1153 1
 2409              		.cfi_startproc
 2410 0000 F30F1EFA 		endbr64
 2411 0004 55       		pushq	%rbp
 2412              	.LCFI51:
 2413              		.cfi_def_cfa_offset 16
 2414              		.cfi_offset 6, -16
 2415 0005 4889E5   		movq	%rsp, %rbp
 2416              	.LCFI52:
 2417              		.cfi_def_cfa_register 6
 2418 0008 4883EC30 		subq	$48, %rsp
 2419 000c 48897DE8 		movq	%rdi, -24(%rbp)
 2420 0010 488975E0 		movq	%rsi, -32(%rbp)
 2421 0014 488955D8 		movq	%rdx, -40(%rbp)
 2422              		.loc 3 1153 1
 2423 0018 64488B04 		movq	%fs:40, %rax
 2423      25280000 
 2423      00
 2424 0021 488945F8 		movq	%rax, -8(%rbp)
 2425 0025 31C0     		xorl	%eax, %eax
1154:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
1155:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * server should use the extension only if we did,
1156:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * and if so the server's value should match ours (and len is always 1)
1157:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
1158:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->mfl_code == MBEDTLS_SSL_MAX_FRAG_LEN_NONE ||
 2426              		.loc 3 1158 12
 2427 0027 488B45E8 		movq	-24(%rbp), %rax
 2428 002b 488B00   		movq	(%rax), %rax
 2429              		.loc 3 1158 29
 2430 002e 0FB780BC 		movzwl	188(%rax), %eax
 2430      000000
 2431 0035 6625C001 		andw	$448, %ax
 2432              		.loc 3 1158 7
 2433 0039 6685C0   		testw	%ax, %ax
 2434 003c 7427     		je	.L147
 2435              		.loc 3 1158 62 discriminator 1
GAS LISTING /tmp/cc8psT5X.s 			page 92


 2436 003e 48837DD8 		cmpq	$1, -40(%rbp)
 2436      01
 2437 0043 7520     		jne	.L147
1159:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         len != 1 ||
1160:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         buf[0] != ssl->conf->mfl_code )
 2438              		.loc 3 1160 12
 2439 0045 488B45E0 		movq	-32(%rbp), %rax
 2440 0049 0FB610   		movzbl	(%rax), %edx
 2441              		.loc 3 1160 22
 2442 004c 488B45E8 		movq	-24(%rbp), %rax
 2443 0050 488B00   		movq	(%rax), %rax
 2444              		.loc 3 1160 28
 2445 0053 0FB780BC 		movzwl	188(%rax), %eax
 2445      000000
 2446 005a 66C1E806 		shrw	$6, %ax
 2447 005e 83E007   		andl	$7, %eax
1159:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         len != 1 ||
 2448              		.loc 3 1159 18
 2449 0061 38C2     		cmpb	%al, %dl
 2450 0063 741D     		je	.L148
 2451              	.L147:
1161:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1162:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "non-matching max fragment length extension" ) );
1163:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 2452              		.loc 3 1163 9
 2453 0065 488B45E8 		movq	-24(%rbp), %rax
 2454 0069 BA280000 		movl	$40, %edx
 2454      00
 2455 006e BE020000 		movl	$2, %esi
 2455      00
 2456 0073 4889C7   		movq	%rax, %rdi
 2457 0076 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 2457      00
1164:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_HANDSHAKE_FAILURE );
1165:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
 2458              		.loc 3 1165 15
 2459 007b B88086FF 		movl	$-31104, %eax
 2459      FF
 2460 0080 EB05     		jmp	.L149
 2461              	.L148:
1166:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1167:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1168:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( 0 );
 2462              		.loc 3 1168 11
 2463 0082 B8000000 		movl	$0, %eax
 2463      00
 2464              	.L149:
1169:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 2465              		.loc 3 1169 1
 2466 0087 488B4DF8 		movq	-8(%rbp), %rcx
 2467 008b 6448330C 		xorq	%fs:40, %rcx
 2467      25280000 
 2467      00
 2468 0094 7405     		je	.L150
 2469 0096 E8000000 		call	__stack_chk_fail@PLT
 2469      00
 2470              	.L150:
GAS LISTING /tmp/cc8psT5X.s 			page 93


 2471 009b C9       		leave
 2472              	.LCFI53:
 2473              		.cfi_def_cfa 7, 8
 2474 009c C3       		ret
 2475              		.cfi_endproc
 2476              	.LFE38:
 2478              		.section	.text.ssl_parse_extended_ms_ext,"ax",@progbits
 2480              	ssl_parse_extended_ms_ext:
 2481              	.LFB39:
1170:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_MAX_FRAGMENT_LENGTH */
1171:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1172:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_TRUNCATED_HMAC)
1173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_parse_truncated_hmac_ext( mbedtls_ssl_context *ssl,
1174:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                          const unsigned char *buf,
1175:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                          size_t len )
1176:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
1177:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->trunc_hmac == MBEDTLS_SSL_TRUNC_HMAC_DISABLED ||
1178:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         len != 0 )
1179:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1180:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "non-matching truncated HMAC extension" ) );
1181:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
1182:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_HANDSHAKE_FAILURE );
1183:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
1184:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1185:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1186:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ((void) buf);
1187:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1188:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->session_negotiate->trunc_hmac = MBEDTLS_SSL_TRUNC_HMAC_ENABLED;
1189:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1190:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( 0 );
1191:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
1192:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_TRUNCATED_HMAC */
1193:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1194:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_ENCRYPT_THEN_MAC)
1195:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_parse_encrypt_then_mac_ext( mbedtls_ssl_context *ssl,
1196:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                          const unsigned char *buf,
1197:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                          size_t len )
1198:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
1199:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->encrypt_then_mac == MBEDTLS_SSL_ETM_DISABLED ||
1200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 ||
1201:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         len != 0 )
1202:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1203:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "non-matching encrypt-then-MAC extension" ) );
1204:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
1205:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_HANDSHAKE_FAILURE );
1206:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
1207:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1208:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1209:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ((void) buf);
1210:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1211:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->session_negotiate->encrypt_then_mac = MBEDTLS_SSL_ETM_ENABLED;
1212:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1213:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( 0 );
1214:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
1215:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_ENCRYPT_THEN_MAC */
1216:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1217:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_EXTENDED_MASTER_SECRET)
GAS LISTING /tmp/cc8psT5X.s 			page 94


1218:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_parse_extended_ms_ext( mbedtls_ssl_context *ssl,
1219:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                          const unsigned char *buf,
1220:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                          size_t len )
1221:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 2482              		.loc 3 1221 1
 2483              		.cfi_startproc
 2484 0000 F30F1EFA 		endbr64
 2485 0004 55       		pushq	%rbp
 2486              	.LCFI54:
 2487              		.cfi_def_cfa_offset 16
 2488              		.cfi_offset 6, -16
 2489 0005 4889E5   		movq	%rsp, %rbp
 2490              	.LCFI55:
 2491              		.cfi_def_cfa_register 6
 2492 0008 4883EC30 		subq	$48, %rsp
 2493 000c 48897DE8 		movq	%rdi, -24(%rbp)
 2494 0010 488975E0 		movq	%rsi, -32(%rbp)
 2495 0014 488955D8 		movq	%rdx, -40(%rbp)
 2496              		.loc 3 1221 1
 2497 0018 64488B04 		movq	%fs:40, %rax
 2497      25280000 
 2497      00
 2498 0021 488945F8 		movq	%rax, -8(%rbp)
 2499 0025 31C0     		xorl	%eax, %eax
1222:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->extended_ms == MBEDTLS_SSL_EXTENDED_MS_DISABLED ||
 2500              		.loc 3 1222 12
 2501 0027 488B45E8 		movq	-24(%rbp), %rax
 2502 002b 488B00   		movq	(%rax), %rax
 2503              		.loc 3 1222 32
 2504 002e 0FB680BD 		movzbl	189(%rax), %eax
 2504      000000
 2505 0035 83E002   		andl	$2, %eax
 2506              		.loc 3 1222 7
 2507 0038 84C0     		testb	%al, %al
 2508 003a 7412     		je	.L152
1223:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 ||
 2509              		.loc 3 1223 12 discriminator 1
 2510 003c 488B45E8 		movq	-24(%rbp), %rax
 2511 0040 8B4018   		movl	24(%rax), %eax
1222:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->extended_ms == MBEDTLS_SSL_EXTENDED_MS_DISABLED ||
 2512              		.loc 3 1222 68 discriminator 1
 2513 0043 85C0     		testl	%eax, %eax
 2514 0045 7407     		je	.L152
 2515              		.loc 3 1223 55
 2516 0047 48837DD8 		cmpq	$0, -40(%rbp)
 2516      00
 2517 004c 741D     		je	.L153
 2518              	.L152:
1224:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         len != 0 )
1225:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1226:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "non-matching extended master secret extension" ) );
1227:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 2519              		.loc 3 1227 9
 2520 004e 488B45E8 		movq	-24(%rbp), %rax
 2521 0052 BA280000 		movl	$40, %edx
 2521      00
 2522 0057 BE020000 		movl	$2, %esi
GAS LISTING /tmp/cc8psT5X.s 			page 95


 2522      00
 2523 005c 4889C7   		movq	%rax, %rdi
 2524 005f E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 2524      00
1228:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_HANDSHAKE_FAILURE );
1229:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
 2525              		.loc 3 1229 15
 2526 0064 B88086FF 		movl	$-31104, %eax
 2526      FF
 2527 0069 EB17     		jmp	.L154
 2528              	.L153:
1230:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1231:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1232:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ((void) buf);
1233:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1234:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->handshake->extended_ms = MBEDTLS_SSL_EXTENDED_MS_ENABLED;
 2529              		.loc 3 1234 8
 2530 006b 488B45E8 		movq	-24(%rbp), %rax
 2531 006f 488B4060 		movq	96(%rax), %rax
 2532              		.loc 3 1234 33
 2533 0073 C780B003 		movl	$1, 944(%rax)
 2533      00000100 
 2533      0000
1235:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1236:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( 0 );
 2534              		.loc 3 1236 11
 2535 007d B8000000 		movl	$0, %eax
 2535      00
 2536              	.L154:
1237:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 2537              		.loc 3 1237 1
 2538 0082 488B4DF8 		movq	-8(%rbp), %rcx
 2539 0086 6448330C 		xorq	%fs:40, %rcx
 2539      25280000 
 2539      00
 2540 008f 7405     		je	.L155
 2541 0091 E8000000 		call	__stack_chk_fail@PLT
 2541      00
 2542              	.L155:
 2543 0096 C9       		leave
 2544              	.LCFI56:
 2545              		.cfi_def_cfa 7, 8
 2546 0097 C3       		ret
 2547              		.cfi_endproc
 2548              	.LFE39:
 2550              		.section	.text.ssl_parse_session_ticket_ext,"ax",@progbits
 2552              	ssl_parse_session_ticket_ext:
 2553              	.LFB40:
1238:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_EXTENDED_MASTER_SECRET */
1239:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1240:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_SESSION_TICKETS)
1241:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_parse_session_ticket_ext( mbedtls_ssl_context *ssl,
1242:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                          const unsigned char *buf,
1243:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                          size_t len )
1244:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 2554              		.loc 3 1244 1
 2555              		.cfi_startproc
GAS LISTING /tmp/cc8psT5X.s 			page 96


 2556 0000 F30F1EFA 		endbr64
 2557 0004 55       		pushq	%rbp
 2558              	.LCFI57:
 2559              		.cfi_def_cfa_offset 16
 2560              		.cfi_offset 6, -16
 2561 0005 4889E5   		movq	%rsp, %rbp
 2562              	.LCFI58:
 2563              		.cfi_def_cfa_register 6
 2564 0008 4883EC30 		subq	$48, %rsp
 2565 000c 48897DE8 		movq	%rdi, -24(%rbp)
 2566 0010 488975E0 		movq	%rsi, -32(%rbp)
 2567 0014 488955D8 		movq	%rdx, -40(%rbp)
 2568              		.loc 3 1244 1
 2569 0018 64488B04 		movq	%fs:40, %rax
 2569      25280000 
 2569      00
 2570 0021 488945F8 		movq	%rax, -8(%rbp)
 2571 0025 31C0     		xorl	%eax, %eax
1245:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->session_tickets == MBEDTLS_SSL_SESSION_TICKETS_DISABLED ||
 2572              		.loc 3 1245 12
 2573 0027 488B45E8 		movq	-24(%rbp), %rax
 2574 002b 488B00   		movq	(%rax), %rax
 2575              		.loc 3 1245 36
 2576 002e 0FB680BD 		movzbl	189(%rax), %eax
 2576      000000
 2577 0035 83E008   		andl	$8, %eax
 2578              		.loc 3 1245 7
 2579 0038 84C0     		testb	%al, %al
 2580 003a 7407     		je	.L157
 2581              		.loc 3 1245 76 discriminator 1
 2582 003c 48837DD8 		cmpq	$0, -40(%rbp)
 2582      00
 2583 0041 741D     		je	.L158
 2584              	.L157:
1246:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         len != 0 )
1247:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1248:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "non-matching session ticket extension" ) );
1249:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 2585              		.loc 3 1249 9
 2586 0043 488B45E8 		movq	-24(%rbp), %rax
 2587 0047 BA280000 		movl	$40, %edx
 2587      00
 2588 004c BE020000 		movl	$2, %esi
 2588      00
 2589 0051 4889C7   		movq	%rax, %rdi
 2590 0054 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 2590      00
1250:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_HANDSHAKE_FAILURE );
1251:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
 2591              		.loc 3 1251 15
 2592 0059 B88086FF 		movl	$-31104, %eax
 2592      FF
 2593 005e EB17     		jmp	.L159
 2594              	.L158:
1252:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1253:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1254:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ((void) buf);
GAS LISTING /tmp/cc8psT5X.s 			page 97


1255:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1256:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->handshake->new_session_ticket = 1;
 2595              		.loc 3 1256 8
 2596 0060 488B45E8 		movq	-24(%rbp), %rax
 2597 0064 488B4060 		movq	96(%rax), %rax
 2598              		.loc 3 1256 40
 2599 0068 C780AC03 		movl	$1, 940(%rax)
 2599      00000100 
 2599      0000
1257:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1258:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( 0 );
 2600              		.loc 3 1258 11
 2601 0072 B8000000 		movl	$0, %eax
 2601      00
 2602              	.L159:
1259:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 2603              		.loc 3 1259 1
 2604 0077 488B4DF8 		movq	-8(%rbp), %rcx
 2605 007b 6448330C 		xorq	%fs:40, %rcx
 2605      25280000 
 2605      00
 2606 0084 7405     		je	.L160
 2607 0086 E8000000 		call	__stack_chk_fail@PLT
 2607      00
 2608              	.L160:
 2609 008b C9       		leave
 2610              	.LCFI59:
 2611              		.cfi_def_cfa 7, 8
 2612 008c C3       		ret
 2613              		.cfi_endproc
 2614              	.LFE40:
 2616              		.section	.text.ssl_parse_supported_point_formats_ext,"ax",@progbits
 2618              	ssl_parse_supported_point_formats_ext:
 2619              	.LFB41:
1260:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_SESSION_TICKETS */
1261:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1262:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_ECDH_C) || defined(MBEDTLS_ECDSA_C) || \
1263:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
1264:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_parse_supported_point_formats_ext( mbedtls_ssl_context *ssl,
1265:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                                   const unsigned char *buf,
1266:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                                   size_t len )
1267:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 2620              		.loc 3 1267 1
 2621              		.cfi_startproc
 2622 0000 F30F1EFA 		endbr64
 2623 0004 55       		pushq	%rbp
 2624              	.LCFI60:
 2625              		.cfi_def_cfa_offset 16
 2626              		.cfi_offset 6, -16
 2627 0005 4889E5   		movq	%rsp, %rbp
 2628              	.LCFI61:
 2629              		.cfi_def_cfa_register 6
 2630 0008 4883EC40 		subq	$64, %rsp
 2631 000c 48897DD8 		movq	%rdi, -40(%rbp)
 2632 0010 488975D0 		movq	%rsi, -48(%rbp)
 2633 0014 488955C8 		movq	%rdx, -56(%rbp)
 2634              		.loc 3 1267 1
GAS LISTING /tmp/cc8psT5X.s 			page 98


 2635 0018 64488B04 		movq	%fs:40, %rax
 2635      25280000 
 2635      00
 2636 0021 488945F8 		movq	%rax, -8(%rbp)
 2637 0025 31C0     		xorl	%eax, %eax
1268:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     size_t list_size;
1269:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const unsigned char *p;
1270:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1271:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( len == 0 || (size_t)( buf[0] + 1 ) != len )
 2638              		.loc 3 1271 7
 2639 0027 48837DC8 		cmpq	$0, -56(%rbp)
 2639      00
 2640 002c 7415     		je	.L162
 2641              		.loc 3 1271 34 discriminator 1
 2642 002e 488B45D0 		movq	-48(%rbp), %rax
 2643 0032 0FB600   		movzbl	(%rax), %eax
 2644 0035 0FB6C0   		movzbl	%al, %eax
 2645              		.loc 3 1271 38 discriminator 1
 2646 0038 83C001   		addl	$1, %eax
 2647              		.loc 3 1271 21 discriminator 1
 2648 003b 4898     		cltq
 2649              		.loc 3 1271 18 discriminator 1
 2650 003d 483945C8 		cmpq	%rax, -56(%rbp)
 2651 0041 741D     		je	.L163
 2652              	.L162:
1272:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1273:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server hello message" ) );
1274:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 2653              		.loc 3 1274 9
 2654 0043 488B45D8 		movq	-40(%rbp), %rax
 2655 0047 BA320000 		movl	$50, %edx
 2655      00
 2656 004c BE020000 		movl	$2, %esi
 2656      00
 2657 0051 4889C7   		movq	%rax, %rdi
 2658 0054 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 2658      00
1275:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
1276:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
 2659              		.loc 3 1276 15
 2660 0059 B88086FF 		movl	$-31104, %eax
 2660      FF
 2661 005e EB7D     		jmp	.L164
 2662              	.L163:
1277:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1278:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     list_size = buf[0];
 2663              		.loc 3 1278 20
 2664 0060 488B45D0 		movq	-48(%rbp), %rax
 2665 0064 0FB600   		movzbl	(%rax), %eax
 2666              		.loc 3 1278 15
 2667 0067 0FB6C0   		movzbl	%al, %eax
 2668 006a 488945E8 		movq	%rax, -24(%rbp)
1279:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1280:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     p = buf + 1;
 2669              		.loc 3 1280 7
 2670 006e 488B45D0 		movq	-48(%rbp), %rax
 2671 0072 4883C001 		addq	$1, %rax
GAS LISTING /tmp/cc8psT5X.s 			page 99


 2672 0076 488945F0 		movq	%rax, -16(%rbp)
1281:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     while( list_size > 0 )
 2673              		.loc 3 1281 10
 2674 007a EB3F     		jmp	.L165
 2675              	.L168:
1282:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1283:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( p[0] == MBEDTLS_ECP_PF_UNCOMPRESSED ||
 2676              		.loc 3 1283 14
 2677 007c 488B45F0 		movq	-16(%rbp), %rax
 2678 0080 0FB600   		movzbl	(%rax), %eax
 2679              		.loc 3 1283 11
 2680 0083 84C0     		testb	%al, %al
 2681 0085 740B     		je	.L166
1284:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             p[0] == MBEDTLS_ECP_PF_COMPRESSED )
 2682              		.loc 3 1284 14 discriminator 1
 2683 0087 488B45F0 		movq	-16(%rbp), %rax
 2684 008b 0FB600   		movzbl	(%rax), %eax
1283:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             p[0] == MBEDTLS_ECP_PF_COMPRESSED )
 2685              		.loc 3 1283 49 discriminator 1
 2686 008e 3C01     		cmpb	$1, %al
 2687 0090 751F     		jne	.L167
 2688              	.L166:
1285:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
1286:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_ECDH_C) || defined(MBEDTLS_ECDSA_C)
1287:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ssl->handshake->ecdh_ctx.point_format = p[0];
 2689              		.loc 3 1287 54
 2690 0092 488B45F0 		movq	-16(%rbp), %rax
 2691 0096 0FB610   		movzbl	(%rax), %edx
 2692              		.loc 3 1287 16
 2693 0099 488B45D8 		movq	-40(%rbp), %rax
 2694 009d 488B4060 		movq	96(%rax), %rax
 2695              		.loc 3 1287 54
 2696 00a1 0FB6D2   		movzbl	%dl, %edx
 2697              		.loc 3 1287 51
 2698 00a4 8990C001 		movl	%edx, 448(%rax)
 2698      0000
1288:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
1289:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
1290:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ssl->handshake->ecjpake_ctx.point_format = p[0];
1291:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
1292:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 4, ( "point format selected: %d", p[0] ) );
1293:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( 0 );
 2699              		.loc 3 1293 19
 2700 00aa B8000000 		movl	$0, %eax
 2700      00
 2701 00af EB2C     		jmp	.L164
 2702              	.L167:
1294:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
1295:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1296:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         list_size--;
 2703              		.loc 3 1296 18
 2704 00b1 48836DE8 		subq	$1, -24(%rbp)
 2704      01
1297:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         p++;
 2705              		.loc 3 1297 10
 2706 00b6 488345F0 		addq	$1, -16(%rbp)
 2706      01
GAS LISTING /tmp/cc8psT5X.s 			page 100


 2707              	.L165:
1281:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 2708              		.loc 3 1281 10
 2709 00bb 48837DE8 		cmpq	$0, -24(%rbp)
 2709      00
 2710 00c0 75BA     		jne	.L168
1298:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1299:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1300:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 1, ( "no point format in common" ) );
1301:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 2711              		.loc 3 1301 5
 2712 00c2 488B45D8 		movq	-40(%rbp), %rax
 2713 00c6 BA280000 		movl	$40, %edx
 2713      00
 2714 00cb BE020000 		movl	$2, %esi
 2714      00
 2715 00d0 4889C7   		movq	%rax, %rdi
 2716 00d3 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 2716      00
1302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                     MBEDTLS_SSL_ALERT_MSG_HANDSHAKE_FAILURE );
1303:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
 2717              		.loc 3 1303 11
 2718 00d8 B88086FF 		movl	$-31104, %eax
 2718      FF
 2719              	.L164:
1304:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 2720              		.loc 3 1304 1
 2721 00dd 488B4DF8 		movq	-8(%rbp), %rcx
 2722 00e1 6448330C 		xorq	%fs:40, %rcx
 2722      25280000 
 2722      00
 2723 00ea 7405     		je	.L169
 2724 00ec E8000000 		call	__stack_chk_fail@PLT
 2724      00
 2725              	.L169:
 2726 00f1 C9       		leave
 2727              	.LCFI62:
 2728              		.cfi_def_cfa 7, 8
 2729 00f2 C3       		ret
 2730              		.cfi_endproc
 2731              	.LFE41:
 2733              		.section	.text.ssl_parse_server_hello,"ax",@progbits
 2735              	ssl_parse_server_hello:
 2736              	.LFB42:
1305:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_ECDH_C || MBEDTLS_ECDSA_C ||
1306:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED */
1307:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1308:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
1309:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_parse_ecjpake_kkpp( mbedtls_ssl_context *ssl,
1310:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                    const unsigned char *buf,
1311:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                    size_t len )
1312:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
1313:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     int ret;
1314:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1315:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->transform_negotiate->ciphersuite_info->key_exchange !=
1316:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_KEY_EXCHANGE_ECJPAKE )
1317:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
GAS LISTING /tmp/cc8psT5X.s 			page 101


1318:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "skip ecjpake kkpp extension" ) );
1319:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( 0 );
1320:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1321:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1322:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /* If we got here, we no longer need our cached extension */
1323:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     mbedtls_free( ssl->handshake->ecjpake_cache );
1324:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->handshake->ecjpake_cache = NULL;
1325:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->handshake->ecjpake_cache_len = 0;
1326:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1327:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( ret = mbedtls_ecjpake_read_round_one( &ssl->handshake->ecjpake_ctx,
1328:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                                 buf, len ) ) != 0 )
1329:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1330:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ecjpake_read_round_one", ret );
1331:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
1332:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_HANDSHAKE_FAILURE );
1333:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( ret );
1334:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1335:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1336:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( 0 );
1337:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
1338:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED */
1339:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1340:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_ALPN)
1341:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_parse_alpn_ext( mbedtls_ssl_context *ssl,
1342:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                const unsigned char *buf, size_t len )
1343:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
1344:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     size_t list_len, name_len;
1345:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const char **p;
1346:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1347:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /* If we didn't send it, the server shouldn't send it */
1348:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->alpn_list == NULL )
1349:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1350:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "non-matching ALPN extension" ) );
1351:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
1352:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_HANDSHAKE_FAILURE );
1353:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
1354:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1355:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1356:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
1357:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * opaque ProtocolName<1..2^8-1>;
1358:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *
1359:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * struct {
1360:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     ProtocolName protocol_name_list<2..2^16-1>
1361:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * } ProtocolNameList;
1362:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *
1363:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * the "ProtocolNameList" MUST contain exactly one "ProtocolName"
1364:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
1365:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1366:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /* Min length is 2 (list_len) + 1 (name_len) + 1 (name) */
1367:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( len < 4 )
1368:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1369:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
1370:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
1371:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
1372:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1373:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1374:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     list_len = ( buf[0] << 8 ) | buf[1];
GAS LISTING /tmp/cc8psT5X.s 			page 102


1375:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( list_len != len - 2 )
1376:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1377:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
1378:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
1379:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
1380:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1381:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1382:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     name_len = buf[2];
1383:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( name_len != list_len - 1 )
1384:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1385:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
1386:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
1387:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
1388:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1389:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1390:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /* Check that the server chosen protocol was in our list and save it */
1391:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     for( p = ssl->conf->alpn_list; *p != NULL; p++ )
1392:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1393:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( name_len == strlen( *p ) &&
1394:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             memcmp( buf + 3, *p, name_len ) == 0 )
1395:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
1396:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ssl->alpn_chosen = *p;
1397:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( 0 );
1398:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
1399:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1400:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1401:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 1, ( "ALPN extension: no matching protocol" ) );
1402:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
1403:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                     MBEDTLS_SSL_ALERT_MSG_HANDSHAKE_FAILURE );
1404:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
1405:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
1406:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_ALPN */
1407:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1408:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** /*
1409:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  * Parse HelloVerifyRequest.  Only called after verifying the HS type.
1410:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  */
1411:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
1412:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_parse_hello_verify_request( mbedtls_ssl_context *ssl )
1413:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
1414:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const unsigned char *p = ssl->in_msg + mbedtls_ssl_hs_hdr_len( ssl );
1415:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     int major_ver, minor_ver;
1416:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char cookie_len;
1417:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1418:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> parse hello verify request" ) );
1419:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1420:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
1421:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * struct {
1422:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *   ProtocolVersion server_version;
1423:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *   opaque cookie<0..2^8-1>;
1424:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * } HelloVerifyRequest;
1425:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
1426:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "server version", p, 2 );
1427:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     mbedtls_ssl_read_version( &major_ver, &minor_ver, ssl->conf->transport, p );
1428:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     p += 2;
1429:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1430:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
1431:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * Since the RFC is not clear on this point, accept DTLS 1.0 (TLS 1.1)
GAS LISTING /tmp/cc8psT5X.s 			page 103


1432:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * even is lower than our min version.
1433:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
1434:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( major_ver < MBEDTLS_SSL_MAJOR_VERSION_3 ||
1435:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         minor_ver < MBEDTLS_SSL_MINOR_VERSION_2 ||
1436:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         major_ver > ssl->conf->max_major_ver  ||
1437:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         minor_ver > ssl->conf->max_minor_ver  )
1438:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1439:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server version" ) );
1440:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1441:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
1442:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                      MBEDTLS_SSL_ALERT_MSG_PROTOCOL_VERSION );
1443:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1444:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_PROTOCOL_VERSION );
1445:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1446:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1447:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     cookie_len = *p++;
1448:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "cookie", p, cookie_len );
1449:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1450:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( ssl->in_msg + ssl->in_msglen ) - p < cookie_len )
1451:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1452:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1,
1453:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ( "cookie length does not match incoming message size" ) );
1454:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
1455:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                     MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
1456:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
1457:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1458:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1459:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     mbedtls_free( ssl->handshake->verify_cookie );
1460:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1461:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->handshake->verify_cookie = mbedtls_calloc( 1, cookie_len );
1462:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->handshake->verify_cookie  == NULL )
1463:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1464:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "alloc failed (%d bytes)", cookie_len ) );
1465:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
1466:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1467:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1468:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     memcpy( ssl->handshake->verify_cookie, p, cookie_len );
1469:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->handshake->verify_cookie_len = cookie_len;
1470:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1471:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /* Start over at ClientHello */
1472:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->state = MBEDTLS_SSL_CLIENT_HELLO;
1473:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     mbedtls_ssl_reset_checksum( ssl );
1474:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1475:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     mbedtls_ssl_recv_flight_completed( ssl );
1476:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1477:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= parse hello verify request" ) );
1478:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1479:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( 0 );
1480:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
1481:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
1482:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1483:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_parse_server_hello( mbedtls_ssl_context *ssl )
1484:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 2737              		.loc 3 1484 1
 2738              		.cfi_startproc
 2739 0000 F30F1EFA 		endbr64
 2740 0004 55       		pushq	%rbp
GAS LISTING /tmp/cc8psT5X.s 			page 104


 2741              	.LCFI63:
 2742              		.cfi_def_cfa_offset 16
 2743              		.cfi_offset 6, -16
 2744 0005 4889E5   		movq	%rsp, %rbp
 2745              	.LCFI64:
 2746              		.cfi_def_cfa_register 6
 2747 0008 53       		pushq	%rbx
 2748 0009 4883EC68 		subq	$104, %rsp
 2749              		.cfi_offset 3, -24
 2750 000d 48897D98 		movq	%rdi, -104(%rbp)
 2751              		.loc 3 1484 1
 2752 0011 64488B04 		movq	%fs:40, %rax
 2752      25280000 
 2752      00
 2753 001a 488945E8 		movq	%rax, -24(%rbp)
 2754 001e 31C0     		xorl	%eax, %eax
1485:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     int ret, i;
1486:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     size_t n;
1487:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     size_t ext_len;
1488:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char *buf, *ext;
1489:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char comp;
1490:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_ZLIB_SUPPORT)
1491:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     int accept_comp;
1492:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
1493:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
1494:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     int renegotiation_info_seen = 0;
 2755              		.loc 3 1494 9
 2756 0020 C745AC00 		movl	$0, -84(%rbp)
 2756      000000
1495:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
1496:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     int handshake_failure = 0;
 2757              		.loc 3 1496 9
 2758 0027 C745B000 		movl	$0, -80(%rbp)
 2758      000000
1497:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const mbedtls_ssl_ciphersuite_t *suite_info;
1498:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1499:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> parse server hello" ) );
1500:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1501:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     buf = ssl->in_msg;
 2759              		.loc 3 1501 9
 2760 002e 488B4598 		movq	-104(%rbp), %rax
 2761 0032 488B80C8 		movq	200(%rax), %rax
 2761      000000
 2762 0039 488945D0 		movq	%rax, -48(%rbp)
1502:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1503:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( ret = mbedtls_ssl_read_record( ssl, 1 ) ) != 0 )
 2763              		.loc 3 1503 17
 2764 003d 488B4598 		movq	-104(%rbp), %rax
 2765 0041 BE010000 		movl	$1, %esi
 2765      00
 2766 0046 4889C7   		movq	%rax, %rdi
 2767 0049 E8000000 		call	mbedtls_ssl_read_record@PLT
 2767      00
 2768 004e 8945B4   		movl	%eax, -76(%rbp)
 2769              		.loc 3 1503 7
 2770 0051 837DB400 		cmpl	$0, -76(%rbp)
 2771 0055 7408     		je	.L171
GAS LISTING /tmp/cc8psT5X.s 			page 105


1504:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1505:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         /* No alert on a read error. */
1506:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_read_record", ret );
1507:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( ret );
 2772              		.loc 3 1507 15
 2773 0057 8B45B4   		movl	-76(%rbp), %eax
 2774 005a E93B0900 		jmp	.L172
 2774      00
 2775              	.L171:
1508:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1509:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1510:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->in_msgtype != MBEDTLS_SSL_MSG_HANDSHAKE )
 2776              		.loc 3 1510 12
 2777 005f 488B4598 		movq	-104(%rbp), %rax
 2778 0063 8B80D800 		movl	216(%rax), %eax
 2778      0000
 2779              		.loc 3 1510 7
 2780 0069 83F816   		cmpl	$22, %eax
 2781 006c 0F848800 		je	.L173
 2781      0000
1511:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1512:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
1513:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ssl->renego_status == MBEDTLS_SSL_RENEGOTIATION_IN_PROGRESS )
 2782              		.loc 3 1513 16
 2783 0072 488B4598 		movq	-104(%rbp), %rax
 2784 0076 8B400C   		movl	12(%rax), %eax
 2785              		.loc 3 1513 11
 2786 0079 83F801   		cmpl	$1, %eax
 2787 007c 755C     		jne	.L174
1514:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
1515:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ssl->renego_records_seen++;
 2788              		.loc 3 1515 16
 2789 007e 488B4598 		movq	-104(%rbp), %rax
 2790 0082 8B4010   		movl	16(%rax), %eax
 2791              		.loc 3 1515 37
 2792 0085 8D5001   		leal	1(%rax), %edx
 2793 0088 488B4598 		movq	-104(%rbp), %rax
 2794 008c 895010   		movl	%edx, 16(%rax)
1516:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1517:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( ssl->conf->renego_max_records >= 0 &&
 2795              		.loc 3 1517 20
 2796 008f 488B4598 		movq	-104(%rbp), %rax
 2797 0093 488B00   		movq	(%rax), %rax
 2798              		.loc 3 1517 26
 2799 0096 8B80AC00 		movl	172(%rax), %eax
 2799      0000
 2800              		.loc 3 1517 15
 2801 009c 85C0     		testl	%eax, %eax
 2802 009e 7822     		js	.L175
1518:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 ssl->renego_records_seen > ssl->conf->renego_max_records )
 2803              		.loc 3 1518 20 discriminator 1
 2804 00a0 488B4598 		movq	-104(%rbp), %rax
 2805 00a4 8B5010   		movl	16(%rax), %edx
 2806              		.loc 3 1518 47 discriminator 1
 2807 00a7 488B4598 		movq	-104(%rbp), %rax
 2808 00ab 488B00   		movq	(%rax), %rax
 2809              		.loc 3 1518 53 discriminator 1
GAS LISTING /tmp/cc8psT5X.s 			page 106


 2810 00ae 8B80AC00 		movl	172(%rax), %eax
 2810      0000
1517:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 ssl->renego_records_seen > ssl->conf->renego_max_records )
 2811              		.loc 3 1517 52 discriminator 1
 2812 00b4 39C2     		cmpl	%eax, %edx
 2813 00b6 7E0A     		jle	.L175
1519:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             {
1520:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "renegotiation requested, "
1521:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                     "but not honored by server" ) );
1522:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
 2814              		.loc 3 1522 23
 2815 00b8 B80089FF 		movl	$-30464, %eax
 2815      FF
 2816 00bd E9D80800 		jmp	.L172
 2816      00
 2817              	.L175:
1523:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             }
1524:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1525:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "non-handshake message during renego" ) );
1526:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1527:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ssl->keep_current_message = 1;
 2818              		.loc 3 1527 39
 2819 00c2 488B4598 		movq	-104(%rbp), %rax
 2820 00c6 C780FC00 		movl	$1, 252(%rax)
 2820      00000100 
 2820      0000
1528:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( MBEDTLS_ERR_SSL_WAITING_SERVER_HELLO_RENEGO );
 2821              		.loc 3 1528 19
 2822 00d0 B80095FF 		movl	$-27392, %eax
 2822      FF
 2823 00d5 E9C00800 		jmp	.L172
 2823      00
 2824              	.L174:
1529:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
1530:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_RENEGOTIATION */
1531:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1532:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server hello message" ) );
1533:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 2825              		.loc 3 1533 9
 2826 00da 488B4598 		movq	-104(%rbp), %rax
 2827 00de BA0A0000 		movl	$10, %edx
 2827      00
 2828 00e3 BE020000 		movl	$2, %esi
 2828      00
 2829 00e8 4889C7   		movq	%rax, %rdi
 2830 00eb E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 2830      00
1534:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_UNEXPECTED_MESSAGE );
1535:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
 2831              		.loc 3 1535 15
 2832 00f0 B80089FF 		movl	$-30464, %eax
 2832      FF
 2833 00f5 E9A00800 		jmp	.L172
 2833      00
 2834              	.L173:
1536:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1537:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
GAS LISTING /tmp/cc8psT5X.s 			page 107


1538:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
1539:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
1540:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1541:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( buf[0] == MBEDTLS_SSL_HS_HELLO_VERIFY_REQUEST )
1542:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
1543:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "received hello verify request" ) );
1544:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= parse server hello" ) );
1545:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( ssl_parse_hello_verify_request( ssl ) );
1546:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
1547:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         else
1548:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
1549:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             /* We made it through the verification process */
1550:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_free( ssl->handshake->verify_cookie );
1551:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ssl->handshake->verify_cookie = NULL;
1552:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ssl->handshake->verify_cookie_len = 0;
1553:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
1554:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1555:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
1556:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1557:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->in_hslen < 38 + mbedtls_ssl_hs_hdr_len( ssl ) ||
 2835              		.loc 3 1557 12
 2836 00fa 488B4598 		movq	-104(%rbp), %rax
 2837 00fe 488B98F0 		movq	240(%rax), %rbx
 2837      000000
 2838              		.loc 3 1557 30
 2839 0105 488B4598 		movq	-104(%rbp), %rax
 2840 0109 4889C7   		movq	%rax, %rdi
 2841 010c E8000000 		call	mbedtls_ssl_hs_hdr_len
 2841      00
 2842              		.loc 3 1557 28
 2843 0111 4883C026 		addq	$38, %rax
 2844              		.loc 3 1557 7
 2845 0115 4839C3   		cmpq	%rax, %rbx
 2846 0118 720B     		jb	.L176
1558:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         buf[0] != MBEDTLS_SSL_HS_SERVER_HELLO )
 2847              		.loc 3 1558 12 discriminator 1
 2848 011a 488B45D0 		movq	-48(%rbp), %rax
 2849 011e 0FB600   		movzbl	(%rax), %eax
1557:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         buf[0] != MBEDTLS_SSL_HS_SERVER_HELLO )
 2850              		.loc 3 1557 60 discriminator 1
 2851 0121 3C02     		cmpb	$2, %al
 2852 0123 7420     		je	.L177
 2853              	.L176:
1559:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1560:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server hello message" ) );
1561:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 2854              		.loc 3 1561 9
 2855 0125 488B4598 		movq	-104(%rbp), %rax
 2856 0129 BA320000 		movl	$50, %edx
 2856      00
 2857 012e BE020000 		movl	$2, %esi
 2857      00
 2858 0133 4889C7   		movq	%rax, %rdi
 2859 0136 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 2859      00
1562:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
1563:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
GAS LISTING /tmp/cc8psT5X.s 			page 108


 2860              		.loc 3 1563 15
 2861 013b B88086FF 		movl	$-31104, %eax
 2861      FF
 2862 0140 E9550800 		jmp	.L172
 2862      00
 2863              	.L177:
1564:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1565:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1566:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
1567:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *  0   .  1    server_version
1568:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *  2   . 33    random (maybe including 4 bytes of Unix time)
1569:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * 34   . 34    session_id length = n
1570:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * 35   . 34+n  session_id
1571:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * 35+n . 36+n  cipher_suite
1572:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * 37+n . 37+n  compression_method
1573:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *
1574:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * 38+n . 39+n  extensions length (optional)
1575:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * 40+n .  ..   extensions
1576:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
1577:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     buf += mbedtls_ssl_hs_hdr_len( ssl );
 2864              		.loc 3 1577 12
 2865 0145 488B4598 		movq	-104(%rbp), %rax
 2866 0149 4889C7   		movq	%rax, %rdi
 2867 014c E8000000 		call	mbedtls_ssl_hs_hdr_len
 2867      00
 2868              		.loc 3 1577 9
 2869 0151 480145D0 		addq	%rax, -48(%rbp)
1578:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1579:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "server hello, version", buf + 0, 2 );
1580:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     mbedtls_ssl_read_version( &ssl->major_ver, &ssl->minor_ver,
1581:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                       ssl->conf->transport, buf + 0 );
 2870              		.loc 3 1581 26
 2871 0155 488B4598 		movq	-104(%rbp), %rax
 2872 0159 488B00   		movq	(%rax), %rax
 2873              		.loc 3 1581 32
 2874 015c 0FB680BC 		movzbl	188(%rax), %eax
 2874      000000
 2875 0163 D0E8     		shrb	%al
 2876 0165 83E001   		andl	$1, %eax
1580:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                       ssl->conf->transport, buf + 0 );
 2877              		.loc 3 1580 5
 2878 0168 0FB6C0   		movzbl	%al, %eax
 2879 016b 488B5598 		movq	-104(%rbp), %rdx
 2880 016f 488D7218 		leaq	24(%rdx), %rsi
 2881 0173 488B5598 		movq	-104(%rbp), %rdx
 2882 0177 488D7A14 		leaq	20(%rdx), %rdi
 2883 017b 488B55D0 		movq	-48(%rbp), %rdx
 2884 017f 4889D1   		movq	%rdx, %rcx
 2885 0182 89C2     		movl	%eax, %edx
 2886 0184 E8000000 		call	mbedtls_ssl_read_version@PLT
 2886      00
1582:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1583:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->major_ver < ssl->conf->min_major_ver ||
 2887              		.loc 3 1583 12
 2888 0189 488B4598 		movq	-104(%rbp), %rax
 2889 018d 8B5014   		movl	20(%rax), %edx
 2890              		.loc 3 1583 29
GAS LISTING /tmp/cc8psT5X.s 			page 109


 2891 0190 488B4598 		movq	-104(%rbp), %rax
 2892 0194 488B00   		movq	(%rax), %rax
 2893              		.loc 3 1583 35
 2894 0197 0FB680BA 		movzbl	186(%rax), %eax
 2894      000000
 2895 019e 0FB6C0   		movzbl	%al, %eax
 2896              		.loc 3 1583 7
 2897 01a1 39C2     		cmpl	%eax, %edx
 2898 01a3 7C54     		jl	.L178
1584:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->minor_ver < ssl->conf->min_minor_ver ||
 2899              		.loc 3 1584 12 discriminator 1
 2900 01a5 488B4598 		movq	-104(%rbp), %rax
 2901 01a9 8B5018   		movl	24(%rax), %edx
 2902              		.loc 3 1584 29 discriminator 1
 2903 01ac 488B4598 		movq	-104(%rbp), %rax
 2904 01b0 488B00   		movq	(%rax), %rax
 2905              		.loc 3 1584 35 discriminator 1
 2906 01b3 0FB680BB 		movzbl	187(%rax), %eax
 2906      000000
 2907 01ba 0FB6C0   		movzbl	%al, %eax
1583:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->minor_ver < ssl->conf->min_minor_ver ||
 2908              		.loc 3 1583 51 discriminator 1
 2909 01bd 39C2     		cmpl	%eax, %edx
 2910 01bf 7C38     		jl	.L178
1585:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->major_ver > ssl->conf->max_major_ver ||
 2911              		.loc 3 1585 12
 2912 01c1 488B4598 		movq	-104(%rbp), %rax
 2913 01c5 8B5014   		movl	20(%rax), %edx
 2914              		.loc 3 1585 29
 2915 01c8 488B4598 		movq	-104(%rbp), %rax
 2916 01cc 488B00   		movq	(%rax), %rax
 2917              		.loc 3 1585 35
 2918 01cf 0FB680B8 		movzbl	184(%rax), %eax
 2918      000000
 2919 01d6 0FB6C0   		movzbl	%al, %eax
1584:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->minor_ver < ssl->conf->min_minor_ver ||
 2920              		.loc 3 1584 51
 2921 01d9 39C2     		cmpl	%eax, %edx
 2922 01db 7F1C     		jg	.L178
1586:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->minor_ver > ssl->conf->max_minor_ver )
 2923              		.loc 3 1586 12
 2924 01dd 488B4598 		movq	-104(%rbp), %rax
 2925 01e1 8B5018   		movl	24(%rax), %edx
 2926              		.loc 3 1586 29
 2927 01e4 488B4598 		movq	-104(%rbp), %rax
 2928 01e8 488B00   		movq	(%rax), %rax
 2929              		.loc 3 1586 35
 2930 01eb 0FB680B9 		movzbl	185(%rax), %eax
 2930      000000
 2931 01f2 0FB6C0   		movzbl	%al, %eax
1585:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->major_ver > ssl->conf->max_major_ver ||
 2932              		.loc 3 1585 51
 2933 01f5 39C2     		cmpl	%eax, %edx
 2934 01f7 7E20     		jle	.L179
 2935              	.L178:
1587:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1588:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "server version out of bounds - "
GAS LISTING /tmp/cc8psT5X.s 			page 110


1589:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             " min: [%d:%d], server: [%d:%d], max: [%d:%d]",
1590:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             ssl->conf->min_major_ver, ssl->conf->min_minor_ver,
1591:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             ssl->major_ver, ssl->minor_ver,
1592:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             ssl->conf->max_major_ver, ssl->conf->max_minor_ver ) );
1593:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1594:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 2936              		.loc 3 1594 9
 2937 01f9 488B4598 		movq	-104(%rbp), %rax
 2938 01fd BA460000 		movl	$70, %edx
 2938      00
 2939 0202 BE020000 		movl	$2, %esi
 2939      00
 2940 0207 4889C7   		movq	%rax, %rdi
 2941 020a E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 2941      00
1595:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                      MBEDTLS_SSL_ALERT_MSG_PROTOCOL_VERSION );
1596:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1597:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_PROTOCOL_VERSION );
 2942              		.loc 3 1597 15
 2943 020f B88091FF 		movl	$-28288, %eax
 2943      FF
 2944 0214 E9810700 		jmp	.L172
 2944      00
 2945              	.L179:
1598:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1599:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1600:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "server hello, current time: %lu",
1601:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                            ( (uint32_t) buf[2] << 24 ) |
1602:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                            ( (uint32_t) buf[3] << 16 ) |
1603:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                            ( (uint32_t) buf[4] <<  8 ) |
1604:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                            ( (uint32_t) buf[5]       ) ) );
1605:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1606:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     memcpy( ssl->handshake->randbytes + 32, buf + 2, 32 );
 2946              		.loc 3 1606 49
 2947 0219 488B45D0 		movq	-48(%rbp), %rax
 2948 021d 488D4802 		leaq	2(%rax), %rcx
 2949              		.loc 3 1606 16
 2950 0221 488B4598 		movq	-104(%rbp), %rax
 2951 0225 488B4060 		movq	96(%rax), %rax
 2952              		.loc 3 1606 13
 2953 0229 48051803 		addq	$792, %rax
 2953      0000
 2954              		.loc 3 1606 5
 2955 022f 4883C020 		addq	$32, %rax
 2956 0233 BA200000 		movl	$32, %edx
 2956      00
 2957 0238 4889CE   		movq	%rcx, %rsi
 2958 023b 4889C7   		movq	%rax, %rdi
 2959 023e E8000000 		call	memcpy@PLT
 2959      00
1607:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1608:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     n = buf[34];
 2960              		.loc 3 1608 12
 2961 0243 488B45D0 		movq	-48(%rbp), %rax
 2962 0247 4883C022 		addq	$34, %rax
 2963 024b 0FB600   		movzbl	(%rax), %eax
 2964              		.loc 3 1608 7
GAS LISTING /tmp/cc8psT5X.s 			page 111


 2965 024e 0FB6C0   		movzbl	%al, %eax
 2966 0251 488945D8 		movq	%rax, -40(%rbp)
1609:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1610:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_BUF( 3,   "server hello, random bytes", buf + 2, 32 );
1611:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1612:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( n > 32 )
 2967              		.loc 3 1612 7
 2968 0255 48837DD8 		cmpq	$32, -40(%rbp)
 2968      20
 2969 025a 7620     		jbe	.L180
1613:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1614:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server hello message" ) );
1615:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 2970              		.loc 3 1615 9
 2971 025c 488B4598 		movq	-104(%rbp), %rax
 2972 0260 BA320000 		movl	$50, %edx
 2972      00
 2973 0265 BE020000 		movl	$2, %esi
 2973      00
 2974 026a 4889C7   		movq	%rax, %rdi
 2975 026d E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 2975      00
1616:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
1617:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
 2976              		.loc 3 1617 15
 2977 0272 B88086FF 		movl	$-31104, %eax
 2977      FF
 2978 0277 E91E0700 		jmp	.L172
 2978      00
 2979              	.L180:
1618:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1619:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1620:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->in_hslen > mbedtls_ssl_hs_hdr_len( ssl ) + 39 + n )
 2980              		.loc 3 1620 12
 2981 027c 488B4598 		movq	-104(%rbp), %rax
 2982 0280 488B98F0 		movq	240(%rax), %rbx
 2982      000000
 2983              		.loc 3 1620 25
 2984 0287 488B4598 		movq	-104(%rbp), %rax
 2985 028b 4889C7   		movq	%rax, %rdi
 2986 028e E8000000 		call	mbedtls_ssl_hs_hdr_len
 2986      00
 2987              		.loc 3 1620 60
 2988 0293 488B55D8 		movq	-40(%rbp), %rdx
 2989 0297 4801D0   		addq	%rdx, %rax
 2990 029a 4883C027 		addq	$39, %rax
 2991              		.loc 3 1620 7
 2992 029e 4839C3   		cmpq	%rax, %rbx
 2993 02a1 0F869300 		jbe	.L181
 2993      0000
1621:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1622:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ext_len = ( ( buf[38 + n] <<  8 )
 2994              		.loc 3 1622 30
 2995 02a7 488B45D8 		movq	-40(%rbp), %rax
 2996 02ab 488D5026 		leaq	38(%rax), %rdx
 2997              		.loc 3 1622 26
 2998 02af 488B45D0 		movq	-48(%rbp), %rax
GAS LISTING /tmp/cc8psT5X.s 			page 112


 2999 02b3 4801D0   		addq	%rdx, %rax
 3000 02b6 0FB600   		movzbl	(%rax), %eax
 3001 02b9 0FB6C0   		movzbl	%al, %eax
 3002              		.loc 3 1622 35
 3003 02bc C1E008   		sall	$8, %eax
 3004 02bf 89C2     		movl	%eax, %edx
1623:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                   | ( buf[39 + n]       ) );
 3005              		.loc 3 1623 30
 3006 02c1 488B45D8 		movq	-40(%rbp), %rax
 3007 02c5 488D4827 		leaq	39(%rax), %rcx
 3008              		.loc 3 1623 26
 3009 02c9 488B45D0 		movq	-48(%rbp), %rax
 3010 02cd 4801C8   		addq	%rcx, %rax
 3011 02d0 0FB600   		movzbl	(%rax), %eax
 3012 02d3 0FB6C0   		movzbl	%al, %eax
 3013              		.loc 3 1623 19
 3014 02d6 09D0     		orl	%edx, %eax
1622:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                   | ( buf[39 + n]       ) );
 3015              		.loc 3 1622 17
 3016 02d8 4898     		cltq
 3017 02da 488945C0 		movq	%rax, -64(%rbp)
1624:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1625:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ( ext_len > 0 && ext_len < 4 ) ||
 3018              		.loc 3 1625 11
 3019 02de 48837DC0 		cmpq	$0, -64(%rbp)
 3019      00
 3020 02e3 7407     		je	.L182
 3021              		.loc 3 1625 27 discriminator 1
 3022 02e5 48837DC0 		cmpq	$3, -64(%rbp)
 3022      03
 3023 02ea 762E     		jbe	.L183
 3024              	.L182:
1626:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ssl->in_hslen != mbedtls_ssl_hs_hdr_len( ssl ) + 40 + n + ext_len )
 3025              		.loc 3 1626 16 discriminator 3
 3026 02ec 488B4598 		movq	-104(%rbp), %rax
 3027 02f0 488B98F0 		movq	240(%rax), %rbx
 3027      000000
 3028              		.loc 3 1626 30 discriminator 3
 3029 02f7 488B4598 		movq	-104(%rbp), %rax
 3030 02fb 4889C7   		movq	%rax, %rdi
 3031 02fe E8000000 		call	mbedtls_ssl_hs_hdr_len
 3031      00
 3032              		.loc 3 1626 65 discriminator 3
 3033 0303 488B55D8 		movq	-40(%rbp), %rdx
 3034 0307 4801C2   		addq	%rax, %rdx
 3035              		.loc 3 1626 69 discriminator 3
 3036 030a 488B45C0 		movq	-64(%rbp), %rax
 3037 030e 4801D0   		addq	%rdx, %rax
 3038 0311 4883C028 		addq	$40, %rax
1625:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ssl->in_hslen != mbedtls_ssl_hs_hdr_len( ssl ) + 40 + n + ext_len )
 3039              		.loc 3 1625 44 discriminator 3
 3040 0315 4839C3   		cmpq	%rax, %rbx
 3041 0318 7471     		je	.L184
 3042              	.L183:
1627:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
1628:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server hello message" ) );
1629:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
GAS LISTING /tmp/cc8psT5X.s 			page 113


 3043              		.loc 3 1629 13
 3044 031a 488B4598 		movq	-104(%rbp), %rax
 3045 031e BA320000 		movl	$50, %edx
 3045      00
 3046 0323 BE020000 		movl	$2, %esi
 3046      00
 3047 0328 4889C7   		movq	%rax, %rdi
 3048 032b E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 3048      00
1630:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                             MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
1631:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
 3049              		.loc 3 1631 19
 3050 0330 B88086FF 		movl	$-31104, %eax
 3050      FF
 3051 0335 E9600600 		jmp	.L172
 3051      00
 3052              	.L181:
1632:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
1633:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1634:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     else if( ssl->in_hslen == mbedtls_ssl_hs_hdr_len( ssl ) + 38 + n )
 3053              		.loc 3 1634 17
 3054 033a 488B4598 		movq	-104(%rbp), %rax
 3055 033e 488B98F0 		movq	240(%rax), %rbx
 3055      000000
 3056              		.loc 3 1634 31
 3057 0345 488B4598 		movq	-104(%rbp), %rax
 3058 0349 4889C7   		movq	%rax, %rdi
 3059 034c E8000000 		call	mbedtls_ssl_hs_hdr_len
 3059      00
 3060              		.loc 3 1634 66
 3061 0351 488B55D8 		movq	-40(%rbp), %rdx
 3062 0355 4801D0   		addq	%rdx, %rax
 3063 0358 4883C026 		addq	$38, %rax
 3064              		.loc 3 1634 12
 3065 035c 4839C3   		cmpq	%rax, %rbx
 3066 035f 750A     		jne	.L185
1635:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1636:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ext_len = 0;
 3067              		.loc 3 1636 17
 3068 0361 48C745C0 		movq	$0, -64(%rbp)
 3068      00000000 
 3069 0369 EB20     		jmp	.L184
 3070              	.L185:
1637:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1638:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     else
1639:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1640:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server hello message" ) );
1641:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 3071              		.loc 3 1641 9
 3072 036b 488B4598 		movq	-104(%rbp), %rax
 3073 036f BA320000 		movl	$50, %edx
 3073      00
 3074 0374 BE020000 		movl	$2, %esi
 3074      00
 3075 0379 4889C7   		movq	%rax, %rdi
 3076 037c E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 3076      00
GAS LISTING /tmp/cc8psT5X.s 			page 114


1642:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
1643:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
 3077              		.loc 3 1643 15
 3078 0381 B88086FF 		movl	$-31104, %eax
 3078      FF
 3079 0386 E90F0600 		jmp	.L172
 3079      00
 3080              	.L184:
1644:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1645:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1646:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /* ciphersuite (used later) */
1647:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     i = ( buf[35 + n] << 8 ) | buf[36 + n];
 3081              		.loc 3 1647 18
 3082 038b 488B45D8 		movq	-40(%rbp), %rax
 3083 038f 488D5023 		leaq	35(%rax), %rdx
 3084              		.loc 3 1647 14
 3085 0393 488B45D0 		movq	-48(%rbp), %rax
 3086 0397 4801D0   		addq	%rdx, %rax
 3087 039a 0FB600   		movzbl	(%rax), %eax
 3088 039d 0FB6C0   		movzbl	%al, %eax
 3089              		.loc 3 1647 23
 3090 03a0 C1E008   		sall	$8, %eax
 3091 03a3 89C2     		movl	%eax, %edx
 3092              		.loc 3 1647 39
 3093 03a5 488B45D8 		movq	-40(%rbp), %rax
 3094 03a9 488D4824 		leaq	36(%rax), %rcx
 3095              		.loc 3 1647 35
 3096 03ad 488B45D0 		movq	-48(%rbp), %rax
 3097 03b1 4801C8   		addq	%rcx, %rax
 3098 03b4 0FB600   		movzbl	(%rax), %eax
 3099 03b7 0FB6C0   		movzbl	%al, %eax
 3100              		.loc 3 1647 7
 3101 03ba 09D0     		orl	%edx, %eax
 3102 03bc 8945A8   		movl	%eax, -88(%rbp)
1648:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1649:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
1650:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * Read and check compression
1651:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
1652:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     comp = buf[37 + n];
 3103              		.loc 3 1652 19
 3104 03bf 488B45D8 		movq	-40(%rbp), %rax
 3105 03c3 488D5025 		leaq	37(%rax), %rdx
 3106              		.loc 3 1652 15
 3107 03c7 488B45D0 		movq	-48(%rbp), %rax
 3108 03cb 4801D0   		addq	%rdx, %rax
 3109              		.loc 3 1652 10
 3110 03ce 0FB600   		movzbl	(%rax), %eax
 3111 03d1 8845A7   		movb	%al, -89(%rbp)
1653:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1654:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_ZLIB_SUPPORT)
1655:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /* See comments in ssl_write_client_hello() */
1656:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
1657:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
1658:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         accept_comp = 0;
1659:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     else
1660:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
1661:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         accept_comp = 1;
GAS LISTING /tmp/cc8psT5X.s 			page 115


1662:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1663:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( comp != MBEDTLS_SSL_COMPRESS_NULL &&
1664:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ( comp != MBEDTLS_SSL_COMPRESS_DEFLATE || accept_comp == 0 ) )
1665:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #else /* MBEDTLS_ZLIB_SUPPORT */
1666:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( comp != MBEDTLS_SSL_COMPRESS_NULL )
 3112              		.loc 3 1666 7
 3113 03d4 807DA700 		cmpb	$0, -89(%rbp)
 3114 03d8 7420     		je	.L186
1667:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif/* MBEDTLS_ZLIB_SUPPORT */
1668:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1669:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "server hello, bad compression: %d", comp ) );
1670:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 3115              		.loc 3 1670 9
 3116 03da 488B4598 		movq	-104(%rbp), %rax
 3117 03de BA2F0000 		movl	$47, %edx
 3117      00
 3118 03e3 BE020000 		movl	$2, %esi
 3118      00
 3119 03e8 4889C7   		movq	%rax, %rdi
 3120 03eb E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 3120      00
1671:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_ILLEGAL_PARAMETER );
1672:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE );
 3121              		.loc 3 1672 15
 3122 03f0 B8808FFF 		movl	$-28800, %eax
 3122      FF
 3123 03f5 E9A00500 		jmp	.L172
 3123      00
 3124              	.L186:
1673:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1674:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1675:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
1676:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * Initialize update checksum functions
1677:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
1678:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->transform_negotiate->ciphersuite_info = mbedtls_ssl_ciphersuite_from_id( i );
 3125              		.loc 3 1678 8
 3126 03fa 488B4598 		movq	-104(%rbp), %rax
 3127 03fe 488B9880 		movq	128(%rax), %rbx
 3127      000000
 3128              		.loc 3 1678 50
 3129 0405 8B45A8   		movl	-88(%rbp), %eax
 3130 0408 89C7     		movl	%eax, %edi
 3131 040a E8000000 		call	mbedtls_ssl_ciphersuite_from_id@PLT
 3131      00
 3132              		.loc 3 1678 48
 3133 040f 488903   		movq	%rax, (%rbx)
1679:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1680:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->transform_negotiate->ciphersuite_info == NULL )
 3134              		.loc 3 1680 12
 3135 0412 488B4598 		movq	-104(%rbp), %rax
 3136 0416 488B8080 		movq	128(%rax), %rax
 3136      000000
 3137              		.loc 3 1680 33
 3138 041d 488B00   		movq	(%rax), %rax
 3139              		.loc 3 1680 7
 3140 0420 4885C0   		testq	%rax, %rax
 3141 0423 7520     		jne	.L187
GAS LISTING /tmp/cc8psT5X.s 			page 116


1681:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1682:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "ciphersuite info for %04x not found", i ) );
1683:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 3142              		.loc 3 1683 9
 3143 0425 488B4598 		movq	-104(%rbp), %rax
 3144 0429 BA500000 		movl	$80, %edx
 3144      00
 3145 042e BE020000 		movl	$2, %esi
 3145      00
 3146 0433 4889C7   		movq	%rax, %rdi
 3147 0436 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 3147      00
1684:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_INTERNAL_ERROR );
1685:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 3148              		.loc 3 1685 15
 3149 043b B8008FFF 		movl	$-28928, %eax
 3149      FF
 3150 0440 E9550500 		jmp	.L172
 3150      00
 3151              	.L187:
1686:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1687:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1688:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     mbedtls_ssl_optimize_checksum( ssl, ssl->transform_negotiate->ciphersuite_info );
 3152              		.loc 3 1688 44
 3153 0445 488B4598 		movq	-104(%rbp), %rax
 3154 0449 488B8080 		movq	128(%rax), %rax
 3154      000000
 3155              		.loc 3 1688 5
 3156 0450 488B10   		movq	(%rax), %rdx
 3157 0453 488B4598 		movq	-104(%rbp), %rax
 3158 0457 4889D6   		movq	%rdx, %rsi
 3159 045a 4889C7   		movq	%rax, %rdi
 3160 045d E8000000 		call	mbedtls_ssl_optimize_checksum@PLT
 3160      00
1689:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1690:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "server hello, session id len.: %d", n ) );
1691:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_BUF( 3,   "server hello, session id", buf + 35, n );
1692:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1693:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
1694:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * Check if the session can be resumed
1695:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
1696:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->handshake->resume == 0 || n == 0 ||
 3161              		.loc 3 1696 12
 3162 0462 488B4598 		movq	-104(%rbp), %rax
 3163 0466 488B4060 		movq	96(%rax), %rax
 3164              		.loc 3 1696 23
 3165 046a 8B809C03 		movl	924(%rax), %eax
 3165      0000
 3166              		.loc 3 1696 7
 3167 0470 85C0     		testl	%eax, %eax
 3168 0472 746D     		je	.L188
 3169              		.loc 3 1696 37 discriminator 1
 3170 0474 48837DD8 		cmpq	$0, -40(%rbp)
 3170      00
 3171 0479 7466     		je	.L188
1697:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
1698:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->renego_status != MBEDTLS_SSL_INITIAL_HANDSHAKE ||
GAS LISTING /tmp/cc8psT5X.s 			page 117


 3172              		.loc 3 1698 12 discriminator 2
 3173 047b 488B4598 		movq	-104(%rbp), %rax
 3174 047f 8B400C   		movl	12(%rax), %eax
1696:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
 3175              		.loc 3 1696 47 discriminator 2
 3176 0482 85C0     		testl	%eax, %eax
 3177 0484 755B     		jne	.L188
1699:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
1700:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->session_negotiate->ciphersuite != i ||
 3178              		.loc 3 1700 12
 3179 0486 488B4598 		movq	-104(%rbp), %rax
 3180 048a 488B4058 		movq	88(%rax), %rax
 3181              		.loc 3 1700 31
 3182 048e 8B00     		movl	(%rax), %eax
1698:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
 3183              		.loc 3 1698 61
 3184 0490 3945A8   		cmpl	%eax, -88(%rbp)
 3185 0493 754C     		jne	.L188
1701:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->session_negotiate->compression != comp ||
 3186              		.loc 3 1701 12
 3187 0495 488B4598 		movq	-104(%rbp), %rax
 3188 0499 488B4058 		movq	88(%rax), %rax
 3189              		.loc 3 1701 31
 3190 049d 8B5004   		movl	4(%rax), %edx
 3191              		.loc 3 1701 45
 3192 04a0 0FB645A7 		movzbl	-89(%rbp), %eax
1700:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->session_negotiate->compression != comp ||
 3193              		.loc 3 1700 50
 3194 04a4 39C2     		cmpl	%eax, %edx
 3195 04a6 7539     		jne	.L188
1702:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->session_negotiate->id_len != n ||
 3196              		.loc 3 1702 12
 3197 04a8 488B4598 		movq	-104(%rbp), %rax
 3198 04ac 488B4058 		movq	88(%rax), %rax
 3199              		.loc 3 1702 31
 3200 04b0 488B4008 		movq	8(%rax), %rax
1701:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->session_negotiate->compression != comp ||
 3201              		.loc 3 1701 53
 3202 04b4 483945D8 		cmpq	%rax, -40(%rbp)
 3203 04b8 7527     		jne	.L188
1703:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         memcmp( ssl->session_negotiate->id, buf + 35, n ) != 0 )
 3204              		.loc 3 1703 49
 3205 04ba 488B45D0 		movq	-48(%rbp), %rax
 3206 04be 488D7023 		leaq	35(%rax), %rsi
 3207              		.loc 3 1703 20
 3208 04c2 488B4598 		movq	-104(%rbp), %rax
 3209 04c6 488B4058 		movq	88(%rax), %rax
 3210              		.loc 3 1703 39
 3211 04ca 488D4810 		leaq	16(%rax), %rcx
 3212              		.loc 3 1703 9
 3213 04ce 488B45D8 		movq	-40(%rbp), %rax
 3214 04d2 4889C2   		movq	%rax, %rdx
 3215 04d5 4889CF   		movq	%rcx, %rdi
 3216 04d8 E8000000 		call	memcmp@PLT
 3216      00
1702:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->session_negotiate->id_len != n ||
 3217              		.loc 3 1702 45
GAS LISTING /tmp/cc8psT5X.s 			page 118


 3218 04dd 85C0     		testl	%eax, %eax
 3219 04df 7474     		je	.L189
 3220              	.L188:
1704:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1705:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->state++;
 3221              		.loc 3 1705 12
 3222 04e1 488B4598 		movq	-104(%rbp), %rax
 3223 04e5 8B4008   		movl	8(%rax), %eax
 3224              		.loc 3 1705 19
 3225 04e8 8D5001   		leal	1(%rax), %edx
 3226 04eb 488B4598 		movq	-104(%rbp), %rax
 3227 04ef 895008   		movl	%edx, 8(%rax)
1706:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->handshake->resume = 0;
 3228              		.loc 3 1706 12
 3229 04f2 488B4598 		movq	-104(%rbp), %rax
 3230 04f6 488B4060 		movq	96(%rax), %rax
 3231              		.loc 3 1706 32
 3232 04fa C7809C03 		movl	$0, 924(%rax)
 3232      00000000 
 3232      0000
1707:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_HAVE_TIME)
1708:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->session_negotiate->start = mbedtls_time( NULL );
1709:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
1710:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->session_negotiate->ciphersuite = i;
 3233              		.loc 3 1710 12
 3234 0504 488B4598 		movq	-104(%rbp), %rax
 3235 0508 488B4058 		movq	88(%rax), %rax
 3236              		.loc 3 1710 45
 3237 050c 8B55A8   		movl	-88(%rbp), %edx
 3238 050f 8910     		movl	%edx, (%rax)
1711:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->session_negotiate->compression = comp;
 3239              		.loc 3 1711 12
 3240 0511 488B4598 		movq	-104(%rbp), %rax
 3241 0515 488B4058 		movq	88(%rax), %rax
 3242              		.loc 3 1711 45
 3243 0519 0FB655A7 		movzbl	-89(%rbp), %edx
 3244 051d 895004   		movl	%edx, 4(%rax)
1712:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->session_negotiate->id_len = n;
 3245              		.loc 3 1712 12
 3246 0520 488B4598 		movq	-104(%rbp), %rax
 3247 0524 488B4058 		movq	88(%rax), %rax
 3248              		.loc 3 1712 40
 3249 0528 488B55D8 		movq	-40(%rbp), %rdx
 3250 052c 48895008 		movq	%rdx, 8(%rax)
1713:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         memcpy( ssl->session_negotiate->id, buf + 35, n );
 3251              		.loc 3 1713 49
 3252 0530 488B45D0 		movq	-48(%rbp), %rax
 3253 0534 488D7023 		leaq	35(%rax), %rsi
 3254              		.loc 3 1713 20
 3255 0538 488B4598 		movq	-104(%rbp), %rax
 3256 053c 488B4058 		movq	88(%rax), %rax
 3257              		.loc 3 1713 39
 3258 0540 488D4810 		leaq	16(%rax), %rcx
 3259              		.loc 3 1713 9
 3260 0544 488B45D8 		movq	-40(%rbp), %rax
 3261 0548 4889C2   		movq	%rax, %rdx
 3262 054b 4889CF   		movq	%rcx, %rdi
GAS LISTING /tmp/cc8psT5X.s 			page 119


 3263 054e E8000000 		call	memcpy@PLT
 3263      00
 3264 0553 EB3E     		jmp	.L190
 3265              	.L189:
1714:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1715:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     else
1716:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1717:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->state = MBEDTLS_SSL_SERVER_CHANGE_CIPHER_SPEC;
 3266              		.loc 3 1717 20
 3267 0555 488B4598 		movq	-104(%rbp), %rax
 3268 0559 C740080C 		movl	$12, 8(%rax)
 3268      000000
1718:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1719:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ( ret = mbedtls_ssl_derive_keys( ssl ) ) != 0 )
 3269              		.loc 3 1719 21
 3270 0560 488B4598 		movq	-104(%rbp), %rax
 3271 0564 4889C7   		movq	%rax, %rdi
 3272 0567 E8000000 		call	mbedtls_ssl_derive_keys@PLT
 3272      00
 3273 056c 8945B4   		movl	%eax, -76(%rbp)
 3274              		.loc 3 1719 11
 3275 056f 837DB400 		cmpl	$0, -76(%rbp)
 3276 0573 741E     		je	.L190
1720:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
1721:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_derive_keys", ret );
1722:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 3277              		.loc 3 1722 13
 3278 0575 488B4598 		movq	-104(%rbp), %rax
 3279 0579 BA500000 		movl	$80, %edx
 3279      00
 3280 057e BE020000 		movl	$2, %esi
 3280      00
 3281 0583 4889C7   		movq	%rax, %rdi
 3282 0586 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 3282      00
1723:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                             MBEDTLS_SSL_ALERT_MSG_INTERNAL_ERROR );
1724:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( ret );
 3283              		.loc 3 1724 19
 3284 058b 8B45B4   		movl	-76(%rbp), %eax
 3285 058e E9070400 		jmp	.L172
 3285      00
 3286              	.L190:
1725:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
1726:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1727:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1728:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "%s session has been resumed",
1729:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                    ssl->handshake->resume ? "a" : "no" ) );
1730:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1731:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "server hello, chosen ciphersuite: %04x", i ) );
1732:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "server hello, compress alg.: %d", buf[37 + n] ) );
1733:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1734:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
1735:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * Perform cipher suite validation in same way as in ssl_write_client_hello.
1736:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
1737:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     i = 0;
 3287              		.loc 3 1737 7
 3288 0593 C745A800 		movl	$0, -88(%rbp)
GAS LISTING /tmp/cc8psT5X.s 			page 120


 3288      000000
 3289              	.L194:
1738:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     while( 1 )
1739:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1740:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ssl->conf->ciphersuite_list[ssl->minor_ver][i] == 0 )
 3290              		.loc 3 1740 16
 3291 059a 488B4598 		movq	-104(%rbp), %rax
 3292 059e 488B00   		movq	(%rax), %rax
 3293              		.loc 3 1740 44
 3294 05a1 488B5598 		movq	-104(%rbp), %rdx
 3295 05a5 8B5218   		movl	24(%rdx), %edx
 3296              		.loc 3 1740 40
 3297 05a8 4863D2   		movslq	%edx, %rdx
 3298 05ab 488B04D0 		movq	(%rax,%rdx,8), %rax
 3299              		.loc 3 1740 56
 3300 05af 8B55A8   		movl	-88(%rbp), %edx
 3301 05b2 4863D2   		movslq	%edx, %rdx
 3302 05b5 48C1E202 		salq	$2, %rdx
 3303 05b9 4801D0   		addq	%rdx, %rax
 3304 05bc 8B00     		movl	(%rax), %eax
 3305              		.loc 3 1740 11
 3306 05be 85C0     		testl	%eax, %eax
 3307 05c0 7520     		jne	.L191
1741:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
1742:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server hello message" ) );
1743:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 3308              		.loc 3 1743 13
 3309 05c2 488B4598 		movq	-104(%rbp), %rax
 3310 05c6 BA2F0000 		movl	$47, %edx
 3310      00
 3311 05cb BE020000 		movl	$2, %esi
 3311      00
 3312 05d0 4889C7   		movq	%rax, %rdi
 3313 05d3 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 3313      00
1744:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                             MBEDTLS_SSL_ALERT_MSG_ILLEGAL_PARAMETER );
1745:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
 3314              		.loc 3 1745 19
 3315 05d8 B88086FF 		movl	$-31104, %eax
 3315      FF
 3316 05dd E9B80300 		jmp	.L172
 3316      00
 3317              	.L191:
1746:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
1747:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1748:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ssl->conf->ciphersuite_list[ssl->minor_ver][i++] ==
 3318              		.loc 3 1748 16
 3319 05e2 488B4598 		movq	-104(%rbp), %rax
 3320 05e6 488B00   		movq	(%rax), %rax
 3321              		.loc 3 1748 44
 3322 05e9 488B5598 		movq	-104(%rbp), %rdx
 3323 05ed 8B5218   		movl	24(%rdx), %edx
 3324              		.loc 3 1748 40
 3325 05f0 4863D2   		movslq	%edx, %rdx
 3326 05f3 488B0CD0 		movq	(%rax,%rdx,8), %rcx
 3327              		.loc 3 1748 58
 3328 05f7 8B45A8   		movl	-88(%rbp), %eax
GAS LISTING /tmp/cc8psT5X.s 			page 121


 3329 05fa 8D5001   		leal	1(%rax), %edx
 3330 05fd 8955A8   		movl	%edx, -88(%rbp)
 3331 0600 4898     		cltq
 3332              		.loc 3 1748 56
 3333 0602 48C1E002 		salq	$2, %rax
 3334 0606 4801C8   		addq	%rcx, %rax
 3335 0609 8B10     		movl	(%rax), %edx
1749:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ssl->session_negotiate->ciphersuite )
 3336              		.loc 3 1749 16
 3337 060b 488B4598 		movq	-104(%rbp), %rax
 3338 060f 488B4058 		movq	88(%rax), %rax
 3339              		.loc 3 1749 35
 3340 0613 8B00     		movl	(%rax), %eax
1748:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ssl->session_negotiate->ciphersuite )
 3341              		.loc 3 1748 11
 3342 0615 39C2     		cmpl	%eax, %edx
 3343 0617 7405     		je	.L218
1740:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
 3344              		.loc 3 1740 11
 3345 0619 E97CFFFF 		jmp	.L194
 3345      FF
 3346              	.L218:
1750:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
1751:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             break;
 3347              		.loc 3 1751 13
 3348 061e 90       		nop
1752:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
1753:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1754:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1755:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     suite_info = mbedtls_ssl_ciphersuite_from_id( ssl->session_negotiate->ciphersuite );
 3349              		.loc 3 1755 54
 3350 061f 488B4598 		movq	-104(%rbp), %rax
 3351 0623 488B4058 		movq	88(%rax), %rax
 3352              		.loc 3 1755 18
 3353 0627 8B00     		movl	(%rax), %eax
 3354 0629 89C7     		movl	%eax, %edi
 3355 062b E8000000 		call	mbedtls_ssl_ciphersuite_from_id@PLT
 3355      00
 3356 0630 488945E0 		movq	%rax, -32(%rbp)
1756:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl_validate_ciphersuite( suite_info, ssl, ssl->minor_ver, ssl->minor_ver ) != 0 )
 3357              		.loc 3 1756 9
 3358 0634 488B4598 		movq	-104(%rbp), %rax
 3359 0638 8B4818   		movl	24(%rax), %ecx
 3360 063b 488B4598 		movq	-104(%rbp), %rax
 3361 063f 8B5018   		movl	24(%rax), %edx
 3362 0642 488B7598 		movq	-104(%rbp), %rsi
 3363 0646 488B45E0 		movq	-32(%rbp), %rax
 3364 064a 4889C7   		movq	%rax, %rdi
 3365 064d E8000000 		call	ssl_validate_ciphersuite
 3365      00
 3366              		.loc 3 1756 7
 3367 0652 85C0     		testl	%eax, %eax
 3368 0654 7420     		je	.L195
1757:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1758:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server hello message" ) );
1759:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 3369              		.loc 3 1759 9
GAS LISTING /tmp/cc8psT5X.s 			page 122


 3370 0656 488B4598 		movq	-104(%rbp), %rax
 3371 065a BA2F0000 		movl	$47, %edx
 3371      00
 3372 065f BE020000 		movl	$2, %esi
 3372      00
 3373 0664 4889C7   		movq	%rax, %rdi
 3374 0667 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 3374      00
1760:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_ILLEGAL_PARAMETER );
1761:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
 3375              		.loc 3 1761 15
 3376 066c B88086FF 		movl	$-31104, %eax
 3376      FF
 3377 0671 E9240300 		jmp	.L172
 3377      00
 3378              	.L195:
1762:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1763:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1764:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "server hello, chosen ciphersuite: %s", suite_info->name ) );
1765:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1766:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL__ECP_RESTARTABLE)
1767:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( suite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA &&
1768:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_3 )
1769:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1770:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->handshake->ecrs_enabled = 1;
1771:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1772:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
1773:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1774:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( comp != MBEDTLS_SSL_COMPRESS_NULL
 3379              		.loc 3 1774 7
 3380 0676 807DA700 		cmpb	$0, -89(%rbp)
 3381 067a 7420     		je	.L196
1775:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_ZLIB_SUPPORT)
1776:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         && comp != MBEDTLS_SSL_COMPRESS_DEFLATE
1777:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
1778:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****       )
1779:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1780:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server hello message" ) );
1781:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 3382              		.loc 3 1781 9
 3383 067c 488B4598 		movq	-104(%rbp), %rax
 3384 0680 BA2F0000 		movl	$47, %edx
 3384      00
 3385 0685 BE020000 		movl	$2, %esi
 3385      00
 3386 068a 4889C7   		movq	%rax, %rdi
 3387 068d E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 3387      00
1782:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_ILLEGAL_PARAMETER );
1783:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
 3388              		.loc 3 1783 15
 3389 0692 B88086FF 		movl	$-31104, %eax
 3389      FF
 3390 0697 E9FE0200 		jmp	.L172
 3390      00
 3391              	.L196:
1784:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
GAS LISTING /tmp/cc8psT5X.s 			page 123


1785:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->session_negotiate->compression = comp;
 3392              		.loc 3 1785 8
 3393 069c 488B4598 		movq	-104(%rbp), %rax
 3394 06a0 488B4058 		movq	88(%rax), %rax
 3395              		.loc 3 1785 41
 3396 06a4 0FB655A7 		movzbl	-89(%rbp), %edx
 3397 06a8 895004   		movl	%edx, 4(%rax)
1786:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1787:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ext = buf + 40 + n;
 3398              		.loc 3 1787 20
 3399 06ab 488B45D8 		movq	-40(%rbp), %rax
 3400 06af 488D5028 		leaq	40(%rax), %rdx
 3401              		.loc 3 1787 9
 3402 06b3 488B45D0 		movq	-48(%rbp), %rax
 3403 06b7 4801D0   		addq	%rdx, %rax
 3404 06ba 488945C8 		movq	%rax, -56(%rbp)
1788:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1789:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "server hello, total extension length: %d", ext_len ) );
1790:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1791:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     while( ext_len )
 3405              		.loc 3 1791 10
 3406 06be E9EC0100 		jmp	.L197
 3406      00
 3407              	.L210:
 3408              	.LBB3:
1792:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1793:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         unsigned int ext_id   = ( ( ext[0] <<  8 )
 3409              		.loc 3 1793 40
 3410 06c3 488B45C8 		movq	-56(%rbp), %rax
 3411 06c7 0FB600   		movzbl	(%rax), %eax
 3412 06ca 0FB6C0   		movzbl	%al, %eax
 3413              		.loc 3 1793 44
 3414 06cd C1E008   		sall	$8, %eax
 3415 06d0 89C2     		movl	%eax, %edx
1794:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                 | ( ext[1]       ) );
 3416              		.loc 3 1794 40
 3417 06d2 488B45C8 		movq	-56(%rbp), %rax
 3418 06d6 4883C001 		addq	$1, %rax
 3419 06da 0FB600   		movzbl	(%rax), %eax
 3420 06dd 0FB6C0   		movzbl	%al, %eax
 3421              		.loc 3 1794 33
 3422 06e0 09D0     		orl	%edx, %eax
1793:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                 | ( ext[1]       ) );
 3423              		.loc 3 1793 22
 3424 06e2 8945B8   		movl	%eax, -72(%rbp)
1795:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         unsigned int ext_size = ( ( ext[2] <<  8 )
 3425              		.loc 3 1795 40
 3426 06e5 488B45C8 		movq	-56(%rbp), %rax
 3427 06e9 4883C002 		addq	$2, %rax
 3428 06ed 0FB600   		movzbl	(%rax), %eax
 3429 06f0 0FB6C0   		movzbl	%al, %eax
 3430              		.loc 3 1795 44
 3431 06f3 C1E008   		sall	$8, %eax
 3432 06f6 89C2     		movl	%eax, %edx
1796:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                 | ( ext[3]       ) );
 3433              		.loc 3 1796 40
 3434 06f8 488B45C8 		movq	-56(%rbp), %rax
GAS LISTING /tmp/cc8psT5X.s 			page 124


 3435 06fc 4883C003 		addq	$3, %rax
 3436 0700 0FB600   		movzbl	(%rax), %eax
 3437 0703 0FB6C0   		movzbl	%al, %eax
 3438              		.loc 3 1796 33
 3439 0706 09D0     		orl	%edx, %eax
1795:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         unsigned int ext_size = ( ( ext[2] <<  8 )
 3440              		.loc 3 1795 22
 3441 0708 8945BC   		movl	%eax, -68(%rbp)
1797:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1798:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ext_size + 4 > ext_len )
 3442              		.loc 3 1798 22
 3443 070b 8B45BC   		movl	-68(%rbp), %eax
 3444 070e 83C004   		addl	$4, %eax
 3445 0711 89C0     		movl	%eax, %eax
 3446              		.loc 3 1798 11
 3447 0713 483945C0 		cmpq	%rax, -64(%rbp)
 3448 0717 7320     		jnb	.L198
1799:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
1800:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server hello message" ) );
1801:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 3449              		.loc 3 1801 13
 3450 0719 488B4598 		movq	-104(%rbp), %rax
 3451 071d BA320000 		movl	$50, %edx
 3451      00
 3452 0722 BE020000 		movl	$2, %esi
 3452      00
 3453 0727 4889C7   		movq	%rax, %rdi
 3454 072a E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 3454      00
1802:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                             MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
1803:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
 3455              		.loc 3 1803 19
 3456 072f B88086FF 		movl	$-31104, %eax
 3456      FF
 3457 0734 E9610200 		jmp	.L172
 3457      00
 3458              	.L198:
1804:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
1805:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1806:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         switch( ext_id )
 3459              		.loc 3 1806 9
 3460 0739 817DB801 		cmpl	$65281, -72(%rbp)
 3460      FF0000
 3461 0740 744A     		je	.L199
 3462 0742 817DB801 		cmpl	$65281, -72(%rbp)
 3462      FF0000
 3463 0749 0F873001 		ja	.L200
 3463      0000
 3464 074f 837DB823 		cmpl	$35, -72(%rbp)
 3465 0753 0F84C300 		je	.L201
 3465      0000
 3466 0759 837DB823 		cmpl	$35, -72(%rbp)
 3467 075d 0F871C01 		ja	.L200
 3467      0000
 3468 0763 837DB817 		cmpl	$23, -72(%rbp)
 3469 0767 0F848400 		je	.L202
 3469      0000
GAS LISTING /tmp/cc8psT5X.s 			page 125


 3470 076d 837DB817 		cmpl	$23, -72(%rbp)
 3471 0771 0F870801 		ja	.L200
 3471      0000
 3472 0777 837DB801 		cmpl	$1, -72(%rbp)
 3473 077b 7445     		je	.L203
 3474 077d 837DB80B 		cmpl	$11, -72(%rbp)
 3475 0781 0F84C000 		je	.L204
 3475      0000
 3476 0787 E9F30000 		jmp	.L200
 3476      00
 3477              	.L199:
1807:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
1808:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         case MBEDTLS_TLS_EXT_RENEGOTIATION_INFO:
1809:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "found renegotiation extension" ) );
1810:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
1811:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             renegotiation_info_seen = 1;
 3478              		.loc 3 1811 37
 3479 078c C745AC01 		movl	$1, -84(%rbp)
 3479      000000
1812:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
1813:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1814:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( ( ret = ssl_parse_renegotiation_info( ssl, ext + 4,
 3480              		.loc 3 1814 25
 3481 0793 8B55BC   		movl	-68(%rbp), %edx
 3482              		.loc 3 1814 64
 3483 0796 488B45C8 		movq	-56(%rbp), %rax
 3484 079a 488D4804 		leaq	4(%rax), %rcx
 3485              		.loc 3 1814 25
 3486 079e 488B4598 		movq	-104(%rbp), %rax
 3487 07a2 4889CE   		movq	%rcx, %rsi
 3488 07a5 4889C7   		movq	%rax, %rdi
 3489 07a8 E8000000 		call	ssl_parse_renegotiation_info
 3489      00
 3490 07ad 8945B4   		movl	%eax, -76(%rbp)
 3491              		.loc 3 1814 15
 3492 07b0 837DB400 		cmpl	$0, -76(%rbp)
 3493 07b4 0F84B800 		je	.L219
 3493      0000
1815:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                                       ext_size ) ) != 0 )
1816:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 return( ret );
 3494              		.loc 3 1816 23
 3495 07ba 8B45B4   		movl	-76(%rbp), %eax
 3496 07bd E9D80100 		jmp	.L172
 3496      00
 3497              	.L203:
1817:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1818:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             break;
1819:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1820:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_MAX_FRAGMENT_LENGTH)
1821:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         case MBEDTLS_TLS_EXT_MAX_FRAGMENT_LENGTH:
1822:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "found max_fragment_length extension" ) );
1823:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1824:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( ( ret = ssl_parse_max_fragment_length_ext( ssl,
 3498              		.loc 3 1824 25
 3499 07c2 8B55BC   		movl	-68(%rbp), %edx
1825:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             ext + 4, ext_size ) ) != 0 )
 3500              		.loc 3 1825 33
GAS LISTING /tmp/cc8psT5X.s 			page 126


 3501 07c5 488B45C8 		movq	-56(%rbp), %rax
 3502 07c9 488D4804 		leaq	4(%rax), %rcx
1824:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             ext + 4, ext_size ) ) != 0 )
 3503              		.loc 3 1824 25
 3504 07cd 488B4598 		movq	-104(%rbp), %rax
 3505 07d1 4889CE   		movq	%rcx, %rsi
 3506 07d4 4889C7   		movq	%rax, %rdi
 3507 07d7 E8000000 		call	ssl_parse_max_fragment_length_ext
 3507      00
 3508 07dc 8945B4   		movl	%eax, -76(%rbp)
1824:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             ext + 4, ext_size ) ) != 0 )
 3509              		.loc 3 1824 15
 3510 07df 837DB400 		cmpl	$0, -76(%rbp)
 3511 07e3 0F848C00 		je	.L220
 3511      0000
1826:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             {
1827:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 return( ret );
 3512              		.loc 3 1827 23
 3513 07e9 8B45B4   		movl	-76(%rbp), %eax
 3514 07ec E9A90100 		jmp	.L172
 3514      00
 3515              	.L202:
1828:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             }
1829:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1830:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             break;
1831:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_MAX_FRAGMENT_LENGTH */
1832:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1833:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_TRUNCATED_HMAC)
1834:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         case MBEDTLS_TLS_EXT_TRUNCATED_HMAC:
1835:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "found truncated_hmac extension" ) );
1836:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1837:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( ( ret = ssl_parse_truncated_hmac_ext( ssl,
1838:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             ext + 4, ext_size ) ) != 0 )
1839:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             {
1840:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 return( ret );
1841:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             }
1842:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1843:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             break;
1844:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_TRUNCATED_HMAC */
1845:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1846:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_ENCRYPT_THEN_MAC)
1847:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         case MBEDTLS_TLS_EXT_ENCRYPT_THEN_MAC:
1848:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "found encrypt_then_mac extension" ) );
1849:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1850:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( ( ret = ssl_parse_encrypt_then_mac_ext( ssl,
1851:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             ext + 4, ext_size ) ) != 0 )
1852:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             {
1853:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 return( ret );
1854:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             }
1855:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1856:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             break;
1857:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_ENCRYPT_THEN_MAC */
1858:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1859:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_EXTENDED_MASTER_SECRET)
1860:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         case MBEDTLS_TLS_EXT_EXTENDED_MASTER_SECRET:
1861:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "found extended_master_secret extension" ) );
1862:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
GAS LISTING /tmp/cc8psT5X.s 			page 127


1863:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( ( ret = ssl_parse_extended_ms_ext( ssl,
 3516              		.loc 3 1863 25
 3517 07f1 8B55BC   		movl	-68(%rbp), %edx
1864:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             ext + 4, ext_size ) ) != 0 )
 3518              		.loc 3 1864 33
 3519 07f4 488B45C8 		movq	-56(%rbp), %rax
 3520 07f8 488D4804 		leaq	4(%rax), %rcx
1863:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             ext + 4, ext_size ) ) != 0 )
 3521              		.loc 3 1863 25
 3522 07fc 488B4598 		movq	-104(%rbp), %rax
 3523 0800 4889CE   		movq	%rcx, %rsi
 3524 0803 4889C7   		movq	%rax, %rdi
 3525 0806 E8000000 		call	ssl_parse_extended_ms_ext
 3525      00
 3526 080b 8945B4   		movl	%eax, -76(%rbp)
1863:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             ext + 4, ext_size ) ) != 0 )
 3527              		.loc 3 1863 15
 3528 080e 837DB400 		cmpl	$0, -76(%rbp)
 3529 0812 7464     		je	.L221
1865:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             {
1866:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 return( ret );
 3530              		.loc 3 1866 23
 3531 0814 8B45B4   		movl	-76(%rbp), %eax
 3532 0817 E97E0100 		jmp	.L172
 3532      00
 3533              	.L201:
1867:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             }
1868:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1869:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             break;
1870:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_EXTENDED_MASTER_SECRET */
1871:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1872:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_SESSION_TICKETS)
1873:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         case MBEDTLS_TLS_EXT_SESSION_TICKET:
1874:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "found session_ticket extension" ) );
1875:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1876:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( ( ret = ssl_parse_session_ticket_ext( ssl,
 3534              		.loc 3 1876 25
 3535 081c 8B55BC   		movl	-68(%rbp), %edx
1877:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             ext + 4, ext_size ) ) != 0 )
 3536              		.loc 3 1877 33
 3537 081f 488B45C8 		movq	-56(%rbp), %rax
 3538 0823 488D4804 		leaq	4(%rax), %rcx
1876:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             ext + 4, ext_size ) ) != 0 )
 3539              		.loc 3 1876 25
 3540 0827 488B4598 		movq	-104(%rbp), %rax
 3541 082b 4889CE   		movq	%rcx, %rsi
 3542 082e 4889C7   		movq	%rax, %rdi
 3543 0831 E8000000 		call	ssl_parse_session_ticket_ext
 3543      00
 3544 0836 8945B4   		movl	%eax, -76(%rbp)
1876:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             ext + 4, ext_size ) ) != 0 )
 3545              		.loc 3 1876 15
 3546 0839 837DB400 		cmpl	$0, -76(%rbp)
 3547 083d 743C     		je	.L222
1878:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             {
1879:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 return( ret );
 3548              		.loc 3 1879 23
GAS LISTING /tmp/cc8psT5X.s 			page 128


 3549 083f 8B45B4   		movl	-76(%rbp), %eax
 3550 0842 E9530100 		jmp	.L172
 3550      00
 3551              	.L204:
1880:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             }
1881:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1882:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             break;
1883:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_SESSION_TICKETS */
1884:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1885:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_ECDH_C) || defined(MBEDTLS_ECDSA_C) || \
1886:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
1887:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         case MBEDTLS_TLS_EXT_SUPPORTED_POINT_FORMATS:
1888:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "found supported_point_formats extension" ) );
1889:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1890:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( ( ret = ssl_parse_supported_point_formats_ext( ssl,
 3552              		.loc 3 1890 25
 3553 0847 8B55BC   		movl	-68(%rbp), %edx
1891:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             ext + 4, ext_size ) ) != 0 )
 3554              		.loc 3 1891 33
 3555 084a 488B45C8 		movq	-56(%rbp), %rax
 3556 084e 488D4804 		leaq	4(%rax), %rcx
1890:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             ext + 4, ext_size ) ) != 0 )
 3557              		.loc 3 1890 25
 3558 0852 488B4598 		movq	-104(%rbp), %rax
 3559 0856 4889CE   		movq	%rcx, %rsi
 3560 0859 4889C7   		movq	%rax, %rdi
 3561 085c E8000000 		call	ssl_parse_supported_point_formats_ext
 3561      00
 3562 0861 8945B4   		movl	%eax, -76(%rbp)
1890:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             ext + 4, ext_size ) ) != 0 )
 3563              		.loc 3 1890 15
 3564 0864 837DB400 		cmpl	$0, -76(%rbp)
 3565 0868 7414     		je	.L223
1892:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             {
1893:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 return( ret );
 3566              		.loc 3 1893 23
 3567 086a 8B45B4   		movl	-76(%rbp), %eax
 3568 086d E9280100 		jmp	.L172
 3568      00
 3569              	.L219:
1818:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
 3570              		.loc 3 1818 13
 3571 0872 90       		nop
 3572 0873 EB0A     		jmp	.L200
 3573              	.L220:
1830:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_MAX_FRAGMENT_LENGTH */
 3574              		.loc 3 1830 13
 3575 0875 90       		nop
 3576 0876 EB07     		jmp	.L200
 3577              	.L221:
1869:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_EXTENDED_MASTER_SECRET */
 3578              		.loc 3 1869 13
 3579 0878 90       		nop
 3580 0879 EB04     		jmp	.L200
 3581              	.L222:
1882:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_SESSION_TICKETS */
 3582              		.loc 3 1882 13
GAS LISTING /tmp/cc8psT5X.s 			page 129


 3583 087b 90       		nop
 3584 087c EB01     		jmp	.L200
 3585              	.L223:
1894:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             }
1895:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1896:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             break;
 3586              		.loc 3 1896 13
 3587 087e 90       		nop
 3588              	.L200:
1897:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_ECDH_C || MBEDTLS_ECDSA_C ||
1898:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED */
1899:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1900:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
1901:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         case MBEDTLS_TLS_EXT_ECJPAKE_KKPP:
1902:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "found ecjpake_kkpp extension" ) );
1903:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1904:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( ( ret = ssl_parse_ecjpake_kkpp( ssl,
1905:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             ext + 4, ext_size ) ) != 0 )
1906:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             {
1907:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 return( ret );
1908:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             }
1909:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1910:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             break;
1911:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED */
1912:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1913:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_ALPN)
1914:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         case MBEDTLS_TLS_EXT_ALPN:
1915:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "found alpn extension" ) );
1916:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1917:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( ( ret = ssl_parse_alpn_ext( ssl, ext + 4, ext_size ) ) != 0 )
1918:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 return( ret );
1919:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1920:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             break;
1921:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_ALPN */
1922:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1923:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         default:
1924:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "unknown extension found: %d (ignoring)",
1925:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                            ext_id ) );
1926:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
1927:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1928:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ext_len -= 4 + ext_size;
 3589              		.loc 3 1928 22
 3590 087f 8B45BC   		movl	-68(%rbp), %eax
 3591 0882 83C004   		addl	$4, %eax
 3592 0885 89C0     		movl	%eax, %eax
 3593              		.loc 3 1928 17
 3594 0887 482945C0 		subq	%rax, -64(%rbp)
1929:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ext += 4 + ext_size;
 3595              		.loc 3 1929 18
 3596 088b 8B45BC   		movl	-68(%rbp), %eax
 3597 088e 83C004   		addl	$4, %eax
 3598 0891 89C0     		movl	%eax, %eax
 3599              		.loc 3 1929 13
 3600 0893 480145C8 		addq	%rax, -56(%rbp)
1930:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1931:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ext_len > 0 && ext_len < 4 )
 3601              		.loc 3 1931 11
GAS LISTING /tmp/cc8psT5X.s 			page 130


 3602 0897 48837DC0 		cmpq	$0, -64(%rbp)
 3602      00
 3603 089c 7411     		je	.L197
 3604              		.loc 3 1931 25 discriminator 1
 3605 089e 48837DC0 		cmpq	$3, -64(%rbp)
 3605      03
 3606 08a3 770A     		ja	.L197
1932:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
1933:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server hello message" ) );
1934:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
 3607              		.loc 3 1934 19
 3608 08a5 B88086FF 		movl	$-31104, %eax
 3608      FF
 3609 08aa E9EB0000 		jmp	.L172
 3609      00
 3610              	.L197:
 3611              	.LBE3:
1791:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
 3612              		.loc 3 1791 10
 3613 08af 48837DC0 		cmpq	$0, -64(%rbp)
 3613      00
 3614 08b4 0F8509FE 		jne	.L210
 3614      FFFF
1935:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
1936:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1937:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1938:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
1939:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * Renegotiation security checks
1940:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
1941:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->secure_renegotiation == MBEDTLS_SSL_LEGACY_RENEGOTIATION &&
 3615              		.loc 3 1941 12
 3616 08ba 488B4598 		movq	-104(%rbp), %rax
 3617 08be 8B806001 		movl	352(%rax), %eax
 3617      0000
 3618              		.loc 3 1941 7
 3619 08c4 85C0     		testl	%eax, %eax
 3620 08c6 7521     		jne	.L211
1942:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->conf->allow_legacy_renegotiation == MBEDTLS_SSL_LEGACY_BREAK_HANDSHAKE )
 3621              		.loc 3 1942 12 discriminator 1
 3622 08c8 488B4598 		movq	-104(%rbp), %rax
 3623 08cc 488B00   		movq	(%rax), %rax
 3624              		.loc 3 1942 47 discriminator 1
 3625 08cf 0FB680BC 		movzbl	188(%rax), %eax
 3625      000000
 3626 08d6 83E030   		andl	$48, %eax
1941:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->conf->allow_legacy_renegotiation == MBEDTLS_SSL_LEGACY_BREAK_HANDSHAKE )
 3627              		.loc 3 1941 71 discriminator 1
 3628 08d9 3C20     		cmpb	$32, %al
 3629 08db 750C     		jne	.L211
1943:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1944:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "legacy renegotiation, breaking off handshake" ) );
1945:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         handshake_failure = 1;
 3630              		.loc 3 1945 27
 3631 08dd C745B001 		movl	$1, -80(%rbp)
 3631      000000
 3632 08e4 E9890000 		jmp	.L212
 3632      00
GAS LISTING /tmp/cc8psT5X.s 			page 131


 3633              	.L211:
1946:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1947:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
1948:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     else if( ssl->renego_status == MBEDTLS_SSL_RENEGOTIATION_IN_PROGRESS &&
 3634              		.loc 3 1948 17
 3635 08e9 488B4598 		movq	-104(%rbp), %rax
 3636 08ed 8B400C   		movl	12(%rax), %eax
 3637              		.loc 3 1948 12
 3638 08f0 83F801   		cmpl	$1, %eax
 3639 08f3 751E     		jne	.L213
1949:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****              ssl->secure_renegotiation == MBEDTLS_SSL_SECURE_RENEGOTIATION &&
 3640              		.loc 3 1949 17 discriminator 1
 3641 08f5 488B4598 		movq	-104(%rbp), %rax
 3642 08f9 8B806001 		movl	352(%rax), %eax
 3642      0000
1948:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****              ssl->secure_renegotiation == MBEDTLS_SSL_SECURE_RENEGOTIATION &&
 3643              		.loc 3 1948 74 discriminator 1
 3644 08ff 83F801   		cmpl	$1, %eax
 3645 0902 750F     		jne	.L213
 3646              		.loc 3 1949 76
 3647 0904 837DAC00 		cmpl	$0, -84(%rbp)
 3648 0908 7509     		jne	.L213
1950:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****              renegotiation_info_seen == 0 )
1951:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1952:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "renegotiation_info extension missing (secure)" ) );
1953:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         handshake_failure = 1;
 3649              		.loc 3 1953 27
 3650 090a C745B001 		movl	$1, -80(%rbp)
 3650      000000
 3651 0911 EB5F     		jmp	.L212
 3652              	.L213:
1954:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1955:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     else if( ssl->renego_status == MBEDTLS_SSL_RENEGOTIATION_IN_PROGRESS &&
 3653              		.loc 3 1955 17
 3654 0913 488B4598 		movq	-104(%rbp), %rax
 3655 0917 8B400C   		movl	12(%rax), %eax
 3656              		.loc 3 1955 12
 3657 091a 83F801   		cmpl	$1, %eax
 3658 091d 752C     		jne	.L214
1956:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****              ssl->secure_renegotiation == MBEDTLS_SSL_LEGACY_RENEGOTIATION &&
 3659              		.loc 3 1956 17 discriminator 1
 3660 091f 488B4598 		movq	-104(%rbp), %rax
 3661 0923 8B806001 		movl	352(%rax), %eax
 3661      0000
1955:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****              ssl->secure_renegotiation == MBEDTLS_SSL_LEGACY_RENEGOTIATION &&
 3662              		.loc 3 1955 74 discriminator 1
 3663 0929 85C0     		testl	%eax, %eax
 3664 092b 751E     		jne	.L214
1957:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****              ssl->conf->allow_legacy_renegotiation == MBEDTLS_SSL_LEGACY_NO_RENEGOTIATION )
 3665              		.loc 3 1957 17
 3666 092d 488B4598 		movq	-104(%rbp), %rax
 3667 0931 488B00   		movq	(%rax), %rax
 3668              		.loc 3 1957 52
 3669 0934 0FB680BC 		movzbl	188(%rax), %eax
 3669      000000
 3670 093b 83E030   		andl	$48, %eax
1956:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****              ssl->secure_renegotiation == MBEDTLS_SSL_LEGACY_RENEGOTIATION &&
GAS LISTING /tmp/cc8psT5X.s 			page 132


 3671              		.loc 3 1956 76
 3672 093e 84C0     		testb	%al, %al
 3673 0940 7509     		jne	.L214
1958:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1959:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "legacy renegotiation not allowed" ) );
1960:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         handshake_failure = 1;
 3674              		.loc 3 1960 27
 3675 0942 C745B001 		movl	$1, -80(%rbp)
 3675      000000
 3676 0949 EB27     		jmp	.L212
 3677              	.L214:
1961:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1962:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     else if( ssl->renego_status == MBEDTLS_SSL_RENEGOTIATION_IN_PROGRESS &&
 3678              		.loc 3 1962 17
 3679 094b 488B4598 		movq	-104(%rbp), %rax
 3680 094f 8B400C   		movl	12(%rax), %eax
 3681              		.loc 3 1962 12
 3682 0952 83F801   		cmpl	$1, %eax
 3683 0955 751B     		jne	.L212
1963:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****              ssl->secure_renegotiation == MBEDTLS_SSL_LEGACY_RENEGOTIATION &&
 3684              		.loc 3 1963 17 discriminator 1
 3685 0957 488B4598 		movq	-104(%rbp), %rax
 3686 095b 8B806001 		movl	352(%rax), %eax
 3686      0000
1962:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****              ssl->secure_renegotiation == MBEDTLS_SSL_LEGACY_RENEGOTIATION &&
 3687              		.loc 3 1962 74 discriminator 1
 3688 0961 85C0     		testl	%eax, %eax
 3689 0963 750D     		jne	.L212
 3690              		.loc 3 1963 76
 3691 0965 837DAC01 		cmpl	$1, -84(%rbp)
 3692 0969 7507     		jne	.L212
1964:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****              renegotiation_info_seen == 1 )
1965:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1966:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "renegotiation_info extension present (legacy)" ) );
1967:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         handshake_failure = 1;
 3693              		.loc 3 1967 27
 3694 096b C745B001 		movl	$1, -80(%rbp)
 3694      000000
 3695              	.L212:
1968:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1969:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_RENEGOTIATION */
1970:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1971:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( handshake_failure == 1 )
 3696              		.loc 3 1971 7
 3697 0972 837DB001 		cmpl	$1, -80(%rbp)
 3698 0976 751D     		jne	.L215
1972:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
1973:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 3699              		.loc 3 1973 9
 3700 0978 488B4598 		movq	-104(%rbp), %rax
 3701 097c BA280000 		movl	$40, %edx
 3701      00
 3702 0981 BE020000 		movl	$2, %esi
 3702      00
 3703 0986 4889C7   		movq	%rax, %rdi
 3704 0989 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 3704      00
GAS LISTING /tmp/cc8psT5X.s 			page 133


1974:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_HANDSHAKE_FAILURE );
1975:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO );
 3705              		.loc 3 1975 15
 3706 098e B88086FF 		movl	$-31104, %eax
 3706      FF
 3707 0993 EB05     		jmp	.L172
 3708              	.L215:
1976:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
1977:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1978:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= parse server hello" ) );
1979:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1980:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( 0 );
 3709              		.loc 3 1980 11
 3710 0995 B8000000 		movl	$0, %eax
 3710      00
 3711              	.L172:
1981:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 3712              		.loc 3 1981 1
 3713 099a 488B5DE8 		movq	-24(%rbp), %rbx
 3714 099e 6448331C 		xorq	%fs:40, %rbx
 3714      25280000 
 3714      00
 3715 09a7 7405     		je	.L216
 3716 09a9 E8000000 		call	__stack_chk_fail@PLT
 3716      00
 3717              	.L216:
 3718 09ae 4883C468 		addq	$104, %rsp
 3719 09b2 5B       		popq	%rbx
 3720 09b3 5D       		popq	%rbp
 3721              	.LCFI65:
 3722              		.cfi_def_cfa 7, 8
 3723 09b4 C3       		ret
 3724              		.cfi_endproc
 3725              	.LFE42:
 3727              		.section	.text.ssl_check_server_ecdh_params,"ax",@progbits
 3729              	ssl_check_server_ecdh_params:
 3730              	.LFB43:
1982:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1983:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_DHE_RSA_ENABLED) ||                       \
1984:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_DHE_PSK_ENABLED)
1985:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_parse_server_dh_params( mbedtls_ssl_context *ssl, unsigned char **p,
1986:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                        unsigned char *end )
1987:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
1988:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     int ret = MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE;
1989:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
1990:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
1991:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * Ephemeral DH parameters:
1992:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *
1993:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * struct {
1994:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     opaque dh_p<1..2^16-1>;
1995:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     opaque dh_g<1..2^16-1>;
1996:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     opaque dh_Ys<1..2^16-1>;
1997:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * } ServerDHParams;
1998:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
1999:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( ret = mbedtls_dhm_read_params( &ssl->handshake->dhm_ctx, p, end ) ) != 0 )
2000:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2001:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_RET( 2, ( "mbedtls_dhm_read_params" ), ret );
GAS LISTING /tmp/cc8psT5X.s 			page 134


2002:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( ret );
2003:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2004:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2005:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->handshake->dhm_ctx.len * 8 < ssl->conf->dhm_min_bitlen )
2006:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2007:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "DHM prime too short: %d < %d",
2008:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                     ssl->handshake->dhm_ctx.len * 8,
2009:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                     ssl->conf->dhm_min_bitlen ) );
2010:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_KEY_EXCHANGE );
2011:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2012:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2013:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MPI( 3, "DHM: P ", &ssl->handshake->dhm_ctx.P  );
2014:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MPI( 3, "DHM: G ", &ssl->handshake->dhm_ctx.G  );
2015:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MPI( 3, "DHM: GY", &ssl->handshake->dhm_ctx.GY );
2016:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2017:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( ret );
2018:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
2019:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE_DHE_RSA_ENABLED ||
2020:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_KEY_EXCHANGE_DHE_PSK_ENABLED */
2021:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2022:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED) ||                     \
2023:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED) ||                   \
2024:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_ECDHE_PSK_ENABLED) ||                     \
2025:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_ECDH_RSA_ENABLED) ||                      \
2026:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA_ENABLED)
2027:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_check_server_ecdh_params( const mbedtls_ssl_context *ssl )
2028:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 3731              		.loc 3 2028 1
 3732              		.cfi_startproc
 3733 0000 F30F1EFA 		endbr64
 3734 0004 55       		pushq	%rbp
 3735              	.LCFI66:
 3736              		.cfi_def_cfa_offset 16
 3737              		.cfi_offset 6, -16
 3738 0005 4889E5   		movq	%rsp, %rbp
 3739              	.LCFI67:
 3740              		.cfi_def_cfa_register 6
 3741 0008 4883EC30 		subq	$48, %rsp
 3742 000c 48897DD8 		movq	%rdi, -40(%rbp)
 3743              		.loc 3 2028 1
 3744 0010 64488B04 		movq	%fs:40, %rax
 3744      25280000 
 3744      00
 3745 0019 488945F8 		movq	%rax, -8(%rbp)
 3746 001d 31C0     		xorl	%eax, %eax
2029:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const mbedtls_ecp_curve_info *curve_info;
2030:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     mbedtls_ecp_group_id grp_id;
2031:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_ECDH_LEGACY_CONTEXT)
2032:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     grp_id = ssl->handshake->ecdh_ctx.grp.id;
 3747              		.loc 3 2032 17
 3748 001f 488B45D8 		movq	-40(%rbp), %rax
 3749 0023 488B4060 		movq	96(%rax), %rax
 3750              		.loc 3 2032 12
 3751 0027 8B4008   		movl	8(%rax), %eax
 3752 002a 8945EC   		movl	%eax, -20(%rbp)
2033:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #else
2034:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     grp_id = ssl->handshake->ecdh_ctx.grp_id;
GAS LISTING /tmp/cc8psT5X.s 			page 135


2035:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
2036:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2037:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     curve_info = mbedtls_ecp_curve_info_from_grp_id( grp_id );
 3753              		.loc 3 2037 18
 3754 002d 8B45EC   		movl	-20(%rbp), %eax
 3755 0030 89C7     		movl	%eax, %edi
 3756 0032 E8000000 		call	mbedtls_ecp_curve_info_from_grp_id@PLT
 3756      00
 3757 0037 488945F0 		movq	%rax, -16(%rbp)
2038:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( curve_info == NULL )
 3758              		.loc 3 2038 7
 3759 003b 48837DF0 		cmpq	$0, -16(%rbp)
 3759      00
 3760 0040 7507     		jne	.L225
2039:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2040:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
2041:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 3761              		.loc 3 2041 15
 3762 0042 B80094FF 		movl	$-27648, %eax
 3762      FF
 3763 0047 EB21     		jmp	.L226
 3764              	.L225:
2042:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2043:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2044:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "ECDH curve: %s", curve_info->name ) );
2045:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2046:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_ECP_C)
2047:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( mbedtls_ssl_check_curve( ssl, grp_id ) != 0 )
 3765              		.loc 3 2047 9
 3766 0049 8B55EC   		movl	-20(%rbp), %edx
 3767 004c 488B45D8 		movq	-40(%rbp), %rax
 3768 0050 89D6     		movl	%edx, %esi
 3769 0052 4889C7   		movq	%rax, %rdi
 3770 0055 E8000000 		call	mbedtls_ssl_check_curve@PLT
 3770      00
 3771              		.loc 3 2047 7
 3772 005a 85C0     		testl	%eax, %eax
 3773 005c 7407     		je	.L227
2048:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #else
2049:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->handshake->ecdh_ctx.grp.nbits < 163 ||
2050:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->handshake->ecdh_ctx.grp.nbits > 521 )
2051:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
2052:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( -1 );
 3774              		.loc 3 2052 15
 3775 005e B8FFFFFF 		movl	$-1, %eax
 3775      FF
 3776 0063 EB05     		jmp	.L226
 3777              	.L227:
2053:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2054:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_ECDH( 3, &ssl->handshake->ecdh_ctx,
2055:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             MBEDTLS_DEBUG_ECDH_QP );
2056:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2057:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( 0 );
 3778              		.loc 3 2057 11
 3779 0065 B8000000 		movl	$0, %eax
 3779      00
 3780              	.L226:
GAS LISTING /tmp/cc8psT5X.s 			page 136


2058:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 3781              		.loc 3 2058 1
 3782 006a 488B4DF8 		movq	-8(%rbp), %rcx
 3783 006e 6448330C 		xorq	%fs:40, %rcx
 3783      25280000 
 3783      00
 3784 0077 7405     		je	.L228
 3785 0079 E8000000 		call	__stack_chk_fail@PLT
 3785      00
 3786              	.L228:
 3787 007e C9       		leave
 3788              	.LCFI68:
 3789              		.cfi_def_cfa 7, 8
 3790 007f C3       		ret
 3791              		.cfi_endproc
 3792              	.LFE43:
 3794              		.section	.text.ssl_parse_server_ecdh_params,"ax",@progbits
 3796              	ssl_parse_server_ecdh_params:
 3797              	.LFB44:
2059:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED ||
2060:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED ||
2061:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_KEY_EXCHANGE_ECDHE_PSK_ENABLED ||
2062:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_KEY_EXCHANGE_ECDH_RSA_ENABLED ||
2063:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA_ENABLED */
2064:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2065:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED) ||                     \
2066:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED) ||                   \
2067:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_ECDHE_PSK_ENABLED)
2068:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_parse_server_ecdh_params( mbedtls_ssl_context *ssl,
2069:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                          unsigned char **p,
2070:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                          unsigned char *end )
2071:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 3798              		.loc 3 2071 1
 3799              		.cfi_startproc
 3800 0000 F30F1EFA 		endbr64
 3801 0004 55       		pushq	%rbp
 3802              	.LCFI69:
 3803              		.cfi_def_cfa_offset 16
 3804              		.cfi_offset 6, -16
 3805 0005 4889E5   		movq	%rsp, %rbp
 3806              	.LCFI70:
 3807              		.cfi_def_cfa_register 6
 3808 0008 4883EC30 		subq	$48, %rsp
 3809 000c 48897DE8 		movq	%rdi, -24(%rbp)
 3810 0010 488975E0 		movq	%rsi, -32(%rbp)
 3811 0014 488955D8 		movq	%rdx, -40(%rbp)
 3812              		.loc 3 2071 1
 3813 0018 64488B04 		movq	%fs:40, %rax
 3813      25280000 
 3813      00
 3814 0021 488945F8 		movq	%rax, -8(%rbp)
 3815 0025 31C0     		xorl	%eax, %eax
2072:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     int ret = MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE;
 3816              		.loc 3 2072 9
 3817 0027 C745F480 		movl	$-28800, -12(%rbp)
 3817      8FFFFF
2073:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
GAS LISTING /tmp/cc8psT5X.s 			page 137


2074:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
2075:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * Ephemeral ECDH parameters:
2076:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *
2077:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * struct {
2078:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     ECParameters curve_params;
2079:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     ECPoint      public;
2080:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * } ServerECDHParams;
2081:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
2082:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( ret = mbedtls_ecdh_read_params( &ssl->handshake->ecdh_ctx,
 3818              		.loc 3 2082 47
 3819 002e 488B45E8 		movq	-24(%rbp), %rax
 3820 0032 488B4060 		movq	96(%rax), %rax
 3821              		.loc 3 2082 17
 3822 0036 488D4808 		leaq	8(%rax), %rcx
 3823 003a 488B55D8 		movq	-40(%rbp), %rdx
 3824 003e 488B45E0 		movq	-32(%rbp), %rax
 3825 0042 4889C6   		movq	%rax, %rsi
 3826 0045 4889CF   		movq	%rcx, %rdi
 3827 0048 E8000000 		call	mbedtls_ecdh_read_params@PLT
 3827      00
 3828 004d 8945F4   		movl	%eax, -12(%rbp)
 3829              		.loc 3 2082 7
 3830 0050 837DF400 		cmpl	$0, -12(%rbp)
 3831 0054 7405     		je	.L230
2083:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                   (const unsigned char **) p, end ) ) != 0 )
2084:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2085:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_RET( 1, ( "mbedtls_ecdh_read_params" ), ret );
2086:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL__ECP_RESTARTABLE)
2087:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ret == MBEDTLS_ERR_ECP_IN_PROGRESS )
2088:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ret = MBEDTLS_ERR_SSL_CRYPTO_IN_PROGRESS;
2089:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
2090:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( ret );
 3832              		.loc 3 2090 15
 3833 0056 8B45F4   		movl	-12(%rbp), %eax
 3834 0059 EB1A     		jmp	.L231
 3835              	.L230:
2091:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2092:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2093:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl_check_server_ecdh_params( ssl ) != 0 )
 3836              		.loc 3 2093 9
 3837 005b 488B45E8 		movq	-24(%rbp), %rax
 3838 005f 4889C7   		movq	%rax, %rdi
 3839 0062 E8000000 		call	ssl_check_server_ecdh_params
 3839      00
 3840              		.loc 3 2093 7
 3841 0067 85C0     		testl	%eax, %eax
 3842 0069 7407     		je	.L232
2094:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2095:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server key exchange message (ECDHE curve)" ) );
2096:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_KEY_EXCHANGE );
 3843              		.loc 3 2096 15
 3844 006b B80085FF 		movl	$-31488, %eax
 3844      FF
 3845 0070 EB03     		jmp	.L231
 3846              	.L232:
2097:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2098:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
GAS LISTING /tmp/cc8psT5X.s 			page 138


2099:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( ret );
 3847              		.loc 3 2099 11
 3848 0072 8B45F4   		movl	-12(%rbp), %eax
 3849              	.L231:
2100:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 3850              		.loc 3 2100 1
 3851 0075 488B4DF8 		movq	-8(%rbp), %rcx
 3852 0079 6448330C 		xorq	%fs:40, %rcx
 3852      25280000 
 3852      00
 3853 0082 7405     		je	.L233
 3854 0084 E8000000 		call	__stack_chk_fail@PLT
 3854      00
 3855              	.L233:
 3856 0089 C9       		leave
 3857              	.LCFI71:
 3858              		.cfi_def_cfa 7, 8
 3859 008a C3       		ret
 3860              		.cfi_endproc
 3861              	.LFE44:
 3863              		.section	.text.ssl_write_encrypted_pms,"ax",@progbits
 3865              	ssl_write_encrypted_pms:
 3866              	.LFB45:
2101:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED ||
2102:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED ||
2103:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_KEY_EXCHANGE_ECDHE_PSK_ENABLED */
2104:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2105:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED)
2106:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_parse_server_psk_hint( mbedtls_ssl_context *ssl,
2107:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                       unsigned char **p,
2108:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                       unsigned char *end )
2109:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
2110:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     int ret = MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE;
2111:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     size_t  len;
2112:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ((void) ssl);
2113:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2114:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
2115:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * PSK parameters:
2116:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *
2117:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * opaque psk_identity_hint<0..2^16-1>;
2118:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
2119:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( end - (*p) < 2 )
2120:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2121:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server key exchange message "
2122:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                     "(psk_identity_hint length)" ) );
2123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_KEY_EXCHANGE );
2124:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2125:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     len = (*p)[0] << 8 | (*p)[1];
2126:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p += 2;
2127:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2128:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( end - (*p) < (int) len )
2129:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2130:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server key exchange message "
2131:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                     "(psk_identity_hint length)" ) );
2132:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_KEY_EXCHANGE );
2133:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2134:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
GAS LISTING /tmp/cc8psT5X.s 			page 139


2135:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
2136:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * Note: we currently ignore the PKS identity hint, as we only allow one
2137:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * PSK to be provisionned on the client. This could be changed later if
2138:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * someone needs that feature.
2139:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
2140:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p += len;
2141:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ret = 0;
2142:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2143:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( ret );
2144:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
2145:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED */
2146:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2147:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_RSA_ENABLED) ||                           \
2148:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_RSA_PSK_ENABLED)
2149:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** /*
2150:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  * Generate a pre-master secret and encrypt it with the server's RSA key
2151:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  */
2152:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_write_encrypted_pms( mbedtls_ssl_context *ssl,
2153:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                     size_t offset, size_t *olen,
2154:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                     size_t pms_offset )
2155:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 3867              		.loc 3 2155 1
 3868              		.cfi_startproc
 3869 0000 F30F1EFA 		endbr64
 3870 0004 55       		pushq	%rbp
 3871              	.LCFI72:
 3872              		.cfi_def_cfa_offset 16
 3873              		.cfi_offset 6, -16
 3874 0005 4889E5   		movq	%rsp, %rbp
 3875              	.LCFI73:
 3876              		.cfi_def_cfa_register 6
 3877 0008 4883EC40 		subq	$64, %rsp
 3878 000c 48897DD8 		movq	%rdi, -40(%rbp)
 3879 0010 488975D0 		movq	%rsi, -48(%rbp)
 3880 0014 488955C8 		movq	%rdx, -56(%rbp)
 3881 0018 48894DC0 		movq	%rcx, -64(%rbp)
 3882              		.loc 3 2155 1
 3883 001c 64488B04 		movq	%fs:40, %rax
 3883      25280000 
 3883      00
 3884 0025 488945F8 		movq	%rax, -8(%rbp)
 3885 0029 31C0     		xorl	%eax, %eax
2156:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     int ret;
2157:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     size_t len_bytes = ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 ? 0 : 2;
 3886              		.loc 3 2157 27
 3887 002b 488B45D8 		movq	-40(%rbp), %rax
 3888 002f 8B4018   		movl	24(%rax), %eax
 3889              		.loc 3 2157 74
 3890 0032 85C0     		testl	%eax, %eax
 3891 0034 7507     		jne	.L235
 3892              		.loc 3 2157 74 is_stmt 0 discriminator 1
 3893 0036 B8000000 		movl	$0, %eax
 3893      00
 3894 003b EB05     		jmp	.L236
 3895              	.L235:
 3896              		.loc 3 2157 74 discriminator 2
 3897 003d B8020000 		movl	$2, %eax
GAS LISTING /tmp/cc8psT5X.s 			page 140


 3897      00
 3898              	.L236:
 3899              		.loc 3 2157 12 is_stmt 1 discriminator 4
 3900 0042 488945E8 		movq	%rax, -24(%rbp)
2158:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char *p = ssl->handshake->premaster + pms_offset;
 3901              		.loc 3 2158 27 discriminator 4
 3902 0046 488B45D8 		movq	-40(%rbp), %rax
 3903 004a 488B4060 		movq	96(%rax), %rax
 3904              		.loc 3 2158 24 discriminator 4
 3905 004e 488D9058 		leaq	856(%rax), %rdx
 3905      030000
 3906              		.loc 3 2158 20 discriminator 4
 3907 0055 488B45C0 		movq	-64(%rbp), %rax
 3908 0059 4801D0   		addq	%rdx, %rax
 3909 005c 488945F0 		movq	%rax, -16(%rbp)
2159:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2160:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( offset + len_bytes > MBEDTLS_SSL_OUT_CONTENT_LEN )
 3910              		.loc 3 2160 16 discriminator 4
 3911 0060 488B55D0 		movq	-48(%rbp), %rdx
 3912 0064 488B45E8 		movq	-24(%rbp), %rax
 3913 0068 4801D0   		addq	%rdx, %rax
 3914              		.loc 3 2160 7 discriminator 4
 3915 006b 483D803E 		cmpq	$16000, %rax
 3915      0000
 3916 0071 760A     		jbe	.L237
2161:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2162:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "buffer too small for encrypted pms" ) );
2163:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BUFFER_TOO_SMALL );
 3917              		.loc 3 2163 15
 3918 0073 B80096FF 		movl	$-27136, %eax
 3918      FF
 3919 0078 E9CA0100 		jmp	.L238
 3919      00
 3920              	.L237:
2164:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2165:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2166:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
2167:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * Generate (part of) the pre-master as
2168:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *  struct {
2169:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *      ProtocolVersion client_version;
2170:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *      opaque random[46];
2171:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *  } PreMasterSecret;
2172:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
2173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     mbedtls_ssl_write_version( ssl->conf->max_major_ver, ssl->conf->max_minor_ver,
2174:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                        ssl->conf->transport, p );
 3921              		.loc 3 2174 27
 3922 007d 488B45D8 		movq	-40(%rbp), %rax
 3923 0081 488B00   		movq	(%rax), %rax
 3924              		.loc 3 2174 33
 3925 0084 0FB680BC 		movzbl	188(%rax), %eax
 3925      000000
 3926 008b D0E8     		shrb	%al
 3927 008d 83E001   		andl	$1, %eax
2173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                        ssl->conf->transport, p );
 3928              		.loc 3 2173 5
 3929 0090 0FB6D0   		movzbl	%al, %edx
2173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                        ssl->conf->transport, p );
GAS LISTING /tmp/cc8psT5X.s 			page 141


 3930              		.loc 3 2173 61
 3931 0093 488B45D8 		movq	-40(%rbp), %rax
 3932 0097 488B00   		movq	(%rax), %rax
2173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                        ssl->conf->transport, p );
 3933              		.loc 3 2173 67
 3934 009a 0FB680B9 		movzbl	185(%rax), %eax
 3934      000000
2173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                        ssl->conf->transport, p );
 3935              		.loc 3 2173 5
 3936 00a1 0FB6F0   		movzbl	%al, %esi
2173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                        ssl->conf->transport, p );
 3937              		.loc 3 2173 35
 3938 00a4 488B45D8 		movq	-40(%rbp), %rax
 3939 00a8 488B00   		movq	(%rax), %rax
2173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                        ssl->conf->transport, p );
 3940              		.loc 3 2173 41
 3941 00ab 0FB680B8 		movzbl	184(%rax), %eax
 3941      000000
2173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                        ssl->conf->transport, p );
 3942              		.loc 3 2173 5
 3943 00b2 0FB6C0   		movzbl	%al, %eax
 3944 00b5 488B4DF0 		movq	-16(%rbp), %rcx
 3945 00b9 89C7     		movl	%eax, %edi
 3946 00bb E8000000 		call	mbedtls_ssl_write_version@PLT
 3946      00
2175:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2176:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( ret = ssl->conf->f_rng( ssl->conf->p_rng, p + 2, 46 ) ) != 0 )
 3947              		.loc 3 2176 20
 3948 00c0 488B45D8 		movq	-40(%rbp), %rax
 3949 00c4 488B00   		movq	(%rax), %rax
 3950              		.loc 3 2176 26
 3951 00c7 488B4830 		movq	48(%rax), %rcx
 3952              		.loc 3 2176 17
 3953 00cb 488B45F0 		movq	-16(%rbp), %rax
 3954 00cf 488D7002 		leaq	2(%rax), %rsi
 3955              		.loc 3 2176 38
 3956 00d3 488B45D8 		movq	-40(%rbp), %rax
 3957 00d7 488B00   		movq	(%rax), %rax
 3958              		.loc 3 2176 17
 3959 00da 488B4038 		movq	56(%rax), %rax
 3960 00de BA2E0000 		movl	$46, %edx
 3960      00
 3961 00e3 4889C7   		movq	%rax, %rdi
 3962 00e6 FFD1     		call	*%rcx
 3963              	.LVL3:
 3964 00e8 8945E4   		movl	%eax, -28(%rbp)
 3965              		.loc 3 2176 7
 3966 00eb 837DE400 		cmpl	$0, -28(%rbp)
 3967 00ef 7408     		je	.L239
2177:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2178:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "f_rng", ret );
2179:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( ret );
 3968              		.loc 3 2179 15
 3969 00f1 8B45E4   		movl	-28(%rbp), %eax
 3970 00f4 E94E0100 		jmp	.L238
 3970      00
 3971              	.L239:
GAS LISTING /tmp/cc8psT5X.s 			page 142


2180:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2181:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2182:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->handshake->pmslen = 48;
 3972              		.loc 3 2182 8
 3973 00f9 488B45D8 		movq	-40(%rbp), %rax
 3974 00fd 488B4060 		movq	96(%rax), %rax
 3975              		.loc 3 2182 28
 3976 0101 48C78010 		movq	$48, 784(%rax)
 3976      03000030 
 3976      000000
2183:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2184:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->session_negotiate->peer_cert == NULL )
 3977              		.loc 3 2184 12
 3978 010c 488B45D8 		movq	-40(%rbp), %rax
 3979 0110 488B4058 		movq	88(%rax), %rax
 3980              		.loc 3 2184 31
 3981 0114 488B4060 		movq	96(%rax), %rax
 3982              		.loc 3 2184 7
 3983 0118 4885C0   		testq	%rax, %rax
 3984 011b 750A     		jne	.L240
2185:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2186:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "certificate required" ) );
2187:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
 3985              		.loc 3 2187 15
 3986 011d B80089FF 		movl	$-30464, %eax
 3986      FF
 3987 0122 E9200100 		jmp	.L238
 3987      00
 3988              	.L240:
2188:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2189:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2190:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
2191:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * Now write it out, encrypted
2192:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
2193:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ! mbedtls_pk_can_do( &ssl->session_negotiate->peer_cert->pk,
 3989              		.loc 3 2193 34
 3990 0127 488B45D8 		movq	-40(%rbp), %rax
 3991 012b 488B4058 		movq	88(%rax), %rax
 3992              		.loc 3 2193 53
 3993 012f 488B4060 		movq	96(%rax), %rax
 3994              		.loc 3 2193 30
 3995 0133 48054801 		addq	$328, %rax
 3995      0000
 3996              		.loc 3 2193 11
 3997 0139 BE010000 		movl	$1, %esi
 3997      00
 3998 013e 4889C7   		movq	%rax, %rdi
 3999 0141 E8000000 		call	mbedtls_pk_can_do@PLT
 3999      00
 4000              		.loc 3 2193 7
 4001 0146 85C0     		testl	%eax, %eax
 4002 0148 750A     		jne	.L241
2194:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 MBEDTLS_PK_RSA ) )
2195:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2196:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "certificate key type mismatch" ) );
2197:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_PK_TYPE_MISMATCH );
 4003              		.loc 3 2197 15
GAS LISTING /tmp/cc8psT5X.s 			page 143


 4004 014a B80093FF 		movl	$-27904, %eax
 4004      FF
 4005 014f E9F30000 		jmp	.L238
 4005      00
 4006              	.L241:
2198:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2199:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( ret = mbedtls_pk_encrypt( &ssl->session_negotiate->peer_cert->pk,
2201:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             p, ssl->handshake->pmslen,
2202:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             ssl->out_msg + offset + len_bytes, olen,
2203:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             MBEDTLS_SSL_OUT_CONTENT_LEN - offset - len_bytes,
2204:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             ssl->conf->f_rng, ssl->conf->p_rng ) ) != 0 )
 4007              		.loc 3 2204 50
 4008 0154 488B45D8 		movq	-40(%rbp), %rax
 4009 0158 488B00   		movq	(%rax), %rax
2200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             p, ssl->handshake->pmslen,
 4010              		.loc 3 2200 17
 4011 015b 4C8B4038 		movq	56(%rax), %r8
 4012              		.loc 3 2204 32
 4013 015f 488B45D8 		movq	-40(%rbp), %rax
 4014 0163 488B00   		movq	(%rax), %rax
2200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             p, ssl->handshake->pmslen,
 4015              		.loc 3 2200 17
 4016 0166 488B7030 		movq	48(%rax), %rsi
2203:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             ssl->conf->f_rng, ssl->conf->p_rng ) ) != 0 )
 4017              		.loc 3 2203 66
 4018 016a 488B55D0 		movq	-48(%rbp), %rdx
 4019 016e 488B45E8 		movq	-24(%rbp), %rax
 4020 0172 4801D0   		addq	%rdx, %rax
2200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             p, ssl->handshake->pmslen,
 4021              		.loc 3 2200 17
 4022 0175 BA803E00 		movl	$16000, %edx
 4022      00
 4023 017a 4829C2   		subq	%rax, %rdx
 4024 017d 4989D1   		movq	%rdx, %r9
2202:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             MBEDTLS_SSL_OUT_CONTENT_LEN - offset - len_bytes,
 4025              		.loc 3 2202 32
 4026 0180 488B45D8 		movq	-40(%rbp), %rax
 4027 0184 488B8028 		movq	296(%rax), %rax
 4027      010000
2202:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             MBEDTLS_SSL_OUT_CONTENT_LEN - offset - len_bytes,
 4028              		.loc 3 2202 51
 4029 018b 488B4DD0 		movq	-48(%rbp), %rcx
 4030 018f 488B55E8 		movq	-24(%rbp), %rdx
 4031 0193 4801CA   		addq	%rcx, %rdx
2200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             p, ssl->handshake->pmslen,
 4032              		.loc 3 2200 17
 4033 0196 488D0C10 		leaq	(%rax,%rdx), %rcx
2201:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             ssl->out_msg + offset + len_bytes, olen,
 4034              		.loc 3 2201 35
 4035 019a 488B45D8 		movq	-40(%rbp), %rax
 4036 019e 488B4060 		movq	96(%rax), %rax
2200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             p, ssl->handshake->pmslen,
 4037              		.loc 3 2200 17
 4038 01a2 488B9010 		movq	784(%rax), %rdx
 4038      030000
2200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             p, ssl->handshake->pmslen,
GAS LISTING /tmp/cc8psT5X.s 			page 144


 4039              		.loc 3 2200 41
 4040 01a9 488B45D8 		movq	-40(%rbp), %rax
 4041 01ad 488B4058 		movq	88(%rax), %rax
2200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             p, ssl->handshake->pmslen,
 4042              		.loc 3 2200 60
 4043 01b1 488B4060 		movq	96(%rax), %rax
2200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             p, ssl->handshake->pmslen,
 4044              		.loc 3 2200 17
 4045 01b5 488DB848 		leaq	328(%rax), %rdi
 4045      010000
 4046 01bc 4C8B55C8 		movq	-56(%rbp), %r10
 4047 01c0 488B45F0 		movq	-16(%rbp), %rax
 4048 01c4 4150     		pushq	%r8
 4049 01c6 56       		pushq	%rsi
 4050 01c7 4D89D0   		movq	%r10, %r8
 4051 01ca 4889C6   		movq	%rax, %rsi
 4052 01cd E8000000 		call	mbedtls_pk_encrypt@PLT
 4052      00
 4053 01d2 4883C410 		addq	$16, %rsp
 4054 01d6 8945E4   		movl	%eax, -28(%rbp)
2200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             p, ssl->handshake->pmslen,
 4055              		.loc 3 2200 7
 4056 01d9 837DE400 		cmpl	$0, -28(%rbp)
 4057 01dd 7405     		je	.L242
2205:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2206:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_rsa_pkcs1_encrypt", ret );
2207:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( ret );
 4058              		.loc 3 2207 15
 4059 01df 8B45E4   		movl	-28(%rbp), %eax
 4060 01e2 EB63     		jmp	.L238
 4061              	.L242:
2208:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2209:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2210:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1) || \
2211:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_2)
2212:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( len_bytes == 2 )
 4062              		.loc 3 2212 7
 4063 01e4 48837DE8 		cmpq	$2, -24(%rbp)
 4063      02
 4064 01e9 7557     		jne	.L243
2213:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2214:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->out_msg[offset+0] = (unsigned char)( *olen >> 8 );
 4065              		.loc 3 2214 51
 4066 01eb 488B45C8 		movq	-56(%rbp), %rax
 4067 01ef 488B00   		movq	(%rax), %rax
 4068              		.loc 3 2214 57
 4069 01f2 48C1E808 		shrq	$8, %rax
 4070 01f6 4889C1   		movq	%rax, %rcx
 4071              		.loc 3 2214 9
 4072 01f9 488B45D8 		movq	-40(%rbp), %rax
 4073 01fd 488B9028 		movq	296(%rax), %rdx
 4073      010000
 4074              		.loc 3 2214 21
 4075 0204 488B45D0 		movq	-48(%rbp), %rax
 4076 0208 4801D0   		addq	%rdx, %rax
 4077              		.loc 3 2214 34
 4078 020b 89CA     		movl	%ecx, %edx
GAS LISTING /tmp/cc8psT5X.s 			page 145


 4079              		.loc 3 2214 32
 4080 020d 8810     		movb	%dl, (%rax)
2215:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->out_msg[offset+1] = (unsigned char)( *olen      );
 4081              		.loc 3 2215 51
 4082 020f 488B45C8 		movq	-56(%rbp), %rax
 4083 0213 488B08   		movq	(%rax), %rcx
 4084              		.loc 3 2215 12
 4085 0216 488B45D8 		movq	-40(%rbp), %rax
 4086 021a 488B8028 		movq	296(%rax), %rax
 4086      010000
 4087              		.loc 3 2215 21
 4088 0221 488B55D0 		movq	-48(%rbp), %rdx
 4089 0225 4883C201 		addq	$1, %rdx
 4090 0229 4801D0   		addq	%rdx, %rax
 4091              		.loc 3 2215 34
 4092 022c 89CA     		movl	%ecx, %edx
 4093              		.loc 3 2215 32
 4094 022e 8810     		movb	%dl, (%rax)
2216:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *olen += 2;
 4095              		.loc 3 2216 15
 4096 0230 488B45C8 		movq	-56(%rbp), %rax
 4097 0234 488B00   		movq	(%rax), %rax
 4098 0237 488D5002 		leaq	2(%rax), %rdx
 4099 023b 488B45C8 		movq	-56(%rbp), %rax
 4100 023f 488910   		movq	%rdx, (%rax)
 4101              	.L243:
2217:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2218:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
2219:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2220:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( 0 );
 4102              		.loc 3 2220 11
 4103 0242 B8000000 		movl	$0, %eax
 4103      00
 4104              	.L238:
2221:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 4105              		.loc 3 2221 1
 4106 0247 488B7DF8 		movq	-8(%rbp), %rdi
 4107 024b 6448333C 		xorq	%fs:40, %rdi
 4107      25280000 
 4107      00
 4108 0254 7405     		je	.L244
 4109 0256 E8000000 		call	__stack_chk_fail@PLT
 4109      00
 4110              	.L244:
 4111 025b C9       		leave
 4112              	.LCFI74:
 4113              		.cfi_def_cfa 7, 8
 4114 025c C3       		ret
 4115              		.cfi_endproc
 4116              	.LFE45:
 4118              		.section	.text.ssl_parse_signature_algorithm,"ax",@progbits
 4120              	ssl_parse_signature_algorithm:
 4121              	.LFB46:
2222:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE_RSA_ENABLED ||
2223:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_KEY_EXCHANGE_RSA_PSK_ENABLED */
2224:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2225:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
GAS LISTING /tmp/cc8psT5X.s 			page 146


2226:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_DHE_RSA_ENABLED) ||                       \
2227:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED) ||                     \
2228:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED)
2229:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_parse_signature_algorithm( mbedtls_ssl_context *ssl,
2230:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                           unsigned char **p,
2231:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                           unsigned char *end,
2232:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                           mbedtls_md_type_t *md_alg,
2233:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                           mbedtls_pk_type_t *pk_alg )
2234:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 4122              		.loc 3 2234 1
 4123              		.cfi_startproc
 4124 0000 F30F1EFA 		endbr64
 4125 0004 55       		pushq	%rbp
 4126              	.LCFI75:
 4127              		.cfi_def_cfa_offset 16
 4128              		.cfi_offset 6, -16
 4129 0005 4889E5   		movq	%rsp, %rbp
 4130              	.LCFI76:
 4131              		.cfi_def_cfa_register 6
 4132 0008 4883EC40 		subq	$64, %rsp
 4133 000c 48897DE8 		movq	%rdi, -24(%rbp)
 4134 0010 488975E0 		movq	%rsi, -32(%rbp)
 4135 0014 488955D8 		movq	%rdx, -40(%rbp)
 4136 0018 48894DD0 		movq	%rcx, -48(%rbp)
 4137 001c 4C8945C8 		movq	%r8, -56(%rbp)
 4138              		.loc 3 2234 1
 4139 0020 64488B04 		movq	%fs:40, %rax
 4139      25280000 
 4139      00
 4140 0029 488945F8 		movq	%rax, -8(%rbp)
 4141 002d 31C0     		xorl	%eax, %eax
2235:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ((void) ssl);
2236:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *md_alg = MBEDTLS_MD_NONE;
 4142              		.loc 3 2236 13
 4143 002f 488B45D0 		movq	-48(%rbp), %rax
 4144 0033 C7000000 		movl	$0, (%rax)
 4144      0000
2237:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *pk_alg = MBEDTLS_PK_NONE;
 4145              		.loc 3 2237 13
 4146 0039 488B45C8 		movq	-56(%rbp), %rax
 4147 003d C7000000 		movl	$0, (%rax)
 4147      0000
2238:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2239:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /* Only in TLS 1.2 */
2240:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->minor_ver != MBEDTLS_SSL_MINOR_VERSION_3 )
 4148              		.loc 3 2240 12
 4149 0043 488B45E8 		movq	-24(%rbp), %rax
 4150 0047 8B4018   		movl	24(%rax), %eax
 4151              		.loc 3 2240 7
 4152 004a 83F803   		cmpl	$3, %eax
 4153 004d 740A     		je	.L246
2241:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2242:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( 0 );
 4154              		.loc 3 2242 15
 4155 004f B8000000 		movl	$0, %eax
 4155      00
 4156 0054 E9AB0000 		jmp	.L247
GAS LISTING /tmp/cc8psT5X.s 			page 147


 4156      00
 4157              	.L246:
2243:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2244:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2245:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( (*p) + 2 > end )
 4158              		.loc 3 2245 10
 4159 0059 488B45E0 		movq	-32(%rbp), %rax
 4160 005d 488B00   		movq	(%rax), %rax
 4161              		.loc 3 2245 14
 4162 0060 4883C002 		addq	$2, %rax
 4163              		.loc 3 2245 7
 4164 0064 483945D8 		cmpq	%rax, -40(%rbp)
 4165 0068 730A     		jnb	.L248
2246:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_KEY_EXCHANGE );
 4166              		.loc 3 2246 15
 4167 006a B80085FF 		movl	$-31488, %eax
 4167      FF
 4168 006f E9900000 		jmp	.L247
 4168      00
 4169              	.L248:
2247:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2248:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
2249:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * Get hash algorithm
2250:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
2251:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( *md_alg = mbedtls_ssl_md_alg_from_hash( (*p)[0] ) ) == MBEDTLS_MD_NONE )
 4170              		.loc 3 2251 52
 4171 0074 488B45E0 		movq	-32(%rbp), %rax
 4172 0078 488B00   		movq	(%rax), %rax
 4173              		.loc 3 2251 55
 4174 007b 0FB600   		movzbl	(%rax), %eax
 4175              		.loc 3 2251 21
 4176 007e 0FB6C0   		movzbl	%al, %eax
 4177 0081 89C7     		movl	%eax, %edi
 4178 0083 E8000000 		call	mbedtls_ssl_md_alg_from_hash@PLT
 4178      00
 4179              		.loc 3 2251 19
 4180 0088 488B55D0 		movq	-48(%rbp), %rdx
 4181 008c 8902     		movl	%eax, (%rdx)
 4182              		.loc 3 2251 11
 4183 008e 488B45D0 		movq	-48(%rbp), %rax
 4184 0092 8B00     		movl	(%rax), %eax
 4185              		.loc 3 2251 7
 4186 0094 85C0     		testl	%eax, %eax
 4187 0096 7507     		jne	.L249
2252:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2253:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "Server used unsupported "
2254:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             "HashAlgorithm %d", *(p)[0] ) );
2255:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_KEY_EXCHANGE );
 4188              		.loc 3 2255 15
 4189 0098 B80085FF 		movl	$-31488, %eax
 4189      FF
 4190 009d EB65     		jmp	.L247
 4191              	.L249:
2256:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2257:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2258:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
2259:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * Get signature algorithm
GAS LISTING /tmp/cc8psT5X.s 			page 148


2260:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
2261:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( *pk_alg = mbedtls_ssl_pk_alg_from_sig( (*p)[1] ) ) == MBEDTLS_PK_NONE )
 4192              		.loc 3 2261 51
 4193 009f 488B45E0 		movq	-32(%rbp), %rax
 4194 00a3 488B00   		movq	(%rax), %rax
 4195              		.loc 3 2261 54
 4196 00a6 4883C001 		addq	$1, %rax
 4197 00aa 0FB600   		movzbl	(%rax), %eax
 4198              		.loc 3 2261 21
 4199 00ad 0FB6C0   		movzbl	%al, %eax
 4200 00b0 89C7     		movl	%eax, %edi
 4201 00b2 E8000000 		call	mbedtls_ssl_pk_alg_from_sig@PLT
 4201      00
 4202              		.loc 3 2261 19
 4203 00b7 488B55C8 		movq	-56(%rbp), %rdx
 4204 00bb 8902     		movl	%eax, (%rdx)
 4205              		.loc 3 2261 11
 4206 00bd 488B45C8 		movq	-56(%rbp), %rax
 4207 00c1 8B00     		movl	(%rax), %eax
 4208              		.loc 3 2261 7
 4209 00c3 85C0     		testl	%eax, %eax
 4210 00c5 7507     		jne	.L250
2262:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2263:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "server used unsupported "
2264:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                             "SignatureAlgorithm %d", (*p)[1] ) );
2265:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_KEY_EXCHANGE );
 4211              		.loc 3 2265 15
 4212 00c7 B80085FF 		movl	$-31488, %eax
 4212      FF
 4213 00cc EB36     		jmp	.L247
 4214              	.L250:
2266:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2267:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2268:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
2269:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * Check if the hash is acceptable
2270:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
2271:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( mbedtls_ssl_check_sig_hash( ssl, *md_alg ) != 0 )
 4215              		.loc 3 2271 9
 4216 00ce 488B45D0 		movq	-48(%rbp), %rax
 4217 00d2 8B10     		movl	(%rax), %edx
 4218 00d4 488B45E8 		movq	-24(%rbp), %rax
 4219 00d8 89D6     		movl	%edx, %esi
 4220 00da 4889C7   		movq	%rax, %rdi
 4221 00dd E8000000 		call	mbedtls_ssl_check_sig_hash@PLT
 4221      00
 4222              		.loc 3 2271 7
 4223 00e2 85C0     		testl	%eax, %eax
 4224 00e4 7407     		je	.L251
2272:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2273:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "server used HashAlgorithm %d that was not offered",
2274:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                     *(p)[0] ) );
2275:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_KEY_EXCHANGE );
 4225              		.loc 3 2275 15
 4226 00e6 B80085FF 		movl	$-31488, %eax
 4226      FF
 4227 00eb EB17     		jmp	.L247
 4228              	.L251:
GAS LISTING /tmp/cc8psT5X.s 			page 149


2276:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2277:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2278:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "Server used SignatureAlgorithm %d", (*p)[1] ) );
2279:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "Server used HashAlgorithm %d", (*p)[0] ) );
2280:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     *p += 2;
 4229              		.loc 3 2280 8
 4230 00ed 488B45E0 		movq	-32(%rbp), %rax
 4231 00f1 488B00   		movq	(%rax), %rax
 4232 00f4 488D5002 		leaq	2(%rax), %rdx
 4233 00f8 488B45E0 		movq	-32(%rbp), %rax
 4234 00fc 488910   		movq	%rdx, (%rax)
2281:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2282:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( 0 );
 4235              		.loc 3 2282 11
 4236 00ff B8000000 		movl	$0, %eax
 4236      00
 4237              	.L247:
2283:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 4238              		.loc 3 2283 1
 4239 0104 488B4DF8 		movq	-8(%rbp), %rcx
 4240 0108 6448330C 		xorq	%fs:40, %rcx
 4240      25280000 
 4240      00
 4241 0111 7405     		je	.L252
 4242 0113 E8000000 		call	__stack_chk_fail@PLT
 4242      00
 4243              	.L252:
 4244 0118 C9       		leave
 4245              	.LCFI77:
 4246              		.cfi_def_cfa 7, 8
 4247 0119 C3       		ret
 4248              		.cfi_endproc
 4249              	.LFE46:
 4251              		.section	.text.ssl_parse_server_key_exchange,"ax",@progbits
 4253              	ssl_parse_server_key_exchange:
 4254              	.LFB47:
2284:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE_DHE_RSA_ENABLED ||
2285:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED ||
2286:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED */
2287:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
2288:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2289:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_ECDH_RSA_ENABLED) || \
2290:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA_ENABLED)
2291:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_get_ecdh_params_from_cert( mbedtls_ssl_context *ssl )
2292:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
2293:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     int ret;
2294:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const mbedtls_ecp_keypair *peer_key;
2295:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2296:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->session_negotiate->peer_cert == NULL )
2297:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2298:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "certificate required" ) );
2299:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
2300:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2301:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ! mbedtls_pk_can_do( &ssl->session_negotiate->peer_cert->pk,
2303:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                      MBEDTLS_PK_ECKEY ) )
2304:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
GAS LISTING /tmp/cc8psT5X.s 			page 150


2305:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "server key not ECDH capable" ) );
2306:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_PK_TYPE_MISMATCH );
2307:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2308:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2309:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     peer_key = mbedtls_pk_ec( ssl->session_negotiate->peer_cert->pk );
2310:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2311:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( ret = mbedtls_ecdh_get_params( &ssl->handshake->ecdh_ctx, peer_key,
2312:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                  MBEDTLS_ECDH_THEIRS ) ) != 0 )
2313:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2314:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_RET( 1, ( "mbedtls_ecdh_get_params" ), ret );
2315:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( ret );
2316:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2317:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2318:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl_check_server_ecdh_params( ssl ) != 0 )
2319:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2320:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server certificate (ECDH curve)" ) );
2321:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE );
2322:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2323:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2324:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( ret );
2325:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
2326:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE_ECDH_RSA_ENABLED) ||
2327:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA_ENABLED */
2328:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2329:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_parse_server_key_exchange( mbedtls_ssl_context *ssl )
2330:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 4255              		.loc 3 2330 1
 4256              		.cfi_startproc
 4257 0000 F30F1EFA 		endbr64
 4258 0004 55       		pushq	%rbp
 4259              	.LCFI78:
 4260              		.cfi_def_cfa_offset 16
 4261              		.cfi_offset 6, -16
 4262 0005 4889E5   		movq	%rsp, %rbp
 4263              	.LCFI79:
 4264              		.cfi_def_cfa_register 6
 4265 0008 53       		pushq	%rbx
 4266 0009 4881ECB8 		subq	$184, %rsp
 4266      000000
 4267              		.cfi_offset 3, -24
 4268 0010 4889BD48 		movq	%rdi, -184(%rbp)
 4268      FFFFFF
 4269              		.loc 3 2330 1
 4270 0017 64488B04 		movq	%fs:40, %rax
 4270      25280000 
 4270      00
 4271 0020 488945E8 		movq	%rax, -24(%rbp)
 4272 0024 31C0     		xorl	%eax, %eax
2331:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     int ret;
2332:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const mbedtls_ssl_ciphersuite_t *ciphersuite_info =
2333:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->transform_negotiate->ciphersuite_info;
 4273              		.loc 3 2333 12
 4274 0026 488B8548 		movq	-184(%rbp), %rax
 4274      FFFFFF
 4275 002d 488B8080 		movq	128(%rax), %rax
 4275      000000
2332:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->transform_negotiate->ciphersuite_info;
GAS LISTING /tmp/cc8psT5X.s 			page 151


 4276              		.loc 3 2332 38
 4277 0034 488B00   		movq	(%rax), %rax
 4278 0037 48898570 		movq	%rax, -144(%rbp)
 4278      FFFFFF
2334:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char *p = NULL, *end = NULL;
 4279              		.loc 3 2334 20
 4280 003e 48C78560 		movq	$0, -160(%rbp)
 4280      FFFFFF00 
 4280      000000
 4281              		.loc 3 2334 31
 4282 0049 48C78578 		movq	$0, -136(%rbp)
 4282      FFFFFF00 
 4282      000000
2335:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2336:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> parse server key exchange" ) );
2337:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2338:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_RSA_ENABLED)
2339:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_RSA )
 4283              		.loc 3 2339 25
 4284 0054 488B8570 		movq	-144(%rbp), %rax
 4284      FFFFFF
 4285 005b 8B4018   		movl	24(%rax), %eax
 4286              		.loc 3 2339 7
 4287 005e 83F801   		cmpl	$1, %eax
 4288 0061 7521     		jne	.L254
2340:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2341:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= skip parse server key exchange" ) );
2342:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->state++;
 4289              		.loc 3 2342 12
 4290 0063 488B8548 		movq	-184(%rbp), %rax
 4290      FFFFFF
 4291 006a 8B4008   		movl	8(%rax), %eax
 4292              		.loc 3 2342 19
 4293 006d 8D5001   		leal	1(%rax), %edx
 4294 0070 488B8548 		movq	-184(%rbp), %rax
 4294      FFFFFF
 4295 0077 895008   		movl	%edx, 8(%rax)
2343:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( 0 );
 4296              		.loc 3 2343 15
 4297 007a B8000000 		movl	$0, %eax
 4297      00
 4298 007f E9E00400 		jmp	.L277
 4298      00
 4299              	.L254:
2344:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2345:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ((void) p);
2346:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ((void) end);
2347:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
2348:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2349:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_ECDH_RSA_ENABLED) || \
2350:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA_ENABLED)
2351:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDH_RSA ||
2352:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA )
2353:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2354:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ( ret = ssl_get_ecdh_params_from_cert( ssl ) ) != 0 )
2355:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2356:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "ssl_get_ecdh_params_from_cert", ret );
GAS LISTING /tmp/cc8psT5X.s 			page 152


2357:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
2358:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                             MBEDTLS_SSL_ALERT_MSG_HANDSHAKE_FAILURE );
2359:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( ret );
2360:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2361:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2362:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= skip parse server key exchange" ) );
2363:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->state++;
2364:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( 0 );
2365:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2366:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ((void) p);
2367:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ((void) end);
2368:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE_ECDH_RSA_ENABLED ||
2369:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA_ENABLED */
2370:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2371:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL__ECP_RESTARTABLE)
2372:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->handshake->ecrs_enabled &&
2373:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->handshake->ecrs_state == ssl_ecrs_ske_start_processing )
2374:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2375:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         goto start_processing;
2376:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2377:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
2378:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2379:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( ret = mbedtls_ssl_read_record( ssl, 1 ) ) != 0 )
 4300              		.loc 3 2379 17
 4301 0084 488B8548 		movq	-184(%rbp), %rax
 4301      FFFFFF
 4302 008b BE010000 		movl	$1, %esi
 4302      00
 4303 0090 4889C7   		movq	%rax, %rdi
 4304 0093 E8000000 		call	mbedtls_ssl_read_record@PLT
 4304      00
 4305 0098 89855CFF 		movl	%eax, -164(%rbp)
 4305      FFFF
 4306              		.loc 3 2379 7
 4307 009e 83BD5CFF 		cmpl	$0, -164(%rbp)
 4307      FFFF00
 4308 00a5 740B     		je	.L256
2380:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2381:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_read_record", ret );
2382:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( ret );
 4309              		.loc 3 2382 15
 4310 00a7 8B855CFF 		movl	-164(%rbp), %eax
 4310      FFFF
 4311 00ad E9B20400 		jmp	.L277
 4311      00
 4312              	.L256:
2383:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2384:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2385:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->in_msgtype != MBEDTLS_SSL_MSG_HANDSHAKE )
 4313              		.loc 3 2385 12
 4314 00b2 488B8548 		movq	-184(%rbp), %rax
 4314      FFFFFF
 4315 00b9 8B80D800 		movl	216(%rax), %eax
 4315      0000
 4316              		.loc 3 2385 7
 4317 00bf 83F816   		cmpl	$22, %eax
 4318 00c2 7423     		je	.L257
GAS LISTING /tmp/cc8psT5X.s 			page 153


2386:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2387:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server key exchange message" ) );
2388:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 4319              		.loc 3 2388 9
 4320 00c4 488B8548 		movq	-184(%rbp), %rax
 4320      FFFFFF
 4321 00cb BA0A0000 		movl	$10, %edx
 4321      00
 4322 00d0 BE020000 		movl	$2, %esi
 4322      00
 4323 00d5 4889C7   		movq	%rax, %rdi
 4324 00d8 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 4324      00
2389:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_UNEXPECTED_MESSAGE );
2390:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
 4325              		.loc 3 2390 15
 4326 00dd B80089FF 		movl	$-30464, %eax
 4326      FF
 4327 00e2 E97D0400 		jmp	.L277
 4327      00
 4328              	.L257:
2391:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2392:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2393:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
2394:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * ServerKeyExchange may be skipped with PSK and RSA-PSK when the server
2395:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * doesn't use a psk_identity_hint
2396:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
2397:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->in_msg[0] != MBEDTLS_SSL_HS_SERVER_KEY_EXCHANGE )
 4329              		.loc 3 2397 12
 4330 00e7 488B8548 		movq	-184(%rbp), %rax
 4330      FFFFFF
 4331 00ee 488B80C8 		movq	200(%rax), %rax
 4331      000000
 4332              		.loc 3 2397 20
 4333 00f5 0FB600   		movzbl	(%rax), %eax
 4334              		.loc 3 2397 7
 4335 00f8 3C0C     		cmpb	$12, %al
 4336 00fa 7457     		je	.L258
2398:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2399:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_PSK ||
 4337              		.loc 3 2399 29
 4338 00fc 488B8570 		movq	-144(%rbp), %rax
 4338      FFFFFF
 4339 0103 8B4018   		movl	24(%rax), %eax
 4340              		.loc 3 2399 11
 4341 0106 83F805   		cmpl	$5, %eax
 4342 0109 740F     		je	.L259
2400:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_RSA_PSK )
 4343              		.loc 3 2400 29 discriminator 1
 4344 010b 488B8570 		movq	-144(%rbp), %rax
 4344      FFFFFF
 4345 0112 8B4018   		movl	24(%rax), %eax
2399:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_RSA_PSK )
 4346              		.loc 3 2399 72 discriminator 1
 4347 0115 83F807   		cmpl	$7, %eax
 4348 0118 7516     		jne	.L260
 4349              	.L259:
GAS LISTING /tmp/cc8psT5X.s 			page 154


2401:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2402:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             /* Current message is probably either
2403:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****              * CertificateRequest or ServerHelloDone */
2404:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ssl->keep_current_message = 1;
 4350              		.loc 3 2404 39
 4351 011a 488B8548 		movq	-184(%rbp), %rax
 4351      FFFFFF
 4352 0121 C780FC00 		movl	$1, 252(%rax)
 4352      00000100 
 4352      0000
2405:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             goto exit;
 4353              		.loc 3 2405 13
 4354 012b E9180400 		jmp	.L261
 4354      00
 4355              	.L260:
2406:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2407:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2408:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "server key exchange message must "
2409:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                     "not be skipped" ) );
2410:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 4356              		.loc 3 2410 9
 4357 0130 488B8548 		movq	-184(%rbp), %rax
 4357      FFFFFF
 4358 0137 BA0A0000 		movl	$10, %edx
 4358      00
 4359 013c BE020000 		movl	$2, %esi
 4359      00
 4360 0141 4889C7   		movq	%rax, %rdi
 4361 0144 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 4361      00
2411:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_UNEXPECTED_MESSAGE );
2412:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2413:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
 4362              		.loc 3 2413 15
 4363 0149 B80089FF 		movl	$-30464, %eax
 4363      FF
 4364 014e E9110400 		jmp	.L277
 4364      00
 4365              	.L258:
2414:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2415:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2416:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL__ECP_RESTARTABLE)
2417:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->handshake->ecrs_enabled )
2418:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->handshake->ecrs_state = ssl_ecrs_ske_start_processing;
2419:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2420:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** start_processing:
2421:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
2422:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     p   = ssl->in_msg + mbedtls_ssl_hs_hdr_len( ssl );
 4366              		.loc 3 2422 14
 4367 0153 488B8548 		movq	-184(%rbp), %rax
 4367      FFFFFF
 4368 015a 488B98C8 		movq	200(%rax), %rbx
 4368      000000
 4369              		.loc 3 2422 25
 4370 0161 488B8548 		movq	-184(%rbp), %rax
 4370      FFFFFF
 4371 0168 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/cc8psT5X.s 			page 155


 4372 016b E8000000 		call	mbedtls_ssl_hs_hdr_len
 4372      00
 4373              		.loc 3 2422 23
 4374 0170 4801D8   		addq	%rbx, %rax
 4375              		.loc 3 2422 9
 4376 0173 48898560 		movq	%rax, -160(%rbp)
 4376      FFFFFF
2423:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     end = ssl->in_msg + ssl->in_hslen;
 4377              		.loc 3 2423 14
 4378 017a 488B8548 		movq	-184(%rbp), %rax
 4378      FFFFFF
 4379 0181 488B90C8 		movq	200(%rax), %rdx
 4379      000000
 4380              		.loc 3 2423 28
 4381 0188 488B8548 		movq	-184(%rbp), %rax
 4381      FFFFFF
 4382 018f 488B80F0 		movq	240(%rax), %rax
 4382      000000
 4383              		.loc 3 2423 9
 4384 0196 4801D0   		addq	%rdx, %rax
 4385 0199 48898578 		movq	%rax, -136(%rbp)
 4385      FFFFFF
2424:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_BUF( 3,   "server key exchange", p, end - p );
2425:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2426:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED)
2427:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_PSK ||
2428:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_RSA_PSK ||
2429:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_DHE_PSK ||
2430:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_PSK )
2431:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2432:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ssl_parse_server_psk_hint( ssl, &p, end ) != 0 )
2433:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2434:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server key exchange message" ) );
2435:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
2436:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                             MBEDTLS_SSL_ALERT_MSG_ILLEGAL_PARAMETER );
2437:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_KEY_EXCHANGE );
2438:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2439:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     } /* FALLTROUGH */
2440:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED */
2441:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2442:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_PSK_ENABLED) ||                       \
2443:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_RSA_PSK_ENABLED)
2444:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_PSK ||
2445:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_RSA_PSK )
2446:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ; /* nothing more to do */
2447:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     else
2448:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE_PSK_ENABLED ||
2449:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_KEY_EXCHANGE_RSA_PSK_ENABLED */
2450:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_DHE_RSA_ENABLED) ||                       \
2451:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_DHE_PSK_ENABLED)
2452:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_DHE_RSA ||
2453:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_DHE_PSK )
2454:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2455:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ssl_parse_server_dh_params( ssl, &p, end ) != 0 )
2456:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2457:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server key exchange message" ) );
2458:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
GAS LISTING /tmp/cc8psT5X.s 			page 156


2459:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                             MBEDTLS_SSL_ALERT_MSG_ILLEGAL_PARAMETER );
2460:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_KEY_EXCHANGE );
2461:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2462:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2463:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     else
2464:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE_DHE_RSA_ENABLED ||
2465:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_KEY_EXCHANGE_DHE_PSK_ENABLED */
2466:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED) ||                     \
2467:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_ECDHE_PSK_ENABLED) ||                     \
2468:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED)
2469:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_RSA ||
 4386              		.loc 3 2469 25
 4387 01a0 488B8570 		movq	-144(%rbp), %rax
 4387      FFFFFF
 4388 01a7 8B4018   		movl	24(%rax), %eax
 4389              		.loc 3 2469 7
 4390 01aa 83F803   		cmpl	$3, %eax
 4391 01ad 741E     		je	.L262
2470:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_PSK ||
 4392              		.loc 3 2470 25 discriminator 1
 4393 01af 488B8570 		movq	-144(%rbp), %rax
 4393      FFFFFF
 4394 01b6 8B4018   		movl	24(%rax), %eax
2469:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_PSK ||
 4395              		.loc 3 2469 74 discriminator 1
 4396 01b9 83F808   		cmpl	$8, %eax
 4397 01bc 740F     		je	.L262
2471:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA )
 4398              		.loc 3 2471 25
 4399 01be 488B8570 		movq	-144(%rbp), %rax
 4399      FFFFFF
 4400 01c5 8B4018   		movl	24(%rax), %eax
2470:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_PSK ||
 4401              		.loc 3 2470 74
 4402 01c8 83F804   		cmpl	$4, %eax
 4403 01cb 7547     		jne	.L263
 4404              	.L262:
2472:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2473:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ssl_parse_server_ecdh_params( ssl, &p, end ) != 0 )
 4405              		.loc 3 2473 13
 4406 01cd 488B9578 		movq	-136(%rbp), %rdx
 4406      FFFFFF
 4407 01d4 488D8D60 		leaq	-160(%rbp), %rcx
 4407      FFFFFF
 4408 01db 488B8548 		movq	-184(%rbp), %rax
 4408      FFFFFF
 4409 01e2 4889CE   		movq	%rcx, %rsi
 4410 01e5 4889C7   		movq	%rax, %rdi
 4411 01e8 E8000000 		call	ssl_parse_server_ecdh_params
 4411      00
 4412              		.loc 3 2473 11
 4413 01ed 85C0     		testl	%eax, %eax
 4414 01ef 742D     		je	.L265
2474:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2475:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server key exchange message" ) );
2476:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 4415              		.loc 3 2476 13
GAS LISTING /tmp/cc8psT5X.s 			page 157


 4416 01f1 488B8548 		movq	-184(%rbp), %rax
 4416      FFFFFF
 4417 01f8 BA2F0000 		movl	$47, %edx
 4417      00
 4418 01fd BE020000 		movl	$2, %esi
 4418      00
 4419 0202 4889C7   		movq	%rax, %rdi
 4420 0205 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 4420      00
2477:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                             MBEDTLS_SSL_ALERT_MSG_ILLEGAL_PARAMETER );
2478:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_KEY_EXCHANGE );
 4421              		.loc 3 2478 19
 4422 020a B80085FF 		movl	$-31488, %eax
 4422      FF
 4423 020f E9500300 		jmp	.L277
 4423      00
 4424              	.L263:
2479:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2480:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2481:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     else
2482:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED ||
2483:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_KEY_EXCHANGE_ECDHE_PSK_ENABLED ||
2484:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED */
2485:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
2486:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECJPAKE )
2487:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2488:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ret = mbedtls_ecjpake_read_round_two( &ssl->handshake->ecjpake_ctx,
2489:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                               p, end - p );
2490:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ret != 0 )
2491:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2492:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ecjpake_read_round_two", ret );
2493:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
2494:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                             MBEDTLS_SSL_ALERT_MSG_ILLEGAL_PARAMETER );
2495:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_KEY_EXCHANGE );
2496:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2497:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2498:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     else
2499:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED */
2500:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2501:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
2502:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 4425              		.loc 3 2502 15
 4426 0214 B80094FF 		movl	$-27648, %eax
 4426      FF
 4427 0219 E9460300 		jmp	.L277
 4427      00
 4428              	.L265:
2503:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2504:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2505:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE__WITH_SERVER_SIGNATURE__ENABLED)
2506:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( mbedtls_ssl_ciphersuite_uses_server_signature( ciphersuite_info ) )
 4429              		.loc 3 2506 9
 4430 021e 488B8570 		movq	-144(%rbp), %rax
 4430      FFFFFF
 4431 0225 4889C7   		movq	%rax, %rdi
 4432 0228 E8000000 		call	mbedtls_ssl_ciphersuite_uses_server_signature
 4432      00
GAS LISTING /tmp/cc8psT5X.s 			page 158


 4433              		.loc 3 2506 7
 4434 022d 85C0     		testl	%eax, %eax
 4435 022f 0F841203 		je	.L279
 4435      0000
 4436              	.LBB4:
2507:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2508:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         size_t sig_len, hashlen;
2509:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         unsigned char hash[64];
2510:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_md_type_t md_alg = MBEDTLS_MD_NONE;
 4437              		.loc 3 2510 27
 4438 0235 C78554FF 		movl	$0, -172(%rbp)
 4438      FFFF0000 
 4438      0000
2511:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_pk_type_t pk_alg = MBEDTLS_PK_NONE;
 4439              		.loc 3 2511 27
 4440 023f C78558FF 		movl	$0, -168(%rbp)
 4440      FFFF0000 
 4440      0000
2512:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         unsigned char *params = ssl->in_msg + mbedtls_ssl_hs_hdr_len( ssl );
 4441              		.loc 3 2512 36
 4442 0249 488B8548 		movq	-184(%rbp), %rax
 4442      FFFFFF
 4443 0250 488B98C8 		movq	200(%rax), %rbx
 4443      000000
 4444              		.loc 3 2512 47
 4445 0257 488B8548 		movq	-184(%rbp), %rax
 4445      FFFFFF
 4446 025e 4889C7   		movq	%rax, %rdi
 4447 0261 E8000000 		call	mbedtls_ssl_hs_hdr_len
 4447      00
 4448              		.loc 3 2512 24
 4449 0266 4801D8   		addq	%rbx, %rax
 4450 0269 48894580 		movq	%rax, -128(%rbp)
2513:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         size_t params_len = p - params;
 4451              		.loc 3 2513 31
 4452 026d 488B8560 		movq	-160(%rbp), %rax
 4452      FFFFFF
 4453 0274 482B4580 		subq	-128(%rbp), %rax
 4454              		.loc 3 2513 16
 4455 0278 48894588 		movq	%rax, -120(%rbp)
2514:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         void *rs_ctx = NULL;
 4456              		.loc 3 2514 15
 4457 027c 48C74590 		movq	$0, -112(%rbp)
 4457      00000000 
2515:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2516:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         /*
2517:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * Handle the digitally-signed structure
2518:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          */
2519:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
2520:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_3 )
 4458              		.loc 3 2520 16
 4459 0284 488B8548 		movq	-184(%rbp), %rax
 4459      FFFFFF
 4460 028b 8B4018   		movl	24(%rax), %eax
 4461              		.loc 3 2520 11
 4462 028e 83F803   		cmpl	$3, %eax
 4463 0291 0F859100 		jne	.L266
GAS LISTING /tmp/cc8psT5X.s 			page 159


 4463      0000
2521:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2522:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( ssl_parse_signature_algorithm( ssl, &p, end,
 4464              		.loc 3 2522 17
 4465 0297 488DBD58 		leaq	-168(%rbp), %rdi
 4465      FFFFFF
 4466 029e 488D8D54 		leaq	-172(%rbp), %rcx
 4466      FFFFFF
 4467 02a5 488B9578 		movq	-136(%rbp), %rdx
 4467      FFFFFF
 4468 02ac 488DB560 		leaq	-160(%rbp), %rsi
 4468      FFFFFF
 4469 02b3 488B8548 		movq	-184(%rbp), %rax
 4469      FFFFFF
 4470 02ba 4989F8   		movq	%rdi, %r8
 4471 02bd 4889C7   		movq	%rax, %rdi
 4472 02c0 E8000000 		call	ssl_parse_signature_algorithm
 4472      00
 4473              		.loc 3 2522 15
 4474 02c5 85C0     		testl	%eax, %eax
 4475 02c7 7423     		je	.L267
2523:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                                &md_alg, &pk_alg ) != 0 )
2524:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             {
2525:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server key exchange message" ) );
2526:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 4476              		.loc 3 2526 17
 4477 02c9 488B8548 		movq	-184(%rbp), %rax
 4477      FFFFFF
 4478 02d0 BA2F0000 		movl	$47, %edx
 4478      00
 4479 02d5 BE020000 		movl	$2, %esi
 4479      00
 4480 02da 4889C7   		movq	%rax, %rdi
 4481 02dd E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 4481      00
2527:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                                 MBEDTLS_SSL_ALERT_MSG_ILLEGAL_PARAMETER );
2528:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_KEY_EXCHANGE );
 4482              		.loc 3 2528 23
 4483 02e2 B80085FF 		movl	$-31488, %eax
 4483      FF
 4484 02e7 E9780200 		jmp	.L277
 4484      00
 4485              	.L267:
2529:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             }
2530:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2531:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( pk_alg != mbedtls_ssl_get_ciphersuite_sig_pk_alg( ciphersuite_info ) )
 4486              		.loc 3 2531 27
 4487 02ec 488B8570 		movq	-144(%rbp), %rax
 4487      FFFFFF
 4488 02f3 4889C7   		movq	%rax, %rdi
 4489 02f6 E8000000 		call	mbedtls_ssl_get_ciphersuite_sig_pk_alg@PLT
 4489      00
 4490              		.loc 3 2531 24
 4491 02fb 8B9558FF 		movl	-168(%rbp), %edx
 4491      FFFF
 4492              		.loc 3 2531 15
 4493 0301 39D0     		cmpl	%edx, %eax
GAS LISTING /tmp/cc8psT5X.s 			page 160


 4494 0303 742D     		je	.L269
2532:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             {
2533:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server key exchange message" ) );
2534:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 4495              		.loc 3 2534 17
 4496 0305 488B8548 		movq	-184(%rbp), %rax
 4496      FFFFFF
 4497 030c BA2F0000 		movl	$47, %edx
 4497      00
 4498 0311 BE020000 		movl	$2, %esi
 4498      00
 4499 0316 4889C7   		movq	%rax, %rdi
 4500 0319 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 4500      00
2535:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                                 MBEDTLS_SSL_ALERT_MSG_ILLEGAL_PARAMETER );
2536:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_KEY_EXCHANGE );
 4501              		.loc 3 2536 23
 4502 031e B80085FF 		movl	$-31488, %eax
 4502      FF
 4503 0323 E93C0200 		jmp	.L277
 4503      00
 4504              	.L266:
2537:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             }
2538:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2539:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         else
2540:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
2541:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1) || \
2542:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_1)
2543:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ssl->minor_ver < MBEDTLS_SSL_MINOR_VERSION_3 )
2544:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2545:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             pk_alg = mbedtls_ssl_get_ciphersuite_sig_pk_alg( ciphersuite_info );
2546:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2547:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             /* Default hash for ECDSA is SHA-1 */
2548:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( pk_alg == MBEDTLS_PK_ECDSA && md_alg == MBEDTLS_MD_NONE )
2549:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 md_alg = MBEDTLS_MD_SHA1;
2550:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2551:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         else
2552:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
2553:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2554:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
2555:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 4505              		.loc 3 2555 19
 4506 0328 B80094FF 		movl	$-27648, %eax
 4506      FF
 4507 032d E9320200 		jmp	.L277
 4507      00
 4508              	.L269:
2556:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2557:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2558:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         /*
2559:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * Read signature
2560:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          */
2561:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2562:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( p > end - 2 )
 4509              		.loc 3 2562 21
 4510 0332 488B8578 		movq	-136(%rbp), %rax
 4510      FFFFFF
GAS LISTING /tmp/cc8psT5X.s 			page 161


 4511 0339 488D50FE 		leaq	-2(%rax), %rdx
 4512              		.loc 3 2562 15
 4513 033d 488B8560 		movq	-160(%rbp), %rax
 4513      FFFFFF
 4514              		.loc 3 2562 11
 4515 0344 4839C2   		cmpq	%rax, %rdx
 4516 0347 7323     		jnb	.L270
2563:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2564:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server key exchange message" ) );
2565:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 4517              		.loc 3 2565 13
 4518 0349 488B8548 		movq	-184(%rbp), %rax
 4518      FFFFFF
 4519 0350 BA320000 		movl	$50, %edx
 4519      00
 4520 0355 BE020000 		movl	$2, %esi
 4520      00
 4521 035a 4889C7   		movq	%rax, %rdi
 4522 035d E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 4522      00
2566:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                             MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
2567:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_KEY_EXCHANGE );
 4523              		.loc 3 2567 19
 4524 0362 B80085FF 		movl	$-31488, %eax
 4524      FF
 4525 0367 E9F80100 		jmp	.L277
 4525      00
 4526              	.L270:
2568:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2569:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         sig_len = ( p[0] << 8 ) | p[1];
 4527              		.loc 3 2569 22
 4528 036c 488B8560 		movq	-160(%rbp), %rax
 4528      FFFFFF
 4529 0373 0FB600   		movzbl	(%rax), %eax
 4530 0376 0FB6C0   		movzbl	%al, %eax
 4531              		.loc 3 2569 26
 4532 0379 C1E008   		sall	$8, %eax
 4533 037c 89C2     		movl	%eax, %edx
 4534              		.loc 3 2569 36
 4535 037e 488B8560 		movq	-160(%rbp), %rax
 4535      FFFFFF
 4536 0385 4883C001 		addq	$1, %rax
 4537 0389 0FB600   		movzbl	(%rax), %eax
 4538 038c 0FB6C0   		movzbl	%al, %eax
 4539              		.loc 3 2569 33
 4540 038f 09D0     		orl	%edx, %eax
 4541              		.loc 3 2569 17
 4542 0391 4898     		cltq
 4543 0393 48894598 		movq	%rax, -104(%rbp)
2570:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         p += 2;
 4544              		.loc 3 2570 11
 4545 0397 488B8560 		movq	-160(%rbp), %rax
 4545      FFFFFF
 4546 039e 4883C002 		addq	$2, %rax
 4547 03a2 48898560 		movq	%rax, -160(%rbp)
 4547      FFFFFF
2571:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
GAS LISTING /tmp/cc8psT5X.s 			page 162


2572:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( p != end - sig_len )
 4548              		.loc 3 2572 22
 4549 03a9 488B4598 		movq	-104(%rbp), %rax
 4550 03ad 48F7D8   		negq	%rax
 4551 03b0 4889C2   		movq	%rax, %rdx
 4552 03b3 488B8578 		movq	-136(%rbp), %rax
 4552      FFFFFF
 4553 03ba 4801C2   		addq	%rax, %rdx
 4554              		.loc 3 2572 15
 4555 03bd 488B8560 		movq	-160(%rbp), %rax
 4555      FFFFFF
 4556              		.loc 3 2572 11
 4557 03c4 4839C2   		cmpq	%rax, %rdx
 4558 03c7 7423     		je	.L271
2573:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2574:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server key exchange message" ) );
2575:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 4559              		.loc 3 2575 13
 4560 03c9 488B8548 		movq	-184(%rbp), %rax
 4560      FFFFFF
 4561 03d0 BA320000 		movl	$50, %edx
 4561      00
 4562 03d5 BE020000 		movl	$2, %esi
 4562      00
 4563 03da 4889C7   		movq	%rax, %rdi
 4564 03dd E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 4564      00
2576:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                             MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
2577:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_KEY_EXCHANGE );
 4565              		.loc 3 2577 19
 4566 03e2 B80085FF 		movl	$-31488, %eax
 4566      FF
 4567 03e7 E9780100 		jmp	.L277
 4567      00
 4568              	.L271:
2578:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2579:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2580:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_BUF( 3, "signature", p, sig_len );
2581:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2582:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         /*
2583:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * Compute the hash that has been signed
2584:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          */
2585:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1) || \
2586:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_1)
2587:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( md_alg == MBEDTLS_MD_NONE )
2588:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2589:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             hashlen = 36;
2590:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ret = mbedtls_ssl_get_key_exchange_md_ssl_tls( ssl, hash, params,
2591:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                                            params_len );
2592:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( ret != 0 )
2593:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 return( ret );
2594:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2595:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         else
2596:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 || MBEDTLS_SSL_PROTO_TLS1 || \
2597:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_SSL_PROTO_TLS1_1 */
2598:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1) || \
2599:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_2)
GAS LISTING /tmp/cc8psT5X.s 			page 163


2600:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( md_alg != MBEDTLS_MD_NONE )
 4569              		.loc 3 2600 20
 4570 03ec 8B8554FF 		movl	-172(%rbp), %eax
 4570      FFFF
 4571              		.loc 3 2600 11
 4572 03f2 85C0     		testl	%eax, %eax
 4573 03f4 7449     		je	.L272
2601:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2602:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ret = mbedtls_ssl_get_key_exchange_md_tls1_2( ssl, hash, &hashlen,
 4574              		.loc 3 2602 19
 4575 03f6 448B8554 		movl	-172(%rbp), %r8d
 4575      FFFFFF
 4576 03fd 488B7D88 		movq	-120(%rbp), %rdi
 4577 0401 488B4D80 		movq	-128(%rbp), %rcx
 4578 0405 488D9568 		leaq	-152(%rbp), %rdx
 4578      FFFFFF
 4579 040c 488D75A0 		leaq	-96(%rbp), %rsi
 4580 0410 488B8548 		movq	-184(%rbp), %rax
 4580      FFFFFF
 4581 0417 4589C1   		movl	%r8d, %r9d
 4582 041a 4989F8   		movq	%rdi, %r8
 4583 041d 4889C7   		movq	%rax, %rdi
 4584 0420 E8000000 		call	mbedtls_ssl_get_key_exchange_md_tls1_2@PLT
 4584      00
 4585 0425 89855CFF 		movl	%eax, -164(%rbp)
 4585      FFFF
2603:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                                           params, params_len,
2604:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                                           md_alg );
2605:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( ret != 0 )
 4586              		.loc 3 2605 15
 4587 042b 83BD5CFF 		cmpl	$0, -164(%rbp)
 4587      FFFF00
 4588 0432 7415     		je	.L273
2606:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 return( ret );
 4589              		.loc 3 2606 23
 4590 0434 8B855CFF 		movl	-164(%rbp), %eax
 4590      FFFF
 4591 043a E9250100 		jmp	.L277
 4591      00
 4592              	.L272:
2607:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2608:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         else
2609:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1 || MBEDTLS_SSL_PROTO_TLS1_1 || \
2610:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_SSL_PROTO_TLS1_2 */
2611:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2612:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
2613:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 4593              		.loc 3 2613 19
 4594 043f B80094FF 		movl	$-27648, %eax
 4594      FF
 4595 0444 E91B0100 		jmp	.L277
 4595      00
 4596              	.L273:
2614:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2615:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2616:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_BUF( 3, "parameters hash", hash, hashlen );
2617:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
GAS LISTING /tmp/cc8psT5X.s 			page 164


2618:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ssl->session_negotiate->peer_cert == NULL )
 4597              		.loc 3 2618 16
 4598 0449 488B8548 		movq	-184(%rbp), %rax
 4598      FFFFFF
 4599 0450 488B4058 		movq	88(%rax), %rax
 4600              		.loc 3 2618 35
 4601 0454 488B4060 		movq	96(%rax), %rax
 4602              		.loc 3 2618 11
 4603 0458 4885C0   		testq	%rax, %rax
 4604 045b 7523     		jne	.L274
2619:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2620:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "certificate required" ) );
2621:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 4605              		.loc 3 2621 13
 4606 045d 488B8548 		movq	-184(%rbp), %rax
 4606      FFFFFF
 4607 0464 BA280000 		movl	$40, %edx
 4607      00
 4608 0469 BE020000 		movl	$2, %esi
 4608      00
 4609 046e 4889C7   		movq	%rax, %rdi
 4610 0471 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 4610      00
2622:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                             MBEDTLS_SSL_ALERT_MSG_HANDSHAKE_FAILURE );
2623:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
 4611              		.loc 3 2623 19
 4612 0476 B80089FF 		movl	$-30464, %eax
 4612      FF
 4613 047b E9E40000 		jmp	.L277
 4613      00
 4614              	.L274:
2624:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2625:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2626:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         /*
2627:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * Verify signature
2628:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          */
2629:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ! mbedtls_pk_can_do( &ssl->session_negotiate->peer_cert->pk, pk_alg ) )
 4615              		.loc 3 2629 15
 4616 0480 8B8558FF 		movl	-168(%rbp), %eax
 4616      FFFF
 4617              		.loc 3 2629 38
 4618 0486 488B9548 		movq	-184(%rbp), %rdx
 4618      FFFFFF
 4619 048d 488B5258 		movq	88(%rdx), %rdx
 4620              		.loc 3 2629 57
 4621 0491 488B5260 		movq	96(%rdx), %rdx
 4622              		.loc 3 2629 34
 4623 0495 4881C248 		addq	$328, %rdx
 4623      010000
 4624              		.loc 3 2629 15
 4625 049c 89C6     		movl	%eax, %esi
 4626 049e 4889D7   		movq	%rdx, %rdi
 4627 04a1 E8000000 		call	mbedtls_pk_can_do@PLT
 4627      00
 4628              		.loc 3 2629 11
 4629 04a6 85C0     		testl	%eax, %eax
 4630 04a8 7523     		jne	.L275
GAS LISTING /tmp/cc8psT5X.s 			page 165


2630:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2631:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server key exchange message" ) );
2632:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 4631              		.loc 3 2632 13
 4632 04aa 488B8548 		movq	-184(%rbp), %rax
 4632      FFFFFF
 4633 04b1 BA280000 		movl	$40, %edx
 4633      00
 4634 04b6 BE020000 		movl	$2, %esi
 4634      00
 4635 04bb 4889C7   		movq	%rax, %rdi
 4636 04be E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 4636      00
2633:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                             MBEDTLS_SSL_ALERT_MSG_HANDSHAKE_FAILURE );
2634:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( MBEDTLS_ERR_SSL_PK_TYPE_MISMATCH );
 4637              		.loc 3 2634 19
 4638 04c3 B80093FF 		movl	$-27904, %eax
 4638      FF
 4639 04c8 E9970000 		jmp	.L277
 4639      00
 4640              	.L275:
2635:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2636:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2637:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL__ECP_RESTARTABLE)
2638:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ssl->handshake->ecrs_enabled )
2639:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             rs_ctx = &ssl->handshake->ecrs_ctx.pk;
2640:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
2641:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2642:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ( ret = mbedtls_pk_verify_restartable(
 4641              		.loc 3 2642 21
 4642 04cd 488BB560 		movq	-160(%rbp), %rsi
 4642      FFFFFF
 4643 04d4 488B8D68 		movq	-152(%rbp), %rcx
 4643      FFFFFF
 4644 04db 8B8554FF 		movl	-172(%rbp), %eax
 4644      FFFF
2643:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                         &ssl->session_negotiate->peer_cert->pk,
 4645              		.loc 3 2643 29
 4646 04e1 488B9548 		movq	-184(%rbp), %rdx
 4646      FFFFFF
 4647 04e8 488B5258 		movq	88(%rdx), %rdx
 4648              		.loc 3 2643 48
 4649 04ec 488B5260 		movq	96(%rdx), %rdx
2642:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                         &ssl->session_negotiate->peer_cert->pk,
 4650              		.loc 3 2642 21
 4651 04f0 488DBA48 		leaq	328(%rdx), %rdi
 4651      010000
 4652 04f7 4C8B4598 		movq	-104(%rbp), %r8
 4653 04fb 488D55A0 		leaq	-96(%rbp), %rdx
 4654 04ff 4883EC08 		subq	$8, %rsp
 4655 0503 FF7590   		pushq	-112(%rbp)
 4656 0506 4D89C1   		movq	%r8, %r9
 4657 0509 4989F0   		movq	%rsi, %r8
 4658 050c 89C6     		movl	%eax, %esi
 4659 050e E8000000 		call	mbedtls_pk_verify_restartable@PLT
 4659      00
 4660 0513 4883C410 		addq	$16, %rsp
GAS LISTING /tmp/cc8psT5X.s 			page 166


 4661 0517 89855CFF 		movl	%eax, -164(%rbp)
 4661      FFFF
2642:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                         &ssl->session_negotiate->peer_cert->pk,
 4662              		.loc 3 2642 11
 4663 051d 83BD5CFF 		cmpl	$0, -164(%rbp)
 4663      FFFF00
 4664 0524 7422     		je	.L261
2644:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                         md_alg, hash, hashlen, p, sig_len, rs_ctx ) ) != 0 )
2645:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2646:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL__ECP_RESTARTABLE)
2647:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( ret != MBEDTLS_ERR_ECP_IN_PROGRESS )
2648:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
2649:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 4665              		.loc 3 2649 17
 4666 0526 488B8548 		movq	-184(%rbp), %rax
 4666      FFFFFF
 4667 052d BA330000 		movl	$51, %edx
 4667      00
 4668 0532 BE020000 		movl	$2, %esi
 4668      00
 4669 0537 4889C7   		movq	%rax, %rdi
 4670 053a E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 4670      00
2650:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                                 MBEDTLS_SSL_ALERT_MSG_DECRYPT_ERROR );
2651:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_pk_verify", ret );
2652:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL__ECP_RESTARTABLE)
2653:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( ret == MBEDTLS_ERR_ECP_IN_PROGRESS )
2654:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 ret = MBEDTLS_ERR_SSL_CRYPTO_IN_PROGRESS;
2655:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
2656:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( ret );
 4671              		.loc 3 2656 19
 4672 053f 8B855CFF 		movl	-164(%rbp), %eax
 4672      FFFF
 4673 0545 EB1D     		jmp	.L277
 4674              	.L279:
 4675              	.LBE4:
2657:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2658:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2659:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE__WITH_SERVER_SIGNATURE__ENABLED */
2660:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2661:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** exit:
 4676              		.loc 3 2661 1
 4677 0547 90       		nop
 4678              	.L261:
2662:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->state++;
 4679              		.loc 3 2662 8
 4680 0548 488B8548 		movq	-184(%rbp), %rax
 4680      FFFFFF
 4681 054f 8B4008   		movl	8(%rax), %eax
 4682              		.loc 3 2662 15
 4683 0552 8D5001   		leal	1(%rax), %edx
 4684 0555 488B8548 		movq	-184(%rbp), %rax
 4684      FFFFFF
 4685 055c 895008   		movl	%edx, 8(%rax)
2663:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2664:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= parse server key exchange" ) );
2665:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
GAS LISTING /tmp/cc8psT5X.s 			page 167


2666:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( 0 );
 4686              		.loc 3 2666 11
 4687 055f B8000000 		movl	$0, %eax
 4687      00
 4688              	.L277:
2667:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 4689              		.loc 3 2667 1 discriminator 1
 4690 0564 488B5DE8 		movq	-24(%rbp), %rbx
 4691 0568 6448331C 		xorq	%fs:40, %rbx
 4691      25280000 
 4691      00
 4692 0571 7405     		je	.L278
 4693              		.loc 3 2667 1 is_stmt 0
 4694 0573 E8000000 		call	__stack_chk_fail@PLT
 4694      00
 4695              	.L278:
 4696 0578 488B5DF8 		movq	-8(%rbp), %rbx
 4697 057c C9       		leave
 4698              	.LCFI80:
 4699              		.cfi_def_cfa 7, 8
 4700 057d C3       		ret
 4701              		.cfi_endproc
 4702              	.LFE47:
 4704              		.section	.text.ssl_parse_certificate_request,"ax",@progbits
 4706              	ssl_parse_certificate_request:
 4707              	.LFB48:
2668:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2669:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if ! defined(MBEDTLS_KEY_EXCHANGE__CERT_REQ_ALLOWED__ENABLED)
2670:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_parse_certificate_request( mbedtls_ssl_context *ssl )
2671:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
2672:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const mbedtls_ssl_ciphersuite_t *ciphersuite_info =
2673:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->transform_negotiate->ciphersuite_info;
2674:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2675:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> parse certificate request" ) );
2676:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2677:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ! mbedtls_ssl_ciphersuite_cert_req_allowed( ciphersuite_info ) )
2678:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2679:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= skip parse certificate request" ) );
2680:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->state++;
2681:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( 0 );
2682:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2683:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2684:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
2685:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
2686:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
2687:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #else /* MBEDTLS_KEY_EXCHANGE__CERT_REQ_ALLOWED__ENABLED */
2688:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_parse_certificate_request( mbedtls_ssl_context *ssl )
2689:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 4708              		.loc 3 2689 1 is_stmt 1
 4709              		.cfi_startproc
 4710 0000 F30F1EFA 		endbr64
 4711 0004 55       		pushq	%rbp
 4712              	.LCFI81:
 4713              		.cfi_def_cfa_offset 16
 4714              		.cfi_offset 6, -16
 4715 0005 4889E5   		movq	%rsp, %rbp
 4716              	.LCFI82:
GAS LISTING /tmp/cc8psT5X.s 			page 168


 4717              		.cfi_def_cfa_register 6
 4718 0008 53       		pushq	%rbx
 4719 0009 4883EC58 		subq	$88, %rsp
 4720              		.cfi_offset 3, -24
 4721 000d 48897DA8 		movq	%rdi, -88(%rbp)
 4722              		.loc 3 2689 1
 4723 0011 64488B04 		movq	%fs:40, %rax
 4723      25280000 
 4723      00
 4724 001a 488945E8 		movq	%rax, -24(%rbp)
 4725 001e 31C0     		xorl	%eax, %eax
2690:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     int ret;
2691:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char *buf;
2692:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     size_t n = 0;
 4726              		.loc 3 2692 12
 4727 0020 48C745B8 		movq	$0, -72(%rbp)
 4727      00000000 
2693:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     size_t cert_type_len = 0, dn_len = 0;
 4728              		.loc 3 2693 12
 4729 0028 48C745C0 		movq	$0, -64(%rbp)
 4729      00000000 
 4730              		.loc 3 2693 31
 4731 0030 48C745C8 		movq	$0, -56(%rbp)
 4731      00000000 
2694:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const mbedtls_ssl_ciphersuite_t *ciphersuite_info =
2695:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->transform_negotiate->ciphersuite_info;
 4732              		.loc 3 2695 12
 4733 0038 488B45A8 		movq	-88(%rbp), %rax
 4734 003c 488B8080 		movq	128(%rax), %rax
 4734      000000
2694:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const mbedtls_ssl_ciphersuite_t *ciphersuite_info =
 4735              		.loc 3 2694 38
 4736 0043 488B00   		movq	(%rax), %rax
 4737 0046 488945D0 		movq	%rax, -48(%rbp)
2696:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2697:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> parse certificate request" ) );
2698:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2699:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ! mbedtls_ssl_ciphersuite_cert_req_allowed( ciphersuite_info ) )
 4738              		.loc 3 2699 11
 4739 004a 488B45D0 		movq	-48(%rbp), %rax
 4740 004e 4889C7   		movq	%rax, %rdi
 4741 0051 E8000000 		call	mbedtls_ssl_ciphersuite_cert_req_allowed
 4741      00
 4742              		.loc 3 2699 7
 4743 0056 85C0     		testl	%eax, %eax
 4744 0058 751B     		jne	.L281
2700:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2701:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= skip parse certificate request" ) );
2702:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->state++;
 4745              		.loc 3 2702 12
 4746 005a 488B45A8 		movq	-88(%rbp), %rax
 4747 005e 8B4008   		movl	8(%rax), %eax
 4748              		.loc 3 2702 19
 4749 0061 8D5001   		leal	1(%rax), %edx
 4750 0064 488B45A8 		movq	-88(%rbp), %rax
 4751 0068 895008   		movl	%edx, 8(%rax)
2703:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( 0 );
GAS LISTING /tmp/cc8psT5X.s 			page 169


 4752              		.loc 3 2703 15
 4753 006b B8000000 		movl	$0, %eax
 4753      00
 4754 0070 E9C70200 		jmp	.L282
 4754      00
 4755              	.L281:
2704:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2705:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2706:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( ret = mbedtls_ssl_read_record( ssl, 1 ) ) != 0 )
 4756              		.loc 3 2706 17
 4757 0075 488B45A8 		movq	-88(%rbp), %rax
 4758 0079 BE010000 		movl	$1, %esi
 4758      00
 4759 007e 4889C7   		movq	%rax, %rdi
 4760 0081 E8000000 		call	mbedtls_ssl_read_record@PLT
 4760      00
 4761 0086 8945B4   		movl	%eax, -76(%rbp)
 4762              		.loc 3 2706 7
 4763 0089 837DB400 		cmpl	$0, -76(%rbp)
 4764 008d 7408     		je	.L283
2707:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2708:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_read_record", ret );
2709:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( ret );
 4765              		.loc 3 2709 15
 4766 008f 8B45B4   		movl	-76(%rbp), %eax
 4767 0092 E9A50200 		jmp	.L282
 4767      00
 4768              	.L283:
2710:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2711:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2712:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->in_msgtype != MBEDTLS_SSL_MSG_HANDSHAKE )
 4769              		.loc 3 2712 12
 4770 0097 488B45A8 		movq	-88(%rbp), %rax
 4771 009b 8B80D800 		movl	216(%rax), %eax
 4771      0000
 4772              		.loc 3 2712 7
 4773 00a1 83F816   		cmpl	$22, %eax
 4774 00a4 7420     		je	.L284
2713:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2714:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad certificate request message" ) );
2715:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 4775              		.loc 3 2715 9
 4776 00a6 488B45A8 		movq	-88(%rbp), %rax
 4777 00aa BA0A0000 		movl	$10, %edx
 4777      00
 4778 00af BE020000 		movl	$2, %esi
 4778      00
 4779 00b4 4889C7   		movq	%rax, %rdi
 4780 00b7 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 4780      00
2716:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_UNEXPECTED_MESSAGE );
2717:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
 4781              		.loc 3 2717 15
 4782 00bc B80089FF 		movl	$-30464, %eax
 4782      FF
 4783 00c1 E9760200 		jmp	.L282
 4783      00
GAS LISTING /tmp/cc8psT5X.s 			page 170


 4784              	.L284:
2718:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2719:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2720:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->state++;
 4785              		.loc 3 2720 8
 4786 00c6 488B45A8 		movq	-88(%rbp), %rax
 4787 00ca 8B4008   		movl	8(%rax), %eax
 4788              		.loc 3 2720 15
 4789 00cd 8D5001   		leal	1(%rax), %edx
 4790 00d0 488B45A8 		movq	-88(%rbp), %rax
 4791 00d4 895008   		movl	%edx, 8(%rax)
2721:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->client_auth = ( ssl->in_msg[0] == MBEDTLS_SSL_HS_CERTIFICATE_REQUEST );
 4792              		.loc 3 2721 29
 4793 00d7 488B45A8 		movq	-88(%rbp), %rax
 4794 00db 488B80C8 		movq	200(%rax), %rax
 4794      000000
 4795              		.loc 3 2721 37
 4796 00e2 0FB600   		movzbl	(%rax), %eax
 4797              		.loc 3 2721 41
 4798 00e5 3C0D     		cmpb	$13, %al
 4799 00e7 0F94C0   		sete	%al
 4800 00ea 0FB6D0   		movzbl	%al, %edx
 4801              		.loc 3 2721 22
 4802 00ed 488B45A8 		movq	-88(%rbp), %rax
 4803 00f1 89905001 		movl	%edx, 336(%rax)
 4803      0000
2722:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2723:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "got %s certificate request",
2724:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                         ssl->client_auth ? "a" : "no" ) );
2725:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2726:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->client_auth == 0 )
 4804              		.loc 3 2726 12
 4805 00f7 488B45A8 		movq	-88(%rbp), %rax
 4806 00fb 8B805001 		movl	336(%rax), %eax
 4806      0000
 4807              		.loc 3 2726 7
 4808 0101 85C0     		testl	%eax, %eax
 4809 0103 7513     		jne	.L285
2727:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2728:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         /* Current message is probably the ServerHelloDone */
2729:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->keep_current_message = 1;
 4810              		.loc 3 2729 35
 4811 0105 488B45A8 		movq	-88(%rbp), %rax
 4812 0109 C780FC00 		movl	$1, 252(%rax)
 4812      00000100 
 4812      0000
2730:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         goto exit;
 4813              		.loc 3 2730 9
 4814 0113 E91F0200 		jmp	.L286
 4814      00
 4815              	.L285:
2731:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2732:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2733:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
2734:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *  struct {
2735:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *      ClientCertificateType certificate_types<1..2^8-1>;
2736:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *      SignatureAndHashAlgorithm
GAS LISTING /tmp/cc8psT5X.s 			page 171


2737:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *        supported_signature_algorithms<2^16-1>; -- TLS 1.2 only
2738:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *      DistinguishedName certificate_authorities<0..2^16-1>;
2739:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *  } CertificateRequest;
2740:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *
2741:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *  Since we only support a single certificate on clients, let's just
2742:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *  ignore all the information that's supposed to help us pick a
2743:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *  certificate.
2744:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *
2745:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *  We could check that our certificate matches the request, and bail out
2746:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *  if it doesn't, but it's simpler to just send the certificate anyway,
2747:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *  and give the server the opportunity to decide if it should terminate
2748:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *  the connection when it doesn't like our certificate.
2749:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *
2750:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *  Same goes for the hash in TLS 1.2's signature_algorithms: at this
2751:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *  point we only have one hash available (see comments in
2752:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *  write_certificate_verify), so let's just use what we have.
2753:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *
2754:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *  However, we still minimally parse the message to check it is at least
2755:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *  superficially sane.
2756:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
2757:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     buf = ssl->in_msg;
 4816              		.loc 3 2757 9
 4817 0118 488B45A8 		movq	-88(%rbp), %rax
 4818 011c 488B80C8 		movq	200(%rax), %rax
 4818      000000
 4819 0123 488945D8 		movq	%rax, -40(%rbp)
2758:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2759:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /* certificate_types */
2760:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->in_hslen <= mbedtls_ssl_hs_hdr_len( ssl ) )
 4820              		.loc 3 2760 12
 4821 0127 488B45A8 		movq	-88(%rbp), %rax
 4822 012b 488B98F0 		movq	240(%rax), %rbx
 4822      000000
 4823              		.loc 3 2760 26
 4824 0132 488B45A8 		movq	-88(%rbp), %rax
 4825 0136 4889C7   		movq	%rax, %rdi
 4826 0139 E8000000 		call	mbedtls_ssl_hs_hdr_len
 4826      00
 4827              		.loc 3 2760 7
 4828 013e 4839C3   		cmpq	%rax, %rbx
 4829 0141 7720     		ja	.L287
2761:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2762:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad certificate request message" ) );
2763:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 4830              		.loc 3 2763 9
 4831 0143 488B45A8 		movq	-88(%rbp), %rax
 4832 0147 BA320000 		movl	$50, %edx
 4832      00
 4833 014c BE020000 		movl	$2, %esi
 4833      00
 4834 0151 4889C7   		movq	%rax, %rdi
 4835 0154 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 4835      00
2764:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
2765:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE_REQUEST );
 4836              		.loc 3 2765 15
 4837 0159 B88085FF 		movl	$-31360, %eax
GAS LISTING /tmp/cc8psT5X.s 			page 172


 4837      FF
 4838 015e E9D90100 		jmp	.L282
 4838      00
 4839              	.L287:
2766:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2767:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     cert_type_len = buf[mbedtls_ssl_hs_hdr_len( ssl )];
 4840              		.loc 3 2767 25
 4841 0163 488B45A8 		movq	-88(%rbp), %rax
 4842 0167 4889C7   		movq	%rax, %rdi
 4843 016a E8000000 		call	mbedtls_ssl_hs_hdr_len
 4843      00
 4844              		.loc 3 2767 24
 4845 016f 488B55D8 		movq	-40(%rbp), %rdx
 4846 0173 4801D0   		addq	%rdx, %rax
 4847 0176 0FB600   		movzbl	(%rax), %eax
 4848              		.loc 3 2767 19
 4849 0179 0FB6C0   		movzbl	%al, %eax
 4850 017c 488945C0 		movq	%rax, -64(%rbp)
2768:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     n = cert_type_len;
 4851              		.loc 3 2768 7
 4852 0180 488B45C0 		movq	-64(%rbp), %rax
 4853 0184 488945B8 		movq	%rax, -72(%rbp)
2769:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2770:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
2771:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * In the subsequent code there are two paths that read from buf:
2772:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     * the length of the signature algorithms field (if minor version of
2773:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *       SSL is 3),
2774:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     * distinguished name length otherwise.
2775:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * Both reach at most the index:
2776:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *    ...hdr_len + 2 + n,
2777:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * therefore the buffer length at this point must be greater than that
2778:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * regardless of the actual code path.
2779:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
2780:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->in_hslen <= mbedtls_ssl_hs_hdr_len( ssl ) + 2 + n )
 4854              		.loc 3 2780 12
 4855 0188 488B45A8 		movq	-88(%rbp), %rax
 4856 018c 488B98F0 		movq	240(%rax), %rbx
 4856      000000
 4857              		.loc 3 2780 26
 4858 0193 488B45A8 		movq	-88(%rbp), %rax
 4859 0197 4889C7   		movq	%rax, %rdi
 4860 019a E8000000 		call	mbedtls_ssl_hs_hdr_len
 4860      00
 4861              		.loc 3 2780 60
 4862 019f 488B55B8 		movq	-72(%rbp), %rdx
 4863 01a3 4801D0   		addq	%rdx, %rax
 4864 01a6 4883C002 		addq	$2, %rax
 4865              		.loc 3 2780 7
 4866 01aa 4839C3   		cmpq	%rax, %rbx
 4867 01ad 7720     		ja	.L288
2781:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2782:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad certificate request message" ) );
2783:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 4868              		.loc 3 2783 9
 4869 01af 488B45A8 		movq	-88(%rbp), %rax
 4870 01b3 BA320000 		movl	$50, %edx
 4870      00
GAS LISTING /tmp/cc8psT5X.s 			page 173


 4871 01b8 BE020000 		movl	$2, %esi
 4871      00
 4872 01bd 4889C7   		movq	%rax, %rdi
 4873 01c0 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 4873      00
2784:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
2785:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE_REQUEST );
 4874              		.loc 3 2785 15
 4875 01c5 B88085FF 		movl	$-31360, %eax
 4875      FF
 4876 01ca E96D0100 		jmp	.L282
 4876      00
 4877              	.L288:
2786:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2787:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2788:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /* supported_signature_algorithms */
2789:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
2790:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_3 )
 4878              		.loc 3 2790 12
 4879 01cf 488B45A8 		movq	-88(%rbp), %rax
 4880 01d3 8B4018   		movl	24(%rax), %eax
 4881              		.loc 3 2790 7
 4882 01d6 83F803   		cmpl	$3, %eax
 4883 01d9 0F85B600 		jne	.L289
 4883      0000
 4884              	.LBB5:
2791:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2792:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         size_t sig_alg_len = ( ( buf[mbedtls_ssl_hs_hdr_len( ssl ) + 1 + n] <<  8 )
 4885              		.loc 3 2792 38
 4886 01df 488B45A8 		movq	-88(%rbp), %rax
 4887 01e3 4889C7   		movq	%rax, %rdi
 4888 01e6 E8000000 		call	mbedtls_ssl_hs_hdr_len
 4888      00
 4889              		.loc 3 2792 72
 4890 01eb 488B55B8 		movq	-72(%rbp), %rdx
 4891 01ef 4801D0   		addq	%rdx, %rax
 4892 01f2 488D5001 		leaq	1(%rax), %rdx
 4893              		.loc 3 2792 37
 4894 01f6 488B45D8 		movq	-40(%rbp), %rax
 4895 01fa 4801D0   		addq	%rdx, %rax
 4896 01fd 0FB600   		movzbl	(%rax), %eax
 4897 0200 0FB6C0   		movzbl	%al, %eax
 4898              		.loc 3 2792 77
 4899 0203 C1E008   		sall	$8, %eax
 4900 0206 89C3     		movl	%eax, %ebx
2793:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                              | ( buf[mbedtls_ssl_hs_hdr_len( ssl ) + 2 + n]       ) );
 4901              		.loc 3 2793 38
 4902 0208 488B45A8 		movq	-88(%rbp), %rax
 4903 020c 4889C7   		movq	%rax, %rdi
 4904 020f E8000000 		call	mbedtls_ssl_hs_hdr_len
 4904      00
 4905              		.loc 3 2793 72
 4906 0214 488B55B8 		movq	-72(%rbp), %rdx
 4907 0218 4801D0   		addq	%rdx, %rax
 4908 021b 488D5002 		leaq	2(%rax), %rdx
 4909              		.loc 3 2793 37
 4910 021f 488B45D8 		movq	-40(%rbp), %rax
GAS LISTING /tmp/cc8psT5X.s 			page 174


 4911 0223 4801D0   		addq	%rdx, %rax
 4912 0226 0FB600   		movzbl	(%rax), %eax
 4913 0229 0FB6C0   		movzbl	%al, %eax
 4914              		.loc 3 2793 30
 4915 022c 09D8     		orl	%ebx, %eax
2792:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                              | ( buf[mbedtls_ssl_hs_hdr_len( ssl ) + 2 + n]       ) );
 4916              		.loc 3 2792 16
 4917 022e 4898     		cltq
 4918 0230 488945E0 		movq	%rax, -32(%rbp)
2794:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_DEBUG_C)
2795:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         unsigned char* sig_alg;
2796:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         size_t i;
2797:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
2798:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2799:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         /*
2800:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * The furthest access in buf is in the loop few lines below:
2801:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          *     sig_alg[i + 1],
2802:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * where:
2803:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          *     sig_alg = buf + ...hdr_len + 3 + n,
2804:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          *     max(i) = sig_alg_len - 1.
2805:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * Therefore the furthest access is:
2806:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          *     buf[...hdr_len + 3 + n + sig_alg_len - 1 + 1],
2807:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * which reduces to:
2808:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          *     buf[...hdr_len + 3 + n + sig_alg_len],
2809:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * which is one less than we need the buf to be.
2810:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          */
2811:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ssl->in_hslen <= mbedtls_ssl_hs_hdr_len( ssl ) + 3 + n + sig_alg_len )
 4919              		.loc 3 2811 16
 4920 0234 488B45A8 		movq	-88(%rbp), %rax
 4921 0238 488B98F0 		movq	240(%rax), %rbx
 4921      000000
 4922              		.loc 3 2811 30
 4923 023f 488B45A8 		movq	-88(%rbp), %rax
 4924 0243 4889C7   		movq	%rax, %rdi
 4925 0246 E8000000 		call	mbedtls_ssl_hs_hdr_len
 4925      00
 4926              		.loc 3 2811 64
 4927 024b 488B55B8 		movq	-72(%rbp), %rdx
 4928 024f 4801C2   		addq	%rax, %rdx
 4929              		.loc 3 2811 68
 4930 0252 488B45E0 		movq	-32(%rbp), %rax
 4931 0256 4801D0   		addq	%rdx, %rax
 4932 0259 4883C003 		addq	$3, %rax
 4933              		.loc 3 2811 11
 4934 025d 4839C3   		cmpq	%rax, %rbx
 4935 0260 7720     		ja	.L290
2812:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2813:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad certificate request message" ) );
2814:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 4936              		.loc 3 2814 13
 4937 0262 488B45A8 		movq	-88(%rbp), %rax
 4938 0266 BA320000 		movl	$50, %edx
 4938      00
 4939 026b BE020000 		movl	$2, %esi
 4939      00
 4940 0270 4889C7   		movq	%rax, %rdi
 4941 0273 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
GAS LISTING /tmp/cc8psT5X.s 			page 175


 4941      00
2815:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                             MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
2816:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE_REQUEST );
 4942              		.loc 3 2816 19
 4943 0278 B88085FF 		movl	$-31360, %eax
 4943      FF
 4944 027d E9BA0000 		jmp	.L282
 4944      00
 4945              	.L290:
2817:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2818:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2819:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_DEBUG_C)
2820:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         sig_alg = buf + mbedtls_ssl_hs_hdr_len( ssl ) + 3 + n;
2821:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         for( i = 0; i < sig_alg_len; i += 2 )
2822:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2823:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "Supported Signature Algorithm found: %d"
2824:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         ",%d", sig_alg[i], sig_alg[i + 1]  ) );
2825:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2826:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
2827:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2828:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         n += 2 + sig_alg_len;
 4946              		.loc 3 2828 11
 4947 0282 488B55E0 		movq	-32(%rbp), %rdx
 4948 0286 488B45B8 		movq	-72(%rbp), %rax
 4949 028a 4801D0   		addq	%rdx, %rax
 4950 028d 4883C002 		addq	$2, %rax
 4951 0291 488945B8 		movq	%rax, -72(%rbp)
 4952              	.L289:
 4953              	.LBE5:
2829:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2830:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
2831:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2832:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /* certificate_authorities */
2833:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     dn_len = ( ( buf[mbedtls_ssl_hs_hdr_len( ssl ) + 1 + n] <<  8 )
 4954              		.loc 3 2833 22
 4955 0295 488B45A8 		movq	-88(%rbp), %rax
 4956 0299 4889C7   		movq	%rax, %rdi
 4957 029c E8000000 		call	mbedtls_ssl_hs_hdr_len
 4957      00
 4958              		.loc 3 2833 56
 4959 02a1 488B55B8 		movq	-72(%rbp), %rdx
 4960 02a5 4801D0   		addq	%rdx, %rax
 4961 02a8 488D5001 		leaq	1(%rax), %rdx
 4962              		.loc 3 2833 21
 4963 02ac 488B45D8 		movq	-40(%rbp), %rax
 4964 02b0 4801D0   		addq	%rdx, %rax
 4965 02b3 0FB600   		movzbl	(%rax), %eax
 4966 02b6 0FB6C0   		movzbl	%al, %eax
 4967              		.loc 3 2833 61
 4968 02b9 C1E008   		sall	$8, %eax
 4969 02bc 89C3     		movl	%eax, %ebx
2834:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****              | ( buf[mbedtls_ssl_hs_hdr_len( ssl ) + 2 + n]       ) );
 4970              		.loc 3 2834 22
 4971 02be 488B45A8 		movq	-88(%rbp), %rax
 4972 02c2 4889C7   		movq	%rax, %rdi
 4973 02c5 E8000000 		call	mbedtls_ssl_hs_hdr_len
 4973      00
GAS LISTING /tmp/cc8psT5X.s 			page 176


 4974              		.loc 3 2834 56
 4975 02ca 488B55B8 		movq	-72(%rbp), %rdx
 4976 02ce 4801D0   		addq	%rdx, %rax
 4977 02d1 488D5002 		leaq	2(%rax), %rdx
 4978              		.loc 3 2834 21
 4979 02d5 488B45D8 		movq	-40(%rbp), %rax
 4980 02d9 4801D0   		addq	%rdx, %rax
 4981 02dc 0FB600   		movzbl	(%rax), %eax
 4982 02df 0FB6C0   		movzbl	%al, %eax
 4983              		.loc 3 2834 14
 4984 02e2 09D8     		orl	%ebx, %eax
2833:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****              | ( buf[mbedtls_ssl_hs_hdr_len( ssl ) + 2 + n]       ) );
 4985              		.loc 3 2833 12
 4986 02e4 4898     		cltq
 4987 02e6 488945C8 		movq	%rax, -56(%rbp)
2835:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2836:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     n += dn_len;
 4988              		.loc 3 2836 7
 4989 02ea 488B45C8 		movq	-56(%rbp), %rax
 4990 02ee 480145B8 		addq	%rax, -72(%rbp)
2837:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->in_hslen != mbedtls_ssl_hs_hdr_len( ssl ) + 3 + n )
 4991              		.loc 3 2837 12
 4992 02f2 488B45A8 		movq	-88(%rbp), %rax
 4993 02f6 488B98F0 		movq	240(%rax), %rbx
 4993      000000
 4994              		.loc 3 2837 26
 4995 02fd 488B45A8 		movq	-88(%rbp), %rax
 4996 0301 4889C7   		movq	%rax, %rdi
 4997 0304 E8000000 		call	mbedtls_ssl_hs_hdr_len
 4997      00
 4998              		.loc 3 2837 60
 4999 0309 488B55B8 		movq	-72(%rbp), %rdx
 5000 030d 4801D0   		addq	%rdx, %rax
 5001 0310 4883C003 		addq	$3, %rax
 5002              		.loc 3 2837 7
 5003 0314 4839C3   		cmpq	%rax, %rbx
 5004 0317 741D     		je	.L292
2838:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2839:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad certificate request message" ) );
2840:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 5005              		.loc 3 2840 9
 5006 0319 488B45A8 		movq	-88(%rbp), %rax
 5007 031d BA320000 		movl	$50, %edx
 5007      00
 5008 0322 BE020000 		movl	$2, %esi
 5008      00
 5009 0327 4889C7   		movq	%rax, %rdi
 5010 032a E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 5010      00
2841:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
2842:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE_REQUEST );
 5011              		.loc 3 2842 15
 5012 032f B88085FF 		movl	$-31360, %eax
 5012      FF
 5013 0334 EB06     		jmp	.L282
 5014              	.L292:
2843:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
GAS LISTING /tmp/cc8psT5X.s 			page 177


2844:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2845:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** exit:
 5015              		.loc 3 2845 1
 5016 0336 90       		nop
 5017              	.L286:
2846:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= parse certificate request" ) );
2847:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2848:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( 0 );
 5018              		.loc 3 2848 11
 5019 0337 B8000000 		movl	$0, %eax
 5019      00
 5020              	.L282:
2849:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 5021              		.loc 3 2849 1
 5022 033c 488B4DE8 		movq	-24(%rbp), %rcx
 5023 0340 6448330C 		xorq	%fs:40, %rcx
 5023      25280000 
 5023      00
 5024 0349 7405     		je	.L291
 5025 034b E8000000 		call	__stack_chk_fail@PLT
 5025      00
 5026              	.L291:
 5027 0350 4883C458 		addq	$88, %rsp
 5028 0354 5B       		popq	%rbx
 5029 0355 5D       		popq	%rbp
 5030              	.LCFI83:
 5031              		.cfi_def_cfa 7, 8
 5032 0356 C3       		ret
 5033              		.cfi_endproc
 5034              	.LFE48:
 5036              		.section	.text.ssl_parse_server_hello_done,"ax",@progbits
 5038              	ssl_parse_server_hello_done:
 5039              	.LFB49:
2850:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE__CERT_REQ_ALLOWED__ENABLED */
2851:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2852:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_parse_server_hello_done( mbedtls_ssl_context *ssl )
2853:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 5040              		.loc 3 2853 1
 5041              		.cfi_startproc
 5042 0000 F30F1EFA 		endbr64
 5043 0004 55       		pushq	%rbp
 5044              	.LCFI84:
 5045              		.cfi_def_cfa_offset 16
 5046              		.cfi_offset 6, -16
 5047 0005 4889E5   		movq	%rsp, %rbp
 5048              	.LCFI85:
 5049              		.cfi_def_cfa_register 6
 5050 0008 53       		pushq	%rbx
 5051 0009 4883EC28 		subq	$40, %rsp
 5052              		.cfi_offset 3, -24
 5053 000d 48897DD8 		movq	%rdi, -40(%rbp)
 5054              		.loc 3 2853 1
 5055 0011 64488B04 		movq	%fs:40, %rax
 5055      25280000 
 5055      00
 5056 001a 488945E8 		movq	%rax, -24(%rbp)
 5057 001e 31C0     		xorl	%eax, %eax
GAS LISTING /tmp/cc8psT5X.s 			page 178


2854:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     int ret;
2855:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2856:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> parse server hello done" ) );
2857:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2858:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( ret = mbedtls_ssl_read_record( ssl, 1 ) ) != 0 )
 5058              		.loc 3 2858 17
 5059 0020 488B45D8 		movq	-40(%rbp), %rax
 5060 0024 BE010000 		movl	$1, %esi
 5060      00
 5061 0029 4889C7   		movq	%rax, %rdi
 5062 002c E8000000 		call	mbedtls_ssl_read_record@PLT
 5062      00
 5063 0031 8945E4   		movl	%eax, -28(%rbp)
 5064              		.loc 3 2858 7
 5065 0034 837DE400 		cmpl	$0, -28(%rbp)
 5066 0038 7405     		je	.L294
2859:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2860:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_read_record", ret );
2861:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( ret );
 5067              		.loc 3 2861 15
 5068 003a 8B45E4   		movl	-28(%rbp), %eax
 5069 003d EB77     		jmp	.L295
 5070              	.L294:
2862:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2863:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2864:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->in_msgtype != MBEDTLS_SSL_MSG_HANDSHAKE )
 5071              		.loc 3 2864 12
 5072 003f 488B45D8 		movq	-40(%rbp), %rax
 5073 0043 8B80D800 		movl	216(%rax), %eax
 5073      0000
 5074              		.loc 3 2864 7
 5075 0049 83F816   		cmpl	$22, %eax
 5076 004c 7407     		je	.L296
2865:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2866:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server hello done message" ) );
2867:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
 5077              		.loc 3 2867 15
 5078 004e B80089FF 		movl	$-30464, %eax
 5078      FF
 5079 0053 EB61     		jmp	.L295
 5080              	.L296:
2868:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2869:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2870:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->in_hslen  != mbedtls_ssl_hs_hdr_len( ssl ) ||
 5081              		.loc 3 2870 12
 5082 0055 488B45D8 		movq	-40(%rbp), %rax
 5083 0059 488B98F0 		movq	240(%rax), %rbx
 5083      000000
 5084              		.loc 3 2870 27
 5085 0060 488B45D8 		movq	-40(%rbp), %rax
 5086 0064 4889C7   		movq	%rax, %rdi
 5087 0067 E8000000 		call	mbedtls_ssl_hs_hdr_len
 5087      00
 5088              		.loc 3 2870 7
 5089 006c 4839C3   		cmpq	%rax, %rbx
 5090 006f 7512     		jne	.L297
2871:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->in_msg[0] != MBEDTLS_SSL_HS_SERVER_HELLO_DONE )
GAS LISTING /tmp/cc8psT5X.s 			page 179


 5091              		.loc 3 2871 12 discriminator 1
 5092 0071 488B45D8 		movq	-40(%rbp), %rax
 5093 0075 488B80C8 		movq	200(%rax), %rax
 5093      000000
 5094              		.loc 3 2871 20 discriminator 1
 5095 007c 0FB600   		movzbl	(%rax), %eax
2870:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->in_msg[0] != MBEDTLS_SSL_HS_SERVER_HELLO_DONE )
 5096              		.loc 3 2870 57 discriminator 1
 5097 007f 3C0E     		cmpb	$14, %al
 5098 0081 741D     		je	.L298
 5099              	.L297:
2872:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2873:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad server hello done message" ) );
2874:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 5100              		.loc 3 2874 9
 5101 0083 488B45D8 		movq	-40(%rbp), %rax
 5102 0087 BA320000 		movl	$50, %edx
 5102      00
 5103 008c BE020000 		movl	$2, %esi
 5103      00
 5104 0091 4889C7   		movq	%rax, %rdi
 5105 0094 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 5105      00
2875:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
2876:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_SERVER_HELLO_DONE );
 5106              		.loc 3 2876 15
 5107 0099 B88084FF 		movl	$-31616, %eax
 5107      FF
 5108 009e EB16     		jmp	.L295
 5109              	.L298:
2877:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2878:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2879:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->state++;
 5110              		.loc 3 2879 8
 5111 00a0 488B45D8 		movq	-40(%rbp), %rax
 5112 00a4 8B4008   		movl	8(%rax), %eax
 5113              		.loc 3 2879 15
 5114 00a7 8D5001   		leal	1(%rax), %edx
 5115 00aa 488B45D8 		movq	-40(%rbp), %rax
 5116 00ae 895008   		movl	%edx, 8(%rax)
2880:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2881:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
2882:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
2883:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_recv_flight_completed( ssl );
2884:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
2885:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2886:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= parse server hello done" ) );
2887:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2888:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( 0 );
 5117              		.loc 3 2888 11
 5118 00b1 B8000000 		movl	$0, %eax
 5118      00
 5119              	.L295:
2889:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 5120              		.loc 3 2889 1
 5121 00b6 488B4DE8 		movq	-24(%rbp), %rcx
 5122 00ba 6448330C 		xorq	%fs:40, %rcx
GAS LISTING /tmp/cc8psT5X.s 			page 180


 5122      25280000 
 5122      00
 5123 00c3 7405     		je	.L299
 5124 00c5 E8000000 		call	__stack_chk_fail@PLT
 5124      00
 5125              	.L299:
 5126 00ca 4883C428 		addq	$40, %rsp
 5127 00ce 5B       		popq	%rbx
 5128 00cf 5D       		popq	%rbp
 5129              	.LCFI86:
 5130              		.cfi_def_cfa 7, 8
 5131 00d0 C3       		ret
 5132              		.cfi_endproc
 5133              	.LFE49:
 5135              		.section	.text.ssl_write_client_key_exchange,"ax",@progbits
 5137              	ssl_write_client_key_exchange:
 5138              	.LFB50:
2890:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2891:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_write_client_key_exchange( mbedtls_ssl_context *ssl )
2892:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 5139              		.loc 3 2892 1
 5140              		.cfi_startproc
 5141 0000 F30F1EFA 		endbr64
 5142 0004 55       		pushq	%rbp
 5143              	.LCFI87:
 5144              		.cfi_def_cfa_offset 16
 5145              		.cfi_offset 6, -16
 5146 0005 4889E5   		movq	%rsp, %rbp
 5147              	.LCFI88:
 5148              		.cfi_def_cfa_register 6
 5149 0008 4883EC40 		subq	$64, %rsp
 5150 000c 48897DC8 		movq	%rdi, -56(%rbp)
 5151              		.loc 3 2892 1
 5152 0010 64488B04 		movq	%fs:40, %rax
 5152      25280000 
 5152      00
 5153 0019 488945F8 		movq	%rax, -8(%rbp)
 5154 001d 31C0     		xorl	%eax, %eax
2893:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     int ret;
2894:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     size_t i, n;
2895:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const mbedtls_ssl_ciphersuite_t *ciphersuite_info =
2896:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->transform_negotiate->ciphersuite_info;
 5155              		.loc 3 2896 12
 5156 001f 488B45C8 		movq	-56(%rbp), %rax
 5157 0023 488B8080 		movq	128(%rax), %rax
 5157      000000
2895:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->transform_negotiate->ciphersuite_info;
 5158              		.loc 3 2895 38
 5159 002a 488B00   		movq	(%rax), %rax
 5160 002d 488945F0 		movq	%rax, -16(%rbp)
2897:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2898:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> write client key exchange" ) );
2899:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2900:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_DHE_RSA_ENABLED)
2901:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_DHE_RSA )
2902:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2903:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         /*
GAS LISTING /tmp/cc8psT5X.s 			page 181


2904:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * DHM key exchange -- send G^X mod P
2905:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          */
2906:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         n = ssl->handshake->dhm_ctx.len;
2907:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2908:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->out_msg[4] = (unsigned char)( n >> 8 );
2909:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->out_msg[5] = (unsigned char)( n      );
2910:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         i = 6;
2911:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2912:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ret = mbedtls_dhm_make_public( &ssl->handshake->dhm_ctx,
2913:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                 (int) mbedtls_mpi_size( &ssl->handshake->dhm_ctx.P ),
2914:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                &ssl->out_msg[i], n,
2915:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                 ssl->conf->f_rng, ssl->conf->p_rng );
2916:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ret != 0 )
2917:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2918:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_dhm_make_public", ret );
2919:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( ret );
2920:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2921:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2922:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MPI( 3, "DHM: X ", &ssl->handshake->dhm_ctx.X  );
2923:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MPI( 3, "DHM: GX", &ssl->handshake->dhm_ctx.GX );
2924:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2925:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ( ret = mbedtls_dhm_calc_secret( &ssl->handshake->dhm_ctx,
2926:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                       ssl->handshake->premaster,
2927:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                       MBEDTLS_PREMASTER_SIZE,
2928:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                      &ssl->handshake->pmslen,
2929:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                       ssl->conf->f_rng, ssl->conf->p_rng ) ) != 0 )
2930:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2931:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_dhm_calc_secret", ret );
2932:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( ret );
2933:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2934:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2935:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MPI( 3, "DHM: K ", &ssl->handshake->dhm_ctx.K  );
2936:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
2937:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     else
2938:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE_DHE_RSA_ENABLED */
2939:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED) ||                     \
2940:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED) ||                   \
2941:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_ECDH_RSA_ENABLED) ||                      \
2942:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA_ENABLED)
2943:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_RSA ||
 5161              		.loc 3 2943 25
 5162 0031 488B45F0 		movq	-16(%rbp), %rax
 5163 0035 8B4018   		movl	24(%rax), %eax
 5164              		.loc 3 2943 7
 5165 0038 83F803   		cmpl	$3, %eax
 5166 003b 7428     		je	.L301
2944:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA ||
 5167              		.loc 3 2944 25 discriminator 1
 5168 003d 488B45F0 		movq	-16(%rbp), %rax
 5169 0041 8B4018   		movl	24(%rax), %eax
2943:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA ||
 5170              		.loc 3 2943 74 discriminator 1
 5171 0044 83F804   		cmpl	$4, %eax
 5172 0047 741C     		je	.L301
2945:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDH_RSA ||
 5173              		.loc 3 2945 25
 5174 0049 488B45F0 		movq	-16(%rbp), %rax
GAS LISTING /tmp/cc8psT5X.s 			page 182


 5175 004d 8B4018   		movl	24(%rax), %eax
2944:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA ||
 5176              		.loc 3 2944 76
 5177 0050 83F809   		cmpl	$9, %eax
 5178 0053 7410     		je	.L301
2946:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA )
 5179              		.loc 3 2946 25
 5180 0055 488B45F0 		movq	-16(%rbp), %rax
 5181 0059 8B4018   		movl	24(%rax), %eax
2945:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDH_RSA ||
 5182              		.loc 3 2945 73
 5183 005c 83F80A   		cmpl	$10, %eax
 5184 005f 0F85C800 		jne	.L302
 5184      0000
 5185              	.L301:
2947:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
2948:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         /*
2949:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * ECDH key exchange -- send client public value
2950:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          */
2951:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         i = 4;
 5186              		.loc 3 2951 11
 5187 0065 48C745E8 		movq	$4, -24(%rbp)
 5187      04000000 
2952:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2953:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL__ECP_RESTARTABLE)
2954:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ssl->handshake->ecrs_enabled )
2955:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2956:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( ssl->handshake->ecrs_state == ssl_ecrs_cke_ecdh_calc_secret )
2957:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 goto ecdh_calc_secret;
2958:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2959:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             mbedtls_ecdh_enable_restart( &ssl->handshake->ecdh_ctx );
2960:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2961:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
2962:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2963:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ret = mbedtls_ecdh_make_public( &ssl->handshake->ecdh_ctx,
2964:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                 &n,
2965:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                 &ssl->out_msg[i], 1000,
2966:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                 ssl->conf->f_rng, ssl->conf->p_rng );
 5188              		.loc 3 2966 54
 5189 006d 488B45C8 		movq	-56(%rbp), %rax
 5190 0071 488B00   		movq	(%rax), %rax
2963:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                 &n,
 5191              		.loc 3 2963 15
 5192 0074 488B7038 		movq	56(%rax), %rsi
 5193              		.loc 3 2966 36
 5194 0078 488B45C8 		movq	-56(%rbp), %rax
 5195 007c 488B00   		movq	(%rax), %rax
2963:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                 &n,
 5196              		.loc 3 2963 15
 5197 007f 488B4830 		movq	48(%rax), %rcx
2965:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                 ssl->conf->f_rng, ssl->conf->p_rng );
 5198              		.loc 3 2965 37
 5199 0083 488B45C8 		movq	-56(%rbp), %rax
 5200 0087 488B9028 		movq	296(%rax), %rdx
 5200      010000
2963:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                 &n,
 5201              		.loc 3 2963 15
GAS LISTING /tmp/cc8psT5X.s 			page 183


 5202 008e 488B45E8 		movq	-24(%rbp), %rax
 5203 0092 4801C2   		addq	%rax, %rdx
2963:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                 &n,
 5204              		.loc 3 2963 45
 5205 0095 488B45C8 		movq	-56(%rbp), %rax
 5206 0099 488B4060 		movq	96(%rax), %rax
2963:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                 &n,
 5207              		.loc 3 2963 15
 5208 009d 488D7808 		leaq	8(%rax), %rdi
 5209 00a1 488D45E0 		leaq	-32(%rbp), %rax
 5210 00a5 4989F1   		movq	%rsi, %r9
 5211 00a8 4989C8   		movq	%rcx, %r8
 5212 00ab B9E80300 		movl	$1000, %ecx
 5212      00
 5213 00b0 4889C6   		movq	%rax, %rsi
 5214 00b3 E8000000 		call	mbedtls_ecdh_make_public@PLT
 5214      00
 5215 00b8 8945DC   		movl	%eax, -36(%rbp)
2967:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ret != 0 )
 5216              		.loc 3 2967 11
 5217 00bb 837DDC00 		cmpl	$0, -36(%rbp)
 5218 00bf 7408     		je	.L303
2968:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2969:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ecdh_make_public", ret );
2970:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL__ECP_RESTARTABLE)
2971:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( ret == MBEDTLS_ERR_ECP_IN_PROGRESS )
2972:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 ret = MBEDTLS_ERR_SSL_CRYPTO_IN_PROGRESS;
2973:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
2974:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( ret );
 5219              		.loc 3 2974 19
 5220 00c1 8B45DC   		movl	-36(%rbp), %eax
 5221 00c4 E9080100 		jmp	.L309
 5221      00
 5222              	.L303:
2975:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2976:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2977:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_ECDH( 3, &ssl->handshake->ecdh_ctx,
2978:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                 MBEDTLS_DEBUG_ECDH_Q );
2979:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2980:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL__ECP_RESTARTABLE)
2981:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ssl->handshake->ecrs_enabled )
2982:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2983:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ssl->handshake->ecrs_n = n;
2984:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ssl->handshake->ecrs_state = ssl_ecrs_cke_ecdh_calc_secret;
2985:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
2986:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
2987:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** ecdh_calc_secret:
2988:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ssl->handshake->ecrs_enabled )
2989:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             n = ssl->handshake->ecrs_n;
2990:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
2991:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ( ret = mbedtls_ecdh_calc_secret( &ssl->handshake->ecdh_ctx,
2992:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                       &ssl->handshake->pmslen,
2993:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                        ssl->handshake->premaster,
2994:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                        MBEDTLS_MPI_MAX_SIZE,
2995:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                        ssl->conf->f_rng, ssl->conf->p_rng ) ) != 0 )
 5223              		.loc 3 2995 61
 5224 00c9 488B45C8 		movq	-56(%rbp), %rax
GAS LISTING /tmp/cc8psT5X.s 			page 184


 5225 00cd 488B00   		movq	(%rax), %rax
2991:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                       &ssl->handshake->pmslen,
 5226              		.loc 3 2991 21
 5227 00d0 488B7838 		movq	56(%rax), %rdi
 5228              		.loc 3 2995 43
 5229 00d4 488B45C8 		movq	-56(%rbp), %rax
 5230 00d8 488B00   		movq	(%rax), %rax
2991:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                       &ssl->handshake->pmslen,
 5231              		.loc 3 2991 21
 5232 00db 488B4830 		movq	48(%rax), %rcx
2993:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                        MBEDTLS_MPI_MAX_SIZE,
 5233              		.loc 3 2993 43
 5234 00df 488B45C8 		movq	-56(%rbp), %rax
 5235 00e3 488B4060 		movq	96(%rax), %rax
2993:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                        MBEDTLS_MPI_MAX_SIZE,
 5236              		.loc 3 2993 54
 5237 00e7 488D9058 		leaq	856(%rax), %rdx
 5237      030000
2992:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                        ssl->handshake->premaster,
 5238              		.loc 3 2992 43
 5239 00ee 488B45C8 		movq	-56(%rbp), %rax
 5240 00f2 488B4060 		movq	96(%rax), %rax
2991:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                       &ssl->handshake->pmslen,
 5241              		.loc 3 2991 21
 5242 00f6 488DB010 		leaq	784(%rax), %rsi
 5242      030000
2991:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                       &ssl->handshake->pmslen,
 5243              		.loc 3 2991 51
 5244 00fd 488B45C8 		movq	-56(%rbp), %rax
 5245 0101 488B4060 		movq	96(%rax), %rax
2991:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                       &ssl->handshake->pmslen,
 5246              		.loc 3 2991 21
 5247 0105 4883C008 		addq	$8, %rax
 5248 0109 4989F9   		movq	%rdi, %r9
 5249 010c 4989C8   		movq	%rcx, %r8
 5250 010f B9000400 		movl	$1024, %ecx
 5250      00
 5251 0114 4889C7   		movq	%rax, %rdi
 5252 0117 E8000000 		call	mbedtls_ecdh_calc_secret@PLT
 5252      00
 5253 011c 8945DC   		movl	%eax, -36(%rbp)
2991:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                       &ssl->handshake->pmslen,
 5254              		.loc 3 2991 11
 5255 011f 837DDC00 		cmpl	$0, -36(%rbp)
 5256 0123 744A     		je	.L306
2996:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
2997:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ecdh_calc_secret", ret );
2998:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL__ECP_RESTARTABLE)
2999:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( ret == MBEDTLS_ERR_ECP_IN_PROGRESS )
3000:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 ret = MBEDTLS_ERR_SSL_CRYPTO_IN_PROGRESS;
3001:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
3002:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( ret );
 5257              		.loc 3 3002 19
 5258 0125 8B45DC   		movl	-36(%rbp), %eax
 5259 0128 E9A40000 		jmp	.L309
 5259      00
 5260              	.L302:
GAS LISTING /tmp/cc8psT5X.s 			page 185


3003:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
3004:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3005:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_ECDH( 3, &ssl->handshake->ecdh_ctx,
3006:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                 MBEDTLS_DEBUG_ECDH_Z );
3007:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3008:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     else
3009:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED ||
3010:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED ||
3011:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_KEY_EXCHANGE_ECDH_RSA_ENABLED ||
3012:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA_ENABLED */
3013:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED)
3014:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( mbedtls_ssl_ciphersuite_uses_psk( ciphersuite_info ) )
3015:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3016:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         /*
3017:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * opaque psk_identity<0..2^16-1>;
3018:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          */
3019:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ssl->conf->psk == NULL || ssl->conf->psk_identity == NULL )
3020:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
3021:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "got no private key for PSK" ) );
3022:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( MBEDTLS_ERR_SSL_PRIVATE_KEY_REQUIRED );
3023:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
3024:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3025:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         i = 4;
3026:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         n = ssl->conf->psk_identity_len;
3027:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3028:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( i + 2 + n > MBEDTLS_SSL_OUT_CONTENT_LEN )
3029:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
3030:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "psk identity too long or "
3031:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         "SSL buffer too short" ) );
3032:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( MBEDTLS_ERR_SSL_BUFFER_TOO_SMALL );
3033:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
3034:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3035:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->out_msg[i++] = (unsigned char)( n >> 8 );
3036:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->out_msg[i++] = (unsigned char)( n      );
3037:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3038:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         memcpy( ssl->out_msg + i, ssl->conf->psk_identity, ssl->conf->psk_identity_len );
3039:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         i += ssl->conf->psk_identity_len;
3040:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3041:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_PSK_ENABLED)
3042:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_PSK )
3043:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
3044:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             n = 0;
3045:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
3046:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         else
3047:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
3048:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_RSA_PSK_ENABLED)
3049:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_RSA_PSK )
3050:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
3051:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( ( ret = ssl_write_encrypted_pms( ssl, i, &n, 2 ) ) != 0 )
3052:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 return( ret );
3053:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
3054:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         else
3055:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
3056:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_DHE_PSK_ENABLED)
3057:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_DHE_PSK )
3058:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
3059:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             /*
GAS LISTING /tmp/cc8psT5X.s 			page 186


3060:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****              * ClientDiffieHellmanPublic public (DHM send G^X mod P)
3061:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****              */
3062:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             n = ssl->handshake->dhm_ctx.len;
3063:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3064:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( i + 2 + n > MBEDTLS_SSL_OUT_CONTENT_LEN )
3065:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             {
3066:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "psk identity or DHM size too long"
3067:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                             " or SSL buffer too short" ) );
3068:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 return( MBEDTLS_ERR_SSL_BUFFER_TOO_SMALL );
3069:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             }
3070:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3071:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ssl->out_msg[i++] = (unsigned char)( n >> 8 );
3072:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ssl->out_msg[i++] = (unsigned char)( n      );
3073:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3074:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ret = mbedtls_dhm_make_public( &ssl->handshake->dhm_ctx,
3075:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                     (int) mbedtls_mpi_size( &ssl->handshake->dhm_ctx.P ),
3076:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                     &ssl->out_msg[i], n,
3077:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                     ssl->conf->f_rng, ssl->conf->p_rng );
3078:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( ret != 0 )
3079:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             {
3080:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_dhm_make_public", ret );
3081:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 return( ret );
3082:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             }
3083:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
3084:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         else
3085:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE_DHE_PSK_ENABLED */
3086:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_ECDHE_PSK_ENABLED)
3087:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_PSK )
3088:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
3089:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             /*
3090:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****              * ClientECDiffieHellmanPublic public;
3091:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****              */
3092:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ret = mbedtls_ecdh_make_public( &ssl->handshake->ecdh_ctx, &n,
3093:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                     &ssl->out_msg[i], MBEDTLS_SSL_OUT_CONTENT_LEN - i,
3094:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                     ssl->conf->f_rng, ssl->conf->p_rng );
3095:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             if( ret != 0 )
3096:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             {
3097:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ecdh_make_public", ret );
3098:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 return( ret );
3099:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             }
3100:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3101:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_ECDH( 3, &ssl->handshake->ecdh_ctx,
3102:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                     MBEDTLS_DEBUG_ECDH_Q );
3103:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
3104:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         else
3105:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE_ECDHE_PSK_ENABLED */
3106:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
3107:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
3108:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
3109:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
3110:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3111:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ( ret = mbedtls_ssl_psk_derive_premaster( ssl,
3112:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                         ciphersuite_info->key_exchange ) ) != 0 )
3113:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
3114:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_psk_derive_premaster", ret );
3115:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( ret );
3116:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
GAS LISTING /tmp/cc8psT5X.s 			page 187


3117:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3118:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     else
3119:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED */
3120:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_RSA_ENABLED)
3121:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_RSA )
 5261              		.loc 3 3121 25
 5262 012d 488B45F0 		movq	-16(%rbp), %rax
 5263 0131 8B4018   		movl	24(%rax), %eax
 5264              		.loc 3 3121 7
 5265 0134 83F801   		cmpl	$1, %eax
 5266 0137 752F     		jne	.L307
3122:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3123:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         i = 4;
 5267              		.loc 3 3123 11
 5268 0139 48C745E8 		movq	$4, -24(%rbp)
 5268      04000000 
3124:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ( ret = ssl_write_encrypted_pms( ssl, i, &n, 0 ) ) != 0 )
 5269              		.loc 3 3124 21
 5270 0141 488D55E0 		leaq	-32(%rbp), %rdx
 5271 0145 488B75E8 		movq	-24(%rbp), %rsi
 5272 0149 488B45C8 		movq	-56(%rbp), %rax
 5273 014d B9000000 		movl	$0, %ecx
 5273      00
 5274 0152 4889C7   		movq	%rax, %rdi
 5275 0155 E8000000 		call	ssl_write_encrypted_pms
 5275      00
 5276 015a 8945DC   		movl	%eax, -36(%rbp)
 5277              		.loc 3 3124 11
 5278 015d 837DDC00 		cmpl	$0, -36(%rbp)
 5279 0161 740C     		je	.L306
3125:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( ret );
 5280              		.loc 3 3125 19
 5281 0163 8B45DC   		movl	-36(%rbp), %eax
 5282 0166 EB69     		jmp	.L309
 5283              	.L307:
3126:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3127:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     else
3128:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE_RSA_ENABLED */
3129:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
3130:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECJPAKE )
3131:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3132:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         i = 4;
3133:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3134:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ret = mbedtls_ecjpake_write_round_two( &ssl->handshake->ecjpake_ctx,
3135:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 ssl->out_msg + i, MBEDTLS_SSL_OUT_CONTENT_LEN - i, &n,
3136:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 ssl->conf->f_rng, ssl->conf->p_rng );
3137:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ret != 0 )
3138:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
3139:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ecjpake_write_round_two", ret );
3140:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( ret );
3141:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
3142:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3143:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ret = mbedtls_ecjpake_derive_secret( &ssl->handshake->ecjpake_ctx,
3144:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 ssl->handshake->premaster, 32, &ssl->handshake->pmslen,
3145:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                 ssl->conf->f_rng, ssl->conf->p_rng );
3146:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ret != 0 )
3147:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
GAS LISTING /tmp/cc8psT5X.s 			page 188


3148:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ecjpake_derive_secret", ret );
3149:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( ret );
3150:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
3151:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3152:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     else
3153:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_KEY_EXCHANGE_RSA_ENABLED */
3154:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3155:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ((void) ciphersuite_info);
3156:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
3157:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 5284              		.loc 3 3157 15
 5285 0168 B80094FF 		movl	$-27648, %eax
 5285      FF
 5286 016d EB62     		jmp	.L309
 5287              	.L306:
3158:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3159:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3160:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->out_msglen  = i + n;
 5288              		.loc 3 3160 26
 5289 016f 488B55E0 		movq	-32(%rbp), %rdx
 5290 0173 488B45E8 		movq	-24(%rbp), %rax
 5291 0177 4801C2   		addq	%rax, %rdx
 5292              		.loc 3 3160 22
 5293 017a 488B45C8 		movq	-56(%rbp), %rax
 5294 017e 48899038 		movq	%rdx, 312(%rax)
 5294      010000
3161:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->out_msgtype = MBEDTLS_SSL_MSG_HANDSHAKE;
 5295              		.loc 3 3161 22
 5296 0185 488B45C8 		movq	-56(%rbp), %rax
 5297 0189 C7803001 		movl	$22, 304(%rax)
 5297      00001600 
 5297      0000
3162:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->out_msg[0]  = MBEDTLS_SSL_HS_CLIENT_KEY_EXCHANGE;
 5298              		.loc 3 3162 8
 5299 0193 488B45C8 		movq	-56(%rbp), %rax
 5300 0197 488B8028 		movq	296(%rax), %rax
 5300      010000
 5301              		.loc 3 3162 22
 5302 019e C60010   		movb	$16, (%rax)
3163:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3164:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->state++;
 5303              		.loc 3 3164 8
 5304 01a1 488B45C8 		movq	-56(%rbp), %rax
 5305 01a5 8B4008   		movl	8(%rax), %eax
 5306              		.loc 3 3164 15
 5307 01a8 8D5001   		leal	1(%rax), %edx
 5308 01ab 488B45C8 		movq	-56(%rbp), %rax
 5309 01af 895008   		movl	%edx, 8(%rax)
3165:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3166:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( ret = mbedtls_ssl_write_handshake_msg( ssl ) ) != 0 )
 5310              		.loc 3 3166 17
 5311 01b2 488B45C8 		movq	-56(%rbp), %rax
 5312 01b6 4889C7   		movq	%rax, %rdi
 5313 01b9 E8000000 		call	mbedtls_ssl_write_handshake_msg@PLT
 5313      00
 5314 01be 8945DC   		movl	%eax, -36(%rbp)
 5315              		.loc 3 3166 7
GAS LISTING /tmp/cc8psT5X.s 			page 189


 5316 01c1 837DDC00 		cmpl	$0, -36(%rbp)
 5317 01c5 7405     		je	.L308
3167:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3168:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_write_handshake_msg", ret );
3169:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( ret );
 5318              		.loc 3 3169 15
 5319 01c7 8B45DC   		movl	-36(%rbp), %eax
 5320 01ca EB05     		jmp	.L309
 5321              	.L308:
3170:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3171:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3172:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= write client key exchange" ) );
3173:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3174:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( 0 );
 5322              		.loc 3 3174 11
 5323 01cc B8000000 		movl	$0, %eax
 5323      00
 5324              	.L309:
3175:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 5325              		.loc 3 3175 1 discriminator 1
 5326 01d1 488B4DF8 		movq	-8(%rbp), %rcx
 5327 01d5 6448330C 		xorq	%fs:40, %rcx
 5327      25280000 
 5327      00
 5328 01de 7405     		je	.L310
 5329              		.loc 3 3175 1 is_stmt 0
 5330 01e0 E8000000 		call	__stack_chk_fail@PLT
 5330      00
 5331              	.L310:
 5332 01e5 C9       		leave
 5333              	.LCFI89:
 5334              		.cfi_def_cfa 7, 8
 5335 01e6 C3       		ret
 5336              		.cfi_endproc
 5337              	.LFE50:
 5339              		.section	.text.ssl_write_certificate_verify,"ax",@progbits
 5341              	ssl_write_certificate_verify:
 5342              	.LFB51:
3176:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3177:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if !defined(MBEDTLS_KEY_EXCHANGE_RSA_ENABLED)       && \
3178:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     !defined(MBEDTLS_KEY_EXCHANGE_DHE_RSA_ENABLED)   && \
3179:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     !defined(MBEDTLS_KEY_EXCHANGE_ECDH_RSA_ENABLED)  && \
3180:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     !defined(MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED) && \
3181:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     !defined(MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA_ENABLED)&& \
3182:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     !defined(MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED)
3183:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_write_certificate_verify( mbedtls_ssl_context *ssl )
3184:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
3185:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const mbedtls_ssl_ciphersuite_t *ciphersuite_info =
3186:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->transform_negotiate->ciphersuite_info;
3187:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     int ret;
3188:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3189:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> write certificate verify" ) );
3190:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3191:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( ret = mbedtls_ssl_derive_keys( ssl ) ) != 0 )
3192:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3193:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_derive_keys", ret );
3194:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( ret );
GAS LISTING /tmp/cc8psT5X.s 			page 190


3195:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3196:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3197:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_PSK ||
3198:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_RSA_PSK ||
3199:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_PSK ||
3200:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_DHE_PSK ||
3201:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECJPAKE )
3202:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3203:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= skip write certificate verify" ) );
3204:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->state++;
3205:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( 0 );
3206:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3207:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3208:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
3209:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
3210:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
3211:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #else
3212:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_write_certificate_verify( mbedtls_ssl_context *ssl )
3213:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 5343              		.loc 3 3213 1 is_stmt 1
 5344              		.cfi_startproc
 5345 0000 F30F1EFA 		endbr64
 5346 0004 55       		pushq	%rbp
 5347              	.LCFI90:
 5348              		.cfi_def_cfa_offset 16
 5349              		.cfi_offset 6, -16
 5350 0005 4889E5   		movq	%rsp, %rbp
 5351              	.LCFI91:
 5352              		.cfi_def_cfa_register 6
 5353 0008 4156     		pushq	%r14
 5354 000a 4155     		pushq	%r13
 5355 000c 4154     		pushq	%r12
 5356 000e 53       		pushq	%rbx
 5357 000f 4881EC90 		subq	$144, %rsp
 5357      000000
 5358              		.cfi_offset 14, -24
 5359              		.cfi_offset 13, -32
 5360              		.cfi_offset 12, -40
 5361              		.cfi_offset 3, -48
 5362 0016 4889BD58 		movq	%rdi, -168(%rbp)
 5362      FFFFFF
 5363              		.loc 3 3213 1
 5364 001d 64488B04 		movq	%fs:40, %rax
 5364      25280000 
 5364      00
 5365 0026 488945D8 		movq	%rax, -40(%rbp)
 5366 002a 31C0     		xorl	%eax, %eax
3214:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     int ret = MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE;
 5367              		.loc 3 3214 9
 5368 002c C78570FF 		movl	$-28800, -144(%rbp)
 5368      FFFF808F 
 5368      FFFF
3215:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const mbedtls_ssl_ciphersuite_t *ciphersuite_info =
3216:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->transform_negotiate->ciphersuite_info;
 5369              		.loc 3 3216 12
 5370 0036 488B8558 		movq	-168(%rbp), %rax
 5370      FFFFFF
GAS LISTING /tmp/cc8psT5X.s 			page 191


 5371 003d 488B8080 		movq	128(%rax), %rax
 5371      000000
3215:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const mbedtls_ssl_ciphersuite_t *ciphersuite_info =
 5372              		.loc 3 3215 38
 5373 0044 488B00   		movq	(%rax), %rax
 5374 0047 48894580 		movq	%rax, -128(%rbp)
3217:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     size_t n = 0, offset = 0;
 5375              		.loc 3 3217 12
 5376 004b 48C78578 		movq	$0, -136(%rbp)
 5376      FFFFFF00 
 5376      000000
 5377              		.loc 3 3217 19
 5378 0056 48C74588 		movq	$0, -120(%rbp)
 5378      00000000 
3218:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char hash[48];
3219:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char *hash_start = hash;
 5379              		.loc 3 3219 20
 5380 005e 488D45A0 		leaq	-96(%rbp), %rax
 5381 0062 48894590 		movq	%rax, -112(%rbp)
3220:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     mbedtls_md_type_t md_alg = MBEDTLS_MD_NONE;
 5382              		.loc 3 3220 23
 5383 0066 C7856CFF 		movl	$0, -148(%rbp)
 5383      FFFF0000 
 5383      0000
3221:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned int hashlen;
3222:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     void *rs_ctx = NULL;
 5384              		.loc 3 3222 11
 5385 0070 48C74598 		movq	$0, -104(%rbp)
 5385      00000000 
3223:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3224:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> write certificate verify" ) );
3225:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3226:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL__ECP_RESTARTABLE)
3227:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->handshake->ecrs_enabled &&
3228:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->handshake->ecrs_state == ssl_ecrs_crt_vrfy_sign )
3229:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3230:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         goto sign;
3231:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3232:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
3233:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3234:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( ret = mbedtls_ssl_derive_keys( ssl ) ) != 0 )
 5386              		.loc 3 3234 17
 5387 0078 488B8558 		movq	-168(%rbp), %rax
 5387      FFFFFF
 5388 007f 4889C7   		movq	%rax, %rdi
 5389 0082 E8000000 		call	mbedtls_ssl_derive_keys@PLT
 5389      00
 5390 0087 898570FF 		movl	%eax, -144(%rbp)
 5390      FFFF
 5391              		.loc 3 3234 7
 5392 008d 83BD70FF 		cmpl	$0, -144(%rbp)
 5392      FFFF00
 5393 0094 740B     		je	.L312
3235:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3236:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_derive_keys", ret );
3237:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( ret );
 5394              		.loc 3 3237 15
GAS LISTING /tmp/cc8psT5X.s 			page 192


 5395 0096 8B8570FF 		movl	-144(%rbp), %eax
 5395      FFFF
 5396 009c E90A0300 		jmp	.L325
 5396      00
 5397              	.L312:
3238:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3239:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3240:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_PSK ||
 5398              		.loc 3 3240 25
 5399 00a1 488B4580 		movq	-128(%rbp), %rax
 5400 00a5 8B4018   		movl	24(%rax), %eax
 5401              		.loc 3 3240 7
 5402 00a8 83F805   		cmpl	$5, %eax
 5403 00ab 7430     		je	.L314
3241:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_RSA_PSK ||
 5404              		.loc 3 3241 25 discriminator 1
 5405 00ad 488B4580 		movq	-128(%rbp), %rax
 5406 00b1 8B4018   		movl	24(%rax), %eax
3240:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_RSA_PSK ||
 5407              		.loc 3 3240 68 discriminator 1
 5408 00b4 83F807   		cmpl	$7, %eax
 5409 00b7 7424     		je	.L314
3242:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_PSK ||
 5410              		.loc 3 3242 25
 5411 00b9 488B4580 		movq	-128(%rbp), %rax
 5412 00bd 8B4018   		movl	24(%rax), %eax
3241:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_RSA_PSK ||
 5413              		.loc 3 3241 72
 5414 00c0 83F808   		cmpl	$8, %eax
 5415 00c3 7418     		je	.L314
3243:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_DHE_PSK ||
 5416              		.loc 3 3243 25
 5417 00c5 488B4580 		movq	-128(%rbp), %rax
 5418 00c9 8B4018   		movl	24(%rax), %eax
3242:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_PSK ||
 5419              		.loc 3 3242 74
 5420 00cc 83F806   		cmpl	$6, %eax
 5421 00cf 740C     		je	.L314
3244:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECJPAKE )
 5422              		.loc 3 3244 25
 5423 00d1 488B4580 		movq	-128(%rbp), %rax
 5424 00d5 8B4018   		movl	24(%rax), %eax
3243:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_DHE_PSK ||
 5425              		.loc 3 3243 72
 5426 00d8 83F80B   		cmpl	$11, %eax
 5427 00db 7521     		jne	.L315
 5428              	.L314:
3245:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3246:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= skip write certificate verify" ) );
3247:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->state++;
 5429              		.loc 3 3247 12
 5430 00dd 488B8558 		movq	-168(%rbp), %rax
 5430      FFFFFF
 5431 00e4 8B4008   		movl	8(%rax), %eax
 5432              		.loc 3 3247 19
 5433 00e7 8D5001   		leal	1(%rax), %edx
 5434 00ea 488B8558 		movq	-168(%rbp), %rax
GAS LISTING /tmp/cc8psT5X.s 			page 193


 5434      FFFFFF
 5435 00f1 895008   		movl	%edx, 8(%rax)
3248:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( 0 );
 5436              		.loc 3 3248 15
 5437 00f4 B8000000 		movl	$0, %eax
 5437      00
 5438 00f9 E9AD0200 		jmp	.L325
 5438      00
 5439              	.L315:
3249:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3250:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3251:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->client_auth == 0 || mbedtls_ssl_own_cert( ssl ) == NULL )
 5440              		.loc 3 3251 12
 5441 00fe 488B8558 		movq	-168(%rbp), %rax
 5441      FFFFFF
 5442 0105 8B805001 		movl	336(%rax), %eax
 5442      0000
 5443              		.loc 3 3251 7
 5444 010b 85C0     		testl	%eax, %eax
 5445 010d 7414     		je	.L316
 5446              		.loc 3 3251 34 discriminator 1
 5447 010f 488B8558 		movq	-168(%rbp), %rax
 5447      FFFFFF
 5448 0116 4889C7   		movq	%rax, %rdi
 5449 0119 E8000000 		call	mbedtls_ssl_own_cert
 5449      00
 5450              		.loc 3 3251 31 discriminator 1
 5451 011e 4885C0   		testq	%rax, %rax
 5452 0121 7521     		jne	.L317
 5453              	.L316:
3252:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3253:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= skip write certificate verify" ) );
3254:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->state++;
 5454              		.loc 3 3254 12
 5455 0123 488B8558 		movq	-168(%rbp), %rax
 5455      FFFFFF
 5456 012a 8B4008   		movl	8(%rax), %eax
 5457              		.loc 3 3254 19
 5458 012d 8D5001   		leal	1(%rax), %edx
 5459 0130 488B8558 		movq	-168(%rbp), %rax
 5459      FFFFFF
 5460 0137 895008   		movl	%edx, 8(%rax)
3255:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( 0 );
 5461              		.loc 3 3255 15
 5462 013a B8000000 		movl	$0, %eax
 5462      00
 5463 013f E9670200 		jmp	.L325
 5463      00
 5464              	.L317:
3256:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3257:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3258:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( mbedtls_ssl_own_key( ssl ) == NULL )
 5465              		.loc 3 3258 9
 5466 0144 488B8558 		movq	-168(%rbp), %rax
 5466      FFFFFF
 5467 014b 4889C7   		movq	%rax, %rdi
 5468 014e E8000000 		call	mbedtls_ssl_own_key
GAS LISTING /tmp/cc8psT5X.s 			page 194


 5468      00
 5469              		.loc 3 3258 7
 5470 0153 4885C0   		testq	%rax, %rax
 5471 0156 750A     		jne	.L318
3259:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3260:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "got no private key for certificate" ) );
3261:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_PRIVATE_KEY_REQUIRED );
 5472              		.loc 3 3261 15
 5473 0158 B8008AFF 		movl	$-30208, %eax
 5473      FF
 5474 015d E9490200 		jmp	.L325
 5474      00
 5475              	.L318:
3262:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3263:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3264:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
3265:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * Make a signature of the handshake digests
3266:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
3267:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL__ECP_RESTARTABLE)
3268:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->handshake->ecrs_enabled )
3269:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->handshake->ecrs_state = ssl_ecrs_crt_vrfy_sign;
3270:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3271:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** sign:
3272:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
3273:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3274:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->handshake->calc_verify( ssl, hash );
 5476              		.loc 3 3274 8
 5477 0162 488B8558 		movq	-168(%rbp), %rax
 5477      FFFFFF
 5478 0169 488B4060 		movq	96(%rax), %rax
 5479              		.loc 3 3274 19
 5480 016d 488B88F8 		movq	760(%rax), %rcx
 5480      020000
 5481              		.loc 3 3274 5
 5482 0174 488D55A0 		leaq	-96(%rbp), %rdx
 5483 0178 488B8558 		movq	-168(%rbp), %rax
 5483      FFFFFF
 5484 017f 4889D6   		movq	%rdx, %rsi
 5485 0182 4889C7   		movq	%rax, %rdi
 5486 0185 FFD1     		call	*%rcx
 5487              	.LVL4:
3275:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3276:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1) || \
3277:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_1)
3278:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->minor_ver != MBEDTLS_SSL_MINOR_VERSION_3 )
3279:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3280:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         /*
3281:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * digitally-signed struct {
3282:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          *     opaque md5_hash[16];
3283:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          *     opaque sha_hash[20];
3284:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * };
3285:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          *
3286:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * md5_hash
3287:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          *     MD5(handshake_messages);
3288:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          *
3289:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * sha_hash
3290:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          *     SHA(handshake_messages);
GAS LISTING /tmp/cc8psT5X.s 			page 195


3291:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          */
3292:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         hashlen = 36;
3293:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         md_alg = MBEDTLS_MD_NONE;
3294:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3295:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         /*
3296:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * For ECDSA, default hash is SHA-1 only
3297:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          */
3298:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( mbedtls_pk_can_do( mbedtls_ssl_own_key( ssl ), MBEDTLS_PK_ECDSA ) )
3299:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
3300:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             hash_start += 16;
3301:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             hashlen -= 16;
3302:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             md_alg = MBEDTLS_MD_SHA1;
3303:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
3304:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3305:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     else
3306:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 || MBEDTLS_SSL_PROTO_TLS1 || \
3307:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           MBEDTLS_SSL_PROTO_TLS1_1 */
3308:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
3309:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_3 )
 5488              		.loc 3 3309 12
 5489 0187 488B8558 		movq	-168(%rbp), %rax
 5489      FFFFFF
 5490 018e 8B4018   		movl	24(%rax), %eax
 5491              		.loc 3 3309 7
 5492 0191 83F803   		cmpl	$3, %eax
 5493 0194 0F852801 		jne	.L319
 5493      0000
3310:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3311:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         /*
3312:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * digitally-signed struct {
3313:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          *     opaque handshake_messages[handshake_messages_length];
3314:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * };
3315:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          *
3316:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * Taking shortcut here. We assume that the server always allows the
3317:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * PRF Hash function and has sent it in the allowed signature
3318:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * algorithms list received in the Certificate Request message.
3319:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          *
3320:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * Until we encounter a server that does not, we will take this
3321:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * shortcut.
3322:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          *
3323:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          * Reason: Otherwise we should have running hashes for SHA512 and SHA224
3324:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          *         in order to satisfy 'weird' needs from the server side.
3325:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****          */
3326:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ssl->transform_negotiate->ciphersuite_info->mac ==
 5494              		.loc 3 3326 16
 5495 019a 488B8558 		movq	-168(%rbp), %rax
 5495      FFFFFF
 5496 01a1 488B8080 		movq	128(%rax), %rax
 5496      000000
 5497              		.loc 3 3326 37
 5498 01a8 488B00   		movq	(%rax), %rax
 5499              		.loc 3 3326 55
 5500 01ab 8B4014   		movl	20(%rax), %eax
 5501              		.loc 3 3326 11
 5502 01ae 83F807   		cmpl	$7, %eax
 5503 01b1 7521     		jne	.L320
3327:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             MBEDTLS_MD_SHA384 )
GAS LISTING /tmp/cc8psT5X.s 			page 196


3328:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
3329:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             md_alg = MBEDTLS_MD_SHA384;
 5504              		.loc 3 3329 20
 5505 01b3 C7856CFF 		movl	$7, -148(%rbp)
 5505      FFFF0700 
 5505      0000
3330:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ssl->out_msg[4] = MBEDTLS_SSL_HASH_SHA384;
 5506              		.loc 3 3330 16
 5507 01bd 488B8558 		movq	-168(%rbp), %rax
 5507      FFFFFF
 5508 01c4 488B8028 		movq	296(%rax), %rax
 5508      010000
 5509              		.loc 3 3330 25
 5510 01cb 4883C004 		addq	$4, %rax
 5511              		.loc 3 3330 29
 5512 01cf C60005   		movb	$5, (%rax)
 5513 01d2 EB1F     		jmp	.L321
 5514              	.L320:
3331:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
3332:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         else
3333:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         {
3334:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             md_alg = MBEDTLS_MD_SHA256;
 5515              		.loc 3 3334 20
 5516 01d4 C7856CFF 		movl	$6, -148(%rbp)
 5516      FFFF0600 
 5516      0000
3335:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ssl->out_msg[4] = MBEDTLS_SSL_HASH_SHA256;
 5517              		.loc 3 3335 16
 5518 01de 488B8558 		movq	-168(%rbp), %rax
 5518      FFFFFF
 5519 01e5 488B8028 		movq	296(%rax), %rax
 5519      010000
 5520              		.loc 3 3335 25
 5521 01ec 4883C004 		addq	$4, %rax
 5522              		.loc 3 3335 29
 5523 01f0 C60004   		movb	$4, (%rax)
 5524              	.L321:
3336:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         }
3337:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->out_msg[5] = mbedtls_ssl_sig_from_pk( mbedtls_ssl_own_key( ssl ) );
 5525              		.loc 3 3337 27
 5526 01f3 488B8558 		movq	-168(%rbp), %rax
 5526      FFFFFF
 5527 01fa 4889C7   		movq	%rax, %rdi
 5528 01fd E8000000 		call	mbedtls_ssl_own_key
 5528      00
 5529 0202 4889C2   		movq	%rax, %rdx
 5530              		.loc 3 3337 12
 5531 0205 488B8558 		movq	-168(%rbp), %rax
 5531      FFFFFF
 5532 020c 488B8028 		movq	296(%rax), %rax
 5532      010000
 5533              		.loc 3 3337 21
 5534 0213 488D5805 		leaq	5(%rax), %rbx
 5535              		.loc 3 3337 27
 5536 0217 4889D7   		movq	%rdx, %rdi
 5537 021a E8000000 		call	mbedtls_ssl_sig_from_pk@PLT
 5537      00
GAS LISTING /tmp/cc8psT5X.s 			page 197


 5538              		.loc 3 3337 25
 5539 021f 8803     		movb	%al, (%rbx)
3338:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3339:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         /* Info from md_alg will be used instead */
3340:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         hashlen = 0;
 5540              		.loc 3 3340 17
 5541 0221 C78574FF 		movl	$0, -140(%rbp)
 5541      FFFF0000 
 5541      0000
3341:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         offset = 2;
 5542              		.loc 3 3341 16
 5543 022b 48C74588 		movq	$2, -120(%rbp)
 5543      02000000 
3342:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3343:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     else
3344:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
3345:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3346:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
3347:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
3348:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3349:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3350:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL__ECP_RESTARTABLE)
3351:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->handshake->ecrs_enabled )
3352:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         rs_ctx = &ssl->handshake->ecrs_ctx.pk;
3353:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
3354:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3355:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( ret = mbedtls_pk_sign_restartable( mbedtls_ssl_own_key( ssl ),
3356:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                          md_alg, hash_start, hashlen,
3357:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                          ssl->out_msg + 6 + offset, &n,
3358:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                          ssl->conf->f_rng, ssl->conf->p_rng, rs_ctx ) ) != 0 )
 5544              		.loc 3 3358 47
 5545 0233 488B8558 		movq	-168(%rbp), %rax
 5545      FFFFFF
 5546 023a 488B00   		movq	(%rax), %rax
3355:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                          md_alg, hash_start, hashlen,
 5547              		.loc 3 3355 17
 5548 023d 4C8B6838 		movq	56(%rax), %r13
 5549              		.loc 3 3358 29
 5550 0241 488B8558 		movq	-168(%rbp), %rax
 5550      FFFFFF
 5551 0248 488B00   		movq	(%rax), %rax
3355:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                          md_alg, hash_start, hashlen,
 5552              		.loc 3 3355 17
 5553 024b 4C8B6030 		movq	48(%rax), %r12
3357:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                          ssl->conf->f_rng, ssl->conf->p_rng, rs_ctx ) ) != 0 )
 5554              		.loc 3 3357 29
 5555 024f 488B8558 		movq	-168(%rbp), %rax
 5555      FFFFFF
 5556 0256 488B8028 		movq	296(%rax), %rax
 5556      010000
3357:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                          ssl->conf->f_rng, ssl->conf->p_rng, rs_ctx ) ) != 0 )
 5557              		.loc 3 3357 43
 5558 025d 488B5588 		movq	-120(%rbp), %rdx
 5559 0261 4883C206 		addq	$6, %rdx
3355:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                          md_alg, hash_start, hashlen,
 5560              		.loc 3 3355 17
 5561 0265 4C8D3410 		leaq	(%rax,%rdx), %r14
GAS LISTING /tmp/cc8psT5X.s 			page 198


 5562 0269 8B9D74FF 		movl	-140(%rbp), %ebx
 5562      FFFF
 5563 026f 488B8558 		movq	-168(%rbp), %rax
 5563      FFFFFF
 5564 0276 4889C7   		movq	%rax, %rdi
 5565 0279 E8000000 		call	mbedtls_ssl_own_key
 5565      00
 5566 027e 4889C7   		movq	%rax, %rdi
 5567 0281 488D8D78 		leaq	-136(%rbp), %rcx
 5567      FFFFFF
 5568 0288 488B5590 		movq	-112(%rbp), %rdx
 5569 028c 8B856CFF 		movl	-148(%rbp), %eax
 5569      FFFF
 5570 0292 4883EC08 		subq	$8, %rsp
 5571 0296 FF7598   		pushq	-104(%rbp)
 5572 0299 4155     		pushq	%r13
 5573 029b 4154     		pushq	%r12
 5574 029d 4989C9   		movq	%rcx, %r9
 5575 02a0 4D89F0   		movq	%r14, %r8
 5576 02a3 4889D9   		movq	%rbx, %rcx
 5577 02a6 89C6     		movl	%eax, %esi
 5578 02a8 E8000000 		call	mbedtls_pk_sign_restartable@PLT
 5578      00
 5579 02ad 4883C420 		addq	$32, %rsp
 5580 02b1 898570FF 		movl	%eax, -144(%rbp)
 5580      FFFF
3355:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                          md_alg, hash_start, hashlen,
 5581              		.loc 3 3355 7
 5582 02b7 83BD70FF 		cmpl	$0, -144(%rbp)
 5582      FFFF00
 5583 02be 7417     		je	.L323
 5584 02c0 EB0A     		jmp	.L327
 5585              	.L319:
3347:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
 5586              		.loc 3 3347 15
 5587 02c2 B80094FF 		movl	$-27648, %eax
 5587      FF
 5588 02c7 E9DF0000 		jmp	.L325
 5588      00
 5589              	.L327:
3359:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3360:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_pk_sign", ret );
3361:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL__ECP_RESTARTABLE)
3362:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ret == MBEDTLS_ERR_ECP_IN_PROGRESS )
3363:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ret = MBEDTLS_ERR_SSL_CRYPTO_IN_PROGRESS;
3364:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
3365:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( ret );
 5590              		.loc 3 3365 15
 5591 02cc 8B8570FF 		movl	-144(%rbp), %eax
 5591      FFFF
 5592 02d2 E9D40000 		jmp	.L325
 5592      00
 5593              	.L323:
3366:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3367:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3368:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->out_msg[4 + offset] = (unsigned char)( n >> 8 );
 5594              		.loc 3 3368 51
GAS LISTING /tmp/cc8psT5X.s 			page 199


 5595 02d7 488B8578 		movq	-136(%rbp), %rax
 5595      FFFFFF
 5596 02de 48C1E808 		shrq	$8, %rax
 5597 02e2 4889C1   		movq	%rax, %rcx
 5598              		.loc 3 3368 8
 5599 02e5 488B8558 		movq	-168(%rbp), %rax
 5599      FFFFFF
 5600 02ec 488B8028 		movq	296(%rax), %rax
 5600      010000
 5601              		.loc 3 3368 20
 5602 02f3 488B5588 		movq	-120(%rbp), %rdx
 5603 02f7 4883C204 		addq	$4, %rdx
 5604              		.loc 3 3368 17
 5605 02fb 4801D0   		addq	%rdx, %rax
 5606              		.loc 3 3368 32
 5607 02fe 89CA     		movl	%ecx, %edx
 5608              		.loc 3 3368 30
 5609 0300 8810     		movb	%dl, (%rax)
3369:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->out_msg[5 + offset] = (unsigned char)( n      );
 5610              		.loc 3 3369 32
 5611 0302 488B8D78 		movq	-136(%rbp), %rcx
 5611      FFFFFF
 5612              		.loc 3 3369 8
 5613 0309 488B8558 		movq	-168(%rbp), %rax
 5613      FFFFFF
 5614 0310 488B8028 		movq	296(%rax), %rax
 5614      010000
 5615              		.loc 3 3369 20
 5616 0317 488B5588 		movq	-120(%rbp), %rdx
 5617 031b 4883C205 		addq	$5, %rdx
 5618              		.loc 3 3369 17
 5619 031f 4801D0   		addq	%rdx, %rax
 5620              		.loc 3 3369 32
 5621 0322 89CA     		movl	%ecx, %edx
 5622              		.loc 3 3369 30
 5623 0324 8810     		movb	%dl, (%rax)
3370:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3371:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->out_msglen  = 6 + n + offset;
 5624              		.loc 3 3371 30
 5625 0326 488B9578 		movq	-136(%rbp), %rdx
 5625      FFFFFF
 5626 032d 488B4588 		movq	-120(%rbp), %rax
 5627 0331 4801D0   		addq	%rdx, %rax
 5628 0334 488D5006 		leaq	6(%rax), %rdx
 5629              		.loc 3 3371 22
 5630 0338 488B8558 		movq	-168(%rbp), %rax
 5630      FFFFFF
 5631 033f 48899038 		movq	%rdx, 312(%rax)
 5631      010000
3372:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->out_msgtype = MBEDTLS_SSL_MSG_HANDSHAKE;
 5632              		.loc 3 3372 22
 5633 0346 488B8558 		movq	-168(%rbp), %rax
 5633      FFFFFF
 5634 034d C7803001 		movl	$22, 304(%rax)
 5634      00001600 
 5634      0000
3373:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->out_msg[0]  = MBEDTLS_SSL_HS_CERTIFICATE_VERIFY;
GAS LISTING /tmp/cc8psT5X.s 			page 200


 5635              		.loc 3 3373 8
 5636 0357 488B8558 		movq	-168(%rbp), %rax
 5636      FFFFFF
 5637 035e 488B8028 		movq	296(%rax), %rax
 5637      010000
 5638              		.loc 3 3373 22
 5639 0365 C6000F   		movb	$15, (%rax)
3374:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3375:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->state++;
 5640              		.loc 3 3375 8
 5641 0368 488B8558 		movq	-168(%rbp), %rax
 5641      FFFFFF
 5642 036f 8B4008   		movl	8(%rax), %eax
 5643              		.loc 3 3375 15
 5644 0372 8D5001   		leal	1(%rax), %edx
 5645 0375 488B8558 		movq	-168(%rbp), %rax
 5645      FFFFFF
 5646 037c 895008   		movl	%edx, 8(%rax)
3376:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3377:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( ret = mbedtls_ssl_write_handshake_msg( ssl ) ) != 0 )
 5647              		.loc 3 3377 17
 5648 037f 488B8558 		movq	-168(%rbp), %rax
 5648      FFFFFF
 5649 0386 4889C7   		movq	%rax, %rdi
 5650 0389 E8000000 		call	mbedtls_ssl_write_handshake_msg@PLT
 5650      00
 5651 038e 898570FF 		movl	%eax, -144(%rbp)
 5651      FFFF
 5652              		.loc 3 3377 7
 5653 0394 83BD70FF 		cmpl	$0, -144(%rbp)
 5653      FFFF00
 5654 039b 7408     		je	.L324
3378:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3379:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_write_handshake_msg", ret );
3380:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( ret );
 5655              		.loc 3 3380 15
 5656 039d 8B8570FF 		movl	-144(%rbp), %eax
 5656      FFFF
 5657 03a3 EB06     		jmp	.L325
 5658              	.L324:
3381:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3382:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3383:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= write certificate verify" ) );
3384:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3385:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( ret );
 5659              		.loc 3 3385 11
 5660 03a5 8B8570FF 		movl	-144(%rbp), %eax
 5660      FFFF
 5661              	.L325:
3386:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 5662              		.loc 3 3386 1 discriminator 1
 5663 03ab 488B75D8 		movq	-40(%rbp), %rsi
 5664 03af 64483334 		xorq	%fs:40, %rsi
 5664      25280000 
 5664      00
 5665 03b8 7405     		je	.L326
 5666              		.loc 3 3386 1 is_stmt 0
GAS LISTING /tmp/cc8psT5X.s 			page 201


 5667 03ba E8000000 		call	__stack_chk_fail@PLT
 5667      00
 5668              	.L326:
 5669 03bf 488D65E0 		leaq	-32(%rbp), %rsp
 5670 03c3 5B       		popq	%rbx
 5671 03c4 415C     		popq	%r12
 5672 03c6 415D     		popq	%r13
 5673 03c8 415E     		popq	%r14
 5674 03ca 5D       		popq	%rbp
 5675              	.LCFI92:
 5676              		.cfi_def_cfa 7, 8
 5677 03cb C3       		ret
 5678              		.cfi_endproc
 5679              	.LFE51:
 5681              		.section	.text.ssl_parse_new_session_ticket,"ax",@progbits
 5683              	ssl_parse_new_session_ticket:
 5684              	.LFB52:
3387:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* !MBEDTLS_KEY_EXCHANGE_RSA_ENABLED &&
3388:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           !MBEDTLS_KEY_EXCHANGE_DHE_RSA_ENABLED &&
3389:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           !MBEDTLS_KEY_EXCHANGE_ECDH_RSA_ENABLED &&
3390:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           !MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED &&
3391:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           !MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA_ENABLED &&
3392:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****           !MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED */
3393:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3394:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_SESSION_TICKETS)
3395:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** static int ssl_parse_new_session_ticket( mbedtls_ssl_context *ssl )
3396:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 5685              		.loc 3 3396 1 is_stmt 1
 5686              		.cfi_startproc
 5687 0000 F30F1EFA 		endbr64
 5688 0004 55       		pushq	%rbp
 5689              	.LCFI93:
 5690              		.cfi_def_cfa_offset 16
 5691              		.cfi_offset 6, -16
 5692 0005 4889E5   		movq	%rsp, %rbp
 5693              	.LCFI94:
 5694              		.cfi_def_cfa_register 6
 5695 0008 53       		pushq	%rbx
 5696 0009 4883EC48 		subq	$72, %rsp
 5697              		.cfi_offset 3, -24
 5698 000d 48897DB8 		movq	%rdi, -72(%rbp)
 5699              		.loc 3 3396 1
 5700 0011 64488B04 		movq	%fs:40, %rax
 5700      25280000 
 5700      00
 5701 001a 488945E8 		movq	%rax, -24(%rbp)
 5702 001e 31C0     		xorl	%eax, %eax
3397:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     int ret;
3398:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     uint32_t lifetime;
3399:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     size_t ticket_len;
3400:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     unsigned char *ticket;
3401:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     const unsigned char *msg;
3402:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3403:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> parse new session ticket" ) );
3404:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3405:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( ret = mbedtls_ssl_read_record( ssl, 1 ) ) != 0 )
 5703              		.loc 3 3405 17
GAS LISTING /tmp/cc8psT5X.s 			page 202


 5704 0020 488B45B8 		movq	-72(%rbp), %rax
 5705 0024 BE010000 		movl	$1, %esi
 5705      00
 5706 0029 4889C7   		movq	%rax, %rdi
 5707 002c E8000000 		call	mbedtls_ssl_read_record@PLT
 5707      00
 5708 0031 8945C8   		movl	%eax, -56(%rbp)
 5709              		.loc 3 3405 7
 5710 0034 837DC800 		cmpl	$0, -56(%rbp)
 5711 0038 7408     		je	.L329
3406:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3407:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_read_record", ret );
3408:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( ret );
 5712              		.loc 3 3408 15
 5713 003a 8B45C8   		movl	-56(%rbp), %eax
 5714 003d E9760200 		jmp	.L330
 5714      00
 5715              	.L329:
3409:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3410:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3411:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->in_msgtype != MBEDTLS_SSL_MSG_HANDSHAKE )
 5716              		.loc 3 3411 12
 5717 0042 488B45B8 		movq	-72(%rbp), %rax
 5718 0046 8B80D800 		movl	216(%rax), %eax
 5718      0000
 5719              		.loc 3 3411 7
 5720 004c 83F816   		cmpl	$22, %eax
 5721 004f 7420     		je	.L331
3412:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3413:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad new session ticket message" ) );
3414:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 5722              		.loc 3 3414 9
 5723 0051 488B45B8 		movq	-72(%rbp), %rax
 5724 0055 BA0A0000 		movl	$10, %edx
 5724      00
 5725 005a BE020000 		movl	$2, %esi
 5725      00
 5726 005f 4889C7   		movq	%rax, %rdi
 5727 0062 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 5727      00
3415:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_UNEXPECTED_MESSAGE );
3416:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
 5728              		.loc 3 3416 15
 5729 0067 B80089FF 		movl	$-30464, %eax
 5729      FF
 5730 006c E9470200 		jmp	.L330
 5730      00
 5731              	.L331:
3417:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3418:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3419:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
3420:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * struct {
3421:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     uint32 ticket_lifetime_hint;
3422:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *     opaque ticket<0..2^16-1>;
3423:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * } NewSessionTicket;
3424:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      *
3425:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * 0  .  3   ticket_lifetime_hint
GAS LISTING /tmp/cc8psT5X.s 			page 203


3426:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * 4  .  5   ticket_len (n)
3427:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * 6  .  5+n ticket content
3428:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
3429:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->in_msg[0] != MBEDTLS_SSL_HS_NEW_SESSION_TICKET ||
 5732              		.loc 3 3429 12
 5733 0071 488B45B8 		movq	-72(%rbp), %rax
 5734 0075 488B80C8 		movq	200(%rax), %rax
 5734      000000
 5735              		.loc 3 3429 20
 5736 007c 0FB600   		movzbl	(%rax), %eax
 5737              		.loc 3 3429 7
 5738 007f 3C04     		cmpb	$4, %al
 5739 0081 7520     		jne	.L332
3430:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->in_hslen < 6 + mbedtls_ssl_hs_hdr_len( ssl ) )
 5740              		.loc 3 3430 12 discriminator 1
 5741 0083 488B45B8 		movq	-72(%rbp), %rax
 5742 0087 488B98F0 		movq	240(%rax), %rbx
 5742      000000
 5743              		.loc 3 3430 29 discriminator 1
 5744 008e 488B45B8 		movq	-72(%rbp), %rax
 5745 0092 4889C7   		movq	%rax, %rdi
 5746 0095 E8000000 		call	mbedtls_ssl_hs_hdr_len
 5746      00
 5747              		.loc 3 3430 27 discriminator 1
 5748 009a 4883C006 		addq	$6, %rax
3429:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->in_hslen < 6 + mbedtls_ssl_hs_hdr_len( ssl ) )
 5749              		.loc 3 3429 61 discriminator 1
 5750 009e 4839C3   		cmpq	%rax, %rbx
 5751 00a1 7320     		jnb	.L333
 5752              	.L332:
3431:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3432:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad new session ticket message" ) );
3433:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 5753              		.loc 3 3433 9
 5754 00a3 488B45B8 		movq	-72(%rbp), %rax
 5755 00a7 BA320000 		movl	$50, %edx
 5755      00
 5756 00ac BE020000 		movl	$2, %esi
 5756      00
 5757 00b1 4889C7   		movq	%rax, %rdi
 5758 00b4 E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 5758      00
3434:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
3435:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_NEW_SESSION_TICKET );
 5759              		.loc 3 3435 15
 5760 00b9 B80092FF 		movl	$-28160, %eax
 5760      FF
 5761 00be E9F50100 		jmp	.L330
 5761      00
 5762              	.L333:
3436:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3437:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3438:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     msg = ssl->in_msg + mbedtls_ssl_hs_hdr_len( ssl );
 5763              		.loc 3 3438 14
 5764 00c3 488B45B8 		movq	-72(%rbp), %rax
 5765 00c7 488B98C8 		movq	200(%rax), %rbx
 5765      000000
GAS LISTING /tmp/cc8psT5X.s 			page 204


 5766              		.loc 3 3438 25
 5767 00ce 488B45B8 		movq	-72(%rbp), %rax
 5768 00d2 4889C7   		movq	%rax, %rdi
 5769 00d5 E8000000 		call	mbedtls_ssl_hs_hdr_len
 5769      00
 5770              		.loc 3 3438 9
 5771 00da 4801D8   		addq	%rbx, %rax
 5772 00dd 488945D0 		movq	%rax, -48(%rbp)
3439:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3440:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     lifetime = ( ((uint32_t) msg[0]) << 24 ) | ( msg[1] << 16 ) |
 5773              		.loc 3 3440 33
 5774 00e1 488B45D0 		movq	-48(%rbp), %rax
 5775 00e5 0FB600   		movzbl	(%rax), %eax
 5776              		.loc 3 3440 19
 5777 00e8 0FB6C0   		movzbl	%al, %eax
 5778              		.loc 3 3440 38
 5779 00eb C1E018   		sall	$24, %eax
 5780 00ee 89C2     		movl	%eax, %edx
 5781              		.loc 3 3440 53
 5782 00f0 488B45D0 		movq	-48(%rbp), %rax
 5783 00f4 4883C001 		addq	$1, %rax
 5784 00f8 0FB600   		movzbl	(%rax), %eax
 5785 00fb 0FB6C0   		movzbl	%al, %eax
 5786              		.loc 3 3440 57
 5787 00fe C1E010   		sall	$16, %eax
 5788              		.loc 3 3440 46
 5789 0101 09C2     		orl	%eax, %edx
3441:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                ( msg[2] << 8 ) | ( msg[3] );
 5790              		.loc 3 3441 21
 5791 0103 488B45D0 		movq	-48(%rbp), %rax
 5792 0107 4883C002 		addq	$2, %rax
 5793 010b 0FB600   		movzbl	(%rax), %eax
 5794 010e 0FB6C0   		movzbl	%al, %eax
 5795              		.loc 3 3441 25
 5796 0111 C1E008   		sall	$8, %eax
3440:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                ( msg[2] << 8 ) | ( msg[3] );
 5797              		.loc 3 3440 65
 5798 0114 09C2     		orl	%eax, %edx
 5799              		.loc 3 3441 39
 5800 0116 488B45D0 		movq	-48(%rbp), %rax
 5801 011a 4883C003 		addq	$3, %rax
 5802 011e 0FB600   		movzbl	(%rax), %eax
 5803 0121 0FB6C0   		movzbl	%al, %eax
3440:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                ( msg[2] << 8 ) | ( msg[3] );
 5804              		.loc 3 3440 14
 5805 0124 09D0     		orl	%edx, %eax
 5806 0126 8945CC   		movl	%eax, -52(%rbp)
3442:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3443:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ticket_len = ( msg[4] << 8 ) | ( msg[5] );
 5807              		.loc 3 3443 23
 5808 0129 488B45D0 		movq	-48(%rbp), %rax
 5809 012d 4883C004 		addq	$4, %rax
 5810 0131 0FB600   		movzbl	(%rax), %eax
 5811 0134 0FB6C0   		movzbl	%al, %eax
 5812              		.loc 3 3443 27
 5813 0137 C1E008   		sall	$8, %eax
 5814 013a 89C2     		movl	%eax, %edx
GAS LISTING /tmp/cc8psT5X.s 			page 205


 5815              		.loc 3 3443 41
 5816 013c 488B45D0 		movq	-48(%rbp), %rax
 5817 0140 4883C005 		addq	$5, %rax
 5818 0144 0FB600   		movzbl	(%rax), %eax
 5819 0147 0FB6C0   		movzbl	%al, %eax
 5820              		.loc 3 3443 34
 5821 014a 09D0     		orl	%edx, %eax
 5822              		.loc 3 3443 16
 5823 014c 4898     		cltq
 5824 014e 488945D8 		movq	%rax, -40(%rbp)
3444:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3445:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ticket_len + 6 + mbedtls_ssl_hs_hdr_len( ssl ) != ssl->in_hslen )
 5825              		.loc 3 3445 26
 5826 0152 488B45B8 		movq	-72(%rbp), %rax
 5827 0156 4889C7   		movq	%rax, %rdi
 5828 0159 E8000000 		call	mbedtls_ssl_hs_hdr_len
 5828      00
 5829              		.loc 3 3445 24
 5830 015e 488B55D8 		movq	-40(%rbp), %rdx
 5831 0162 4801D0   		addq	%rdx, %rax
 5832 0165 488D5006 		leaq	6(%rax), %rdx
 5833              		.loc 3 3445 62
 5834 0169 488B45B8 		movq	-72(%rbp), %rax
 5835 016d 488B80F0 		movq	240(%rax), %rax
 5835      000000
 5836              		.loc 3 3445 7
 5837 0174 4839C2   		cmpq	%rax, %rdx
 5838 0177 7420     		je	.L334
3446:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3447:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad new session ticket message" ) );
3448:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 5839              		.loc 3 3448 9
 5840 0179 488B45B8 		movq	-72(%rbp), %rax
 5841 017d BA320000 		movl	$50, %edx
 5841      00
 5842 0182 BE020000 		movl	$2, %esi
 5842      00
 5843 0187 4889C7   		movq	%rax, %rdi
 5844 018a E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 5844      00
3449:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
3450:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_NEW_SESSION_TICKET );
 5845              		.loc 3 3450 15
 5846 018f B80092FF 		movl	$-28160, %eax
 5846      FF
 5847 0194 E91F0100 		jmp	.L330
 5847      00
 5848              	.L334:
3451:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3452:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3453:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "ticket length: %d", ticket_len ) );
3454:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3455:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /* We're not waiting for a NewSessionTicket message any more */
3456:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->handshake->new_session_ticket = 0;
 5849              		.loc 3 3456 8
 5850 0199 488B45B8 		movq	-72(%rbp), %rax
 5851 019d 488B4060 		movq	96(%rax), %rax
GAS LISTING /tmp/cc8psT5X.s 			page 206


 5852              		.loc 3 3456 40
 5853 01a1 C780AC03 		movl	$0, 940(%rax)
 5853      00000000 
 5853      0000
3457:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->state = MBEDTLS_SSL_SERVER_CHANGE_CIPHER_SPEC;
 5854              		.loc 3 3457 16
 5855 01ab 488B45B8 		movq	-72(%rbp), %rax
 5856 01af C740080C 		movl	$12, 8(%rax)
 5856      000000
3458:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3459:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
3460:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * Zero-length ticket means the server changed his mind and doesn't want
3461:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * to send a ticket after all, so just forget it
3462:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
3463:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ticket_len == 0 )
 5857              		.loc 3 3463 7
 5858 01b6 48837DD8 		cmpq	$0, -40(%rbp)
 5858      00
 5859 01bb 750A     		jne	.L335
3464:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( 0 );
 5860              		.loc 3 3464 15
 5861 01bd B8000000 		movl	$0, %eax
 5861      00
 5862 01c2 E9F10000 		jmp	.L330
 5862      00
 5863              	.L335:
3465:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3466:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     mbedtls_platform_zeroize( ssl->session_negotiate->ticket,
3467:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                               ssl->session_negotiate->ticket_len );
 5864              		.loc 3 3467 34
 5865 01c7 488B45B8 		movq	-72(%rbp), %rax
 5866 01cb 488B4058 		movq	88(%rax), %rax
3466:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                               ssl->session_negotiate->ticket_len );
 5867              		.loc 3 3466 5
 5868 01cf 488B5078 		movq	120(%rax), %rdx
3466:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                               ssl->session_negotiate->ticket_len );
 5869              		.loc 3 3466 34
 5870 01d3 488B45B8 		movq	-72(%rbp), %rax
 5871 01d7 488B4058 		movq	88(%rax), %rax
3466:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                               ssl->session_negotiate->ticket_len );
 5872              		.loc 3 3466 53
 5873 01db 488B4070 		movq	112(%rax), %rax
3466:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                               ssl->session_negotiate->ticket_len );
 5874              		.loc 3 3466 5
 5875 01df 4889D6   		movq	%rdx, %rsi
 5876 01e2 4889C7   		movq	%rax, %rdi
 5877 01e5 E8000000 		call	mbedtls_platform_zeroize@PLT
 5877      00
3468:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     mbedtls_free( ssl->session_negotiate->ticket );
 5878              		.loc 3 3468 22
 5879 01ea 488B45B8 		movq	-72(%rbp), %rax
 5880 01ee 488B4058 		movq	88(%rax), %rax
 5881              		.loc 3 3468 41
 5882 01f2 488B4070 		movq	112(%rax), %rax
 5883              		.loc 3 3468 5
 5884 01f6 4889C7   		movq	%rax, %rdi
 5885 01f9 E8000000 		call	mbedtls_free@PLT
GAS LISTING /tmp/cc8psT5X.s 			page 207


 5885      00
3469:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->session_negotiate->ticket = NULL;
 5886              		.loc 3 3469 8
 5887 01fe 488B45B8 		movq	-72(%rbp), %rax
 5888 0202 488B4058 		movq	88(%rax), %rax
 5889              		.loc 3 3469 36
 5890 0206 48C74070 		movq	$0, 112(%rax)
 5890      00000000 
3470:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->session_negotiate->ticket_len = 0;
 5891              		.loc 3 3470 8
 5892 020e 488B45B8 		movq	-72(%rbp), %rax
 5893 0212 488B4058 		movq	88(%rax), %rax
 5894              		.loc 3 3470 40
 5895 0216 48C74078 		movq	$0, 120(%rax)
 5895      00000000 
3471:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3472:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( ticket = mbedtls_calloc( 1, ticket_len ) ) == NULL )
 5896              		.loc 3 3472 20
 5897 021e 488B45D8 		movq	-40(%rbp), %rax
 5898 0222 4889C6   		movq	%rax, %rsi
 5899 0225 BF010000 		movl	$1, %edi
 5899      00
 5900 022a E8000000 		call	mbedtls_calloc@PLT
 5900      00
 5901 022f 488945E0 		movq	%rax, -32(%rbp)
 5902              		.loc 3 3472 7
 5903 0233 48837DE0 		cmpq	$0, -32(%rbp)
 5903      00
 5904 0238 751D     		jne	.L336
3473:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3474:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "ticket alloc failed" ) );
3475:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 5905              		.loc 3 3475 9
 5906 023a 488B45B8 		movq	-72(%rbp), %rax
 5907 023e BA500000 		movl	$80, %edx
 5907      00
 5908 0243 BE020000 		movl	$2, %esi
 5908      00
 5909 0248 4889C7   		movq	%rax, %rdi
 5910 024b E8000000 		call	mbedtls_ssl_send_alert_message@PLT
 5910      00
3476:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****                                         MBEDTLS_SSL_ALERT_MSG_INTERNAL_ERROR );
3477:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
 5911              		.loc 3 3477 15
 5912 0250 B80081FF 		movl	$-32512, %eax
 5912      FF
 5913 0255 EB61     		jmp	.L330
 5914              	.L336:
3478:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3479:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3480:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     memcpy( ticket, msg + 6, ticket_len );
 5915              		.loc 3 3480 25
 5916 0257 488B45D0 		movq	-48(%rbp), %rax
 5917 025b 488D4806 		leaq	6(%rax), %rcx
 5918              		.loc 3 3480 5
 5919 025f 488B55D8 		movq	-40(%rbp), %rdx
 5920 0263 488B45E0 		movq	-32(%rbp), %rax
GAS LISTING /tmp/cc8psT5X.s 			page 208


 5921 0267 4889CE   		movq	%rcx, %rsi
 5922 026a 4889C7   		movq	%rax, %rdi
 5923 026d E8000000 		call	memcpy@PLT
 5923      00
3481:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3482:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->session_negotiate->ticket = ticket;
 5924              		.loc 3 3482 8
 5925 0272 488B45B8 		movq	-72(%rbp), %rax
 5926 0276 488B4058 		movq	88(%rax), %rax
 5927              		.loc 3 3482 36
 5928 027a 488B55E0 		movq	-32(%rbp), %rdx
 5929 027e 48895070 		movq	%rdx, 112(%rax)
3483:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->session_negotiate->ticket_len = ticket_len;
 5930              		.loc 3 3483 8
 5931 0282 488B45B8 		movq	-72(%rbp), %rax
 5932 0286 488B4058 		movq	88(%rax), %rax
 5933              		.loc 3 3483 40
 5934 028a 488B55D8 		movq	-40(%rbp), %rdx
 5935 028e 48895078 		movq	%rdx, 120(%rax)
3484:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->session_negotiate->ticket_lifetime = lifetime;
 5936              		.loc 3 3484 8
 5937 0292 488B45B8 		movq	-72(%rbp), %rax
 5938 0296 488B4058 		movq	88(%rax), %rax
 5939              		.loc 3 3484 45
 5940 029a 8B55CC   		movl	-52(%rbp), %edx
 5941 029d 89908000 		movl	%edx, 128(%rax)
 5941      0000
3485:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3486:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /*
3487:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * RFC 5077 section 3.4:
3488:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * "If the client receives a session ticket from the server, then it
3489:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * discards any Session ID that was sent in the ServerHello."
3490:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      */
3491:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "ticket in use, discarding session id" ) );
3492:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     ssl->session_negotiate->id_len = 0;
 5942              		.loc 3 3492 8
 5943 02a3 488B45B8 		movq	-72(%rbp), %rax
 5944 02a7 488B4058 		movq	88(%rax), %rax
 5945              		.loc 3 3492 36
 5946 02ab 48C74008 		movq	$0, 8(%rax)
 5946      00000000 
3493:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3494:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= parse new session ticket" ) );
3495:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3496:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( 0 );
 5947              		.loc 3 3496 11
 5948 02b3 B8000000 		movl	$0, %eax
 5948      00
 5949              	.L330:
3497:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 5950              		.loc 3 3497 1
 5951 02b8 488B4DE8 		movq	-24(%rbp), %rcx
 5952 02bc 6448330C 		xorq	%fs:40, %rcx
 5952      25280000 
 5952      00
 5953 02c5 7405     		je	.L337
 5954 02c7 E8000000 		call	__stack_chk_fail@PLT
GAS LISTING /tmp/cc8psT5X.s 			page 209


 5954      00
 5955              	.L337:
 5956 02cc 4883C448 		addq	$72, %rsp
 5957 02d0 5B       		popq	%rbx
 5958 02d1 5D       		popq	%rbp
 5959              	.LCFI95:
 5960              		.cfi_def_cfa 7, 8
 5961 02d2 C3       		ret
 5962              		.cfi_endproc
 5963              	.LFE52:
 5965              		.section	.text.mbedtls_ssl_handshake_client_step,"ax",@progbits
 5966              		.globl	mbedtls_ssl_handshake_client_step
 5968              	mbedtls_ssl_handshake_client_step:
 5969              	.LFB53:
3498:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_SESSION_TICKETS */
3499:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3500:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** /*
3501:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  * SSL handshake -- client side -- single step
3502:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****  */
3503:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** int mbedtls_ssl_handshake_client_step( mbedtls_ssl_context *ssl )
3504:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** {
 5970              		.loc 3 3504 1
 5971              		.cfi_startproc
 5972 0000 F30F1EFA 		endbr64
 5973 0004 55       		pushq	%rbp
 5974              	.LCFI96:
 5975              		.cfi_def_cfa_offset 16
 5976              		.cfi_offset 6, -16
 5977 0005 4889E5   		movq	%rsp, %rbp
 5978              	.LCFI97:
 5979              		.cfi_def_cfa_register 6
 5980 0008 4883EC20 		subq	$32, %rsp
 5981 000c 48897DE8 		movq	%rdi, -24(%rbp)
 5982              		.loc 3 3504 1
 5983 0010 64488B04 		movq	%fs:40, %rax
 5983      25280000 
 5983      00
 5984 0019 488945F8 		movq	%rax, -8(%rbp)
 5985 001d 31C0     		xorl	%eax, %eax
3505:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     int ret = 0;
 5986              		.loc 3 3505 9
 5987 001f C745F400 		movl	$0, -12(%rbp)
 5987      000000
3506:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3507:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->state == MBEDTLS_SSL_HANDSHAKE_OVER || ssl->handshake == NULL )
 5988              		.loc 3 3507 12
 5989 0026 488B45E8 		movq	-24(%rbp), %rax
 5990 002a 8B4008   		movl	8(%rax), %eax
 5991              		.loc 3 3507 7
 5992 002d 83F810   		cmpl	$16, %eax
 5993 0030 740D     		je	.L339
 5994              		.loc 3 3507 56 discriminator 1
 5995 0032 488B45E8 		movq	-24(%rbp), %rax
 5996 0036 488B4060 		movq	96(%rax), %rax
 5997              		.loc 3 3507 50 discriminator 1
 5998 003a 4885C0   		testq	%rax, %rax
 5999 003d 750A     		jne	.L340
GAS LISTING /tmp/cc8psT5X.s 			page 210


 6000              	.L339:
3508:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 6001              		.loc 3 3508 15
 6002 003f B8008FFF 		movl	$-28928, %eax
 6002      FF
 6003 0044 E9B40100 		jmp	.L341
 6003      00
 6004              	.L340:
3509:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3510:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "client state: %d", ssl->state ) );
3511:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3512:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ( ret = mbedtls_ssl_flush_output( ssl ) ) != 0 )
 6005              		.loc 3 3512 17
 6006 0049 488B45E8 		movq	-24(%rbp), %rax
 6007 004d 4889C7   		movq	%rax, %rdi
 6008 0050 E8000000 		call	mbedtls_ssl_flush_output@PLT
 6008      00
 6009 0055 8945F4   		movl	%eax, -12(%rbp)
 6010              		.loc 3 3512 7
 6011 0058 837DF400 		cmpl	$0, -12(%rbp)
 6012 005c 7408     		je	.L342
3513:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         return( ret );
 6013              		.loc 3 3513 15
 6014 005e 8B45F4   		movl	-12(%rbp), %eax
 6015 0061 E9970100 		jmp	.L341
 6015      00
 6016              	.L342:
3514:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3515:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
3516:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
3517:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->handshake->retransmit_state == MBEDTLS_SSL_RETRANS_SENDING )
3518:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3519:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         if( ( ret = mbedtls_ssl_flight_transmit( ssl ) ) != 0 )
3520:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             return( ret );
3521:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3522:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
3523:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3524:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     /* Change state now, so that it is right in mbedtls_ssl_read_record(), used
3525:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****      * by DTLS for dropping out-of-sequence ChangeCipherSpec records */
3526:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_SESSION_TICKETS)
3527:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     if( ssl->state == MBEDTLS_SSL_SERVER_CHANGE_CIPHER_SPEC &&
 6017              		.loc 3 3527 12
 6018 0066 488B45E8 		movq	-24(%rbp), %rax
 6019 006a 8B4008   		movl	8(%rax), %eax
 6020              		.loc 3 3527 7
 6021 006d 83F80C   		cmpl	$12, %eax
 6022 0070 751D     		jne	.L343
3528:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->handshake->new_session_ticket != 0 )
 6023              		.loc 3 3528 12 discriminator 1
 6024 0072 488B45E8 		movq	-24(%rbp), %rax
 6025 0076 488B4060 		movq	96(%rax), %rax
 6026              		.loc 3 3528 23 discriminator 1
 6027 007a 8B80AC03 		movl	940(%rax), %eax
 6027      0000
3527:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->handshake->new_session_ticket != 0 )
 6028              		.loc 3 3527 61 discriminator 1
 6029 0080 85C0     		testl	%eax, %eax
GAS LISTING /tmp/cc8psT5X.s 			page 211


 6030 0082 740B     		je	.L343
3529:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3530:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         ssl->state = MBEDTLS_SSL_SERVER_NEW_SESSION_TICKET;
 6031              		.loc 3 3530 20
 6032 0084 488B45E8 		movq	-24(%rbp), %rax
 6033 0088 C7400811 		movl	$17, 8(%rax)
 6033      000000
 6034              	.L343:
3531:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     }
3532:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
3533:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3534:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     switch( ssl->state )
 6035              		.loc 3 3534 16
 6036 008f 488B45E8 		movq	-24(%rbp), %rax
 6037 0093 8B4008   		movl	8(%rax), %eax
 6038 0096 83F811   		cmpl	$17, %eax
 6039 0099 0F875401 		ja	.L344
 6039      0000
 6040 009f 89C0     		movl	%eax, %eax
 6041 00a1 488D1485 		leaq	0(,%rax,4), %rdx
 6041      00000000 
 6042 00a9 488D0500 		leaq	.L346(%rip), %rax
 6042      000000
 6043 00b0 8B0402   		movl	(%rdx,%rax), %eax
 6044 00b3 4898     		cltq
 6045 00b5 488D1500 		leaq	.L346(%rip), %rdx
 6045      000000
 6046 00bc 4801D0   		addq	%rdx, %rax
 6047 00bf 3EFFE0   		notrack jmp	*%rax
 6048              		.section	.rodata.mbedtls_ssl_handshake_client_step,"a",@progbits
 6049              		.align 4
 6050              		.align 4
 6051              	.L346:
 6052 0000 00000000 		.long	.L362-.L346
 6053 0004 00000000 		.long	.L361-.L346
 6054 0008 00000000 		.long	.L360-.L346
 6055 000c 00000000 		.long	.L359-.L346
 6056 0010 00000000 		.long	.L358-.L346
 6057 0014 00000000 		.long	.L357-.L346
 6058 0018 00000000 		.long	.L356-.L346
 6059 001c 00000000 		.long	.L355-.L346
 6060 0020 00000000 		.long	.L354-.L346
 6061 0024 00000000 		.long	.L353-.L346
 6062 0028 00000000 		.long	.L352-.L346
 6063 002c 00000000 		.long	.L351-.L346
 6064 0030 00000000 		.long	.L350-.L346
 6065 0034 00000000 		.long	.L349-.L346
 6066 0038 00000000 		.long	.L348-.L346
 6067 003c 00000000 		.long	.L347-.L346
 6068 0040 00000000 		.long	.L344-.L346
 6069 0044 00000000 		.long	.L345-.L346
 6070              		.section	.text.mbedtls_ssl_handshake_client_step
 6071              	.L362:
3535:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     {
3536:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         case MBEDTLS_SSL_HELLO_REQUEST:
3537:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             ssl->state = MBEDTLS_SSL_CLIENT_HELLO;
 6072              		.loc 3 3537 24
GAS LISTING /tmp/cc8psT5X.s 			page 212


 6073 00c2 488B45E8 		movq	-24(%rbp), %rax
 6074 00c6 C7400801 		movl	$1, 8(%rax)
 6074      000000
3538:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****             break;
 6075              		.loc 3 3538 13
 6076 00cd E9280100 		jmp	.L363
 6076      00
 6077              	.L361:
3539:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3540:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****        /*
3541:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *  ==>   ClientHello
3542:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         */
3543:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****        case MBEDTLS_SSL_CLIENT_HELLO:
3544:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            ret = ssl_write_client_hello( ssl );
 6078              		.loc 3 3544 18
 6079 00d2 488B45E8 		movq	-24(%rbp), %rax
 6080 00d6 4889C7   		movq	%rax, %rdi
 6081 00d9 E8000000 		call	ssl_write_client_hello
 6081      00
 6082 00de 8945F4   		movl	%eax, -12(%rbp)
3545:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            break;
 6083              		.loc 3 3545 12
 6084 00e1 E9140100 		jmp	.L363
 6084      00
 6085              	.L360:
3546:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3547:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****        /*
3548:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *  <==   ServerHello
3549:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *        Certificate
3550:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *      ( ServerKeyExchange  )
3551:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *      ( CertificateRequest )
3552:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *        ServerHelloDone
3553:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         */
3554:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****        case MBEDTLS_SSL_SERVER_HELLO:
3555:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            ret = ssl_parse_server_hello( ssl );
 6086              		.loc 3 3555 18
 6087 00e6 488B45E8 		movq	-24(%rbp), %rax
 6088 00ea 4889C7   		movq	%rax, %rdi
 6089 00ed E8000000 		call	ssl_parse_server_hello
 6089      00
 6090 00f2 8945F4   		movl	%eax, -12(%rbp)
3556:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            break;
 6091              		.loc 3 3556 12
 6092 00f5 E9000100 		jmp	.L363
 6092      00
 6093              	.L359:
3557:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3558:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****        case MBEDTLS_SSL_SERVER_CERTIFICATE:
3559:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            ret = mbedtls_ssl_parse_certificate( ssl );
 6094              		.loc 3 3559 18
 6095 00fa 488B45E8 		movq	-24(%rbp), %rax
 6096 00fe 4889C7   		movq	%rax, %rdi
 6097 0101 E8000000 		call	mbedtls_ssl_parse_certificate@PLT
 6097      00
 6098 0106 8945F4   		movl	%eax, -12(%rbp)
3560:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            break;
 6099              		.loc 3 3560 12
GAS LISTING /tmp/cc8psT5X.s 			page 213


 6100 0109 E9EC0000 		jmp	.L363
 6100      00
 6101              	.L358:
3561:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3562:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****        case MBEDTLS_SSL_SERVER_KEY_EXCHANGE:
3563:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            ret = ssl_parse_server_key_exchange( ssl );
 6102              		.loc 3 3563 18
 6103 010e 488B45E8 		movq	-24(%rbp), %rax
 6104 0112 4889C7   		movq	%rax, %rdi
 6105 0115 E8000000 		call	ssl_parse_server_key_exchange
 6105      00
 6106 011a 8945F4   		movl	%eax, -12(%rbp)
3564:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            break;
 6107              		.loc 3 3564 12
 6108 011d E9D80000 		jmp	.L363
 6108      00
 6109              	.L357:
3565:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3566:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****        case MBEDTLS_SSL_CERTIFICATE_REQUEST:
3567:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            ret = ssl_parse_certificate_request( ssl );
 6110              		.loc 3 3567 18
 6111 0122 488B45E8 		movq	-24(%rbp), %rax
 6112 0126 4889C7   		movq	%rax, %rdi
 6113 0129 E8000000 		call	ssl_parse_certificate_request
 6113      00
 6114 012e 8945F4   		movl	%eax, -12(%rbp)
3568:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            break;
 6115              		.loc 3 3568 12
 6116 0131 E9C40000 		jmp	.L363
 6116      00
 6117              	.L356:
3569:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3570:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****        case MBEDTLS_SSL_SERVER_HELLO_DONE:
3571:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            ret = ssl_parse_server_hello_done( ssl );
 6118              		.loc 3 3571 18
 6119 0136 488B45E8 		movq	-24(%rbp), %rax
 6120 013a 4889C7   		movq	%rax, %rdi
 6121 013d E8000000 		call	ssl_parse_server_hello_done
 6121      00
 6122 0142 8945F4   		movl	%eax, -12(%rbp)
3572:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            break;
 6123              		.loc 3 3572 12
 6124 0145 E9B00000 		jmp	.L363
 6124      00
 6125              	.L355:
3573:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3574:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****        /*
3575:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *  ==> ( Certificate/Alert  )
3576:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *        ClientKeyExchange
3577:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *      ( CertificateVerify  )
3578:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *        ChangeCipherSpec
3579:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *        Finished
3580:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         */
3581:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****        case MBEDTLS_SSL_CLIENT_CERTIFICATE:
3582:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            ret = mbedtls_ssl_write_certificate( ssl );
 6126              		.loc 3 3582 18
 6127 014a 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/cc8psT5X.s 			page 214


 6128 014e 4889C7   		movq	%rax, %rdi
 6129 0151 E8000000 		call	mbedtls_ssl_write_certificate@PLT
 6129      00
 6130 0156 8945F4   		movl	%eax, -12(%rbp)
3583:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            break;
 6131              		.loc 3 3583 12
 6132 0159 E99C0000 		jmp	.L363
 6132      00
 6133              	.L354:
3584:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3585:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****        case MBEDTLS_SSL_CLIENT_KEY_EXCHANGE:
3586:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            ret = ssl_write_client_key_exchange( ssl );
 6134              		.loc 3 3586 18
 6135 015e 488B45E8 		movq	-24(%rbp), %rax
 6136 0162 4889C7   		movq	%rax, %rdi
 6137 0165 E8000000 		call	ssl_write_client_key_exchange
 6137      00
 6138 016a 8945F4   		movl	%eax, -12(%rbp)
3587:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            break;
 6139              		.loc 3 3587 12
 6140 016d E9880000 		jmp	.L363
 6140      00
 6141              	.L353:
3588:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3589:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****        case MBEDTLS_SSL_CERTIFICATE_VERIFY:
3590:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            ret = ssl_write_certificate_verify( ssl );
 6142              		.loc 3 3590 18
 6143 0172 488B45E8 		movq	-24(%rbp), %rax
 6144 0176 4889C7   		movq	%rax, %rdi
 6145 0179 E8000000 		call	ssl_write_certificate_verify
 6145      00
 6146 017e 8945F4   		movl	%eax, -12(%rbp)
3591:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            break;
 6147              		.loc 3 3591 12
 6148 0181 EB77     		jmp	.L363
 6149              	.L352:
3592:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3593:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****        case MBEDTLS_SSL_CLIENT_CHANGE_CIPHER_SPEC:
3594:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            ret = mbedtls_ssl_write_change_cipher_spec( ssl );
 6150              		.loc 3 3594 18
 6151 0183 488B45E8 		movq	-24(%rbp), %rax
 6152 0187 4889C7   		movq	%rax, %rdi
 6153 018a E8000000 		call	mbedtls_ssl_write_change_cipher_spec@PLT
 6153      00
 6154 018f 8945F4   		movl	%eax, -12(%rbp)
3595:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            break;
 6155              		.loc 3 3595 12
 6156 0192 EB66     		jmp	.L363
 6157              	.L351:
3596:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3597:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****        case MBEDTLS_SSL_CLIENT_FINISHED:
3598:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            ret = mbedtls_ssl_write_finished( ssl );
 6158              		.loc 3 3598 18
 6159 0194 488B45E8 		movq	-24(%rbp), %rax
 6160 0198 4889C7   		movq	%rax, %rdi
 6161 019b E8000000 		call	mbedtls_ssl_write_finished@PLT
 6161      00
GAS LISTING /tmp/cc8psT5X.s 			page 215


 6162 01a0 8945F4   		movl	%eax, -12(%rbp)
3599:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            break;
 6163              		.loc 3 3599 12
 6164 01a3 EB55     		jmp	.L363
 6165              	.L345:
3600:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3601:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****        /*
3602:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *  <==   ( NewSessionTicket )
3603:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *        ChangeCipherSpec
3604:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         *        Finished
3605:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****         */
3606:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #if defined(MBEDTLS_SSL_SESSION_TICKETS)
3607:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****        case MBEDTLS_SSL_SERVER_NEW_SESSION_TICKET:
3608:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            ret = ssl_parse_new_session_ticket( ssl );
 6166              		.loc 3 3608 18
 6167 01a5 488B45E8 		movq	-24(%rbp), %rax
 6168 01a9 4889C7   		movq	%rax, %rdi
 6169 01ac E8000000 		call	ssl_parse_new_session_ticket
 6169      00
 6170 01b1 8945F4   		movl	%eax, -12(%rbp)
3609:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            break;
 6171              		.loc 3 3609 12
 6172 01b4 EB44     		jmp	.L363
 6173              	.L350:
3610:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** #endif
3611:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3612:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****        case MBEDTLS_SSL_SERVER_CHANGE_CIPHER_SPEC:
3613:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            ret = mbedtls_ssl_parse_change_cipher_spec( ssl );
 6174              		.loc 3 3613 18
 6175 01b6 488B45E8 		movq	-24(%rbp), %rax
 6176 01ba 4889C7   		movq	%rax, %rdi
 6177 01bd E8000000 		call	mbedtls_ssl_parse_change_cipher_spec@PLT
 6177      00
 6178 01c2 8945F4   		movl	%eax, -12(%rbp)
3614:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            break;
 6179              		.loc 3 3614 12
 6180 01c5 EB33     		jmp	.L363
 6181              	.L349:
3615:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3616:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****        case MBEDTLS_SSL_SERVER_FINISHED:
3617:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            ret = mbedtls_ssl_parse_finished( ssl );
 6182              		.loc 3 3617 18
 6183 01c7 488B45E8 		movq	-24(%rbp), %rax
 6184 01cb 4889C7   		movq	%rax, %rdi
 6185 01ce E8000000 		call	mbedtls_ssl_parse_finished@PLT
 6185      00
 6186 01d3 8945F4   		movl	%eax, -12(%rbp)
3618:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            break;
 6187              		.loc 3 3618 12
 6188 01d6 EB22     		jmp	.L363
 6189              	.L348:
3619:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3620:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****        case MBEDTLS_SSL_FLUSH_BUFFERS:
3621:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            MBEDTLS_SSL_DEBUG_MSG( 2, ( "handshake: done" ) );
3622:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            ssl->state = MBEDTLS_SSL_HANDSHAKE_WRAPUP;
 6190              		.loc 3 3622 23
 6191 01d8 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/cc8psT5X.s 			page 216


 6192 01dc C740080F 		movl	$15, 8(%rax)
 6192      000000
3623:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            break;
 6193              		.loc 3 3623 12
 6194 01e3 EB15     		jmp	.L363
 6195              	.L347:
3624:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3625:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****        case MBEDTLS_SSL_HANDSHAKE_WRAPUP:
3626:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            mbedtls_ssl_handshake_wrapup( ssl );
 6196              		.loc 3 3626 12
 6197 01e5 488B45E8 		movq	-24(%rbp), %rax
 6198 01e9 4889C7   		movq	%rax, %rdi
 6199 01ec E8000000 		call	mbedtls_ssl_handshake_wrapup@PLT
 6199      00
3627:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            break;
 6200              		.loc 3 3627 12
 6201 01f1 EB07     		jmp	.L363
 6202              	.L344:
3628:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3629:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****        default:
3630:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            MBEDTLS_SSL_DEBUG_MSG( 1, ( "invalid state %d", ssl->state ) );
3631:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****            return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 6203              		.loc 3 3631 18
 6204 01f3 B8008FFF 		movl	$-28928, %eax
 6204      FF
 6205 01f8 EB03     		jmp	.L341
 6206              	.L363:
3632:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****    }
3633:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** 
3634:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c ****     return( ret );
 6207              		.loc 3 3634 11
 6208 01fa 8B45F4   		movl	-12(%rbp), %eax
 6209              	.L341:
3635:/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/library/ssl_cli.c **** }
 6210              		.loc 3 3635 1
 6211 01fd 488B4DF8 		movq	-8(%rbp), %rcx
 6212 0201 6448330C 		xorq	%fs:40, %rcx
 6212      25280000 
 6212      00
 6213 020a 7405     		je	.L364
 6214 020c E8000000 		call	__stack_chk_fail@PLT
 6214      00
 6215              	.L364:
 6216 0211 C9       		leave
 6217              	.LCFI98:
 6218              		.cfi_def_cfa 7, 8
 6219 0212 C3       		ret
 6220              		.cfi_endproc
 6221              	.LFE53:
 6223              		.text
 6224              	.Letext0:
 6225              		.file 4 "/usr/lib/gcc/x86_64-linux-gnu/9/include/stddef.h"
 6226              		.file 5 "/usr/include/x86_64-linux-gnu/bits/types.h"
 6227              		.file 6 "/usr/include/x86_64-linux-gnu/bits/types/struct_FILE.h"
 6228              		.file 7 "/usr/include/x86_64-linux-gnu/bits/types/FILE.h"
 6229              		.file 8 "/usr/include/stdio.h"
 6230              		.file 9 "/usr/include/x86_64-linux-gnu/bits/sys_errlist.h"
GAS LISTING /tmp/cc8psT5X.s 			page 217


 6231              		.file 10 "/usr/include/time.h"
 6232              		.file 11 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/platform
 6233              		.file 12 "/usr/include/x86_64-linux-gnu/bits/stdint-uintn.h"
 6234              		.file 13 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/bignum.h
 6235              		.file 14 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ecp.h"
 6236              		.file 15 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/md.h"
 6237              		.file 16 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h"
 6238              		.file 17 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/cipher.h
 6239              		.file 18 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/asn1.h"
 6240              		.file 19 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/x509.h"
 6241              		.file 20 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/x509_crl
 6242              		.file 21 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/x509_crt
 6243              		.file 22 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ecdh.h"
 6244              		.file 23 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ssl.h"
 6245              		.file 24 "/home/xingli/share/1205tiny/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/sha256.h
 15505              		.section	.note.gnu.property,"a"
 15506              		.align 8
 15507 0000 04000000 		.long	 1f - 0f
 15508 0004 10000000 		.long	 4f - 1f
 15509 0008 05000000 		.long	 5
 15510              	0:
 15511 000c 474E5500 		.string	 "GNU"
 15512              	1:
 15513              		.align 8
 15514 0010 020000C0 		.long	 0xc0000002
 15515 0014 04000000 		.long	 3f - 2f
 15516              	2:
 15517 0018 03000000 		.long	 0x3
 15518              	3:
 15519 001c 00000000 		.align 8
 15520              	4:
GAS LISTING /tmp/cc8psT5X.s 			page 218


DEFINED SYMBOLS
                            *ABS*:0000000000000000 ssl_cli.c
     /tmp/cc8psT5X.s:6      .text.mbedtls_ssl_ciphersuite_cert_req_allowed:0000000000000000 mbedtls_ssl_ciphersuite_cert_req_allowed
     /tmp/cc8psT5X.s:60     .text.mbedtls_ssl_ciphersuite_uses_server_signature:0000000000000000 mbedtls_ssl_ciphersuite_uses_server_signature
     /tmp/cc8psT5X.s:106    .text.mbedtls_ssl_own_key:0000000000000000 mbedtls_ssl_own_key
     /tmp/cc8psT5X.s:180    .text.mbedtls_ssl_own_cert:0000000000000000 mbedtls_ssl_own_cert
     /tmp/cc8psT5X.s:253    .text.mbedtls_ssl_hs_hdr_len:0000000000000000 mbedtls_ssl_hs_hdr_len
     /tmp/cc8psT5X.s:287    .text.mbedtls_ssl_safer_memcmp:0000000000000000 mbedtls_ssl_safer_memcmp
     /tmp/cc8psT5X.s:367    .text.ssl_write_renegotiation_ext:0000000000000000 ssl_write_renegotiation_ext
     /tmp/cc8psT5X.s:507    .text.ssl_write_signature_algorithms_ext:0000000000000000 ssl_write_signature_algorithms_ext
     /tmp/cc8psT5X.s:749    .text.ssl_write_supported_elliptic_curves_ext:0000000000000000 ssl_write_supported_elliptic_curves_ext
     /tmp/cc8psT5X.s:980    .text.ssl_write_supported_point_formats_ext:0000000000000000 ssl_write_supported_point_formats_ext
     /tmp/cc8psT5X.s:1081   .text.ssl_write_max_fragment_length_ext:0000000000000000 ssl_write_max_fragment_length_ext
     /tmp/cc8psT5X.s:1199   .text.ssl_write_extended_ms_ext:0000000000000000 ssl_write_extended_ms_ext
     /tmp/cc8psT5X.s:1309   .text.ssl_write_session_ticket_ext:0000000000000000 ssl_write_session_ticket_ext
     /tmp/cc8psT5X.s:1463   .text.ssl_generate_random:0000000000000000 ssl_generate_random
     /tmp/cc8psT5X.s:1555   .text.ssl_validate_ciphersuite:0000000000000000 ssl_validate_ciphersuite
     /tmp/cc8psT5X.s:1618   .text.ssl_write_client_hello:0000000000000000 ssl_write_client_hello
     /tmp/cc8psT5X.s:2269   .text.ssl_parse_renegotiation_info:0000000000000000 ssl_parse_renegotiation_info
     /tmp/cc8psT5X.s:2406   .text.ssl_parse_max_fragment_length_ext:0000000000000000 ssl_parse_max_fragment_length_ext
     /tmp/cc8psT5X.s:2480   .text.ssl_parse_extended_ms_ext:0000000000000000 ssl_parse_extended_ms_ext
     /tmp/cc8psT5X.s:2552   .text.ssl_parse_session_ticket_ext:0000000000000000 ssl_parse_session_ticket_ext
     /tmp/cc8psT5X.s:2618   .text.ssl_parse_supported_point_formats_ext:0000000000000000 ssl_parse_supported_point_formats_ext
     /tmp/cc8psT5X.s:2735   .text.ssl_parse_server_hello:0000000000000000 ssl_parse_server_hello
     /tmp/cc8psT5X.s:3729   .text.ssl_check_server_ecdh_params:0000000000000000 ssl_check_server_ecdh_params
     /tmp/cc8psT5X.s:3796   .text.ssl_parse_server_ecdh_params:0000000000000000 ssl_parse_server_ecdh_params
     /tmp/cc8psT5X.s:3865   .text.ssl_write_encrypted_pms:0000000000000000 ssl_write_encrypted_pms
     /tmp/cc8psT5X.s:4120   .text.ssl_parse_signature_algorithm:0000000000000000 ssl_parse_signature_algorithm
     /tmp/cc8psT5X.s:4253   .text.ssl_parse_server_key_exchange:0000000000000000 ssl_parse_server_key_exchange
     /tmp/cc8psT5X.s:4706   .text.ssl_parse_certificate_request:0000000000000000 ssl_parse_certificate_request
     /tmp/cc8psT5X.s:5038   .text.ssl_parse_server_hello_done:0000000000000000 ssl_parse_server_hello_done
     /tmp/cc8psT5X.s:5137   .text.ssl_write_client_key_exchange:0000000000000000 ssl_write_client_key_exchange
     /tmp/cc8psT5X.s:5341   .text.ssl_write_certificate_verify:0000000000000000 ssl_write_certificate_verify
     /tmp/cc8psT5X.s:5683   .text.ssl_parse_new_session_ticket:0000000000000000 ssl_parse_new_session_ticket
     /tmp/cc8psT5X.s:5968   .text.mbedtls_ssl_handshake_client_step:0000000000000000 mbedtls_ssl_handshake_client_step

UNDEFINED SYMBOLS
_GLOBAL_OFFSET_TABLE_
__stack_chk_fail
memcpy
mbedtls_ssl_hash_from_md_alg
mbedtls_ecp_curve_info_from_grp_id
mbedtls_ssl_write_version
mbedtls_ssl_ciphersuite_from_id
mbedtls_ssl_ciphersuite_uses_ec
mbedtls_ssl_write_handshake_msg
mbedtls_ssl_send_alert_message
mbedtls_ssl_read_record
mbedtls_ssl_read_version
mbedtls_ssl_optimize_checksum
memcmp
mbedtls_ssl_derive_keys
mbedtls_ssl_check_curve
mbedtls_ecdh_read_params
mbedtls_pk_can_do
mbedtls_pk_encrypt
mbedtls_ssl_md_alg_from_hash
GAS LISTING /tmp/cc8psT5X.s 			page 219


mbedtls_ssl_pk_alg_from_sig
mbedtls_ssl_check_sig_hash
mbedtls_ssl_get_ciphersuite_sig_pk_alg
mbedtls_ssl_get_key_exchange_md_tls1_2
mbedtls_pk_verify_restartable
mbedtls_ecdh_make_public
mbedtls_ecdh_calc_secret
mbedtls_ssl_sig_from_pk
mbedtls_pk_sign_restartable
mbedtls_platform_zeroize
mbedtls_free
mbedtls_calloc
mbedtls_ssl_flush_output
mbedtls_ssl_parse_certificate
mbedtls_ssl_write_certificate
mbedtls_ssl_write_change_cipher_spec
mbedtls_ssl_write_finished
mbedtls_ssl_parse_change_cipher_spec
mbedtls_ssl_parse_finished
mbedtls_ssl_handshake_wrapup
