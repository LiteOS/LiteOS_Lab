GAS LISTING /tmp/ccuGp1Bp.s 			page 1


   1              		.file	"ctr_drbg.c"
   2              		.text
   3              	.Ltext0:
   4              		.section	.text.mbedtls_ctr_drbg_init,"ax",@progbits
   5              		.globl	mbedtls_ctr_drbg_init
   7              	mbedtls_ctr_drbg_init:
   8              	.LFB0:
   9              		.file 1 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c"
   1:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** /*
   2:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *  CTR_DRBG implementation based on AES-256 (NIST SP 800-90)
   3:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *
   4:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *  Copyright (C) 2006-2015, ARM Limited, All Rights Reserved
   5:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *  SPDX-License-Identifier: Apache-2.0
   6:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *
   7:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *  Licensed under the Apache License, Version 2.0 (the "License"); you may
   8:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *  not use this file except in compliance with the License.
   9:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *  You may obtain a copy of the License at
  10:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *
  11:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *  http://www.apache.org/licenses/LICENSE-2.0
  12:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *
  13:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *  Unless required by applicable law or agreed to in writing, software
  14:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  15:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  16:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *  See the License for the specific language governing permissions and
  17:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *  limitations under the License.
  18:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *
  19:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *  This file is part of mbed TLS (https://tls.mbed.org)
  20:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  */
  21:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** /*
  22:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *  The NIST SP 800-90 DRBGs are described in the following publication.
  23:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *
  24:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *  http://csrc.nist.gov/publications/nistpubs/800-90/SP800-90revised_March2007.pdf
  25:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  */
  26:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
  27:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #if !defined(MBEDTLS_CONFIG_FILE)
  28:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #include "mbedtls/config.h"
  29:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #else
  30:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #include MBEDTLS_CONFIG_FILE
  31:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #endif
  32:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
  33:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #if defined(MBEDTLS_CTR_DRBG_C)
  34:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
  35:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #include "mbedtls/ctr_drbg.h"
  36:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #include "mbedtls/platform_util.h"
  37:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
  38:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #include <string.h>
  39:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
  40:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #if defined(MBEDTLS_FS_IO)
  41:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #include <stdio.h>
  42:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #endif
  43:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
  44:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #if defined(MBEDTLS_SELF_TEST)
  45:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #if defined(MBEDTLS_PLATFORM_C)
  46:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #include "mbedtls/platform.h"
  47:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #else
  48:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #include <stdio.h>
  49:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #define mbedtls_printf printf
GAS LISTING /tmp/ccuGp1Bp.s 			page 2


  50:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #endif /* MBEDTLS_PLATFORM_C */
  51:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #endif /* MBEDTLS_SELF_TEST */
  52:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
  53:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** /*
  54:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * CTR_DRBG context initialization
  55:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  */
  56:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** void mbedtls_ctr_drbg_init( mbedtls_ctr_drbg_context *ctx )
  57:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** {
  10              		.loc 1 57 1
  11              		.cfi_startproc
  12 0000 F30F1EFA 		endbr64
  13 0004 55       		pushq	%rbp
  14              	.LCFI0:
  15              		.cfi_def_cfa_offset 16
  16              		.cfi_offset 6, -16
  17 0005 4889E5   		movq	%rsp, %rbp
  18              	.LCFI1:
  19              		.cfi_def_cfa_register 6
  20 0008 4883EC20 		subq	$32, %rsp
  21 000c 48897DE8 		movq	%rdi, -24(%rbp)
  22              		.loc 1 57 1
  23 0010 64488B04 		movq	%fs:40, %rax
  23      25280000 
  23      00
  24 0019 488945F8 		movq	%rax, -8(%rbp)
  25 001d 31C0     		xorl	%eax, %eax
  58:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     memset( ctx, 0, sizeof( mbedtls_ctr_drbg_context ) );
  26              		.loc 1 58 5
  27 001f 488B45E8 		movq	-24(%rbp), %rax
  28 0023 BA580100 		movl	$344, %edx
  28      00
  29 0028 BE000000 		movl	$0, %esi
  29      00
  30 002d 4889C7   		movq	%rax, %rdi
  31 0030 E8000000 		call	memset@PLT
  31      00
  59:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
  60:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #if defined(MBEDTLS_THREADING_C)
  61:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     mbedtls_mutex_init( &ctx->mutex );
  62:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #endif
  63:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** }
  32              		.loc 1 63 1
  33 0035 90       		nop
  34 0036 488B45F8 		movq	-8(%rbp), %rax
  35 003a 64483304 		xorq	%fs:40, %rax
  35      25280000 
  35      00
  36 0043 7405     		je	.L2
  37 0045 E8000000 		call	__stack_chk_fail@PLT
  37      00
  38              	.L2:
  39 004a C9       		leave
  40              	.LCFI2:
  41              		.cfi_def_cfa 7, 8
  42 004b C3       		ret
  43              		.cfi_endproc
  44              	.LFE0:
GAS LISTING /tmp/ccuGp1Bp.s 			page 3


  46              		.section	.text.mbedtls_ctr_drbg_seed_entropy_len,"ax",@progbits
  47              		.globl	mbedtls_ctr_drbg_seed_entropy_len
  49              	mbedtls_ctr_drbg_seed_entropy_len:
  50              	.LFB1:
  64:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
  65:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** /*
  66:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * Non-public function wrapped by mbedtls_ctr_drbg_seed(). Necessary to allow
  67:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * NIST tests to succeed (which require known length fixed entropy)
  68:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  */
  69:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** /* CTR_DRBG_Instantiate with derivation function (SP 800-90A &sect;10.2.1.3.2)
  70:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * mbedtls_ctr_drbg_seed_entropy_len(ctx, f_entropy, p_entropy,
  71:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *                                   custom, len, entropy_len)
  72:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * implements
  73:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * CTR_DRBG_Instantiate(entropy_input, nonce, personalization_string,
  74:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *                      security_strength) -> initial_working_state
  75:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * with inputs
  76:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *   custom[:len] = nonce || personalization_string
  77:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * where entropy_input comes from f_entropy for entropy_len bytes
  78:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * and with outputs
  79:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *   ctx = initial_working_state
  80:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  */
  81:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** int mbedtls_ctr_drbg_seed_entropy_len(
  82:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                    mbedtls_ctr_drbg_context *ctx,
  83:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                    int (*f_entropy)(void *, unsigned char *, size_t),
  84:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                    void *p_entropy,
  85:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                    const unsigned char *custom,
  86:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                    size_t len,
  87:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                    size_t entropy_len )
  88:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** {
  51              		.loc 1 88 1
  52              		.cfi_startproc
  53 0000 F30F1EFA 		endbr64
  54 0004 55       		pushq	%rbp
  55              	.LCFI3:
  56              		.cfi_def_cfa_offset 16
  57              		.cfi_offset 6, -16
  58 0005 4889E5   		movq	%rsp, %rbp
  59              	.LCFI4:
  60              		.cfi_def_cfa_register 6
  61 0008 4883EC70 		subq	$112, %rsp
  62 000c 48897DB8 		movq	%rdi, -72(%rbp)
  63 0010 488975B0 		movq	%rsi, -80(%rbp)
  64 0014 488955A8 		movq	%rdx, -88(%rbp)
  65 0018 48894DA0 		movq	%rcx, -96(%rbp)
  66 001c 4C894598 		movq	%r8, -104(%rbp)
  67 0020 4C894D90 		movq	%r9, -112(%rbp)
  68              		.loc 1 88 1
  69 0024 64488B04 		movq	%fs:40, %rax
  69      25280000 
  69      00
  70 002d 488945F8 		movq	%rax, -8(%rbp)
  71 0031 31C0     		xorl	%eax, %eax
  89:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     int ret;
  90:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     unsigned char key[MBEDTLS_CTR_DRBG_KEYSIZE];
  91:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
  92:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     memset( key, 0, MBEDTLS_CTR_DRBG_KEYSIZE );
  72              		.loc 1 92 5
GAS LISTING /tmp/ccuGp1Bp.s 			page 4


  73 0033 488D45D0 		leaq	-48(%rbp), %rax
  74 0037 BA200000 		movl	$32, %edx
  74      00
  75 003c BE000000 		movl	$0, %esi
  75      00
  76 0041 4889C7   		movq	%rax, %rdi
  77 0044 E8000000 		call	memset@PLT
  77      00
  93:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
  94:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     mbedtls_aes_init( &ctx->aes_ctx );
  78              		.loc 1 94 5
  79 0049 488B45B8 		movq	-72(%rbp), %rax
  80 004d 4883C028 		addq	$40, %rax
  81 0051 4889C7   		movq	%rax, %rdi
  82 0054 E8000000 		call	mbedtls_aes_init@PLT
  82      00
  95:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
  96:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     ctx->f_entropy = f_entropy;
  83              		.loc 1 96 20
  84 0059 488B45B8 		movq	-72(%rbp), %rax
  85 005d 488B55B0 		movq	-80(%rbp), %rdx
  86 0061 48899048 		movq	%rdx, 328(%rax)
  86      010000
  97:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     ctx->p_entropy = p_entropy;
  87              		.loc 1 97 20
  88 0068 488B45B8 		movq	-72(%rbp), %rax
  89 006c 488B55A8 		movq	-88(%rbp), %rdx
  90 0070 48899050 		movq	%rdx, 336(%rax)
  90      010000
  98:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
  99:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     ctx->entropy_len = entropy_len;
  91              		.loc 1 99 22
  92 0077 488B45B8 		movq	-72(%rbp), %rax
  93 007b 488B5590 		movq	-112(%rbp), %rdx
  94 007f 48895018 		movq	%rdx, 24(%rax)
 100:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     ctx->reseed_interval = MBEDTLS_CTR_DRBG_RESEED_INTERVAL;
  95              		.loc 1 100 26
  96 0083 488B45B8 		movq	-72(%rbp), %rax
  97 0087 C7402010 		movl	$10000, 32(%rax)
  97      270000
 101:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 102:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     /*
 103:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****      * Initialize with an empty key
 104:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****      */
 105:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( ( ret = mbedtls_aes_setkey_enc( &ctx->aes_ctx, key, MBEDTLS_CTR_DRBG_KEYBITS ) ) != 0 )
  98              		.loc 1 105 17
  99 008e 488B45B8 		movq	-72(%rbp), %rax
 100 0092 488D4828 		leaq	40(%rax), %rcx
 101 0096 488D45D0 		leaq	-48(%rbp), %rax
 102 009a BA000100 		movl	$256, %edx
 102      00
 103 009f 4889C6   		movq	%rax, %rsi
 104 00a2 4889CF   		movq	%rcx, %rdi
 105 00a5 E8000000 		call	mbedtls_aes_setkey_enc@PLT
 105      00
 106 00aa 8945CC   		movl	%eax, -52(%rbp)
 107              		.loc 1 105 7
GAS LISTING /tmp/ccuGp1Bp.s 			page 5


 108 00ad 837DCC00 		cmpl	$0, -52(%rbp)
 109 00b1 7405     		je	.L4
 106:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     {
 107:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         return( ret );
 110              		.loc 1 107 15
 111 00b3 8B45CC   		movl	-52(%rbp), %eax
 112 00b6 EB2A     		jmp	.L7
 113              	.L4:
 108:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     }
 109:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 110:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( ( ret = mbedtls_ctr_drbg_reseed( ctx, custom, len ) ) != 0 )
 114              		.loc 1 110 17
 115 00b8 488B5598 		movq	-104(%rbp), %rdx
 116 00bc 488B4DA0 		movq	-96(%rbp), %rcx
 117 00c0 488B45B8 		movq	-72(%rbp), %rax
 118 00c4 4889CE   		movq	%rcx, %rsi
 119 00c7 4889C7   		movq	%rax, %rdi
 120 00ca E8000000 		call	mbedtls_ctr_drbg_reseed
 120      00
 121 00cf 8945CC   		movl	%eax, -52(%rbp)
 122              		.loc 1 110 7
 123 00d2 837DCC00 		cmpl	$0, -52(%rbp)
 124 00d6 7405     		je	.L6
 111:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     {
 112:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         return( ret );
 125              		.loc 1 112 15
 126 00d8 8B45CC   		movl	-52(%rbp), %eax
 127 00db EB05     		jmp	.L7
 128              	.L6:
 113:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     }
 114:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     return( 0 );
 129              		.loc 1 114 11
 130 00dd B8000000 		movl	$0, %eax
 130      00
 131              	.L7:
 115:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** }
 132              		.loc 1 115 1 discriminator 1
 133 00e2 488B75F8 		movq	-8(%rbp), %rsi
 134 00e6 64483334 		xorq	%fs:40, %rsi
 134      25280000 
 134      00
 135 00ef 7405     		je	.L8
 136              		.loc 1 115 1 is_stmt 0
 137 00f1 E8000000 		call	__stack_chk_fail@PLT
 137      00
 138              	.L8:
 139 00f6 C9       		leave
 140              	.LCFI5:
 141              		.cfi_def_cfa 7, 8
 142 00f7 C3       		ret
 143              		.cfi_endproc
 144              	.LFE1:
 146              		.section	.text.mbedtls_ctr_drbg_seed,"ax",@progbits
 147              		.globl	mbedtls_ctr_drbg_seed
 149              	mbedtls_ctr_drbg_seed:
 150              	.LFB2:
 116:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
GAS LISTING /tmp/ccuGp1Bp.s 			page 6


 117:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** int mbedtls_ctr_drbg_seed( mbedtls_ctr_drbg_context *ctx,
 118:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                    int (*f_entropy)(void *, unsigned char *, size_t),
 119:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                    void *p_entropy,
 120:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                    const unsigned char *custom,
 121:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                    size_t len )
 122:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** {
 151              		.loc 1 122 1 is_stmt 1
 152              		.cfi_startproc
 153 0000 F30F1EFA 		endbr64
 154 0004 55       		pushq	%rbp
 155              	.LCFI6:
 156              		.cfi_def_cfa_offset 16
 157              		.cfi_offset 6, -16
 158 0005 4889E5   		movq	%rsp, %rbp
 159              	.LCFI7:
 160              		.cfi_def_cfa_register 6
 161 0008 4883EC40 		subq	$64, %rsp
 162 000c 48897DE8 		movq	%rdi, -24(%rbp)
 163 0010 488975E0 		movq	%rsi, -32(%rbp)
 164 0014 488955D8 		movq	%rdx, -40(%rbp)
 165 0018 48894DD0 		movq	%rcx, -48(%rbp)
 166 001c 4C8945C8 		movq	%r8, -56(%rbp)
 167              		.loc 1 122 1
 168 0020 64488B04 		movq	%fs:40, %rax
 168      25280000 
 168      00
 169 0029 488945F8 		movq	%rax, -8(%rbp)
 170 002d 31C0     		xorl	%eax, %eax
 123:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     return( mbedtls_ctr_drbg_seed_entropy_len( ctx, f_entropy, p_entropy, custom, len,
 171              		.loc 1 123 13
 172 002f 488B7DC8 		movq	-56(%rbp), %rdi
 173 0033 488B4DD0 		movq	-48(%rbp), %rcx
 174 0037 488B55D8 		movq	-40(%rbp), %rdx
 175 003b 488B75E0 		movq	-32(%rbp), %rsi
 176 003f 488B45E8 		movq	-24(%rbp), %rax
 177 0043 41B92000 		movl	$32, %r9d
 177      0000
 178 0049 4989F8   		movq	%rdi, %r8
 179 004c 4889C7   		movq	%rax, %rdi
 180 004f E8000000 		call	mbedtls_ctr_drbg_seed_entropy_len
 180      00
 124:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                                        MBEDTLS_CTR_DRBG_ENTROPY_LEN ) );
 125:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** }
 181              		.loc 1 125 1
 182 0054 488B55F8 		movq	-8(%rbp), %rdx
 183 0058 64483314 		xorq	%fs:40, %rdx
 183      25280000 
 183      00
 184 0061 7405     		je	.L11
 185 0063 E8000000 		call	__stack_chk_fail@PLT
 185      00
 186              	.L11:
 187 0068 C9       		leave
 188              	.LCFI8:
 189              		.cfi_def_cfa 7, 8
 190 0069 C3       		ret
 191              		.cfi_endproc
GAS LISTING /tmp/ccuGp1Bp.s 			page 7


 192              	.LFE2:
 194              		.section	.text.mbedtls_ctr_drbg_free,"ax",@progbits
 195              		.globl	mbedtls_ctr_drbg_free
 197              	mbedtls_ctr_drbg_free:
 198              	.LFB3:
 126:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 127:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** void mbedtls_ctr_drbg_free( mbedtls_ctr_drbg_context *ctx )
 128:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** {
 199              		.loc 1 128 1
 200              		.cfi_startproc
 201 0000 F30F1EFA 		endbr64
 202 0004 55       		pushq	%rbp
 203              	.LCFI9:
 204              		.cfi_def_cfa_offset 16
 205              		.cfi_offset 6, -16
 206 0005 4889E5   		movq	%rsp, %rbp
 207              	.LCFI10:
 208              		.cfi_def_cfa_register 6
 209 0008 4883EC20 		subq	$32, %rsp
 210 000c 48897DE8 		movq	%rdi, -24(%rbp)
 211              		.loc 1 128 1
 212 0010 64488B04 		movq	%fs:40, %rax
 212      25280000 
 212      00
 213 0019 488945F8 		movq	%rax, -8(%rbp)
 214 001d 31C0     		xorl	%eax, %eax
 129:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( ctx == NULL )
 215              		.loc 1 129 7
 216 001f 48837DE8 		cmpq	$0, -24(%rbp)
 216      00
 217 0024 7423     		je	.L16
 130:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         return;
 131:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 132:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #if defined(MBEDTLS_THREADING_C)
 133:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     mbedtls_mutex_free( &ctx->mutex );
 134:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #endif
 135:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     mbedtls_aes_free( &ctx->aes_ctx );
 218              		.loc 1 135 5
 219 0026 488B45E8 		movq	-24(%rbp), %rax
 220 002a 4883C028 		addq	$40, %rax
 221 002e 4889C7   		movq	%rax, %rdi
 222 0031 E8000000 		call	mbedtls_aes_free@PLT
 222      00
 136:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     mbedtls_platform_zeroize( ctx, sizeof( mbedtls_ctr_drbg_context ) );
 223              		.loc 1 136 5
 224 0036 488B45E8 		movq	-24(%rbp), %rax
 225 003a BE580100 		movl	$344, %esi
 225      00
 226 003f 4889C7   		movq	%rax, %rdi
 227 0042 E8000000 		call	mbedtls_platform_zeroize@PLT
 227      00
 228 0047 EB01     		jmp	.L12
 229              	.L16:
 130:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         return;
 230              		.loc 1 130 9
 231 0049 90       		nop
 232              	.L12:
GAS LISTING /tmp/ccuGp1Bp.s 			page 8


 137:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** }
 233              		.loc 1 137 1
 234 004a 488B45F8 		movq	-8(%rbp), %rax
 235 004e 64483304 		xorq	%fs:40, %rax
 235      25280000 
 235      00
 236 0057 7405     		je	.L15
 237 0059 E8000000 		call	__stack_chk_fail@PLT
 237      00
 238              	.L15:
 239 005e C9       		leave
 240              	.LCFI11:
 241              		.cfi_def_cfa 7, 8
 242 005f C3       		ret
 243              		.cfi_endproc
 244              	.LFE3:
 246              		.section	.text.mbedtls_ctr_drbg_set_prediction_resistance,"ax",@progbits
 247              		.globl	mbedtls_ctr_drbg_set_prediction_resistance
 249              	mbedtls_ctr_drbg_set_prediction_resistance:
 250              	.LFB4:
 138:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 139:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** void mbedtls_ctr_drbg_set_prediction_resistance( mbedtls_ctr_drbg_context *ctx, int resistance )
 140:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** {
 251              		.loc 1 140 1
 252              		.cfi_startproc
 253 0000 F30F1EFA 		endbr64
 254 0004 55       		pushq	%rbp
 255              	.LCFI12:
 256              		.cfi_def_cfa_offset 16
 257              		.cfi_offset 6, -16
 258 0005 4889E5   		movq	%rsp, %rbp
 259              	.LCFI13:
 260              		.cfi_def_cfa_register 6
 261 0008 4883EC20 		subq	$32, %rsp
 262 000c 48897DE8 		movq	%rdi, -24(%rbp)
 263 0010 8975E4   		movl	%esi, -28(%rbp)
 264              		.loc 1 140 1
 265 0013 64488B04 		movq	%fs:40, %rax
 265      25280000 
 265      00
 266 001c 488945F8 		movq	%rax, -8(%rbp)
 267 0020 31C0     		xorl	%eax, %eax
 141:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     ctx->prediction_resistance = resistance;
 268              		.loc 1 141 32
 269 0022 488B45E8 		movq	-24(%rbp), %rax
 270 0026 8B55E4   		movl	-28(%rbp), %edx
 271 0029 895014   		movl	%edx, 20(%rax)
 142:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** }
 272              		.loc 1 142 1
 273 002c 90       		nop
 274 002d 488B45F8 		movq	-8(%rbp), %rax
 275 0031 64483304 		xorq	%fs:40, %rax
 275      25280000 
 275      00
 276 003a 7405     		je	.L18
 277 003c E8000000 		call	__stack_chk_fail@PLT
 277      00
GAS LISTING /tmp/ccuGp1Bp.s 			page 9


 278              	.L18:
 279 0041 C9       		leave
 280              	.LCFI14:
 281              		.cfi_def_cfa 7, 8
 282 0042 C3       		ret
 283              		.cfi_endproc
 284              	.LFE4:
 286              		.section	.text.mbedtls_ctr_drbg_set_entropy_len,"ax",@progbits
 287              		.globl	mbedtls_ctr_drbg_set_entropy_len
 289              	mbedtls_ctr_drbg_set_entropy_len:
 290              	.LFB5:
 143:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 144:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** void mbedtls_ctr_drbg_set_entropy_len( mbedtls_ctr_drbg_context *ctx, size_t len )
 145:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** {
 291              		.loc 1 145 1
 292              		.cfi_startproc
 293 0000 F30F1EFA 		endbr64
 294 0004 55       		pushq	%rbp
 295              	.LCFI15:
 296              		.cfi_def_cfa_offset 16
 297              		.cfi_offset 6, -16
 298 0005 4889E5   		movq	%rsp, %rbp
 299              	.LCFI16:
 300              		.cfi_def_cfa_register 6
 301 0008 4883EC20 		subq	$32, %rsp
 302 000c 48897DE8 		movq	%rdi, -24(%rbp)
 303 0010 488975E0 		movq	%rsi, -32(%rbp)
 304              		.loc 1 145 1
 305 0014 64488B04 		movq	%fs:40, %rax
 305      25280000 
 305      00
 306 001d 488945F8 		movq	%rax, -8(%rbp)
 307 0021 31C0     		xorl	%eax, %eax
 146:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     ctx->entropy_len = len;
 308              		.loc 1 146 22
 309 0023 488B45E8 		movq	-24(%rbp), %rax
 310 0027 488B55E0 		movq	-32(%rbp), %rdx
 311 002b 48895018 		movq	%rdx, 24(%rax)
 147:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** }
 312              		.loc 1 147 1
 313 002f 90       		nop
 314 0030 488B45F8 		movq	-8(%rbp), %rax
 315 0034 64483304 		xorq	%fs:40, %rax
 315      25280000 
 315      00
 316 003d 7405     		je	.L20
 317 003f E8000000 		call	__stack_chk_fail@PLT
 317      00
 318              	.L20:
 319 0044 C9       		leave
 320              	.LCFI17:
 321              		.cfi_def_cfa 7, 8
 322 0045 C3       		ret
 323              		.cfi_endproc
 324              	.LFE5:
 326              		.section	.text.mbedtls_ctr_drbg_set_reseed_interval,"ax",@progbits
 327              		.globl	mbedtls_ctr_drbg_set_reseed_interval
GAS LISTING /tmp/ccuGp1Bp.s 			page 10


 329              	mbedtls_ctr_drbg_set_reseed_interval:
 330              	.LFB6:
 148:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 149:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** void mbedtls_ctr_drbg_set_reseed_interval( mbedtls_ctr_drbg_context *ctx, int interval )
 150:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** {
 331              		.loc 1 150 1
 332              		.cfi_startproc
 333 0000 F30F1EFA 		endbr64
 334 0004 55       		pushq	%rbp
 335              	.LCFI18:
 336              		.cfi_def_cfa_offset 16
 337              		.cfi_offset 6, -16
 338 0005 4889E5   		movq	%rsp, %rbp
 339              	.LCFI19:
 340              		.cfi_def_cfa_register 6
 341 0008 4883EC20 		subq	$32, %rsp
 342 000c 48897DE8 		movq	%rdi, -24(%rbp)
 343 0010 8975E4   		movl	%esi, -28(%rbp)
 344              		.loc 1 150 1
 345 0013 64488B04 		movq	%fs:40, %rax
 345      25280000 
 345      00
 346 001c 488945F8 		movq	%rax, -8(%rbp)
 347 0020 31C0     		xorl	%eax, %eax
 151:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     ctx->reseed_interval = interval;
 348              		.loc 1 151 26
 349 0022 488B45E8 		movq	-24(%rbp), %rax
 350 0026 8B55E4   		movl	-28(%rbp), %edx
 351 0029 895020   		movl	%edx, 32(%rax)
 152:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** }
 352              		.loc 1 152 1
 353 002c 90       		nop
 354 002d 488B45F8 		movq	-8(%rbp), %rax
 355 0031 64483304 		xorq	%fs:40, %rax
 355      25280000 
 355      00
 356 003a 7405     		je	.L22
 357 003c E8000000 		call	__stack_chk_fail@PLT
 357      00
 358              	.L22:
 359 0041 C9       		leave
 360              	.LCFI20:
 361              		.cfi_def_cfa 7, 8
 362 0042 C3       		ret
 363              		.cfi_endproc
 364              	.LFE6:
 366              		.section	.text.block_cipher_df,"ax",@progbits
 368              	block_cipher_df:
 369              	.LFB7:
 153:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 154:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** static int block_cipher_df( unsigned char *output,
 155:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                             const unsigned char *data, size_t data_len )
 156:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** {
 370              		.loc 1 156 1
 371              		.cfi_startproc
 372 0000 F30F1EFA 		endbr64
 373 0004 55       		pushq	%rbp
GAS LISTING /tmp/ccuGp1Bp.s 			page 11


 374              	.LCFI21:
 375              		.cfi_def_cfa_offset 16
 376              		.cfi_offset 6, -16
 377 0005 4889E5   		movq	%rsp, %rbp
 378              	.LCFI22:
 379              		.cfi_def_cfa_register 6
 380 0008 4881EC80 		subq	$896, %rsp
 380      030000
 381 000f 4889BD98 		movq	%rdi, -872(%rbp)
 381      FCFFFF
 382 0016 4889B590 		movq	%rsi, -880(%rbp)
 382      FCFFFF
 383 001d 48899588 		movq	%rdx, -888(%rbp)
 383      FCFFFF
 384              		.loc 1 156 1
 385 0024 64488B04 		movq	%fs:40, %rax
 385      25280000 
 385      00
 386 002d 488945F8 		movq	%rax, -8(%rbp)
 387 0031 31C0     		xorl	%eax, %eax
 157:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     unsigned char buf[MBEDTLS_CTR_DRBG_MAX_SEED_INPUT + MBEDTLS_CTR_DRBG_BLOCKSIZE + 16];
 158:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     unsigned char tmp[MBEDTLS_CTR_DRBG_SEEDLEN];
 159:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     unsigned char key[MBEDTLS_CTR_DRBG_KEYSIZE];
 160:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     unsigned char chain[MBEDTLS_CTR_DRBG_BLOCKSIZE];
 161:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     unsigned char *p, *iv;
 162:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     mbedtls_aes_context aes_ctx;
 163:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     int ret = 0;
 388              		.loc 1 163 9
 389 0033 C785A4FC 		movl	$0, -860(%rbp)
 389      FFFF0000 
 389      0000
 164:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 165:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     int i, j;
 166:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     size_t buf_len, use_len;
 167:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 168:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( data_len > MBEDTLS_CTR_DRBG_MAX_SEED_INPUT )
 390              		.loc 1 168 7
 391 003d 4881BD88 		cmpq	$384, -888(%rbp)
 391      FCFFFF80 
 391      010000
 392 0048 760A     		jbe	.L24
 169:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         return( MBEDTLS_ERR_CTR_DRBG_INPUT_TOO_BIG );
 393              		.loc 1 169 15
 394 004a B8C8FFFF 		movl	$-56, %eax
 394      FF
 395 004f E9290400 		jmp	.L41
 395      00
 396              	.L24:
 170:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 171:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     memset( buf, 0, MBEDTLS_CTR_DRBG_MAX_SEED_INPUT + MBEDTLS_CTR_DRBG_BLOCKSIZE + 16 );
 397              		.loc 1 171 5
 398 0054 488D8550 		leaq	-432(%rbp), %rax
 398      FEFFFF
 399 005b BAA00100 		movl	$416, %edx
 399      00
 400 0060 BE000000 		movl	$0, %esi
 400      00
GAS LISTING /tmp/ccuGp1Bp.s 			page 12


 401 0065 4889C7   		movq	%rax, %rdi
 402 0068 E8000000 		call	memset@PLT
 402      00
 172:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     mbedtls_aes_init( &aes_ctx );
 403              		.loc 1 172 5
 404 006d 488D85D0 		leaq	-816(%rbp), %rax
 404      FCFFFF
 405 0074 4889C7   		movq	%rax, %rdi
 406 0077 E8000000 		call	mbedtls_aes_init@PLT
 406      00
 173:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 174:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     /*
 175:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****      * Construct IV (16 bytes) and S in buffer
 176:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****      * IV = Counter (in 32-bits) padded to 16 with zeroes
 177:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****      * S = Length input string (in 32-bits) || Length of output (in 32-bits) ||
 178:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****      *     data || 0x80
 179:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****      *     (Total is padded to a multiple of 16-bytes with zeroes)
 180:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****      */
 181:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     p = buf + MBEDTLS_CTR_DRBG_BLOCKSIZE;
 407              		.loc 1 181 7
 408 007c 488D8550 		leaq	-432(%rbp), %rax
 408      FEFFFF
 409 0083 4883C010 		addq	$16, %rax
 410 0087 488985B0 		movq	%rax, -848(%rbp)
 410      FCFFFF
 182:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     *p++ = ( data_len >> 24 ) & 0xff;
 411              		.loc 1 182 23
 412 008e 488B8588 		movq	-888(%rbp), %rax
 412      FCFFFF
 413 0095 48C1E818 		shrq	$24, %rax
 414 0099 4889C1   		movq	%rax, %rcx
 415              		.loc 1 182 7
 416 009c 488B85B0 		movq	-848(%rbp), %rax
 416      FCFFFF
 417 00a3 488D5001 		leaq	1(%rax), %rdx
 418 00a7 488995B0 		movq	%rdx, -848(%rbp)
 418      FCFFFF
 419              		.loc 1 182 10
 420 00ae 89CA     		movl	%ecx, %edx
 421 00b0 8810     		movb	%dl, (%rax)
 183:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     *p++ = ( data_len >> 16 ) & 0xff;
 422              		.loc 1 183 23
 423 00b2 488B8588 		movq	-888(%rbp), %rax
 423      FCFFFF
 424 00b9 48C1E810 		shrq	$16, %rax
 425 00bd 4889C1   		movq	%rax, %rcx
 426              		.loc 1 183 7
 427 00c0 488B85B0 		movq	-848(%rbp), %rax
 427      FCFFFF
 428 00c7 488D5001 		leaq	1(%rax), %rdx
 429 00cb 488995B0 		movq	%rdx, -848(%rbp)
 429      FCFFFF
 430              		.loc 1 183 10
 431 00d2 89CA     		movl	%ecx, %edx
 432 00d4 8810     		movb	%dl, (%rax)
 184:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     *p++ = ( data_len >> 8  ) & 0xff;
 433              		.loc 1 184 23
GAS LISTING /tmp/ccuGp1Bp.s 			page 13


 434 00d6 488B8588 		movq	-888(%rbp), %rax
 434      FCFFFF
 435 00dd 48C1E808 		shrq	$8, %rax
 436 00e1 4889C1   		movq	%rax, %rcx
 437              		.loc 1 184 7
 438 00e4 488B85B0 		movq	-848(%rbp), %rax
 438      FCFFFF
 439 00eb 488D5001 		leaq	1(%rax), %rdx
 440 00ef 488995B0 		movq	%rdx, -848(%rbp)
 440      FCFFFF
 441              		.loc 1 184 10
 442 00f6 89CA     		movl	%ecx, %edx
 443 00f8 8810     		movb	%dl, (%rax)
 185:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     *p++ = ( data_len       ) & 0xff;
 444              		.loc 1 185 7
 445 00fa 488B85B0 		movq	-848(%rbp), %rax
 445      FCFFFF
 446 0101 488D5001 		leaq	1(%rax), %rdx
 447 0105 488995B0 		movq	%rdx, -848(%rbp)
 447      FCFFFF
 448              		.loc 1 185 10
 449 010c 488B9588 		movq	-888(%rbp), %rdx
 449      FCFFFF
 450 0113 8810     		movb	%dl, (%rax)
 186:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     p += 3;
 451              		.loc 1 186 7
 452 0115 488385B0 		addq	$3, -848(%rbp)
 452      FCFFFF03 
 187:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     *p++ = MBEDTLS_CTR_DRBG_SEEDLEN;
 453              		.loc 1 187 7
 454 011d 488B85B0 		movq	-848(%rbp), %rax
 454      FCFFFF
 455 0124 488D5001 		leaq	1(%rax), %rdx
 456 0128 488995B0 		movq	%rdx, -848(%rbp)
 456      FCFFFF
 457              		.loc 1 187 10
 458 012f C60030   		movb	$48, (%rax)
 188:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     memcpy( p, data, data_len );
 459              		.loc 1 188 5
 460 0132 488B9588 		movq	-888(%rbp), %rdx
 460      FCFFFF
 461 0139 488B8D90 		movq	-880(%rbp), %rcx
 461      FCFFFF
 462 0140 488B85B0 		movq	-848(%rbp), %rax
 462      FCFFFF
 463 0147 4889CE   		movq	%rcx, %rsi
 464 014a 4889C7   		movq	%rax, %rdi
 465 014d E8000000 		call	memcpy@PLT
 465      00
 189:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     p[data_len] = 0x80;
 466              		.loc 1 189 6
 467 0152 488B95B0 		movq	-848(%rbp), %rdx
 467      FCFFFF
 468 0159 488B8588 		movq	-888(%rbp), %rax
 468      FCFFFF
 469 0160 4801D0   		addq	%rdx, %rax
 470              		.loc 1 189 17
GAS LISTING /tmp/ccuGp1Bp.s 			page 14


 471 0163 C60080   		movb	$-128, (%rax)
 190:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 191:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     buf_len = MBEDTLS_CTR_DRBG_BLOCKSIZE + 8 + data_len + 1;
 472              		.loc 1 191 13
 473 0166 488B8588 		movq	-888(%rbp), %rax
 473      FCFFFF
 474 016d 4883C019 		addq	$25, %rax
 475 0171 488985C0 		movq	%rax, -832(%rbp)
 475      FCFFFF
 192:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 193:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     for( i = 0; i < MBEDTLS_CTR_DRBG_KEYSIZE; i++ )
 476              		.loc 1 193 12
 477 0178 C785A8FC 		movl	$0, -856(%rbp)
 477      FFFF0000 
 477      0000
 478              		.loc 1 193 5
 479 0182 EB1E     		jmp	.L26
 480              	.L27:
 194:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         key[i] = i;
 481              		.loc 1 194 16 discriminator 3
 482 0184 8B85A8FC 		movl	-856(%rbp), %eax
 482      FFFF
 483 018a 89C2     		movl	%eax, %edx
 484 018c 8B85A8FC 		movl	-856(%rbp), %eax
 484      FFFF
 485 0192 4898     		cltq
 486 0194 88940500 		movb	%dl, -512(%rbp,%rax)
 486      FEFFFF
 193:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         key[i] = i;
 487              		.loc 1 193 48 discriminator 3
 488 019b 8385A8FC 		addl	$1, -856(%rbp)
 488      FFFF01
 489              	.L26:
 193:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         key[i] = i;
 490              		.loc 1 193 5 discriminator 1
 491 01a2 83BDA8FC 		cmpl	$31, -856(%rbp)
 491      FFFF1F
 492 01a9 7ED9     		jle	.L27
 195:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 196:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( ( ret = mbedtls_aes_setkey_enc( &aes_ctx, key, MBEDTLS_CTR_DRBG_KEYBITS ) ) != 0 )
 493              		.loc 1 196 17
 494 01ab 488D8D00 		leaq	-512(%rbp), %rcx
 494      FEFFFF
 495 01b2 488D85D0 		leaq	-816(%rbp), %rax
 495      FCFFFF
 496 01b9 BA000100 		movl	$256, %edx
 496      00
 497 01be 4889CE   		movq	%rcx, %rsi
 498 01c1 4889C7   		movq	%rax, %rdi
 499 01c4 E8000000 		call	mbedtls_aes_setkey_enc@PLT
 499      00
 500 01c9 8985A4FC 		movl	%eax, -860(%rbp)
 500      FFFF
 501              		.loc 1 196 7
 502 01cf 83BDA4FC 		cmpl	$0, -860(%rbp)
 502      FFFF00
 503 01d6 0F851502 		jne	.L43
GAS LISTING /tmp/ccuGp1Bp.s 			page 15


 503      0000
 197:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     {
 198:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         goto exit;
 199:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     }
 200:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 201:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     /*
 202:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****      * Reduce data to MBEDTLS_CTR_DRBG_SEEDLEN bytes of data
 203:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****      */
 204:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     for( j = 0; j < MBEDTLS_CTR_DRBG_SEEDLEN; j += MBEDTLS_CTR_DRBG_BLOCKSIZE )
 504              		.loc 1 204 12
 505 01dc C785ACFC 		movl	$0, -852(%rbp)
 505      FFFF0000 
 505      0000
 506              		.loc 1 204 5
 507 01e6 E9350100 		jmp	.L30
 507      00
 508              	.L35:
 205:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     {
 206:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         p = buf;
 509              		.loc 1 206 11
 510 01eb 488D8550 		leaq	-432(%rbp), %rax
 510      FEFFFF
 511 01f2 488985B0 		movq	%rax, -848(%rbp)
 511      FCFFFF
 207:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         memset( chain, 0, MBEDTLS_CTR_DRBG_BLOCKSIZE );
 512              		.loc 1 207 9
 513 01f9 488D85F0 		leaq	-528(%rbp), %rax
 513      FDFFFF
 514 0200 BA100000 		movl	$16, %edx
 514      00
 515 0205 BE000000 		movl	$0, %esi
 515      00
 516 020a 4889C7   		movq	%rax, %rdi
 517 020d E8000000 		call	memset@PLT
 517      00
 208:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         use_len = buf_len;
 518              		.loc 1 208 17
 519 0212 488B85C0 		movq	-832(%rbp), %rax
 519      FCFFFF
 520 0219 488985B8 		movq	%rax, -840(%rbp)
 520      FCFFFF
 209:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 210:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         while( use_len > 0 )
 521              		.loc 1 210 14
 522 0220 E9AE0000 		jmp	.L31
 522      00
 523              	.L34:
 211:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         {
 212:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****             for( i = 0; i < MBEDTLS_CTR_DRBG_BLOCKSIZE; i++ )
 524              		.loc 1 212 20
 525 0225 C785A8FC 		movl	$0, -856(%rbp)
 525      FFFF0000 
 525      0000
 526              		.loc 1 212 13
 527 022f EB40     		jmp	.L32
 528              	.L33:
 213:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                 chain[i] ^= p[i];
GAS LISTING /tmp/ccuGp1Bp.s 			page 16


 529              		.loc 1 213 26 discriminator 3
 530 0231 8B85A8FC 		movl	-856(%rbp), %eax
 530      FFFF
 531 0237 4898     		cltq
 532 0239 0FB68C05 		movzbl	-528(%rbp,%rax), %ecx
 532      F0FDFFFF 
 533              		.loc 1 213 30 discriminator 3
 534 0241 8B85A8FC 		movl	-856(%rbp), %eax
 534      FFFF
 535 0247 4863D0   		movslq	%eax, %rdx
 536 024a 488B85B0 		movq	-848(%rbp), %rax
 536      FCFFFF
 537 0251 4801D0   		addq	%rdx, %rax
 538 0254 0FB600   		movzbl	(%rax), %eax
 539              		.loc 1 213 26 discriminator 3
 540 0257 31C1     		xorl	%eax, %ecx
 541 0259 89CA     		movl	%ecx, %edx
 542 025b 8B85A8FC 		movl	-856(%rbp), %eax
 542      FFFF
 543 0261 4898     		cltq
 544 0263 889405F0 		movb	%dl, -528(%rbp,%rax)
 544      FDFFFF
 212:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                 chain[i] ^= p[i];
 545              		.loc 1 212 58 discriminator 3
 546 026a 8385A8FC 		addl	$1, -856(%rbp)
 546      FFFF01
 547              	.L32:
 212:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                 chain[i] ^= p[i];
 548              		.loc 1 212 13 discriminator 1
 549 0271 83BDA8FC 		cmpl	$15, -856(%rbp)
 549      FFFF0F
 550 0278 7EB7     		jle	.L33
 214:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****             p += MBEDTLS_CTR_DRBG_BLOCKSIZE;
 551              		.loc 1 214 15
 552 027a 488385B0 		addq	$16, -848(%rbp)
 552      FCFFFF10 
 215:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****             use_len -= ( use_len >= MBEDTLS_CTR_DRBG_BLOCKSIZE ) ?
 216:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                        MBEDTLS_CTR_DRBG_BLOCKSIZE : use_len;
 553              		.loc 1 216 51
 554 0282 B8100000 		movl	$16, %eax
 554      00
 555 0287 4883BDB8 		cmpq	$16, -840(%rbp)
 555      FCFFFF10 
 556 028f 480F4685 		cmovbe	-840(%rbp), %rax
 556      B8FCFFFF 
 215:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****             use_len -= ( use_len >= MBEDTLS_CTR_DRBG_BLOCKSIZE ) ?
 557              		.loc 1 215 21
 558 0297 482985B8 		subq	%rax, -840(%rbp)
 558      FCFFFF
 217:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 218:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****             if( ( ret = mbedtls_aes_crypt_ecb( &aes_ctx, MBEDTLS_AES_ENCRYPT, chain, chain ) ) != 0
 559              		.loc 1 218 25
 560 029e 488D8DF0 		leaq	-528(%rbp), %rcx
 560      FDFFFF
 561 02a5 488D95F0 		leaq	-528(%rbp), %rdx
 561      FDFFFF
 562 02ac 488D85D0 		leaq	-816(%rbp), %rax
GAS LISTING /tmp/ccuGp1Bp.s 			page 17


 562      FCFFFF
 563 02b3 BE010000 		movl	$1, %esi
 563      00
 564 02b8 4889C7   		movq	%rax, %rdi
 565 02bb E8000000 		call	mbedtls_aes_crypt_ecb@PLT
 565      00
 566 02c0 8985A4FC 		movl	%eax, -860(%rbp)
 566      FFFF
 567              		.loc 1 218 15
 568 02c6 83BDA4FC 		cmpl	$0, -860(%rbp)
 568      FFFF00
 569 02cd 0F852101 		jne	.L44
 569      0000
 570              	.L31:
 210:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         {
 571              		.loc 1 210 14
 572 02d3 4883BDB8 		cmpq	$0, -840(%rbp)
 572      FCFFFF00 
 573 02db 0F8544FF 		jne	.L34
 573      FFFF
 219:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****             {
 220:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                 goto exit;
 221:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****             }
 222:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         }
 223:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 224:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         memcpy( tmp + j, chain, MBEDTLS_CTR_DRBG_BLOCKSIZE );
 574              		.loc 1 224 9 discriminator 2
 575 02e1 8B85ACFC 		movl	-852(%rbp), %eax
 575      FFFF
 576 02e7 4898     		cltq
 577 02e9 488D9520 		leaq	-480(%rbp), %rdx
 577      FEFFFF
 578 02f0 488D0C02 		leaq	(%rdx,%rax), %rcx
 579 02f4 488B85F0 		movq	-528(%rbp), %rax
 579      FDFFFF
 580 02fb 488B95F8 		movq	-520(%rbp), %rdx
 580      FDFFFF
 581 0302 488901   		movq	%rax, (%rcx)
 582 0305 48895108 		movq	%rdx, 8(%rcx)
 225:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 226:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         /*
 227:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****          * Update IV
 228:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****          */
 229:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         buf[3]++;
 583              		.loc 1 229 12 discriminator 2
 584 0309 0FB68553 		movzbl	-429(%rbp), %eax
 584      FEFFFF
 585              		.loc 1 229 15 discriminator 2
 586 0310 83C001   		addl	$1, %eax
 587 0313 888553FE 		movb	%al, -429(%rbp)
 587      FFFF
 204:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     {
 588              		.loc 1 204 49 discriminator 2
 589 0319 8385ACFC 		addl	$16, -852(%rbp)
 589      FFFF10
 590              	.L30:
 204:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     {
GAS LISTING /tmp/ccuGp1Bp.s 			page 18


 591              		.loc 1 204 5 discriminator 1
 592 0320 83BDACFC 		cmpl	$47, -852(%rbp)
 592      FFFF2F
 593 0327 0F8EBEFE 		jle	.L35
 593      FFFF
 230:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     }
 231:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 232:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     /*
 233:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****      * Do final encryption with reduced data
 234:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****      */
 235:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( ( ret = mbedtls_aes_setkey_enc( &aes_ctx, tmp, MBEDTLS_CTR_DRBG_KEYBITS ) ) != 0 )
 594              		.loc 1 235 17
 595 032d 488D8D20 		leaq	-480(%rbp), %rcx
 595      FEFFFF
 596 0334 488D85D0 		leaq	-816(%rbp), %rax
 596      FCFFFF
 597 033b BA000100 		movl	$256, %edx
 597      00
 598 0340 4889CE   		movq	%rcx, %rsi
 599 0343 4889C7   		movq	%rax, %rdi
 600 0346 E8000000 		call	mbedtls_aes_setkey_enc@PLT
 600      00
 601 034b 8985A4FC 		movl	%eax, -860(%rbp)
 601      FFFF
 602              		.loc 1 235 7
 603 0351 83BDA4FC 		cmpl	$0, -860(%rbp)
 603      FFFF00
 604 0358 0F859900 		jne	.L45
 604      0000
 236:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     {
 237:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         goto exit;
 238:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     }
 239:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     iv = tmp + MBEDTLS_CTR_DRBG_KEYSIZE;
 605              		.loc 1 239 8
 606 035e 488D8520 		leaq	-480(%rbp), %rax
 606      FEFFFF
 607 0365 4883C020 		addq	$32, %rax
 608 0369 488985C8 		movq	%rax, -824(%rbp)
 608      FCFFFF
 240:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     p = output;
 609              		.loc 1 240 7
 610 0370 488B8598 		movq	-872(%rbp), %rax
 610      FCFFFF
 611 0377 488985B0 		movq	%rax, -848(%rbp)
 611      FCFFFF
 241:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 242:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     for( j = 0; j < MBEDTLS_CTR_DRBG_SEEDLEN; j += MBEDTLS_CTR_DRBG_BLOCKSIZE )
 612              		.loc 1 242 12
 613 037e C785ACFC 		movl	$0, -852(%rbp)
 613      FFFF0000 
 613      0000
 614              		.loc 1 242 5
 615 0388 EB5C     		jmp	.L37
 616              	.L39:
 243:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     {
 244:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         if( ( ret = mbedtls_aes_crypt_ecb( &aes_ctx, MBEDTLS_AES_ENCRYPT, iv, iv ) ) != 0 )
 617              		.loc 1 244 21
GAS LISTING /tmp/ccuGp1Bp.s 			page 19


 618 038a 488B8DC8 		movq	-824(%rbp), %rcx
 618      FCFFFF
 619 0391 488B95C8 		movq	-824(%rbp), %rdx
 619      FCFFFF
 620 0398 488D85D0 		leaq	-816(%rbp), %rax
 620      FCFFFF
 621 039f BE010000 		movl	$1, %esi
 621      00
 622 03a4 4889C7   		movq	%rax, %rdi
 623 03a7 E8000000 		call	mbedtls_aes_crypt_ecb@PLT
 623      00
 624 03ac 8985A4FC 		movl	%eax, -860(%rbp)
 624      FFFF
 625              		.loc 1 244 11
 626 03b2 83BDA4FC 		cmpl	$0, -860(%rbp)
 626      FFFF00
 627 03b9 753F     		jne	.L46
 628 03bb 488B85C8 		movq	-824(%rbp), %rax
 628      FCFFFF
 629 03c2 488B5008 		movq	8(%rax), %rdx
 630 03c6 488B00   		movq	(%rax), %rax
 245:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         {
 246:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****             goto exit;
 247:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         }
 248:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         memcpy( p, iv, MBEDTLS_CTR_DRBG_BLOCKSIZE );
 631              		.loc 1 248 9 discriminator 2
 632 03c9 488B8DB0 		movq	-848(%rbp), %rcx
 632      FCFFFF
 633 03d0 488901   		movq	%rax, (%rcx)
 634 03d3 48895108 		movq	%rdx, 8(%rcx)
 249:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         p += MBEDTLS_CTR_DRBG_BLOCKSIZE;
 635              		.loc 1 249 11 discriminator 2
 636 03d7 488385B0 		addq	$16, -848(%rbp)
 636      FCFFFF10 
 242:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     {
 637              		.loc 1 242 49 discriminator 2
 638 03df 8385ACFC 		addl	$16, -852(%rbp)
 638      FFFF10
 639              	.L37:
 242:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     {
 640              		.loc 1 242 5 discriminator 1
 641 03e6 83BDACFC 		cmpl	$47, -852(%rbp)
 641      FFFF2F
 642 03ed 7E9B     		jle	.L39
 250:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     }
 251:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** exit:
 643              		.loc 1 251 1
 644 03ef EB0A     		jmp	.L29
 645              	.L43:
 198:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     }
 646              		.loc 1 198 9
 647 03f1 90       		nop
 648 03f2 EB07     		jmp	.L29
 649              	.L44:
 220:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****             }
 650              		.loc 1 220 17
 651 03f4 90       		nop
GAS LISTING /tmp/ccuGp1Bp.s 			page 20


 652 03f5 EB04     		jmp	.L29
 653              	.L45:
 237:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     }
 654              		.loc 1 237 9
 655 03f7 90       		nop
 656 03f8 EB01     		jmp	.L29
 657              	.L46:
 246:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         }
 658              		.loc 1 246 13
 659 03fa 90       		nop
 660              	.L29:
 252:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     mbedtls_aes_free( &aes_ctx );
 661              		.loc 1 252 5
 662 03fb 488D85D0 		leaq	-816(%rbp), %rax
 662      FCFFFF
 663 0402 4889C7   		movq	%rax, %rdi
 664 0405 E8000000 		call	mbedtls_aes_free@PLT
 664      00
 253:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     /*
 254:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     * tidy up the stack
 255:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     */
 256:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     mbedtls_platform_zeroize( buf, sizeof( buf ) );
 665              		.loc 1 256 5
 666 040a 488D8550 		leaq	-432(%rbp), %rax
 666      FEFFFF
 667 0411 BEA00100 		movl	$416, %esi
 667      00
 668 0416 4889C7   		movq	%rax, %rdi
 669 0419 E8000000 		call	mbedtls_platform_zeroize@PLT
 669      00
 257:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     mbedtls_platform_zeroize( tmp, sizeof( tmp ) );
 670              		.loc 1 257 5
 671 041e 488D8520 		leaq	-480(%rbp), %rax
 671      FEFFFF
 672 0425 BE300000 		movl	$48, %esi
 672      00
 673 042a 4889C7   		movq	%rax, %rdi
 674 042d E8000000 		call	mbedtls_platform_zeroize@PLT
 674      00
 258:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     mbedtls_platform_zeroize( key, sizeof( key ) );
 675              		.loc 1 258 5
 676 0432 488D8500 		leaq	-512(%rbp), %rax
 676      FEFFFF
 677 0439 BE200000 		movl	$32, %esi
 677      00
 678 043e 4889C7   		movq	%rax, %rdi
 679 0441 E8000000 		call	mbedtls_platform_zeroize@PLT
 679      00
 259:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     mbedtls_platform_zeroize( chain, sizeof( chain ) );
 680              		.loc 1 259 5
 681 0446 488D85F0 		leaq	-528(%rbp), %rax
 681      FDFFFF
 682 044d BE100000 		movl	$16, %esi
 682      00
 683 0452 4889C7   		movq	%rax, %rdi
 684 0455 E8000000 		call	mbedtls_platform_zeroize@PLT
 684      00
GAS LISTING /tmp/ccuGp1Bp.s 			page 21


 260:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( 0 != ret )
 685              		.loc 1 260 7
 686 045a 83BDA4FC 		cmpl	$0, -860(%rbp)
 686      FFFF00
 687 0461 7414     		je	.L40
 261:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     {
 262:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         /*
 263:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         * wipe partial seed from memory
 264:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         */
 265:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         mbedtls_platform_zeroize( output, MBEDTLS_CTR_DRBG_SEEDLEN );
 688              		.loc 1 265 9
 689 0463 488B8598 		movq	-872(%rbp), %rax
 689      FCFFFF
 690 046a BE300000 		movl	$48, %esi
 690      00
 691 046f 4889C7   		movq	%rax, %rdi
 692 0472 E8000000 		call	mbedtls_platform_zeroize@PLT
 692      00
 693              	.L40:
 266:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     }
 267:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 268:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     return( ret );
 694              		.loc 1 268 11
 695 0477 8B85A4FC 		movl	-860(%rbp), %eax
 695      FFFF
 696              	.L41:
 269:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** }
 697              		.loc 1 269 1 discriminator 1
 698 047d 488B75F8 		movq	-8(%rbp), %rsi
 699 0481 64483334 		xorq	%fs:40, %rsi
 699      25280000 
 699      00
 700 048a 7405     		je	.L42
 701              		.loc 1 269 1 is_stmt 0
 702 048c E8000000 		call	__stack_chk_fail@PLT
 702      00
 703              	.L42:
 704 0491 C9       		leave
 705              	.LCFI23:
 706              		.cfi_def_cfa 7, 8
 707 0492 C3       		ret
 708              		.cfi_endproc
 709              	.LFE7:
 711              		.section	.text.ctr_drbg_update_internal,"ax",@progbits
 713              	ctr_drbg_update_internal:
 714              	.LFB8:
 270:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 271:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** /* CTR_DRBG_Update (SP 800-90A &sect;10.2.1.2)
 272:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * ctr_drbg_update_internal(ctx, provided_data)
 273:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * implements
 274:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * CTR_DRBG_Update(provided_data, Key, V)
 275:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * with inputs and outputs
 276:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *   ctx->aes_ctx = Key
 277:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *   ctx->counter = V
 278:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  */
 279:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** static int ctr_drbg_update_internal( mbedtls_ctr_drbg_context *ctx,
 280:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                               const unsigned char data[MBEDTLS_CTR_DRBG_SEEDLEN] )
GAS LISTING /tmp/ccuGp1Bp.s 			page 22


 281:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** {
 715              		.loc 1 281 1 is_stmt 1
 716              		.cfi_startproc
 717 0000 F30F1EFA 		endbr64
 718 0004 55       		pushq	%rbp
 719              	.LCFI24:
 720              		.cfi_def_cfa_offset 16
 721              		.cfi_offset 6, -16
 722 0005 4889E5   		movq	%rsp, %rbp
 723              	.LCFI25:
 724              		.cfi_def_cfa_register 6
 725 0008 4883EC70 		subq	$112, %rsp
 726 000c 48897D98 		movq	%rdi, -104(%rbp)
 727 0010 48897590 		movq	%rsi, -112(%rbp)
 728              		.loc 1 281 1
 729 0014 64488B04 		movq	%fs:40, %rax
 729      25280000 
 729      00
 730 001d 488945F8 		movq	%rax, -8(%rbp)
 731 0021 31C0     		xorl	%eax, %eax
 282:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     unsigned char tmp[MBEDTLS_CTR_DRBG_SEEDLEN];
 283:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     unsigned char *p = tmp;
 732              		.loc 1 283 20
 733 0023 488D45C0 		leaq	-64(%rbp), %rax
 734 0027 488945B8 		movq	%rax, -72(%rbp)
 284:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     int i, j;
 285:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     int ret = 0;
 735              		.loc 1 285 9
 736 002b C745B400 		movl	$0, -76(%rbp)
 736      000000
 286:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 287:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     memset( tmp, 0, MBEDTLS_CTR_DRBG_SEEDLEN );
 737              		.loc 1 287 5
 738 0032 488D45C0 		leaq	-64(%rbp), %rax
 739 0036 BA300000 		movl	$48, %edx
 739      00
 740 003b BE000000 		movl	$0, %esi
 740      00
 741 0040 4889C7   		movq	%rax, %rdi
 742 0043 E8000000 		call	memset@PLT
 742      00
 288:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 289:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     for( j = 0; j < MBEDTLS_CTR_DRBG_SEEDLEN; j += MBEDTLS_CTR_DRBG_BLOCKSIZE )
 743              		.loc 1 289 12
 744 0048 C745B000 		movl	$0, -80(%rbp)
 744      000000
 745              		.loc 1 289 5
 746 004f EB79     		jmp	.L48
 747              	.L55:
 290:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     {
 291:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         /*
 292:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****          * Increase counter
 293:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****          */
 294:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         for( i = MBEDTLS_CTR_DRBG_BLOCKSIZE; i > 0; i-- )
 748              		.loc 1 294 16
 749 0051 C745AC10 		movl	$16, -84(%rbp)
 749      000000
GAS LISTING /tmp/ccuGp1Bp.s 			page 23


 750              		.loc 1 294 9
 751 0058 EB31     		jmp	.L49
 752              	.L52:
 295:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****             if( ++ctx->counter[i - 1] != 0 )
 753              		.loc 1 295 34
 754 005a 8B45AC   		movl	-84(%rbp), %eax
 755 005d 83E801   		subl	$1, %eax
 756              		.loc 1 295 31
 757 0060 488B4D98 		movq	-104(%rbp), %rcx
 758 0064 4863D0   		movslq	%eax, %rdx
 759 0067 0FB61411 		movzbl	(%rcx,%rdx), %edx
 760              		.loc 1 295 17
 761 006b 8D7201   		leal	1(%rdx), %esi
 762              		.loc 1 295 15
 763 006e 488B4D98 		movq	-104(%rbp), %rcx
 764 0072 4863D0   		movslq	%eax, %rdx
 765 0075 40883411 		movb	%sil, (%rcx,%rdx)
 766              		.loc 1 295 31
 767 0079 488B5598 		movq	-104(%rbp), %rdx
 768 007d 4898     		cltq
 769 007f 0FB60402 		movzbl	(%rdx,%rax), %eax
 770              		.loc 1 295 15
 771 0083 84C0     		testb	%al, %al
 772 0085 750C     		jne	.L61
 294:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****             if( ++ctx->counter[i - 1] != 0 )
 773              		.loc 1 294 54 discriminator 2
 774 0087 836DAC01 		subl	$1, -84(%rbp)
 775              	.L49:
 294:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****             if( ++ctx->counter[i - 1] != 0 )
 776              		.loc 1 294 9 discriminator 1
 777 008b 837DAC00 		cmpl	$0, -84(%rbp)
 778 008f 7FC9     		jg	.L52
 779 0091 EB01     		jmp	.L51
 780              	.L61:
 296:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                 break;
 781              		.loc 1 296 17
 782 0093 90       		nop
 783              	.L51:
 297:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 298:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         /*
 299:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****          * Crypt counter block
 300:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****          */
 301:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         if( ( ret = mbedtls_aes_crypt_ecb( &ctx->aes_ctx, MBEDTLS_AES_ENCRYPT, ctx->counter, p ) ) 
 784              		.loc 1 301 83
 785 0094 488B4598 		movq	-104(%rbp), %rax
 786              		.loc 1 301 21
 787 0098 488B5598 		movq	-104(%rbp), %rdx
 788 009c 488D7A28 		leaq	40(%rdx), %rdi
 789 00a0 488B55B8 		movq	-72(%rbp), %rdx
 790 00a4 4889D1   		movq	%rdx, %rcx
 791 00a7 4889C2   		movq	%rax, %rdx
 792 00aa BE010000 		movl	$1, %esi
 792      00
 793 00af E8000000 		call	mbedtls_aes_crypt_ecb@PLT
 793      00
 794 00b4 8945B4   		movl	%eax, -76(%rbp)
 795              		.loc 1 301 11
GAS LISTING /tmp/ccuGp1Bp.s 			page 24


 796 00b7 837DB400 		cmpl	$0, -76(%rbp)
 797 00bb 0F858A00 		jne	.L62
 797      0000
 302:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****             goto exit;
 303:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 304:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         p += MBEDTLS_CTR_DRBG_BLOCKSIZE;
 798              		.loc 1 304 11 discriminator 2
 799 00c1 488345B8 		addq	$16, -72(%rbp)
 799      10
 289:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     {
 800              		.loc 1 289 49 discriminator 2
 801 00c6 8345B010 		addl	$16, -80(%rbp)
 802              	.L48:
 289:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     {
 803              		.loc 1 289 5 discriminator 1
 804 00ca 837DB02F 		cmpl	$47, -80(%rbp)
 805 00ce 7E81     		jle	.L55
 305:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     }
 306:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 307:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     for( i = 0; i < MBEDTLS_CTR_DRBG_SEEDLEN; i++ )
 806              		.loc 1 307 12
 807 00d0 C745AC00 		movl	$0, -84(%rbp)
 807      000000
 808              		.loc 1 307 5
 809 00d7 EB2B     		jmp	.L56
 810              	.L57:
 308:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         tmp[i] ^= data[i];
 811              		.loc 1 308 16 discriminator 3
 812 00d9 8B45AC   		movl	-84(%rbp), %eax
 813 00dc 4898     		cltq
 814 00de 0FB64C05 		movzbl	-64(%rbp,%rax), %ecx
 814      C0
 815              		.loc 1 308 23 discriminator 3
 816 00e3 8B45AC   		movl	-84(%rbp), %eax
 817 00e6 4863D0   		movslq	%eax, %rdx
 818 00e9 488B4590 		movq	-112(%rbp), %rax
 819 00ed 4801D0   		addq	%rdx, %rax
 820 00f0 0FB600   		movzbl	(%rax), %eax
 821              		.loc 1 308 16 discriminator 3
 822 00f3 31C1     		xorl	%eax, %ecx
 823 00f5 89CA     		movl	%ecx, %edx
 824 00f7 8B45AC   		movl	-84(%rbp), %eax
 825 00fa 4898     		cltq
 826 00fc 885405C0 		movb	%dl, -64(%rbp,%rax)
 307:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         tmp[i] ^= data[i];
 827              		.loc 1 307 48 discriminator 3
 828 0100 8345AC01 		addl	$1, -84(%rbp)
 829              	.L56:
 307:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         tmp[i] ^= data[i];
 830              		.loc 1 307 5 discriminator 1
 831 0104 837DAC2F 		cmpl	$47, -84(%rbp)
 832 0108 7ECF     		jle	.L57
 309:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 310:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     /*
 311:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****      * Update key and counter
 312:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****      */
 313:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( ( ret = mbedtls_aes_setkey_enc( &ctx->aes_ctx, tmp, MBEDTLS_CTR_DRBG_KEYBITS ) ) != 0 )
GAS LISTING /tmp/ccuGp1Bp.s 			page 25


 833              		.loc 1 313 17
 834 010a 488B4598 		movq	-104(%rbp), %rax
 835 010e 488D4828 		leaq	40(%rax), %rcx
 836 0112 488D45C0 		leaq	-64(%rbp), %rax
 837 0116 BA000100 		movl	$256, %edx
 837      00
 838 011b 4889C6   		movq	%rax, %rsi
 839 011e 4889CF   		movq	%rcx, %rdi
 840 0121 E8000000 		call	mbedtls_aes_setkey_enc@PLT
 840      00
 841 0126 8945B4   		movl	%eax, -76(%rbp)
 842              		.loc 1 313 7
 843 0129 837DB400 		cmpl	$0, -76(%rbp)
 844 012d 751F     		jne	.L63
 314:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         goto exit;
 315:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     memcpy( ctx->counter, tmp + MBEDTLS_CTR_DRBG_KEYSIZE, MBEDTLS_CTR_DRBG_BLOCKSIZE );
 845              		.loc 1 315 5
 846 012f 488D45C0 		leaq	-64(%rbp), %rax
 847 0133 4883C020 		addq	$32, %rax
 848              		.loc 1 315 16
 849 0137 488B4D98 		movq	-104(%rbp), %rcx
 850 013b 488B5008 		movq	8(%rax), %rdx
 851 013f 488B00   		movq	(%rax), %rax
 852              		.loc 1 315 5
 853 0142 488901   		movq	%rax, (%rcx)
 854 0145 48895108 		movq	%rdx, 8(%rcx)
 855 0149 EB04     		jmp	.L54
 856              	.L62:
 302:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 857              		.loc 1 302 13
 858 014b 90       		nop
 859 014c EB01     		jmp	.L54
 860              	.L63:
 314:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         goto exit;
 861              		.loc 1 314 9
 862 014e 90       		nop
 863              	.L54:
 316:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 317:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** exit:
 318:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     mbedtls_platform_zeroize( tmp, sizeof( tmp ) );
 864              		.loc 1 318 5
 865 014f 488D45C0 		leaq	-64(%rbp), %rax
 866 0153 BE300000 		movl	$48, %esi
 866      00
 867 0158 4889C7   		movq	%rax, %rdi
 868 015b E8000000 		call	mbedtls_platform_zeroize@PLT
 868      00
 319:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     return( ret );
 869              		.loc 1 319 11
 870 0160 8B45B4   		movl	-76(%rbp), %eax
 320:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** }
 871              		.loc 1 320 1
 872 0163 488B75F8 		movq	-8(%rbp), %rsi
 873 0167 64483334 		xorq	%fs:40, %rsi
 873      25280000 
 873      00
 874 0170 7405     		je	.L60
GAS LISTING /tmp/ccuGp1Bp.s 			page 26


 875 0172 E8000000 		call	__stack_chk_fail@PLT
 875      00
 876              	.L60:
 877 0177 C9       		leave
 878              	.LCFI26:
 879              		.cfi_def_cfa 7, 8
 880 0178 C3       		ret
 881              		.cfi_endproc
 882              	.LFE8:
 884              		.section	.text.mbedtls_ctr_drbg_update_ret,"ax",@progbits
 885              		.globl	mbedtls_ctr_drbg_update_ret
 887              	mbedtls_ctr_drbg_update_ret:
 888              	.LFB9:
 321:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 322:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** /* CTR_DRBG_Instantiate with derivation function (SP 800-90A &sect;10.2.1.3.2)
 323:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * mbedtls_ctr_drbg_update(ctx, additional, add_len)
 324:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * implements
 325:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * CTR_DRBG_Instantiate(entropy_input, nonce, personalization_string,
 326:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *                      security_strength) -> initial_working_state
 327:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * with inputs
 328:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *   ctx->counter = all-bits-0
 329:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *   ctx->aes_ctx = context from all-bits-0 key
 330:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *   additional[:add_len] = entropy_input || nonce || personalization_string
 331:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * and with outputs
 332:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *   ctx = initial_working_state
 333:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  */
 334:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** int mbedtls_ctr_drbg_update_ret( mbedtls_ctr_drbg_context *ctx,
 335:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                                  const unsigned char *additional,
 336:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                                  size_t add_len )
 337:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** {
 889              		.loc 1 337 1
 890              		.cfi_startproc
 891 0000 F30F1EFA 		endbr64
 892 0004 55       		pushq	%rbp
 893              	.LCFI27:
 894              		.cfi_def_cfa_offset 16
 895              		.cfi_offset 6, -16
 896 0005 4889E5   		movq	%rsp, %rbp
 897              	.LCFI28:
 898              		.cfi_def_cfa_register 6
 899 0008 4883EC70 		subq	$112, %rsp
 900 000c 48897DA8 		movq	%rdi, -88(%rbp)
 901 0010 488975A0 		movq	%rsi, -96(%rbp)
 902 0014 48895598 		movq	%rdx, -104(%rbp)
 903              		.loc 1 337 1
 904 0018 64488B04 		movq	%fs:40, %rax
 904      25280000 
 904      00
 905 0021 488945F8 		movq	%rax, -8(%rbp)
 906 0025 31C0     		xorl	%eax, %eax
 338:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     unsigned char add_input[MBEDTLS_CTR_DRBG_SEEDLEN];
 339:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     int ret;
 340:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 341:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( add_len == 0 )
 907              		.loc 1 341 7
 908 0027 48837D98 		cmpq	$0, -104(%rbp)
 908      00
GAS LISTING /tmp/ccuGp1Bp.s 			page 27


 909 002c 7507     		jne	.L65
 342:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         return( 0 );
 910              		.loc 1 342 15
 911 002e B8000000 		movl	$0, %eax
 911      00
 912 0033 EB51     		jmp	.L69
 913              	.L65:
 343:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 344:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( ( ret = block_cipher_df( add_input, additional, add_len ) ) != 0 )
 914              		.loc 1 344 17
 915 0035 488B5598 		movq	-104(%rbp), %rdx
 916 0039 488B4DA0 		movq	-96(%rbp), %rcx
 917 003d 488D45C0 		leaq	-64(%rbp), %rax
 918 0041 4889CE   		movq	%rcx, %rsi
 919 0044 4889C7   		movq	%rax, %rdi
 920 0047 E8000000 		call	block_cipher_df
 920      00
 921 004c 8945BC   		movl	%eax, -68(%rbp)
 922              		.loc 1 344 7
 923 004f 837DBC00 		cmpl	$0, -68(%rbp)
 924 0053 751C     		jne	.L71
 345:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         goto exit;
 346:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( ( ret = ctr_drbg_update_internal( ctx, add_input ) ) != 0 )
 925              		.loc 1 346 17
 926 0055 488D55C0 		leaq	-64(%rbp), %rdx
 927 0059 488B45A8 		movq	-88(%rbp), %rax
 928 005d 4889D6   		movq	%rdx, %rsi
 929 0060 4889C7   		movq	%rax, %rdi
 930 0063 E8000000 		call	ctr_drbg_update_internal
 930      00
 931 0068 8945BC   		movl	%eax, -68(%rbp)
 932              		.loc 1 346 7
 933 006b 837DBC00 		cmpl	$0, -68(%rbp)
 347:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         goto exit;
 348:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 349:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** exit:
 934              		.loc 1 349 1
 935 006f EB01     		jmp	.L68
 936              	.L71:
 345:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         goto exit;
 937              		.loc 1 345 9
 938 0071 90       		nop
 939              	.L68:
 350:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     mbedtls_platform_zeroize( add_input, sizeof( add_input ) );
 940              		.loc 1 350 5
 941 0072 488D45C0 		leaq	-64(%rbp), %rax
 942 0076 BE300000 		movl	$48, %esi
 942      00
 943 007b 4889C7   		movq	%rax, %rdi
 944 007e E8000000 		call	mbedtls_platform_zeroize@PLT
 944      00
 351:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     return( ret );
 945              		.loc 1 351 11
 946 0083 8B45BC   		movl	-68(%rbp), %eax
 947              	.L69:
 352:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** }
 948              		.loc 1 352 1 discriminator 1
GAS LISTING /tmp/ccuGp1Bp.s 			page 28


 949 0086 488B4DF8 		movq	-8(%rbp), %rcx
 950 008a 6448330C 		xorq	%fs:40, %rcx
 950      25280000 
 950      00
 951 0093 7405     		je	.L70
 952              		.loc 1 352 1 is_stmt 0
 953 0095 E8000000 		call	__stack_chk_fail@PLT
 953      00
 954              	.L70:
 955 009a C9       		leave
 956              	.LCFI29:
 957              		.cfi_def_cfa 7, 8
 958 009b C3       		ret
 959              		.cfi_endproc
 960              	.LFE9:
 962              		.section	.text.mbedtls_ctr_drbg_update,"ax",@progbits
 963              		.globl	mbedtls_ctr_drbg_update
 965              	mbedtls_ctr_drbg_update:
 966              	.LFB10:
 353:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 354:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #if !defined(MBEDTLS_DEPRECATED_REMOVED)
 355:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** void mbedtls_ctr_drbg_update( mbedtls_ctr_drbg_context *ctx,
 356:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                               const unsigned char *additional,
 357:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                               size_t add_len )
 358:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** {
 967              		.loc 1 358 1 is_stmt 1
 968              		.cfi_startproc
 969 0000 F30F1EFA 		endbr64
 970 0004 55       		pushq	%rbp
 971              	.LCFI30:
 972              		.cfi_def_cfa_offset 16
 973              		.cfi_offset 6, -16
 974 0005 4889E5   		movq	%rsp, %rbp
 975              	.LCFI31:
 976              		.cfi_def_cfa_register 6
 977 0008 4883EC30 		subq	$48, %rsp
 978 000c 48897DE8 		movq	%rdi, -24(%rbp)
 979 0010 488975E0 		movq	%rsi, -32(%rbp)
 980 0014 488955D8 		movq	%rdx, -40(%rbp)
 981              		.loc 1 358 1
 982 0018 64488B04 		movq	%fs:40, %rax
 982      25280000 
 982      00
 983 0021 488945F8 		movq	%rax, -8(%rbp)
 984 0025 31C0     		xorl	%eax, %eax
 359:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     /* MAX_INPUT would be more logical here, but we have to match
 360:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****      * block_cipher_df()'s limits since we can't propagate errors */
 361:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( add_len > MBEDTLS_CTR_DRBG_MAX_SEED_INPUT )
 985              		.loc 1 361 7
 986 0027 48817DD8 		cmpq	$384, -40(%rbp)
 986      80010000 
 987 002f 7608     		jbe	.L73
 362:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         add_len = MBEDTLS_CTR_DRBG_MAX_SEED_INPUT;
 988              		.loc 1 362 17
 989 0031 48C745D8 		movq	$384, -40(%rbp)
 989      80010000 
 990              	.L73:
GAS LISTING /tmp/ccuGp1Bp.s 			page 29


 363:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     (void) mbedtls_ctr_drbg_update_ret( ctx, additional, add_len );
 991              		.loc 1 363 12
 992 0039 488B55D8 		movq	-40(%rbp), %rdx
 993 003d 488B4DE0 		movq	-32(%rbp), %rcx
 994 0041 488B45E8 		movq	-24(%rbp), %rax
 995 0045 4889CE   		movq	%rcx, %rsi
 996 0048 4889C7   		movq	%rax, %rdi
 997 004b E8000000 		call	mbedtls_ctr_drbg_update_ret
 997      00
 364:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** }
 998              		.loc 1 364 1
 999 0050 90       		nop
 1000 0051 488B45F8 		movq	-8(%rbp), %rax
 1001 0055 64483304 		xorq	%fs:40, %rax
 1001      25280000 
 1001      00
 1002 005e 7405     		je	.L74
 1003 0060 E8000000 		call	__stack_chk_fail@PLT
 1003      00
 1004              	.L74:
 1005 0065 C9       		leave
 1006              	.LCFI32:
 1007              		.cfi_def_cfa 7, 8
 1008 0066 C3       		ret
 1009              		.cfi_endproc
 1010              	.LFE10:
 1012              		.section	.text.mbedtls_ctr_drbg_reseed,"ax",@progbits
 1013              		.globl	mbedtls_ctr_drbg_reseed
 1015              	mbedtls_ctr_drbg_reseed:
 1016              	.LFB11:
 365:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #endif /* MBEDTLS_DEPRECATED_REMOVED */
 366:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 367:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** /* CTR_DRBG_Reseed with derivation function (SP 800-90A &sect;10.2.1.4.2)
 368:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * mbedtls_ctr_drbg_reseed(ctx, additional, len)
 369:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * implements
 370:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * CTR_DRBG_Reseed(working_state, entropy_input, additional_input)
 371:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *                -> new_working_state
 372:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * with inputs
 373:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *   ctx contains working_state
 374:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *   additional[:len] = additional_input
 375:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * and entropy_input comes from calling ctx->f_entropy
 376:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * and with output
 377:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *   ctx contains new_working_state
 378:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  */
 379:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** int mbedtls_ctr_drbg_reseed( mbedtls_ctr_drbg_context *ctx,
 380:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                      const unsigned char *additional, size_t len )
 381:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** {
 1017              		.loc 1 381 1
 1018              		.cfi_startproc
 1019 0000 F30F1EFA 		endbr64
 1020 0004 55       		pushq	%rbp
 1021              	.LCFI33:
 1022              		.cfi_def_cfa_offset 16
 1023              		.cfi_offset 6, -16
 1024 0005 4889E5   		movq	%rsp, %rbp
 1025              	.LCFI34:
 1026              		.cfi_def_cfa_register 6
GAS LISTING /tmp/ccuGp1Bp.s 			page 30


 1027 0008 4881ECC0 		subq	$448, %rsp
 1027      010000
 1028 000f 4889BD58 		movq	%rdi, -424(%rbp)
 1028      FEFFFF
 1029 0016 4889B550 		movq	%rsi, -432(%rbp)
 1029      FEFFFF
 1030 001d 48899548 		movq	%rdx, -440(%rbp)
 1030      FEFFFF
 1031              		.loc 1 381 1
 1032 0024 64488B04 		movq	%fs:40, %rax
 1032      25280000 
 1032      00
 1033 002d 488945F8 		movq	%rax, -8(%rbp)
 1034 0031 31C0     		xorl	%eax, %eax
 382:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     unsigned char seed[MBEDTLS_CTR_DRBG_MAX_SEED_INPUT];
 383:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     size_t seedlen = 0;
 1035              		.loc 1 383 12
 1036 0033 48C78568 		movq	$0, -408(%rbp)
 1036      FEFFFF00 
 1036      000000
 384:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     int ret;
 385:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 386:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( ctx->entropy_len > MBEDTLS_CTR_DRBG_MAX_SEED_INPUT ||
 1037              		.loc 1 386 12
 1038 003e 488B8558 		movq	-424(%rbp), %rax
 1038      FEFFFF
 1039 0045 488B4018 		movq	24(%rax), %rax
 1040              		.loc 1 386 7
 1041 0049 483D8001 		cmpq	$384, %rax
 1041      0000
 1042 004f 771F     		ja	.L76
 387:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         len > MBEDTLS_CTR_DRBG_MAX_SEED_INPUT - ctx->entropy_len )
 1043              		.loc 1 387 52 discriminator 1
 1044 0051 488B8558 		movq	-424(%rbp), %rax
 1044      FEFFFF
 1045 0058 488B4018 		movq	24(%rax), %rax
 1046              		.loc 1 387 47 discriminator 1
 1047 005c BA800100 		movl	$384, %edx
 1047      00
 1048 0061 4829C2   		subq	%rax, %rdx
 1049 0064 4889D0   		movq	%rdx, %rax
 386:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         len > MBEDTLS_CTR_DRBG_MAX_SEED_INPUT - ctx->entropy_len )
 1050              		.loc 1 386 60 discriminator 1
 1051 0067 48398548 		cmpq	%rax, -440(%rbp)
 1051      FEFFFF
 1052 006e 760A     		jbe	.L77
 1053              	.L76:
 388:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         return( MBEDTLS_ERR_CTR_DRBG_INPUT_TOO_BIG );
 1054              		.loc 1 388 15
 1055 0070 B8C8FFFF 		movl	$-56, %eax
 1055      FF
 1056 0075 E9420100 		jmp	.L84
 1056      00
 1057              	.L77:
 389:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 390:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     memset( seed, 0, MBEDTLS_CTR_DRBG_MAX_SEED_INPUT );
 1058              		.loc 1 390 5
GAS LISTING /tmp/ccuGp1Bp.s 			page 31


 1059 007a 488D8570 		leaq	-400(%rbp), %rax
 1059      FEFFFF
 1060 0081 BA800100 		movl	$384, %edx
 1060      00
 1061 0086 BE000000 		movl	$0, %esi
 1061      00
 1062 008b 4889C7   		movq	%rax, %rdi
 1063 008e E8000000 		call	memset@PLT
 1063      00
 391:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 392:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     /*
 393:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****      * Gather entropy_len bytes of entropy to seed state
 394:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****      */
 395:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( 0 != ctx->f_entropy( ctx->p_entropy, seed,
 1064              		.loc 1 395 17
 1065 0093 488B8558 		movq	-424(%rbp), %rax
 1065      FEFFFF
 1066 009a 4C8B8048 		movq	328(%rax), %r8
 1066      010000
 1067              		.loc 1 395 14
 1068 00a1 488B8558 		movq	-424(%rbp), %rax
 1068      FEFFFF
 1069 00a8 488B5018 		movq	24(%rax), %rdx
 1070 00ac 488B8558 		movq	-424(%rbp), %rax
 1070      FEFFFF
 1071 00b3 488B8050 		movq	336(%rax), %rax
 1071      010000
 1072 00ba 488D8D70 		leaq	-400(%rbp), %rcx
 1072      FEFFFF
 1073 00c1 4889CE   		movq	%rcx, %rsi
 1074 00c4 4889C7   		movq	%rax, %rdi
 1075 00c7 41FFD0   		call	*%r8
 1076              	.LVL0:
 1077              		.loc 1 395 7
 1078 00ca 85C0     		testl	%eax, %eax
 1079 00cc 740A     		je	.L79
 396:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                              ctx->entropy_len ) )
 397:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     {
 398:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         return( MBEDTLS_ERR_CTR_DRBG_ENTROPY_SOURCE_FAILED );
 1080              		.loc 1 398 15
 1081 00ce B8CCFFFF 		movl	$-52, %eax
 1081      FF
 1082 00d3 E9E40000 		jmp	.L84
 1082      00
 1083              	.L79:
 399:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     }
 400:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 401:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     seedlen += ctx->entropy_len;
 1084              		.loc 1 401 19
 1085 00d8 488B8558 		movq	-424(%rbp), %rax
 1085      FEFFFF
 1086 00df 488B4018 		movq	24(%rax), %rax
 1087              		.loc 1 401 13
 1088 00e3 48018568 		addq	%rax, -408(%rbp)
 1088      FEFFFF
 402:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 403:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     /*
GAS LISTING /tmp/ccuGp1Bp.s 			page 32


 404:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****      * Add additional data
 405:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****      */
 406:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( additional && len )
 1089              		.loc 1 406 7
 1090 00ea 4883BD50 		cmpq	$0, -432(%rbp)
 1090      FEFFFF00 
 1091 00f2 7443     		je	.L80
 1092              		.loc 1 406 20 discriminator 1
 1093 00f4 4883BD48 		cmpq	$0, -440(%rbp)
 1093      FEFFFF00 
 1094 00fc 7439     		je	.L80
 407:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     {
 408:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         memcpy( seed + seedlen, additional, len );
 1095              		.loc 1 408 9
 1096 00fe 488D9570 		leaq	-400(%rbp), %rdx
 1096      FEFFFF
 1097 0105 488B8568 		movq	-408(%rbp), %rax
 1097      FEFFFF
 1098 010c 488D0C02 		leaq	(%rdx,%rax), %rcx
 1099 0110 488B9548 		movq	-440(%rbp), %rdx
 1099      FEFFFF
 1100 0117 488B8550 		movq	-432(%rbp), %rax
 1100      FEFFFF
 1101 011e 4889C6   		movq	%rax, %rsi
 1102 0121 4889CF   		movq	%rcx, %rdi
 1103 0124 E8000000 		call	memcpy@PLT
 1103      00
 409:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         seedlen += len;
 1104              		.loc 1 409 17
 1105 0129 488B8548 		movq	-440(%rbp), %rax
 1105      FEFFFF
 1106 0130 48018568 		addq	%rax, -408(%rbp)
 1106      FEFFFF
 1107              	.L80:
 410:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     }
 411:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 412:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     /*
 413:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****      * Reduce to 384 bits
 414:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****      */
 415:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( ( ret = block_cipher_df( seed, seed, seedlen ) ) != 0 )
 1108              		.loc 1 415 17
 1109 0137 488B9568 		movq	-408(%rbp), %rdx
 1109      FEFFFF
 1110 013e 488D8D70 		leaq	-400(%rbp), %rcx
 1110      FEFFFF
 1111 0145 488D8570 		leaq	-400(%rbp), %rax
 1111      FEFFFF
 1112 014c 4889CE   		movq	%rcx, %rsi
 1113 014f 4889C7   		movq	%rax, %rdi
 1114 0152 E8000000 		call	block_cipher_df
 1114      00
 1115 0157 898564FE 		movl	%eax, -412(%rbp)
 1115      FFFF
 1116              		.loc 1 415 7
 1117 015d 83BD64FE 		cmpl	$0, -412(%rbp)
 1117      FFFF00
 1118 0164 7538     		jne	.L86
GAS LISTING /tmp/ccuGp1Bp.s 			page 33


 416:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         goto exit;
 417:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 418:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     /*
 419:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****      * Update state
 420:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****      */
 421:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( ( ret = ctr_drbg_update_internal( ctx, seed ) ) != 0 )
 1119              		.loc 1 421 17
 1120 0166 488D9570 		leaq	-400(%rbp), %rdx
 1120      FEFFFF
 1121 016d 488B8558 		movq	-424(%rbp), %rax
 1121      FEFFFF
 1122 0174 4889D6   		movq	%rdx, %rsi
 1123 0177 4889C7   		movq	%rax, %rdi
 1124 017a E8000000 		call	ctr_drbg_update_internal
 1124      00
 1125 017f 898564FE 		movl	%eax, -412(%rbp)
 1125      FFFF
 1126              		.loc 1 421 7
 1127 0185 83BD64FE 		cmpl	$0, -412(%rbp)
 1127      FFFF00
 1128 018c 7513     		jne	.L87
 422:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         goto exit;
 423:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     ctx->reseed_counter = 1;
 1129              		.loc 1 423 25
 1130 018e 488B8558 		movq	-424(%rbp), %rax
 1130      FEFFFF
 1131 0195 C7401001 		movl	$1, 16(%rax)
 1131      000000
 1132 019c EB04     		jmp	.L82
 1133              	.L86:
 416:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         goto exit;
 1134              		.loc 1 416 9
 1135 019e 90       		nop
 1136 019f EB01     		jmp	.L82
 1137              	.L87:
 422:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         goto exit;
 1138              		.loc 1 422 9
 1139 01a1 90       		nop
 1140              	.L82:
 424:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 425:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** exit:
 426:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     mbedtls_platform_zeroize( seed, sizeof( seed ) );
 1141              		.loc 1 426 5
 1142 01a2 488D8570 		leaq	-400(%rbp), %rax
 1142      FEFFFF
 1143 01a9 BE800100 		movl	$384, %esi
 1143      00
 1144 01ae 4889C7   		movq	%rax, %rdi
 1145 01b1 E8000000 		call	mbedtls_platform_zeroize@PLT
 1145      00
 427:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     return( ret );
 1146              		.loc 1 427 11
 1147 01b6 8B8564FE 		movl	-412(%rbp), %eax
 1147      FFFF
 1148              	.L84:
 428:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** }
 1149              		.loc 1 428 1 discriminator 1
GAS LISTING /tmp/ccuGp1Bp.s 			page 34


 1150 01bc 488B4DF8 		movq	-8(%rbp), %rcx
 1151 01c0 6448330C 		xorq	%fs:40, %rcx
 1151      25280000 
 1151      00
 1152 01c9 7405     		je	.L85
 1153              		.loc 1 428 1 is_stmt 0
 1154 01cb E8000000 		call	__stack_chk_fail@PLT
 1154      00
 1155              	.L85:
 1156 01d0 C9       		leave
 1157              	.LCFI35:
 1158              		.cfi_def_cfa 7, 8
 1159 01d1 C3       		ret
 1160              		.cfi_endproc
 1161              	.LFE11:
 1163              		.section	.text.mbedtls_ctr_drbg_random_with_add,"ax",@progbits
 1164              		.globl	mbedtls_ctr_drbg_random_with_add
 1166              	mbedtls_ctr_drbg_random_with_add:
 1167              	.LFB12:
 429:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 430:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** /* CTR_DRBG_Generate with derivation function (SP 800-90A &sect;10.2.1.5.2)
 431:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * mbedtls_ctr_drbg_random_with_add(ctx, output, output_len, additional, add_len)
 432:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * implements
 433:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * CTR_DRBG_Reseed(working_state, entropy_input, additional[:add_len])
 434:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *                -> working_state_after_reseed
 435:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *                if required, then
 436:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * CTR_DRBG_Generate(working_state_after_reseed,
 437:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *                   requested_number_of_bits, additional_input)
 438:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *                -> status, returned_bits, new_working_state
 439:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * with inputs
 440:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *   ctx contains working_state
 441:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *   requested_number_of_bits = 8 * output_len
 442:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *   additional[:add_len] = additional_input
 443:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * and entropy_input comes from calling ctx->f_entropy
 444:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  * and with outputs
 445:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *   status = SUCCESS (this function does the reseed internally)
 446:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *   returned_bits = output[:output_len]
 447:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  *   ctx contains new_working_state
 448:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****  */
 449:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** int mbedtls_ctr_drbg_random_with_add( void *p_rng,
 450:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                               unsigned char *output, size_t output_len,
 451:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                               const unsigned char *additional, size_t add_len )
 452:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** {
 1168              		.loc 1 452 1 is_stmt 1
 1169              		.cfi_startproc
 1170 0000 F30F1EFA 		endbr64
 1171 0004 55       		pushq	%rbp
 1172              	.LCFI36:
 1173              		.cfi_def_cfa_offset 16
 1174              		.cfi_offset 6, -16
 1175 0005 4889E5   		movq	%rsp, %rbp
 1176              	.LCFI37:
 1177              		.cfi_def_cfa_register 6
 1178 0008 4881ECA0 		subq	$160, %rsp
 1178      000000
 1179 000f 48897D88 		movq	%rdi, -120(%rbp)
 1180 0013 48897580 		movq	%rsi, -128(%rbp)
GAS LISTING /tmp/ccuGp1Bp.s 			page 35


 1181 0017 48899578 		movq	%rdx, -136(%rbp)
 1181      FFFFFF
 1182 001e 48898D70 		movq	%rcx, -144(%rbp)
 1182      FFFFFF
 1183 0025 4C898568 		movq	%r8, -152(%rbp)
 1183      FFFFFF
 1184              		.loc 1 452 1
 1185 002c 64488B04 		movq	%fs:40, %rax
 1185      25280000 
 1185      00
 1186 0035 488945F8 		movq	%rax, -8(%rbp)
 1187 0039 31C0     		xorl	%eax, %eax
 453:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     int ret = 0;
 1188              		.loc 1 453 9
 1189 003b C7459400 		movl	$0, -108(%rbp)
 1189      000000
 454:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     mbedtls_ctr_drbg_context *ctx = (mbedtls_ctr_drbg_context *) p_rng;
 1190              		.loc 1 454 31
 1191 0042 488B4588 		movq	-120(%rbp), %rax
 1192 0046 488945A0 		movq	%rax, -96(%rbp)
 455:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     unsigned char add_input[MBEDTLS_CTR_DRBG_SEEDLEN];
 456:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     unsigned char *p = output;
 1193              		.loc 1 456 20
 1194 004a 488B4580 		movq	-128(%rbp), %rax
 1195 004e 48894598 		movq	%rax, -104(%rbp)
 457:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     unsigned char tmp[MBEDTLS_CTR_DRBG_BLOCKSIZE];
 458:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     int i;
 459:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     size_t use_len;
 460:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 461:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( output_len > MBEDTLS_CTR_DRBG_MAX_REQUEST )
 1196              		.loc 1 461 7
 1197 0052 4881BD78 		cmpq	$1024, -136(%rbp)
 1197      FFFFFF00 
 1197      040000
 1198 005d 760A     		jbe	.L89
 462:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         return( MBEDTLS_ERR_CTR_DRBG_REQUEST_TOO_BIG );
 1199              		.loc 1 462 15
 1200 005f B8CAFFFF 		movl	$-54, %eax
 1200      FF
 1201 0064 E9010200 		jmp	.L106
 1201      00
 1202              	.L89:
 463:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 464:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( add_len > MBEDTLS_CTR_DRBG_MAX_INPUT )
 1203              		.loc 1 464 7
 1204 0069 4881BD68 		cmpq	$256, -152(%rbp)
 1204      FFFFFF00 
 1204      010000
 1205 0074 760A     		jbe	.L91
 465:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         return( MBEDTLS_ERR_CTR_DRBG_INPUT_TOO_BIG );
 1206              		.loc 1 465 15
 1207 0076 B8C8FFFF 		movl	$-56, %eax
 1207      FF
 1208 007b E9EA0100 		jmp	.L106
 1208      00
 1209              	.L91:
 466:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
GAS LISTING /tmp/ccuGp1Bp.s 			page 36


 467:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     memset( add_input, 0, MBEDTLS_CTR_DRBG_SEEDLEN );
 1210              		.loc 1 467 5
 1211 0080 488D45C0 		leaq	-64(%rbp), %rax
 1212 0084 BA300000 		movl	$48, %edx
 1212      00
 1213 0089 BE000000 		movl	$0, %esi
 1213      00
 1214 008e 4889C7   		movq	%rax, %rdi
 1215 0091 E8000000 		call	memset@PLT
 1215      00
 468:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 469:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( ctx->reseed_counter > ctx->reseed_interval ||
 1216              		.loc 1 469 12
 1217 0096 488B45A0 		movq	-96(%rbp), %rax
 1218 009a 8B5010   		movl	16(%rax), %edx
 1219              		.loc 1 469 34
 1220 009d 488B45A0 		movq	-96(%rbp), %rax
 1221 00a1 8B4020   		movl	32(%rax), %eax
 1222              		.loc 1 469 7
 1223 00a4 39C2     		cmpl	%eax, %edx
 1224 00a6 7F0B     		jg	.L92
 470:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         ctx->prediction_resistance )
 1225              		.loc 1 470 12 discriminator 1
 1226 00a8 488B45A0 		movq	-96(%rbp), %rax
 1227 00ac 8B4014   		movl	20(%rax), %eax
 469:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         ctx->prediction_resistance )
 1228              		.loc 1 469 52 discriminator 1
 1229 00af 85C0     		testl	%eax, %eax
 1230 00b1 7439     		je	.L93
 1231              	.L92:
 471:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     {
 472:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         if( ( ret = mbedtls_ctr_drbg_reseed( ctx, additional, add_len ) ) != 0 )
 1232              		.loc 1 472 21
 1233 00b3 488B9568 		movq	-152(%rbp), %rdx
 1233      FFFFFF
 1234 00ba 488B8D70 		movq	-144(%rbp), %rcx
 1234      FFFFFF
 1235 00c1 488B45A0 		movq	-96(%rbp), %rax
 1236 00c5 4889CE   		movq	%rcx, %rsi
 1237 00c8 4889C7   		movq	%rax, %rdi
 1238 00cb E8000000 		call	mbedtls_ctr_drbg_reseed
 1238      00
 1239 00d0 894594   		movl	%eax, -108(%rbp)
 1240              		.loc 1 472 11
 1241 00d3 837D9400 		cmpl	$0, -108(%rbp)
 1242 00d7 7408     		je	.L94
 473:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         {
 474:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****             return( ret );
 1243              		.loc 1 474 19
 1244 00d9 8B4594   		movl	-108(%rbp), %eax
 1245 00dc E9890100 		jmp	.L106
 1245      00
 1246              	.L94:
 475:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         }
 476:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         add_len = 0;
 1247              		.loc 1 476 17
 1248 00e1 48C78568 		movq	$0, -152(%rbp)
GAS LISTING /tmp/ccuGp1Bp.s 			page 37


 1248      FFFFFF00 
 1248      000000
 1249              	.L93:
 477:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     }
 478:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 479:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( add_len > 0 )
 1250              		.loc 1 479 7
 1251 00ec 4883BD68 		cmpq	$0, -152(%rbp)
 1251      FFFFFF00 
 1252 00f4 0F840201 		je	.L98
 1252      0000
 480:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     {
 481:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         if( ( ret = block_cipher_df( add_input, additional, add_len ) ) != 0 )
 1253              		.loc 1 481 21
 1254 00fa 488B9568 		movq	-152(%rbp), %rdx
 1254      FFFFFF
 1255 0101 488B8D70 		movq	-144(%rbp), %rcx
 1255      FFFFFF
 1256 0108 488D45C0 		leaq	-64(%rbp), %rax
 1257 010c 4889CE   		movq	%rcx, %rsi
 1258 010f 4889C7   		movq	%rax, %rdi
 1259 0112 E8000000 		call	block_cipher_df
 1259      00
 1260 0117 894594   		movl	%eax, -108(%rbp)
 1261              		.loc 1 481 11
 1262 011a 837D9400 		cmpl	$0, -108(%rbp)
 1263 011e 0F851501 		jne	.L108
 1263      0000
 482:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****             goto exit;
 483:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         if( ( ret = ctr_drbg_update_internal( ctx, add_input ) ) != 0 )
 1264              		.loc 1 483 21
 1265 0124 488D55C0 		leaq	-64(%rbp), %rdx
 1266 0128 488B45A0 		movq	-96(%rbp), %rax
 1267 012c 4889D6   		movq	%rdx, %rsi
 1268 012f 4889C7   		movq	%rax, %rdi
 1269 0132 E8000000 		call	ctr_drbg_update_internal
 1269      00
 1270 0137 894594   		movl	%eax, -108(%rbp)
 1271              		.loc 1 483 11
 1272 013a 837D9400 		cmpl	$0, -108(%rbp)
 1273 013e 0F85F800 		jne	.L109
 1273      0000
 484:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****             goto exit;
 485:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     }
 486:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 487:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     while( output_len > 0 )
 1274              		.loc 1 487 10
 1275 0144 E9B30000 		jmp	.L98
 1275      00
 1276              	.L104:
 488:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     {
 489:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         /*
 490:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****          * Increase counter
 491:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****          */
 492:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         for( i = MBEDTLS_CTR_DRBG_BLOCKSIZE; i > 0; i-- )
 1277              		.loc 1 492 16
 1278 0149 C7459010 		movl	$16, -112(%rbp)
GAS LISTING /tmp/ccuGp1Bp.s 			page 38


 1278      000000
 1279              		.loc 1 492 9
 1280 0150 EB31     		jmp	.L99
 1281              	.L102:
 493:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****             if( ++ctx->counter[i - 1] != 0 )
 1282              		.loc 1 493 34
 1283 0152 8B4590   		movl	-112(%rbp), %eax
 1284 0155 83E801   		subl	$1, %eax
 1285              		.loc 1 493 31
 1286 0158 488B4DA0 		movq	-96(%rbp), %rcx
 1287 015c 4863D0   		movslq	%eax, %rdx
 1288 015f 0FB61411 		movzbl	(%rcx,%rdx), %edx
 1289              		.loc 1 493 17
 1290 0163 8D7201   		leal	1(%rdx), %esi
 1291              		.loc 1 493 15
 1292 0166 488B4DA0 		movq	-96(%rbp), %rcx
 1293 016a 4863D0   		movslq	%eax, %rdx
 1294 016d 40883411 		movb	%sil, (%rcx,%rdx)
 1295              		.loc 1 493 31
 1296 0171 488B55A0 		movq	-96(%rbp), %rdx
 1297 0175 4898     		cltq
 1298 0177 0FB60402 		movzbl	(%rdx,%rax), %eax
 1299              		.loc 1 493 15
 1300 017b 84C0     		testb	%al, %al
 1301 017d 750C     		jne	.L110
 492:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****             if( ++ctx->counter[i - 1] != 0 )
 1302              		.loc 1 492 54 discriminator 2
 1303 017f 836D9001 		subl	$1, -112(%rbp)
 1304              	.L99:
 492:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****             if( ++ctx->counter[i - 1] != 0 )
 1305              		.loc 1 492 9 discriminator 1
 1306 0183 837D9000 		cmpl	$0, -112(%rbp)
 1307 0187 7FC9     		jg	.L102
 1308 0189 EB01     		jmp	.L101
 1309              	.L110:
 494:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                 break;
 1310              		.loc 1 494 17
 1311 018b 90       		nop
 1312              	.L101:
 495:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 496:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         /*
 497:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****          * Crypt counter block
 498:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****          */
 499:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         if( ( ret = mbedtls_aes_crypt_ecb( &ctx->aes_ctx, MBEDTLS_AES_ENCRYPT, ctx->counter, tmp ) 
 1313              		.loc 1 499 83
 1314 018c 488B45A0 		movq	-96(%rbp), %rax
 1315              		.loc 1 499 21
 1316 0190 488B55A0 		movq	-96(%rbp), %rdx
 1317 0194 488D7A28 		leaq	40(%rdx), %rdi
 1318 0198 488D55B0 		leaq	-80(%rbp), %rdx
 1319 019c 4889D1   		movq	%rdx, %rcx
 1320 019f 4889C2   		movq	%rax, %rdx
 1321 01a2 BE010000 		movl	$1, %esi
 1321      00
 1322 01a7 E8000000 		call	mbedtls_aes_crypt_ecb@PLT
 1322      00
 1323 01ac 894594   		movl	%eax, -108(%rbp)
GAS LISTING /tmp/ccuGp1Bp.s 			page 39


 1324              		.loc 1 499 11
 1325 01af 837D9400 		cmpl	$0, -108(%rbp)
 1326 01b3 0F858600 		jne	.L111
 1326      0000
 500:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****             goto exit;
 501:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 502:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         use_len = ( output_len > MBEDTLS_CTR_DRBG_BLOCKSIZE ) ? MBEDTLS_CTR_DRBG_BLOCKSIZE :
 1327              		.loc 1 502 17
 1328 01b9 B8100000 		movl	$16, %eax
 1328      00
 1329 01be 4883BD78 		cmpq	$16, -136(%rbp)
 1329      FFFFFF10 
 1330 01c6 480F4685 		cmovbe	-136(%rbp), %rax
 1330      78FFFFFF 
 1331 01ce 488945A8 		movq	%rax, -88(%rbp)
 503:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****                                                        output_len;
 504:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         /*
 505:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****          * Copy random block to destination
 506:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****          */
 507:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         memcpy( p, tmp, use_len );
 1332              		.loc 1 507 9
 1333 01d2 488B55A8 		movq	-88(%rbp), %rdx
 1334 01d6 488D4DB0 		leaq	-80(%rbp), %rcx
 1335 01da 488B4598 		movq	-104(%rbp), %rax
 1336 01de 4889CE   		movq	%rcx, %rsi
 1337 01e1 4889C7   		movq	%rax, %rdi
 1338 01e4 E8000000 		call	memcpy@PLT
 1338      00
 508:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         p += use_len;
 1339              		.loc 1 508 11
 1340 01e9 488B45A8 		movq	-88(%rbp), %rax
 1341 01ed 48014598 		addq	%rax, -104(%rbp)
 509:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         output_len -= use_len;
 1342              		.loc 1 509 20
 1343 01f1 488B45A8 		movq	-88(%rbp), %rax
 1344 01f5 48298578 		subq	%rax, -136(%rbp)
 1344      FFFFFF
 1345              	.L98:
 487:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     {
 1346              		.loc 1 487 10
 1347 01fc 4883BD78 		cmpq	$0, -136(%rbp)
 1347      FFFFFF00 
 1348 0204 0F853FFF 		jne	.L104
 1348      FFFF
 510:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     }
 511:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 512:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( ( ret = ctr_drbg_update_internal( ctx, add_input ) ) != 0 )
 1349              		.loc 1 512 17
 1350 020a 488D55C0 		leaq	-64(%rbp), %rdx
 1351 020e 488B45A0 		movq	-96(%rbp), %rax
 1352 0212 4889D6   		movq	%rdx, %rsi
 1353 0215 4889C7   		movq	%rax, %rdi
 1354 0218 E8000000 		call	ctr_drbg_update_internal
 1354      00
 1355 021d 894594   		movl	%eax, -108(%rbp)
 1356              		.loc 1 512 7
 1357 0220 837D9400 		cmpl	$0, -108(%rbp)
GAS LISTING /tmp/ccuGp1Bp.s 			page 40


 1358 0224 751C     		jne	.L112
 513:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         goto exit;
 514:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 515:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     ctx->reseed_counter++;
 1359              		.loc 1 515 8
 1360 0226 488B45A0 		movq	-96(%rbp), %rax
 1361 022a 8B4010   		movl	16(%rax), %eax
 1362              		.loc 1 515 24
 1363 022d 8D5001   		leal	1(%rax), %edx
 1364 0230 488B45A0 		movq	-96(%rbp), %rax
 1365 0234 895010   		movl	%edx, 16(%rax)
 1366 0237 EB0A     		jmp	.L97
 1367              	.L108:
 482:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         if( ( ret = ctr_drbg_update_internal( ctx, add_input ) ) != 0 )
 1368              		.loc 1 482 13
 1369 0239 90       		nop
 1370 023a EB07     		jmp	.L97
 1371              	.L109:
 484:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     }
 1372              		.loc 1 484 13
 1373 023c 90       		nop
 1374 023d EB04     		jmp	.L97
 1375              	.L111:
 500:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 1376              		.loc 1 500 13
 1377 023f 90       		nop
 1378 0240 EB01     		jmp	.L97
 1379              	.L112:
 513:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 1380              		.loc 1 513 9
 1381 0242 90       		nop
 1382              	.L97:
 516:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 517:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** exit:
 518:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     mbedtls_platform_zeroize( add_input, sizeof( add_input ) );
 1383              		.loc 1 518 5
 1384 0243 488D45C0 		leaq	-64(%rbp), %rax
 1385 0247 BE300000 		movl	$48, %esi
 1385      00
 1386 024c 4889C7   		movq	%rax, %rdi
 1387 024f E8000000 		call	mbedtls_platform_zeroize@PLT
 1387      00
 519:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     mbedtls_platform_zeroize( tmp, sizeof( tmp ) );
 1388              		.loc 1 519 5
 1389 0254 488D45B0 		leaq	-80(%rbp), %rax
 1390 0258 BE100000 		movl	$16, %esi
 1390      00
 1391 025d 4889C7   		movq	%rax, %rdi
 1392 0260 E8000000 		call	mbedtls_platform_zeroize@PLT
 1392      00
 520:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     return( 0 );
 1393              		.loc 1 520 11
 1394 0265 B8000000 		movl	$0, %eax
 1394      00
 1395              	.L106:
 521:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** }
 1396              		.loc 1 521 1 discriminator 1
GAS LISTING /tmp/ccuGp1Bp.s 			page 41


 1397 026a 488B4DF8 		movq	-8(%rbp), %rcx
 1398 026e 6448330C 		xorq	%fs:40, %rcx
 1398      25280000 
 1398      00
 1399 0277 7405     		je	.L107
 1400              		.loc 1 521 1 is_stmt 0
 1401 0279 E8000000 		call	__stack_chk_fail@PLT
 1401      00
 1402              	.L107:
 1403 027e C9       		leave
 1404              	.LCFI38:
 1405              		.cfi_def_cfa 7, 8
 1406 027f C3       		ret
 1407              		.cfi_endproc
 1408              	.LFE12:
 1410              		.section	.text.mbedtls_ctr_drbg_random,"ax",@progbits
 1411              		.globl	mbedtls_ctr_drbg_random
 1413              	mbedtls_ctr_drbg_random:
 1414              	.LFB13:
 522:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 523:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** int mbedtls_ctr_drbg_random( void *p_rng, unsigned char *output, size_t output_len )
 524:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** {
 1415              		.loc 1 524 1 is_stmt 1
 1416              		.cfi_startproc
 1417 0000 F30F1EFA 		endbr64
 1418 0004 55       		pushq	%rbp
 1419              	.LCFI39:
 1420              		.cfi_def_cfa_offset 16
 1421              		.cfi_offset 6, -16
 1422 0005 4889E5   		movq	%rsp, %rbp
 1423              	.LCFI40:
 1424              		.cfi_def_cfa_register 6
 1425 0008 4883EC40 		subq	$64, %rsp
 1426 000c 48897DD8 		movq	%rdi, -40(%rbp)
 1427 0010 488975D0 		movq	%rsi, -48(%rbp)
 1428 0014 488955C8 		movq	%rdx, -56(%rbp)
 1429              		.loc 1 524 1
 1430 0018 64488B04 		movq	%fs:40, %rax
 1430      25280000 
 1430      00
 1431 0021 488945F8 		movq	%rax, -8(%rbp)
 1432 0025 31C0     		xorl	%eax, %eax
 525:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     int ret;
 526:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     mbedtls_ctr_drbg_context *ctx = (mbedtls_ctr_drbg_context *) p_rng;
 1433              		.loc 1 526 31
 1434 0027 488B45D8 		movq	-40(%rbp), %rax
 1435 002b 488945F0 		movq	%rax, -16(%rbp)
 527:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 528:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #if defined(MBEDTLS_THREADING_C)
 529:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( ( ret = mbedtls_mutex_lock( &ctx->mutex ) ) != 0 )
 530:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         return( ret );
 531:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #endif
 532:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 533:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     ret = mbedtls_ctr_drbg_random_with_add( ctx, output, output_len, NULL, 0 );
 1436              		.loc 1 533 11
 1437 002f 488B55C8 		movq	-56(%rbp), %rdx
 1438 0033 488B75D0 		movq	-48(%rbp), %rsi
GAS LISTING /tmp/ccuGp1Bp.s 			page 42


 1439 0037 488B45F0 		movq	-16(%rbp), %rax
 1440 003b 41B80000 		movl	$0, %r8d
 1440      0000
 1441 0041 B9000000 		movl	$0, %ecx
 1441      00
 1442 0046 4889C7   		movq	%rax, %rdi
 1443 0049 E8000000 		call	mbedtls_ctr_drbg_random_with_add
 1443      00
 1444 004e 8945EC   		movl	%eax, -20(%rbp)
 534:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 535:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #if defined(MBEDTLS_THREADING_C)
 536:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     if( mbedtls_mutex_unlock( &ctx->mutex ) != 0 )
 537:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****         return( MBEDTLS_ERR_THREADING_MUTEX_ERROR );
 538:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** #endif
 539:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** 
 540:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c ****     return( ret );
 1445              		.loc 1 540 11
 1446 0051 8B45EC   		movl	-20(%rbp), %eax
 541:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ctr_drbg.c **** }
 1447              		.loc 1 541 1
 1448 0054 488B4DF8 		movq	-8(%rbp), %rcx
 1449 0058 6448330C 		xorq	%fs:40, %rcx
 1449      25280000 
 1449      00
 1450 0061 7405     		je	.L115
 1451 0063 E8000000 		call	__stack_chk_fail@PLT
 1451      00
 1452              	.L115:
 1453 0068 C9       		leave
 1454              	.LCFI41:
 1455              		.cfi_def_cfa 7, 8
 1456 0069 C3       		ret
 1457              		.cfi_endproc
 1458              	.LFE13:
 1460              		.text
 1461              	.Letext0:
 1462              		.file 2 "/usr/lib/gcc/x86_64-linux-gnu/9/include/stddef.h"
 1463              		.file 3 "/usr/include/x86_64-linux-gnu/bits/types.h"
 1464              		.file 4 "/usr/include/x86_64-linux-gnu/bits/stdint-uintn.h"
 1465              		.file 5 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/aes.h"
 1466              		.file 6 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ctr_drb
 3677              		.section	.note.gnu.property,"a"
 3678              		.align 8
 3679 0000 04000000 		.long	 1f - 0f
 3680 0004 10000000 		.long	 4f - 1f
 3681 0008 05000000 		.long	 5
 3682              	0:
 3683 000c 474E5500 		.string	 "GNU"
 3684              	1:
 3685              		.align 8
 3686 0010 020000C0 		.long	 0xc0000002
 3687 0014 04000000 		.long	 3f - 2f
 3688              	2:
 3689 0018 03000000 		.long	 0x3
 3690              	3:
 3691 001c 00000000 		.align 8
 3692              	4:
GAS LISTING /tmp/ccuGp1Bp.s 			page 43


GAS LISTING /tmp/ccuGp1Bp.s 			page 44


DEFINED SYMBOLS
                            *ABS*:0000000000000000 ctr_drbg.c
     /tmp/ccuGp1Bp.s:7      .text.mbedtls_ctr_drbg_init:0000000000000000 mbedtls_ctr_drbg_init
     /tmp/ccuGp1Bp.s:49     .text.mbedtls_ctr_drbg_seed_entropy_len:0000000000000000 mbedtls_ctr_drbg_seed_entropy_len
     /tmp/ccuGp1Bp.s:1015   .text.mbedtls_ctr_drbg_reseed:0000000000000000 mbedtls_ctr_drbg_reseed
     /tmp/ccuGp1Bp.s:149    .text.mbedtls_ctr_drbg_seed:0000000000000000 mbedtls_ctr_drbg_seed
     /tmp/ccuGp1Bp.s:197    .text.mbedtls_ctr_drbg_free:0000000000000000 mbedtls_ctr_drbg_free
     /tmp/ccuGp1Bp.s:249    .text.mbedtls_ctr_drbg_set_prediction_resistance:0000000000000000 mbedtls_ctr_drbg_set_prediction_resistance
     /tmp/ccuGp1Bp.s:289    .text.mbedtls_ctr_drbg_set_entropy_len:0000000000000000 mbedtls_ctr_drbg_set_entropy_len
     /tmp/ccuGp1Bp.s:329    .text.mbedtls_ctr_drbg_set_reseed_interval:0000000000000000 mbedtls_ctr_drbg_set_reseed_interval
     /tmp/ccuGp1Bp.s:368    .text.block_cipher_df:0000000000000000 block_cipher_df
     /tmp/ccuGp1Bp.s:713    .text.ctr_drbg_update_internal:0000000000000000 ctr_drbg_update_internal
     /tmp/ccuGp1Bp.s:887    .text.mbedtls_ctr_drbg_update_ret:0000000000000000 mbedtls_ctr_drbg_update_ret
     /tmp/ccuGp1Bp.s:965    .text.mbedtls_ctr_drbg_update:0000000000000000 mbedtls_ctr_drbg_update
     /tmp/ccuGp1Bp.s:1166   .text.mbedtls_ctr_drbg_random_with_add:0000000000000000 mbedtls_ctr_drbg_random_with_add
     /tmp/ccuGp1Bp.s:1413   .text.mbedtls_ctr_drbg_random:0000000000000000 mbedtls_ctr_drbg_random

UNDEFINED SYMBOLS
_GLOBAL_OFFSET_TABLE_
memset
__stack_chk_fail
mbedtls_aes_init
mbedtls_aes_setkey_enc
mbedtls_aes_free
mbedtls_platform_zeroize
memcpy
mbedtls_aes_crypt_ecb
