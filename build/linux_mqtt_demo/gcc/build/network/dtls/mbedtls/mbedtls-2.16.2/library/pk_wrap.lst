GAS LISTING /tmp/ccCBR1Ba.s 			page 1


   1              		.file	"pk_wrap.c"
   2              		.text
   3              	.Ltext0:
   4              		.section	.text.rsa_can_do,"ax",@progbits
   6              	rsa_can_do:
   7              	.LFB9:
   8              		.file 1 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c"
   1:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** /*
   2:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  *  Public Key abstraction layer: wrapper functions
   3:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  *
   4:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  *  Copyright (C) 2006-2015, ARM Limited, All Rights Reserved
   5:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  *  SPDX-License-Identifier: Apache-2.0
   6:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  *
   7:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  *  Licensed under the Apache License, Version 2.0 (the "License"); you may
   8:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  *  not use this file except in compliance with the License.
   9:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  *  You may obtain a copy of the License at
  10:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  *
  11:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  *  http://www.apache.org/licenses/LICENSE-2.0
  12:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  *
  13:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  *  Unless required by applicable law or agreed to in writing, software
  14:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  *  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  15:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  16:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  *  See the License for the specific language governing permissions and
  17:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  *  limitations under the License.
  18:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  *
  19:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  *  This file is part of mbed TLS (https://tls.mbed.org)
  20:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  */
  21:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
  22:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if !defined(MBEDTLS_CONFIG_FILE)
  23:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #include "mbedtls/config.h"
  24:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #else
  25:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #include MBEDTLS_CONFIG_FILE
  26:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif
  27:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
  28:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if defined(MBEDTLS_PK_C)
  29:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #include "mbedtls/pk_internal.h"
  30:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
  31:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** /* Even if RSA not activated, for the sake of RSA-alt */
  32:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #include "mbedtls/rsa.h"
  33:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
  34:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #include <string.h>
  35:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
  36:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if defined(MBEDTLS_ECP_C)
  37:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #include "mbedtls/ecp.h"
  38:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif
  39:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
  40:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if defined(MBEDTLS_ECDSA_C)
  41:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #include "mbedtls/ecdsa.h"
  42:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif
  43:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
  44:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if defined(MBEDTLS_PK_RSA_ALT_SUPPORT)
  45:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #include "mbedtls/platform_util.h"
  46:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif
  47:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
  48:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if defined(MBEDTLS_PLATFORM_C)
  49:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #include "mbedtls/platform.h"
  50:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #else
GAS LISTING /tmp/ccCBR1Ba.s 			page 2


  51:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #include <stdlib.h>
  52:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #define mbedtls_calloc    calloc
  53:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #define mbedtls_free       free
  54:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif
  55:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
  56:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #include <limits.h>
  57:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #include <stdint.h>
  58:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
  59:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if defined(MBEDTLS_RSA_C)
  60:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int rsa_can_do( mbedtls_pk_type_t type )
  61:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
   9              		.loc 1 61 1
  10              		.cfi_startproc
  11 0000 F30F1EFA 		endbr64
  12 0004 55       		pushq	%rbp
  13              	.LCFI0:
  14              		.cfi_def_cfa_offset 16
  15              		.cfi_offset 6, -16
  16 0005 4889E5   		movq	%rsp, %rbp
  17              	.LCFI1:
  18              		.cfi_def_cfa_register 6
  19 0008 4883EC20 		subq	$32, %rsp
  20 000c 897DEC   		movl	%edi, -20(%rbp)
  21              		.loc 1 61 1
  22 000f 64488B04 		movq	%fs:40, %rax
  22      25280000 
  22      00
  23 0018 488945F8 		movq	%rax, -8(%rbp)
  24 001c 31C0     		xorl	%eax, %eax
  62:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( type == MBEDTLS_PK_RSA ||
  25              		.loc 1 62 36
  26 001e 837DEC01 		cmpl	$1, -20(%rbp)
  27 0022 7406     		je	.L2
  28              		.loc 1 62 36 is_stmt 0 discriminator 2
  29 0024 837DEC06 		cmpl	$6, -20(%rbp)
  30 0028 7507     		jne	.L3
  31              	.L2:
  32              		.loc 1 62 36 discriminator 3
  33 002a B8010000 		movl	$1, %eax
  33      00
  34 002f EB05     		jmp	.L5
  35              	.L3:
  36              		.loc 1 62 36 discriminator 4
  37 0031 B8000000 		movl	$0, %eax
  37      00
  38              	.L5:
  63:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****             type == MBEDTLS_PK_RSASSA_PSS );
  64:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
  39              		.loc 1 64 1 is_stmt 1 discriminator 7
  40 0036 488B55F8 		movq	-8(%rbp), %rdx
  41 003a 64483314 		xorq	%fs:40, %rdx
  41      25280000 
  41      00
  42 0043 7405     		je	.L6
  43              		.loc 1 64 1 is_stmt 0
  44 0045 E8000000 		call	__stack_chk_fail@PLT
  44      00
GAS LISTING /tmp/ccCBR1Ba.s 			page 3


  45              	.L6:
  46 004a C9       		leave
  47              	.LCFI2:
  48              		.cfi_def_cfa 7, 8
  49 004b C3       		ret
  50              		.cfi_endproc
  51              	.LFE9:
  53              		.section	.text.rsa_get_bitlen,"ax",@progbits
  55              	rsa_get_bitlen:
  56              	.LFB10:
  65:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
  66:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static size_t rsa_get_bitlen( const void *ctx )
  67:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
  57              		.loc 1 67 1 is_stmt 1
  58              		.cfi_startproc
  59 0000 F30F1EFA 		endbr64
  60 0004 55       		pushq	%rbp
  61              	.LCFI3:
  62              		.cfi_def_cfa_offset 16
  63              		.cfi_offset 6, -16
  64 0005 4889E5   		movq	%rsp, %rbp
  65              	.LCFI4:
  66              		.cfi_def_cfa_register 6
  67 0008 4883EC20 		subq	$32, %rsp
  68 000c 48897DE8 		movq	%rdi, -24(%rbp)
  69              		.loc 1 67 1
  70 0010 64488B04 		movq	%fs:40, %rax
  70      25280000 
  70      00
  71 0019 488945F8 		movq	%rax, -8(%rbp)
  72 001d 31C0     		xorl	%eax, %eax
  68:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     const mbedtls_rsa_context * rsa = (const mbedtls_rsa_context *) ctx;
  73              		.loc 1 68 33
  74 001f 488B45E8 		movq	-24(%rbp), %rax
  75 0023 488945F0 		movq	%rax, -16(%rbp)
  69:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( 8 * mbedtls_rsa_get_len( rsa ) );
  76              		.loc 1 69 17
  77 0027 488B45F0 		movq	-16(%rbp), %rax
  78 002b 4889C7   		movq	%rax, %rdi
  79 002e E8000000 		call	mbedtls_rsa_get_len@PLT
  79      00
  80              		.loc 1 69 15
  81 0033 48C1E003 		salq	$3, %rax
  70:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
  82              		.loc 1 70 1
  83 0037 488B55F8 		movq	-8(%rbp), %rdx
  84 003b 64483314 		xorq	%fs:40, %rdx
  84      25280000 
  84      00
  85 0044 7405     		je	.L9
  86 0046 E8000000 		call	__stack_chk_fail@PLT
  86      00
  87              	.L9:
  88 004b C9       		leave
  89              	.LCFI5:
  90              		.cfi_def_cfa 7, 8
  91 004c C3       		ret
GAS LISTING /tmp/ccCBR1Ba.s 			page 4


  92              		.cfi_endproc
  93              	.LFE10:
  95              		.section	.text.rsa_verify_wrap,"ax",@progbits
  97              	rsa_verify_wrap:
  98              	.LFB11:
  71:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
  72:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int rsa_verify_wrap( void *ctx, mbedtls_md_type_t md_alg,
  73:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    const unsigned char *hash, size_t hash_len,
  74:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    const unsigned char *sig, size_t sig_len )
  75:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
  99              		.loc 1 75 1
 100              		.cfi_startproc
 101 0000 F30F1EFA 		endbr64
 102 0004 55       		pushq	%rbp
 103              	.LCFI6:
 104              		.cfi_def_cfa_offset 16
 105              		.cfi_offset 6, -16
 106 0005 4889E5   		movq	%rsp, %rbp
 107              	.LCFI7:
 108              		.cfi_def_cfa_register 6
 109 0008 4883EC50 		subq	$80, %rsp
 110 000c 48897DD8 		movq	%rdi, -40(%rbp)
 111 0010 8975D4   		movl	%esi, -44(%rbp)
 112 0013 488955C8 		movq	%rdx, -56(%rbp)
 113 0017 48894DC0 		movq	%rcx, -64(%rbp)
 114 001b 4C8945B8 		movq	%r8, -72(%rbp)
 115 001f 4C894DB0 		movq	%r9, -80(%rbp)
 116              		.loc 1 75 1
 117 0023 64488B04 		movq	%fs:40, %rax
 117      25280000 
 117      00
 118 002c 488945F8 		movq	%rax, -8(%rbp)
 119 0030 31C0     		xorl	%eax, %eax
  76:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     int ret;
  77:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_rsa_context * rsa = (mbedtls_rsa_context *) ctx;
 120              		.loc 1 77 27
 121 0032 488B45D8 		movq	-40(%rbp), %rax
 122 0036 488945E8 		movq	%rax, -24(%rbp)
  78:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     size_t rsa_len = mbedtls_rsa_get_len( rsa );
 123              		.loc 1 78 22
 124 003a 488B45E8 		movq	-24(%rbp), %rax
 125 003e 4889C7   		movq	%rax, %rdi
 126 0041 E8000000 		call	mbedtls_rsa_get_len@PLT
 126      00
 127 0046 488945F0 		movq	%rax, -16(%rbp)
  79:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
  80:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if SIZE_MAX > UINT_MAX
  81:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( md_alg == MBEDTLS_MD_NONE && UINT_MAX < hash_len )
 128              		.loc 1 81 7
 129 004a 837DD400 		cmpl	$0, -44(%rbp)
 130 004e 7512     		jne	.L11
 131              		.loc 1 81 35 discriminator 1
 132 0050 B8FFFFFF 		movl	$4294967295, %eax
 132      FF
 133 0055 483945C0 		cmpq	%rax, -64(%rbp)
 134 0059 7607     		jbe	.L11
  82:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         return( MBEDTLS_ERR_PK_BAD_INPUT_DATA );
GAS LISTING /tmp/ccCBR1Ba.s 			page 5


 135              		.loc 1 82 15
 136 005b B880C1FF 		movl	$-16000, %eax
 136      FF
 137 0060 EB69     		jmp	.L12
 138              	.L11:
  83:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif /* SIZE_MAX > UINT_MAX */
  84:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
  85:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( sig_len < rsa_len )
 139              		.loc 1 85 7
 140 0062 488B45B0 		movq	-80(%rbp), %rax
 141 0066 483B45F0 		cmpq	-16(%rbp), %rax
 142 006a 7307     		jnb	.L13
  86:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         return( MBEDTLS_ERR_RSA_VERIFY_FAILED );
 143              		.loc 1 86 15
 144 006c B880BCFF 		movl	$-17280, %eax
 144      FF
 145 0071 EB58     		jmp	.L12
 146              	.L13:
  87:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
  88:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( ( ret = mbedtls_rsa_pkcs1_verify( rsa, NULL, NULL,
 147              		.loc 1 88 17
 148 0073 488B45C0 		movq	-64(%rbp), %rax
 149 0077 89C1     		movl	%eax, %ecx
 150 0079 8B55D4   		movl	-44(%rbp), %edx
 151 007c 488B45E8 		movq	-24(%rbp), %rax
 152 0080 FF75B8   		pushq	-72(%rbp)
 153 0083 FF75C8   		pushq	-56(%rbp)
 154 0086 4189C9   		movl	%ecx, %r9d
 155 0089 4189D0   		movl	%edx, %r8d
 156 008c B9000000 		movl	$0, %ecx
 156      00
 157 0091 BA000000 		movl	$0, %edx
 157      00
 158 0096 BE000000 		movl	$0, %esi
 158      00
 159 009b 4889C7   		movq	%rax, %rdi
 160 009e E8000000 		call	mbedtls_rsa_pkcs1_verify@PLT
 160      00
 161 00a3 4883C410 		addq	$16, %rsp
 162 00a7 8945E4   		movl	%eax, -28(%rbp)
 163              		.loc 1 88 7
 164 00aa 837DE400 		cmpl	$0, -28(%rbp)
 165 00ae 7405     		je	.L14
  89:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                                   MBEDTLS_RSA_PUBLIC, md_alg,
  90:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                                   (unsigned int) hash_len, hash, sig ) ) != 0 )
  91:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         return( ret );
 166              		.loc 1 91 15
 167 00b0 8B45E4   		movl	-28(%rbp), %eax
 168 00b3 EB16     		jmp	.L12
 169              	.L14:
  92:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
  93:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     /* The buffer contains a valid signature followed by extra data.
  94:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****      * We have a special error code for that so that so that callers can
  95:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****      * use mbedtls_pk_verify() to check "Does the buffer start with a
  96:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****      * valid signature?" and not just "Does the buffer contain a valid
  97:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****      * signature?". */
  98:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( sig_len > rsa_len )
GAS LISTING /tmp/ccCBR1Ba.s 			page 6


 170              		.loc 1 98 7
 171 00b5 488B45B0 		movq	-80(%rbp), %rax
 172 00b9 483B45F0 		cmpq	-16(%rbp), %rax
 173 00bd 7607     		jbe	.L15
  99:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         return( MBEDTLS_ERR_PK_SIG_LEN_MISMATCH );
 174              		.loc 1 99 15
 175 00bf B800C7FF 		movl	$-14592, %eax
 175      FF
 176 00c4 EB05     		jmp	.L12
 177              	.L15:
 100:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 101:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( 0 );
 178              		.loc 1 101 11
 179 00c6 B8000000 		movl	$0, %eax
 179      00
 180              	.L12:
 102:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 181              		.loc 1 102 1
 182 00cb 488B75F8 		movq	-8(%rbp), %rsi
 183 00cf 64483334 		xorq	%fs:40, %rsi
 183      25280000 
 183      00
 184 00d8 7405     		je	.L16
 185 00da E8000000 		call	__stack_chk_fail@PLT
 185      00
 186              	.L16:
 187 00df C9       		leave
 188              	.LCFI8:
 189              		.cfi_def_cfa 7, 8
 190 00e0 C3       		ret
 191              		.cfi_endproc
 192              	.LFE11:
 194              		.section	.text.rsa_sign_wrap,"ax",@progbits
 196              	rsa_sign_wrap:
 197              	.LFB12:
 103:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 104:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int rsa_sign_wrap( void *ctx, mbedtls_md_type_t md_alg,
 105:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    const unsigned char *hash, size_t hash_len,
 106:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    unsigned char *sig, size_t *sig_len,
 107:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    int (*f_rng)(void *, unsigned char *, size_t), void *p_rng )
 108:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 198              		.loc 1 108 1
 199              		.cfi_startproc
 200 0000 F30F1EFA 		endbr64
 201 0004 55       		pushq	%rbp
 202              	.LCFI9:
 203              		.cfi_def_cfa_offset 16
 204              		.cfi_offset 6, -16
 205 0005 4889E5   		movq	%rsp, %rbp
 206              	.LCFI10:
 207              		.cfi_def_cfa_register 6
 208 0008 4883EC50 		subq	$80, %rsp
 209 000c 48897DE8 		movq	%rdi, -24(%rbp)
 210 0010 8975E4   		movl	%esi, -28(%rbp)
 211 0013 488955D8 		movq	%rdx, -40(%rbp)
 212 0017 48894DD0 		movq	%rcx, -48(%rbp)
 213 001b 4C8945C8 		movq	%r8, -56(%rbp)
GAS LISTING /tmp/ccCBR1Ba.s 			page 7


 214 001f 4C894DC0 		movq	%r9, -64(%rbp)
 215 0023 488B4510 		movq	16(%rbp), %rax
 216 0027 488945B8 		movq	%rax, -72(%rbp)
 217 002b 488B4518 		movq	24(%rbp), %rax
 218 002f 488945B0 		movq	%rax, -80(%rbp)
 219              		.loc 1 108 1
 220 0033 64488B04 		movq	%fs:40, %rax
 220      25280000 
 220      00
 221 003c 488945F8 		movq	%rax, -8(%rbp)
 222 0040 31C0     		xorl	%eax, %eax
 109:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_rsa_context * rsa = (mbedtls_rsa_context *) ctx;
 223              		.loc 1 109 27
 224 0042 488B45E8 		movq	-24(%rbp), %rax
 225 0046 488945F0 		movq	%rax, -16(%rbp)
 110:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 111:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if SIZE_MAX > UINT_MAX
 112:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( md_alg == MBEDTLS_MD_NONE && UINT_MAX < hash_len )
 226              		.loc 1 112 7
 227 004a 837DE400 		cmpl	$0, -28(%rbp)
 228 004e 7512     		jne	.L18
 229              		.loc 1 112 35 discriminator 1
 230 0050 B8FFFFFF 		movl	$4294967295, %eax
 230      FF
 231 0055 483945D0 		cmpq	%rax, -48(%rbp)
 232 0059 7607     		jbe	.L18
 113:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         return( MBEDTLS_ERR_PK_BAD_INPUT_DATA );
 233              		.loc 1 113 15
 234 005b B880C1FF 		movl	$-16000, %eax
 234      FF
 235 0060 EB45     		jmp	.L19
 236              	.L18:
 114:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif /* SIZE_MAX > UINT_MAX */
 115:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 116:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     *sig_len = mbedtls_rsa_get_len( rsa );
 237              		.loc 1 116 16
 238 0062 488B45F0 		movq	-16(%rbp), %rax
 239 0066 4889C7   		movq	%rax, %rdi
 240 0069 E8000000 		call	mbedtls_rsa_get_len@PLT
 240      00
 241              		.loc 1 116 14
 242 006e 488B55C0 		movq	-64(%rbp), %rdx
 243 0072 488902   		movq	%rax, (%rdx)
 117:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 118:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( mbedtls_rsa_pkcs1_sign( rsa, f_rng, p_rng, MBEDTLS_RSA_PRIVATE,
 244              		.loc 1 118 13
 245 0075 488B45D0 		movq	-48(%rbp), %rax
 246 0079 89C7     		movl	%eax, %edi
 247 007b 8B4DE4   		movl	-28(%rbp), %ecx
 248 007e 488B55B0 		movq	-80(%rbp), %rdx
 249 0082 488B75B8 		movq	-72(%rbp), %rsi
 250 0086 488B45F0 		movq	-16(%rbp), %rax
 251 008a FF75C8   		pushq	-56(%rbp)
 252 008d FF75D8   		pushq	-40(%rbp)
 253 0090 4189F9   		movl	%edi, %r9d
 254 0093 4189C8   		movl	%ecx, %r8d
 255 0096 B9010000 		movl	$1, %ecx
GAS LISTING /tmp/ccCBR1Ba.s 			page 8


 255      00
 256 009b 4889C7   		movq	%rax, %rdi
 257 009e E8000000 		call	mbedtls_rsa_pkcs1_sign@PLT
 257      00
 258 00a3 4883C410 		addq	$16, %rsp
 259              	.L19:
 119:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                 md_alg, (unsigned int) hash_len, hash, sig ) );
 120:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 260              		.loc 1 120 1
 261 00a7 488B4DF8 		movq	-8(%rbp), %rcx
 262 00ab 6448330C 		xorq	%fs:40, %rcx
 262      25280000 
 262      00
 263 00b4 7405     		je	.L20
 264 00b6 E8000000 		call	__stack_chk_fail@PLT
 264      00
 265              	.L20:
 266 00bb C9       		leave
 267              	.LCFI11:
 268              		.cfi_def_cfa 7, 8
 269 00bc C3       		ret
 270              		.cfi_endproc
 271              	.LFE12:
 273              		.section	.text.rsa_decrypt_wrap,"ax",@progbits
 275              	rsa_decrypt_wrap:
 276              	.LFB13:
 121:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 122:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int rsa_decrypt_wrap( void *ctx,
 123:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                     const unsigned char *input, size_t ilen,
 124:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                     unsigned char *output, size_t *olen, size_t osize,
 125:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                     int (*f_rng)(void *, unsigned char *, size_t), void *p_rng )
 126:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 277              		.loc 1 126 1
 278              		.cfi_startproc
 279 0000 F30F1EFA 		endbr64
 280 0004 55       		pushq	%rbp
 281              	.LCFI12:
 282              		.cfi_def_cfa_offset 16
 283              		.cfi_offset 6, -16
 284 0005 4889E5   		movq	%rsp, %rbp
 285              	.LCFI13:
 286              		.cfi_def_cfa_register 6
 287 0008 4883EC50 		subq	$80, %rsp
 288 000c 48897DE8 		movq	%rdi, -24(%rbp)
 289 0010 488975E0 		movq	%rsi, -32(%rbp)
 290 0014 488955D8 		movq	%rdx, -40(%rbp)
 291 0018 48894DD0 		movq	%rcx, -48(%rbp)
 292 001c 4C8945C8 		movq	%r8, -56(%rbp)
 293 0020 4C894DC0 		movq	%r9, -64(%rbp)
 294 0024 488B4510 		movq	16(%rbp), %rax
 295 0028 488945B8 		movq	%rax, -72(%rbp)
 296 002c 488B4518 		movq	24(%rbp), %rax
 297 0030 488945B0 		movq	%rax, -80(%rbp)
 298              		.loc 1 126 1
 299 0034 64488B04 		movq	%fs:40, %rax
 299      25280000 
 299      00
GAS LISTING /tmp/ccCBR1Ba.s 			page 9


 300 003d 488945F8 		movq	%rax, -8(%rbp)
 301 0041 31C0     		xorl	%eax, %eax
 127:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_rsa_context * rsa = (mbedtls_rsa_context *) ctx;
 302              		.loc 1 127 27
 303 0043 488B45E8 		movq	-24(%rbp), %rax
 304 0047 488945F0 		movq	%rax, -16(%rbp)
 128:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 129:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( ilen != mbedtls_rsa_get_len( rsa ) )
 305              		.loc 1 129 17
 306 004b 488B45F0 		movq	-16(%rbp), %rax
 307 004f 4889C7   		movq	%rax, %rdi
 308 0052 E8000000 		call	mbedtls_rsa_get_len@PLT
 308      00
 309              		.loc 1 129 7
 310 0057 483945D8 		cmpq	%rax, -40(%rbp)
 311 005b 7407     		je	.L22
 130:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 312              		.loc 1 130 15
 313 005d B880BFFF 		movl	$-16512, %eax
 313      FF
 314 0062 EB31     		jmp	.L23
 315              	.L22:
 131:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 132:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( mbedtls_rsa_pkcs1_decrypt( rsa, f_rng, p_rng,
 316              		.loc 1 132 13
 317 0064 488B7DE0 		movq	-32(%rbp), %rdi
 318 0068 488B4DC8 		movq	-56(%rbp), %rcx
 319 006c 488B55B0 		movq	-80(%rbp), %rdx
 320 0070 488B75B8 		movq	-72(%rbp), %rsi
 321 0074 488B45F0 		movq	-16(%rbp), %rax
 322 0078 FF75C0   		pushq	-64(%rbp)
 323 007b FF75D0   		pushq	-48(%rbp)
 324 007e 4989F9   		movq	%rdi, %r9
 325 0081 4989C8   		movq	%rcx, %r8
 326 0084 B9010000 		movl	$1, %ecx
 326      00
 327 0089 4889C7   		movq	%rax, %rdi
 328 008c E8000000 		call	mbedtls_rsa_pkcs1_decrypt@PLT
 328      00
 329 0091 4883C410 		addq	$16, %rsp
 330              	.L23:
 133:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                 MBEDTLS_RSA_PRIVATE, olen, input, output, osize ) );
 134:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 331              		.loc 1 134 1
 332 0095 488B55F8 		movq	-8(%rbp), %rdx
 333 0099 64483314 		xorq	%fs:40, %rdx
 333      25280000 
 333      00
 334 00a2 7405     		je	.L24
 335 00a4 E8000000 		call	__stack_chk_fail@PLT
 335      00
 336              	.L24:
 337 00a9 C9       		leave
 338              	.LCFI14:
 339              		.cfi_def_cfa 7, 8
 340 00aa C3       		ret
 341              		.cfi_endproc
GAS LISTING /tmp/ccCBR1Ba.s 			page 10


 342              	.LFE13:
 344              		.section	.text.rsa_encrypt_wrap,"ax",@progbits
 346              	rsa_encrypt_wrap:
 347              	.LFB14:
 135:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 136:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int rsa_encrypt_wrap( void *ctx,
 137:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                     const unsigned char *input, size_t ilen,
 138:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                     unsigned char *output, size_t *olen, size_t osize,
 139:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                     int (*f_rng)(void *, unsigned char *, size_t), void *p_rng )
 140:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 348              		.loc 1 140 1
 349              		.cfi_startproc
 350 0000 F30F1EFA 		endbr64
 351 0004 55       		pushq	%rbp
 352              	.LCFI15:
 353              		.cfi_def_cfa_offset 16
 354              		.cfi_offset 6, -16
 355 0005 4889E5   		movq	%rsp, %rbp
 356              	.LCFI16:
 357              		.cfi_def_cfa_register 6
 358 0008 4883EC50 		subq	$80, %rsp
 359 000c 48897DE8 		movq	%rdi, -24(%rbp)
 360 0010 488975E0 		movq	%rsi, -32(%rbp)
 361 0014 488955D8 		movq	%rdx, -40(%rbp)
 362 0018 48894DD0 		movq	%rcx, -48(%rbp)
 363 001c 4C8945C8 		movq	%r8, -56(%rbp)
 364 0020 4C894DC0 		movq	%r9, -64(%rbp)
 365 0024 488B4510 		movq	16(%rbp), %rax
 366 0028 488945B8 		movq	%rax, -72(%rbp)
 367 002c 488B4518 		movq	24(%rbp), %rax
 368 0030 488945B0 		movq	%rax, -80(%rbp)
 369              		.loc 1 140 1
 370 0034 64488B04 		movq	%fs:40, %rax
 370      25280000 
 370      00
 371 003d 488945F8 		movq	%rax, -8(%rbp)
 372 0041 31C0     		xorl	%eax, %eax
 141:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_rsa_context * rsa = (mbedtls_rsa_context *) ctx;
 373              		.loc 1 141 27
 374 0043 488B45E8 		movq	-24(%rbp), %rax
 375 0047 488945F0 		movq	%rax, -16(%rbp)
 142:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     *olen = mbedtls_rsa_get_len( rsa );
 376              		.loc 1 142 13
 377 004b 488B45F0 		movq	-16(%rbp), %rax
 378 004f 4889C7   		movq	%rax, %rdi
 379 0052 E8000000 		call	mbedtls_rsa_get_len@PLT
 379      00
 380              		.loc 1 142 11
 381 0057 488B55C8 		movq	-56(%rbp), %rdx
 382 005b 488902   		movq	%rax, (%rdx)
 143:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 144:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( *olen > osize )
 383              		.loc 1 144 9
 384 005e 488B45C8 		movq	-56(%rbp), %rax
 385 0062 488B00   		movq	(%rax), %rax
 386              		.loc 1 144 7
 387 0065 483945C0 		cmpq	%rax, -64(%rbp)
GAS LISTING /tmp/ccCBR1Ba.s 			page 11


 388 0069 7307     		jnb	.L26
 145:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         return( MBEDTLS_ERR_RSA_OUTPUT_TOO_LARGE );
 389              		.loc 1 145 15
 390 006b B800BCFF 		movl	$-17408, %eax
 390      FF
 391 0070 EB32     		jmp	.L27
 392              	.L26:
 146:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 147:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( mbedtls_rsa_pkcs1_encrypt( rsa, f_rng, p_rng, MBEDTLS_RSA_PUBLIC,
 393              		.loc 1 147 13
 394 0072 488B7DE0 		movq	-32(%rbp), %rdi
 395 0076 488B4DD8 		movq	-40(%rbp), %rcx
 396 007a 488B55B0 		movq	-80(%rbp), %rdx
 397 007e 488B75B8 		movq	-72(%rbp), %rsi
 398 0082 488B45F0 		movq	-16(%rbp), %rax
 399 0086 4883EC08 		subq	$8, %rsp
 400 008a FF75D0   		pushq	-48(%rbp)
 401 008d 4989F9   		movq	%rdi, %r9
 402 0090 4989C8   		movq	%rcx, %r8
 403 0093 B9000000 		movl	$0, %ecx
 403      00
 404 0098 4889C7   		movq	%rax, %rdi
 405 009b E8000000 		call	mbedtls_rsa_pkcs1_encrypt@PLT
 405      00
 406 00a0 4883C410 		addq	$16, %rsp
 407              	.L27:
 148:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                                        ilen, input, output ) );
 149:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 408              		.loc 1 149 1
 409 00a4 488B4DF8 		movq	-8(%rbp), %rcx
 410 00a8 6448330C 		xorq	%fs:40, %rcx
 410      25280000 
 410      00
 411 00b1 7405     		je	.L28
 412 00b3 E8000000 		call	__stack_chk_fail@PLT
 412      00
 413              	.L28:
 414 00b8 C9       		leave
 415              	.LCFI17:
 416              		.cfi_def_cfa 7, 8
 417 00b9 C3       		ret
 418              		.cfi_endproc
 419              	.LFE14:
 421              		.section	.text.rsa_check_pair_wrap,"ax",@progbits
 423              	rsa_check_pair_wrap:
 424              	.LFB15:
 150:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 151:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int rsa_check_pair_wrap( const void *pub, const void *prv )
 152:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 425              		.loc 1 152 1
 426              		.cfi_startproc
 427 0000 F30F1EFA 		endbr64
 428 0004 55       		pushq	%rbp
 429              	.LCFI18:
 430              		.cfi_def_cfa_offset 16
 431              		.cfi_offset 6, -16
 432 0005 4889E5   		movq	%rsp, %rbp
GAS LISTING /tmp/ccCBR1Ba.s 			page 12


 433              	.LCFI19:
 434              		.cfi_def_cfa_register 6
 435 0008 4883EC20 		subq	$32, %rsp
 436 000c 48897DE8 		movq	%rdi, -24(%rbp)
 437 0010 488975E0 		movq	%rsi, -32(%rbp)
 438              		.loc 1 152 1
 439 0014 64488B04 		movq	%fs:40, %rax
 439      25280000 
 439      00
 440 001d 488945F8 		movq	%rax, -8(%rbp)
 441 0021 31C0     		xorl	%eax, %eax
 153:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( mbedtls_rsa_check_pub_priv( (const mbedtls_rsa_context *) pub,
 442              		.loc 1 153 13
 443 0023 488B55E0 		movq	-32(%rbp), %rdx
 444 0027 488B45E8 		movq	-24(%rbp), %rax
 445 002b 4889D6   		movq	%rdx, %rsi
 446 002e 4889C7   		movq	%rax, %rdi
 447 0031 E8000000 		call	mbedtls_rsa_check_pub_priv@PLT
 447      00
 154:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                                 (const mbedtls_rsa_context *) prv ) );
 155:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 448              		.loc 1 155 1
 449 0036 488B4DF8 		movq	-8(%rbp), %rcx
 450 003a 6448330C 		xorq	%fs:40, %rcx
 450      25280000 
 450      00
 451 0043 7405     		je	.L31
 452 0045 E8000000 		call	__stack_chk_fail@PLT
 452      00
 453              	.L31:
 454 004a C9       		leave
 455              	.LCFI20:
 456              		.cfi_def_cfa 7, 8
 457 004b C3       		ret
 458              		.cfi_endproc
 459              	.LFE15:
 461              		.section	.text.rsa_alloc_wrap,"ax",@progbits
 463              	rsa_alloc_wrap:
 464              	.LFB16:
 156:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 157:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static void *rsa_alloc_wrap( void )
 158:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 465              		.loc 1 158 1
 466              		.cfi_startproc
 467 0000 F30F1EFA 		endbr64
 468 0004 55       		pushq	%rbp
 469              	.LCFI21:
 470              		.cfi_def_cfa_offset 16
 471              		.cfi_offset 6, -16
 472 0005 4889E5   		movq	%rsp, %rbp
 473              	.LCFI22:
 474              		.cfi_def_cfa_register 6
 475 0008 4883EC10 		subq	$16, %rsp
 476              		.loc 1 158 1
 477 000c 64488B04 		movq	%fs:40, %rax
 477      25280000 
 477      00
GAS LISTING /tmp/ccCBR1Ba.s 			page 13


 478 0015 488945F8 		movq	%rax, -8(%rbp)
 479 0019 31C0     		xorl	%eax, %eax
 159:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     void *ctx = mbedtls_calloc( 1, sizeof( mbedtls_rsa_context ) );
 480              		.loc 1 159 17
 481 001b BE500100 		movl	$336, %esi
 481      00
 482 0020 BF010000 		movl	$1, %edi
 482      00
 483 0025 E8000000 		call	mbedtls_calloc@PLT
 483      00
 484 002a 488945F0 		movq	%rax, -16(%rbp)
 160:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 161:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( ctx != NULL )
 485              		.loc 1 161 7
 486 002e 48837DF0 		cmpq	$0, -16(%rbp)
 486      00
 487 0033 7416     		je	.L33
 162:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         mbedtls_rsa_init( (mbedtls_rsa_context *) ctx, 0, 0 );
 488              		.loc 1 162 9
 489 0035 488B45F0 		movq	-16(%rbp), %rax
 490 0039 BA000000 		movl	$0, %edx
 490      00
 491 003e BE000000 		movl	$0, %esi
 491      00
 492 0043 4889C7   		movq	%rax, %rdi
 493 0046 E8000000 		call	mbedtls_rsa_init@PLT
 493      00
 494              	.L33:
 163:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 164:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( ctx );
 495              		.loc 1 164 11
 496 004b 488B45F0 		movq	-16(%rbp), %rax
 165:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 497              		.loc 1 165 1
 498 004f 488B4DF8 		movq	-8(%rbp), %rcx
 499 0053 6448330C 		xorq	%fs:40, %rcx
 499      25280000 
 499      00
 500 005c 7405     		je	.L35
 501 005e E8000000 		call	__stack_chk_fail@PLT
 501      00
 502              	.L35:
 503 0063 C9       		leave
 504              	.LCFI23:
 505              		.cfi_def_cfa 7, 8
 506 0064 C3       		ret
 507              		.cfi_endproc
 508              	.LFE16:
 510              		.section	.text.rsa_free_wrap,"ax",@progbits
 512              	rsa_free_wrap:
 513              	.LFB17:
 166:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 167:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static void rsa_free_wrap( void *ctx )
 168:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 514              		.loc 1 168 1
 515              		.cfi_startproc
 516 0000 F30F1EFA 		endbr64
GAS LISTING /tmp/ccCBR1Ba.s 			page 14


 517 0004 55       		pushq	%rbp
 518              	.LCFI24:
 519              		.cfi_def_cfa_offset 16
 520              		.cfi_offset 6, -16
 521 0005 4889E5   		movq	%rsp, %rbp
 522              	.LCFI25:
 523              		.cfi_def_cfa_register 6
 524 0008 4883EC20 		subq	$32, %rsp
 525 000c 48897DE8 		movq	%rdi, -24(%rbp)
 526              		.loc 1 168 1
 527 0010 64488B04 		movq	%fs:40, %rax
 527      25280000 
 527      00
 528 0019 488945F8 		movq	%rax, -8(%rbp)
 529 001d 31C0     		xorl	%eax, %eax
 169:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_rsa_free( (mbedtls_rsa_context *) ctx );
 530              		.loc 1 169 5
 531 001f 488B45E8 		movq	-24(%rbp), %rax
 532 0023 4889C7   		movq	%rax, %rdi
 533 0026 E8000000 		call	mbedtls_rsa_free@PLT
 533      00
 170:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_free( ctx );
 534              		.loc 1 170 5
 535 002b 488B45E8 		movq	-24(%rbp), %rax
 536 002f 4889C7   		movq	%rax, %rdi
 537 0032 E8000000 		call	mbedtls_free@PLT
 537      00
 171:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 538              		.loc 1 171 1
 539 0037 90       		nop
 540 0038 488B45F8 		movq	-8(%rbp), %rax
 541 003c 64483304 		xorq	%fs:40, %rax
 541      25280000 
 541      00
 542 0045 7405     		je	.L37
 543 0047 E8000000 		call	__stack_chk_fail@PLT
 543      00
 544              	.L37:
 545 004c C9       		leave
 546              	.LCFI26:
 547              		.cfi_def_cfa 7, 8
 548 004d C3       		ret
 549              		.cfi_endproc
 550              	.LFE17:
 552              		.section	.rodata
 553              	.LC0:
 554 0000 7273612E 		.string	"rsa.N"
 554      4E00
 555              	.LC1:
 556 0006 7273612E 		.string	"rsa.E"
 556      4500
 557              		.section	.text.rsa_debug,"ax",@progbits
 559              	rsa_debug:
 560              	.LFB18:
 172:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 173:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static void rsa_debug( const void *ctx, mbedtls_pk_debug_item *items )
 174:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
GAS LISTING /tmp/ccCBR1Ba.s 			page 15


 561              		.loc 1 174 1
 562              		.cfi_startproc
 563 0000 F30F1EFA 		endbr64
 564 0004 55       		pushq	%rbp
 565              	.LCFI27:
 566              		.cfi_def_cfa_offset 16
 567              		.cfi_offset 6, -16
 568 0005 4889E5   		movq	%rsp, %rbp
 569              	.LCFI28:
 570              		.cfi_def_cfa_register 6
 571 0008 4883EC20 		subq	$32, %rsp
 572 000c 48897DE8 		movq	%rdi, -24(%rbp)
 573 0010 488975E0 		movq	%rsi, -32(%rbp)
 574              		.loc 1 174 1
 575 0014 64488B04 		movq	%fs:40, %rax
 575      25280000 
 575      00
 576 001d 488945F8 		movq	%rax, -8(%rbp)
 577 0021 31C0     		xorl	%eax, %eax
 175:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     items->type = MBEDTLS_PK_DEBUG_MPI;
 578              		.loc 1 175 17
 579 0023 488B45E0 		movq	-32(%rbp), %rax
 580 0027 C7000100 		movl	$1, (%rax)
 580      0000
 176:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     items->name = "rsa.N";
 581              		.loc 1 176 17
 582 002d 488B45E0 		movq	-32(%rbp), %rax
 583 0031 488D1500 		leaq	.LC0(%rip), %rdx
 583      000000
 584 0038 48895008 		movq	%rdx, 8(%rax)
 177:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     items->value = &( ((mbedtls_rsa_context *) ctx)->N );
 585              		.loc 1 177 20
 586 003c 488B45E8 		movq	-24(%rbp), %rax
 587 0040 488D5010 		leaq	16(%rax), %rdx
 588              		.loc 1 177 18
 589 0044 488B45E0 		movq	-32(%rbp), %rax
 590 0048 48895010 		movq	%rdx, 16(%rax)
 178:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 179:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     items++;
 591              		.loc 1 179 10
 592 004c 488345E0 		addq	$24, -32(%rbp)
 592      18
 180:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 181:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     items->type = MBEDTLS_PK_DEBUG_MPI;
 593              		.loc 1 181 17
 594 0051 488B45E0 		movq	-32(%rbp), %rax
 595 0055 C7000100 		movl	$1, (%rax)
 595      0000
 182:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     items->name = "rsa.E";
 596              		.loc 1 182 17
 597 005b 488B45E0 		movq	-32(%rbp), %rax
 598 005f 488D1500 		leaq	.LC1(%rip), %rdx
 598      000000
 599 0066 48895008 		movq	%rdx, 8(%rax)
 183:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     items->value = &( ((mbedtls_rsa_context *) ctx)->E );
 600              		.loc 1 183 20
 601 006a 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/ccCBR1Ba.s 			page 16


 602 006e 488D5028 		leaq	40(%rax), %rdx
 603              		.loc 1 183 18
 604 0072 488B45E0 		movq	-32(%rbp), %rax
 605 0076 48895010 		movq	%rdx, 16(%rax)
 184:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 606              		.loc 1 184 1
 607 007a 90       		nop
 608 007b 488B45F8 		movq	-8(%rbp), %rax
 609 007f 64483304 		xorq	%fs:40, %rax
 609      25280000 
 609      00
 610 0088 7405     		je	.L39
 611 008a E8000000 		call	__stack_chk_fail@PLT
 611      00
 612              	.L39:
 613 008f C9       		leave
 614              	.LCFI29:
 615              		.cfi_def_cfa 7, 8
 616 0090 C3       		ret
 617              		.cfi_endproc
 618              	.LFE18:
 620              		.globl	mbedtls_rsa_info
 621              		.section	.rodata
 622              	.LC2:
 623 000c 52534100 		.string	"RSA"
 624              		.section	.data.rel.ro.local.mbedtls_rsa_info,"aw"
 625              		.align 32
 628              	mbedtls_rsa_info:
 629 0000 01000000 		.long	1
 630 0004 00000000 		.zero	4
 631 0008 00000000 		.quad	.LC2
 631      00000000 
 632 0010 00000000 		.quad	rsa_get_bitlen
 632      00000000 
 633 0018 00000000 		.quad	rsa_can_do
 633      00000000 
 634 0020 00000000 		.quad	rsa_verify_wrap
 634      00000000 
 635 0028 00000000 		.quad	rsa_sign_wrap
 635      00000000 
 636 0030 00000000 		.quad	rsa_decrypt_wrap
 636      00000000 
 637 0038 00000000 		.quad	rsa_encrypt_wrap
 637      00000000 
 638 0040 00000000 		.quad	rsa_check_pair_wrap
 638      00000000 
 639 0048 00000000 		.quad	rsa_alloc_wrap
 639      00000000 
 640 0050 00000000 		.quad	rsa_free_wrap
 640      00000000 
 641 0058 00000000 		.quad	rsa_debug
 641      00000000 
 642              		.section	.text.eckey_can_do,"ax",@progbits
 644              	eckey_can_do:
 645              	.LFB19:
 185:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 186:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** const mbedtls_pk_info_t mbedtls_rsa_info = {
GAS LISTING /tmp/ccCBR1Ba.s 			page 17


 187:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     MBEDTLS_PK_RSA,
 188:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     "RSA",
 189:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     rsa_get_bitlen,
 190:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     rsa_can_do,
 191:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     rsa_verify_wrap,
 192:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     rsa_sign_wrap,
 193:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if defined(MBEDTLS_ECDSA_C) && defined(MBEDTLS_ECP_RESTARTABLE)
 194:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     NULL,
 195:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     NULL,
 196:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif
 197:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     rsa_decrypt_wrap,
 198:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     rsa_encrypt_wrap,
 199:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     rsa_check_pair_wrap,
 200:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     rsa_alloc_wrap,
 201:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     rsa_free_wrap,
 202:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if defined(MBEDTLS_ECDSA_C) && defined(MBEDTLS_ECP_RESTARTABLE)
 203:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     NULL,
 204:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     NULL,
 205:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif
 206:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     rsa_debug,
 207:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** };
 208:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif /* MBEDTLS_RSA_C */
 209:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 210:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if defined(MBEDTLS_ECP_C)
 211:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** /*
 212:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  * Generic EC key
 213:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  */
 214:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int eckey_can_do( mbedtls_pk_type_t type )
 215:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 646              		.loc 1 215 1
 647              		.cfi_startproc
 648 0000 F30F1EFA 		endbr64
 649 0004 55       		pushq	%rbp
 650              	.LCFI30:
 651              		.cfi_def_cfa_offset 16
 652              		.cfi_offset 6, -16
 653 0005 4889E5   		movq	%rsp, %rbp
 654              	.LCFI31:
 655              		.cfi_def_cfa_register 6
 656 0008 4883EC20 		subq	$32, %rsp
 657 000c 897DEC   		movl	%edi, -20(%rbp)
 658              		.loc 1 215 1
 659 000f 64488B04 		movq	%fs:40, %rax
 659      25280000 
 659      00
 660 0018 488945F8 		movq	%rax, -8(%rbp)
 661 001c 31C0     		xorl	%eax, %eax
 216:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( type == MBEDTLS_PK_ECKEY ||
 217:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****             type == MBEDTLS_PK_ECKEY_DH ||
 662              		.loc 1 217 41
 663 001e 837DEC02 		cmpl	$2, -20(%rbp)
 664 0022 740C     		je	.L41
 216:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( type == MBEDTLS_PK_ECKEY ||
 665              		.loc 1 216 38
 666 0024 837DEC03 		cmpl	$3, -20(%rbp)
 667 0028 7406     		je	.L41
 668              		.loc 1 217 41 discriminator 2
GAS LISTING /tmp/ccCBR1Ba.s 			page 18


 669 002a 837DEC04 		cmpl	$4, -20(%rbp)
 670 002e 7507     		jne	.L42
 671              	.L41:
 672              		.loc 1 217 41 is_stmt 0 discriminator 1
 673 0030 B8010000 		movl	$1, %eax
 673      00
 674 0035 EB05     		jmp	.L44
 675              	.L42:
 676              		.loc 1 217 41 discriminator 3
 677 0037 B8000000 		movl	$0, %eax
 677      00
 678              	.L44:
 218:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****             type == MBEDTLS_PK_ECDSA );
 219:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 679              		.loc 1 219 1 is_stmt 1 discriminator 6
 680 003c 488B55F8 		movq	-8(%rbp), %rdx
 681 0040 64483314 		xorq	%fs:40, %rdx
 681      25280000 
 681      00
 682 0049 7405     		je	.L45
 683              		.loc 1 219 1 is_stmt 0
 684 004b E8000000 		call	__stack_chk_fail@PLT
 684      00
 685              	.L45:
 686 0050 C9       		leave
 687              	.LCFI32:
 688              		.cfi_def_cfa 7, 8
 689 0051 C3       		ret
 690              		.cfi_endproc
 691              	.LFE19:
 693              		.section	.text.eckey_get_bitlen,"ax",@progbits
 695              	eckey_get_bitlen:
 696              	.LFB20:
 220:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 221:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static size_t eckey_get_bitlen( const void *ctx )
 222:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 697              		.loc 1 222 1 is_stmt 1
 698              		.cfi_startproc
 699 0000 F30F1EFA 		endbr64
 700 0004 55       		pushq	%rbp
 701              	.LCFI33:
 702              		.cfi_def_cfa_offset 16
 703              		.cfi_offset 6, -16
 704 0005 4889E5   		movq	%rsp, %rbp
 705              	.LCFI34:
 706              		.cfi_def_cfa_register 6
 707 0008 4883EC20 		subq	$32, %rsp
 708 000c 48897DE8 		movq	%rdi, -24(%rbp)
 709              		.loc 1 222 1
 710 0010 64488B04 		movq	%fs:40, %rax
 710      25280000 
 710      00
 711 0019 488945F8 		movq	%rax, -8(%rbp)
 712 001d 31C0     		xorl	%eax, %eax
 223:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( ((mbedtls_ecp_keypair *) ctx)->grp.pbits );
 713              		.loc 1 223 47
 714 001f 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/ccCBR1Ba.s 			page 19


 715 0023 488B80B0 		movq	176(%rax), %rax
 715      000000
 224:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 716              		.loc 1 224 1
 717 002a 488B55F8 		movq	-8(%rbp), %rdx
 718 002e 64483314 		xorq	%fs:40, %rdx
 718      25280000 
 718      00
 719 0037 7405     		je	.L48
 720 0039 E8000000 		call	__stack_chk_fail@PLT
 720      00
 721              	.L48:
 722 003e C9       		leave
 723              	.LCFI35:
 724              		.cfi_def_cfa 7, 8
 725 003f C3       		ret
 726              		.cfi_endproc
 727              	.LFE20:
 729              		.section	.text.eckey_verify_wrap,"ax",@progbits
 731              	eckey_verify_wrap:
 732              	.LFB21:
 225:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 226:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if defined(MBEDTLS_ECDSA_C)
 227:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** /* Forward declarations */
 228:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int ecdsa_verify_wrap( void *ctx, mbedtls_md_type_t md_alg,
 229:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                        const unsigned char *hash, size_t hash_len,
 230:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                        const unsigned char *sig, size_t sig_len );
 231:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 232:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int ecdsa_sign_wrap( void *ctx, mbedtls_md_type_t md_alg,
 233:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    const unsigned char *hash, size_t hash_len,
 234:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    unsigned char *sig, size_t *sig_len,
 235:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    int (*f_rng)(void *, unsigned char *, size_t), void *p_rng );
 236:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 237:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int eckey_verify_wrap( void *ctx, mbedtls_md_type_t md_alg,
 238:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                        const unsigned char *hash, size_t hash_len,
 239:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                        const unsigned char *sig, size_t sig_len )
 240:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 733              		.loc 1 240 1
 734              		.cfi_startproc
 735 0000 F30F1EFA 		endbr64
 736 0004 55       		pushq	%rbp
 737              	.LCFI36:
 738              		.cfi_def_cfa_offset 16
 739              		.cfi_offset 6, -16
 740 0005 4889E5   		movq	%rsp, %rbp
 741              	.LCFI37:
 742              		.cfi_def_cfa_register 6
 743 0008 4881ECA0 		subq	$416, %rsp
 743      010000
 744 000f 4889BD88 		movq	%rdi, -376(%rbp)
 744      FEFFFF
 745 0016 89B584FE 		movl	%esi, -380(%rbp)
 745      FFFF
 746 001c 48899578 		movq	%rdx, -392(%rbp)
 746      FEFFFF
 747 0023 48898D70 		movq	%rcx, -400(%rbp)
 747      FEFFFF
GAS LISTING /tmp/ccCBR1Ba.s 			page 20


 748 002a 4C898568 		movq	%r8, -408(%rbp)
 748      FEFFFF
 749 0031 4C898D60 		movq	%r9, -416(%rbp)
 749      FEFFFF
 750              		.loc 1 240 1
 751 0038 64488B04 		movq	%fs:40, %rax
 751      25280000 
 751      00
 752 0041 488945F8 		movq	%rax, -8(%rbp)
 753 0045 31C0     		xorl	%eax, %eax
 241:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     int ret;
 242:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_ecdsa_context ecdsa;
 243:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 244:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_ecdsa_init( &ecdsa );
 754              		.loc 1 244 5
 755 0047 488D85A0 		leaq	-352(%rbp), %rax
 755      FEFFFF
 756 004e 4889C7   		movq	%rax, %rdi
 757 0051 E8000000 		call	mbedtls_ecdsa_init@PLT
 757      00
 245:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 246:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( ( ret = mbedtls_ecdsa_from_keypair( &ecdsa, ctx ) ) == 0 )
 758              		.loc 1 246 17
 759 0056 488B9588 		movq	-376(%rbp), %rdx
 759      FEFFFF
 760 005d 488D85A0 		leaq	-352(%rbp), %rax
 760      FEFFFF
 761 0064 4889D6   		movq	%rdx, %rsi
 762 0067 4889C7   		movq	%rax, %rdi
 763 006a E8000000 		call	mbedtls_ecdsa_from_keypair@PLT
 763      00
 764 006f 89859CFE 		movl	%eax, -356(%rbp)
 764      FFFF
 765              		.loc 1 246 7
 766 0075 83BD9CFE 		cmpl	$0, -356(%rbp)
 766      FFFF00
 767 007c 753D     		jne	.L50
 247:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         ret = ecdsa_verify_wrap( &ecdsa, md_alg, hash, hash_len, sig, sig_len );
 768              		.loc 1 247 15
 769 007e 4C8B8560 		movq	-416(%rbp), %r8
 769      FEFFFF
 770 0085 488BBD68 		movq	-408(%rbp), %rdi
 770      FEFFFF
 771 008c 488B8D70 		movq	-400(%rbp), %rcx
 771      FEFFFF
 772 0093 488B9578 		movq	-392(%rbp), %rdx
 772      FEFFFF
 773 009a 8BB584FE 		movl	-380(%rbp), %esi
 773      FFFF
 774 00a0 488D85A0 		leaq	-352(%rbp), %rax
 774      FEFFFF
 775 00a7 4D89C1   		movq	%r8, %r9
 776 00aa 4989F8   		movq	%rdi, %r8
 777 00ad 4889C7   		movq	%rax, %rdi
 778 00b0 E8000000 		call	ecdsa_verify_wrap
 778      00
 779 00b5 89859CFE 		movl	%eax, -356(%rbp)
GAS LISTING /tmp/ccCBR1Ba.s 			page 21


 779      FFFF
 780              	.L50:
 248:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 249:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_ecdsa_free( &ecdsa );
 781              		.loc 1 249 5
 782 00bb 488D85A0 		leaq	-352(%rbp), %rax
 782      FEFFFF
 783 00c2 4889C7   		movq	%rax, %rdi
 784 00c5 E8000000 		call	mbedtls_ecdsa_free@PLT
 784      00
 250:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 251:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( ret );
 785              		.loc 1 251 11
 786 00ca 8B859CFE 		movl	-356(%rbp), %eax
 786      FFFF
 252:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 787              		.loc 1 252 1
 788 00d0 488B4DF8 		movq	-8(%rbp), %rcx
 789 00d4 6448330C 		xorq	%fs:40, %rcx
 789      25280000 
 789      00
 790 00dd 7405     		je	.L52
 791 00df E8000000 		call	__stack_chk_fail@PLT
 791      00
 792              	.L52:
 793 00e4 C9       		leave
 794              	.LCFI38:
 795              		.cfi_def_cfa 7, 8
 796 00e5 C3       		ret
 797              		.cfi_endproc
 798              	.LFE21:
 800              		.section	.text.eckey_sign_wrap,"ax",@progbits
 802              	eckey_sign_wrap:
 803              	.LFB22:
 253:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 254:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int eckey_sign_wrap( void *ctx, mbedtls_md_type_t md_alg,
 255:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    const unsigned char *hash, size_t hash_len,
 256:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    unsigned char *sig, size_t *sig_len,
 257:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    int (*f_rng)(void *, unsigned char *, size_t), void *p_rng )
 258:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 804              		.loc 1 258 1
 805              		.cfi_startproc
 806 0000 F30F1EFA 		endbr64
 807 0004 55       		pushq	%rbp
 808              	.LCFI39:
 809              		.cfi_def_cfa_offset 16
 810              		.cfi_offset 6, -16
 811 0005 4889E5   		movq	%rsp, %rbp
 812              	.LCFI40:
 813              		.cfi_def_cfa_register 6
 814 0008 4881ECB0 		subq	$432, %rsp
 814      010000
 815 000f 4889BD88 		movq	%rdi, -376(%rbp)
 815      FEFFFF
 816 0016 89B584FE 		movl	%esi, -380(%rbp)
 816      FFFF
 817 001c 48899578 		movq	%rdx, -392(%rbp)
GAS LISTING /tmp/ccCBR1Ba.s 			page 22


 817      FEFFFF
 818 0023 48898D70 		movq	%rcx, -400(%rbp)
 818      FEFFFF
 819 002a 4C898568 		movq	%r8, -408(%rbp)
 819      FEFFFF
 820 0031 4C898D60 		movq	%r9, -416(%rbp)
 820      FEFFFF
 821 0038 488B4510 		movq	16(%rbp), %rax
 822 003c 48898558 		movq	%rax, -424(%rbp)
 822      FEFFFF
 823 0043 488B4518 		movq	24(%rbp), %rax
 824 0047 48898550 		movq	%rax, -432(%rbp)
 824      FEFFFF
 825              		.loc 1 258 1
 826 004e 64488B04 		movq	%fs:40, %rax
 826      25280000 
 826      00
 827 0057 488945F8 		movq	%rax, -8(%rbp)
 828 005b 31C0     		xorl	%eax, %eax
 259:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     int ret;
 260:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_ecdsa_context ecdsa;
 261:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 262:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_ecdsa_init( &ecdsa );
 829              		.loc 1 262 5
 830 005d 488D85A0 		leaq	-352(%rbp), %rax
 830      FEFFFF
 831 0064 4889C7   		movq	%rax, %rdi
 832 0067 E8000000 		call	mbedtls_ecdsa_init@PLT
 832      00
 263:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 264:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( ( ret = mbedtls_ecdsa_from_keypair( &ecdsa, ctx ) ) == 0 )
 833              		.loc 1 264 17
 834 006c 488B9588 		movq	-376(%rbp), %rdx
 834      FEFFFF
 835 0073 488D85A0 		leaq	-352(%rbp), %rax
 835      FEFFFF
 836 007a 4889D6   		movq	%rdx, %rsi
 837 007d 4889C7   		movq	%rax, %rdi
 838 0080 E8000000 		call	mbedtls_ecdsa_from_keypair@PLT
 838      00
 839 0085 89859CFE 		movl	%eax, -356(%rbp)
 839      FFFF
 840              		.loc 1 264 7
 841 008b 83BD9CFE 		cmpl	$0, -356(%rbp)
 841      FFFF00
 842 0092 754D     		jne	.L54
 265:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         ret = ecdsa_sign_wrap( &ecdsa, md_alg, hash, hash_len, sig, sig_len,
 843              		.loc 1 265 15
 844 0094 4C8B8560 		movq	-416(%rbp), %r8
 844      FEFFFF
 845 009b 488BBD68 		movq	-408(%rbp), %rdi
 845      FEFFFF
 846 00a2 488B8D70 		movq	-400(%rbp), %rcx
 846      FEFFFF
 847 00a9 488B9578 		movq	-392(%rbp), %rdx
 847      FEFFFF
 848 00b0 8BB584FE 		movl	-380(%rbp), %esi
GAS LISTING /tmp/ccCBR1Ba.s 			page 23


 848      FFFF
 849 00b6 488D85A0 		leaq	-352(%rbp), %rax
 849      FEFFFF
 850 00bd FFB550FE 		pushq	-432(%rbp)
 850      FFFF
 851 00c3 FFB558FE 		pushq	-424(%rbp)
 851      FFFF
 852 00c9 4D89C1   		movq	%r8, %r9
 853 00cc 4989F8   		movq	%rdi, %r8
 854 00cf 4889C7   		movq	%rax, %rdi
 855 00d2 E8000000 		call	ecdsa_sign_wrap
 855      00
 856 00d7 4883C410 		addq	$16, %rsp
 857 00db 89859CFE 		movl	%eax, -356(%rbp)
 857      FFFF
 858              	.L54:
 266:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                                f_rng, p_rng );
 267:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 268:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_ecdsa_free( &ecdsa );
 859              		.loc 1 268 5
 860 00e1 488D85A0 		leaq	-352(%rbp), %rax
 860      FEFFFF
 861 00e8 4889C7   		movq	%rax, %rdi
 862 00eb E8000000 		call	mbedtls_ecdsa_free@PLT
 862      00
 269:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 270:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( ret );
 863              		.loc 1 270 11
 864 00f0 8B859CFE 		movl	-356(%rbp), %eax
 864      FFFF
 271:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 865              		.loc 1 271 1
 866 00f6 488B4DF8 		movq	-8(%rbp), %rcx
 867 00fa 6448330C 		xorq	%fs:40, %rcx
 867      25280000 
 867      00
 868 0103 7405     		je	.L56
 869 0105 E8000000 		call	__stack_chk_fail@PLT
 869      00
 870              	.L56:
 871 010a C9       		leave
 872              	.LCFI41:
 873              		.cfi_def_cfa 7, 8
 874 010b C3       		ret
 875              		.cfi_endproc
 876              	.LFE22:
 878              		.section	.text.eckey_check_pair,"ax",@progbits
 880              	eckey_check_pair:
 881              	.LFB23:
 272:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 273:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
 274:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** /* Forward declarations */
 275:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int ecdsa_verify_rs_wrap( void *ctx, mbedtls_md_type_t md_alg,
 276:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                        const unsigned char *hash, size_t hash_len,
 277:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                        const unsigned char *sig, size_t sig_len,
 278:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                        void *rs_ctx );
 279:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
GAS LISTING /tmp/ccCBR1Ba.s 			page 24


 280:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int ecdsa_sign_rs_wrap( void *ctx, mbedtls_md_type_t md_alg,
 281:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    const unsigned char *hash, size_t hash_len,
 282:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    unsigned char *sig, size_t *sig_len,
 283:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    int (*f_rng)(void *, unsigned char *, size_t), void *p_rng,
 284:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    void *rs_ctx );
 285:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 286:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** /*
 287:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  * Restart context for ECDSA operations with ECKEY context
 288:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  *
 289:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  * We need to store an actual ECDSA context, as we need to pass the same to
 290:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  * the underlying ecdsa function, so we can't create it on the fly every time.
 291:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  */
 292:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** typedef struct
 293:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 294:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_ecdsa_restart_ctx ecdsa_rs;
 295:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_ecdsa_context ecdsa_ctx;
 296:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** } eckey_restart_ctx;
 297:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 298:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static void *eckey_rs_alloc( void )
 299:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 300:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_restart_ctx *rs_ctx;
 301:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 302:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     void *ctx = mbedtls_calloc( 1, sizeof( eckey_restart_ctx ) );
 303:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 304:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( ctx != NULL )
 305:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     {
 306:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         rs_ctx = ctx;
 307:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         mbedtls_ecdsa_restart_init( &rs_ctx->ecdsa_rs );
 308:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         mbedtls_ecdsa_init( &rs_ctx->ecdsa_ctx );
 309:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     }
 310:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 311:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( ctx );
 312:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 313:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 314:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static void eckey_rs_free( void *ctx )
 315:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 316:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_restart_ctx *rs_ctx;
 317:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 318:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( ctx == NULL)
 319:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         return;
 320:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 321:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     rs_ctx = ctx;
 322:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_ecdsa_restart_free( &rs_ctx->ecdsa_rs );
 323:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_ecdsa_free( &rs_ctx->ecdsa_ctx );
 324:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 325:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_free( ctx );
 326:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 327:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 328:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int eckey_verify_rs_wrap( void *ctx, mbedtls_md_type_t md_alg,
 329:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                        const unsigned char *hash, size_t hash_len,
 330:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                        const unsigned char *sig, size_t sig_len,
 331:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                        void *rs_ctx )
 332:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 333:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     int ret;
 334:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_restart_ctx *rs = rs_ctx;
 335:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 336:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     /* Should never happen */
GAS LISTING /tmp/ccCBR1Ba.s 			page 25


 337:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( rs == NULL )
 338:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         return( MBEDTLS_ERR_PK_BAD_INPUT_DATA );
 339:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 340:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     /* set up our own sub-context if needed (that is, on first run) */
 341:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( rs->ecdsa_ctx.grp.pbits == 0 )
 342:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         MBEDTLS_MPI_CHK( mbedtls_ecdsa_from_keypair( &rs->ecdsa_ctx, ctx ) );
 343:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 344:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     MBEDTLS_MPI_CHK( ecdsa_verify_rs_wrap( &rs->ecdsa_ctx,
 345:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                                            md_alg, hash, hash_len,
 346:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                                            sig, sig_len, &rs->ecdsa_rs ) );
 347:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 348:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** cleanup:
 349:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( ret );
 350:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 351:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 352:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int eckey_sign_rs_wrap( void *ctx, mbedtls_md_type_t md_alg,
 353:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    const unsigned char *hash, size_t hash_len,
 354:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    unsigned char *sig, size_t *sig_len,
 355:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    int (*f_rng)(void *, unsigned char *, size_t), void *p_rng,
 356:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                        void *rs_ctx )
 357:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 358:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     int ret;
 359:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_restart_ctx *rs = rs_ctx;
 360:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 361:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     /* Should never happen */
 362:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( rs == NULL )
 363:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         return( MBEDTLS_ERR_PK_BAD_INPUT_DATA );
 364:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 365:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     /* set up our own sub-context if needed (that is, on first run) */
 366:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( rs->ecdsa_ctx.grp.pbits == 0 )
 367:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         MBEDTLS_MPI_CHK( mbedtls_ecdsa_from_keypair( &rs->ecdsa_ctx, ctx ) );
 368:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 369:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     MBEDTLS_MPI_CHK( ecdsa_sign_rs_wrap( &rs->ecdsa_ctx, md_alg,
 370:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                                          hash, hash_len, sig, sig_len,
 371:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                                          f_rng, p_rng, &rs->ecdsa_rs ) );
 372:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 373:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** cleanup:
 374:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( ret );
 375:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 376:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif /* MBEDTLS_ECP_RESTARTABLE */
 377:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif /* MBEDTLS_ECDSA_C */
 378:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 379:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int eckey_check_pair( const void *pub, const void *prv )
 380:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 882              		.loc 1 380 1
 883              		.cfi_startproc
 884 0000 F30F1EFA 		endbr64
 885 0004 55       		pushq	%rbp
 886              	.LCFI42:
 887              		.cfi_def_cfa_offset 16
 888              		.cfi_offset 6, -16
 889 0005 4889E5   		movq	%rsp, %rbp
 890              	.LCFI43:
 891              		.cfi_def_cfa_register 6
 892 0008 4883EC20 		subq	$32, %rsp
 893 000c 48897DE8 		movq	%rdi, -24(%rbp)
 894 0010 488975E0 		movq	%rsi, -32(%rbp)
GAS LISTING /tmp/ccCBR1Ba.s 			page 26


 895              		.loc 1 380 1
 896 0014 64488B04 		movq	%fs:40, %rax
 896      25280000 
 896      00
 897 001d 488945F8 		movq	%rax, -8(%rbp)
 898 0021 31C0     		xorl	%eax, %eax
 381:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( mbedtls_ecp_check_pub_priv( (const mbedtls_ecp_keypair *) pub,
 899              		.loc 1 381 13
 900 0023 488B55E0 		movq	-32(%rbp), %rdx
 901 0027 488B45E8 		movq	-24(%rbp), %rax
 902 002b 4889D6   		movq	%rdx, %rsi
 903 002e 4889C7   		movq	%rax, %rdi
 904 0031 E8000000 		call	mbedtls_ecp_check_pub_priv@PLT
 904      00
 382:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                                 (const mbedtls_ecp_keypair *) prv ) );
 383:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 905              		.loc 1 383 1
 906 0036 488B4DF8 		movq	-8(%rbp), %rcx
 907 003a 6448330C 		xorq	%fs:40, %rcx
 907      25280000 
 907      00
 908 0043 7405     		je	.L59
 909 0045 E8000000 		call	__stack_chk_fail@PLT
 909      00
 910              	.L59:
 911 004a C9       		leave
 912              	.LCFI44:
 913              		.cfi_def_cfa 7, 8
 914 004b C3       		ret
 915              		.cfi_endproc
 916              	.LFE23:
 918              		.section	.text.eckey_alloc_wrap,"ax",@progbits
 920              	eckey_alloc_wrap:
 921              	.LFB24:
 384:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 385:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static void *eckey_alloc_wrap( void )
 386:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 922              		.loc 1 386 1
 923              		.cfi_startproc
 924 0000 F30F1EFA 		endbr64
 925 0004 55       		pushq	%rbp
 926              	.LCFI45:
 927              		.cfi_def_cfa_offset 16
 928              		.cfi_offset 6, -16
 929 0005 4889E5   		movq	%rsp, %rbp
 930              	.LCFI46:
 931              		.cfi_def_cfa_register 6
 932 0008 4883EC10 		subq	$16, %rsp
 933              		.loc 1 386 1
 934 000c 64488B04 		movq	%fs:40, %rax
 934      25280000 
 934      00
 935 0015 488945F8 		movq	%rax, -8(%rbp)
 936 0019 31C0     		xorl	%eax, %eax
 387:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     void *ctx = mbedtls_calloc( 1, sizeof( mbedtls_ecp_keypair ) );
 937              		.loc 1 387 17
 938 001b BE580100 		movl	$344, %esi
GAS LISTING /tmp/ccCBR1Ba.s 			page 27


 938      00
 939 0020 BF010000 		movl	$1, %edi
 939      00
 940 0025 E8000000 		call	mbedtls_calloc@PLT
 940      00
 941 002a 488945F0 		movq	%rax, -16(%rbp)
 388:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 389:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( ctx != NULL )
 942              		.loc 1 389 7
 943 002e 48837DF0 		cmpq	$0, -16(%rbp)
 943      00
 944 0033 740C     		je	.L61
 390:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         mbedtls_ecp_keypair_init( ctx );
 945              		.loc 1 390 9
 946 0035 488B45F0 		movq	-16(%rbp), %rax
 947 0039 4889C7   		movq	%rax, %rdi
 948 003c E8000000 		call	mbedtls_ecp_keypair_init@PLT
 948      00
 949              	.L61:
 391:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 392:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( ctx );
 950              		.loc 1 392 11
 951 0041 488B45F0 		movq	-16(%rbp), %rax
 393:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 952              		.loc 1 393 1
 953 0045 488B55F8 		movq	-8(%rbp), %rdx
 954 0049 64483314 		xorq	%fs:40, %rdx
 954      25280000 
 954      00
 955 0052 7405     		je	.L63
 956 0054 E8000000 		call	__stack_chk_fail@PLT
 956      00
 957              	.L63:
 958 0059 C9       		leave
 959              	.LCFI47:
 960              		.cfi_def_cfa 7, 8
 961 005a C3       		ret
 962              		.cfi_endproc
 963              	.LFE24:
 965              		.section	.text.eckey_free_wrap,"ax",@progbits
 967              	eckey_free_wrap:
 968              	.LFB25:
 394:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 395:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static void eckey_free_wrap( void *ctx )
 396:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 969              		.loc 1 396 1
 970              		.cfi_startproc
 971 0000 F30F1EFA 		endbr64
 972 0004 55       		pushq	%rbp
 973              	.LCFI48:
 974              		.cfi_def_cfa_offset 16
 975              		.cfi_offset 6, -16
 976 0005 4889E5   		movq	%rsp, %rbp
 977              	.LCFI49:
 978              		.cfi_def_cfa_register 6
 979 0008 4883EC20 		subq	$32, %rsp
 980 000c 48897DE8 		movq	%rdi, -24(%rbp)
GAS LISTING /tmp/ccCBR1Ba.s 			page 28


 981              		.loc 1 396 1
 982 0010 64488B04 		movq	%fs:40, %rax
 982      25280000 
 982      00
 983 0019 488945F8 		movq	%rax, -8(%rbp)
 984 001d 31C0     		xorl	%eax, %eax
 397:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_ecp_keypair_free( (mbedtls_ecp_keypair *) ctx );
 985              		.loc 1 397 5
 986 001f 488B45E8 		movq	-24(%rbp), %rax
 987 0023 4889C7   		movq	%rax, %rdi
 988 0026 E8000000 		call	mbedtls_ecp_keypair_free@PLT
 988      00
 398:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_free( ctx );
 989              		.loc 1 398 5
 990 002b 488B45E8 		movq	-24(%rbp), %rax
 991 002f 4889C7   		movq	%rax, %rdi
 992 0032 E8000000 		call	mbedtls_free@PLT
 992      00
 399:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 993              		.loc 1 399 1
 994 0037 90       		nop
 995 0038 488B45F8 		movq	-8(%rbp), %rax
 996 003c 64483304 		xorq	%fs:40, %rax
 996      25280000 
 996      00
 997 0045 7405     		je	.L65
 998 0047 E8000000 		call	__stack_chk_fail@PLT
 998      00
 999              	.L65:
 1000 004c C9       		leave
 1001              	.LCFI50:
 1002              		.cfi_def_cfa 7, 8
 1003 004d C3       		ret
 1004              		.cfi_endproc
 1005              	.LFE25:
 1007              		.section	.rodata
 1008              	.LC3:
 1009 0010 65636B65 		.string	"eckey.Q"
 1009      792E5100 
 1010              		.section	.text.eckey_debug,"ax",@progbits
 1012              	eckey_debug:
 1013              	.LFB26:
 400:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 401:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static void eckey_debug( const void *ctx, mbedtls_pk_debug_item *items )
 402:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 1014              		.loc 1 402 1
 1015              		.cfi_startproc
 1016 0000 F30F1EFA 		endbr64
 1017 0004 55       		pushq	%rbp
 1018              	.LCFI51:
 1019              		.cfi_def_cfa_offset 16
 1020              		.cfi_offset 6, -16
 1021 0005 4889E5   		movq	%rsp, %rbp
 1022              	.LCFI52:
 1023              		.cfi_def_cfa_register 6
 1024 0008 4883EC20 		subq	$32, %rsp
 1025 000c 48897DE8 		movq	%rdi, -24(%rbp)
GAS LISTING /tmp/ccCBR1Ba.s 			page 29


 1026 0010 488975E0 		movq	%rsi, -32(%rbp)
 1027              		.loc 1 402 1
 1028 0014 64488B04 		movq	%fs:40, %rax
 1028      25280000 
 1028      00
 1029 001d 488945F8 		movq	%rax, -8(%rbp)
 1030 0021 31C0     		xorl	%eax, %eax
 403:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     items->type = MBEDTLS_PK_DEBUG_ECP;
 1031              		.loc 1 403 17
 1032 0023 488B45E0 		movq	-32(%rbp), %rax
 1033 0027 C7000200 		movl	$2, (%rax)
 1033      0000
 404:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     items->name = "eckey.Q";
 1034              		.loc 1 404 17
 1035 002d 488B45E0 		movq	-32(%rbp), %rax
 1036 0031 488D1500 		leaq	.LC3(%rip), %rdx
 1036      000000
 1037 0038 48895008 		movq	%rdx, 8(%rax)
 405:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     items->value = &( ((mbedtls_ecp_keypair *) ctx)->Q );
 1038              		.loc 1 405 20
 1039 003c 488B45E8 		movq	-24(%rbp), %rax
 1040 0040 488D9010 		leaq	272(%rax), %rdx
 1040      010000
 1041              		.loc 1 405 18
 1042 0047 488B45E0 		movq	-32(%rbp), %rax
 1043 004b 48895010 		movq	%rdx, 16(%rax)
 406:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 1044              		.loc 1 406 1
 1045 004f 90       		nop
 1046 0050 488B45F8 		movq	-8(%rbp), %rax
 1047 0054 64483304 		xorq	%fs:40, %rax
 1047      25280000 
 1047      00
 1048 005d 7405     		je	.L67
 1049 005f E8000000 		call	__stack_chk_fail@PLT
 1049      00
 1050              	.L67:
 1051 0064 C9       		leave
 1052              	.LCFI53:
 1053              		.cfi_def_cfa 7, 8
 1054 0065 C3       		ret
 1055              		.cfi_endproc
 1056              	.LFE26:
 1058              		.globl	mbedtls_eckey_info
 1059              		.section	.rodata
 1060              	.LC4:
 1061 0018 454300   		.string	"EC"
 1062              		.section	.data.rel.ro.local.mbedtls_eckey_info,"aw"
 1063              		.align 32
 1066              	mbedtls_eckey_info:
 1067 0000 02000000 		.long	2
 1068 0004 00000000 		.zero	4
 1069 0008 00000000 		.quad	.LC4
 1069      00000000 
 1070 0010 00000000 		.quad	eckey_get_bitlen
 1070      00000000 
 1071 0018 00000000 		.quad	eckey_can_do
GAS LISTING /tmp/ccCBR1Ba.s 			page 30


 1071      00000000 
 1072 0020 00000000 		.quad	eckey_verify_wrap
 1072      00000000 
 1073 0028 00000000 		.quad	eckey_sign_wrap
 1073      00000000 
 1074 0030 00000000 		.quad	0
 1074      00000000 
 1075 0038 00000000 		.quad	0
 1075      00000000 
 1076 0040 00000000 		.quad	eckey_check_pair
 1076      00000000 
 1077 0048 00000000 		.quad	eckey_alloc_wrap
 1077      00000000 
 1078 0050 00000000 		.quad	eckey_free_wrap
 1078      00000000 
 1079 0058 00000000 		.quad	eckey_debug
 1079      00000000 
 1080              		.section	.text.eckeydh_can_do,"ax",@progbits
 1082              	eckeydh_can_do:
 1083              	.LFB27:
 407:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 408:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** const mbedtls_pk_info_t mbedtls_eckey_info = {
 409:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     MBEDTLS_PK_ECKEY,
 410:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     "EC",
 411:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_get_bitlen,
 412:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_can_do,
 413:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if defined(MBEDTLS_ECDSA_C)
 414:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_verify_wrap,
 415:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_sign_wrap,
 416:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
 417:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_verify_rs_wrap,
 418:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_sign_rs_wrap,
 419:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif
 420:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #else /* MBEDTLS_ECDSA_C */
 421:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     NULL,
 422:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     NULL,
 423:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif /* MBEDTLS_ECDSA_C */
 424:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     NULL,
 425:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     NULL,
 426:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_check_pair,
 427:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_alloc_wrap,
 428:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_free_wrap,
 429:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if defined(MBEDTLS_ECDSA_C) && defined(MBEDTLS_ECP_RESTARTABLE)
 430:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_rs_alloc,
 431:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_rs_free,
 432:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif
 433:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_debug,
 434:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** };
 435:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 436:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** /*
 437:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  * EC key restricted to ECDH
 438:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  */
 439:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int eckeydh_can_do( mbedtls_pk_type_t type )
 440:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 1084              		.loc 1 440 1
 1085              		.cfi_startproc
 1086 0000 F30F1EFA 		endbr64
GAS LISTING /tmp/ccCBR1Ba.s 			page 31


 1087 0004 55       		pushq	%rbp
 1088              	.LCFI54:
 1089              		.cfi_def_cfa_offset 16
 1090              		.cfi_offset 6, -16
 1091 0005 4889E5   		movq	%rsp, %rbp
 1092              	.LCFI55:
 1093              		.cfi_def_cfa_register 6
 1094 0008 4883EC20 		subq	$32, %rsp
 1095 000c 897DEC   		movl	%edi, -20(%rbp)
 1096              		.loc 1 440 1
 1097 000f 64488B04 		movq	%fs:40, %rax
 1097      25280000 
 1097      00
 1098 0018 488945F8 		movq	%rax, -8(%rbp)
 1099 001c 31C0     		xorl	%eax, %eax
 441:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( type == MBEDTLS_PK_ECKEY ||
 1100              		.loc 1 441 38
 1101 001e 837DEC02 		cmpl	$2, -20(%rbp)
 1102 0022 7406     		je	.L69
 1103              		.loc 1 441 38 is_stmt 0 discriminator 2
 1104 0024 837DEC03 		cmpl	$3, -20(%rbp)
 1105 0028 7507     		jne	.L70
 1106              	.L69:
 1107              		.loc 1 441 38 discriminator 3
 1108 002a B8010000 		movl	$1, %eax
 1108      00
 1109 002f EB05     		jmp	.L72
 1110              	.L70:
 1111              		.loc 1 441 38 discriminator 4
 1112 0031 B8000000 		movl	$0, %eax
 1112      00
 1113              	.L72:
 442:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****             type == MBEDTLS_PK_ECKEY_DH );
 443:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 1114              		.loc 1 443 1 is_stmt 1 discriminator 7
 1115 0036 488B55F8 		movq	-8(%rbp), %rdx
 1116 003a 64483314 		xorq	%fs:40, %rdx
 1116      25280000 
 1116      00
 1117 0043 7405     		je	.L73
 1118              		.loc 1 443 1 is_stmt 0
 1119 0045 E8000000 		call	__stack_chk_fail@PLT
 1119      00
 1120              	.L73:
 1121 004a C9       		leave
 1122              	.LCFI56:
 1123              		.cfi_def_cfa 7, 8
 1124 004b C3       		ret
 1125              		.cfi_endproc
 1126              	.LFE27:
 1128              		.globl	mbedtls_eckeydh_info
 1129              		.section	.rodata
 1130              	.LC5:
 1131 001b 45435F44 		.string	"EC_DH"
 1131      4800
 1132              		.section	.data.rel.ro.local.mbedtls_eckeydh_info,"aw"
 1133              		.align 32
GAS LISTING /tmp/ccCBR1Ba.s 			page 32


 1136              	mbedtls_eckeydh_info:
 1137 0000 03000000 		.long	3
 1138 0004 00000000 		.zero	4
 1139 0008 00000000 		.quad	.LC5
 1139      00000000 
 1140 0010 00000000 		.quad	eckey_get_bitlen
 1140      00000000 
 1141 0018 00000000 		.quad	eckeydh_can_do
 1141      00000000 
 1142 0020 00000000 		.quad	0
 1142      00000000 
 1143 0028 00000000 		.quad	0
 1143      00000000 
 1144 0030 00000000 		.quad	0
 1144      00000000 
 1145 0038 00000000 		.quad	0
 1145      00000000 
 1146 0040 00000000 		.quad	eckey_check_pair
 1146      00000000 
 1147 0048 00000000 		.quad	eckey_alloc_wrap
 1147      00000000 
 1148 0050 00000000 		.quad	eckey_free_wrap
 1148      00000000 
 1149 0058 00000000 		.quad	eckey_debug
 1149      00000000 
 1150              		.section	.text.ecdsa_can_do,"ax",@progbits
 1152              	ecdsa_can_do:
 1153              	.LFB28:
 444:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 445:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** const mbedtls_pk_info_t mbedtls_eckeydh_info = {
 446:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     MBEDTLS_PK_ECKEY_DH,
 447:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     "EC_DH",
 448:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_get_bitlen,         /* Same underlying key structure */
 449:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckeydh_can_do,
 450:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     NULL,
 451:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     NULL,
 452:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if defined(MBEDTLS_ECDSA_C) && defined(MBEDTLS_ECP_RESTARTABLE)
 453:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     NULL,
 454:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     NULL,
 455:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif
 456:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     NULL,
 457:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     NULL,
 458:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_check_pair,
 459:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_alloc_wrap,       /* Same underlying key structure */
 460:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_free_wrap,        /* Same underlying key structure */
 461:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if defined(MBEDTLS_ECDSA_C) && defined(MBEDTLS_ECP_RESTARTABLE)
 462:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     NULL,
 463:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     NULL,
 464:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif
 465:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_debug,            /* Same underlying key structure */
 466:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** };
 467:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif /* MBEDTLS_ECP_C */
 468:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 469:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if defined(MBEDTLS_ECDSA_C)
 470:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int ecdsa_can_do( mbedtls_pk_type_t type )
 471:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 1154              		.loc 1 471 1 is_stmt 1
GAS LISTING /tmp/ccCBR1Ba.s 			page 33


 1155              		.cfi_startproc
 1156 0000 F30F1EFA 		endbr64
 1157 0004 55       		pushq	%rbp
 1158              	.LCFI57:
 1159              		.cfi_def_cfa_offset 16
 1160              		.cfi_offset 6, -16
 1161 0005 4889E5   		movq	%rsp, %rbp
 1162              	.LCFI58:
 1163              		.cfi_def_cfa_register 6
 1164 0008 4883EC20 		subq	$32, %rsp
 1165 000c 897DEC   		movl	%edi, -20(%rbp)
 1166              		.loc 1 471 1
 1167 000f 64488B04 		movq	%fs:40, %rax
 1167      25280000 
 1167      00
 1168 0018 488945F8 		movq	%rax, -8(%rbp)
 1169 001c 31C0     		xorl	%eax, %eax
 472:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( type == MBEDTLS_PK_ECDSA );
 1170              		.loc 1 472 18
 1171 001e 837DEC04 		cmpl	$4, -20(%rbp)
 1172 0022 0F94C0   		sete	%al
 1173 0025 0FB6C0   		movzbl	%al, %eax
 473:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 1174              		.loc 1 473 1
 1175 0028 488B55F8 		movq	-8(%rbp), %rdx
 1176 002c 64483314 		xorq	%fs:40, %rdx
 1176      25280000 
 1176      00
 1177 0035 7405     		je	.L76
 1178 0037 E8000000 		call	__stack_chk_fail@PLT
 1178      00
 1179              	.L76:
 1180 003c C9       		leave
 1181              	.LCFI59:
 1182              		.cfi_def_cfa 7, 8
 1183 003d C3       		ret
 1184              		.cfi_endproc
 1185              	.LFE28:
 1187              		.section	.text.ecdsa_verify_wrap,"ax",@progbits
 1189              	ecdsa_verify_wrap:
 1190              	.LFB29:
 474:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 475:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int ecdsa_verify_wrap( void *ctx, mbedtls_md_type_t md_alg,
 476:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                        const unsigned char *hash, size_t hash_len,
 477:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                        const unsigned char *sig, size_t sig_len )
 478:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 1191              		.loc 1 478 1
 1192              		.cfi_startproc
 1193 0000 F30F1EFA 		endbr64
 1194 0004 55       		pushq	%rbp
 1195              	.LCFI60:
 1196              		.cfi_def_cfa_offset 16
 1197              		.cfi_offset 6, -16
 1198 0005 4889E5   		movq	%rsp, %rbp
 1199              	.LCFI61:
 1200              		.cfi_def_cfa_register 6
 1201 0008 4883EC40 		subq	$64, %rsp
GAS LISTING /tmp/ccCBR1Ba.s 			page 34


 1202 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1203 0010 8975E4   		movl	%esi, -28(%rbp)
 1204 0013 488955D8 		movq	%rdx, -40(%rbp)
 1205 0017 48894DD0 		movq	%rcx, -48(%rbp)
 1206 001b 4C8945C8 		movq	%r8, -56(%rbp)
 1207 001f 4C894DC0 		movq	%r9, -64(%rbp)
 1208              		.loc 1 478 1
 1209 0023 64488B04 		movq	%fs:40, %rax
 1209      25280000 
 1209      00
 1210 002c 488945F8 		movq	%rax, -8(%rbp)
 1211 0030 31C0     		xorl	%eax, %eax
 479:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     int ret;
 480:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     ((void) md_alg);
 481:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 482:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     ret = mbedtls_ecdsa_read_signature( (mbedtls_ecdsa_context *) ctx,
 1212              		.loc 1 482 11
 1213 0032 488B7DC0 		movq	-64(%rbp), %rdi
 1214 0036 488B4DC8 		movq	-56(%rbp), %rcx
 1215 003a 488B55D0 		movq	-48(%rbp), %rdx
 1216 003e 488B75D8 		movq	-40(%rbp), %rsi
 1217 0042 488B45E8 		movq	-24(%rbp), %rax
 1218 0046 4989F8   		movq	%rdi, %r8
 1219 0049 4889C7   		movq	%rax, %rdi
 1220 004c E8000000 		call	mbedtls_ecdsa_read_signature@PLT
 1220      00
 1221 0051 8945F4   		movl	%eax, -12(%rbp)
 483:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                                 hash, hash_len, sig, sig_len );
 484:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 485:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( ret == MBEDTLS_ERR_ECP_SIG_LEN_MISMATCH )
 1222              		.loc 1 485 7
 1223 0054 817DF400 		cmpl	$-19456, -12(%rbp)
 1223      B4FFFF
 1224 005b 7507     		jne	.L78
 486:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         return( MBEDTLS_ERR_PK_SIG_LEN_MISMATCH );
 1225              		.loc 1 486 15
 1226 005d B800C7FF 		movl	$-14592, %eax
 1226      FF
 1227 0062 EB03     		jmp	.L79
 1228              	.L78:
 487:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 488:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( ret );
 1229              		.loc 1 488 11
 1230 0064 8B45F4   		movl	-12(%rbp), %eax
 1231              	.L79:
 489:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 1232              		.loc 1 489 1
 1233 0067 488B55F8 		movq	-8(%rbp), %rdx
 1234 006b 64483314 		xorq	%fs:40, %rdx
 1234      25280000 
 1234      00
 1235 0074 7405     		je	.L80
 1236 0076 E8000000 		call	__stack_chk_fail@PLT
 1236      00
 1237              	.L80:
 1238 007b C9       		leave
 1239              	.LCFI62:
GAS LISTING /tmp/ccCBR1Ba.s 			page 35


 1240              		.cfi_def_cfa 7, 8
 1241 007c C3       		ret
 1242              		.cfi_endproc
 1243              	.LFE29:
 1245              		.section	.text.ecdsa_sign_wrap,"ax",@progbits
 1247              	ecdsa_sign_wrap:
 1248              	.LFB30:
 490:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 491:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int ecdsa_sign_wrap( void *ctx, mbedtls_md_type_t md_alg,
 492:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    const unsigned char *hash, size_t hash_len,
 493:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    unsigned char *sig, size_t *sig_len,
 494:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    int (*f_rng)(void *, unsigned char *, size_t), void *p_rng )
 495:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 1249              		.loc 1 495 1
 1250              		.cfi_startproc
 1251 0000 F30F1EFA 		endbr64
 1252 0004 55       		pushq	%rbp
 1253              	.LCFI63:
 1254              		.cfi_def_cfa_offset 16
 1255              		.cfi_offset 6, -16
 1256 0005 4889E5   		movq	%rsp, %rbp
 1257              	.LCFI64:
 1258              		.cfi_def_cfa_register 6
 1259 0008 4883EC50 		subq	$80, %rsp
 1260 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1261 0010 8975E4   		movl	%esi, -28(%rbp)
 1262 0013 488955D8 		movq	%rdx, -40(%rbp)
 1263 0017 48894DD0 		movq	%rcx, -48(%rbp)
 1264 001b 4C8945C8 		movq	%r8, -56(%rbp)
 1265 001f 4C894DC0 		movq	%r9, -64(%rbp)
 1266 0023 488B4510 		movq	16(%rbp), %rax
 1267 0027 488945B8 		movq	%rax, -72(%rbp)
 1268 002b 488B4518 		movq	24(%rbp), %rax
 1269 002f 488945B0 		movq	%rax, -80(%rbp)
 1270              		.loc 1 495 1
 1271 0033 64488B04 		movq	%fs:40, %rax
 1271      25280000 
 1271      00
 1272 003c 488945F8 		movq	%rax, -8(%rbp)
 1273 0040 31C0     		xorl	%eax, %eax
 496:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( mbedtls_ecdsa_write_signature( (mbedtls_ecdsa_context *) ctx,
 1274              		.loc 1 496 13
 1275 0042 4C8B45C0 		movq	-64(%rbp), %r8
 1276 0046 488B7DC8 		movq	-56(%rbp), %rdi
 1277 004a 488B4DD0 		movq	-48(%rbp), %rcx
 1278 004e 488B55D8 		movq	-40(%rbp), %rdx
 1279 0052 8B75E4   		movl	-28(%rbp), %esi
 1280 0055 488B45E8 		movq	-24(%rbp), %rax
 1281 0059 FF75B0   		pushq	-80(%rbp)
 1282 005c FF75B8   		pushq	-72(%rbp)
 1283 005f 4D89C1   		movq	%r8, %r9
 1284 0062 4989F8   		movq	%rdi, %r8
 1285 0065 4889C7   		movq	%rax, %rdi
 1286 0068 E8000000 		call	mbedtls_ecdsa_write_signature@PLT
 1286      00
 1287 006d 4883C410 		addq	$16, %rsp
 497:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                 md_alg, hash, hash_len, sig, sig_len, f_rng, p_rng ) );
GAS LISTING /tmp/ccCBR1Ba.s 			page 36


 498:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 1288              		.loc 1 498 1
 1289 0071 488B55F8 		movq	-8(%rbp), %rdx
 1290 0075 64483314 		xorq	%fs:40, %rdx
 1290      25280000 
 1290      00
 1291 007e 7405     		je	.L83
 1292 0080 E8000000 		call	__stack_chk_fail@PLT
 1292      00
 1293              	.L83:
 1294 0085 C9       		leave
 1295              	.LCFI65:
 1296              		.cfi_def_cfa 7, 8
 1297 0086 C3       		ret
 1298              		.cfi_endproc
 1299              	.LFE30:
 1301              		.section	.text.ecdsa_alloc_wrap,"ax",@progbits
 1303              	ecdsa_alloc_wrap:
 1304              	.LFB31:
 499:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 500:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
 501:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int ecdsa_verify_rs_wrap( void *ctx, mbedtls_md_type_t md_alg,
 502:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                        const unsigned char *hash, size_t hash_len,
 503:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                        const unsigned char *sig, size_t sig_len,
 504:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                        void *rs_ctx )
 505:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 506:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     int ret;
 507:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     ((void) md_alg);
 508:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 509:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     ret = mbedtls_ecdsa_read_signature_restartable(
 510:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****             (mbedtls_ecdsa_context *) ctx,
 511:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****             hash, hash_len, sig, sig_len,
 512:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****             (mbedtls_ecdsa_restart_ctx *) rs_ctx );
 513:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 514:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( ret == MBEDTLS_ERR_ECP_SIG_LEN_MISMATCH )
 515:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         return( MBEDTLS_ERR_PK_SIG_LEN_MISMATCH );
 516:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 517:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( ret );
 518:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 519:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 520:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int ecdsa_sign_rs_wrap( void *ctx, mbedtls_md_type_t md_alg,
 521:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    const unsigned char *hash, size_t hash_len,
 522:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    unsigned char *sig, size_t *sig_len,
 523:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    int (*f_rng)(void *, unsigned char *, size_t), void *p_rng,
 524:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    void *rs_ctx )
 525:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 526:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( mbedtls_ecdsa_write_signature_restartable(
 527:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                 (mbedtls_ecdsa_context *) ctx,
 528:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                 md_alg, hash, hash_len, sig, sig_len, f_rng, p_rng,
 529:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                 (mbedtls_ecdsa_restart_ctx *) rs_ctx ) );
 530:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 531:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 532:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif /* MBEDTLS_ECP_RESTARTABLE */
 533:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 534:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static void *ecdsa_alloc_wrap( void )
 535:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 1305              		.loc 1 535 1
GAS LISTING /tmp/ccCBR1Ba.s 			page 37


 1306              		.cfi_startproc
 1307 0000 F30F1EFA 		endbr64
 1308 0004 55       		pushq	%rbp
 1309              	.LCFI66:
 1310              		.cfi_def_cfa_offset 16
 1311              		.cfi_offset 6, -16
 1312 0005 4889E5   		movq	%rsp, %rbp
 1313              	.LCFI67:
 1314              		.cfi_def_cfa_register 6
 1315 0008 4883EC10 		subq	$16, %rsp
 1316              		.loc 1 535 1
 1317 000c 64488B04 		movq	%fs:40, %rax
 1317      25280000 
 1317      00
 1318 0015 488945F8 		movq	%rax, -8(%rbp)
 1319 0019 31C0     		xorl	%eax, %eax
 536:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     void *ctx = mbedtls_calloc( 1, sizeof( mbedtls_ecdsa_context ) );
 1320              		.loc 1 536 17
 1321 001b BE580100 		movl	$344, %esi
 1321      00
 1322 0020 BF010000 		movl	$1, %edi
 1322      00
 1323 0025 E8000000 		call	mbedtls_calloc@PLT
 1323      00
 1324 002a 488945F0 		movq	%rax, -16(%rbp)
 537:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 538:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( ctx != NULL )
 1325              		.loc 1 538 7
 1326 002e 48837DF0 		cmpq	$0, -16(%rbp)
 1326      00
 1327 0033 740C     		je	.L85
 539:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         mbedtls_ecdsa_init( (mbedtls_ecdsa_context *) ctx );
 1328              		.loc 1 539 9
 1329 0035 488B45F0 		movq	-16(%rbp), %rax
 1330 0039 4889C7   		movq	%rax, %rdi
 1331 003c E8000000 		call	mbedtls_ecdsa_init@PLT
 1331      00
 1332              	.L85:
 540:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 541:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( ctx );
 1333              		.loc 1 541 11
 1334 0041 488B45F0 		movq	-16(%rbp), %rax
 542:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 1335              		.loc 1 542 1
 1336 0045 488B55F8 		movq	-8(%rbp), %rdx
 1337 0049 64483314 		xorq	%fs:40, %rdx
 1337      25280000 
 1337      00
 1338 0052 7405     		je	.L87
 1339 0054 E8000000 		call	__stack_chk_fail@PLT
 1339      00
 1340              	.L87:
 1341 0059 C9       		leave
 1342              	.LCFI68:
 1343              		.cfi_def_cfa 7, 8
 1344 005a C3       		ret
 1345              		.cfi_endproc
GAS LISTING /tmp/ccCBR1Ba.s 			page 38


 1346              	.LFE31:
 1348              		.section	.text.ecdsa_free_wrap,"ax",@progbits
 1350              	ecdsa_free_wrap:
 1351              	.LFB32:
 543:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 544:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static void ecdsa_free_wrap( void *ctx )
 545:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 1352              		.loc 1 545 1
 1353              		.cfi_startproc
 1354 0000 F30F1EFA 		endbr64
 1355 0004 55       		pushq	%rbp
 1356              	.LCFI69:
 1357              		.cfi_def_cfa_offset 16
 1358              		.cfi_offset 6, -16
 1359 0005 4889E5   		movq	%rsp, %rbp
 1360              	.LCFI70:
 1361              		.cfi_def_cfa_register 6
 1362 0008 4883EC20 		subq	$32, %rsp
 1363 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1364              		.loc 1 545 1
 1365 0010 64488B04 		movq	%fs:40, %rax
 1365      25280000 
 1365      00
 1366 0019 488945F8 		movq	%rax, -8(%rbp)
 1367 001d 31C0     		xorl	%eax, %eax
 546:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_ecdsa_free( (mbedtls_ecdsa_context *) ctx );
 1368              		.loc 1 546 5
 1369 001f 488B45E8 		movq	-24(%rbp), %rax
 1370 0023 4889C7   		movq	%rax, %rdi
 1371 0026 E8000000 		call	mbedtls_ecdsa_free@PLT
 1371      00
 547:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_free( ctx );
 1372              		.loc 1 547 5
 1373 002b 488B45E8 		movq	-24(%rbp), %rax
 1374 002f 4889C7   		movq	%rax, %rdi
 1375 0032 E8000000 		call	mbedtls_free@PLT
 1375      00
 548:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 1376              		.loc 1 548 1
 1377 0037 90       		nop
 1378 0038 488B45F8 		movq	-8(%rbp), %rax
 1379 003c 64483304 		xorq	%fs:40, %rax
 1379      25280000 
 1379      00
 1380 0045 7405     		je	.L89
 1381 0047 E8000000 		call	__stack_chk_fail@PLT
 1381      00
 1382              	.L89:
 1383 004c C9       		leave
 1384              	.LCFI71:
 1385              		.cfi_def_cfa 7, 8
 1386 004d C3       		ret
 1387              		.cfi_endproc
 1388              	.LFE32:
 1390              		.globl	mbedtls_ecdsa_info
 1391              		.section	.rodata
 1392              	.LC6:
GAS LISTING /tmp/ccCBR1Ba.s 			page 39


 1393 0021 45434453 		.string	"ECDSA"
 1393      4100
 1394              		.section	.data.rel.ro.local.mbedtls_ecdsa_info,"aw"
 1395              		.align 32
 1398              	mbedtls_ecdsa_info:
 1399 0000 04000000 		.long	4
 1400 0004 00000000 		.zero	4
 1401 0008 00000000 		.quad	.LC6
 1401      00000000 
 1402 0010 00000000 		.quad	eckey_get_bitlen
 1402      00000000 
 1403 0018 00000000 		.quad	ecdsa_can_do
 1403      00000000 
 1404 0020 00000000 		.quad	ecdsa_verify_wrap
 1404      00000000 
 1405 0028 00000000 		.quad	ecdsa_sign_wrap
 1405      00000000 
 1406 0030 00000000 		.quad	0
 1406      00000000 
 1407 0038 00000000 		.quad	0
 1407      00000000 
 1408 0040 00000000 		.quad	eckey_check_pair
 1408      00000000 
 1409 0048 00000000 		.quad	ecdsa_alloc_wrap
 1409      00000000 
 1410 0050 00000000 		.quad	ecdsa_free_wrap
 1410      00000000 
 1411 0058 00000000 		.quad	eckey_debug
 1411      00000000 
 1412              		.section	.text.rsa_alt_can_do,"ax",@progbits
 1414              	rsa_alt_can_do:
 1415              	.LFB33:
 549:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 550:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
 551:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static void *ecdsa_rs_alloc( void )
 552:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 553:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     void *ctx = mbedtls_calloc( 1, sizeof( mbedtls_ecdsa_restart_ctx ) );
 554:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 555:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( ctx != NULL )
 556:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         mbedtls_ecdsa_restart_init( ctx );
 557:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 558:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( ctx );
 559:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 560:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 561:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static void ecdsa_rs_free( void *ctx )
 562:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 563:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_ecdsa_restart_free( ctx );
 564:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_free( ctx );
 565:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 566:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif /* MBEDTLS_ECP_RESTARTABLE */
 567:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 568:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** const mbedtls_pk_info_t mbedtls_ecdsa_info = {
 569:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     MBEDTLS_PK_ECDSA,
 570:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     "ECDSA",
 571:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_get_bitlen,     /* Compatible key structures */
 572:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     ecdsa_can_do,
 573:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     ecdsa_verify_wrap,
GAS LISTING /tmp/ccCBR1Ba.s 			page 40


 574:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     ecdsa_sign_wrap,
 575:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
 576:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     ecdsa_verify_rs_wrap,
 577:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     ecdsa_sign_rs_wrap,
 578:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif
 579:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     NULL,
 580:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     NULL,
 581:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_check_pair,   /* Compatible key structures */
 582:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     ecdsa_alloc_wrap,
 583:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     ecdsa_free_wrap,
 584:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
 585:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     ecdsa_rs_alloc,
 586:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     ecdsa_rs_free,
 587:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif
 588:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     eckey_debug,        /* Compatible key structures */
 589:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** };
 590:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif /* MBEDTLS_ECDSA_C */
 591:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 592:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if defined(MBEDTLS_PK_RSA_ALT_SUPPORT)
 593:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** /*
 594:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  * Support for alternative RSA-private implementations
 595:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****  */
 596:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 597:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int rsa_alt_can_do( mbedtls_pk_type_t type )
 598:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 1416              		.loc 1 598 1
 1417              		.cfi_startproc
 1418 0000 F30F1EFA 		endbr64
 1419 0004 55       		pushq	%rbp
 1420              	.LCFI72:
 1421              		.cfi_def_cfa_offset 16
 1422              		.cfi_offset 6, -16
 1423 0005 4889E5   		movq	%rsp, %rbp
 1424              	.LCFI73:
 1425              		.cfi_def_cfa_register 6
 1426 0008 4883EC20 		subq	$32, %rsp
 1427 000c 897DEC   		movl	%edi, -20(%rbp)
 1428              		.loc 1 598 1
 1429 000f 64488B04 		movq	%fs:40, %rax
 1429      25280000 
 1429      00
 1430 0018 488945F8 		movq	%rax, -8(%rbp)
 1431 001c 31C0     		xorl	%eax, %eax
 599:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( type == MBEDTLS_PK_RSA );
 1432              		.loc 1 599 18
 1433 001e 837DEC01 		cmpl	$1, -20(%rbp)
 1434 0022 0F94C0   		sete	%al
 1435 0025 0FB6C0   		movzbl	%al, %eax
 600:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 1436              		.loc 1 600 1
 1437 0028 488B55F8 		movq	-8(%rbp), %rdx
 1438 002c 64483314 		xorq	%fs:40, %rdx
 1438      25280000 
 1438      00
 1439 0035 7405     		je	.L92
 1440 0037 E8000000 		call	__stack_chk_fail@PLT
 1440      00
GAS LISTING /tmp/ccCBR1Ba.s 			page 41


 1441              	.L92:
 1442 003c C9       		leave
 1443              	.LCFI74:
 1444              		.cfi_def_cfa 7, 8
 1445 003d C3       		ret
 1446              		.cfi_endproc
 1447              	.LFE33:
 1449              		.section	.text.rsa_alt_get_bitlen,"ax",@progbits
 1451              	rsa_alt_get_bitlen:
 1452              	.LFB34:
 601:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 602:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static size_t rsa_alt_get_bitlen( const void *ctx )
 603:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 1453              		.loc 1 603 1
 1454              		.cfi_startproc
 1455 0000 F30F1EFA 		endbr64
 1456 0004 55       		pushq	%rbp
 1457              	.LCFI75:
 1458              		.cfi_def_cfa_offset 16
 1459              		.cfi_offset 6, -16
 1460 0005 4889E5   		movq	%rsp, %rbp
 1461              	.LCFI76:
 1462              		.cfi_def_cfa_register 6
 1463 0008 4883EC20 		subq	$32, %rsp
 1464 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1465              		.loc 1 603 1
 1466 0010 64488B04 		movq	%fs:40, %rax
 1466      25280000 
 1466      00
 1467 0019 488945F8 		movq	%rax, -8(%rbp)
 1468 001d 31C0     		xorl	%eax, %eax
 604:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     const mbedtls_rsa_alt_context *rsa_alt = (const mbedtls_rsa_alt_context *) ctx;
 1469              		.loc 1 604 36
 1470 001f 488B45E8 		movq	-24(%rbp), %rax
 1471 0023 488945F0 		movq	%rax, -16(%rbp)
 605:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 606:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( 8 * rsa_alt->key_len_func( rsa_alt->key ) );
 1472              		.loc 1 606 24
 1473 0027 488B45F0 		movq	-16(%rbp), %rax
 1474 002b 488B5018 		movq	24(%rax), %rdx
 1475              		.loc 1 606 17
 1476 002f 488B45F0 		movq	-16(%rbp), %rax
 1477 0033 488B00   		movq	(%rax), %rax
 1478 0036 4889C7   		movq	%rax, %rdi
 1479 0039 FFD2     		call	*%rdx
 1480              	.LVL0:
 1481              		.loc 1 606 15
 1482 003b 48C1E003 		salq	$3, %rax
 607:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 1483              		.loc 1 607 1
 1484 003f 488B4DF8 		movq	-8(%rbp), %rcx
 1485 0043 6448330C 		xorq	%fs:40, %rcx
 1485      25280000 
 1485      00
 1486 004c 7405     		je	.L95
 1487 004e E8000000 		call	__stack_chk_fail@PLT
 1487      00
GAS LISTING /tmp/ccCBR1Ba.s 			page 42


 1488              	.L95:
 1489 0053 C9       		leave
 1490              	.LCFI77:
 1491              		.cfi_def_cfa 7, 8
 1492 0054 C3       		ret
 1493              		.cfi_endproc
 1494              	.LFE34:
 1496              		.section	.text.rsa_alt_sign_wrap,"ax",@progbits
 1498              	rsa_alt_sign_wrap:
 1499              	.LFB35:
 608:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 609:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int rsa_alt_sign_wrap( void *ctx, mbedtls_md_type_t md_alg,
 610:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    const unsigned char *hash, size_t hash_len,
 611:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    unsigned char *sig, size_t *sig_len,
 612:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                    int (*f_rng)(void *, unsigned char *, size_t), void *p_rng )
 613:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 1500              		.loc 1 613 1
 1501              		.cfi_startproc
 1502 0000 F30F1EFA 		endbr64
 1503 0004 55       		pushq	%rbp
 1504              	.LCFI78:
 1505              		.cfi_def_cfa_offset 16
 1506              		.cfi_offset 6, -16
 1507 0005 4889E5   		movq	%rsp, %rbp
 1508              	.LCFI79:
 1509              		.cfi_def_cfa_register 6
 1510 0008 4883EC50 		subq	$80, %rsp
 1511 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1512 0010 8975E4   		movl	%esi, -28(%rbp)
 1513 0013 488955D8 		movq	%rdx, -40(%rbp)
 1514 0017 48894DD0 		movq	%rcx, -48(%rbp)
 1515 001b 4C8945C8 		movq	%r8, -56(%rbp)
 1516 001f 4C894DC0 		movq	%r9, -64(%rbp)
 1517 0023 488B4510 		movq	16(%rbp), %rax
 1518 0027 488945B8 		movq	%rax, -72(%rbp)
 1519 002b 488B4518 		movq	24(%rbp), %rax
 1520 002f 488945B0 		movq	%rax, -80(%rbp)
 1521              		.loc 1 613 1
 1522 0033 64488B04 		movq	%fs:40, %rax
 1522      25280000 
 1522      00
 1523 003c 488945F8 		movq	%rax, -8(%rbp)
 1524 0040 31C0     		xorl	%eax, %eax
 614:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_rsa_alt_context *rsa_alt = (mbedtls_rsa_alt_context *) ctx;
 1525              		.loc 1 614 30
 1526 0042 488B45E8 		movq	-24(%rbp), %rax
 1527 0046 488945F0 		movq	%rax, -16(%rbp)
 615:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 616:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if SIZE_MAX > UINT_MAX
 617:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( UINT_MAX < hash_len )
 1528              		.loc 1 617 7
 1529 004a B8FFFFFF 		movl	$4294967295, %eax
 1529      FF
 1530 004f 483945D0 		cmpq	%rax, -48(%rbp)
 1531 0053 7607     		jbe	.L97
 618:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         return( MBEDTLS_ERR_PK_BAD_INPUT_DATA );
 1532              		.loc 1 618 15
GAS LISTING /tmp/ccCBR1Ba.s 			page 43


 1533 0055 B880C1FF 		movl	$-16000, %eax
 1533      FF
 1534 005a EB56     		jmp	.L98
 1535              	.L97:
 619:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif /* SIZE_MAX > UINT_MAX */
 620:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 621:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     *sig_len = rsa_alt->key_len_func( rsa_alt->key );
 1536              		.loc 1 621 23
 1537 005c 488B45F0 		movq	-16(%rbp), %rax
 1538 0060 488B5018 		movq	24(%rax), %rdx
 1539              		.loc 1 621 16
 1540 0064 488B45F0 		movq	-16(%rbp), %rax
 1541 0068 488B00   		movq	(%rax), %rax
 1542 006b 4889C7   		movq	%rax, %rdi
 1543 006e FFD2     		call	*%rdx
 1544              	.LVL1:
 1545              		.loc 1 621 14
 1546 0070 488B55C0 		movq	-64(%rbp), %rdx
 1547 0074 488902   		movq	%rax, (%rdx)
 622:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 623:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( rsa_alt->sign_func( rsa_alt->key, f_rng, p_rng, MBEDTLS_RSA_PRIVATE,
 1548              		.loc 1 623 20
 1549 0077 488B45F0 		movq	-16(%rbp), %rax
 1550 007b 4C8B5010 		movq	16(%rax), %r10
 1551              		.loc 1 623 13
 1552 007f 488B45D0 		movq	-48(%rbp), %rax
 1553 0083 89C7     		movl	%eax, %edi
 1554 0085 488B45F0 		movq	-16(%rbp), %rax
 1555 0089 488B00   		movq	(%rax), %rax
 1556 008c 8B4DE4   		movl	-28(%rbp), %ecx
 1557 008f 488B55B0 		movq	-80(%rbp), %rdx
 1558 0093 488B75B8 		movq	-72(%rbp), %rsi
 1559 0097 FF75C8   		pushq	-56(%rbp)
 1560 009a FF75D8   		pushq	-40(%rbp)
 1561 009d 4189F9   		movl	%edi, %r9d
 1562 00a0 4189C8   		movl	%ecx, %r8d
 1563 00a3 B9010000 		movl	$1, %ecx
 1563      00
 1564 00a8 4889C7   		movq	%rax, %rdi
 1565 00ab 41FFD2   		call	*%r10
 1566              	.LVL2:
 1567 00ae 4883C410 		addq	$16, %rsp
 1568              	.L98:
 624:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                 md_alg, (unsigned int) hash_len, hash, sig ) );
 625:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 1569              		.loc 1 625 1
 1570 00b2 488B4DF8 		movq	-8(%rbp), %rcx
 1571 00b6 6448330C 		xorq	%fs:40, %rcx
 1571      25280000 
 1571      00
 1572 00bf 7405     		je	.L99
 1573 00c1 E8000000 		call	__stack_chk_fail@PLT
 1573      00
 1574              	.L99:
 1575 00c6 C9       		leave
 1576              	.LCFI80:
 1577              		.cfi_def_cfa 7, 8
GAS LISTING /tmp/ccCBR1Ba.s 			page 44


 1578 00c7 C3       		ret
 1579              		.cfi_endproc
 1580              	.LFE35:
 1582              		.section	.text.rsa_alt_decrypt_wrap,"ax",@progbits
 1584              	rsa_alt_decrypt_wrap:
 1585              	.LFB36:
 626:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 627:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int rsa_alt_decrypt_wrap( void *ctx,
 628:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                     const unsigned char *input, size_t ilen,
 629:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                     unsigned char *output, size_t *olen, size_t osize,
 630:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                     int (*f_rng)(void *, unsigned char *, size_t), void *p_rng )
 631:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 1586              		.loc 1 631 1
 1587              		.cfi_startproc
 1588 0000 F30F1EFA 		endbr64
 1589 0004 55       		pushq	%rbp
 1590              	.LCFI81:
 1591              		.cfi_def_cfa_offset 16
 1592              		.cfi_offset 6, -16
 1593 0005 4889E5   		movq	%rsp, %rbp
 1594              	.LCFI82:
 1595              		.cfi_def_cfa_register 6
 1596 0008 4883EC50 		subq	$80, %rsp
 1597 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1598 0010 488975E0 		movq	%rsi, -32(%rbp)
 1599 0014 488955D8 		movq	%rdx, -40(%rbp)
 1600 0018 48894DD0 		movq	%rcx, -48(%rbp)
 1601 001c 4C8945C8 		movq	%r8, -56(%rbp)
 1602 0020 4C894DC0 		movq	%r9, -64(%rbp)
 1603 0024 488B4510 		movq	16(%rbp), %rax
 1604 0028 488945B8 		movq	%rax, -72(%rbp)
 1605 002c 488B4518 		movq	24(%rbp), %rax
 1606 0030 488945B0 		movq	%rax, -80(%rbp)
 1607              		.loc 1 631 1
 1608 0034 64488B04 		movq	%fs:40, %rax
 1608      25280000 
 1608      00
 1609 003d 488945F8 		movq	%rax, -8(%rbp)
 1610 0041 31C0     		xorl	%eax, %eax
 632:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_rsa_alt_context *rsa_alt = (mbedtls_rsa_alt_context *) ctx;
 1611              		.loc 1 632 30
 1612 0043 488B45E8 		movq	-24(%rbp), %rax
 1613 0047 488945F0 		movq	%rax, -16(%rbp)
 633:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 634:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     ((void) f_rng);
 635:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     ((void) p_rng);
 636:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 637:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( ilen != rsa_alt->key_len_func( rsa_alt->key ) )
 1614              		.loc 1 637 24
 1615 004b 488B45F0 		movq	-16(%rbp), %rax
 1616 004f 488B5018 		movq	24(%rax), %rdx
 1617              		.loc 1 637 17
 1618 0053 488B45F0 		movq	-16(%rbp), %rax
 1619 0057 488B00   		movq	(%rax), %rax
 1620 005a 4889C7   		movq	%rax, %rdi
 1621 005d FFD2     		call	*%rdx
 1622              	.LVL3:
GAS LISTING /tmp/ccCBR1Ba.s 			page 45


 1623              		.loc 1 637 7
 1624 005f 483945D8 		cmpq	%rax, -40(%rbp)
 1625 0063 7407     		je	.L101
 638:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 1626              		.loc 1 638 15
 1627 0065 B880BFFF 		movl	$-16512, %eax
 1627      FF
 1628 006a EB30     		jmp	.L102
 1629              	.L101:
 639:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 640:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( rsa_alt->decrypt_func( rsa_alt->key,
 1630              		.loc 1 640 20
 1631 006c 488B45F0 		movq	-16(%rbp), %rax
 1632 0070 4C8B5008 		movq	8(%rax), %r10
 1633              		.loc 1 640 13
 1634 0074 488B45F0 		movq	-16(%rbp), %rax
 1635 0078 488B00   		movq	(%rax), %rax
 1636 007b 488B7DC0 		movq	-64(%rbp), %rdi
 1637 007f 488B75D0 		movq	-48(%rbp), %rsi
 1638 0083 488B4DE0 		movq	-32(%rbp), %rcx
 1639 0087 488B55C8 		movq	-56(%rbp), %rdx
 1640 008b 4989F9   		movq	%rdi, %r9
 1641 008e 4989F0   		movq	%rsi, %r8
 1642 0091 BE010000 		movl	$1, %esi
 1642      00
 1643 0096 4889C7   		movq	%rax, %rdi
 1644 0099 41FFD2   		call	*%r10
 1645              	.LVL4:
 1646              	.L102:
 641:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                 MBEDTLS_RSA_PRIVATE, olen, input, output, osize ) );
 642:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 1647              		.loc 1 642 1
 1648 009c 488B4DF8 		movq	-8(%rbp), %rcx
 1649 00a0 6448330C 		xorq	%fs:40, %rcx
 1649      25280000 
 1649      00
 1650 00a9 7405     		je	.L103
 1651 00ab E8000000 		call	__stack_chk_fail@PLT
 1651      00
 1652              	.L103:
 1653 00b0 C9       		leave
 1654              	.LCFI83:
 1655              		.cfi_def_cfa 7, 8
 1656 00b1 C3       		ret
 1657              		.cfi_endproc
 1658              	.LFE36:
 1660              		.section	.text.rsa_alt_check_pair,"ax",@progbits
 1662              	rsa_alt_check_pair:
 1663              	.LFB37:
 643:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 644:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #if defined(MBEDTLS_RSA_C)
 645:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static int rsa_alt_check_pair( const void *pub, const void *prv )
 646:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 1664              		.loc 1 646 1
 1665              		.cfi_startproc
 1666 0000 F30F1EFA 		endbr64
 1667 0004 55       		pushq	%rbp
GAS LISTING /tmp/ccCBR1Ba.s 			page 46


 1668              	.LCFI84:
 1669              		.cfi_def_cfa_offset 16
 1670              		.cfi_offset 6, -16
 1671 0005 4889E5   		movq	%rsp, %rbp
 1672              	.LCFI85:
 1673              		.cfi_def_cfa_register 6
 1674 0008 53       		pushq	%rbx
 1675 0009 4881EC58 		subq	$1112, %rsp
 1675      040000
 1676              		.cfi_offset 3, -24
 1677 0010 4889BDA8 		movq	%rdi, -1112(%rbp)
 1677      FBFFFF
 1678 0017 4889B5A0 		movq	%rsi, -1120(%rbp)
 1678      FBFFFF
 1679              		.loc 1 646 1
 1680 001e 64488B04 		movq	%fs:40, %rax
 1680      25280000 
 1680      00
 1681 0027 488945E8 		movq	%rax, -24(%rbp)
 1682 002b 31C0     		xorl	%eax, %eax
 647:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     unsigned char sig[MBEDTLS_MPI_MAX_SIZE];
 648:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     unsigned char hash[32];
 649:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     size_t sig_len = 0;
 1683              		.loc 1 649 12
 1684 002d 48C785B8 		movq	$0, -1096(%rbp)
 1684      FBFFFF00 
 1684      000000
 650:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     int ret;
 651:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 652:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( rsa_alt_get_bitlen( prv ) != rsa_get_bitlen( pub ) )
 1685              		.loc 1 652 9
 1686 0038 488B85A0 		movq	-1120(%rbp), %rax
 1686      FBFFFF
 1687 003f 4889C7   		movq	%rax, %rdi
 1688 0042 E8000000 		call	rsa_alt_get_bitlen
 1688      00
 1689 0047 4889C3   		movq	%rax, %rbx
 1690              		.loc 1 652 38
 1691 004a 488B85A8 		movq	-1112(%rbp), %rax
 1691      FBFFFF
 1692 0051 4889C7   		movq	%rax, %rdi
 1693 0054 E8000000 		call	rsa_get_bitlen
 1693      00
 1694              		.loc 1 652 7
 1695 0059 4839C3   		cmpq	%rax, %rbx
 1696 005c 740A     		je	.L105
 653:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         return( MBEDTLS_ERR_RSA_KEY_CHECK_FAILED );
 1697              		.loc 1 653 15
 1698 005e B800BEFF 		movl	$-16896, %eax
 1698      FF
 1699 0063 E9B00000 		jmp	.L109
 1699      00
 1700              	.L105:
 654:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 655:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     memset( hash, 0x2a, sizeof( hash ) );
 1701              		.loc 1 655 5
 1702 0068 488D85C0 		leaq	-1088(%rbp), %rax
GAS LISTING /tmp/ccCBR1Ba.s 			page 47


 1702      FBFFFF
 1703 006f BA200000 		movl	$32, %edx
 1703      00
 1704 0074 BE2A0000 		movl	$42, %esi
 1704      00
 1705 0079 4889C7   		movq	%rax, %rdi
 1706 007c E8000000 		call	memset@PLT
 1706      00
 656:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 657:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( ( ret = rsa_alt_sign_wrap( (void *) prv, MBEDTLS_MD_NONE,
 1707              		.loc 1 657 17
 1708 0081 488DB5B8 		leaq	-1096(%rbp), %rsi
 1708      FBFFFF
 1709 0088 488D8DE0 		leaq	-1056(%rbp), %rcx
 1709      FBFFFF
 1710 008f 488D95C0 		leaq	-1088(%rbp), %rdx
 1710      FBFFFF
 1711 0096 488B85A0 		movq	-1120(%rbp), %rax
 1711      FBFFFF
 1712 009d 6A00     		pushq	$0
 1713 009f 6A00     		pushq	$0
 1714 00a1 4989F1   		movq	%rsi, %r9
 1715 00a4 4989C8   		movq	%rcx, %r8
 1716 00a7 B9200000 		movl	$32, %ecx
 1716      00
 1717 00ac BE000000 		movl	$0, %esi
 1717      00
 1718 00b1 4889C7   		movq	%rax, %rdi
 1719 00b4 E8000000 		call	rsa_alt_sign_wrap
 1719      00
 1720 00b9 4883C410 		addq	$16, %rsp
 1721 00bd 8985B4FB 		movl	%eax, -1100(%rbp)
 1721      FFFF
 1722              		.loc 1 657 7
 1723 00c3 83BDB4FB 		cmpl	$0, -1100(%rbp)
 1723      FFFF00
 1724 00ca 7408     		je	.L107
 658:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                                    hash, sizeof( hash ),
 659:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                                    sig, &sig_len, NULL, NULL ) ) != 0 )
 660:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     {
 661:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         return( ret );
 1725              		.loc 1 661 15
 1726 00cc 8B85B4FB 		movl	-1100(%rbp), %eax
 1726      FFFF
 1727 00d2 EB44     		jmp	.L109
 1728              	.L107:
 662:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     }
 663:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 664:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( rsa_verify_wrap( (void *) pub, MBEDTLS_MD_NONE,
 1729              		.loc 1 664 9
 1730 00d4 488BB5B8 		movq	-1096(%rbp), %rsi
 1730      FBFFFF
 1731 00db 488D8DE0 		leaq	-1056(%rbp), %rcx
 1731      FBFFFF
 1732 00e2 488D95C0 		leaq	-1088(%rbp), %rdx
 1732      FBFFFF
 1733 00e9 488B85A8 		movq	-1112(%rbp), %rax
GAS LISTING /tmp/ccCBR1Ba.s 			page 48


 1733      FBFFFF
 1734 00f0 4989F1   		movq	%rsi, %r9
 1735 00f3 4989C8   		movq	%rcx, %r8
 1736 00f6 B9200000 		movl	$32, %ecx
 1736      00
 1737 00fb BE000000 		movl	$0, %esi
 1737      00
 1738 0100 4889C7   		movq	%rax, %rdi
 1739 0103 E8000000 		call	rsa_verify_wrap
 1739      00
 1740              		.loc 1 664 7
 1741 0108 85C0     		testl	%eax, %eax
 1742 010a 7407     		je	.L108
 665:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****                          hash, sizeof( hash ), sig, sig_len ) != 0 )
 666:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     {
 667:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         return( MBEDTLS_ERR_RSA_KEY_CHECK_FAILED );
 1743              		.loc 1 667 15
 1744 010c B800BEFF 		movl	$-16896, %eax
 1744      FF
 1745 0111 EB05     		jmp	.L109
 1746              	.L108:
 668:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     }
 669:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 670:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( 0 );
 1747              		.loc 1 670 11
 1748 0113 B8000000 		movl	$0, %eax
 1748      00
 1749              	.L109:
 671:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 1750              		.loc 1 671 1 discriminator 1
 1751 0118 488B5DE8 		movq	-24(%rbp), %rbx
 1752 011c 6448331C 		xorq	%fs:40, %rbx
 1752      25280000 
 1752      00
 1753 0125 7405     		je	.L110
 1754              		.loc 1 671 1 is_stmt 0
 1755 0127 E8000000 		call	__stack_chk_fail@PLT
 1755      00
 1756              	.L110:
 1757 012c 488B5DF8 		movq	-8(%rbp), %rbx
 1758 0130 C9       		leave
 1759              	.LCFI86:
 1760              		.cfi_def_cfa 7, 8
 1761 0131 C3       		ret
 1762              		.cfi_endproc
 1763              	.LFE37:
 1765              		.section	.text.rsa_alt_alloc_wrap,"ax",@progbits
 1767              	rsa_alt_alloc_wrap:
 1768              	.LFB38:
 672:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** #endif /* MBEDTLS_RSA_C */
 673:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 674:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static void *rsa_alt_alloc_wrap( void )
 675:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 1769              		.loc 1 675 1 is_stmt 1
 1770              		.cfi_startproc
 1771 0000 F30F1EFA 		endbr64
 1772 0004 55       		pushq	%rbp
GAS LISTING /tmp/ccCBR1Ba.s 			page 49


 1773              	.LCFI87:
 1774              		.cfi_def_cfa_offset 16
 1775              		.cfi_offset 6, -16
 1776 0005 4889E5   		movq	%rsp, %rbp
 1777              	.LCFI88:
 1778              		.cfi_def_cfa_register 6
 1779 0008 4883EC10 		subq	$16, %rsp
 1780              		.loc 1 675 1
 1781 000c 64488B04 		movq	%fs:40, %rax
 1781      25280000 
 1781      00
 1782 0015 488945F8 		movq	%rax, -8(%rbp)
 1783 0019 31C0     		xorl	%eax, %eax
 676:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     void *ctx = mbedtls_calloc( 1, sizeof( mbedtls_rsa_alt_context ) );
 1784              		.loc 1 676 17
 1785 001b BE200000 		movl	$32, %esi
 1785      00
 1786 0020 BF010000 		movl	$1, %edi
 1786      00
 1787 0025 E8000000 		call	mbedtls_calloc@PLT
 1787      00
 1788 002a 488945F0 		movq	%rax, -16(%rbp)
 677:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 678:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     if( ctx != NULL )
 1789              		.loc 1 678 7
 1790 002e 48837DF0 		cmpq	$0, -16(%rbp)
 1790      00
 1791 0033 7416     		je	.L112
 679:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****         memset( ctx, 0, sizeof( mbedtls_rsa_alt_context ) );
 1792              		.loc 1 679 9
 1793 0035 488B45F0 		movq	-16(%rbp), %rax
 1794 0039 BA200000 		movl	$32, %edx
 1794      00
 1795 003e BE000000 		movl	$0, %esi
 1795      00
 1796 0043 4889C7   		movq	%rax, %rdi
 1797 0046 E8000000 		call	memset@PLT
 1797      00
 1798              	.L112:
 680:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 681:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     return( ctx );
 1799              		.loc 1 681 11
 1800 004b 488B45F0 		movq	-16(%rbp), %rax
 682:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 1801              		.loc 1 682 1
 1802 004f 488B4DF8 		movq	-8(%rbp), %rcx
 1803 0053 6448330C 		xorq	%fs:40, %rcx
 1803      25280000 
 1803      00
 1804 005c 7405     		je	.L114
 1805 005e E8000000 		call	__stack_chk_fail@PLT
 1805      00
 1806              	.L114:
 1807 0063 C9       		leave
 1808              	.LCFI89:
 1809              		.cfi_def_cfa 7, 8
 1810 0064 C3       		ret
GAS LISTING /tmp/ccCBR1Ba.s 			page 50


 1811              		.cfi_endproc
 1812              	.LFE38:
 1814              		.section	.text.rsa_alt_free_wrap,"ax",@progbits
 1816              	rsa_alt_free_wrap:
 1817              	.LFB39:
 683:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** 
 684:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** static void rsa_alt_free_wrap( void *ctx )
 685:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** {
 1818              		.loc 1 685 1
 1819              		.cfi_startproc
 1820 0000 F30F1EFA 		endbr64
 1821 0004 55       		pushq	%rbp
 1822              	.LCFI90:
 1823              		.cfi_def_cfa_offset 16
 1824              		.cfi_offset 6, -16
 1825 0005 4889E5   		movq	%rsp, %rbp
 1826              	.LCFI91:
 1827              		.cfi_def_cfa_register 6
 1828 0008 4883EC20 		subq	$32, %rsp
 1829 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1830              		.loc 1 685 1
 1831 0010 64488B04 		movq	%fs:40, %rax
 1831      25280000 
 1831      00
 1832 0019 488945F8 		movq	%rax, -8(%rbp)
 1833 001d 31C0     		xorl	%eax, %eax
 686:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_platform_zeroize( ctx, sizeof( mbedtls_rsa_alt_context ) );
 1834              		.loc 1 686 5
 1835 001f 488B45E8 		movq	-24(%rbp), %rax
 1836 0023 BE200000 		movl	$32, %esi
 1836      00
 1837 0028 4889C7   		movq	%rax, %rdi
 1838 002b E8000000 		call	mbedtls_platform_zeroize@PLT
 1838      00
 687:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c ****     mbedtls_free( ctx );
 1839              		.loc 1 687 5
 1840 0030 488B45E8 		movq	-24(%rbp), %rax
 1841 0034 4889C7   		movq	%rax, %rdi
 1842 0037 E8000000 		call	mbedtls_free@PLT
 1842      00
 688:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/pk_wrap.c **** }
 1843              		.loc 1 688 1
 1844 003c 90       		nop
 1845 003d 488B45F8 		movq	-8(%rbp), %rax
 1846 0041 64483304 		xorq	%fs:40, %rax
 1846      25280000 
 1846      00
 1847 004a 7405     		je	.L116
 1848 004c E8000000 		call	__stack_chk_fail@PLT
 1848      00
 1849              	.L116:
 1850 0051 C9       		leave
 1851              	.LCFI92:
 1852              		.cfi_def_cfa 7, 8
 1853 0052 C3       		ret
 1854              		.cfi_endproc
 1855              	.LFE39:
GAS LISTING /tmp/ccCBR1Ba.s 			page 51


 1857              		.globl	mbedtls_rsa_alt_info
 1858              		.section	.rodata
 1859              	.LC7:
 1860 0027 5253412D 		.string	"RSA-alt"
 1860      616C7400 
 1861              		.section	.data.rel.ro.local.mbedtls_rsa_alt_info,"aw"
 1862              		.align 32
 1865              	mbedtls_rsa_alt_info:
 1866 0000 05000000 		.long	5
 1867 0004 00000000 		.zero	4
 1868 0008 00000000 		.quad	.LC7
 1868      00000000 
 1869 0010 00000000 		.quad	rsa_alt_get_bitlen
 1869      00000000 
 1870 0018 00000000 		.quad	rsa_alt_can_do
 1870      00000000 
 1871 0020 00000000 		.quad	0
 1871      00000000 
 1872 0028 00000000 		.quad	rsa_alt_sign_wrap
 1872      00000000 
 1873 0030 00000000 		.quad	rsa_alt_decrypt_wrap
 1873      00000000 
 1874 0038 00000000 		.quad	0
 1874      00000000 
 1875 0040 00000000 		.quad	rsa_alt_check_pair
 1875      00000000 
 1876 0048 00000000 		.quad	rsa_alt_alloc_wrap
 1876      00000000 
 1877 0050 00000000 		.quad	rsa_alt_free_wrap
 1877      00000000 
 1878 0058 00000000 		.quad	0
 1878      00000000 
 1879              		.text
 1880              	.Letext0:
 1881              		.file 2 "/usr/lib/gcc/x86_64-linux-gnu/9/include/stddef.h"
 1882              		.file 3 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/md.h"
 1883              		.file 4 "/usr/include/x86_64-linux-gnu/bits/types.h"
 1884              		.file 5 "/usr/include/x86_64-linux-gnu/bits/stdint-uintn.h"
 1885              		.file 6 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/bignum.
 1886              		.file 7 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/rsa.h"
 1887              		.file 8 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ecp.h"
 1888              		.file 9 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ecdsa.h
 1889              		.file 10 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk.h"
 1890              		.file 11 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/pk_int
 1891              		.file 12 "/usr/include/x86_64-linux-gnu/bits/types/struct_FILE.h"
 1892              		.file 13 "/usr/include/x86_64-linux-gnu/bits/types/FILE.h"
 1893              		.file 14 "/usr/include/stdio.h"
 1894              		.file 15 "/usr/include/x86_64-linux-gnu/bits/sys_errlist.h"
 1895              		.file 16 "/usr/include/time.h"
 1896              		.file 17 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/platfo
 7039              		.section	.note.gnu.property,"a"
 7040              		.align 8
 7041 0000 04000000 		.long	 1f - 0f
 7042 0004 10000000 		.long	 4f - 1f
 7043 0008 05000000 		.long	 5
 7044              	0:
 7045 000c 474E5500 		.string	 "GNU"
GAS LISTING /tmp/ccCBR1Ba.s 			page 52


 7046              	1:
 7047              		.align 8
 7048 0010 020000C0 		.long	 0xc0000002
 7049 0014 04000000 		.long	 3f - 2f
 7050              	2:
 7051 0018 03000000 		.long	 0x3
 7052              	3:
 7053 001c 00000000 		.align 8
 7054              	4:
GAS LISTING /tmp/ccCBR1Ba.s 			page 53


DEFINED SYMBOLS
                            *ABS*:0000000000000000 pk_wrap.c
     /tmp/ccCBR1Ba.s:6      .text.rsa_can_do:0000000000000000 rsa_can_do
     /tmp/ccCBR1Ba.s:55     .text.rsa_get_bitlen:0000000000000000 rsa_get_bitlen
     /tmp/ccCBR1Ba.s:97     .text.rsa_verify_wrap:0000000000000000 rsa_verify_wrap
     /tmp/ccCBR1Ba.s:196    .text.rsa_sign_wrap:0000000000000000 rsa_sign_wrap
     /tmp/ccCBR1Ba.s:275    .text.rsa_decrypt_wrap:0000000000000000 rsa_decrypt_wrap
     /tmp/ccCBR1Ba.s:346    .text.rsa_encrypt_wrap:0000000000000000 rsa_encrypt_wrap
     /tmp/ccCBR1Ba.s:423    .text.rsa_check_pair_wrap:0000000000000000 rsa_check_pair_wrap
     /tmp/ccCBR1Ba.s:463    .text.rsa_alloc_wrap:0000000000000000 rsa_alloc_wrap
     /tmp/ccCBR1Ba.s:512    .text.rsa_free_wrap:0000000000000000 rsa_free_wrap
     /tmp/ccCBR1Ba.s:559    .text.rsa_debug:0000000000000000 rsa_debug
     /tmp/ccCBR1Ba.s:628    .data.rel.ro.local.mbedtls_rsa_info:0000000000000000 mbedtls_rsa_info
     /tmp/ccCBR1Ba.s:644    .text.eckey_can_do:0000000000000000 eckey_can_do
     /tmp/ccCBR1Ba.s:695    .text.eckey_get_bitlen:0000000000000000 eckey_get_bitlen
     /tmp/ccCBR1Ba.s:731    .text.eckey_verify_wrap:0000000000000000 eckey_verify_wrap
     /tmp/ccCBR1Ba.s:1189   .text.ecdsa_verify_wrap:0000000000000000 ecdsa_verify_wrap
     /tmp/ccCBR1Ba.s:802    .text.eckey_sign_wrap:0000000000000000 eckey_sign_wrap
     /tmp/ccCBR1Ba.s:1247   .text.ecdsa_sign_wrap:0000000000000000 ecdsa_sign_wrap
     /tmp/ccCBR1Ba.s:880    .text.eckey_check_pair:0000000000000000 eckey_check_pair
     /tmp/ccCBR1Ba.s:920    .text.eckey_alloc_wrap:0000000000000000 eckey_alloc_wrap
     /tmp/ccCBR1Ba.s:967    .text.eckey_free_wrap:0000000000000000 eckey_free_wrap
     /tmp/ccCBR1Ba.s:1012   .text.eckey_debug:0000000000000000 eckey_debug
     /tmp/ccCBR1Ba.s:1066   .data.rel.ro.local.mbedtls_eckey_info:0000000000000000 mbedtls_eckey_info
     /tmp/ccCBR1Ba.s:1082   .text.eckeydh_can_do:0000000000000000 eckeydh_can_do
     /tmp/ccCBR1Ba.s:1136   .data.rel.ro.local.mbedtls_eckeydh_info:0000000000000000 mbedtls_eckeydh_info
     /tmp/ccCBR1Ba.s:1152   .text.ecdsa_can_do:0000000000000000 ecdsa_can_do
     /tmp/ccCBR1Ba.s:1303   .text.ecdsa_alloc_wrap:0000000000000000 ecdsa_alloc_wrap
     /tmp/ccCBR1Ba.s:1350   .text.ecdsa_free_wrap:0000000000000000 ecdsa_free_wrap
     /tmp/ccCBR1Ba.s:1398   .data.rel.ro.local.mbedtls_ecdsa_info:0000000000000000 mbedtls_ecdsa_info
     /tmp/ccCBR1Ba.s:1414   .text.rsa_alt_can_do:0000000000000000 rsa_alt_can_do
     /tmp/ccCBR1Ba.s:1451   .text.rsa_alt_get_bitlen:0000000000000000 rsa_alt_get_bitlen
     /tmp/ccCBR1Ba.s:1498   .text.rsa_alt_sign_wrap:0000000000000000 rsa_alt_sign_wrap
     /tmp/ccCBR1Ba.s:1584   .text.rsa_alt_decrypt_wrap:0000000000000000 rsa_alt_decrypt_wrap
     /tmp/ccCBR1Ba.s:1662   .text.rsa_alt_check_pair:0000000000000000 rsa_alt_check_pair
     /tmp/ccCBR1Ba.s:1767   .text.rsa_alt_alloc_wrap:0000000000000000 rsa_alt_alloc_wrap
     /tmp/ccCBR1Ba.s:1816   .text.rsa_alt_free_wrap:0000000000000000 rsa_alt_free_wrap
     /tmp/ccCBR1Ba.s:1865   .data.rel.ro.local.mbedtls_rsa_alt_info:0000000000000000 mbedtls_rsa_alt_info

UNDEFINED SYMBOLS
_GLOBAL_OFFSET_TABLE_
__stack_chk_fail
mbedtls_rsa_get_len
mbedtls_rsa_pkcs1_verify
mbedtls_rsa_pkcs1_sign
mbedtls_rsa_pkcs1_decrypt
mbedtls_rsa_pkcs1_encrypt
mbedtls_rsa_check_pub_priv
mbedtls_calloc
mbedtls_rsa_init
mbedtls_rsa_free
mbedtls_free
mbedtls_ecdsa_init
mbedtls_ecdsa_from_keypair
mbedtls_ecdsa_free
mbedtls_ecp_check_pub_priv
mbedtls_ecp_keypair_init
GAS LISTING /tmp/ccCBR1Ba.s 			page 54


mbedtls_ecp_keypair_free
mbedtls_ecdsa_read_signature
mbedtls_ecdsa_write_signature
memset
mbedtls_platform_zeroize
