GAS LISTING /tmp/cc6OITWc.s 			page 1


   1              		.file	"rsa.c"
   2              		.text
   3              	.Ltext0:
   4              		.section	.text.mbedtls_safer_memcmp,"ax",@progbits
   6              	mbedtls_safer_memcmp:
   7              	.LFB16:
   8              		.file 1 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c"
   1:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
   2:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *  The RSA public-key cryptosystem
   3:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
   4:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *  Copyright (C) 2006-2015, ARM Limited, All Rights Reserved
   5:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *  SPDX-License-Identifier: Apache-2.0
   6:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
   7:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *  Licensed under the Apache License, Version 2.0 (the "License"); you may
   8:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *  not use this file except in compliance with the License.
   9:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *  You may obtain a copy of the License at
  10:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
  11:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *  http://www.apache.org/licenses/LICENSE-2.0
  12:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
  13:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *  Unless required by applicable law or agreed to in writing, software
  14:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  15:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  16:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *  See the License for the specific language governing permissions and
  17:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *  limitations under the License.
  18:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
  19:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *  This file is part of mbed TLS (https://tls.mbed.org)
  20:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
  21:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
  22:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
  23:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *  The following sources were referenced in the design of this implementation
  24:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *  of the RSA algorithm:
  25:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
  26:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *  [1] A method for obtaining digital signatures and public-key cryptosystems
  27:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *      R Rivest, A Shamir, and L Adleman
  28:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *      http://people.csail.mit.edu/rivest/pubs.html#RSA78
  29:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
  30:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *  [2] Handbook of Applied Cryptography - 1997, Chapter 8
  31:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *      Menezes, van Oorschot and Vanstone
  32:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
  33:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *  [3] Malware Guard Extension: Using SGX to Conceal Cache Attacks
  34:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *      Michael Schwarz, Samuel Weiser, Daniel Gruss, Cl√©mentine Maurice and
  35:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *      Stefan Mangard
  36:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *      https://arxiv.org/abs/1702.08719v2
  37:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
  38:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
  39:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
  40:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if !defined(MBEDTLS_CONFIG_FILE)
  41:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #include "mbedtls/config.h"
  42:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #else
  43:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #include MBEDTLS_CONFIG_FILE
  44:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
  45:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
  46:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_RSA_C)
  47:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
  48:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #include "mbedtls/rsa.h"
  49:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #include "mbedtls/rsa_internal.h"
  50:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #include "mbedtls/oid.h"
GAS LISTING /tmp/cc6OITWc.s 			page 2


  51:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #include "mbedtls/platform_util.h"
  52:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
  53:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #include <string.h>
  54:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
  55:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_PKCS1_V21)
  56:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #include "mbedtls/md.h"
  57:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
  58:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
  59:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_PKCS1_V15) && !defined(__OpenBSD__)
  60:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #include <stdlib.h>
  61:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
  62:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
  63:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_PLATFORM_C)
  64:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #include "mbedtls/platform.h"
  65:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #else
  66:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #include <stdio.h>
  67:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #define mbedtls_printf printf
  68:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #define mbedtls_calloc calloc
  69:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #define mbedtls_free   free
  70:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
  71:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
  72:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if !defined(MBEDTLS_RSA_ALT)
  73:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
  74:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /* Parameter validation macros */
  75:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #define RSA_VALIDATE_RET( cond )                                       \
  76:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_INTERNAL_VALIDATE_RET( cond, MBEDTLS_ERR_RSA_BAD_INPUT_DATA )
  77:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #define RSA_VALIDATE( cond )                                           \
  78:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_INTERNAL_VALIDATE( cond )
  79:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
  80:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_PKCS1_V15)
  81:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /* constant-time buffer comparison */
  82:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** static inline int mbedtls_safer_memcmp( const void *a, const void *b, size_t n )
  83:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
   9              		.loc 1 83 1
  10              		.cfi_startproc
  11 0000 55       		pushq	%rbp
  12              	.LCFI0:
  13              		.cfi_def_cfa_offset 16
  14              		.cfi_offset 6, -16
  15 0001 4889E5   		movq	%rsp, %rbp
  16              	.LCFI1:
  17              		.cfi_def_cfa_register 6
  18 0004 4883EC50 		subq	$80, %rsp
  19 0008 48897DC8 		movq	%rdi, -56(%rbp)
  20 000c 488975C0 		movq	%rsi, -64(%rbp)
  21 0010 488955B8 		movq	%rdx, -72(%rbp)
  22              		.loc 1 83 1
  23 0014 64488B04 		movq	%fs:40, %rax
  23      25280000 
  23      00
  24 001d 488945F8 		movq	%rax, -8(%rbp)
  25 0021 31C0     		xorl	%eax, %eax
  84:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     size_t i;
  85:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     const unsigned char *A = (const unsigned char *) a;
  26              		.loc 1 85 26
  27 0023 488B45C8 		movq	-56(%rbp), %rax
  28 0027 488945E8 		movq	%rax, -24(%rbp)
GAS LISTING /tmp/cc6OITWc.s 			page 3


  86:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     const unsigned char *B = (const unsigned char *) b;
  29              		.loc 1 86 26
  30 002b 488B45C0 		movq	-64(%rbp), %rax
  31 002f 488945F0 		movq	%rax, -16(%rbp)
  87:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned char diff = 0;
  32              		.loc 1 87 19
  33 0033 C645DF00 		movb	$0, -33(%rbp)
  88:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
  89:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     for( i = 0; i < n; i++ )
  34              		.loc 1 89 12
  35 0037 48C745E0 		movq	$0, -32(%rbp)
  35      00000000 
  36              		.loc 1 89 5
  37 003f EB26     		jmp	.L2
  38              	.L3:
  90:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         diff |= A[i] ^ B[i];
  39              		.loc 1 90 18 discriminator 3
  40 0041 488B55E8 		movq	-24(%rbp), %rdx
  41 0045 488B45E0 		movq	-32(%rbp), %rax
  42 0049 4801D0   		addq	%rdx, %rax
  43 004c 0FB608   		movzbl	(%rax), %ecx
  44              		.loc 1 90 25 discriminator 3
  45 004f 488B55F0 		movq	-16(%rbp), %rdx
  46 0053 488B45E0 		movq	-32(%rbp), %rax
  47 0057 4801D0   		addq	%rdx, %rax
  48 005a 0FB600   		movzbl	(%rax), %eax
  49              		.loc 1 90 14 discriminator 3
  50 005d 31C8     		xorl	%ecx, %eax
  51 005f 0845DF   		orb	%al, -33(%rbp)
  89:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         diff |= A[i] ^ B[i];
  52              		.loc 1 89 25 discriminator 3
  53 0062 488345E0 		addq	$1, -32(%rbp)
  53      01
  54              	.L2:
  89:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         diff |= A[i] ^ B[i];
  55              		.loc 1 89 5 discriminator 1
  56 0067 488B45E0 		movq	-32(%rbp), %rax
  57 006b 483B45B8 		cmpq	-72(%rbp), %rax
  58 006f 72D0     		jb	.L3
  91:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
  92:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( diff );
  59              		.loc 1 92 11
  60 0071 0FB645DF 		movzbl	-33(%rbp), %eax
  93:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
  61              		.loc 1 93 1
  62 0075 488B75F8 		movq	-8(%rbp), %rsi
  63 0079 64483334 		xorq	%fs:40, %rsi
  63      25280000 
  63      00
  64 0082 7405     		je	.L5
  65 0084 E8000000 		call	__stack_chk_fail@PLT
  65      00
  66              	.L5:
  67 0089 C9       		leave
  68              	.LCFI2:
  69              		.cfi_def_cfa 7, 8
  70 008a C3       		ret
GAS LISTING /tmp/cc6OITWc.s 			page 4


  71              		.cfi_endproc
  72              	.LFE16:
  74              		.section	.text.mbedtls_rsa_import,"ax",@progbits
  75              		.globl	mbedtls_rsa_import
  77              	mbedtls_rsa_import:
  78              	.LFB17:
  94:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif /* MBEDTLS_PKCS1_V15 */
  95:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
  96:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_import( mbedtls_rsa_context *ctx,
  97:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                         const mbedtls_mpi *N,
  98:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                         const mbedtls_mpi *P, const mbedtls_mpi *Q,
  99:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                         const mbedtls_mpi *D, const mbedtls_mpi *E )
 100:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
  79              		.loc 1 100 1
  80              		.cfi_startproc
  81 0000 F30F1EFA 		endbr64
  82 0004 55       		pushq	%rbp
  83              	.LCFI3:
  84              		.cfi_def_cfa_offset 16
  85              		.cfi_offset 6, -16
  86 0005 4889E5   		movq	%rsp, %rbp
  87              	.LCFI4:
  88              		.cfi_def_cfa_register 6
  89 0008 4883EC40 		subq	$64, %rsp
  90 000c 48897DE8 		movq	%rdi, -24(%rbp)
  91 0010 488975E0 		movq	%rsi, -32(%rbp)
  92 0014 488955D8 		movq	%rdx, -40(%rbp)
  93 0018 48894DD0 		movq	%rcx, -48(%rbp)
  94 001c 4C8945C8 		movq	%r8, -56(%rbp)
  95 0020 4C894DC0 		movq	%r9, -64(%rbp)
  96              		.loc 1 100 1
  97 0024 64488B04 		movq	%fs:40, %rax
  97      25280000 
  97      00
  98 002d 488945F8 		movq	%rax, -8(%rbp)
  99 0031 31C0     		xorl	%eax, %eax
 101:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int ret;
 102:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
 103:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 104:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( N != NULL && ( ret = mbedtls_mpi_copy( &ctx->N, N ) ) != 0 ) ||
 100              		.loc 1 104 7
 101 0033 48837DE0 		cmpq	$0, -32(%rbp)
 101      00
 102 0038 7424     		je	.L7
 103              		.loc 1 104 32 discriminator 1
 104 003a 488B45E8 		movq	-24(%rbp), %rax
 105 003e 488D5010 		leaq	16(%rax), %rdx
 106 0042 488B45E0 		movq	-32(%rbp), %rax
 107 0046 4889C6   		movq	%rax, %rsi
 108 0049 4889D7   		movq	%rdx, %rdi
 109 004c E8000000 		call	mbedtls_mpi_copy@PLT
 109      00
 110 0051 8945F4   		movl	%eax, -12(%rbp)
 111              		.loc 1 104 21 discriminator 1
 112 0054 837DF400 		cmpl	$0, -12(%rbp)
 113 0058 0F859C00 		jne	.L8
 113      0000
GAS LISTING /tmp/cc6OITWc.s 			page 5


 114              	.L7:
 115              		.loc 1 104 72 discriminator 3
 116 005e 48837DD8 		cmpq	$0, -40(%rbp)
 116      00
 117 0063 7420     		je	.L9
 105:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ( P != NULL && ( ret = mbedtls_mpi_copy( &ctx->P, P ) ) != 0 ) ||
 118              		.loc 1 105 32
 119 0065 488B45E8 		movq	-24(%rbp), %rax
 120 0069 488D5058 		leaq	88(%rax), %rdx
 121 006d 488B45D8 		movq	-40(%rbp), %rax
 122 0071 4889C6   		movq	%rax, %rsi
 123 0074 4889D7   		movq	%rdx, %rdi
 124 0077 E8000000 		call	mbedtls_mpi_copy@PLT
 124      00
 125 007c 8945F4   		movl	%eax, -12(%rbp)
 126              		.loc 1 105 21
 127 007f 837DF400 		cmpl	$0, -12(%rbp)
 128 0083 7575     		jne	.L8
 129              	.L9:
 130              		.loc 1 105 72 discriminator 1
 131 0085 48837DD0 		cmpq	$0, -48(%rbp)
 131      00
 132 008a 7420     		je	.L10
 106:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ( Q != NULL && ( ret = mbedtls_mpi_copy( &ctx->Q, Q ) ) != 0 ) ||
 133              		.loc 1 106 32
 134 008c 488B45E8 		movq	-24(%rbp), %rax
 135 0090 488D5070 		leaq	112(%rax), %rdx
 136 0094 488B45D0 		movq	-48(%rbp), %rax
 137 0098 4889C6   		movq	%rax, %rsi
 138 009b 4889D7   		movq	%rdx, %rdi
 139 009e E8000000 		call	mbedtls_mpi_copy@PLT
 139      00
 140 00a3 8945F4   		movl	%eax, -12(%rbp)
 141              		.loc 1 106 21
 142 00a6 837DF400 		cmpl	$0, -12(%rbp)
 143 00aa 754E     		jne	.L8
 144              	.L10:
 145              		.loc 1 106 72 discriminator 1
 146 00ac 48837DC8 		cmpq	$0, -56(%rbp)
 146      00
 147 00b1 7420     		je	.L11
 107:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ( D != NULL && ( ret = mbedtls_mpi_copy( &ctx->D, D ) ) != 0 ) ||
 148              		.loc 1 107 32
 149 00b3 488B45E8 		movq	-24(%rbp), %rax
 150 00b7 488D5040 		leaq	64(%rax), %rdx
 151 00bb 488B45C8 		movq	-56(%rbp), %rax
 152 00bf 4889C6   		movq	%rax, %rsi
 153 00c2 4889D7   		movq	%rdx, %rdi
 154 00c5 E8000000 		call	mbedtls_mpi_copy@PLT
 154      00
 155 00ca 8945F4   		movl	%eax, -12(%rbp)
 156              		.loc 1 107 21
 157 00cd 837DF400 		cmpl	$0, -12(%rbp)
 158 00d1 7527     		jne	.L8
 159              	.L11:
 160              		.loc 1 107 72 discriminator 1
 161 00d3 48837DC0 		cmpq	$0, -64(%rbp)
GAS LISTING /tmp/cc6OITWc.s 			page 6


 161      00
 162 00d8 742A     		je	.L12
 108:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ( E != NULL && ( ret = mbedtls_mpi_copy( &ctx->E, E ) ) != 0 ) )
 163              		.loc 1 108 32
 164 00da 488B45E8 		movq	-24(%rbp), %rax
 165 00de 488D5028 		leaq	40(%rax), %rdx
 166 00e2 488B45C0 		movq	-64(%rbp), %rax
 167 00e6 4889C6   		movq	%rax, %rsi
 168 00e9 4889D7   		movq	%rdx, %rdi
 169 00ec E8000000 		call	mbedtls_mpi_copy@PLT
 169      00
 170 00f1 8945F4   		movl	%eax, -12(%rbp)
 171              		.loc 1 108 21
 172 00f4 837DF400 		cmpl	$0, -12(%rbp)
 173 00f8 740A     		je	.L12
 174              	.L8:
 109:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 110:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA + ret );
 175              		.loc 1 110 48
 176 00fa 8B45F4   		movl	-12(%rbp), %eax
 177 00fd 2D804000 		subl	$16512, %eax
 177      00
 178 0102 EB24     		jmp	.L13
 179              	.L12:
 111:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 112:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 113:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( N != NULL )
 180              		.loc 1 113 7
 181 0104 48837DE0 		cmpq	$0, -32(%rbp)
 181      00
 182 0109 7418     		je	.L14
 114:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ctx->len = mbedtls_mpi_size( &ctx->N );
 183              		.loc 1 114 38
 184 010b 488B45E8 		movq	-24(%rbp), %rax
 185 010f 4883C010 		addq	$16, %rax
 186              		.loc 1 114 20
 187 0113 4889C7   		movq	%rax, %rdi
 188 0116 E8000000 		call	mbedtls_mpi_size@PLT
 188      00
 189              		.loc 1 114 18
 190 011b 488B55E8 		movq	-24(%rbp), %rdx
 191 011f 48894208 		movq	%rax, 8(%rdx)
 192              	.L14:
 115:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 116:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( 0 );
 193              		.loc 1 116 11
 194 0123 B8000000 		movl	$0, %eax
 194      00
 195              	.L13:
 117:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 196              		.loc 1 117 1
 197 0128 488B4DF8 		movq	-8(%rbp), %rcx
 198 012c 6448330C 		xorq	%fs:40, %rcx
 198      25280000 
 198      00
 199 0135 7405     		je	.L15
 200 0137 E8000000 		call	__stack_chk_fail@PLT
GAS LISTING /tmp/cc6OITWc.s 			page 7


 200      00
 201              	.L15:
 202 013c C9       		leave
 203              	.LCFI5:
 204              		.cfi_def_cfa 7, 8
 205 013d C3       		ret
 206              		.cfi_endproc
 207              	.LFE17:
 209              		.section	.text.mbedtls_rsa_import_raw,"ax",@progbits
 210              		.globl	mbedtls_rsa_import_raw
 212              	mbedtls_rsa_import_raw:
 213              	.LFB18:
 118:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 119:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_import_raw( mbedtls_rsa_context *ctx,
 120:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             unsigned char const *N, size_t N_len,
 121:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             unsigned char const *P, size_t P_len,
 122:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             unsigned char const *Q, size_t Q_len,
 123:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             unsigned char const *D, size_t D_len,
 124:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             unsigned char const *E, size_t E_len )
 125:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 214              		.loc 1 125 1
 215              		.cfi_startproc
 216 0000 F30F1EFA 		endbr64
 217 0004 55       		pushq	%rbp
 218              	.LCFI6:
 219              		.cfi_def_cfa_offset 16
 220              		.cfi_offset 6, -16
 221 0005 4889E5   		movq	%rsp, %rbp
 222              	.LCFI7:
 223              		.cfi_def_cfa_register 6
 224 0008 4883EC70 		subq	$112, %rsp
 225 000c 48897DE8 		movq	%rdi, -24(%rbp)
 226 0010 488975E0 		movq	%rsi, -32(%rbp)
 227 0014 488955D8 		movq	%rdx, -40(%rbp)
 228 0018 48894DD0 		movq	%rcx, -48(%rbp)
 229 001c 4C8945C8 		movq	%r8, -56(%rbp)
 230 0020 4C894DC0 		movq	%r9, -64(%rbp)
 231 0024 488B4510 		movq	16(%rbp), %rax
 232 0028 488945B8 		movq	%rax, -72(%rbp)
 233 002c 488B4518 		movq	24(%rbp), %rax
 234 0030 488945B0 		movq	%rax, -80(%rbp)
 235 0034 488B4520 		movq	32(%rbp), %rax
 236 0038 488945A8 		movq	%rax, -88(%rbp)
 237 003c 488B4528 		movq	40(%rbp), %rax
 238 0040 488945A0 		movq	%rax, -96(%rbp)
 239 0044 488B4530 		movq	48(%rbp), %rax
 240 0048 48894598 		movq	%rax, -104(%rbp)
 241              		.loc 1 125 1
 242 004c 64488B04 		movq	%fs:40, %rax
 242      25280000 
 242      00
 243 0055 488945F8 		movq	%rax, -8(%rbp)
 244 0059 31C0     		xorl	%eax, %eax
 126:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int ret = 0;
 245              		.loc 1 126 9
 246 005b C745F400 		movl	$0, -12(%rbp)
 246      000000
GAS LISTING /tmp/cc6OITWc.s 			page 8


 127:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
 128:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 129:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( N != NULL )
 247              		.loc 1 129 7
 248 0062 48837DE0 		cmpq	$0, -32(%rbp)
 248      00
 249 0067 7440     		je	.L17
 130:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 131:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_read_binary( &ctx->N, N, N_len ) );
 250              		.loc 1 131 9
 251 0069 488B45E8 		movq	-24(%rbp), %rax
 252 006d 488D4810 		leaq	16(%rax), %rcx
 253 0071 488B55D8 		movq	-40(%rbp), %rdx
 254 0075 488B45E0 		movq	-32(%rbp), %rax
 255 0079 4889C6   		movq	%rax, %rsi
 256 007c 4889CF   		movq	%rcx, %rdi
 257 007f E8000000 		call	mbedtls_mpi_read_binary@PLT
 257      00
 258 0084 8945F4   		movl	%eax, -12(%rbp)
 259 0087 837DF400 		cmpl	$0, -12(%rbp)
 260 008b 0F85C800 		jne	.L26
 260      0000
 132:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ctx->len = mbedtls_mpi_size( &ctx->N );
 261              		.loc 1 132 38
 262 0091 488B45E8 		movq	-24(%rbp), %rax
 263 0095 4883C010 		addq	$16, %rax
 264              		.loc 1 132 20
 265 0099 4889C7   		movq	%rax, %rdi
 266 009c E8000000 		call	mbedtls_mpi_size@PLT
 266      00
 267              		.loc 1 132 18
 268 00a1 488B55E8 		movq	-24(%rbp), %rdx
 269 00a5 48894208 		movq	%rax, 8(%rdx)
 270              	.L17:
 133:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 134:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 135:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( P != NULL )
 271              		.loc 1 135 7
 272 00a9 48837DD0 		cmpq	$0, -48(%rbp)
 272      00
 273 00ae 7428     		je	.L20
 136:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_read_binary( &ctx->P, P, P_len ) );
 274              		.loc 1 136 9
 275 00b0 488B45E8 		movq	-24(%rbp), %rax
 276 00b4 488D4858 		leaq	88(%rax), %rcx
 277 00b8 488B55C8 		movq	-56(%rbp), %rdx
 278 00bc 488B45D0 		movq	-48(%rbp), %rax
 279 00c0 4889C6   		movq	%rax, %rsi
 280 00c3 4889CF   		movq	%rcx, %rdi
 281 00c6 E8000000 		call	mbedtls_mpi_read_binary@PLT
 281      00
 282 00cb 8945F4   		movl	%eax, -12(%rbp)
 283 00ce 837DF400 		cmpl	$0, -12(%rbp)
 284 00d2 0F858400 		jne	.L27
 284      0000
 285              	.L20:
 137:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
GAS LISTING /tmp/cc6OITWc.s 			page 9


 138:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( Q != NULL )
 286              		.loc 1 138 7
 287 00d8 48837DC0 		cmpq	$0, -64(%rbp)
 287      00
 288 00dd 7424     		je	.L21
 139:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_read_binary( &ctx->Q, Q, Q_len ) );
 289              		.loc 1 139 9
 290 00df 488B45E8 		movq	-24(%rbp), %rax
 291 00e3 488D4870 		leaq	112(%rax), %rcx
 292 00e7 488B55B8 		movq	-72(%rbp), %rdx
 293 00eb 488B45C0 		movq	-64(%rbp), %rax
 294 00ef 4889C6   		movq	%rax, %rsi
 295 00f2 4889CF   		movq	%rcx, %rdi
 296 00f5 E8000000 		call	mbedtls_mpi_read_binary@PLT
 296      00
 297 00fa 8945F4   		movl	%eax, -12(%rbp)
 298 00fd 837DF400 		cmpl	$0, -12(%rbp)
 299 0101 755C     		jne	.L28
 300              	.L21:
 140:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 141:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( D != NULL )
 301              		.loc 1 141 7
 302 0103 48837DB0 		cmpq	$0, -80(%rbp)
 302      00
 303 0108 7424     		je	.L22
 142:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_read_binary( &ctx->D, D, D_len ) );
 304              		.loc 1 142 9
 305 010a 488B45E8 		movq	-24(%rbp), %rax
 306 010e 488D4840 		leaq	64(%rax), %rcx
 307 0112 488B55A8 		movq	-88(%rbp), %rdx
 308 0116 488B45B0 		movq	-80(%rbp), %rax
 309 011a 4889C6   		movq	%rax, %rsi
 310 011d 4889CF   		movq	%rcx, %rdi
 311 0120 E8000000 		call	mbedtls_mpi_read_binary@PLT
 311      00
 312 0125 8945F4   		movl	%eax, -12(%rbp)
 313 0128 837DF400 		cmpl	$0, -12(%rbp)
 314 012c 7534     		jne	.L29
 315              	.L22:
 143:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 144:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( E != NULL )
 316              		.loc 1 144 7
 317 012e 48837DA0 		cmpq	$0, -96(%rbp)
 317      00
 318 0133 7430     		je	.L30
 145:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_read_binary( &ctx->E, E, E_len ) );
 319              		.loc 1 145 9
 320 0135 488B45E8 		movq	-24(%rbp), %rax
 321 0139 488D4828 		leaq	40(%rax), %rcx
 322 013d 488B5598 		movq	-104(%rbp), %rdx
 323 0141 488B45A0 		movq	-96(%rbp), %rax
 324 0145 4889C6   		movq	%rax, %rsi
 325 0148 4889CF   		movq	%rcx, %rdi
 326 014b E8000000 		call	mbedtls_mpi_read_binary@PLT
 326      00
 327 0150 8945F4   		movl	%eax, -12(%rbp)
 328 0153 837DF400 		cmpl	$0, -12(%rbp)
GAS LISTING /tmp/cc6OITWc.s 			page 10


 146:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 147:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** cleanup:
 329              		.loc 1 147 1
 330 0157 EB0C     		jmp	.L30
 331              	.L26:
 131:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ctx->len = mbedtls_mpi_size( &ctx->N );
 332              		.loc 1 131 9
 333 0159 90       		nop
 334 015a EB0A     		jmp	.L19
 335              	.L27:
 136:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 336              		.loc 1 136 9
 337 015c 90       		nop
 338 015d EB07     		jmp	.L19
 339              	.L28:
 139:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 340              		.loc 1 139 9
 341 015f 90       		nop
 342 0160 EB04     		jmp	.L19
 343              	.L29:
 142:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 344              		.loc 1 142 9
 345 0162 90       		nop
 346 0163 EB01     		jmp	.L19
 347              	.L30:
 348              		.loc 1 147 1
 349 0165 90       		nop
 350              	.L19:
 148:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 149:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ret != 0 )
 351              		.loc 1 149 7
 352 0166 837DF400 		cmpl	$0, -12(%rbp)
 353 016a 740A     		je	.L23
 150:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA + ret );
 354              		.loc 1 150 48
 355 016c 8B45F4   		movl	-12(%rbp), %eax
 356 016f 2D804000 		subl	$16512, %eax
 356      00
 357 0174 EB05     		jmp	.L24
 358              	.L23:
 151:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 152:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( 0 );
 359              		.loc 1 152 11
 360 0176 B8000000 		movl	$0, %eax
 360      00
 361              	.L24:
 153:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 362              		.loc 1 153 1
 363 017b 488B75F8 		movq	-8(%rbp), %rsi
 364 017f 64483334 		xorq	%fs:40, %rsi
 364      25280000 
 364      00
 365 0188 7405     		je	.L25
 366 018a E8000000 		call	__stack_chk_fail@PLT
 366      00
 367              	.L25:
 368 018f C9       		leave
GAS LISTING /tmp/cc6OITWc.s 			page 11


 369              	.LCFI8:
 370              		.cfi_def_cfa 7, 8
 371 0190 C3       		ret
 372              		.cfi_endproc
 373              	.LFE18:
 375              		.section	.text.rsa_check_context,"ax",@progbits
 377              	rsa_check_context:
 378              	.LFB19:
 154:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 155:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
 156:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Checks whether the context fields are set in such a way
 157:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * that the RSA primitives will be able to execute without error.
 158:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * It does *not* make guarantees for consistency of the parameters.
 159:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
 160:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** static int rsa_check_context( mbedtls_rsa_context const *ctx, int is_priv,
 161:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                               int blinding_needed )
 162:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 379              		.loc 1 162 1
 380              		.cfi_startproc
 381 0000 F30F1EFA 		endbr64
 382 0004 55       		pushq	%rbp
 383              	.LCFI9:
 384              		.cfi_def_cfa_offset 16
 385              		.cfi_offset 6, -16
 386 0005 4889E5   		movq	%rsp, %rbp
 387              	.LCFI10:
 388              		.cfi_def_cfa_register 6
 389 0008 53       		pushq	%rbx
 390 0009 4883EC28 		subq	$40, %rsp
 391              		.cfi_offset 3, -24
 392 000d 48897DD8 		movq	%rdi, -40(%rbp)
 393 0011 8975D4   		movl	%esi, -44(%rbp)
 394 0014 8955D0   		movl	%edx, -48(%rbp)
 395              		.loc 1 162 1
 396 0017 64488B04 		movq	%fs:40, %rax
 396      25280000 
 396      00
 397 0020 488945E8 		movq	%rax, -24(%rbp)
 398 0024 31C0     		xorl	%eax, %eax
 163:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if !defined(MBEDTLS_RSA_NO_CRT)
 164:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* blinding_needed is only used for NO_CRT to decide whether
 165:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * P,Q need to be present or not. */
 166:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     ((void) blinding_needed);
 167:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
 168:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 169:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ctx->len != mbedtls_mpi_size( &ctx->N ) ||
 399              		.loc 1 169 12
 400 0026 488B45D8 		movq	-40(%rbp), %rax
 401 002a 488B5808 		movq	8(%rax), %rbx
 402              		.loc 1 169 21
 403 002e 488B45D8 		movq	-40(%rbp), %rax
 404 0032 4883C010 		addq	$16, %rax
 405 0036 4889C7   		movq	%rax, %rdi
 406 0039 E8000000 		call	mbedtls_mpi_size@PLT
 406      00
 407              		.loc 1 169 7
 408 003e 4839C3   		cmpq	%rax, %rbx
GAS LISTING /tmp/cc6OITWc.s 			page 12


 409 0041 7510     		jne	.L32
 170:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ctx->len > MBEDTLS_MPI_MAX_SIZE )
 410              		.loc 1 170 12 discriminator 1
 411 0043 488B45D8 		movq	-40(%rbp), %rax
 412 0047 488B4008 		movq	8(%rax), %rax
 169:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ctx->len > MBEDTLS_MPI_MAX_SIZE )
 413              		.loc 1 169 49 discriminator 1
 414 004b 483D0004 		cmpq	$1024, %rax
 414      0000
 415 0051 760A     		jbe	.L33
 416              	.L32:
 171:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 172:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 417              		.loc 1 172 15
 418 0053 B880BFFF 		movl	$-16512, %eax
 418      FF
 419 0058 E9400100 		jmp	.L34
 419      00
 420              	.L33:
 173:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 174:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 175:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
 176:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * 1. Modular exponentiation needs positive, odd moduli.
 177:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
 178:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 179:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Modular exponentiation wrt. N is always used for
 180:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * RSA public key operations. */
 181:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mbedtls_mpi_cmp_int( &ctx->N, 0 ) <= 0 ||
 421              		.loc 1 181 9
 422 005d 488B45D8 		movq	-40(%rbp), %rax
 423 0061 4883C010 		addq	$16, %rax
 424 0065 BE000000 		movl	$0, %esi
 424      00
 425 006a 4889C7   		movq	%rax, %rdi
 426 006d E8000000 		call	mbedtls_mpi_cmp_int@PLT
 426      00
 427              		.loc 1 181 7
 428 0072 85C0     		testl	%eax, %eax
 429 0074 7E19     		jle	.L35
 182:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_get_bit( &ctx->N, 0 ) == 0  )
 430              		.loc 1 182 9 discriminator 1
 431 0076 488B45D8 		movq	-40(%rbp), %rax
 432 007a 4883C010 		addq	$16, %rax
 433 007e BE000000 		movl	$0, %esi
 433      00
 434 0083 4889C7   		movq	%rax, %rdi
 435 0086 E8000000 		call	mbedtls_mpi_get_bit@PLT
 435      00
 181:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_get_bit( &ctx->N, 0 ) == 0  )
 436              		.loc 1 181 48 discriminator 1
 437 008b 85C0     		testl	%eax, %eax
 438 008d 750A     		jne	.L36
 439              	.L35:
 183:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 184:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 440              		.loc 1 184 15
 441 008f B880BFFF 		movl	$-16512, %eax
GAS LISTING /tmp/cc6OITWc.s 			page 13


 441      FF
 442 0094 E9040100 		jmp	.L34
 442      00
 443              	.L36:
 185:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 186:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 187:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if !defined(MBEDTLS_RSA_NO_CRT)
 188:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Modular exponentiation for P and Q is only
 189:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * used for private key operations and if CRT
 190:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * is used. */
 191:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( is_priv &&
 444              		.loc 1 191 7
 445 0099 837DD400 		cmpl	$0, -44(%rbp)
 446 009d 746E     		je	.L37
 192:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ( mbedtls_mpi_cmp_int( &ctx->P, 0 ) <= 0 ||
 447              		.loc 1 192 11 discriminator 1
 448 009f 488B45D8 		movq	-40(%rbp), %rax
 449 00a3 4883C058 		addq	$88, %rax
 450 00a7 BE000000 		movl	$0, %esi
 450      00
 451 00ac 4889C7   		movq	%rax, %rdi
 452 00af E8000000 		call	mbedtls_mpi_cmp_int@PLT
 452      00
 191:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ( mbedtls_mpi_cmp_int( &ctx->P, 0 ) <= 0 ||
 453              		.loc 1 191 17 discriminator 1
 454 00b4 85C0     		testl	%eax, %eax
 455 00b6 7E4B     		jle	.L38
 193:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****           mbedtls_mpi_get_bit( &ctx->P, 0 ) == 0 ||
 456              		.loc 1 193 11
 457 00b8 488B45D8 		movq	-40(%rbp), %rax
 458 00bc 4883C058 		addq	$88, %rax
 459 00c0 BE000000 		movl	$0, %esi
 459      00
 460 00c5 4889C7   		movq	%rax, %rdi
 461 00c8 E8000000 		call	mbedtls_mpi_get_bit@PLT
 461      00
 192:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ( mbedtls_mpi_cmp_int( &ctx->P, 0 ) <= 0 ||
 462              		.loc 1 192 50
 463 00cd 85C0     		testl	%eax, %eax
 464 00cf 7432     		je	.L38
 194:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****           mbedtls_mpi_cmp_int( &ctx->Q, 0 ) <= 0 ||
 465              		.loc 1 194 11
 466 00d1 488B45D8 		movq	-40(%rbp), %rax
 467 00d5 4883C070 		addq	$112, %rax
 468 00d9 BE000000 		movl	$0, %esi
 468      00
 469 00de 4889C7   		movq	%rax, %rdi
 470 00e1 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 470      00
 193:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****           mbedtls_mpi_get_bit( &ctx->P, 0 ) == 0 ||
 471              		.loc 1 193 50
 472 00e6 85C0     		testl	%eax, %eax
 473 00e8 7E19     		jle	.L38
 195:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****           mbedtls_mpi_get_bit( &ctx->Q, 0 ) == 0  ) )
 474              		.loc 1 195 11
 475 00ea 488B45D8 		movq	-40(%rbp), %rax
 476 00ee 4883C070 		addq	$112, %rax
GAS LISTING /tmp/cc6OITWc.s 			page 14


 477 00f2 BE000000 		movl	$0, %esi
 477      00
 478 00f7 4889C7   		movq	%rax, %rdi
 479 00fa E8000000 		call	mbedtls_mpi_get_bit@PLT
 479      00
 194:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****           mbedtls_mpi_cmp_int( &ctx->Q, 0 ) <= 0 ||
 480              		.loc 1 194 50
 481 00ff 85C0     		testl	%eax, %eax
 482 0101 750A     		jne	.L37
 483              	.L38:
 196:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 197:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 484              		.loc 1 197 15
 485 0103 B880BFFF 		movl	$-16512, %eax
 485      FF
 486 0108 E9900000 		jmp	.L34
 486      00
 487              	.L37:
 198:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 199:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif /* !MBEDTLS_RSA_NO_CRT */
 200:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 201:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
 202:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * 2. Exponents must be positive
 203:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
 204:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 205:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Always need E for public key operations */
 206:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mbedtls_mpi_cmp_int( &ctx->E, 0 ) <= 0 )
 488              		.loc 1 206 9
 489 010d 488B45D8 		movq	-40(%rbp), %rax
 490 0111 4883C028 		addq	$40, %rax
 491 0115 BE000000 		movl	$0, %esi
 491      00
 492 011a 4889C7   		movq	%rax, %rdi
 493 011d E8000000 		call	mbedtls_mpi_cmp_int@PLT
 493      00
 494              		.loc 1 206 7
 495 0122 85C0     		testl	%eax, %eax
 496 0124 7F07     		jg	.L39
 207:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 497              		.loc 1 207 15
 498 0126 B880BFFF 		movl	$-16512, %eax
 498      FF
 499 012b EB70     		jmp	.L34
 500              	.L39:
 208:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 209:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_RSA_NO_CRT)
 210:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* For private key operations, use D or DP & DQ
 211:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * as (unblinded) exponents. */
 212:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( is_priv && mbedtls_mpi_cmp_int( &ctx->D, 0 ) <= 0 )
 213:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 214:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #else
 215:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( is_priv &&
 501              		.loc 1 215 7
 502 012d 837DD400 		cmpl	$0, -44(%rbp)
 503 0131 743D     		je	.L40
 216:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ( mbedtls_mpi_cmp_int( &ctx->DP, 0 ) <= 0 ||
 504              		.loc 1 216 11 discriminator 1
GAS LISTING /tmp/cc6OITWc.s 			page 15


 505 0133 488B45D8 		movq	-40(%rbp), %rax
 506 0137 48058800 		addq	$136, %rax
 506      0000
 507 013d BE000000 		movl	$0, %esi
 507      00
 508 0142 4889C7   		movq	%rax, %rdi
 509 0145 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 509      00
 215:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ( mbedtls_mpi_cmp_int( &ctx->DP, 0 ) <= 0 ||
 510              		.loc 1 215 17 discriminator 1
 511 014a 85C0     		testl	%eax, %eax
 512 014c 7E1B     		jle	.L41
 217:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****           mbedtls_mpi_cmp_int( &ctx->DQ, 0 ) <= 0  ) )
 513              		.loc 1 217 11
 514 014e 488B45D8 		movq	-40(%rbp), %rax
 515 0152 4805A000 		addq	$160, %rax
 515      0000
 516 0158 BE000000 		movl	$0, %esi
 516      00
 517 015d 4889C7   		movq	%rax, %rdi
 518 0160 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 518      00
 216:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ( mbedtls_mpi_cmp_int( &ctx->DP, 0 ) <= 0 ||
 519              		.loc 1 216 51
 520 0165 85C0     		testl	%eax, %eax
 521 0167 7F07     		jg	.L40
 522              	.L41:
 218:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 219:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 523              		.loc 1 219 15
 524 0169 B880BFFF 		movl	$-16512, %eax
 524      FF
 525 016e EB2D     		jmp	.L34
 526              	.L40:
 220:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 221:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif /* MBEDTLS_RSA_NO_CRT */
 222:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 223:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Blinding shouldn't make exponents negative either,
 224:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * so check that P, Q >= 1 if that hasn't yet been
 225:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * done as part of 1. */
 226:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_RSA_NO_CRT)
 227:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( is_priv && blinding_needed &&
 228:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ( mbedtls_mpi_cmp_int( &ctx->P, 0 ) <= 0 ||
 229:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****           mbedtls_mpi_cmp_int( &ctx->Q, 0 ) <= 0 ) )
 230:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 231:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 232:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 233:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
 234:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 235:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* It wouldn't lead to an error if it wasn't satisfied,
 236:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * but check for QP >= 1 nonetheless. */
 237:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if !defined(MBEDTLS_RSA_NO_CRT)
 238:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( is_priv &&
 527              		.loc 1 238 7
 528 0170 837DD400 		cmpl	$0, -44(%rbp)
 529 0174 7422     		je	.L42
 239:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->QP, 0 ) <= 0 )
GAS LISTING /tmp/cc6OITWc.s 			page 16


 530              		.loc 1 239 9 discriminator 1
 531 0176 488B45D8 		movq	-40(%rbp), %rax
 532 017a 4805B800 		addq	$184, %rax
 532      0000
 533 0180 BE000000 		movl	$0, %esi
 533      00
 534 0185 4889C7   		movq	%rax, %rdi
 535 0188 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 535      00
 238:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->QP, 0 ) <= 0 )
 536              		.loc 1 238 17 discriminator 1
 537 018d 85C0     		testl	%eax, %eax
 538 018f 7F07     		jg	.L42
 240:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 241:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 539              		.loc 1 241 15
 540 0191 B880BFFF 		movl	$-16512, %eax
 540      FF
 541 0196 EB05     		jmp	.L34
 542              	.L42:
 242:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 243:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
 244:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 245:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( 0 );
 543              		.loc 1 245 11
 544 0198 B8000000 		movl	$0, %eax
 544      00
 545              	.L34:
 246:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 546              		.loc 1 246 1
 547 019d 488B4DE8 		movq	-24(%rbp), %rcx
 548 01a1 6448330C 		xorq	%fs:40, %rcx
 548      25280000 
 548      00
 549 01aa 7405     		je	.L43
 550 01ac E8000000 		call	__stack_chk_fail@PLT
 550      00
 551              	.L43:
 552 01b1 4883C428 		addq	$40, %rsp
 553 01b5 5B       		popq	%rbx
 554 01b6 5D       		popq	%rbp
 555              	.LCFI11:
 556              		.cfi_def_cfa 7, 8
 557 01b7 C3       		ret
 558              		.cfi_endproc
 559              	.LFE19:
 561              		.section	.text.mbedtls_rsa_complete,"ax",@progbits
 562              		.globl	mbedtls_rsa_complete
 564              	mbedtls_rsa_complete:
 565              	.LFB20:
 247:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 248:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_complete( mbedtls_rsa_context *ctx )
 249:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 566              		.loc 1 249 1
 567              		.cfi_startproc
 568 0000 F30F1EFA 		endbr64
 569 0004 55       		pushq	%rbp
GAS LISTING /tmp/cc6OITWc.s 			page 17


 570              	.LCFI12:
 571              		.cfi_def_cfa_offset 16
 572              		.cfi_offset 6, -16
 573 0005 4889E5   		movq	%rsp, %rbp
 574              	.LCFI13:
 575              		.cfi_def_cfa_register 6
 576 0008 4883EC50 		subq	$80, %rsp
 577 000c 48897DB8 		movq	%rdi, -72(%rbp)
 578              		.loc 1 249 1
 579 0010 64488B04 		movq	%fs:40, %rax
 579      25280000 
 579      00
 580 0019 488945F8 		movq	%rax, -8(%rbp)
 581 001d 31C0     		xorl	%eax, %eax
 250:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int ret = 0;
 582              		.loc 1 250 9
 583 001f C745CC00 		movl	$0, -52(%rbp)
 583      000000
 251:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int have_N, have_P, have_Q, have_D, have_E;
 252:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int n_missing, pq_missing, d_missing, is_pub, is_priv;
 253:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 254:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
 255:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 256:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     have_N = ( mbedtls_mpi_cmp_int( &ctx->N, 0 ) != 0 );
 584              		.loc 1 256 37
 585 0026 488B45B8 		movq	-72(%rbp), %rax
 586 002a 4883C010 		addq	$16, %rax
 587              		.loc 1 256 16
 588 002e BE000000 		movl	$0, %esi
 588      00
 589 0033 4889C7   		movq	%rax, %rdi
 590 0036 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 590      00
 591              		.loc 1 256 50
 592 003b 85C0     		testl	%eax, %eax
 593 003d 0F95C0   		setne	%al
 594              		.loc 1 256 12
 595 0040 0FB6C0   		movzbl	%al, %eax
 596 0043 8945D0   		movl	%eax, -48(%rbp)
 257:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     have_P = ( mbedtls_mpi_cmp_int( &ctx->P, 0 ) != 0 );
 597              		.loc 1 257 37
 598 0046 488B45B8 		movq	-72(%rbp), %rax
 599 004a 4883C058 		addq	$88, %rax
 600              		.loc 1 257 16
 601 004e BE000000 		movl	$0, %esi
 601      00
 602 0053 4889C7   		movq	%rax, %rdi
 603 0056 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 603      00
 604              		.loc 1 257 50
 605 005b 85C0     		testl	%eax, %eax
 606 005d 0F95C0   		setne	%al
 607              		.loc 1 257 12
 608 0060 0FB6C0   		movzbl	%al, %eax
 609 0063 8945D4   		movl	%eax, -44(%rbp)
 258:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     have_Q = ( mbedtls_mpi_cmp_int( &ctx->Q, 0 ) != 0 );
 610              		.loc 1 258 37
GAS LISTING /tmp/cc6OITWc.s 			page 18


 611 0066 488B45B8 		movq	-72(%rbp), %rax
 612 006a 4883C070 		addq	$112, %rax
 613              		.loc 1 258 16
 614 006e BE000000 		movl	$0, %esi
 614      00
 615 0073 4889C7   		movq	%rax, %rdi
 616 0076 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 616      00
 617              		.loc 1 258 50
 618 007b 85C0     		testl	%eax, %eax
 619 007d 0F95C0   		setne	%al
 620              		.loc 1 258 12
 621 0080 0FB6C0   		movzbl	%al, %eax
 622 0083 8945D8   		movl	%eax, -40(%rbp)
 259:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     have_D = ( mbedtls_mpi_cmp_int( &ctx->D, 0 ) != 0 );
 623              		.loc 1 259 37
 624 0086 488B45B8 		movq	-72(%rbp), %rax
 625 008a 4883C040 		addq	$64, %rax
 626              		.loc 1 259 16
 627 008e BE000000 		movl	$0, %esi
 627      00
 628 0093 4889C7   		movq	%rax, %rdi
 629 0096 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 629      00
 630              		.loc 1 259 50
 631 009b 85C0     		testl	%eax, %eax
 632 009d 0F95C0   		setne	%al
 633              		.loc 1 259 12
 634 00a0 0FB6C0   		movzbl	%al, %eax
 635 00a3 8945DC   		movl	%eax, -36(%rbp)
 260:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     have_E = ( mbedtls_mpi_cmp_int( &ctx->E, 0 ) != 0 );
 636              		.loc 1 260 37
 637 00a6 488B45B8 		movq	-72(%rbp), %rax
 638 00aa 4883C028 		addq	$40, %rax
 639              		.loc 1 260 16
 640 00ae BE000000 		movl	$0, %esi
 640      00
 641 00b3 4889C7   		movq	%rax, %rdi
 642 00b6 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 642      00
 643              		.loc 1 260 50
 644 00bb 85C0     		testl	%eax, %eax
 645 00bd 0F95C0   		setne	%al
 646              		.loc 1 260 12
 647 00c0 0FB6C0   		movzbl	%al, %eax
 648 00c3 8945E0   		movl	%eax, -32(%rbp)
 261:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 262:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
 263:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * Check whether provided parameters are enough
 264:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * to deduce all others. The following incomplete
 265:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * parameter sets for private keys are supported:
 266:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      *
 267:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * (1) P, Q missing.
 268:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * (2) D and potentially N missing.
 269:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      *
 270:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
 271:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
GAS LISTING /tmp/cc6OITWc.s 			page 19


 272:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     n_missing  =              have_P &&  have_Q &&  have_D && have_E;
 649              		.loc 1 272 60
 650 00c6 837DD400 		cmpl	$0, -44(%rbp)
 651 00ca 7419     		je	.L45
 652              		.loc 1 272 38 discriminator 1
 653 00cc 837DD800 		cmpl	$0, -40(%rbp)
 654 00d0 7413     		je	.L45
 655              		.loc 1 272 49 discriminator 3
 656 00d2 837DDC00 		cmpl	$0, -36(%rbp)
 657 00d6 740D     		je	.L45
 658              		.loc 1 272 60 discriminator 5
 659 00d8 837DE000 		cmpl	$0, -32(%rbp)
 660 00dc 7407     		je	.L45
 661              		.loc 1 272 60 is_stmt 0 discriminator 7
 662 00de B8010000 		movl	$1, %eax
 662      00
 663 00e3 EB05     		jmp	.L46
 664              	.L45:
 665              		.loc 1 272 60 discriminator 8
 666 00e5 B8000000 		movl	$0, %eax
 666      00
 667              	.L46:
 668              		.loc 1 272 16 is_stmt 1 discriminator 10
 669 00ea 8945E4   		movl	%eax, -28(%rbp)
 273:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     pq_missing =   have_N && !have_P && !have_Q &&  have_D && have_E;
 670              		.loc 1 273 60 discriminator 10
 671 00ed 837DD000 		cmpl	$0, -48(%rbp)
 672 00f1 741F     		je	.L47
 673              		.loc 1 273 27 discriminator 1
 674 00f3 837DD400 		cmpl	$0, -44(%rbp)
 675 00f7 7519     		jne	.L47
 676              		.loc 1 273 38 discriminator 3
 677 00f9 837DD800 		cmpl	$0, -40(%rbp)
 678 00fd 7513     		jne	.L47
 679              		.loc 1 273 49 discriminator 5
 680 00ff 837DDC00 		cmpl	$0, -36(%rbp)
 681 0103 740D     		je	.L47
 682              		.loc 1 273 60 discriminator 7
 683 0105 837DE000 		cmpl	$0, -32(%rbp)
 684 0109 7407     		je	.L47
 685              		.loc 1 273 60 is_stmt 0 discriminator 9
 686 010b B8010000 		movl	$1, %eax
 686      00
 687 0110 EB05     		jmp	.L48
 688              	.L47:
 689              		.loc 1 273 60 discriminator 10
 690 0112 B8000000 		movl	$0, %eax
 690      00
 691              	.L48:
 692              		.loc 1 273 16 is_stmt 1 discriminator 12
 693 0117 8945E8   		movl	%eax, -24(%rbp)
 274:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     d_missing  =              have_P &&  have_Q && !have_D && have_E;
 694              		.loc 1 274 60 discriminator 12
 695 011a 837DD400 		cmpl	$0, -44(%rbp)
 696 011e 7419     		je	.L49
 697              		.loc 1 274 38 discriminator 1
 698 0120 837DD800 		cmpl	$0, -40(%rbp)
GAS LISTING /tmp/cc6OITWc.s 			page 20


 699 0124 7413     		je	.L49
 700              		.loc 1 274 49 discriminator 3
 701 0126 837DDC00 		cmpl	$0, -36(%rbp)
 702 012a 750D     		jne	.L49
 703              		.loc 1 274 60 discriminator 5
 704 012c 837DE000 		cmpl	$0, -32(%rbp)
 705 0130 7407     		je	.L49
 706              		.loc 1 274 60 is_stmt 0 discriminator 7
 707 0132 B8010000 		movl	$1, %eax
 707      00
 708 0137 EB05     		jmp	.L50
 709              	.L49:
 710              		.loc 1 274 60 discriminator 8
 711 0139 B8000000 		movl	$0, %eax
 711      00
 712              	.L50:
 713              		.loc 1 274 16 is_stmt 1 discriminator 10
 714 013e 8945EC   		movl	%eax, -20(%rbp)
 275:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     is_pub     =   have_N && !have_P && !have_Q && !have_D && have_E;
 715              		.loc 1 275 60 discriminator 10
 716 0141 837DD000 		cmpl	$0, -48(%rbp)
 717 0145 741F     		je	.L51
 718              		.loc 1 275 27 discriminator 1
 719 0147 837DD400 		cmpl	$0, -44(%rbp)
 720 014b 7519     		jne	.L51
 721              		.loc 1 275 38 discriminator 3
 722 014d 837DD800 		cmpl	$0, -40(%rbp)
 723 0151 7513     		jne	.L51
 724              		.loc 1 275 49 discriminator 5
 725 0153 837DDC00 		cmpl	$0, -36(%rbp)
 726 0157 750D     		jne	.L51
 727              		.loc 1 275 60 discriminator 7
 728 0159 837DE000 		cmpl	$0, -32(%rbp)
 729 015d 7407     		je	.L51
 730              		.loc 1 275 60 is_stmt 0 discriminator 9
 731 015f B8010000 		movl	$1, %eax
 731      00
 732 0164 EB05     		jmp	.L52
 733              	.L51:
 734              		.loc 1 275 60 discriminator 10
 735 0166 B8000000 		movl	$0, %eax
 735      00
 736              	.L52:
 737              		.loc 1 275 16 is_stmt 1 discriminator 12
 738 016b 8945F0   		movl	%eax, -16(%rbp)
 276:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 277:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* These three alternatives are mutually exclusive */
 278:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     is_priv = n_missing || pq_missing || d_missing;
 739              		.loc 1 278 39 discriminator 12
 740 016e 837DE400 		cmpl	$0, -28(%rbp)
 741 0172 750C     		jne	.L53
 742              		.loc 1 278 25 discriminator 2
 743 0174 837DE800 		cmpl	$0, -24(%rbp)
 744 0178 7506     		jne	.L53
 745              		.loc 1 278 39 discriminator 4
 746 017a 837DEC00 		cmpl	$0, -20(%rbp)
 747 017e 7407     		je	.L54
GAS LISTING /tmp/cc6OITWc.s 			page 21


 748              	.L53:
 749              		.loc 1 278 39 is_stmt 0 discriminator 5
 750 0180 B8010000 		movl	$1, %eax
 750      00
 751 0185 EB05     		jmp	.L55
 752              	.L54:
 753              		.loc 1 278 39 discriminator 6
 754 0187 B8000000 		movl	$0, %eax
 754      00
 755              	.L55:
 756              		.loc 1 278 13 is_stmt 1 discriminator 8
 757 018c 8945F4   		movl	%eax, -12(%rbp)
 279:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 280:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( !is_priv && !is_pub )
 758              		.loc 1 280 7 discriminator 8
 759 018f 837DF400 		cmpl	$0, -12(%rbp)
 760 0193 7510     		jne	.L56
 761              		.loc 1 280 18 discriminator 1
 762 0195 837DF000 		cmpl	$0, -16(%rbp)
 763 0199 750A     		jne	.L56
 281:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 764              		.loc 1 281 15
 765 019b B880BFFF 		movl	$-16512, %eax
 765      FF
 766 01a0 E9690100 		jmp	.L57
 766      00
 767              	.L56:
 282:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 283:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
 284:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * Step 1: Deduce N if P, Q are provided.
 285:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
 286:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 287:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( !have_N && have_P && have_Q )
 768              		.loc 1 287 7
 769 01a5 837DD000 		cmpl	$0, -48(%rbp)
 770 01a9 755D     		jne	.L58
 771              		.loc 1 287 17 discriminator 1
 772 01ab 837DD400 		cmpl	$0, -44(%rbp)
 773 01af 7457     		je	.L58
 774              		.loc 1 287 27 discriminator 2
 775 01b1 837DD800 		cmpl	$0, -40(%rbp)
 776 01b5 7451     		je	.L58
 288:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 289:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( ( ret = mbedtls_mpi_mul_mpi( &ctx->N, &ctx->P,
 290:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                          &ctx->Q ) ) != 0 )
 777              		.loc 1 290 42
 778 01b7 488B45B8 		movq	-72(%rbp), %rax
 779 01bb 488D5070 		leaq	112(%rax), %rdx
 289:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                          &ctx->Q ) ) != 0 )
 780              		.loc 1 289 51
 781 01bf 488B45B8 		movq	-72(%rbp), %rax
 782 01c3 488D4858 		leaq	88(%rax), %rcx
 289:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                          &ctx->Q ) ) != 0 )
 783              		.loc 1 289 21
 784 01c7 488B45B8 		movq	-72(%rbp), %rax
 785 01cb 4883C010 		addq	$16, %rax
 786 01cf 4889CE   		movq	%rcx, %rsi
GAS LISTING /tmp/cc6OITWc.s 			page 22


 787 01d2 4889C7   		movq	%rax, %rdi
 788 01d5 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 788      00
 789 01da 8945CC   		movl	%eax, -52(%rbp)
 289:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                          &ctx->Q ) ) != 0 )
 790              		.loc 1 289 11
 791 01dd 837DCC00 		cmpl	$0, -52(%rbp)
 792 01e1 740D     		je	.L59
 291:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         {
 292:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA + ret );
 793              		.loc 1 292 52
 794 01e3 8B45CC   		movl	-52(%rbp), %eax
 795 01e6 2D804000 		subl	$16512, %eax
 795      00
 796 01eb E91E0100 		jmp	.L57
 796      00
 797              	.L59:
 293:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         }
 294:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 295:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ctx->len = mbedtls_mpi_size( &ctx->N );
 798              		.loc 1 295 38
 799 01f0 488B45B8 		movq	-72(%rbp), %rax
 800 01f4 4883C010 		addq	$16, %rax
 801              		.loc 1 295 20
 802 01f8 4889C7   		movq	%rax, %rdi
 803 01fb E8000000 		call	mbedtls_mpi_size@PLT
 803      00
 804              		.loc 1 295 18
 805 0200 488B55B8 		movq	-72(%rbp), %rdx
 806 0204 48894208 		movq	%rax, 8(%rdx)
 807              	.L58:
 296:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 297:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 298:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
 299:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * Step 2: Deduce and verify all remaining core parameters.
 300:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
 301:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 302:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( pq_missing )
 808              		.loc 1 302 7
 809 0208 837DE800 		cmpl	$0, -24(%rbp)
 810 020c 7449     		je	.L60
 303:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 304:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ret = mbedtls_rsa_deduce_primes( &ctx->N, &ctx->E, &ctx->D,
 811              		.loc 1 304 15
 812 020e 488B45B8 		movq	-72(%rbp), %rax
 813 0212 488D7870 		leaq	112(%rax), %rdi
 814 0216 488B45B8 		movq	-72(%rbp), %rax
 815 021a 488D4858 		leaq	88(%rax), %rcx
 816              		.loc 1 304 60
 817 021e 488B45B8 		movq	-72(%rbp), %rax
 818 0222 488D5040 		leaq	64(%rax), %rdx
 819              		.loc 1 304 51
 820 0226 488B45B8 		movq	-72(%rbp), %rax
 821 022a 488D7028 		leaq	40(%rax), %rsi
 822              		.loc 1 304 42
 823 022e 488B45B8 		movq	-72(%rbp), %rax
 824 0232 4883C010 		addq	$16, %rax
GAS LISTING /tmp/cc6OITWc.s 			page 23


 825              		.loc 1 304 15
 826 0236 4989F8   		movq	%rdi, %r8
 827 0239 4889C7   		movq	%rax, %rdi
 828 023c E8000000 		call	mbedtls_rsa_deduce_primes@PLT
 828      00
 829 0241 8945CC   		movl	%eax, -52(%rbp)
 305:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                          &ctx->P, &ctx->Q );
 306:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( ret != 0 )
 830              		.loc 1 306 11
 831 0244 837DCC00 		cmpl	$0, -52(%rbp)
 832 0248 744E     		je	.L61
 307:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA + ret );
 833              		.loc 1 307 52
 834 024a 8B45CC   		movl	-52(%rbp), %eax
 835 024d 2D804000 		subl	$16512, %eax
 835      00
 836 0252 E9B70000 		jmp	.L57
 836      00
 837              	.L60:
 308:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 309:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 310:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     else if( d_missing )
 838              		.loc 1 310 12
 839 0257 837DEC00 		cmpl	$0, -20(%rbp)
 840 025b 743B     		je	.L61
 311:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 312:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( ( ret = mbedtls_rsa_deduce_private_exponent( &ctx->P,
 841              		.loc 1 312 21
 842 025d 488B45B8 		movq	-72(%rbp), %rax
 843 0261 488D4840 		leaq	64(%rax), %rcx
 313:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                                          &ctx->Q,
 314:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                                          &ctx->E,
 844              		.loc 1 314 58
 845 0265 488B45B8 		movq	-72(%rbp), %rax
 846 0269 488D5028 		leaq	40(%rax), %rdx
 313:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                                          &ctx->Q,
 847              		.loc 1 313 58
 848 026d 488B45B8 		movq	-72(%rbp), %rax
 849 0271 488D7070 		leaq	112(%rax), %rsi
 312:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                                          &ctx->Q,
 850              		.loc 1 312 58
 851 0275 488B45B8 		movq	-72(%rbp), %rax
 852 0279 4883C058 		addq	$88, %rax
 312:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                                          &ctx->Q,
 853              		.loc 1 312 21
 854 027d 4889C7   		movq	%rax, %rdi
 855 0280 E8000000 		call	mbedtls_rsa_deduce_private_exponent@PLT
 855      00
 856 0285 8945CC   		movl	%eax, -52(%rbp)
 312:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                                          &ctx->Q,
 857              		.loc 1 312 11
 858 0288 837DCC00 		cmpl	$0, -52(%rbp)
 859 028c 740A     		je	.L61
 315:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                                          &ctx->D ) ) != 0 )
 316:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         {
 317:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA + ret );
 860              		.loc 1 317 52
GAS LISTING /tmp/cc6OITWc.s 			page 24


 861 028e 8B45CC   		movl	-52(%rbp), %eax
 862 0291 2D804000 		subl	$16512, %eax
 862      00
 863 0296 EB76     		jmp	.L57
 864              	.L61:
 318:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         }
 319:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 320:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 321:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
 322:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * Step 3: Deduce all additional parameters specific
 323:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      *         to our current RSA implementation.
 324:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
 325:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 326:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if !defined(MBEDTLS_RSA_NO_CRT)
 327:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( is_priv )
 865              		.loc 1 327 7
 866 0298 837DF400 		cmpl	$0, -12(%rbp)
 867 029c 745A     		je	.L62
 328:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 329:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ret = mbedtls_rsa_deduce_crt( &ctx->P,  &ctx->Q,  &ctx->D,
 868              		.loc 1 329 15
 869 029e 488B45B8 		movq	-72(%rbp), %rax
 870 02a2 4C8D80B8 		leaq	184(%rax), %r8
 870      000000
 871 02a9 488B45B8 		movq	-72(%rbp), %rax
 872 02ad 488DB8A0 		leaq	160(%rax), %rdi
 872      000000
 873 02b4 488B45B8 		movq	-72(%rbp), %rax
 874 02b8 488D8888 		leaq	136(%rax), %rcx
 874      000000
 875              		.loc 1 329 59
 876 02bf 488B45B8 		movq	-72(%rbp), %rax
 877 02c3 488D5040 		leaq	64(%rax), %rdx
 878              		.loc 1 329 49
 879 02c7 488B45B8 		movq	-72(%rbp), %rax
 880 02cb 488D7070 		leaq	112(%rax), %rsi
 881              		.loc 1 329 39
 882 02cf 488B45B8 		movq	-72(%rbp), %rax
 883 02d3 4883C058 		addq	$88, %rax
 884              		.loc 1 329 15
 885 02d7 4D89C1   		movq	%r8, %r9
 886 02da 4989F8   		movq	%rdi, %r8
 887 02dd 4889C7   		movq	%rax, %rdi
 888 02e0 E8000000 		call	mbedtls_rsa_deduce_crt@PLT
 888      00
 889 02e5 8945CC   		movl	%eax, -52(%rbp)
 330:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                       &ctx->DP, &ctx->DQ, &ctx->QP );
 331:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( ret != 0 )
 890              		.loc 1 331 11
 891 02e8 837DCC00 		cmpl	$0, -52(%rbp)
 892 02ec 740A     		je	.L62
 332:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA + ret );
 893              		.loc 1 332 52
 894 02ee 8B45CC   		movl	-52(%rbp), %eax
 895 02f1 2D804000 		subl	$16512, %eax
 895      00
 896 02f6 EB16     		jmp	.L57
GAS LISTING /tmp/cc6OITWc.s 			page 25


 897              	.L62:
 333:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 334:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif /* MBEDTLS_RSA_NO_CRT */
 335:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 336:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
 337:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * Step 3: Basic sanity checks
 338:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
 339:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 340:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( rsa_check_context( ctx, is_priv, 1 ) );
 898              		.loc 1 340 13
 899 02f8 8B4DF4   		movl	-12(%rbp), %ecx
 900 02fb 488B45B8 		movq	-72(%rbp), %rax
 901 02ff BA010000 		movl	$1, %edx
 901      00
 902 0304 89CE     		movl	%ecx, %esi
 903 0306 4889C7   		movq	%rax, %rdi
 904 0309 E8000000 		call	rsa_check_context
 904      00
 905              	.L57:
 341:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 906              		.loc 1 341 1
 907 030e 488B4DF8 		movq	-8(%rbp), %rcx
 908 0312 6448330C 		xorq	%fs:40, %rcx
 908      25280000 
 908      00
 909 031b 7405     		je	.L63
 910 031d E8000000 		call	__stack_chk_fail@PLT
 910      00
 911              	.L63:
 912 0322 C9       		leave
 913              	.LCFI14:
 914              		.cfi_def_cfa 7, 8
 915 0323 C3       		ret
 916              		.cfi_endproc
 917              	.LFE20:
 919              		.section	.text.mbedtls_rsa_export_raw,"ax",@progbits
 920              		.globl	mbedtls_rsa_export_raw
 922              	mbedtls_rsa_export_raw:
 923              	.LFB21:
 342:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 343:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_export_raw( const mbedtls_rsa_context *ctx,
 344:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             unsigned char *N, size_t N_len,
 345:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             unsigned char *P, size_t P_len,
 346:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             unsigned char *Q, size_t Q_len,
 347:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             unsigned char *D, size_t D_len,
 348:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             unsigned char *E, size_t E_len )
 349:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 924              		.loc 1 349 1
 925              		.cfi_startproc
 926 0000 F30F1EFA 		endbr64
 927 0004 55       		pushq	%rbp
 928              	.LCFI15:
 929              		.cfi_def_cfa_offset 16
 930              		.cfi_offset 6, -16
 931 0005 4889E5   		movq	%rsp, %rbp
 932              	.LCFI16:
 933              		.cfi_def_cfa_register 6
GAS LISTING /tmp/cc6OITWc.s 			page 26


 934 0008 4883EC70 		subq	$112, %rsp
 935 000c 48897DE8 		movq	%rdi, -24(%rbp)
 936 0010 488975E0 		movq	%rsi, -32(%rbp)
 937 0014 488955D8 		movq	%rdx, -40(%rbp)
 938 0018 48894DD0 		movq	%rcx, -48(%rbp)
 939 001c 4C8945C8 		movq	%r8, -56(%rbp)
 940 0020 4C894DC0 		movq	%r9, -64(%rbp)
 941 0024 488B4510 		movq	16(%rbp), %rax
 942 0028 488945B8 		movq	%rax, -72(%rbp)
 943 002c 488B4518 		movq	24(%rbp), %rax
 944 0030 488945B0 		movq	%rax, -80(%rbp)
 945 0034 488B4520 		movq	32(%rbp), %rax
 946 0038 488945A8 		movq	%rax, -88(%rbp)
 947 003c 488B4528 		movq	40(%rbp), %rax
 948 0040 488945A0 		movq	%rax, -96(%rbp)
 949 0044 488B4530 		movq	48(%rbp), %rax
 950 0048 48894598 		movq	%rax, -104(%rbp)
 951              		.loc 1 349 1
 952 004c 64488B04 		movq	%fs:40, %rax
 952      25280000 
 952      00
 953 0055 488945F8 		movq	%rax, -8(%rbp)
 954 0059 31C0     		xorl	%eax, %eax
 350:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int ret = 0;
 955              		.loc 1 350 9
 956 005b C745F000 		movl	$0, -16(%rbp)
 956      000000
 351:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int is_priv;
 352:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
 353:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 354:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Check if key is private or public */
 355:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     is_priv =
 356:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->N, 0 ) != 0 &&
 957              		.loc 1 356 9
 958 0062 488B45E8 		movq	-24(%rbp), %rax
 959 0066 4883C010 		addq	$16, %rax
 960 006a BE000000 		movl	$0, %esi
 960      00
 961 006f 4889C7   		movq	%rax, %rdi
 962 0072 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 962      00
 357:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->P, 0 ) != 0 &&
 358:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->Q, 0 ) != 0 &&
 359:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->D, 0 ) != 0 &&
 963              		.loc 1 359 48
 964 0077 85C0     		testl	%eax, %eax
 965 0079 746B     		je	.L65
 357:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->P, 0 ) != 0 &&
 966              		.loc 1 357 9
 967 007b 488B45E8 		movq	-24(%rbp), %rax
 968 007f 4883C058 		addq	$88, %rax
 969 0083 BE000000 		movl	$0, %esi
 969      00
 970 0088 4889C7   		movq	%rax, %rdi
 971 008b E8000000 		call	mbedtls_mpi_cmp_int@PLT
 971      00
 356:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->P, 0 ) != 0 &&
GAS LISTING /tmp/cc6OITWc.s 			page 27


 972              		.loc 1 356 48
 973 0090 85C0     		testl	%eax, %eax
 974 0092 7452     		je	.L65
 358:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->D, 0 ) != 0 &&
 975              		.loc 1 358 9
 976 0094 488B45E8 		movq	-24(%rbp), %rax
 977 0098 4883C070 		addq	$112, %rax
 978 009c BE000000 		movl	$0, %esi
 978      00
 979 00a1 4889C7   		movq	%rax, %rdi
 980 00a4 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 980      00
 357:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->P, 0 ) != 0 &&
 981              		.loc 1 357 48
 982 00a9 85C0     		testl	%eax, %eax
 983 00ab 7439     		je	.L65
 984              		.loc 1 359 9
 985 00ad 488B45E8 		movq	-24(%rbp), %rax
 986 00b1 4883C040 		addq	$64, %rax
 987 00b5 BE000000 		movl	$0, %esi
 987      00
 988 00ba 4889C7   		movq	%rax, %rdi
 989 00bd E8000000 		call	mbedtls_mpi_cmp_int@PLT
 989      00
 358:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->D, 0 ) != 0 &&
 990              		.loc 1 358 48
 991 00c2 85C0     		testl	%eax, %eax
 992 00c4 7420     		je	.L65
 360:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->E, 0 ) != 0;
 993              		.loc 1 360 9 discriminator 3
 994 00c6 488B45E8 		movq	-24(%rbp), %rax
 995 00ca 4883C028 		addq	$40, %rax
 996 00ce BE000000 		movl	$0, %esi
 996      00
 997 00d3 4889C7   		movq	%rax, %rdi
 998 00d6 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 998      00
 359:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->E, 0 ) != 0;
 999              		.loc 1 359 48 discriminator 3
 1000 00db 85C0     		testl	%eax, %eax
 1001 00dd 7407     		je	.L65
 359:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->E, 0 ) != 0;
 1002              		.loc 1 359 48 is_stmt 0 discriminator 2
 1003 00df B8010000 		movl	$1, %eax
 1003      00
 1004 00e4 EB05     		jmp	.L66
 1005              	.L65:
 359:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->E, 0 ) != 0;
 1006              		.loc 1 359 48 discriminator 1
 1007 00e6 B8000000 		movl	$0, %eax
 1007      00
 1008              	.L66:
 355:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->N, 0 ) != 0 &&
 1009              		.loc 1 355 13 is_stmt 1
 1010 00eb 8945F4   		movl	%eax, -12(%rbp)
 361:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 362:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( !is_priv )
GAS LISTING /tmp/cc6OITWc.s 			page 28


 1011              		.loc 1 362 7
 1012 00ee 837DF400 		cmpl	$0, -12(%rbp)
 1013 00f2 751F     		jne	.L67
 363:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 364:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /* If we're trying to export private parameters for a public key,
 365:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          * something must be wrong. */
 366:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( P != NULL || Q != NULL || D != NULL )
 1014              		.loc 1 366 11
 1015 00f4 48837DD0 		cmpq	$0, -48(%rbp)
 1015      00
 1016 00f9 750E     		jne	.L68
 1017              		.loc 1 366 23 discriminator 1
 1018 00fb 48837DC0 		cmpq	$0, -64(%rbp)
 1018      00
 1019 0100 7507     		jne	.L68
 1020              		.loc 1 366 36 discriminator 2
 1021 0102 48837DB0 		cmpq	$0, -80(%rbp)
 1021      00
 1022 0107 740A     		je	.L67
 1023              	.L68:
 367:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 1024              		.loc 1 367 19
 1025 0109 B880BFFF 		movl	$-16512, %eax
 1025      FF
 1026 010e E9EF0000 		jmp	.L69
 1026      00
 1027              	.L67:
 368:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 369:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 370:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 371:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( N != NULL )
 1028              		.loc 1 371 7
 1029 0113 48837DE0 		cmpq	$0, -32(%rbp)
 1029      00
 1030 0118 7428     		je	.L70
 372:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_write_binary( &ctx->N, N, N_len ) );
 1031              		.loc 1 372 9
 1032 011a 488B45E8 		movq	-24(%rbp), %rax
 1033 011e 488D4810 		leaq	16(%rax), %rcx
 1034 0122 488B55D8 		movq	-40(%rbp), %rdx
 1035 0126 488B45E0 		movq	-32(%rbp), %rax
 1036 012a 4889C6   		movq	%rax, %rsi
 1037 012d 4889CF   		movq	%rcx, %rdi
 1038 0130 E8000000 		call	mbedtls_mpi_write_binary@PLT
 1038      00
 1039 0135 8945F0   		movl	%eax, -16(%rbp)
 1040 0138 837DF000 		cmpl	$0, -16(%rbp)
 1041 013c 0F85B000 		jne	.L76
 1041      0000
 1042              	.L70:
 373:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 374:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( P != NULL )
 1043              		.loc 1 374 7
 1044 0142 48837DD0 		cmpq	$0, -48(%rbp)
 1044      00
 1045 0147 7428     		je	.L72
 375:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_write_binary( &ctx->P, P, P_len ) );
GAS LISTING /tmp/cc6OITWc.s 			page 29


 1046              		.loc 1 375 9
 1047 0149 488B45E8 		movq	-24(%rbp), %rax
 1048 014d 488D4858 		leaq	88(%rax), %rcx
 1049 0151 488B55C8 		movq	-56(%rbp), %rdx
 1050 0155 488B45D0 		movq	-48(%rbp), %rax
 1051 0159 4889C6   		movq	%rax, %rsi
 1052 015c 4889CF   		movq	%rcx, %rdi
 1053 015f E8000000 		call	mbedtls_mpi_write_binary@PLT
 1053      00
 1054 0164 8945F0   		movl	%eax, -16(%rbp)
 1055 0167 837DF000 		cmpl	$0, -16(%rbp)
 1056 016b 0F858400 		jne	.L77
 1056      0000
 1057              	.L72:
 376:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 377:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( Q != NULL )
 1058              		.loc 1 377 7
 1059 0171 48837DC0 		cmpq	$0, -64(%rbp)
 1059      00
 1060 0176 7424     		je	.L73
 378:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_write_binary( &ctx->Q, Q, Q_len ) );
 1061              		.loc 1 378 9
 1062 0178 488B45E8 		movq	-24(%rbp), %rax
 1063 017c 488D4870 		leaq	112(%rax), %rcx
 1064 0180 488B55B8 		movq	-72(%rbp), %rdx
 1065 0184 488B45C0 		movq	-64(%rbp), %rax
 1066 0188 4889C6   		movq	%rax, %rsi
 1067 018b 4889CF   		movq	%rcx, %rdi
 1068 018e E8000000 		call	mbedtls_mpi_write_binary@PLT
 1068      00
 1069 0193 8945F0   		movl	%eax, -16(%rbp)
 1070 0196 837DF000 		cmpl	$0, -16(%rbp)
 1071 019a 755C     		jne	.L78
 1072              	.L73:
 379:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 380:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( D != NULL )
 1073              		.loc 1 380 7
 1074 019c 48837DB0 		cmpq	$0, -80(%rbp)
 1074      00
 1075 01a1 7424     		je	.L74
 381:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_write_binary( &ctx->D, D, D_len ) );
 1076              		.loc 1 381 9
 1077 01a3 488B45E8 		movq	-24(%rbp), %rax
 1078 01a7 488D4840 		leaq	64(%rax), %rcx
 1079 01ab 488B55A8 		movq	-88(%rbp), %rdx
 1080 01af 488B45B0 		movq	-80(%rbp), %rax
 1081 01b3 4889C6   		movq	%rax, %rsi
 1082 01b6 4889CF   		movq	%rcx, %rdi
 1083 01b9 E8000000 		call	mbedtls_mpi_write_binary@PLT
 1083      00
 1084 01be 8945F0   		movl	%eax, -16(%rbp)
 1085 01c1 837DF000 		cmpl	$0, -16(%rbp)
 1086 01c5 7534     		jne	.L79
 1087              	.L74:
 382:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 383:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( E != NULL )
 1088              		.loc 1 383 7
GAS LISTING /tmp/cc6OITWc.s 			page 30


 1089 01c7 48837DA0 		cmpq	$0, -96(%rbp)
 1089      00
 1090 01cc 7430     		je	.L80
 384:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_write_binary( &ctx->E, E, E_len ) );
 1091              		.loc 1 384 9
 1092 01ce 488B45E8 		movq	-24(%rbp), %rax
 1093 01d2 488D4828 		leaq	40(%rax), %rcx
 1094 01d6 488B5598 		movq	-104(%rbp), %rdx
 1095 01da 488B45A0 		movq	-96(%rbp), %rax
 1096 01de 4889C6   		movq	%rax, %rsi
 1097 01e1 4889CF   		movq	%rcx, %rdi
 1098 01e4 E8000000 		call	mbedtls_mpi_write_binary@PLT
 1098      00
 1099 01e9 8945F0   		movl	%eax, -16(%rbp)
 1100 01ec 837DF000 		cmpl	$0, -16(%rbp)
 385:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 386:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** cleanup:
 1101              		.loc 1 386 1
 1102 01f0 EB0C     		jmp	.L80
 1103              	.L76:
 372:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 1104              		.loc 1 372 9
 1105 01f2 90       		nop
 1106 01f3 EB0A     		jmp	.L71
 1107              	.L77:
 375:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 1108              		.loc 1 375 9
 1109 01f5 90       		nop
 1110 01f6 EB07     		jmp	.L71
 1111              	.L78:
 378:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 1112              		.loc 1 378 9
 1113 01f8 90       		nop
 1114 01f9 EB04     		jmp	.L71
 1115              	.L79:
 381:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 1116              		.loc 1 381 9
 1117 01fb 90       		nop
 1118 01fc EB01     		jmp	.L71
 1119              	.L80:
 1120              		.loc 1 386 1
 1121 01fe 90       		nop
 1122              	.L71:
 387:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 388:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( ret );
 1123              		.loc 1 388 11
 1124 01ff 8B45F0   		movl	-16(%rbp), %eax
 1125              	.L69:
 389:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 1126              		.loc 1 389 1
 1127 0202 488B4DF8 		movq	-8(%rbp), %rcx
 1128 0206 6448330C 		xorq	%fs:40, %rcx
 1128      25280000 
 1128      00
 1129 020f 7405     		je	.L75
 1130 0211 E8000000 		call	__stack_chk_fail@PLT
 1130      00
GAS LISTING /tmp/cc6OITWc.s 			page 31


 1131              	.L75:
 1132 0216 C9       		leave
 1133              	.LCFI17:
 1134              		.cfi_def_cfa 7, 8
 1135 0217 C3       		ret
 1136              		.cfi_endproc
 1137              	.LFE21:
 1139              		.section	.text.mbedtls_rsa_export,"ax",@progbits
 1140              		.globl	mbedtls_rsa_export
 1142              	mbedtls_rsa_export:
 1143              	.LFB22:
 390:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 391:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_export( const mbedtls_rsa_context *ctx,
 392:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                         mbedtls_mpi *N, mbedtls_mpi *P, mbedtls_mpi *Q,
 393:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                         mbedtls_mpi *D, mbedtls_mpi *E )
 394:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 1144              		.loc 1 394 1
 1145              		.cfi_startproc
 1146 0000 F30F1EFA 		endbr64
 1147 0004 55       		pushq	%rbp
 1148              	.LCFI18:
 1149              		.cfi_def_cfa_offset 16
 1150              		.cfi_offset 6, -16
 1151 0005 4889E5   		movq	%rsp, %rbp
 1152              	.LCFI19:
 1153              		.cfi_def_cfa_register 6
 1154 0008 4883EC40 		subq	$64, %rsp
 1155 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1156 0010 488975E0 		movq	%rsi, -32(%rbp)
 1157 0014 488955D8 		movq	%rdx, -40(%rbp)
 1158 0018 48894DD0 		movq	%rcx, -48(%rbp)
 1159 001c 4C8945C8 		movq	%r8, -56(%rbp)
 1160 0020 4C894DC0 		movq	%r9, -64(%rbp)
 1161              		.loc 1 394 1
 1162 0024 64488B04 		movq	%fs:40, %rax
 1162      25280000 
 1162      00
 1163 002d 488945F8 		movq	%rax, -8(%rbp)
 1164 0031 31C0     		xorl	%eax, %eax
 395:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int ret;
 396:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int is_priv;
 397:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
 398:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 399:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Check if key is private or public */
 400:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     is_priv =
 401:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->N, 0 ) != 0 &&
 1165              		.loc 1 401 9
 1166 0033 488B45E8 		movq	-24(%rbp), %rax
 1167 0037 4883C010 		addq	$16, %rax
 1168 003b BE000000 		movl	$0, %esi
 1168      00
 1169 0040 4889C7   		movq	%rax, %rdi
 1170 0043 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 1170      00
 402:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->P, 0 ) != 0 &&
 403:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->Q, 0 ) != 0 &&
 404:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->D, 0 ) != 0 &&
GAS LISTING /tmp/cc6OITWc.s 			page 32


 1171              		.loc 1 404 48
 1172 0048 85C0     		testl	%eax, %eax
 1173 004a 746B     		je	.L82
 402:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->P, 0 ) != 0 &&
 1174              		.loc 1 402 9
 1175 004c 488B45E8 		movq	-24(%rbp), %rax
 1176 0050 4883C058 		addq	$88, %rax
 1177 0054 BE000000 		movl	$0, %esi
 1177      00
 1178 0059 4889C7   		movq	%rax, %rdi
 1179 005c E8000000 		call	mbedtls_mpi_cmp_int@PLT
 1179      00
 401:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->P, 0 ) != 0 &&
 1180              		.loc 1 401 48
 1181 0061 85C0     		testl	%eax, %eax
 1182 0063 7452     		je	.L82
 403:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->D, 0 ) != 0 &&
 1183              		.loc 1 403 9
 1184 0065 488B45E8 		movq	-24(%rbp), %rax
 1185 0069 4883C070 		addq	$112, %rax
 1186 006d BE000000 		movl	$0, %esi
 1186      00
 1187 0072 4889C7   		movq	%rax, %rdi
 1188 0075 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 1188      00
 402:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->P, 0 ) != 0 &&
 1189              		.loc 1 402 48
 1190 007a 85C0     		testl	%eax, %eax
 1191 007c 7439     		je	.L82
 1192              		.loc 1 404 9
 1193 007e 488B45E8 		movq	-24(%rbp), %rax
 1194 0082 4883C040 		addq	$64, %rax
 1195 0086 BE000000 		movl	$0, %esi
 1195      00
 1196 008b 4889C7   		movq	%rax, %rdi
 1197 008e E8000000 		call	mbedtls_mpi_cmp_int@PLT
 1197      00
 403:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->D, 0 ) != 0 &&
 1198              		.loc 1 403 48
 1199 0093 85C0     		testl	%eax, %eax
 1200 0095 7420     		je	.L82
 405:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->E, 0 ) != 0;
 1201              		.loc 1 405 9 discriminator 3
 1202 0097 488B45E8 		movq	-24(%rbp), %rax
 1203 009b 4883C028 		addq	$40, %rax
 1204 009f BE000000 		movl	$0, %esi
 1204      00
 1205 00a4 4889C7   		movq	%rax, %rdi
 1206 00a7 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 1206      00
 404:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->E, 0 ) != 0;
 1207              		.loc 1 404 48 discriminator 3
 1208 00ac 85C0     		testl	%eax, %eax
 1209 00ae 7407     		je	.L82
 404:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->E, 0 ) != 0;
 1210              		.loc 1 404 48 is_stmt 0 discriminator 2
 1211 00b0 B8010000 		movl	$1, %eax
GAS LISTING /tmp/cc6OITWc.s 			page 33


 1211      00
 1212 00b5 EB05     		jmp	.L83
 1213              	.L82:
 404:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->E, 0 ) != 0;
 1214              		.loc 1 404 48 discriminator 1
 1215 00b7 B8000000 		movl	$0, %eax
 1215      00
 1216              	.L83:
 400:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->N, 0 ) != 0 &&
 1217              		.loc 1 400 13 is_stmt 1
 1218 00bc 8945F4   		movl	%eax, -12(%rbp)
 406:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 407:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( !is_priv )
 1219              		.loc 1 407 7
 1220 00bf 837DF400 		cmpl	$0, -12(%rbp)
 1221 00c3 751F     		jne	.L84
 408:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 409:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /* If we're trying to export private parameters for a public key,
 410:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          * something must be wrong. */
 411:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( P != NULL || Q != NULL || D != NULL )
 1222              		.loc 1 411 11
 1223 00c5 48837DD8 		cmpq	$0, -40(%rbp)
 1223      00
 1224 00ca 750E     		jne	.L85
 1225              		.loc 1 411 23 discriminator 1
 1226 00cc 48837DD0 		cmpq	$0, -48(%rbp)
 1226      00
 1227 00d1 7507     		jne	.L85
 1228              		.loc 1 411 36 discriminator 2
 1229 00d3 48837DC8 		cmpq	$0, -56(%rbp)
 1229      00
 1230 00d8 740A     		je	.L84
 1231              	.L85:
 412:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 1232              		.loc 1 412 19
 1233 00da B880BFFF 		movl	$-16512, %eax
 1233      FF
 1234 00df E9D10000 		jmp	.L86
 1234      00
 1235              	.L84:
 413:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 414:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 415:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 416:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Export all requested core parameters. */
 417:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 418:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( N != NULL && ( ret = mbedtls_mpi_copy( N, &ctx->N ) ) != 0 ) ||
 1236              		.loc 1 418 7
 1237 00e4 48837DE0 		cmpq	$0, -32(%rbp)
 1237      00
 1238 00e9 7424     		je	.L87
 1239              		.loc 1 418 32 discriminator 1
 1240 00eb 488B45E8 		movq	-24(%rbp), %rax
 1241 00ef 488D5010 		leaq	16(%rax), %rdx
 1242 00f3 488B45E0 		movq	-32(%rbp), %rax
 1243 00f7 4889D6   		movq	%rdx, %rsi
 1244 00fa 4889C7   		movq	%rax, %rdi
 1245 00fd E8000000 		call	mbedtls_mpi_copy@PLT
GAS LISTING /tmp/cc6OITWc.s 			page 34


 1245      00
 1246 0102 8945F0   		movl	%eax, -16(%rbp)
 1247              		.loc 1 418 21 discriminator 1
 1248 0105 837DF000 		cmpl	$0, -16(%rbp)
 1249 0109 0F859C00 		jne	.L88
 1249      0000
 1250              	.L87:
 1251              		.loc 1 418 72 discriminator 3
 1252 010f 48837DD8 		cmpq	$0, -40(%rbp)
 1252      00
 1253 0114 7420     		je	.L89
 419:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ( P != NULL && ( ret = mbedtls_mpi_copy( P, &ctx->P ) ) != 0 ) ||
 1254              		.loc 1 419 32
 1255 0116 488B45E8 		movq	-24(%rbp), %rax
 1256 011a 488D5058 		leaq	88(%rax), %rdx
 1257 011e 488B45D8 		movq	-40(%rbp), %rax
 1258 0122 4889D6   		movq	%rdx, %rsi
 1259 0125 4889C7   		movq	%rax, %rdi
 1260 0128 E8000000 		call	mbedtls_mpi_copy@PLT
 1260      00
 1261 012d 8945F0   		movl	%eax, -16(%rbp)
 1262              		.loc 1 419 21
 1263 0130 837DF000 		cmpl	$0, -16(%rbp)
 1264 0134 7575     		jne	.L88
 1265              	.L89:
 1266              		.loc 1 419 72 discriminator 1
 1267 0136 48837DD0 		cmpq	$0, -48(%rbp)
 1267      00
 1268 013b 7420     		je	.L90
 420:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ( Q != NULL && ( ret = mbedtls_mpi_copy( Q, &ctx->Q ) ) != 0 ) ||
 1269              		.loc 1 420 32
 1270 013d 488B45E8 		movq	-24(%rbp), %rax
 1271 0141 488D5070 		leaq	112(%rax), %rdx
 1272 0145 488B45D0 		movq	-48(%rbp), %rax
 1273 0149 4889D6   		movq	%rdx, %rsi
 1274 014c 4889C7   		movq	%rax, %rdi
 1275 014f E8000000 		call	mbedtls_mpi_copy@PLT
 1275      00
 1276 0154 8945F0   		movl	%eax, -16(%rbp)
 1277              		.loc 1 420 21
 1278 0157 837DF000 		cmpl	$0, -16(%rbp)
 1279 015b 754E     		jne	.L88
 1280              	.L90:
 1281              		.loc 1 420 72 discriminator 1
 1282 015d 48837DC8 		cmpq	$0, -56(%rbp)
 1282      00
 1283 0162 7420     		je	.L91
 421:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ( D != NULL && ( ret = mbedtls_mpi_copy( D, &ctx->D ) ) != 0 ) ||
 1284              		.loc 1 421 32
 1285 0164 488B45E8 		movq	-24(%rbp), %rax
 1286 0168 488D5040 		leaq	64(%rax), %rdx
 1287 016c 488B45C8 		movq	-56(%rbp), %rax
 1288 0170 4889D6   		movq	%rdx, %rsi
 1289 0173 4889C7   		movq	%rax, %rdi
 1290 0176 E8000000 		call	mbedtls_mpi_copy@PLT
 1290      00
 1291 017b 8945F0   		movl	%eax, -16(%rbp)
GAS LISTING /tmp/cc6OITWc.s 			page 35


 1292              		.loc 1 421 21
 1293 017e 837DF000 		cmpl	$0, -16(%rbp)
 1294 0182 7527     		jne	.L88
 1295              	.L91:
 1296              		.loc 1 421 72 discriminator 1
 1297 0184 48837DC0 		cmpq	$0, -64(%rbp)
 1297      00
 1298 0189 7425     		je	.L92
 422:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ( E != NULL && ( ret = mbedtls_mpi_copy( E, &ctx->E ) ) != 0 ) )
 1299              		.loc 1 422 32
 1300 018b 488B45E8 		movq	-24(%rbp), %rax
 1301 018f 488D5028 		leaq	40(%rax), %rdx
 1302 0193 488B45C0 		movq	-64(%rbp), %rax
 1303 0197 4889D6   		movq	%rdx, %rsi
 1304 019a 4889C7   		movq	%rax, %rdi
 1305 019d E8000000 		call	mbedtls_mpi_copy@PLT
 1305      00
 1306 01a2 8945F0   		movl	%eax, -16(%rbp)
 1307              		.loc 1 422 21
 1308 01a5 837DF000 		cmpl	$0, -16(%rbp)
 1309 01a9 7405     		je	.L92
 1310              	.L88:
 423:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 424:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( ret );
 1311              		.loc 1 424 15
 1312 01ab 8B45F0   		movl	-16(%rbp), %eax
 1313 01ae EB05     		jmp	.L86
 1314              	.L92:
 425:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 426:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 427:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( 0 );
 1315              		.loc 1 427 11
 1316 01b0 B8000000 		movl	$0, %eax
 1316      00
 1317              	.L86:
 428:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 1318              		.loc 1 428 1
 1319 01b5 488B4DF8 		movq	-8(%rbp), %rcx
 1320 01b9 6448330C 		xorq	%fs:40, %rcx
 1320      25280000 
 1320      00
 1321 01c2 7405     		je	.L93
 1322 01c4 E8000000 		call	__stack_chk_fail@PLT
 1322      00
 1323              	.L93:
 1324 01c9 C9       		leave
 1325              	.LCFI20:
 1326              		.cfi_def_cfa 7, 8
 1327 01ca C3       		ret
 1328              		.cfi_endproc
 1329              	.LFE22:
 1331              		.section	.text.mbedtls_rsa_export_crt,"ax",@progbits
 1332              		.globl	mbedtls_rsa_export_crt
 1334              	mbedtls_rsa_export_crt:
 1335              	.LFB23:
 429:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 430:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
GAS LISTING /tmp/cc6OITWc.s 			page 36


 431:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Export CRT parameters
 432:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * This must also be implemented if CRT is not used, for being able to
 433:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * write DER encoded RSA keys. The helper function mbedtls_rsa_deduce_crt
 434:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * can be used in this case.
 435:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
 436:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_export_crt( const mbedtls_rsa_context *ctx,
 437:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             mbedtls_mpi *DP, mbedtls_mpi *DQ, mbedtls_mpi *QP )
 438:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 1336              		.loc 1 438 1
 1337              		.cfi_startproc
 1338 0000 F30F1EFA 		endbr64
 1339 0004 55       		pushq	%rbp
 1340              	.LCFI21:
 1341              		.cfi_def_cfa_offset 16
 1342              		.cfi_offset 6, -16
 1343 0005 4889E5   		movq	%rsp, %rbp
 1344              	.LCFI22:
 1345              		.cfi_def_cfa_register 6
 1346 0008 4883EC30 		subq	$48, %rsp
 1347 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1348 0010 488975E0 		movq	%rsi, -32(%rbp)
 1349 0014 488955D8 		movq	%rdx, -40(%rbp)
 1350 0018 48894DD0 		movq	%rcx, -48(%rbp)
 1351              		.loc 1 438 1
 1352 001c 64488B04 		movq	%fs:40, %rax
 1352      25280000 
 1352      00
 1353 0025 488945F8 		movq	%rax, -8(%rbp)
 1354 0029 31C0     		xorl	%eax, %eax
 439:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int ret;
 440:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int is_priv;
 441:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
 442:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 443:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Check if key is private or public */
 444:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     is_priv =
 445:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->N, 0 ) != 0 &&
 1355              		.loc 1 445 9
 1356 002b 488B45E8 		movq	-24(%rbp), %rax
 1357 002f 4883C010 		addq	$16, %rax
 1358 0033 BE000000 		movl	$0, %esi
 1358      00
 1359 0038 4889C7   		movq	%rax, %rdi
 1360 003b E8000000 		call	mbedtls_mpi_cmp_int@PLT
 1360      00
 446:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->P, 0 ) != 0 &&
 447:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->Q, 0 ) != 0 &&
 448:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->D, 0 ) != 0 &&
 1361              		.loc 1 448 48
 1362 0040 85C0     		testl	%eax, %eax
 1363 0042 746B     		je	.L95
 446:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->P, 0 ) != 0 &&
 1364              		.loc 1 446 9
 1365 0044 488B45E8 		movq	-24(%rbp), %rax
 1366 0048 4883C058 		addq	$88, %rax
 1367 004c BE000000 		movl	$0, %esi
 1367      00
 1368 0051 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/cc6OITWc.s 			page 37


 1369 0054 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 1369      00
 445:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->P, 0 ) != 0 &&
 1370              		.loc 1 445 48
 1371 0059 85C0     		testl	%eax, %eax
 1372 005b 7452     		je	.L95
 447:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->D, 0 ) != 0 &&
 1373              		.loc 1 447 9
 1374 005d 488B45E8 		movq	-24(%rbp), %rax
 1375 0061 4883C070 		addq	$112, %rax
 1376 0065 BE000000 		movl	$0, %esi
 1376      00
 1377 006a 4889C7   		movq	%rax, %rdi
 1378 006d E8000000 		call	mbedtls_mpi_cmp_int@PLT
 1378      00
 446:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->P, 0 ) != 0 &&
 1379              		.loc 1 446 48
 1380 0072 85C0     		testl	%eax, %eax
 1381 0074 7439     		je	.L95
 1382              		.loc 1 448 9
 1383 0076 488B45E8 		movq	-24(%rbp), %rax
 1384 007a 4883C040 		addq	$64, %rax
 1385 007e BE000000 		movl	$0, %esi
 1385      00
 1386 0083 4889C7   		movq	%rax, %rdi
 1387 0086 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 1387      00
 447:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->D, 0 ) != 0 &&
 1388              		.loc 1 447 48
 1389 008b 85C0     		testl	%eax, %eax
 1390 008d 7420     		je	.L95
 449:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->E, 0 ) != 0;
 1391              		.loc 1 449 9 discriminator 3
 1392 008f 488B45E8 		movq	-24(%rbp), %rax
 1393 0093 4883C028 		addq	$40, %rax
 1394 0097 BE000000 		movl	$0, %esi
 1394      00
 1395 009c 4889C7   		movq	%rax, %rdi
 1396 009f E8000000 		call	mbedtls_mpi_cmp_int@PLT
 1396      00
 448:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->E, 0 ) != 0;
 1397              		.loc 1 448 48 discriminator 3
 1398 00a4 85C0     		testl	%eax, %eax
 1399 00a6 7407     		je	.L95
 448:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->E, 0 ) != 0;
 1400              		.loc 1 448 48 is_stmt 0 discriminator 2
 1401 00a8 B8010000 		movl	$1, %eax
 1401      00
 1402 00ad EB05     		jmp	.L96
 1403              	.L95:
 448:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->E, 0 ) != 0;
 1404              		.loc 1 448 48 discriminator 1
 1405 00af B8000000 		movl	$0, %eax
 1405      00
 1406              	.L96:
 444:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_int( &ctx->N, 0 ) != 0 &&
 1407              		.loc 1 444 13 is_stmt 1
GAS LISTING /tmp/cc6OITWc.s 			page 38


 1408 00b4 8945F4   		movl	%eax, -12(%rbp)
 450:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 451:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( !is_priv )
 1409              		.loc 1 451 7
 1410 00b7 837DF400 		cmpl	$0, -12(%rbp)
 1411 00bb 750A     		jne	.L97
 452:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 1412              		.loc 1 452 15
 1413 00bd B880BFFF 		movl	$-16512, %eax
 1413      FF
 1414 00c2 E98D0000 		jmp	.L98
 1414      00
 1415              	.L97:
 453:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 454:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if !defined(MBEDTLS_RSA_NO_CRT)
 455:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Export all requested blinding parameters. */
 456:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( DP != NULL && ( ret = mbedtls_mpi_copy( DP, &ctx->DP ) ) != 0 ) ||
 1416              		.loc 1 456 7
 1417 00c7 48837DE0 		cmpq	$0, -32(%rbp)
 1417      00
 1418 00cc 7423     		je	.L99
 1419              		.loc 1 456 33 discriminator 1
 1420 00ce 488B45E8 		movq	-24(%rbp), %rax
 1421 00d2 488D9088 		leaq	136(%rax), %rdx
 1421      000000
 1422 00d9 488B45E0 		movq	-32(%rbp), %rax
 1423 00dd 4889D6   		movq	%rdx, %rsi
 1424 00e0 4889C7   		movq	%rax, %rdi
 1425 00e3 E8000000 		call	mbedtls_mpi_copy@PLT
 1425      00
 1426 00e8 8945F0   		movl	%eax, -16(%rbp)
 1427              		.loc 1 456 22 discriminator 1
 1428 00eb 837DF000 		cmpl	$0, -16(%rbp)
 1429 00ef 7554     		jne	.L100
 1430              	.L99:
 1431              		.loc 1 456 75 discriminator 3
 1432 00f1 48837DD8 		cmpq	$0, -40(%rbp)
 1432      00
 1433 00f6 7423     		je	.L101
 457:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ( DQ != NULL && ( ret = mbedtls_mpi_copy( DQ, &ctx->DQ ) ) != 0 ) ||
 1434              		.loc 1 457 33
 1435 00f8 488B45E8 		movq	-24(%rbp), %rax
 1436 00fc 488D90A0 		leaq	160(%rax), %rdx
 1436      000000
 1437 0103 488B45D8 		movq	-40(%rbp), %rax
 1438 0107 4889D6   		movq	%rdx, %rsi
 1439 010a 4889C7   		movq	%rax, %rdi
 1440 010d E8000000 		call	mbedtls_mpi_copy@PLT
 1440      00
 1441 0112 8945F0   		movl	%eax, -16(%rbp)
 1442              		.loc 1 457 22
 1443 0115 837DF000 		cmpl	$0, -16(%rbp)
 1444 0119 752A     		jne	.L100
 1445              	.L101:
 1446              		.loc 1 457 75 discriminator 1
 1447 011b 48837DD0 		cmpq	$0, -48(%rbp)
 1447      00
GAS LISTING /tmp/cc6OITWc.s 			page 39


 1448 0120 742D     		je	.L102
 458:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ( QP != NULL && ( ret = mbedtls_mpi_copy( QP, &ctx->QP ) ) != 0 ) )
 1449              		.loc 1 458 33
 1450 0122 488B45E8 		movq	-24(%rbp), %rax
 1451 0126 488D90B8 		leaq	184(%rax), %rdx
 1451      000000
 1452 012d 488B45D0 		movq	-48(%rbp), %rax
 1453 0131 4889D6   		movq	%rdx, %rsi
 1454 0134 4889C7   		movq	%rax, %rdi
 1455 0137 E8000000 		call	mbedtls_mpi_copy@PLT
 1455      00
 1456 013c 8945F0   		movl	%eax, -16(%rbp)
 1457              		.loc 1 458 22
 1458 013f 837DF000 		cmpl	$0, -16(%rbp)
 1459 0143 740A     		je	.L102
 1460              	.L100:
 459:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 460:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA + ret );
 1461              		.loc 1 460 48
 1462 0145 8B45F0   		movl	-16(%rbp), %eax
 1463 0148 2D804000 		subl	$16512, %eax
 1463      00
 1464 014d EB05     		jmp	.L98
 1465              	.L102:
 461:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 462:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #else
 463:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = mbedtls_rsa_deduce_crt( &ctx->P, &ctx->Q, &ctx->D,
 464:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                         DP, DQ, QP ) ) != 0 )
 465:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 466:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA + ret );
 467:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 468:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
 469:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 470:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( 0 );
 1466              		.loc 1 470 11
 1467 014f B8000000 		movl	$0, %eax
 1467      00
 1468              	.L98:
 471:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 1469              		.loc 1 471 1
 1470 0154 488B4DF8 		movq	-8(%rbp), %rcx
 1471 0158 6448330C 		xorq	%fs:40, %rcx
 1471      25280000 
 1471      00
 1472 0161 7405     		je	.L103
 1473 0163 E8000000 		call	__stack_chk_fail@PLT
 1473      00
 1474              	.L103:
 1475 0168 C9       		leave
 1476              	.LCFI23:
 1477              		.cfi_def_cfa 7, 8
 1478 0169 C3       		ret
 1479              		.cfi_endproc
 1480              	.LFE23:
 1482              		.section	.text.mbedtls_rsa_init,"ax",@progbits
 1483              		.globl	mbedtls_rsa_init
 1485              	mbedtls_rsa_init:
GAS LISTING /tmp/cc6OITWc.s 			page 40


 1486              	.LFB24:
 472:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 473:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
 474:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Initialize an RSA context
 475:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
 476:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** void mbedtls_rsa_init( mbedtls_rsa_context *ctx,
 477:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                int padding,
 478:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                int hash_id )
 479:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 1487              		.loc 1 479 1
 1488              		.cfi_startproc
 1489 0000 F30F1EFA 		endbr64
 1490 0004 55       		pushq	%rbp
 1491              	.LCFI24:
 1492              		.cfi_def_cfa_offset 16
 1493              		.cfi_offset 6, -16
 1494 0005 4889E5   		movq	%rsp, %rbp
 1495              	.LCFI25:
 1496              		.cfi_def_cfa_register 6
 1497 0008 4883EC20 		subq	$32, %rsp
 1498 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1499 0010 8975E4   		movl	%esi, -28(%rbp)
 1500 0013 8955E0   		movl	%edx, -32(%rbp)
 1501              		.loc 1 479 1
 1502 0016 64488B04 		movq	%fs:40, %rax
 1502      25280000 
 1502      00
 1503 001f 488945F8 		movq	%rax, -8(%rbp)
 1504 0023 31C0     		xorl	%eax, %eax
 480:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE( ctx != NULL );
 481:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE( padding == MBEDTLS_RSA_PKCS_V15 ||
 482:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                   padding == MBEDTLS_RSA_PKCS_V21 );
 483:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 484:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     memset( ctx, 0, sizeof( mbedtls_rsa_context ) );
 1505              		.loc 1 484 5
 1506 0025 488B45E8 		movq	-24(%rbp), %rax
 1507 0029 BA500100 		movl	$336, %edx
 1507      00
 1508 002e BE000000 		movl	$0, %esi
 1508      00
 1509 0033 4889C7   		movq	%rax, %rdi
 1510 0036 E8000000 		call	memset@PLT
 1510      00
 485:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 486:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_rsa_set_padding( ctx, padding, hash_id );
 1511              		.loc 1 486 5
 1512 003b 8B55E0   		movl	-32(%rbp), %edx
 1513 003e 8B4DE4   		movl	-28(%rbp), %ecx
 1514 0041 488B45E8 		movq	-24(%rbp), %rax
 1515 0045 89CE     		movl	%ecx, %esi
 1516 0047 4889C7   		movq	%rax, %rdi
 1517 004a E8000000 		call	mbedtls_rsa_set_padding
 1517      00
 487:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 488:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_THREADING_C)
 489:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mutex_init( &ctx->mutex );
 490:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
GAS LISTING /tmp/cc6OITWc.s 			page 41


 491:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 1518              		.loc 1 491 1
 1519 004f 90       		nop
 1520 0050 488B45F8 		movq	-8(%rbp), %rax
 1521 0054 64483304 		xorq	%fs:40, %rax
 1521      25280000 
 1521      00
 1522 005d 7405     		je	.L105
 1523 005f E8000000 		call	__stack_chk_fail@PLT
 1523      00
 1524              	.L105:
 1525 0064 C9       		leave
 1526              	.LCFI26:
 1527              		.cfi_def_cfa 7, 8
 1528 0065 C3       		ret
 1529              		.cfi_endproc
 1530              	.LFE24:
 1532              		.section	.text.mbedtls_rsa_set_padding,"ax",@progbits
 1533              		.globl	mbedtls_rsa_set_padding
 1535              	mbedtls_rsa_set_padding:
 1536              	.LFB25:
 492:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 493:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
 494:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Set padding for an existing RSA context
 495:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
 496:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** void mbedtls_rsa_set_padding( mbedtls_rsa_context *ctx, int padding,
 497:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                               int hash_id )
 498:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 1537              		.loc 1 498 1
 1538              		.cfi_startproc
 1539 0000 F30F1EFA 		endbr64
 1540 0004 55       		pushq	%rbp
 1541              	.LCFI27:
 1542              		.cfi_def_cfa_offset 16
 1543              		.cfi_offset 6, -16
 1544 0005 4889E5   		movq	%rsp, %rbp
 1545              	.LCFI28:
 1546              		.cfi_def_cfa_register 6
 1547 0008 4883EC20 		subq	$32, %rsp
 1548 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1549 0010 8975E4   		movl	%esi, -28(%rbp)
 1550 0013 8955E0   		movl	%edx, -32(%rbp)
 1551              		.loc 1 498 1
 1552 0016 64488B04 		movq	%fs:40, %rax
 1552      25280000 
 1552      00
 1553 001f 488945F8 		movq	%rax, -8(%rbp)
 1554 0023 31C0     		xorl	%eax, %eax
 499:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE( ctx != NULL );
 500:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE( padding == MBEDTLS_RSA_PKCS_V15 ||
 501:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                   padding == MBEDTLS_RSA_PKCS_V21 );
 502:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 503:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     ctx->padding = padding;
 1555              		.loc 1 503 18
 1556 0025 488B45E8 		movq	-24(%rbp), %rax
 1557 0029 8B55E4   		movl	-28(%rbp), %edx
 1558 002c 89904801 		movl	%edx, 328(%rax)
GAS LISTING /tmp/cc6OITWc.s 			page 42


 1558      0000
 504:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     ctx->hash_id = hash_id;
 1559              		.loc 1 504 18
 1560 0032 488B45E8 		movq	-24(%rbp), %rax
 1561 0036 8B55E0   		movl	-32(%rbp), %edx
 1562 0039 89904C01 		movl	%edx, 332(%rax)
 1562      0000
 505:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 1563              		.loc 1 505 1
 1564 003f 90       		nop
 1565 0040 488B45F8 		movq	-8(%rbp), %rax
 1566 0044 64483304 		xorq	%fs:40, %rax
 1566      25280000 
 1566      00
 1567 004d 7405     		je	.L107
 1568 004f E8000000 		call	__stack_chk_fail@PLT
 1568      00
 1569              	.L107:
 1570 0054 C9       		leave
 1571              	.LCFI29:
 1572              		.cfi_def_cfa 7, 8
 1573 0055 C3       		ret
 1574              		.cfi_endproc
 1575              	.LFE25:
 1577              		.section	.text.mbedtls_rsa_get_len,"ax",@progbits
 1578              		.globl	mbedtls_rsa_get_len
 1580              	mbedtls_rsa_get_len:
 1581              	.LFB26:
 506:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 507:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
 508:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Get length in bytes of RSA modulus
 509:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
 510:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 511:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** size_t mbedtls_rsa_get_len( const mbedtls_rsa_context *ctx )
 512:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 1582              		.loc 1 512 1
 1583              		.cfi_startproc
 1584 0000 F30F1EFA 		endbr64
 1585 0004 55       		pushq	%rbp
 1586              	.LCFI30:
 1587              		.cfi_def_cfa_offset 16
 1588              		.cfi_offset 6, -16
 1589 0005 4889E5   		movq	%rsp, %rbp
 1590              	.LCFI31:
 1591              		.cfi_def_cfa_register 6
 1592 0008 4883EC20 		subq	$32, %rsp
 1593 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1594              		.loc 1 512 1
 1595 0010 64488B04 		movq	%fs:40, %rax
 1595      25280000 
 1595      00
 1596 0019 488945F8 		movq	%rax, -8(%rbp)
 1597 001d 31C0     		xorl	%eax, %eax
 513:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( ctx->len );
 1598              		.loc 1 513 16
 1599 001f 488B45E8 		movq	-24(%rbp), %rax
 1600 0023 488B4008 		movq	8(%rax), %rax
GAS LISTING /tmp/cc6OITWc.s 			page 43


 514:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 1601              		.loc 1 514 1
 1602 0027 488B55F8 		movq	-8(%rbp), %rdx
 1603 002b 64483314 		xorq	%fs:40, %rdx
 1603      25280000 
 1603      00
 1604 0034 7405     		je	.L110
 1605 0036 E8000000 		call	__stack_chk_fail@PLT
 1605      00
 1606              	.L110:
 1607 003b C9       		leave
 1608              	.LCFI32:
 1609              		.cfi_def_cfa 7, 8
 1610 003c C3       		ret
 1611              		.cfi_endproc
 1612              	.LFE26:
 1614              		.section	.text.mbedtls_rsa_check_pubkey,"ax",@progbits
 1615              		.globl	mbedtls_rsa_check_pubkey
 1617              	mbedtls_rsa_check_pubkey:
 1618              	.LFB27:
 515:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 516:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 517:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_GENPRIME)
 518:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 519:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
 520:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Generate an RSA keypair
 521:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
 522:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * This generation method follows the RSA key pair generation procedure of
 523:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * FIPS 186-4 if 2^16 < exponent < 2^256 and nbits = 2048 or nbits = 3072.
 524:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
 525:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_gen_key( mbedtls_rsa_context *ctx,
 526:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                  int (*f_rng)(void *, unsigned char *, size_t),
 527:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                  void *p_rng,
 528:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                  unsigned int nbits, int exponent )
 529:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 530:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int ret;
 531:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi H, G, L;
 532:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int prime_quality = 0;
 533:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
 534:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( f_rng != NULL );
 535:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 536:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( nbits < 128 || exponent < 3 || nbits % 2 != 0 )
 537:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 538:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 539:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
 540:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * If the modulus is 1024 bit long or shorter, then the security strength of
 541:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * the RSA algorithm is less than or equal to 80 bits and therefore an error
 542:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * rate of 2^-80 is sufficient.
 543:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
 544:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( nbits > 1024 )
 545:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         prime_quality = MBEDTLS_MPI_GEN_PRIME_FLAG_LOW_ERR;
 546:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 547:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_init( &H );
 548:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_init( &G );
 549:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_init( &L );
 550:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 551:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
GAS LISTING /tmp/cc6OITWc.s 			page 44


 552:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * find primes P and Q with Q < P so that:
 553:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * 1.  |P-Q| > 2^( nbits / 2 - 100 )
 554:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * 2.  GCD( E, (P-1)*(Q-1) ) == 1
 555:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * 3.  E^-1 mod LCM(P-1, Q-1) > 2^( nbits / 2 )
 556:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
 557:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_lset( &ctx->E, exponent ) );
 558:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 559:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     do
 560:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 561:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_gen_prime( &ctx->P, nbits >> 1,
 562:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                                 prime_quality, f_rng, p_rng ) );
 563:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 564:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_gen_prime( &ctx->Q, nbits >> 1,
 565:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                                 prime_quality, f_rng, p_rng ) );
 566:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 567:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /* make sure the difference between p and q is not too small (FIPS 186-4 ¬ßB.3.3 step 5.4) 
 568:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &H, &ctx->P, &ctx->Q ) );
 569:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( mbedtls_mpi_bitlen( &H ) <= ( ( nbits >= 200 ) ? ( ( nbits >> 1 ) - 99 ) : 0 ) )
 570:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             continue;
 571:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 572:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /* not required by any standards, but some users rely on the fact that P > Q */
 573:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( H.s < 0 )
 574:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             mbedtls_mpi_swap( &ctx->P, &ctx->Q );
 575:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 576:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /* Temporarily replace P,Q by P-1, Q-1 */
 577:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_sub_int( &ctx->P, &ctx->P, 1 ) );
 578:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_sub_int( &ctx->Q, &ctx->Q, 1 ) );
 579:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &H, &ctx->P, &ctx->Q ) );
 580:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 581:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /* check GCD( E, (P-1)*(Q-1) ) == 1 (FIPS 186-4 ¬ßB.3.1 criterion 2(a)) */
 582:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_gcd( &G, &ctx->E, &H  ) );
 583:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( mbedtls_mpi_cmp_int( &G, 1 ) != 0 )
 584:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             continue;
 585:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 586:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /* compute smallest possible D = E^-1 mod LCM(P-1, Q-1) (FIPS 186-4 ¬ßB.3.1 criterion 3(b))
 587:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_gcd( &G, &ctx->P, &ctx->Q ) );
 588:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_div_mpi( &L, NULL, &H, &G ) );
 589:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_inv_mod( &ctx->D, &ctx->E, &L ) );
 590:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 591:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( mbedtls_mpi_bitlen( &ctx->D ) <= ( ( nbits + 1 ) / 2 ) ) // (FIPS 186-4 ¬ßB.3.1 criteri
 592:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             continue;
 593:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 594:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         break;
 595:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 596:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     while( 1 );
 597:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 598:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Restore P,Q */
 599:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_add_int( &ctx->P,  &ctx->P, 1 ) );
 600:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_add_int( &ctx->Q,  &ctx->Q, 1 ) );
 601:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 602:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &ctx->N, &ctx->P, &ctx->Q ) );
 603:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 604:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     ctx->len = mbedtls_mpi_size( &ctx->N );
 605:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 606:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if !defined(MBEDTLS_RSA_NO_CRT)
 607:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
 608:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * DP = D mod (P - 1)
GAS LISTING /tmp/cc6OITWc.s 			page 45


 609:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * DQ = D mod (Q - 1)
 610:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * QP = Q^-1 mod P
 611:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
 612:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_rsa_deduce_crt( &ctx->P, &ctx->Q, &ctx->D,
 613:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                              &ctx->DP, &ctx->DQ, &ctx->QP ) );
 614:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif /* MBEDTLS_RSA_NO_CRT */
 615:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 616:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Double-check */
 617:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_rsa_check_privkey( ctx ) );
 618:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 619:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** cleanup:
 620:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 621:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &H );
 622:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &G );
 623:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &L );
 624:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 625:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ret != 0 )
 626:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 627:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_rsa_free( ctx );
 628:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_KEY_GEN_FAILED + ret );
 629:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 630:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 631:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( 0 );
 632:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 633:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 634:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif /* MBEDTLS_GENPRIME */
 635:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 636:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
 637:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Check a public RSA key
 638:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
 639:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_check_pubkey( const mbedtls_rsa_context *ctx )
 640:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 1619              		.loc 1 640 1
 1620              		.cfi_startproc
 1621 0000 F30F1EFA 		endbr64
 1622 0004 55       		pushq	%rbp
 1623              	.LCFI33:
 1624              		.cfi_def_cfa_offset 16
 1625              		.cfi_offset 6, -16
 1626 0005 4889E5   		movq	%rsp, %rbp
 1627              	.LCFI34:
 1628              		.cfi_def_cfa_register 6
 1629 0008 4883EC20 		subq	$32, %rsp
 1630 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1631              		.loc 1 640 1
 1632 0010 64488B04 		movq	%fs:40, %rax
 1632      25280000 
 1632      00
 1633 0019 488945F8 		movq	%rax, -8(%rbp)
 1634 001d 31C0     		xorl	%eax, %eax
 641:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
 642:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 643:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( rsa_check_context( ctx, 0 /* public */, 0 /* no blinding */ ) != 0 )
 1635              		.loc 1 643 9
 1636 001f 488B45E8 		movq	-24(%rbp), %rax
 1637 0023 BA000000 		movl	$0, %edx
 1637      00
GAS LISTING /tmp/cc6OITWc.s 			page 46


 1638 0028 BE000000 		movl	$0, %esi
 1638      00
 1639 002d 4889C7   		movq	%rax, %rdi
 1640 0030 E8000000 		call	rsa_check_context
 1640      00
 1641              		.loc 1 643 7
 1642 0035 85C0     		testl	%eax, %eax
 1643 0037 7407     		je	.L112
 644:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_KEY_CHECK_FAILED );
 1644              		.loc 1 644 15
 1645 0039 B800BEFF 		movl	$-16896, %eax
 1645      FF
 1646 003e EB77     		jmp	.L113
 1647              	.L112:
 645:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 646:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mbedtls_mpi_bitlen( &ctx->N ) < 128 )
 1648              		.loc 1 646 9
 1649 0040 488B45E8 		movq	-24(%rbp), %rax
 1650 0044 4883C010 		addq	$16, %rax
 1651 0048 4889C7   		movq	%rax, %rdi
 1652 004b E8000000 		call	mbedtls_mpi_bitlen@PLT
 1652      00
 1653              		.loc 1 646 7
 1654 0050 4883F87F 		cmpq	$127, %rax
 1655 0054 7707     		ja	.L114
 647:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 648:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_KEY_CHECK_FAILED );
 1656              		.loc 1 648 15
 1657 0056 B800BEFF 		movl	$-16896, %eax
 1657      FF
 1658 005b EB5A     		jmp	.L113
 1659              	.L114:
 649:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 650:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 651:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mbedtls_mpi_get_bit( &ctx->E, 0 ) == 0 ||
 1660              		.loc 1 651 9
 1661 005d 488B45E8 		movq	-24(%rbp), %rax
 1662 0061 4883C028 		addq	$40, %rax
 1663 0065 BE000000 		movl	$0, %esi
 1663      00
 1664 006a 4889C7   		movq	%rax, %rdi
 1665 006d E8000000 		call	mbedtls_mpi_get_bit@PLT
 1665      00
 1666              		.loc 1 651 7
 1667 0072 85C0     		testl	%eax, %eax
 1668 0074 7435     		je	.L115
 652:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_bitlen( &ctx->E )     < 2  ||
 1669              		.loc 1 652 9 discriminator 1
 1670 0076 488B45E8 		movq	-24(%rbp), %rax
 1671 007a 4883C028 		addq	$40, %rax
 1672 007e 4889C7   		movq	%rax, %rdi
 1673 0081 E8000000 		call	mbedtls_mpi_bitlen@PLT
 1673      00
 651:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_bitlen( &ctx->E )     < 2  ||
 1674              		.loc 1 651 48 discriminator 1
 1675 0086 4883F801 		cmpq	$1, %rax
 1676 008a 761F     		jbe	.L115
GAS LISTING /tmp/cc6OITWc.s 			page 47


 653:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_mpi( &ctx->E, &ctx->N ) >= 0 )
 1677              		.loc 1 653 9
 1678 008c 488B45E8 		movq	-24(%rbp), %rax
 1679 0090 488D5010 		leaq	16(%rax), %rdx
 1680 0094 488B45E8 		movq	-24(%rbp), %rax
 1681 0098 4883C028 		addq	$40, %rax
 1682 009c 4889D6   		movq	%rdx, %rsi
 1683 009f 4889C7   		movq	%rax, %rdi
 1684 00a2 E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 1684      00
 652:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_bitlen( &ctx->E )     < 2  ||
 1685              		.loc 1 652 48
 1686 00a7 85C0     		testl	%eax, %eax
 1687 00a9 7807     		js	.L116
 1688              	.L115:
 654:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 655:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_KEY_CHECK_FAILED );
 1689              		.loc 1 655 15
 1690 00ab B800BEFF 		movl	$-16896, %eax
 1690      FF
 1691 00b0 EB05     		jmp	.L113
 1692              	.L116:
 656:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 657:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 658:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( 0 );
 1693              		.loc 1 658 11
 1694 00b2 B8000000 		movl	$0, %eax
 1694      00
 1695              	.L113:
 659:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 1696              		.loc 1 659 1
 1697 00b7 488B4DF8 		movq	-8(%rbp), %rcx
 1698 00bb 6448330C 		xorq	%fs:40, %rcx
 1698      25280000 
 1698      00
 1699 00c4 7405     		je	.L117
 1700 00c6 E8000000 		call	__stack_chk_fail@PLT
 1700      00
 1701              	.L117:
 1702 00cb C9       		leave
 1703              	.LCFI35:
 1704              		.cfi_def_cfa 7, 8
 1705 00cc C3       		ret
 1706              		.cfi_endproc
 1707              	.LFE27:
 1709              		.section	.text.mbedtls_rsa_check_privkey,"ax",@progbits
 1710              		.globl	mbedtls_rsa_check_privkey
 1712              	mbedtls_rsa_check_privkey:
 1713              	.LFB28:
 660:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 661:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
 662:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Check for the consistency of all fields in an RSA private key context
 663:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
 664:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_check_privkey( const mbedtls_rsa_context *ctx )
 665:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 1714              		.loc 1 665 1
 1715              		.cfi_startproc
GAS LISTING /tmp/cc6OITWc.s 			page 48


 1716 0000 F30F1EFA 		endbr64
 1717 0004 55       		pushq	%rbp
 1718              	.LCFI36:
 1719              		.cfi_def_cfa_offset 16
 1720              		.cfi_offset 6, -16
 1721 0005 4889E5   		movq	%rsp, %rbp
 1722              	.LCFI37:
 1723              		.cfi_def_cfa_register 6
 1724 0008 4883EC20 		subq	$32, %rsp
 1725 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1726              		.loc 1 665 1
 1727 0010 64488B04 		movq	%fs:40, %rax
 1727      25280000 
 1727      00
 1728 0019 488945F8 		movq	%rax, -8(%rbp)
 1729 001d 31C0     		xorl	%eax, %eax
 666:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
 667:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 668:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mbedtls_rsa_check_pubkey( ctx ) != 0 ||
 1730              		.loc 1 668 9
 1731 001f 488B45E8 		movq	-24(%rbp), %rax
 1732 0023 4889C7   		movq	%rax, %rdi
 1733 0026 E8000000 		call	mbedtls_rsa_check_pubkey
 1733      00
 1734              		.loc 1 668 7
 1735 002b 85C0     		testl	%eax, %eax
 1736 002d 751A     		jne	.L119
 669:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         rsa_check_context( ctx, 1 /* private */, 1 /* blinding */ ) != 0 )
 1737              		.loc 1 669 9 discriminator 1
 1738 002f 488B45E8 		movq	-24(%rbp), %rax
 1739 0033 BA010000 		movl	$1, %edx
 1739      00
 1740 0038 BE010000 		movl	$1, %esi
 1740      00
 1741 003d 4889C7   		movq	%rax, %rdi
 1742 0040 E8000000 		call	rsa_check_context
 1742      00
 668:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         rsa_check_context( ctx, 1 /* private */, 1 /* blinding */ ) != 0 )
 1743              		.loc 1 668 46 discriminator 1
 1744 0045 85C0     		testl	%eax, %eax
 1745 0047 740A     		je	.L120
 1746              	.L119:
 670:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 671:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_KEY_CHECK_FAILED );
 1747              		.loc 1 671 15
 1748 0049 B800BEFF 		movl	$-16896, %eax
 1748      FF
 1749 004e E9A50000 		jmp	.L121
 1749      00
 1750              	.L120:
 672:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 673:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 674:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mbedtls_rsa_validate_params( &ctx->N, &ctx->P, &ctx->Q,
 1751              		.loc 1 674 9
 1752 0053 488B45E8 		movq	-24(%rbp), %rax
 1753 0057 488D7828 		leaq	40(%rax), %rdi
 1754 005b 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/cc6OITWc.s 			page 49


 1755 005f 488D4840 		leaq	64(%rax), %rcx
 1756 0063 488B45E8 		movq	-24(%rbp), %rax
 1757 0067 488D5070 		leaq	112(%rax), %rdx
 1758 006b 488B45E8 		movq	-24(%rbp), %rax
 1759 006f 488D7058 		leaq	88(%rax), %rsi
 1760 0073 488B45E8 		movq	-24(%rbp), %rax
 1761 0077 4883C010 		addq	$16, %rax
 1762 007b 4883EC08 		subq	$8, %rsp
 1763 007f 6A00     		pushq	$0
 1764 0081 41B90000 		movl	$0, %r9d
 1764      0000
 1765 0087 4989F8   		movq	%rdi, %r8
 1766 008a 4889C7   		movq	%rax, %rdi
 1767 008d E8000000 		call	mbedtls_rsa_validate_params@PLT
 1767      00
 1768 0092 4883C410 		addq	$16, %rsp
 1769              		.loc 1 674 7
 1770 0096 85C0     		testl	%eax, %eax
 1771 0098 7407     		je	.L122
 675:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                      &ctx->D, &ctx->E, NULL, NULL ) != 0 )
 676:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 677:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_KEY_CHECK_FAILED );
 1772              		.loc 1 677 15
 1773 009a B800BEFF 		movl	$-16896, %eax
 1773      FF
 1774 009f EB57     		jmp	.L121
 1775              	.L122:
 678:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 679:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 680:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if !defined(MBEDTLS_RSA_NO_CRT)
 681:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     else if( mbedtls_rsa_validate_crt( &ctx->P, &ctx->Q, &ctx->D,
 1776              		.loc 1 681 14
 1777 00a1 488B45E8 		movq	-24(%rbp), %rax
 1778 00a5 4C8D80B8 		leaq	184(%rax), %r8
 1778      000000
 1779 00ac 488B45E8 		movq	-24(%rbp), %rax
 1780 00b0 488DB8A0 		leaq	160(%rax), %rdi
 1780      000000
 1781 00b7 488B45E8 		movq	-24(%rbp), %rax
 1782 00bb 488D8888 		leaq	136(%rax), %rcx
 1782      000000
 1783 00c2 488B45E8 		movq	-24(%rbp), %rax
 1784 00c6 488D5040 		leaq	64(%rax), %rdx
 1785 00ca 488B45E8 		movq	-24(%rbp), %rax
 1786 00ce 488D7070 		leaq	112(%rax), %rsi
 1787 00d2 488B45E8 		movq	-24(%rbp), %rax
 1788 00d6 4883C058 		addq	$88, %rax
 1789 00da 4D89C1   		movq	%r8, %r9
 1790 00dd 4989F8   		movq	%rdi, %r8
 1791 00e0 4889C7   		movq	%rax, %rdi
 1792 00e3 E8000000 		call	mbedtls_rsa_validate_crt@PLT
 1792      00
 1793              		.loc 1 681 12
 1794 00e8 85C0     		testl	%eax, %eax
 1795 00ea 7407     		je	.L123
 682:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                        &ctx->DP, &ctx->DQ, &ctx->QP ) != 0 )
 683:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
GAS LISTING /tmp/cc6OITWc.s 			page 50


 684:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_KEY_CHECK_FAILED );
 1796              		.loc 1 684 15
 1797 00ec B800BEFF 		movl	$-16896, %eax
 1797      FF
 1798 00f1 EB05     		jmp	.L121
 1799              	.L123:
 685:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 686:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
 687:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 688:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( 0 );
 1800              		.loc 1 688 11
 1801 00f3 B8000000 		movl	$0, %eax
 1801      00
 1802              	.L121:
 689:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 1803              		.loc 1 689 1
 1804 00f8 488B4DF8 		movq	-8(%rbp), %rcx
 1805 00fc 6448330C 		xorq	%fs:40, %rcx
 1805      25280000 
 1805      00
 1806 0105 7405     		je	.L124
 1807 0107 E8000000 		call	__stack_chk_fail@PLT
 1807      00
 1808              	.L124:
 1809 010c C9       		leave
 1810              	.LCFI38:
 1811              		.cfi_def_cfa 7, 8
 1812 010d C3       		ret
 1813              		.cfi_endproc
 1814              	.LFE28:
 1816              		.section	.text.mbedtls_rsa_check_pub_priv,"ax",@progbits
 1817              		.globl	mbedtls_rsa_check_pub_priv
 1819              	mbedtls_rsa_check_pub_priv:
 1820              	.LFB29:
 690:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 691:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
 692:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Check if contexts holding a public and private key match
 693:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
 694:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_check_pub_priv( const mbedtls_rsa_context *pub,
 695:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                 const mbedtls_rsa_context *prv )
 696:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 1821              		.loc 1 696 1
 1822              		.cfi_startproc
 1823 0000 F30F1EFA 		endbr64
 1824 0004 55       		pushq	%rbp
 1825              	.LCFI39:
 1826              		.cfi_def_cfa_offset 16
 1827              		.cfi_offset 6, -16
 1828 0005 4889E5   		movq	%rsp, %rbp
 1829              	.LCFI40:
 1830              		.cfi_def_cfa_register 6
 1831 0008 4883EC20 		subq	$32, %rsp
 1832 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1833 0010 488975E0 		movq	%rsi, -32(%rbp)
 1834              		.loc 1 696 1
 1835 0014 64488B04 		movq	%fs:40, %rax
 1835      25280000 
GAS LISTING /tmp/cc6OITWc.s 			page 51


 1835      00
 1836 001d 488945F8 		movq	%rax, -8(%rbp)
 1837 0021 31C0     		xorl	%eax, %eax
 697:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( pub != NULL );
 698:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( prv != NULL );
 699:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 700:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mbedtls_rsa_check_pubkey( pub )  != 0 ||
 1838              		.loc 1 700 9
 1839 0023 488B45E8 		movq	-24(%rbp), %rax
 1840 0027 4889C7   		movq	%rax, %rdi
 1841 002a E8000000 		call	mbedtls_rsa_check_pubkey
 1841      00
 1842              		.loc 1 700 7
 1843 002f 85C0     		testl	%eax, %eax
 1844 0031 7510     		jne	.L126
 701:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_rsa_check_privkey( prv ) != 0 )
 1845              		.loc 1 701 9 discriminator 1
 1846 0033 488B45E0 		movq	-32(%rbp), %rax
 1847 0037 4889C7   		movq	%rax, %rdi
 1848 003a E8000000 		call	mbedtls_rsa_check_privkey
 1848      00
 700:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_rsa_check_privkey( prv ) != 0 )
 1849              		.loc 1 700 47 discriminator 1
 1850 003f 85C0     		testl	%eax, %eax
 1851 0041 7407     		je	.L127
 1852              	.L126:
 702:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 703:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_KEY_CHECK_FAILED );
 1853              		.loc 1 703 15
 1854 0043 B800BEFF 		movl	$-16896, %eax
 1854      FF
 1855 0048 EB4A     		jmp	.L128
 1856              	.L127:
 704:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 705:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 706:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mbedtls_mpi_cmp_mpi( &pub->N, &prv->N ) != 0 ||
 1857              		.loc 1 706 9
 1858 004a 488B45E0 		movq	-32(%rbp), %rax
 1859 004e 488D5010 		leaq	16(%rax), %rdx
 1860 0052 488B45E8 		movq	-24(%rbp), %rax
 1861 0056 4883C010 		addq	$16, %rax
 1862 005a 4889D6   		movq	%rdx, %rsi
 1863 005d 4889C7   		movq	%rax, %rdi
 1864 0060 E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 1864      00
 1865              		.loc 1 706 7
 1866 0065 85C0     		testl	%eax, %eax
 1867 0067 751F     		jne	.L129
 707:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_mpi( &pub->E, &prv->E ) != 0 )
 1868              		.loc 1 707 9 discriminator 1
 1869 0069 488B45E0 		movq	-32(%rbp), %rax
 1870 006d 488D5028 		leaq	40(%rax), %rdx
 1871 0071 488B45E8 		movq	-24(%rbp), %rax
 1872 0075 4883C028 		addq	$40, %rax
 1873 0079 4889D6   		movq	%rdx, %rsi
 1874 007c 4889C7   		movq	%rax, %rdi
 1875 007f E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
GAS LISTING /tmp/cc6OITWc.s 			page 52


 1875      00
 706:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_cmp_mpi( &pub->E, &prv->E ) != 0 )
 1876              		.loc 1 706 54 discriminator 1
 1877 0084 85C0     		testl	%eax, %eax
 1878 0086 7407     		je	.L130
 1879              	.L129:
 708:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 709:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_KEY_CHECK_FAILED );
 1880              		.loc 1 709 15
 1881 0088 B800BEFF 		movl	$-16896, %eax
 1881      FF
 1882 008d EB05     		jmp	.L128
 1883              	.L130:
 710:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 711:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 712:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( 0 );
 1884              		.loc 1 712 11
 1885 008f B8000000 		movl	$0, %eax
 1885      00
 1886              	.L128:
 713:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 1887              		.loc 1 713 1
 1888 0094 488B4DF8 		movq	-8(%rbp), %rcx
 1889 0098 6448330C 		xorq	%fs:40, %rcx
 1889      25280000 
 1889      00
 1890 00a1 7405     		je	.L131
 1891 00a3 E8000000 		call	__stack_chk_fail@PLT
 1891      00
 1892              	.L131:
 1893 00a8 C9       		leave
 1894              	.LCFI41:
 1895              		.cfi_def_cfa 7, 8
 1896 00a9 C3       		ret
 1897              		.cfi_endproc
 1898              	.LFE29:
 1900              		.section	.text.mbedtls_rsa_public,"ax",@progbits
 1901              		.globl	mbedtls_rsa_public
 1903              	mbedtls_rsa_public:
 1904              	.LFB30:
 714:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 715:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
 716:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Do an RSA public key operation
 717:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
 718:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_public( mbedtls_rsa_context *ctx,
 719:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                 const unsigned char *input,
 720:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                 unsigned char *output )
 721:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 1905              		.loc 1 721 1
 1906              		.cfi_startproc
 1907 0000 F30F1EFA 		endbr64
 1908 0004 55       		pushq	%rbp
 1909              	.LCFI42:
 1910              		.cfi_def_cfa_offset 16
 1911              		.cfi_offset 6, -16
 1912 0005 4889E5   		movq	%rsp, %rbp
 1913              	.LCFI43:
GAS LISTING /tmp/cc6OITWc.s 			page 53


 1914              		.cfi_def_cfa_register 6
 1915 0008 4883EC50 		subq	$80, %rsp
 1916 000c 48897DC8 		movq	%rdi, -56(%rbp)
 1917 0010 488975C0 		movq	%rsi, -64(%rbp)
 1918 0014 488955B8 		movq	%rdx, -72(%rbp)
 1919              		.loc 1 721 1
 1920 0018 64488B04 		movq	%fs:40, %rax
 1920      25280000 
 1920      00
 1921 0021 488945F8 		movq	%rax, -8(%rbp)
 1922 0025 31C0     		xorl	%eax, %eax
 722:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int ret;
 723:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     size_t olen;
 724:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi T;
 725:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
 726:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( input != NULL );
 727:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( output != NULL );
 728:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 729:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( rsa_check_context( ctx, 0 /* public */, 0 /* no blinding */ ) )
 1923              		.loc 1 729 9
 1924 0027 488B45C8 		movq	-56(%rbp), %rax
 1925 002b BA000000 		movl	$0, %edx
 1925      00
 1926 0030 BE000000 		movl	$0, %esi
 1926      00
 1927 0035 4889C7   		movq	%rax, %rdi
 1928 0038 E8000000 		call	rsa_check_context
 1928      00
 1929              		.loc 1 729 7
 1930 003d 85C0     		testl	%eax, %eax
 1931 003f 740A     		je	.L133
 730:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 1932              		.loc 1 730 15
 1933 0041 B880BFFF 		movl	$-16512, %eax
 1933      FF
 1934 0046 E9E00000 		jmp	.L140
 1934      00
 1935              	.L133:
 731:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 732:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_init( &T );
 1936              		.loc 1 732 5
 1937 004b 488D45E0 		leaq	-32(%rbp), %rax
 1938 004f 4889C7   		movq	%rax, %rdi
 1939 0052 E8000000 		call	mbedtls_mpi_init@PLT
 1939      00
 733:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 734:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_THREADING_C)
 735:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = mbedtls_mutex_lock( &ctx->mutex ) ) != 0 )
 736:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( ret );
 737:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
 738:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 739:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_read_binary( &T, input, ctx->len ) );
 1940              		.loc 1 739 5
 1941 0057 488B45C8 		movq	-56(%rbp), %rax
 1942 005b 488B5008 		movq	8(%rax), %rdx
 1943 005f 488B4DC0 		movq	-64(%rbp), %rcx
 1944 0063 488D45E0 		leaq	-32(%rbp), %rax
GAS LISTING /tmp/cc6OITWc.s 			page 54


 1945 0067 4889CE   		movq	%rcx, %rsi
 1946 006a 4889C7   		movq	%rax, %rdi
 1947 006d E8000000 		call	mbedtls_mpi_read_binary@PLT
 1947      00
 1948 0072 8945D4   		movl	%eax, -44(%rbp)
 1949 0075 837DD400 		cmpl	$0, -44(%rbp)
 1950 0079 0F858700 		jne	.L142
 1950      0000
 740:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 741:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mbedtls_mpi_cmp_mpi( &T, &ctx->N ) >= 0 )
 1951              		.loc 1 741 34
 1952 007f 488B45C8 		movq	-56(%rbp), %rax
 1953 0083 488D5010 		leaq	16(%rax), %rdx
 1954              		.loc 1 741 9
 1955 0087 488D45E0 		leaq	-32(%rbp), %rax
 1956 008b 4889D6   		movq	%rdx, %rsi
 1957 008e 4889C7   		movq	%rax, %rdi
 1958 0091 E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 1958      00
 1959              		.loc 1 741 7
 1960 0096 85C0     		testl	%eax, %eax
 1961 0098 7809     		js	.L137
 742:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 743:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ret = MBEDTLS_ERR_MPI_BAD_INPUT_DATA;
 1962              		.loc 1 743 13
 1963 009a C745D4FC 		movl	$-4, -44(%rbp)
 1963      FFFFFF
 744:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto cleanup;
 1964              		.loc 1 744 9
 1965 00a1 EB67     		jmp	.L136
 1966              	.L137:
 745:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 746:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 747:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     olen = ctx->len;
 1967              		.loc 1 747 10
 1968 00a3 488B45C8 		movq	-56(%rbp), %rax
 1969 00a7 488B4008 		movq	8(%rax), %rax
 1970 00ab 488945D8 		movq	%rax, -40(%rbp)
 748:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_exp_mod( &T, &T, &ctx->E, &ctx->N, &ctx->RN ) );
 1971              		.loc 1 748 5
 1972 00af 488B45C8 		movq	-56(%rbp), %rax
 1973 00b3 488DB8D0 		leaq	208(%rax), %rdi
 1973      000000
 1974 00ba 488B45C8 		movq	-56(%rbp), %rax
 1975 00be 488D4810 		leaq	16(%rax), %rcx
 1976 00c2 488B45C8 		movq	-56(%rbp), %rax
 1977 00c6 488D5028 		leaq	40(%rax), %rdx
 1978 00ca 488D75E0 		leaq	-32(%rbp), %rsi
 1979 00ce 488D45E0 		leaq	-32(%rbp), %rax
 1980 00d2 4989F8   		movq	%rdi, %r8
 1981 00d5 4889C7   		movq	%rax, %rdi
 1982 00d8 E8000000 		call	mbedtls_mpi_exp_mod@PLT
 1982      00
 1983 00dd 8945D4   		movl	%eax, -44(%rbp)
 1984 00e0 837DD400 		cmpl	$0, -44(%rbp)
 1985 00e4 7523     		jne	.L143
 749:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_write_binary( &T, output, olen ) );
GAS LISTING /tmp/cc6OITWc.s 			page 55


 1986              		.loc 1 749 5
 1987 00e6 488B55D8 		movq	-40(%rbp), %rdx
 1988 00ea 488B4DB8 		movq	-72(%rbp), %rcx
 1989 00ee 488D45E0 		leaq	-32(%rbp), %rax
 1990 00f2 4889CE   		movq	%rcx, %rsi
 1991 00f5 4889C7   		movq	%rax, %rdi
 1992 00f8 E8000000 		call	mbedtls_mpi_write_binary@PLT
 1992      00
 1993 00fd 8945D4   		movl	%eax, -44(%rbp)
 1994 0100 837DD400 		cmpl	$0, -44(%rbp)
 750:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 751:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** cleanup:
 1995              		.loc 1 751 1
 1996 0104 EB04     		jmp	.L136
 1997              	.L142:
 739:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 1998              		.loc 1 739 5
 1999 0106 90       		nop
 2000 0107 EB01     		jmp	.L136
 2001              	.L143:
 748:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_write_binary( &T, output, olen ) );
 2002              		.loc 1 748 5
 2003 0109 90       		nop
 2004              	.L136:
 752:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_THREADING_C)
 753:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mbedtls_mutex_unlock( &ctx->mutex ) != 0 )
 754:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_THREADING_MUTEX_ERROR );
 755:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
 756:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 757:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &T );
 2005              		.loc 1 757 5
 2006 010a 488D45E0 		leaq	-32(%rbp), %rax
 2007 010e 4889C7   		movq	%rax, %rdi
 2008 0111 E8000000 		call	mbedtls_mpi_free@PLT
 2008      00
 758:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 759:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ret != 0 )
 2009              		.loc 1 759 7
 2010 0116 837DD400 		cmpl	$0, -44(%rbp)
 2011 011a 740A     		je	.L139
 760:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_PUBLIC_FAILED + ret );
 2012              		.loc 1 760 47
 2013 011c 8B45D4   		movl	-44(%rbp), %eax
 2014 011f 2D804200 		subl	$17024, %eax
 2014      00
 2015 0124 EB05     		jmp	.L140
 2016              	.L139:
 761:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 762:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( 0 );
 2017              		.loc 1 762 11
 2018 0126 B8000000 		movl	$0, %eax
 2018      00
 2019              	.L140:
 763:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 2020              		.loc 1 763 1 discriminator 1
 2021 012b 488B4DF8 		movq	-8(%rbp), %rcx
 2022 012f 6448330C 		xorq	%fs:40, %rcx
GAS LISTING /tmp/cc6OITWc.s 			page 56


 2022      25280000 
 2022      00
 2023 0138 7405     		je	.L141
 2024              		.loc 1 763 1 is_stmt 0
 2025 013a E8000000 		call	__stack_chk_fail@PLT
 2025      00
 2026              	.L141:
 2027 013f C9       		leave
 2028              	.LCFI44:
 2029              		.cfi_def_cfa 7, 8
 2030 0140 C3       		ret
 2031              		.cfi_endproc
 2032              	.LFE30:
 2034              		.section	.text.rsa_prepare_blinding,"ax",@progbits
 2036              	rsa_prepare_blinding:
 2037              	.LFB31:
 764:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 765:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
 766:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Generate or update blinding values, see section 10 of:
 767:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *  KOCHER, Paul C. Timing attacks on implementations of Diffie-Hellman, RSA,
 768:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *  DSS, and other systems. In : Advances in Cryptology-CRYPTO'96. Springer
 769:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *  Berlin Heidelberg, 1996. p. 104-113.
 770:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
 771:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** static int rsa_prepare_blinding( mbedtls_rsa_context *ctx,
 772:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                  int (*f_rng)(void *, unsigned char *, size_t), void *p_rng )
 773:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 2038              		.loc 1 773 1 is_stmt 1
 2039              		.cfi_startproc
 2040 0000 F30F1EFA 		endbr64
 2041 0004 55       		pushq	%rbp
 2042              	.LCFI45:
 2043              		.cfi_def_cfa_offset 16
 2044              		.cfi_offset 6, -16
 2045 0005 4889E5   		movq	%rsp, %rbp
 2046              	.LCFI46:
 2047              		.cfi_def_cfa_register 6
 2048 0008 4883EC30 		subq	$48, %rsp
 2049 000c 48897DE8 		movq	%rdi, -24(%rbp)
 2050 0010 488975E0 		movq	%rsi, -32(%rbp)
 2051 0014 488955D8 		movq	%rdx, -40(%rbp)
 2052              		.loc 1 773 1
 2053 0018 64488B04 		movq	%fs:40, %rax
 2053      25280000 
 2053      00
 2054 0021 488945F8 		movq	%rax, -8(%rbp)
 2055 0025 31C0     		xorl	%eax, %eax
 774:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int ret, count = 0;
 2056              		.loc 1 774 14
 2057 0027 C745F400 		movl	$0, -12(%rbp)
 2057      000000
 775:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 776:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ctx->Vf.p != NULL )
 2058              		.loc 1 776 16
 2059 002e 488B45E8 		movq	-24(%rbp), %rax
 2060 0032 488B8040 		movq	320(%rax), %rax
 2060      010000
 2061              		.loc 1 776 7
GAS LISTING /tmp/cc6OITWc.s 			page 57


 2062 0039 4885C0   		testq	%rax, %rax
 2063 003c 0F84D900 		je	.L145
 2063      0000
 777:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 778:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /* We already have blinding values, just update them by squaring */
 779:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &ctx->Vi, &ctx->Vi, &ctx->Vi ) );
 2064              		.loc 1 779 9
 2065 0042 488B45E8 		movq	-24(%rbp), %rax
 2066 0046 488D9018 		leaq	280(%rax), %rdx
 2066      010000
 2067 004d 488B45E8 		movq	-24(%rbp), %rax
 2068 0051 488D8818 		leaq	280(%rax), %rcx
 2068      010000
 2069 0058 488B45E8 		movq	-24(%rbp), %rax
 2070 005c 48051801 		addq	$280, %rax
 2070      0000
 2071 0062 4889CE   		movq	%rcx, %rsi
 2072 0065 4889C7   		movq	%rax, %rdi
 2073 0068 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 2073      00
 2074 006d 8945F0   		movl	%eax, -16(%rbp)
 2075 0070 837DF000 		cmpl	$0, -16(%rbp)
 2076 0074 0F85B901 		jne	.L157
 2076      0000
 780:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mod_mpi( &ctx->Vi, &ctx->Vi, &ctx->N ) );
 2077              		.loc 1 780 9
 2078 007a 488B45E8 		movq	-24(%rbp), %rax
 2079 007e 488D5010 		leaq	16(%rax), %rdx
 2080 0082 488B45E8 		movq	-24(%rbp), %rax
 2081 0086 488D8818 		leaq	280(%rax), %rcx
 2081      010000
 2082 008d 488B45E8 		movq	-24(%rbp), %rax
 2083 0091 48051801 		addq	$280, %rax
 2083      0000
 2084 0097 4889CE   		movq	%rcx, %rsi
 2085 009a 4889C7   		movq	%rax, %rdi
 2086 009d E8000000 		call	mbedtls_mpi_mod_mpi@PLT
 2086      00
 2087 00a2 8945F0   		movl	%eax, -16(%rbp)
 2088 00a5 837DF000 		cmpl	$0, -16(%rbp)
 2089 00a9 0F858701 		jne	.L158
 2089      0000
 781:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &ctx->Vf, &ctx->Vf, &ctx->Vf ) );
 2090              		.loc 1 781 9
 2091 00af 488B45E8 		movq	-24(%rbp), %rax
 2092 00b3 488D9030 		leaq	304(%rax), %rdx
 2092      010000
 2093 00ba 488B45E8 		movq	-24(%rbp), %rax
 2094 00be 488D8830 		leaq	304(%rax), %rcx
 2094      010000
 2095 00c5 488B45E8 		movq	-24(%rbp), %rax
 2096 00c9 48053001 		addq	$304, %rax
 2096      0000
 2097 00cf 4889CE   		movq	%rcx, %rsi
 2098 00d2 4889C7   		movq	%rax, %rdi
 2099 00d5 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 2099      00
GAS LISTING /tmp/cc6OITWc.s 			page 58


 2100 00da 8945F0   		movl	%eax, -16(%rbp)
 2101 00dd 837DF000 		cmpl	$0, -16(%rbp)
 2102 00e1 0F855201 		jne	.L159
 2102      0000
 782:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mod_mpi( &ctx->Vf, &ctx->Vf, &ctx->N ) );
 2103              		.loc 1 782 9
 2104 00e7 488B45E8 		movq	-24(%rbp), %rax
 2105 00eb 488D5010 		leaq	16(%rax), %rdx
 2106 00ef 488B45E8 		movq	-24(%rbp), %rax
 2107 00f3 488D8830 		leaq	304(%rax), %rcx
 2107      010000
 2108 00fa 488B45E8 		movq	-24(%rbp), %rax
 2109 00fe 48053001 		addq	$304, %rax
 2109      0000
 2110 0104 4889CE   		movq	%rcx, %rsi
 2111 0107 4889C7   		movq	%rax, %rdi
 2112 010a E8000000 		call	mbedtls_mpi_mod_mpi@PLT
 2112      00
 2113 010f 8945F0   		movl	%eax, -16(%rbp)
 2114 0112 837DF000 		cmpl	$0, -16(%rbp)
 783:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 784:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto cleanup;
 2115              		.loc 1 784 9
 2116 0116 E9280100 		jmp	.L147
 2116      00
 2117              	.L145:
 785:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 786:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 787:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Unblinding value: Vf = random number, invertible mod N */
 788:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     do {
 789:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( count++ > 10 )
 2118              		.loc 1 789 18
 2119 011b 8B45F4   		movl	-12(%rbp), %eax
 2120 011e 8D5001   		leal	1(%rax), %edx
 2121 0121 8955F4   		movl	%edx, -12(%rbp)
 2122              		.loc 1 789 11
 2123 0124 83F80A   		cmpl	$10, %eax
 2124 0127 7E0A     		jle	.L151
 790:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return( MBEDTLS_ERR_RSA_RNG_FAILED );
 2125              		.loc 1 790 19
 2126 0129 B880BBFF 		movl	$-17536, %eax
 2126      FF
 2127 012e E9130100 		jmp	.L152
 2127      00
 2128              	.L151:
 791:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 792:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_fill_random( &ctx->Vf, ctx->len - 1, f_rng, p_rng ) );
 2129              		.loc 1 792 9
 2130 0133 488B45E8 		movq	-24(%rbp), %rax
 2131 0137 488B4008 		movq	8(%rax), %rax
 2132 013b 488D70FF 		leaq	-1(%rax), %rsi
 2133 013f 488B45E8 		movq	-24(%rbp), %rax
 2134 0143 488DB830 		leaq	304(%rax), %rdi
 2134      010000
 2135 014a 488B55D8 		movq	-40(%rbp), %rdx
 2136 014e 488B45E0 		movq	-32(%rbp), %rax
 2137 0152 4889D1   		movq	%rdx, %rcx
GAS LISTING /tmp/cc6OITWc.s 			page 59


 2138 0155 4889C2   		movq	%rax, %rdx
 2139 0158 E8000000 		call	mbedtls_mpi_fill_random@PLT
 2139      00
 2140 015d 8945F0   		movl	%eax, -16(%rbp)
 2141 0160 837DF000 		cmpl	$0, -16(%rbp)
 2142 0164 0F85D200 		jne	.L160
 2142      0000
 793:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_gcd( &ctx->Vi, &ctx->Vf, &ctx->N ) );
 2143              		.loc 1 793 9
 2144 016a 488B45E8 		movq	-24(%rbp), %rax
 2145 016e 488D5010 		leaq	16(%rax), %rdx
 2146 0172 488B45E8 		movq	-24(%rbp), %rax
 2147 0176 488D8830 		leaq	304(%rax), %rcx
 2147      010000
 2148 017d 488B45E8 		movq	-24(%rbp), %rax
 2149 0181 48051801 		addq	$280, %rax
 2149      0000
 2150 0187 4889CE   		movq	%rcx, %rsi
 2151 018a 4889C7   		movq	%rax, %rdi
 2152 018d E8000000 		call	mbedtls_mpi_gcd@PLT
 2152      00
 2153 0192 8945F0   		movl	%eax, -16(%rbp)
 2154 0195 837DF000 		cmpl	$0, -16(%rbp)
 2155 0199 0F85A000 		jne	.L161
 2155      0000
 794:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     } while( mbedtls_mpi_cmp_int( &ctx->Vi, 1 ) != 0 );
 2156              		.loc 1 794 35
 2157 019f 488B45E8 		movq	-24(%rbp), %rax
 2158 01a3 48051801 		addq	$280, %rax
 2158      0000
 2159              		.loc 1 794 14
 2160 01a9 BE010000 		movl	$1, %esi
 2160      00
 2161 01ae 4889C7   		movq	%rax, %rdi
 2162 01b1 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 2162      00
 2163              		.loc 1 794 5
 2164 01b6 85C0     		testl	%eax, %eax
 2165 01b8 0F855DFF 		jne	.L145
 2165      FFFF
 795:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 796:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Blinding value: Vi =  Vf^(-e) mod N */
 797:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_inv_mod( &ctx->Vi, &ctx->Vf, &ctx->N ) );
 2166              		.loc 1 797 5
 2167 01be 488B45E8 		movq	-24(%rbp), %rax
 2168 01c2 488D5010 		leaq	16(%rax), %rdx
 2169 01c6 488B45E8 		movq	-24(%rbp), %rax
 2170 01ca 488D8830 		leaq	304(%rax), %rcx
 2170      010000
 2171 01d1 488B45E8 		movq	-24(%rbp), %rax
 2172 01d5 48051801 		addq	$280, %rax
 2172      0000
 2173 01db 4889CE   		movq	%rcx, %rsi
 2174 01de 4889C7   		movq	%rax, %rdi
 2175 01e1 E8000000 		call	mbedtls_mpi_inv_mod@PLT
 2175      00
 2176 01e6 8945F0   		movl	%eax, -16(%rbp)
GAS LISTING /tmp/cc6OITWc.s 			page 60


 2177 01e9 837DF000 		cmpl	$0, -16(%rbp)
 2178 01ed 7553     		jne	.L162
 798:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_exp_mod( &ctx->Vi, &ctx->Vi, &ctx->E, &ctx->N, &ctx->RN ) );
 2179              		.loc 1 798 5
 2180 01ef 488B45E8 		movq	-24(%rbp), %rax
 2181 01f3 488DB8D0 		leaq	208(%rax), %rdi
 2181      000000
 2182 01fa 488B45E8 		movq	-24(%rbp), %rax
 2183 01fe 488D4810 		leaq	16(%rax), %rcx
 2184 0202 488B45E8 		movq	-24(%rbp), %rax
 2185 0206 488D5028 		leaq	40(%rax), %rdx
 2186 020a 488B45E8 		movq	-24(%rbp), %rax
 2187 020e 488DB018 		leaq	280(%rax), %rsi
 2187      010000
 2188 0215 488B45E8 		movq	-24(%rbp), %rax
 2189 0219 48051801 		addq	$280, %rax
 2189      0000
 2190 021f 4989F8   		movq	%rdi, %r8
 2191 0222 4889C7   		movq	%rax, %rdi
 2192 0225 E8000000 		call	mbedtls_mpi_exp_mod@PLT
 2192      00
 2193 022a 8945F0   		movl	%eax, -16(%rbp)
 2194 022d 837DF000 		cmpl	$0, -16(%rbp)
 799:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 800:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 801:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** cleanup:
 2195              		.loc 1 801 1
 2196 0231 EB10     		jmp	.L147
 2197              	.L157:
 779:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mod_mpi( &ctx->Vi, &ctx->Vi, &ctx->N ) );
 2198              		.loc 1 779 9
 2199 0233 90       		nop
 2200 0234 EB0D     		jmp	.L147
 2201              	.L158:
 780:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &ctx->Vf, &ctx->Vf, &ctx->Vf ) );
 2202              		.loc 1 780 9
 2203 0236 90       		nop
 2204 0237 EB0A     		jmp	.L147
 2205              	.L159:
 781:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mod_mpi( &ctx->Vf, &ctx->Vf, &ctx->N ) );
 2206              		.loc 1 781 9
 2207 0239 90       		nop
 2208 023a EB07     		jmp	.L147
 2209              	.L160:
 792:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_gcd( &ctx->Vi, &ctx->Vf, &ctx->N ) );
 2210              		.loc 1 792 9
 2211 023c 90       		nop
 2212 023d EB04     		jmp	.L147
 2213              	.L161:
 793:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     } while( mbedtls_mpi_cmp_int( &ctx->Vi, 1 ) != 0 );
 2214              		.loc 1 793 9
 2215 023f 90       		nop
 2216 0240 EB01     		jmp	.L147
 2217              	.L162:
 797:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_exp_mod( &ctx->Vi, &ctx->Vi, &ctx->E, &ctx->N, &ctx->RN ) );
 2218              		.loc 1 797 5
 2219 0242 90       		nop
GAS LISTING /tmp/cc6OITWc.s 			page 61


 2220              	.L147:
 802:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( ret );
 2221              		.loc 1 802 11
 2222 0243 8B45F0   		movl	-16(%rbp), %eax
 2223              	.L152:
 803:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 2224              		.loc 1 803 1
 2225 0246 488B75F8 		movq	-8(%rbp), %rsi
 2226 024a 64483334 		xorq	%fs:40, %rsi
 2226      25280000 
 2226      00
 2227 0253 7405     		je	.L156
 2228 0255 E8000000 		call	__stack_chk_fail@PLT
 2228      00
 2229              	.L156:
 2230 025a C9       		leave
 2231              	.LCFI47:
 2232              		.cfi_def_cfa 7, 8
 2233 025b C3       		ret
 2234              		.cfi_endproc
 2235              	.LFE31:
 2237              		.section	.text.mbedtls_rsa_private,"ax",@progbits
 2238              		.globl	mbedtls_rsa_private
 2240              	mbedtls_rsa_private:
 2241              	.LFB32:
 804:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 805:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
 806:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Exponent blinding supposed to prevent side-channel attacks using multiple
 807:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * traces of measurements to recover the RSA key. The more collisions are there,
 808:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * the more bits of the key can be recovered. See [3].
 809:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
 810:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Collecting n collisions with m bit long blinding value requires 2^(m-m/n)
 811:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * observations on avarage.
 812:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
 813:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * For example with 28 byte blinding to achieve 2 collisions the adversary has
 814:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * to make 2^112 observations on avarage.
 815:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
 816:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * (With the currently (as of 2017 April) known best algorithms breaking 2048
 817:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * bit RSA requires approximately as much time as trying out 2^112 random keys.
 818:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Thus in this sense with 28 byte blinding the security is not reduced by
 819:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * side-channel attacks like the one in [3])
 820:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
 821:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * This countermeasure does not help if the key recovery is possible with a
 822:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * single trace.
 823:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
 824:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #define RSA_EXPONENT_BLINDING 28
 825:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 826:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
 827:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Do an RSA private key operation
 828:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
 829:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_private( mbedtls_rsa_context *ctx,
 830:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                  int (*f_rng)(void *, unsigned char *, size_t),
 831:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                  void *p_rng,
 832:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                  const unsigned char *input,
 833:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                  unsigned char *output )
 834:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 2242              		.loc 1 834 1
GAS LISTING /tmp/cc6OITWc.s 			page 62


 2243              		.cfi_startproc
 2244 0000 F30F1EFA 		endbr64
 2245 0004 55       		pushq	%rbp
 2246              	.LCFI48:
 2247              		.cfi_def_cfa_offset 16
 2248              		.cfi_offset 6, -16
 2249 0005 4889E5   		movq	%rsp, %rbp
 2250              	.LCFI49:
 2251              		.cfi_def_cfa_register 6
 2252 0008 4881EC90 		subq	$400, %rsp
 2252      010000
 2253 000f 4889BD98 		movq	%rdi, -360(%rbp)
 2253      FEFFFF
 2254 0016 4889B590 		movq	%rsi, -368(%rbp)
 2254      FEFFFF
 2255 001d 48899588 		movq	%rdx, -376(%rbp)
 2255      FEFFFF
 2256 0024 48898D80 		movq	%rcx, -384(%rbp)
 2256      FEFFFF
 2257 002b 4C898578 		movq	%r8, -392(%rbp)
 2257      FEFFFF
 2258              		.loc 1 834 1
 2259 0032 64488B04 		movq	%fs:40, %rax
 2259      25280000 
 2259      00
 2260 003b 488945F8 		movq	%rax, -8(%rbp)
 2261 003f 31C0     		xorl	%eax, %eax
 835:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int ret;
 836:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     size_t olen;
 837:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 838:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Temporary holding the result */
 839:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi T;
 840:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 841:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Temporaries holding P-1, Q-1 and the
 842:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * exponent blinding factor, respectively. */
 843:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi P1, Q1, R;
 844:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 845:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if !defined(MBEDTLS_RSA_NO_CRT)
 846:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Temporaries holding the results mod p resp. mod q. */
 847:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi TP, TQ;
 848:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 849:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Temporaries holding the blinded exponents for
 850:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * the mod p resp. mod q computation (if used). */
 851:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi DP_blind, DQ_blind;
 852:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 853:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Pointers to actual exponents to be used - either the unblinded
 854:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * or the blinded ones, depending on the presence of a PRNG. */
 855:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi *DP = &ctx->DP;
 2262              		.loc 1 855 18
 2263 0041 488B8598 		movq	-360(%rbp), %rax
 2263      FEFFFF
 2264 0048 48058800 		addq	$136, %rax
 2264      0000
 2265 004e 488985A8 		movq	%rax, -344(%rbp)
 2265      FEFFFF
 856:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi *DQ = &ctx->DQ;
 2266              		.loc 1 856 18
GAS LISTING /tmp/cc6OITWc.s 			page 63


 2267 0055 488B8598 		movq	-360(%rbp), %rax
 2267      FEFFFF
 2268 005c 4805A000 		addq	$160, %rax
 2268      0000
 2269 0062 488985B0 		movq	%rax, -336(%rbp)
 2269      FEFFFF
 857:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #else
 858:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Temporary holding the blinded exponent (if used). */
 859:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi D_blind;
 860:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 861:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Pointer to actual exponent to be used - either the unblinded
 862:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * or the blinded one, depending on the presence of a PRNG. */
 863:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi *D = &ctx->D;
 864:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif /* MBEDTLS_RSA_NO_CRT */
 865:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 866:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Temporaries holding the initial input and the double
 867:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * checked result; should be the same in the end. */
 868:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi I, C;
 869:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 870:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
 871:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( input  != NULL );
 872:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( output != NULL );
 873:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 874:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( rsa_check_context( ctx, 1             /* private key checks */,
 2270              		.loc 1 874 9
 2271 0069 4883BD90 		cmpq	$0, -368(%rbp)
 2271      FEFFFF00 
 2272 0071 0F95C0   		setne	%al
 2273 0074 0FB6D0   		movzbl	%al, %edx
 2274 0077 488B8598 		movq	-360(%rbp), %rax
 2274      FEFFFF
 2275 007e BE010000 		movl	$1, %esi
 2275      00
 2276 0083 4889C7   		movq	%rax, %rdi
 2277 0086 E8000000 		call	rsa_check_context
 2277      00
 2278              		.loc 1 874 7
 2279 008b 85C0     		testl	%eax, %eax
 2280 008d 740A     		je	.L164
 875:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                 f_rng != NULL /* blinding y/n       */ ) != 0 )
 876:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 877:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 2281              		.loc 1 877 15
 2282 008f B880BFFF 		movl	$-16512, %eax
 2282      FF
 2283 0094 E94F0700 		jmp	.L196
 2283      00
 2284              	.L164:
 878:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 879:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 880:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_THREADING_C)
 881:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = mbedtls_mutex_lock( &ctx->mutex ) ) != 0 )
 882:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( ret );
 883:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
 884:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 885:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* MPI Initialization */
 886:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_init( &T );
GAS LISTING /tmp/cc6OITWc.s 			page 64


 2285              		.loc 1 886 5
 2286 0099 488D85C0 		leaq	-320(%rbp), %rax
 2286      FEFFFF
 2287 00a0 4889C7   		movq	%rax, %rdi
 2288 00a3 E8000000 		call	mbedtls_mpi_init@PLT
 2288      00
 887:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 888:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_init( &P1 );
 2289              		.loc 1 888 5
 2290 00a8 488D85E0 		leaq	-288(%rbp), %rax
 2290      FEFFFF
 2291 00af 4889C7   		movq	%rax, %rdi
 2292 00b2 E8000000 		call	mbedtls_mpi_init@PLT
 2292      00
 889:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_init( &Q1 );
 2293              		.loc 1 889 5
 2294 00b7 488D8500 		leaq	-256(%rbp), %rax
 2294      FFFFFF
 2295 00be 4889C7   		movq	%rax, %rdi
 2296 00c1 E8000000 		call	mbedtls_mpi_init@PLT
 2296      00
 890:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_init( &R );
 2297              		.loc 1 890 5
 2298 00c6 488D8520 		leaq	-224(%rbp), %rax
 2298      FFFFFF
 2299 00cd 4889C7   		movq	%rax, %rdi
 2300 00d0 E8000000 		call	mbedtls_mpi_init@PLT
 2300      00
 891:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 892:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( f_rng != NULL )
 2301              		.loc 1 892 7
 2302 00d5 4883BD90 		cmpq	$0, -368(%rbp)
 2302      FEFFFF00 
 2303 00dd 7418     		je	.L166
 893:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 894:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_RSA_NO_CRT)
 895:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_init( &D_blind );
 896:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #else
 897:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_init( &DP_blind );
 2304              		.loc 1 897 9
 2305 00df 488D4580 		leaq	-128(%rbp), %rax
 2306 00e3 4889C7   		movq	%rax, %rdi
 2307 00e6 E8000000 		call	mbedtls_mpi_init@PLT
 2307      00
 898:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_init( &DQ_blind );
 2308              		.loc 1 898 9
 2309 00eb 488D45A0 		leaq	-96(%rbp), %rax
 2310 00ef 4889C7   		movq	%rax, %rdi
 2311 00f2 E8000000 		call	mbedtls_mpi_init@PLT
 2311      00
 2312              	.L166:
 899:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
 900:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 901:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 902:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if !defined(MBEDTLS_RSA_NO_CRT)
 903:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_init( &TP ); mbedtls_mpi_init( &TQ );
 2313              		.loc 1 903 5
GAS LISTING /tmp/cc6OITWc.s 			page 65


 2314 00f7 488D8540 		leaq	-192(%rbp), %rax
 2314      FFFFFF
 2315 00fe 4889C7   		movq	%rax, %rdi
 2316 0101 E8000000 		call	mbedtls_mpi_init@PLT
 2316      00
 2317              		.loc 1 903 30
 2318 0106 488D8560 		leaq	-160(%rbp), %rax
 2318      FFFFFF
 2319 010d 4889C7   		movq	%rax, %rdi
 2320 0110 E8000000 		call	mbedtls_mpi_init@PLT
 2320      00
 904:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
 905:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 906:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_init( &I );
 2321              		.loc 1 906 5
 2322 0115 488D45C0 		leaq	-64(%rbp), %rax
 2323 0119 4889C7   		movq	%rax, %rdi
 2324 011c E8000000 		call	mbedtls_mpi_init@PLT
 2324      00
 907:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_init( &C );
 2325              		.loc 1 907 5
 2326 0121 488D45E0 		leaq	-32(%rbp), %rax
 2327 0125 4889C7   		movq	%rax, %rdi
 2328 0128 E8000000 		call	mbedtls_mpi_init@PLT
 2328      00
 908:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 909:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* End of MPI initialization */
 910:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 911:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_read_binary( &T, input, ctx->len ) );
 2329              		.loc 1 911 5
 2330 012d 488B8598 		movq	-360(%rbp), %rax
 2330      FEFFFF
 2331 0134 488B5008 		movq	8(%rax), %rdx
 2332 0138 488B8D80 		movq	-384(%rbp), %rcx
 2332      FEFFFF
 2333 013f 488D85C0 		leaq	-320(%rbp), %rax
 2333      FEFFFF
 2334 0146 4889CE   		movq	%rcx, %rsi
 2335 0149 4889C7   		movq	%rax, %rdi
 2336 014c E8000000 		call	mbedtls_mpi_read_binary@PLT
 2336      00
 2337 0151 8985A4FE 		movl	%eax, -348(%rbp)
 2337      FFFF
 2338 0157 83BDA4FE 		cmpl	$0, -348(%rbp)
 2338      FFFF00
 2339 015e 0F859205 		jne	.L198
 2339      0000
 912:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mbedtls_mpi_cmp_mpi( &T, &ctx->N ) >= 0 )
 2340              		.loc 1 912 34
 2341 0164 488B8598 		movq	-360(%rbp), %rax
 2341      FEFFFF
 2342 016b 488D5010 		leaq	16(%rax), %rdx
 2343              		.loc 1 912 9
 2344 016f 488D85C0 		leaq	-320(%rbp), %rax
 2344      FEFFFF
 2345 0176 4889D6   		movq	%rdx, %rsi
 2346 0179 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/cc6OITWc.s 			page 66


 2347 017c E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 2347      00
 2348              		.loc 1 912 7
 2349 0181 85C0     		testl	%eax, %eax
 2350 0183 780F     		js	.L169
 913:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 914:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ret = MBEDTLS_ERR_MPI_BAD_INPUT_DATA;
 2351              		.loc 1 914 13
 2352 0185 C785A4FE 		movl	$-4, -348(%rbp)
 2352      FFFFFCFF 
 2352      FFFF
 915:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto cleanup;
 2353              		.loc 1 915 9
 2354 018f E9A50500 		jmp	.L168
 2354      00
 2355              	.L169:
 916:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 917:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 918:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &I, &T ) );
 2356              		.loc 1 918 5
 2357 0194 488D95C0 		leaq	-320(%rbp), %rdx
 2357      FEFFFF
 2358 019b 488D45C0 		leaq	-64(%rbp), %rax
 2359 019f 4889D6   		movq	%rdx, %rsi
 2360 01a2 4889C7   		movq	%rax, %rdi
 2361 01a5 E8000000 		call	mbedtls_mpi_copy@PLT
 2361      00
 2362 01aa 8985A4FE 		movl	%eax, -348(%rbp)
 2362      FFFF
 2363 01b0 83BDA4FE 		cmpl	$0, -348(%rbp)
 2363      FFFF00
 2364 01b7 0F853C05 		jne	.L199
 2364      0000
 919:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 920:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( f_rng != NULL )
 2365              		.loc 1 920 7
 2366 01bd 4883BD90 		cmpq	$0, -368(%rbp)
 2366      FEFFFF00 
 2367 01c5 0F845602 		je	.L171
 2367      0000
 921:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 922:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /*
 923:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          * Blinding
 924:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          * T = T * Vi mod N
 925:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          */
 926:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( rsa_prepare_blinding( ctx, f_rng, p_rng ) );
 2368              		.loc 1 926 9
 2369 01cb 488B9588 		movq	-376(%rbp), %rdx
 2369      FEFFFF
 2370 01d2 488B8D90 		movq	-368(%rbp), %rcx
 2370      FEFFFF
 2371 01d9 488B8598 		movq	-360(%rbp), %rax
 2371      FEFFFF
 2372 01e0 4889CE   		movq	%rcx, %rsi
 2373 01e3 4889C7   		movq	%rax, %rdi
 2374 01e6 E8000000 		call	rsa_prepare_blinding
 2374      00
GAS LISTING /tmp/cc6OITWc.s 			page 67


 2375 01eb 8985A4FE 		movl	%eax, -348(%rbp)
 2375      FFFF
 2376 01f1 83BDA4FE 		cmpl	$0, -348(%rbp)
 2376      FFFF00
 2377 01f8 0F85FE04 		jne	.L200
 2377      0000
 927:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T, &T, &ctx->Vi ) );
 2378              		.loc 1 927 9
 2379 01fe 488B8598 		movq	-360(%rbp), %rax
 2379      FEFFFF
 2380 0205 488D9018 		leaq	280(%rax), %rdx
 2380      010000
 2381 020c 488D8DC0 		leaq	-320(%rbp), %rcx
 2381      FEFFFF
 2382 0213 488D85C0 		leaq	-320(%rbp), %rax
 2382      FEFFFF
 2383 021a 4889CE   		movq	%rcx, %rsi
 2384 021d 4889C7   		movq	%rax, %rdi
 2385 0220 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 2385      00
 2386 0225 8985A4FE 		movl	%eax, -348(%rbp)
 2386      FFFF
 2387 022b 83BDA4FE 		cmpl	$0, -348(%rbp)
 2387      FFFF00
 2388 0232 0F85C704 		jne	.L201
 2388      0000
 928:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mod_mpi( &T, &T, &ctx->N ) );
 2389              		.loc 1 928 9
 2390 0238 488B8598 		movq	-360(%rbp), %rax
 2390      FEFFFF
 2391 023f 488D5010 		leaq	16(%rax), %rdx
 2392 0243 488D8DC0 		leaq	-320(%rbp), %rcx
 2392      FEFFFF
 2393 024a 488D85C0 		leaq	-320(%rbp), %rax
 2393      FEFFFF
 2394 0251 4889CE   		movq	%rcx, %rsi
 2395 0254 4889C7   		movq	%rax, %rdi
 2396 0257 E8000000 		call	mbedtls_mpi_mod_mpi@PLT
 2396      00
 2397 025c 8985A4FE 		movl	%eax, -348(%rbp)
 2397      FFFF
 2398 0262 83BDA4FE 		cmpl	$0, -348(%rbp)
 2398      FFFF00
 2399 0269 0F859304 		jne	.L202
 2399      0000
 929:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 930:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /*
 931:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          * Exponent blinding
 932:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          */
 933:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_sub_int( &P1, &ctx->P, 1 ) );
 2400              		.loc 1 933 9
 2401 026f 488B8598 		movq	-360(%rbp), %rax
 2401      FEFFFF
 2402 0276 488D4858 		leaq	88(%rax), %rcx
 2403 027a 488D85E0 		leaq	-288(%rbp), %rax
 2403      FEFFFF
 2404 0281 BA010000 		movl	$1, %edx
GAS LISTING /tmp/cc6OITWc.s 			page 68


 2404      00
 2405 0286 4889CE   		movq	%rcx, %rsi
 2406 0289 4889C7   		movq	%rax, %rdi
 2407 028c E8000000 		call	mbedtls_mpi_sub_int@PLT
 2407      00
 2408 0291 8985A4FE 		movl	%eax, -348(%rbp)
 2408      FFFF
 2409 0297 83BDA4FE 		cmpl	$0, -348(%rbp)
 2409      FFFF00
 2410 029e 0F856104 		jne	.L203
 2410      0000
 934:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_sub_int( &Q1, &ctx->Q, 1 ) );
 2411              		.loc 1 934 9
 2412 02a4 488B8598 		movq	-360(%rbp), %rax
 2412      FEFFFF
 2413 02ab 488D4870 		leaq	112(%rax), %rcx
 2414 02af 488D8500 		leaq	-256(%rbp), %rax
 2414      FFFFFF
 2415 02b6 BA010000 		movl	$1, %edx
 2415      00
 2416 02bb 4889CE   		movq	%rcx, %rsi
 2417 02be 4889C7   		movq	%rax, %rdi
 2418 02c1 E8000000 		call	mbedtls_mpi_sub_int@PLT
 2418      00
 2419 02c6 8985A4FE 		movl	%eax, -348(%rbp)
 2419      FFFF
 2420 02cc 83BDA4FE 		cmpl	$0, -348(%rbp)
 2420      FFFF00
 2421 02d3 0F852F04 		jne	.L204
 2421      0000
 935:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 936:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_RSA_NO_CRT)
 937:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /*
 938:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          * D_blind = ( P - 1 ) * ( Q - 1 ) * R + D
 939:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          */
 940:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_fill_random( &R, RSA_EXPONENT_BLINDING,
 941:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                          f_rng, p_rng ) );
 942:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &D_blind, &P1, &Q1 ) );
 943:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &D_blind, &D_blind, &R ) );
 944:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( &D_blind, &D_blind, &ctx->D ) );
 945:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 946:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         D = &D_blind;
 947:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #else
 948:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /*
 949:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          * DP_blind = ( P - 1 ) * R + DP
 950:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          */
 951:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_fill_random( &R, RSA_EXPONENT_BLINDING,
 2422              		.loc 1 951 9
 2423 02d9 488B8D88 		movq	-376(%rbp), %rcx
 2423      FEFFFF
 2424 02e0 488B9590 		movq	-368(%rbp), %rdx
 2424      FEFFFF
 2425 02e7 488D8520 		leaq	-224(%rbp), %rax
 2425      FFFFFF
 2426 02ee BE1C0000 		movl	$28, %esi
 2426      00
 2427 02f3 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/cc6OITWc.s 			page 69


 2428 02f6 E8000000 		call	mbedtls_mpi_fill_random@PLT
 2428      00
 2429 02fb 8985A4FE 		movl	%eax, -348(%rbp)
 2429      FFFF
 2430 0301 83BDA4FE 		cmpl	$0, -348(%rbp)
 2430      FFFF00
 2431 0308 0F85FD03 		jne	.L205
 2431      0000
 952:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                          f_rng, p_rng ) );
 953:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &DP_blind, &P1, &R ) );
 2432              		.loc 1 953 9
 2433 030e 488D9520 		leaq	-224(%rbp), %rdx
 2433      FFFFFF
 2434 0315 488D8DE0 		leaq	-288(%rbp), %rcx
 2434      FEFFFF
 2435 031c 488D4580 		leaq	-128(%rbp), %rax
 2436 0320 4889CE   		movq	%rcx, %rsi
 2437 0323 4889C7   		movq	%rax, %rdi
 2438 0326 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 2438      00
 2439 032b 8985A4FE 		movl	%eax, -348(%rbp)
 2439      FFFF
 2440 0331 83BDA4FE 		cmpl	$0, -348(%rbp)
 2440      FFFF00
 2441 0338 0F85D003 		jne	.L206
 2441      0000
 954:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( &DP_blind, &DP_blind,
 2442              		.loc 1 954 9
 2443 033e 488B8598 		movq	-360(%rbp), %rax
 2443      FEFFFF
 2444 0345 488D9088 		leaq	136(%rax), %rdx
 2444      000000
 2445 034c 488D4D80 		leaq	-128(%rbp), %rcx
 2446 0350 488D4580 		leaq	-128(%rbp), %rax
 2447 0354 4889CE   		movq	%rcx, %rsi
 2448 0357 4889C7   		movq	%rax, %rdi
 2449 035a E8000000 		call	mbedtls_mpi_add_mpi@PLT
 2449      00
 2450 035f 8985A4FE 		movl	%eax, -348(%rbp)
 2450      FFFF
 2451 0365 83BDA4FE 		cmpl	$0, -348(%rbp)
 2451      FFFF00
 2452 036c 0F859F03 		jne	.L207
 2452      0000
 955:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                     &ctx->DP ) );
 956:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 957:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         DP = &DP_blind;
 2453              		.loc 1 957 12
 2454 0372 488D4580 		leaq	-128(%rbp), %rax
 2455 0376 488985A8 		movq	%rax, -344(%rbp)
 2455      FEFFFF
 958:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 959:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /*
 960:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          * DQ_blind = ( Q - 1 ) * R + DQ
 961:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          */
 962:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_fill_random( &R, RSA_EXPONENT_BLINDING,
 2456              		.loc 1 962 9
GAS LISTING /tmp/cc6OITWc.s 			page 70


 2457 037d 488B8D88 		movq	-376(%rbp), %rcx
 2457      FEFFFF
 2458 0384 488B9590 		movq	-368(%rbp), %rdx
 2458      FEFFFF
 2459 038b 488D8520 		leaq	-224(%rbp), %rax
 2459      FFFFFF
 2460 0392 BE1C0000 		movl	$28, %esi
 2460      00
 2461 0397 4889C7   		movq	%rax, %rdi
 2462 039a E8000000 		call	mbedtls_mpi_fill_random@PLT
 2462      00
 2463 039f 8985A4FE 		movl	%eax, -348(%rbp)
 2463      FFFF
 2464 03a5 83BDA4FE 		cmpl	$0, -348(%rbp)
 2464      FFFF00
 2465 03ac 0F856203 		jne	.L208
 2465      0000
 963:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                          f_rng, p_rng ) );
 964:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &DQ_blind, &Q1, &R ) );
 2466              		.loc 1 964 9
 2467 03b2 488D9520 		leaq	-224(%rbp), %rdx
 2467      FFFFFF
 2468 03b9 488D8D00 		leaq	-256(%rbp), %rcx
 2468      FFFFFF
 2469 03c0 488D45A0 		leaq	-96(%rbp), %rax
 2470 03c4 4889CE   		movq	%rcx, %rsi
 2471 03c7 4889C7   		movq	%rax, %rdi
 2472 03ca E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 2472      00
 2473 03cf 8985A4FE 		movl	%eax, -348(%rbp)
 2473      FFFF
 2474 03d5 83BDA4FE 		cmpl	$0, -348(%rbp)
 2474      FFFF00
 2475 03dc 0F853503 		jne	.L209
 2475      0000
 965:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( &DQ_blind, &DQ_blind,
 2476              		.loc 1 965 9
 2477 03e2 488B8598 		movq	-360(%rbp), %rax
 2477      FEFFFF
 2478 03e9 488D90A0 		leaq	160(%rax), %rdx
 2478      000000
 2479 03f0 488D4DA0 		leaq	-96(%rbp), %rcx
 2480 03f4 488D45A0 		leaq	-96(%rbp), %rax
 2481 03f8 4889CE   		movq	%rcx, %rsi
 2482 03fb 4889C7   		movq	%rax, %rdi
 2483 03fe E8000000 		call	mbedtls_mpi_add_mpi@PLT
 2483      00
 2484 0403 8985A4FE 		movl	%eax, -348(%rbp)
 2484      FFFF
 2485 0409 83BDA4FE 		cmpl	$0, -348(%rbp)
 2485      FFFF00
 2486 0410 0F850403 		jne	.L210
 2486      0000
 966:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                     &ctx->DQ ) );
 967:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 968:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         DQ = &DQ_blind;
 2487              		.loc 1 968 12
GAS LISTING /tmp/cc6OITWc.s 			page 71


 2488 0416 488D45A0 		leaq	-96(%rbp), %rax
 2489 041a 488985B0 		movq	%rax, -336(%rbp)
 2489      FEFFFF
 2490              	.L171:
 969:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif /* MBEDTLS_RSA_NO_CRT */
 970:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 971:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 972:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_RSA_NO_CRT)
 973:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_exp_mod( &T, &T, D, &ctx->N, &ctx->RN ) );
 974:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #else
 975:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
 976:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * Faster decryption using the CRT
 977:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      *
 978:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * TP = input ^ dP mod P
 979:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * TQ = input ^ dQ mod Q
 980:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
 981:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 982:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_exp_mod( &TP, &T, DP, &ctx->P, &ctx->RP ) );
 2491              		.loc 1 982 5
 2492 0421 488B8598 		movq	-360(%rbp), %rax
 2492      FEFFFF
 2493 0428 488DB8E8 		leaq	232(%rax), %rdi
 2493      000000
 2494 042f 488B8598 		movq	-360(%rbp), %rax
 2494      FEFFFF
 2495 0436 488D4858 		leaq	88(%rax), %rcx
 2496 043a 488B95A8 		movq	-344(%rbp), %rdx
 2496      FEFFFF
 2497 0441 488DB5C0 		leaq	-320(%rbp), %rsi
 2497      FEFFFF
 2498 0448 488D8540 		leaq	-192(%rbp), %rax
 2498      FFFFFF
 2499 044f 4989F8   		movq	%rdi, %r8
 2500 0452 4889C7   		movq	%rax, %rdi
 2501 0455 E8000000 		call	mbedtls_mpi_exp_mod@PLT
 2501      00
 2502 045a 8985A4FE 		movl	%eax, -348(%rbp)
 2502      FFFF
 2503 0460 83BDA4FE 		cmpl	$0, -348(%rbp)
 2503      FFFF00
 2504 0467 0F85B002 		jne	.L211
 2504      0000
 983:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_exp_mod( &TQ, &T, DQ, &ctx->Q, &ctx->RQ ) );
 2505              		.loc 1 983 5
 2506 046d 488B8598 		movq	-360(%rbp), %rax
 2506      FEFFFF
 2507 0474 488DB800 		leaq	256(%rax), %rdi
 2507      010000
 2508 047b 488B8598 		movq	-360(%rbp), %rax
 2508      FEFFFF
 2509 0482 488D4870 		leaq	112(%rax), %rcx
 2510 0486 488B95B0 		movq	-336(%rbp), %rdx
 2510      FEFFFF
 2511 048d 488DB5C0 		leaq	-320(%rbp), %rsi
 2511      FEFFFF
 2512 0494 488D8560 		leaq	-160(%rbp), %rax
 2512      FFFFFF
GAS LISTING /tmp/cc6OITWc.s 			page 72


 2513 049b 4989F8   		movq	%rdi, %r8
 2514 049e 4889C7   		movq	%rax, %rdi
 2515 04a1 E8000000 		call	mbedtls_mpi_exp_mod@PLT
 2515      00
 2516 04a6 8985A4FE 		movl	%eax, -348(%rbp)
 2516      FFFF
 2517 04ac 83BDA4FE 		cmpl	$0, -348(%rbp)
 2517      FFFF00
 2518 04b3 0F856702 		jne	.L212
 2518      0000
 984:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 985:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
 986:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * T = (TP - TQ) * (Q^-1 mod P) mod P
 987:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
 988:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &T, &TP, &TQ ) );
 2519              		.loc 1 988 5
 2520 04b9 488D9560 		leaq	-160(%rbp), %rdx
 2520      FFFFFF
 2521 04c0 488D8D40 		leaq	-192(%rbp), %rcx
 2521      FFFFFF
 2522 04c7 488D85C0 		leaq	-320(%rbp), %rax
 2522      FEFFFF
 2523 04ce 4889CE   		movq	%rcx, %rsi
 2524 04d1 4889C7   		movq	%rax, %rdi
 2525 04d4 E8000000 		call	mbedtls_mpi_sub_mpi@PLT
 2525      00
 2526 04d9 8985A4FE 		movl	%eax, -348(%rbp)
 2526      FFFF
 2527 04df 83BDA4FE 		cmpl	$0, -348(%rbp)
 2527      FFFF00
 2528 04e6 0F853702 		jne	.L213
 2528      0000
 989:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &TP, &T, &ctx->QP ) );
 2529              		.loc 1 989 5
 2530 04ec 488B8598 		movq	-360(%rbp), %rax
 2530      FEFFFF
 2531 04f3 488D90B8 		leaq	184(%rax), %rdx
 2531      000000
 2532 04fa 488D8DC0 		leaq	-320(%rbp), %rcx
 2532      FEFFFF
 2533 0501 488D8540 		leaq	-192(%rbp), %rax
 2533      FFFFFF
 2534 0508 4889CE   		movq	%rcx, %rsi
 2535 050b 4889C7   		movq	%rax, %rdi
 2536 050e E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 2536      00
 2537 0513 8985A4FE 		movl	%eax, -348(%rbp)
 2537      FFFF
 2538 0519 83BDA4FE 		cmpl	$0, -348(%rbp)
 2538      FFFF00
 2539 0520 0F850002 		jne	.L214
 2539      0000
 990:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mod_mpi( &T, &TP, &ctx->P ) );
 2540              		.loc 1 990 5
 2541 0526 488B8598 		movq	-360(%rbp), %rax
 2541      FEFFFF
 2542 052d 488D5058 		leaq	88(%rax), %rdx
GAS LISTING /tmp/cc6OITWc.s 			page 73


 2543 0531 488D8D40 		leaq	-192(%rbp), %rcx
 2543      FFFFFF
 2544 0538 488D85C0 		leaq	-320(%rbp), %rax
 2544      FEFFFF
 2545 053f 4889CE   		movq	%rcx, %rsi
 2546 0542 4889C7   		movq	%rax, %rdi
 2547 0545 E8000000 		call	mbedtls_mpi_mod_mpi@PLT
 2547      00
 2548 054a 8985A4FE 		movl	%eax, -348(%rbp)
 2548      FFFF
 2549 0550 83BDA4FE 		cmpl	$0, -348(%rbp)
 2549      FFFF00
 2550 0557 0F85CC01 		jne	.L215
 2550      0000
 991:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 992:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
 993:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * T = TQ + T * Q
 994:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
 995:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &TP, &T, &ctx->Q ) );
 2551              		.loc 1 995 5
 2552 055d 488B8598 		movq	-360(%rbp), %rax
 2552      FEFFFF
 2553 0564 488D5070 		leaq	112(%rax), %rdx
 2554 0568 488D8DC0 		leaq	-320(%rbp), %rcx
 2554      FEFFFF
 2555 056f 488D8540 		leaq	-192(%rbp), %rax
 2555      FFFFFF
 2556 0576 4889CE   		movq	%rcx, %rsi
 2557 0579 4889C7   		movq	%rax, %rdi
 2558 057c E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 2558      00
 2559 0581 8985A4FE 		movl	%eax, -348(%rbp)
 2559      FFFF
 2560 0587 83BDA4FE 		cmpl	$0, -348(%rbp)
 2560      FFFF00
 2561 058e 0F859801 		jne	.L216
 2561      0000
 996:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( &T, &TQ, &TP ) );
 2562              		.loc 1 996 5
 2563 0594 488D9540 		leaq	-192(%rbp), %rdx
 2563      FFFFFF
 2564 059b 488D8D60 		leaq	-160(%rbp), %rcx
 2564      FFFFFF
 2565 05a2 488D85C0 		leaq	-320(%rbp), %rax
 2565      FEFFFF
 2566 05a9 4889CE   		movq	%rcx, %rsi
 2567 05ac 4889C7   		movq	%rax, %rdi
 2568 05af E8000000 		call	mbedtls_mpi_add_mpi@PLT
 2568      00
 2569 05b4 8985A4FE 		movl	%eax, -348(%rbp)
 2569      FFFF
 2570 05ba 83BDA4FE 		cmpl	$0, -348(%rbp)
 2570      FFFF00
 2571 05c1 0F856801 		jne	.L217
 2571      0000
 997:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif /* MBEDTLS_RSA_NO_CRT */
 998:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
GAS LISTING /tmp/cc6OITWc.s 			page 74


 999:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( f_rng != NULL )
 2572              		.loc 1 999 7
 2573 05c7 4883BD90 		cmpq	$0, -368(%rbp)
 2573      FEFFFF00 
 2574 05cf 7471     		je	.L190
1000:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
1001:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /*
1002:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          * Unblind
1003:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          * T = T * Vf mod N
1004:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          */
1005:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T, &T, &ctx->Vf ) );
 2575              		.loc 1 1005 9
 2576 05d1 488B8598 		movq	-360(%rbp), %rax
 2576      FEFFFF
 2577 05d8 488D9030 		leaq	304(%rax), %rdx
 2577      010000
 2578 05df 488D8DC0 		leaq	-320(%rbp), %rcx
 2578      FEFFFF
 2579 05e6 488D85C0 		leaq	-320(%rbp), %rax
 2579      FEFFFF
 2580 05ed 4889CE   		movq	%rcx, %rsi
 2581 05f0 4889C7   		movq	%rax, %rdi
 2582 05f3 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 2582      00
 2583 05f8 8985A4FE 		movl	%eax, -348(%rbp)
 2583      FFFF
 2584 05fe 83BDA4FE 		cmpl	$0, -348(%rbp)
 2584      FFFF00
 2585 0605 0F852701 		jne	.L218
 2585      0000
1006:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mod_mpi( &T, &T, &ctx->N ) );
 2586              		.loc 1 1006 9
 2587 060b 488B8598 		movq	-360(%rbp), %rax
 2587      FEFFFF
 2588 0612 488D5010 		leaq	16(%rax), %rdx
 2589 0616 488D8DC0 		leaq	-320(%rbp), %rcx
 2589      FEFFFF
 2590 061d 488D85C0 		leaq	-320(%rbp), %rax
 2590      FEFFFF
 2591 0624 4889CE   		movq	%rcx, %rsi
 2592 0627 4889C7   		movq	%rax, %rdi
 2593 062a E8000000 		call	mbedtls_mpi_mod_mpi@PLT
 2593      00
 2594 062f 8985A4FE 		movl	%eax, -348(%rbp)
 2594      FFFF
 2595 0635 83BDA4FE 		cmpl	$0, -348(%rbp)
 2595      FFFF00
 2596 063c 0F85F300 		jne	.L219
 2596      0000
 2597              	.L190:
1007:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
1008:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1009:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Verify the result to prevent glitching attacks. */
1010:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_exp_mod( &C, &T, &ctx->E,
 2598              		.loc 1 1010 5
 2599 0642 488B8598 		movq	-360(%rbp), %rax
 2599      FEFFFF
GAS LISTING /tmp/cc6OITWc.s 			page 75


 2600 0649 488DB8D0 		leaq	208(%rax), %rdi
 2600      000000
 2601 0650 488B8598 		movq	-360(%rbp), %rax
 2601      FEFFFF
 2602 0657 488D4810 		leaq	16(%rax), %rcx
 2603 065b 488B8598 		movq	-360(%rbp), %rax
 2603      FEFFFF
 2604 0662 488D5028 		leaq	40(%rax), %rdx
 2605 0666 488DB5C0 		leaq	-320(%rbp), %rsi
 2605      FEFFFF
 2606 066d 488D45E0 		leaq	-32(%rbp), %rax
 2607 0671 4989F8   		movq	%rdi, %r8
 2608 0674 4889C7   		movq	%rax, %rdi
 2609 0677 E8000000 		call	mbedtls_mpi_exp_mod@PLT
 2609      00
 2610 067c 8985A4FE 		movl	%eax, -348(%rbp)
 2610      FFFF
 2611 0682 83BDA4FE 		cmpl	$0, -348(%rbp)
 2611      FFFF00
 2612 0689 0F85A900 		jne	.L220
 2612      0000
1011:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                           &ctx->N, &ctx->RN ) );
1012:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mbedtls_mpi_cmp_mpi( &C, &I ) != 0 )
 2613              		.loc 1 1012 9
 2614 068f 488D55C0 		leaq	-64(%rbp), %rdx
 2615 0693 488D45E0 		leaq	-32(%rbp), %rax
 2616 0697 4889D6   		movq	%rdx, %rsi
 2617 069a 4889C7   		movq	%rax, %rdi
 2618 069d E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 2618      00
 2619              		.loc 1 1012 7
 2620 06a2 85C0     		testl	%eax, %eax
 2621 06a4 740F     		je	.L193
1013:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
1014:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ret = MBEDTLS_ERR_RSA_VERIFY_FAILED;
 2622              		.loc 1 1014 13
 2623 06a6 C785A4FE 		movl	$-17280, -348(%rbp)
 2623      FFFF80BC 
 2623      FFFF
1015:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto cleanup;
 2624              		.loc 1 1015 9
 2625 06b0 E9840000 		jmp	.L168
 2625      00
 2626              	.L193:
1016:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
1017:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1018:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     olen = ctx->len;
 2627              		.loc 1 1018 10
 2628 06b5 488B8598 		movq	-360(%rbp), %rax
 2628      FEFFFF
 2629 06bc 488B4008 		movq	8(%rax), %rax
 2630 06c0 488985B8 		movq	%rax, -328(%rbp)
 2630      FEFFFF
1019:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_write_binary( &T, output, olen ) );
 2631              		.loc 1 1019 5
 2632 06c7 488B95B8 		movq	-328(%rbp), %rdx
 2632      FEFFFF
GAS LISTING /tmp/cc6OITWc.s 			page 76


 2633 06ce 488B8D78 		movq	-392(%rbp), %rcx
 2633      FEFFFF
 2634 06d5 488D85C0 		leaq	-320(%rbp), %rax
 2634      FEFFFF
 2635 06dc 4889CE   		movq	%rcx, %rsi
 2636 06df 4889C7   		movq	%rax, %rdi
 2637 06e2 E8000000 		call	mbedtls_mpi_write_binary@PLT
 2637      00
 2638 06e7 8985A4FE 		movl	%eax, -348(%rbp)
 2638      FFFF
 2639 06ed 83BDA4FE 		cmpl	$0, -348(%rbp)
 2639      FFFF00
1020:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1021:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** cleanup:
 2640              		.loc 1 1021 1
 2641 06f4 EB43     		jmp	.L168
 2642              	.L198:
 911:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mbedtls_mpi_cmp_mpi( &T, &ctx->N ) >= 0 )
 2643              		.loc 1 911 5
 2644 06f6 90       		nop
 2645 06f7 EB40     		jmp	.L168
 2646              	.L199:
 918:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 2647              		.loc 1 918 5
 2648 06f9 90       		nop
 2649 06fa EB3D     		jmp	.L168
 2650              	.L200:
 926:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T, &T, &ctx->Vi ) );
 2651              		.loc 1 926 9
 2652 06fc 90       		nop
 2653 06fd EB3A     		jmp	.L168
 2654              	.L201:
 927:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mod_mpi( &T, &T, &ctx->N ) );
 2655              		.loc 1 927 9
 2656 06ff 90       		nop
 2657 0700 EB37     		jmp	.L168
 2658              	.L202:
 928:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 2659              		.loc 1 928 9
 2660 0702 90       		nop
 2661 0703 EB34     		jmp	.L168
 2662              	.L203:
 933:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_sub_int( &Q1, &ctx->Q, 1 ) );
 2663              		.loc 1 933 9
 2664 0705 90       		nop
 2665 0706 EB31     		jmp	.L168
 2666              	.L204:
 934:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 2667              		.loc 1 934 9
 2668 0708 90       		nop
 2669 0709 EB2E     		jmp	.L168
 2670              	.L205:
 951:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                          f_rng, p_rng ) );
 2671              		.loc 1 951 9
 2672 070b 90       		nop
 2673 070c EB2B     		jmp	.L168
 2674              	.L206:
GAS LISTING /tmp/cc6OITWc.s 			page 77


 953:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( &DP_blind, &DP_blind,
 2675              		.loc 1 953 9
 2676 070e 90       		nop
 2677 070f EB28     		jmp	.L168
 2678              	.L207:
 954:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                     &ctx->DP ) );
 2679              		.loc 1 954 9
 2680 0711 90       		nop
 2681 0712 EB25     		jmp	.L168
 2682              	.L208:
 962:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                          f_rng, p_rng ) );
 2683              		.loc 1 962 9
 2684 0714 90       		nop
 2685 0715 EB22     		jmp	.L168
 2686              	.L209:
 964:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( &DQ_blind, &DQ_blind,
 2687              		.loc 1 964 9
 2688 0717 90       		nop
 2689 0718 EB1F     		jmp	.L168
 2690              	.L210:
 965:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                     &ctx->DQ ) );
 2691              		.loc 1 965 9
 2692 071a 90       		nop
 2693 071b EB1C     		jmp	.L168
 2694              	.L211:
 982:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_exp_mod( &TQ, &T, DQ, &ctx->Q, &ctx->RQ ) );
 2695              		.loc 1 982 5
 2696 071d 90       		nop
 2697 071e EB19     		jmp	.L168
 2698              	.L212:
 983:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 2699              		.loc 1 983 5
 2700 0720 90       		nop
 2701 0721 EB16     		jmp	.L168
 2702              	.L213:
 988:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &TP, &T, &ctx->QP ) );
 2703              		.loc 1 988 5
 2704 0723 90       		nop
 2705 0724 EB13     		jmp	.L168
 2706              	.L214:
 989:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mod_mpi( &T, &TP, &ctx->P ) );
 2707              		.loc 1 989 5
 2708 0726 90       		nop
 2709 0727 EB10     		jmp	.L168
 2710              	.L215:
 990:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 2711              		.loc 1 990 5
 2712 0729 90       		nop
 2713 072a EB0D     		jmp	.L168
 2714              	.L216:
 995:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( &T, &TQ, &TP ) );
 2715              		.loc 1 995 5
 2716 072c 90       		nop
 2717 072d EB0A     		jmp	.L168
 2718              	.L217:
 996:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif /* MBEDTLS_RSA_NO_CRT */
 2719              		.loc 1 996 5
GAS LISTING /tmp/cc6OITWc.s 			page 78


 2720 072f 90       		nop
 2721 0730 EB07     		jmp	.L168
 2722              	.L218:
1005:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mod_mpi( &T, &T, &ctx->N ) );
 2723              		.loc 1 1005 9
 2724 0732 90       		nop
 2725 0733 EB04     		jmp	.L168
 2726              	.L219:
1006:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
 2727              		.loc 1 1006 9
 2728 0735 90       		nop
 2729 0736 EB01     		jmp	.L168
 2730              	.L220:
1010:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                           &ctx->N, &ctx->RN ) );
 2731              		.loc 1 1010 5
 2732 0738 90       		nop
 2733              	.L168:
1022:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_THREADING_C)
1023:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mbedtls_mutex_unlock( &ctx->mutex ) != 0 )
1024:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_THREADING_MUTEX_ERROR );
1025:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
1026:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1027:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &P1 );
 2734              		.loc 1 1027 5
 2735 0739 488D85E0 		leaq	-288(%rbp), %rax
 2735      FEFFFF
 2736 0740 4889C7   		movq	%rax, %rdi
 2737 0743 E8000000 		call	mbedtls_mpi_free@PLT
 2737      00
1028:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &Q1 );
 2738              		.loc 1 1028 5
 2739 0748 488D8500 		leaq	-256(%rbp), %rax
 2739      FFFFFF
 2740 074f 4889C7   		movq	%rax, %rdi
 2741 0752 E8000000 		call	mbedtls_mpi_free@PLT
 2741      00
1029:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &R );
 2742              		.loc 1 1029 5
 2743 0757 488D8520 		leaq	-224(%rbp), %rax
 2743      FFFFFF
 2744 075e 4889C7   		movq	%rax, %rdi
 2745 0761 E8000000 		call	mbedtls_mpi_free@PLT
 2745      00
1030:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1031:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( f_rng != NULL )
 2746              		.loc 1 1031 7
 2747 0766 4883BD90 		cmpq	$0, -368(%rbp)
 2747      FEFFFF00 
 2748 076e 7418     		je	.L194
1032:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
1033:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_RSA_NO_CRT)
1034:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_free( &D_blind );
1035:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #else
1036:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_free( &DP_blind );
 2749              		.loc 1 1036 9
 2750 0770 488D4580 		leaq	-128(%rbp), %rax
 2751 0774 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/cc6OITWc.s 			page 79


 2752 0777 E8000000 		call	mbedtls_mpi_free@PLT
 2752      00
1037:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_mpi_free( &DQ_blind );
 2753              		.loc 1 1037 9
 2754 077c 488D45A0 		leaq	-96(%rbp), %rax
 2755 0780 4889C7   		movq	%rax, %rdi
 2756 0783 E8000000 		call	mbedtls_mpi_free@PLT
 2756      00
 2757              	.L194:
1038:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
1039:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
1040:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1041:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &T );
 2758              		.loc 1 1041 5
 2759 0788 488D85C0 		leaq	-320(%rbp), %rax
 2759      FEFFFF
 2760 078f 4889C7   		movq	%rax, %rdi
 2761 0792 E8000000 		call	mbedtls_mpi_free@PLT
 2761      00
1042:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1043:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if !defined(MBEDTLS_RSA_NO_CRT)
1044:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &TP ); mbedtls_mpi_free( &TQ );
 2762              		.loc 1 1044 5
 2763 0797 488D8540 		leaq	-192(%rbp), %rax
 2763      FFFFFF
 2764 079e 4889C7   		movq	%rax, %rdi
 2765 07a1 E8000000 		call	mbedtls_mpi_free@PLT
 2765      00
 2766              		.loc 1 1044 30
 2767 07a6 488D8560 		leaq	-160(%rbp), %rax
 2767      FFFFFF
 2768 07ad 4889C7   		movq	%rax, %rdi
 2769 07b0 E8000000 		call	mbedtls_mpi_free@PLT
 2769      00
1045:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
1046:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1047:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &C );
 2770              		.loc 1 1047 5
 2771 07b5 488D45E0 		leaq	-32(%rbp), %rax
 2772 07b9 4889C7   		movq	%rax, %rdi
 2773 07bc E8000000 		call	mbedtls_mpi_free@PLT
 2773      00
1048:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &I );
 2774              		.loc 1 1048 5
 2775 07c1 488D45C0 		leaq	-64(%rbp), %rax
 2776 07c5 4889C7   		movq	%rax, %rdi
 2777 07c8 E8000000 		call	mbedtls_mpi_free@PLT
 2777      00
1049:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1050:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ret != 0 )
 2778              		.loc 1 1050 7
 2779 07cd 83BDA4FE 		cmpl	$0, -348(%rbp)
 2779      FFFF00
 2780 07d4 740D     		je	.L195
1051:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_PRIVATE_FAILED + ret );
 2781              		.loc 1 1051 48
 2782 07d6 8B85A4FE 		movl	-348(%rbp), %eax
GAS LISTING /tmp/cc6OITWc.s 			page 80


 2782      FFFF
 2783 07dc 2D004300 		subl	$17152, %eax
 2783      00
 2784 07e1 EB05     		jmp	.L196
 2785              	.L195:
1052:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1053:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( 0 );
 2786              		.loc 1 1053 11
 2787 07e3 B8000000 		movl	$0, %eax
 2787      00
 2788              	.L196:
1054:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 2789              		.loc 1 1054 1 discriminator 1
 2790 07e8 488B75F8 		movq	-8(%rbp), %rsi
 2791 07ec 64483334 		xorq	%fs:40, %rsi
 2791      25280000 
 2791      00
 2792 07f5 7405     		je	.L197
 2793              		.loc 1 1054 1 is_stmt 0
 2794 07f7 E8000000 		call	__stack_chk_fail@PLT
 2794      00
 2795              	.L197:
 2796 07fc C9       		leave
 2797              	.LCFI50:
 2798              		.cfi_def_cfa 7, 8
 2799 07fd C3       		ret
 2800              		.cfi_endproc
 2801              	.LFE32:
 2803              		.section	.text.mgf_mask,"ax",@progbits
 2805              	mgf_mask:
 2806              	.LFB33:
1055:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1056:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_PKCS1_V21)
1057:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /**
1058:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Generate and apply the MGF1 operation (from PKCS#1 v2.1) to a buffer.
1059:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
1060:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * \param dst       buffer to mask
1061:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * \param dlen      length of destination buffer
1062:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * \param src       source of the mask generation
1063:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * \param slen      length of the source buffer
1064:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * \param md_ctx    message digest context to use
1065:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
1066:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** static int mgf_mask( unsigned char *dst, size_t dlen, unsigned char *src,
1067:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       size_t slen, mbedtls_md_context_t *md_ctx )
1068:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 2807              		.loc 1 1068 1 is_stmt 1
 2808              		.cfi_startproc
 2809 0000 F30F1EFA 		endbr64
 2810 0004 55       		pushq	%rbp
 2811              	.LCFI51:
 2812              		.cfi_def_cfa_offset 16
 2813              		.cfi_offset 6, -16
 2814 0005 4889E5   		movq	%rsp, %rbp
 2815              	.LCFI52:
 2816              		.cfi_def_cfa_register 6
 2817 0008 4881EC90 		subq	$144, %rsp
 2817      000000
GAS LISTING /tmp/cc6OITWc.s 			page 81


 2818 000f 48897D98 		movq	%rdi, -104(%rbp)
 2819 0013 48897590 		movq	%rsi, -112(%rbp)
 2820 0017 48895588 		movq	%rdx, -120(%rbp)
 2821 001b 48894D80 		movq	%rcx, -128(%rbp)
 2822 001f 4C898578 		movq	%r8, -136(%rbp)
 2822      FFFFFF
 2823              		.loc 1 1068 1
 2824 0026 64488B04 		movq	%fs:40, %rax
 2824      25280000 
 2824      00
 2825 002f 488945F8 		movq	%rax, -8(%rbp)
 2826 0033 31C0     		xorl	%eax, %eax
1069:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned char mask[MBEDTLS_MD_MAX_SIZE];
1070:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned char counter[4];
1071:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned char *p;
1072:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned int hlen;
1073:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     size_t i, use_len;
1074:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int ret = 0;
 2827              		.loc 1 1074 9
 2828 0035 C745A800 		movl	$0, -88(%rbp)
 2828      000000
1075:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1076:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     memset( mask, 0, MBEDTLS_MD_MAX_SIZE );
 2829              		.loc 1 1076 5
 2830 003c 488D45D0 		leaq	-48(%rbp), %rax
 2831 0040 BA200000 		movl	$32, %edx
 2831      00
 2832 0045 BE000000 		movl	$0, %esi
 2832      00
 2833 004a 4889C7   		movq	%rax, %rdi
 2834 004d E8000000 		call	memset@PLT
 2834      00
1077:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     memset( counter, 0, 4 );
 2835              		.loc 1 1077 5
 2836 0052 488D45CC 		leaq	-52(%rbp), %rax
 2837 0056 BA040000 		movl	$4, %edx
 2837      00
 2838 005b BE000000 		movl	$0, %esi
 2838      00
 2839 0060 4889C7   		movq	%rax, %rdi
 2840 0063 E8000000 		call	memset@PLT
 2840      00
1078:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1079:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     hlen = mbedtls_md_get_size( md_ctx->md_info );
 2841              		.loc 1 1079 12
 2842 0068 488B8578 		movq	-136(%rbp), %rax
 2842      FFFFFF
 2843 006f 488B00   		movq	(%rax), %rax
 2844 0072 4889C7   		movq	%rax, %rdi
 2845 0075 E8000000 		call	mbedtls_md_get_size@PLT
 2845      00
 2846              		.loc 1 1079 10
 2847 007a 0FB6C0   		movzbl	%al, %eax
 2848 007d 8945AC   		movl	%eax, -84(%rbp)
1080:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1081:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Generate and apply dbMask */
1082:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     p = dst;
GAS LISTING /tmp/cc6OITWc.s 			page 82


 2849              		.loc 1 1082 7
 2850 0080 488B4598 		movq	-104(%rbp), %rax
 2851 0084 488945B0 		movq	%rax, -80(%rbp)
1083:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1084:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     while( dlen > 0 )
 2852              		.loc 1 1084 10
 2853 0088 E9EA0000 		jmp	.L222
 2853      00
 2854              	.L231:
1085:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
1086:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         use_len = hlen;
 2855              		.loc 1 1086 17
 2856 008d 8B45AC   		movl	-84(%rbp), %eax
 2857 0090 488945C0 		movq	%rax, -64(%rbp)
1087:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( dlen < hlen )
 2858              		.loc 1 1087 18
 2859 0094 8B45AC   		movl	-84(%rbp), %eax
 2860              		.loc 1 1087 11
 2861 0097 48394590 		cmpq	%rax, -112(%rbp)
 2862 009b 7308     		jnb	.L223
1088:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             use_len = dlen;
 2863              		.loc 1 1088 21
 2864 009d 488B4590 		movq	-112(%rbp), %rax
 2865 00a1 488945C0 		movq	%rax, -64(%rbp)
 2866              	.L223:
1089:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1090:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( ( ret = mbedtls_md_starts( md_ctx ) ) != 0 )
 2867              		.loc 1 1090 21
 2868 00a5 488B8578 		movq	-136(%rbp), %rax
 2868      FFFFFF
 2869 00ac 4889C7   		movq	%rax, %rdi
 2870 00af E8000000 		call	mbedtls_md_starts@PLT
 2870      00
 2871 00b4 8945A8   		movl	%eax, -88(%rbp)
 2872              		.loc 1 1090 11
 2873 00b7 837DA800 		cmpl	$0, -88(%rbp)
 2874 00bb 0F85C300 		jne	.L234
 2874      0000
1091:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             goto exit;
1092:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( ( ret = mbedtls_md_update( md_ctx, src, slen ) ) != 0 )
 2875              		.loc 1 1092 21
 2876 00c1 488B5580 		movq	-128(%rbp), %rdx
 2877 00c5 488B4D88 		movq	-120(%rbp), %rcx
 2878 00c9 488B8578 		movq	-136(%rbp), %rax
 2878      FFFFFF
 2879 00d0 4889CE   		movq	%rcx, %rsi
 2880 00d3 4889C7   		movq	%rax, %rdi
 2881 00d6 E8000000 		call	mbedtls_md_update@PLT
 2881      00
 2882 00db 8945A8   		movl	%eax, -88(%rbp)
 2883              		.loc 1 1092 11
 2884 00de 837DA800 		cmpl	$0, -88(%rbp)
 2885 00e2 0F859F00 		jne	.L235
 2885      0000
1093:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             goto exit;
1094:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( ( ret = mbedtls_md_update( md_ctx, counter, 4 ) ) != 0 )
 2886              		.loc 1 1094 21
GAS LISTING /tmp/cc6OITWc.s 			page 83


 2887 00e8 488D4DCC 		leaq	-52(%rbp), %rcx
 2888 00ec 488B8578 		movq	-136(%rbp), %rax
 2888      FFFFFF
 2889 00f3 BA040000 		movl	$4, %edx
 2889      00
 2890 00f8 4889CE   		movq	%rcx, %rsi
 2891 00fb 4889C7   		movq	%rax, %rdi
 2892 00fe E8000000 		call	mbedtls_md_update@PLT
 2892      00
 2893 0103 8945A8   		movl	%eax, -88(%rbp)
 2894              		.loc 1 1094 11
 2895 0106 837DA800 		cmpl	$0, -88(%rbp)
 2896 010a 757E     		jne	.L236
1095:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             goto exit;
1096:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( ( ret = mbedtls_md_finish( md_ctx, mask ) ) != 0 )
 2897              		.loc 1 1096 21
 2898 010c 488D55D0 		leaq	-48(%rbp), %rdx
 2899 0110 488B8578 		movq	-136(%rbp), %rax
 2899      FFFFFF
 2900 0117 4889D6   		movq	%rdx, %rsi
 2901 011a 4889C7   		movq	%rax, %rdi
 2902 011d E8000000 		call	mbedtls_md_finish@PLT
 2902      00
 2903 0122 8945A8   		movl	%eax, -88(%rbp)
 2904              		.loc 1 1096 11
 2905 0125 837DA800 		cmpl	$0, -88(%rbp)
 2906 0129 7562     		jne	.L237
1097:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             goto exit;
1098:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1099:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         for( i = 0; i < use_len; ++i )
 2907              		.loc 1 1099 16
 2908 012b 48C745B8 		movq	$0, -72(%rbp)
 2908      00000000 
 2909              		.loc 1 1099 9
 2910 0133 EB26     		jmp	.L229
 2911              	.L230:
1100:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             *p++ ^= mask[i];
 2912              		.loc 1 1100 15 discriminator 3
 2913 0135 488B45B0 		movq	-80(%rbp), %rax
 2914 0139 488D5001 		leaq	1(%rax), %rdx
 2915 013d 488955B0 		movq	%rdx, -80(%rbp)
 2916              		.loc 1 1100 18 discriminator 3
 2917 0141 0FB630   		movzbl	(%rax), %esi
 2918              		.loc 1 1100 25 discriminator 3
 2919 0144 488D4DD0 		leaq	-48(%rbp), %rcx
 2920 0148 488B55B8 		movq	-72(%rbp), %rdx
 2921 014c 4801CA   		addq	%rcx, %rdx
 2922 014f 0FB612   		movzbl	(%rdx), %edx
 2923              		.loc 1 1100 18 discriminator 3
 2924 0152 31F2     		xorl	%esi, %edx
 2925 0154 8810     		movb	%dl, (%rax)
1099:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             *p++ ^= mask[i];
 2926              		.loc 1 1099 34 discriminator 3
 2927 0156 488345B8 		addq	$1, -72(%rbp)
 2927      01
 2928              	.L229:
1099:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             *p++ ^= mask[i];
GAS LISTING /tmp/cc6OITWc.s 			page 84


 2929              		.loc 1 1099 9 discriminator 1
 2930 015b 488B45B8 		movq	-72(%rbp), %rax
 2931 015f 483B45C0 		cmpq	-64(%rbp), %rax
 2932 0163 72D0     		jb	.L230
1101:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1102:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         counter[3]++;
 2933              		.loc 1 1102 16
 2934 0165 0FB645CF 		movzbl	-49(%rbp), %eax
 2935              		.loc 1 1102 19
 2936 0169 83C001   		addl	$1, %eax
 2937 016c 8845CF   		movb	%al, -49(%rbp)
1103:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1104:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         dlen -= use_len;
 2938              		.loc 1 1104 14
 2939 016f 488B45C0 		movq	-64(%rbp), %rax
 2940 0173 48294590 		subq	%rax, -112(%rbp)
 2941              	.L222:
1084:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 2942              		.loc 1 1084 10
 2943 0177 48837D90 		cmpq	$0, -112(%rbp)
 2943      00
 2944 017c 0F850BFF 		jne	.L231
 2944      FFFF
1105:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
1106:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1107:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** exit:
 2945              		.loc 1 1107 1
 2946 0182 EB0A     		jmp	.L225
 2947              	.L234:
1091:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( ( ret = mbedtls_md_update( md_ctx, src, slen ) ) != 0 )
 2948              		.loc 1 1091 13
 2949 0184 90       		nop
 2950 0185 EB07     		jmp	.L225
 2951              	.L235:
1093:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( ( ret = mbedtls_md_update( md_ctx, counter, 4 ) ) != 0 )
 2952              		.loc 1 1093 13
 2953 0187 90       		nop
 2954 0188 EB04     		jmp	.L225
 2955              	.L236:
1095:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( ( ret = mbedtls_md_finish( md_ctx, mask ) ) != 0 )
 2956              		.loc 1 1095 13
 2957 018a 90       		nop
 2958 018b EB01     		jmp	.L225
 2959              	.L237:
1097:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 2960              		.loc 1 1097 13
 2961 018d 90       		nop
 2962              	.L225:
1108:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_platform_zeroize( mask, sizeof( mask ) );
 2963              		.loc 1 1108 5
 2964 018e 488D45D0 		leaq	-48(%rbp), %rax
 2965 0192 BE200000 		movl	$32, %esi
 2965      00
 2966 0197 4889C7   		movq	%rax, %rdi
 2967 019a E8000000 		call	mbedtls_platform_zeroize@PLT
 2967      00
1109:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
GAS LISTING /tmp/cc6OITWc.s 			page 85


1110:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( ret );
 2968              		.loc 1 1110 11
 2969 019f 8B45A8   		movl	-88(%rbp), %eax
1111:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 2970              		.loc 1 1111 1
 2971 01a2 488B4DF8 		movq	-8(%rbp), %rcx
 2972 01a6 6448330C 		xorq	%fs:40, %rcx
 2972      25280000 
 2972      00
 2973 01af 7405     		je	.L233
 2974 01b1 E8000000 		call	__stack_chk_fail@PLT
 2974      00
 2975              	.L233:
 2976 01b6 C9       		leave
 2977              	.LCFI53:
 2978              		.cfi_def_cfa 7, 8
 2979 01b7 C3       		ret
 2980              		.cfi_endproc
 2981              	.LFE33:
 2983              		.section	.text.mbedtls_rsa_rsaes_oaep_encrypt,"ax",@progbits
 2984              		.globl	mbedtls_rsa_rsaes_oaep_encrypt
 2986              	mbedtls_rsa_rsaes_oaep_encrypt:
 2987              	.LFB34:
1112:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif /* MBEDTLS_PKCS1_V21 */
1113:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1114:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_PKCS1_V21)
1115:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
1116:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Implementation of the PKCS#1 v2.1 RSAES-OAEP-ENCRYPT function
1117:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
1118:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_rsaes_oaep_encrypt( mbedtls_rsa_context *ctx,
1119:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             int (*f_rng)(void *, unsigned char *, size_t),
1120:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             void *p_rng,
1121:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             int mode,
1122:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             const unsigned char *label, size_t label_len,
1123:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             size_t ilen,
1124:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             const unsigned char *input,
1125:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             unsigned char *output )
1126:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 2988              		.loc 1 1126 1
 2989              		.cfi_startproc
 2990 0000 F30F1EFA 		endbr64
 2991 0004 55       		pushq	%rbp
 2992              	.LCFI54:
 2993              		.cfi_def_cfa_offset 16
 2994              		.cfi_offset 6, -16
 2995 0005 4889E5   		movq	%rsp, %rbp
 2996              	.LCFI55:
 2997              		.cfi_def_cfa_register 6
 2998 0008 4881EC90 		subq	$144, %rsp
 2998      000000
 2999 000f 48897DB8 		movq	%rdi, -72(%rbp)
 3000 0013 488975B0 		movq	%rsi, -80(%rbp)
 3001 0017 488955A8 		movq	%rdx, -88(%rbp)
 3002 001b 894DA4   		movl	%ecx, -92(%rbp)
 3003 001e 4C894598 		movq	%r8, -104(%rbp)
 3004 0022 4C894D90 		movq	%r9, -112(%rbp)
 3005 0026 488B4510 		movq	16(%rbp), %rax
GAS LISTING /tmp/cc6OITWc.s 			page 86


 3006 002a 48894588 		movq	%rax, -120(%rbp)
 3007 002e 488B4518 		movq	24(%rbp), %rax
 3008 0032 48894580 		movq	%rax, -128(%rbp)
 3009 0036 488B4520 		movq	32(%rbp), %rax
 3010 003a 48898578 		movq	%rax, -136(%rbp)
 3010      FFFFFF
 3011              		.loc 1 1126 1
 3012 0041 64488B04 		movq	%fs:40, %rax
 3012      25280000 
 3012      00
 3013 004a 488945F8 		movq	%rax, -8(%rbp)
 3014 004e 31C0     		xorl	%eax, %eax
1127:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     size_t olen;
1128:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int ret;
1129:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned char *p = output;
 3015              		.loc 1 1129 20
 3016 0050 488B8578 		movq	-136(%rbp), %rax
 3016      FFFFFF
 3017 0057 488945C8 		movq	%rax, -56(%rbp)
1130:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned int hlen;
1131:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     const mbedtls_md_info_t *md_info;
1132:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_md_context_t md_ctx;
1133:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1134:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
1135:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( mode == MBEDTLS_RSA_PRIVATE ||
1136:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       mode == MBEDTLS_RSA_PUBLIC );
1137:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( output != NULL );
1138:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( input != NULL );
1139:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( label_len == 0 || label != NULL );
1140:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1141:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mode == MBEDTLS_RSA_PRIVATE && ctx->padding != MBEDTLS_RSA_PKCS_V21 )
 3018              		.loc 1 1141 7
 3019 005b 837DA401 		cmpl	$1, -92(%rbp)
 3020 005f 7519     		jne	.L239
 3021              		.loc 1 1141 43 discriminator 1
 3022 0061 488B45B8 		movq	-72(%rbp), %rax
 3023 0065 8B804801 		movl	328(%rax), %eax
 3023      0000
 3024              		.loc 1 1141 37 discriminator 1
 3025 006b 83F801   		cmpl	$1, %eax
 3026 006e 740A     		je	.L239
1142:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 3027              		.loc 1 1142 15
 3028 0070 B880BFFF 		movl	$-16512, %eax
 3028      FF
 3029 0075 E9820200 		jmp	.L253
 3029      00
 3030              	.L239:
1143:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1144:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( f_rng == NULL )
 3031              		.loc 1 1144 7
 3032 007a 48837DB0 		cmpq	$0, -80(%rbp)
 3032      00
 3033 007f 750A     		jne	.L241
1145:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 3034              		.loc 1 1145 15
 3035 0081 B880BFFF 		movl	$-16512, %eax
GAS LISTING /tmp/cc6OITWc.s 			page 87


 3035      FF
 3036 0086 E9710200 		jmp	.L253
 3036      00
 3037              	.L241:
1146:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1147:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     md_info = mbedtls_md_info_from_type( (mbedtls_md_type_t) ctx->hash_id );
 3038              		.loc 1 1147 65
 3039 008b 488B45B8 		movq	-72(%rbp), %rax
 3040 008f 8B804C01 		movl	332(%rax), %eax
 3040      0000
 3041              		.loc 1 1147 15
 3042 0095 89C7     		movl	%eax, %edi
 3043 0097 E8000000 		call	mbedtls_md_info_from_type@PLT
 3043      00
 3044 009c 488945D0 		movq	%rax, -48(%rbp)
1148:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( md_info == NULL )
 3045              		.loc 1 1148 7
 3046 00a0 48837DD0 		cmpq	$0, -48(%rbp)
 3046      00
 3047 00a5 750A     		jne	.L242
1149:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 3048              		.loc 1 1149 15
 3049 00a7 B880BFFF 		movl	$-16512, %eax
 3049      FF
 3050 00ac E94B0200 		jmp	.L253
 3050      00
 3051              	.L242:
1150:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1151:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     olen = ctx->len;
 3052              		.loc 1 1151 10
 3053 00b1 488B45B8 		movq	-72(%rbp), %rax
 3054 00b5 488B4008 		movq	8(%rax), %rax
 3055 00b9 488945D8 		movq	%rax, -40(%rbp)
1152:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     hlen = mbedtls_md_get_size( md_info );
 3056              		.loc 1 1152 12
 3057 00bd 488B45D0 		movq	-48(%rbp), %rax
 3058 00c1 4889C7   		movq	%rax, %rdi
 3059 00c4 E8000000 		call	mbedtls_md_get_size@PLT
 3059      00
 3060              		.loc 1 1152 10
 3061 00c9 0FB6C0   		movzbl	%al, %eax
 3062 00cc 8945C4   		movl	%eax, -60(%rbp)
1153:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1154:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* first comparison checks for overflow */
1155:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ilen + 2 * hlen + 2 < ilen || olen < ilen + 2 * hlen + 2 )
 3063              		.loc 1 1155 18
 3064 00cf 8B45C4   		movl	-60(%rbp), %eax
 3065 00d2 01C0     		addl	%eax, %eax
 3066 00d4 89C2     		movl	%eax, %edx
 3067              		.loc 1 1155 14
 3068 00d6 488B4588 		movq	-120(%rbp), %rax
 3069 00da 4801D0   		addq	%rdx, %rax
 3070              		.loc 1 1155 25
 3071 00dd 4883C002 		addq	$2, %rax
 3072              		.loc 1 1155 7
 3073 00e1 48394588 		cmpq	%rax, -120(%rbp)
 3074 00e5 7718     		ja	.L243
GAS LISTING /tmp/cc6OITWc.s 			page 88


 3075              		.loc 1 1155 55 discriminator 1
 3076 00e7 8B45C4   		movl	-60(%rbp), %eax
 3077 00ea 01C0     		addl	%eax, %eax
 3078 00ec 89C2     		movl	%eax, %edx
 3079              		.loc 1 1155 51 discriminator 1
 3080 00ee 488B4588 		movq	-120(%rbp), %rax
 3081 00f2 4801D0   		addq	%rdx, %rax
 3082              		.loc 1 1155 62 discriminator 1
 3083 00f5 4883C002 		addq	$2, %rax
 3084              		.loc 1 1155 36 discriminator 1
 3085 00f9 483945D8 		cmpq	%rax, -40(%rbp)
 3086 00fd 730A     		jnb	.L244
 3087              	.L243:
1156:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 3088              		.loc 1 1156 15
 3089 00ff B880BFFF 		movl	$-16512, %eax
 3089      FF
 3090 0104 E9F30100 		jmp	.L253
 3090      00
 3091              	.L244:
1157:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1158:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     memset( output, 0, olen );
 3092              		.loc 1 1158 5
 3093 0109 488B55D8 		movq	-40(%rbp), %rdx
 3094 010d 488B8578 		movq	-136(%rbp), %rax
 3094      FFFFFF
 3095 0114 BE000000 		movl	$0, %esi
 3095      00
 3096 0119 4889C7   		movq	%rax, %rdi
 3097 011c E8000000 		call	memset@PLT
 3097      00
1159:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1160:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     *p++ = 0;
 3098              		.loc 1 1160 7
 3099 0121 488B45C8 		movq	-56(%rbp), %rax
 3100 0125 488D5001 		leaq	1(%rax), %rdx
 3101 0129 488955C8 		movq	%rdx, -56(%rbp)
 3102              		.loc 1 1160 10
 3103 012d C60000   		movb	$0, (%rax)
1161:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1162:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Generate a random octet string seed */
1163:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = f_rng( p_rng, p, hlen ) ) != 0 )
 3104              		.loc 1 1163 17
 3105 0130 8B55C4   		movl	-60(%rbp), %edx
 3106 0133 488B4DC8 		movq	-56(%rbp), %rcx
 3107 0137 488B45A8 		movq	-88(%rbp), %rax
 3108 013b 4C8B45B0 		movq	-80(%rbp), %r8
 3109 013f 4889CE   		movq	%rcx, %rsi
 3110 0142 4889C7   		movq	%rax, %rdi
 3111 0145 41FFD0   		call	*%r8
 3112              	.LVL0:
 3113 0148 8945C0   		movl	%eax, -64(%rbp)
 3114              		.loc 1 1163 7
 3115 014b 837DC000 		cmpl	$0, -64(%rbp)
 3116 014f 740D     		je	.L245
1164:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_RNG_FAILED + ret );
 3117              		.loc 1 1164 44
GAS LISTING /tmp/cc6OITWc.s 			page 89


 3118 0151 8B45C0   		movl	-64(%rbp), %eax
 3119 0154 2D804400 		subl	$17536, %eax
 3119      00
 3120 0159 E99E0100 		jmp	.L253
 3120      00
 3121              	.L245:
1165:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1166:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     p += hlen;
 3122              		.loc 1 1166 7
 3123 015e 8B45C4   		movl	-60(%rbp), %eax
 3124 0161 480145C8 		addq	%rax, -56(%rbp)
1167:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1168:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Construct DB */
1169:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = mbedtls_md( md_info, label, label_len, p ) ) != 0 )
 3125              		.loc 1 1169 17
 3126 0165 488B4DC8 		movq	-56(%rbp), %rcx
 3127 0169 488B5590 		movq	-112(%rbp), %rdx
 3128 016d 488B7598 		movq	-104(%rbp), %rsi
 3129 0171 488B45D0 		movq	-48(%rbp), %rax
 3130 0175 4889C7   		movq	%rax, %rdi
 3131 0178 E8000000 		call	mbedtls_md@PLT
 3131      00
 3132 017d 8945C0   		movl	%eax, -64(%rbp)
 3133              		.loc 1 1169 7
 3134 0180 837DC000 		cmpl	$0, -64(%rbp)
 3135 0184 7408     		je	.L246
1170:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( ret );
 3136              		.loc 1 1170 15
 3137 0186 8B45C0   		movl	-64(%rbp), %eax
 3138 0189 E96E0100 		jmp	.L253
 3138      00
 3139              	.L246:
1171:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     p += hlen;
 3140              		.loc 1 1171 7
 3141 018e 8B45C4   		movl	-60(%rbp), %eax
 3142 0191 480145C8 		addq	%rax, -56(%rbp)
1172:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     p += olen - 2 * hlen - 2 - ilen;
 3143              		.loc 1 1172 19
 3144 0195 8B45C4   		movl	-60(%rbp), %eax
 3145 0198 01C0     		addl	%eax, %eax
 3146 019a 89C2     		movl	%eax, %edx
 3147              		.loc 1 1172 15
 3148 019c 488B45D8 		movq	-40(%rbp), %rax
 3149 01a0 4829D0   		subq	%rdx, %rax
 3150              		.loc 1 1172 30
 3151 01a3 482B4588 		subq	-120(%rbp), %rax
 3152 01a7 4883E802 		subq	$2, %rax
 3153              		.loc 1 1172 7
 3154 01ab 480145C8 		addq	%rax, -56(%rbp)
1173:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     *p++ = 1;
 3155              		.loc 1 1173 7
 3156 01af 488B45C8 		movq	-56(%rbp), %rax
 3157 01b3 488D5001 		leaq	1(%rax), %rdx
 3158 01b7 488955C8 		movq	%rdx, -56(%rbp)
 3159              		.loc 1 1173 10
 3160 01bb C60001   		movb	$1, (%rax)
1174:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     memcpy( p, input, ilen );
GAS LISTING /tmp/cc6OITWc.s 			page 90


 3161              		.loc 1 1174 5
 3162 01be 488B5588 		movq	-120(%rbp), %rdx
 3163 01c2 488B4D80 		movq	-128(%rbp), %rcx
 3164 01c6 488B45C8 		movq	-56(%rbp), %rax
 3165 01ca 4889CE   		movq	%rcx, %rsi
 3166 01cd 4889C7   		movq	%rax, %rdi
 3167 01d0 E8000000 		call	memcpy@PLT
 3167      00
1175:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1176:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_md_init( &md_ctx );
 3168              		.loc 1 1176 5
 3169 01d5 488D45E0 		leaq	-32(%rbp), %rax
 3170 01d9 4889C7   		movq	%rax, %rdi
 3171 01dc E8000000 		call	mbedtls_md_init@PLT
 3171      00
1177:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = mbedtls_md_setup( &md_ctx, md_info, 0 ) ) != 0 )
 3172              		.loc 1 1177 17
 3173 01e1 488B4DD0 		movq	-48(%rbp), %rcx
 3174 01e5 488D45E0 		leaq	-32(%rbp), %rax
 3175 01e9 BA000000 		movl	$0, %edx
 3175      00
 3176 01ee 4889CE   		movq	%rcx, %rsi
 3177 01f1 4889C7   		movq	%rax, %rdi
 3178 01f4 E8000000 		call	mbedtls_md_setup@PLT
 3178      00
 3179 01f9 8945C0   		movl	%eax, -64(%rbp)
 3180              		.loc 1 1177 7
 3181 01fc 837DC000 		cmpl	$0, -64(%rbp)
 3182 0200 0F859000 		jne	.L255
 3182      0000
1178:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto exit;
1179:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1180:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* maskedDB: Apply dbMask to DB */
1181:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = mgf_mask( output + hlen + 1, olen - hlen - 1, output + 1, hlen,
 3183              		.loc 1 1181 17
 3184 0206 8B45C4   		movl	-60(%rbp), %eax
 3185 0209 488B9578 		movq	-136(%rbp), %rdx
 3185      FFFFFF
 3186 0210 4883C201 		addq	$1, %rdx
 3187              		.loc 1 1181 51
 3188 0214 8B4DC4   		movl	-60(%rbp), %ecx
 3189 0217 488B75D8 		movq	-40(%rbp), %rsi
 3190 021b 4829CE   		subq	%rcx, %rsi
 3191 021e 4889F1   		movq	%rsi, %rcx
 3192              		.loc 1 1181 17
 3193 0221 488D71FF 		leaq	-1(%rcx), %rsi
 3194              		.loc 1 1181 41
 3195 0225 8B4DC4   		movl	-60(%rbp), %ecx
 3196 0228 488D7901 		leaq	1(%rcx), %rdi
 3197              		.loc 1 1181 17
 3198 022c 488B8D78 		movq	-136(%rbp), %rcx
 3198      FFFFFF
 3199 0233 4801CF   		addq	%rcx, %rdi
 3200 0236 488D4DE0 		leaq	-32(%rbp), %rcx
 3201 023a 4989C8   		movq	%rcx, %r8
 3202 023d 4889C1   		movq	%rax, %rcx
 3203 0240 E8000000 		call	mgf_mask
GAS LISTING /tmp/cc6OITWc.s 			page 91


 3203      00
 3204 0245 8945C0   		movl	%eax, -64(%rbp)
 3205              		.loc 1 1181 7
 3206 0248 837DC000 		cmpl	$0, -64(%rbp)
 3207 024c 754B     		jne	.L256
1182:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                           &md_ctx ) ) != 0 )
1183:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto exit;
1184:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1185:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* maskedSeed: Apply seedMask to seed */
1186:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = mgf_mask( output + 1, hlen, output + hlen + 1, olen - hlen - 1,
 3208              		.loc 1 1186 69
 3209 024e 8B45C4   		movl	-60(%rbp), %eax
 3210 0251 488B55D8 		movq	-40(%rbp), %rdx
 3211 0255 4829C2   		subq	%rax, %rdx
 3212 0258 4889D0   		movq	%rdx, %rax
 3213              		.loc 1 1186 17
 3214 025b 488D48FF 		leaq	-1(%rax), %rcx
 3215              		.loc 1 1186 59
 3216 025f 8B45C4   		movl	-60(%rbp), %eax
 3217 0262 488D5001 		leaq	1(%rax), %rdx
 3218              		.loc 1 1186 17
 3219 0266 488B8578 		movq	-136(%rbp), %rax
 3219      FFFFFF
 3220 026d 4801C2   		addq	%rax, %rdx
 3221 0270 8B45C4   		movl	-60(%rbp), %eax
 3222 0273 488BB578 		movq	-136(%rbp), %rsi
 3222      FFFFFF
 3223 027a 488D7E01 		leaq	1(%rsi), %rdi
 3224 027e 488D75E0 		leaq	-32(%rbp), %rsi
 3225 0282 4989F0   		movq	%rsi, %r8
 3226 0285 4889C6   		movq	%rax, %rsi
 3227 0288 E8000000 		call	mgf_mask
 3227      00
 3228 028d 8945C0   		movl	%eax, -64(%rbp)
 3229              		.loc 1 1186 7
 3230 0290 837DC000 		cmpl	$0, -64(%rbp)
1187:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                           &md_ctx ) ) != 0 )
1188:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto exit;
1189:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1190:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** exit:
 3231              		.loc 1 1190 1
 3232 0294 EB04     		jmp	.L248
 3233              	.L255:
1178:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 3234              		.loc 1 1178 9
 3235 0296 90       		nop
 3236 0297 EB01     		jmp	.L248
 3237              	.L256:
1183:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 3238              		.loc 1 1183 9
 3239 0299 90       		nop
 3240              	.L248:
1191:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_md_free( &md_ctx );
 3241              		.loc 1 1191 5
 3242 029a 488D45E0 		leaq	-32(%rbp), %rax
 3243 029e 4889C7   		movq	%rax, %rdi
 3244 02a1 E8000000 		call	mbedtls_md_free@PLT
GAS LISTING /tmp/cc6OITWc.s 			page 92


 3244      00
1192:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1193:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ret != 0 )
 3245              		.loc 1 1193 7
 3246 02a6 837DC000 		cmpl	$0, -64(%rbp)
 3247 02aa 7405     		je	.L250
1194:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( ret );
 3248              		.loc 1 1194 15
 3249 02ac 8B45C0   		movl	-64(%rbp), %eax
 3250 02af EB4B     		jmp	.L253
 3251              	.L250:
1195:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1196:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( ( mode == MBEDTLS_RSA_PUBLIC )
1197:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             ? mbedtls_rsa_public(  ctx, output, output )
1198:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             : mbedtls_rsa_private( ctx, f_rng, p_rng, output, output ) );
 3252              		.loc 1 1198 13
 3253 02b1 837DA400 		cmpl	$0, -92(%rbp)
 3254 02b5 751F     		jne	.L251
1197:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             : mbedtls_rsa_private( ctx, f_rng, p_rng, output, output ) );
 3255              		.loc 1 1197 15
 3256 02b7 488B9578 		movq	-136(%rbp), %rdx
 3256      FFFFFF
 3257 02be 488B8D78 		movq	-136(%rbp), %rcx
 3257      FFFFFF
 3258 02c5 488B45B8 		movq	-72(%rbp), %rax
 3259 02c9 4889CE   		movq	%rcx, %rsi
 3260 02cc 4889C7   		movq	%rax, %rdi
 3261 02cf E8000000 		call	mbedtls_rsa_public
 3261      00
 3262              		.loc 1 1198 13
 3263 02d4 EB25     		jmp	.L257
 3264              	.L251:
 3265              		.loc 1 1198 15 discriminator 1
 3266 02d6 488BBD78 		movq	-136(%rbp), %rdi
 3266      FFFFFF
 3267 02dd 488B8D78 		movq	-136(%rbp), %rcx
 3267      FFFFFF
 3268 02e4 488B55A8 		movq	-88(%rbp), %rdx
 3269 02e8 488B75B0 		movq	-80(%rbp), %rsi
 3270 02ec 488B45B8 		movq	-72(%rbp), %rax
 3271 02f0 4989F8   		movq	%rdi, %r8
 3272 02f3 4889C7   		movq	%rax, %rdi
 3273 02f6 E8000000 		call	mbedtls_rsa_private
 3273      00
 3274              	.L257:
 3275              		.loc 1 1198 13
 3276 02fb 90       		nop
 3277              	.L253:
1199:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 3278              		.loc 1 1199 1 discriminator 1
 3279 02fc 488B7DF8 		movq	-8(%rbp), %rdi
 3280 0300 6448333C 		xorq	%fs:40, %rdi
 3280      25280000 
 3280      00
 3281 0309 7405     		je	.L254
 3282              		.loc 1 1199 1 is_stmt 0
 3283 030b E8000000 		call	__stack_chk_fail@PLT
GAS LISTING /tmp/cc6OITWc.s 			page 93


 3283      00
 3284              	.L254:
 3285 0310 C9       		leave
 3286              	.LCFI56:
 3287              		.cfi_def_cfa 7, 8
 3288 0311 C3       		ret
 3289              		.cfi_endproc
 3290              	.LFE34:
 3292              		.section	.text.mbedtls_rsa_rsaes_pkcs1_v15_encrypt,"ax",@progbits
 3293              		.globl	mbedtls_rsa_rsaes_pkcs1_v15_encrypt
 3295              	mbedtls_rsa_rsaes_pkcs1_v15_encrypt:
 3296              	.LFB35:
1200:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif /* MBEDTLS_PKCS1_V21 */
1201:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1202:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_PKCS1_V15)
1203:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
1204:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Implementation of the PKCS#1 v2.1 RSAES-PKCS1-V1_5-ENCRYPT function
1205:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
1206:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_rsaes_pkcs1_v15_encrypt( mbedtls_rsa_context *ctx,
1207:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                  int (*f_rng)(void *, unsigned char *, size_t),
1208:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                  void *p_rng,
1209:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                  int mode, size_t ilen,
1210:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                  const unsigned char *input,
1211:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                  unsigned char *output )
1212:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 3297              		.loc 1 1212 1 is_stmt 1
 3298              		.cfi_startproc
 3299 0000 F30F1EFA 		endbr64
 3300 0004 55       		pushq	%rbp
 3301              	.LCFI57:
 3302              		.cfi_def_cfa_offset 16
 3303              		.cfi_offset 6, -16
 3304 0005 4889E5   		movq	%rsp, %rbp
 3305              	.LCFI58:
 3306              		.cfi_def_cfa_register 6
 3307 0008 4883EC70 		subq	$112, %rsp
 3308 000c 48897DC8 		movq	%rdi, -56(%rbp)
 3309 0010 488975C0 		movq	%rsi, -64(%rbp)
 3310 0014 488955B8 		movq	%rdx, -72(%rbp)
 3311 0018 894DB4   		movl	%ecx, -76(%rbp)
 3312 001b 4C8945A8 		movq	%r8, -88(%rbp)
 3313 001f 4C894DA0 		movq	%r9, -96(%rbp)
 3314 0023 488B4510 		movq	16(%rbp), %rax
 3315 0027 48894598 		movq	%rax, -104(%rbp)
 3316              		.loc 1 1212 1
 3317 002b 64488B04 		movq	%fs:40, %rax
 3317      25280000 
 3317      00
 3318 0034 488945F8 		movq	%rax, -8(%rbp)
 3319 0038 31C0     		xorl	%eax, %eax
1213:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     size_t nb_pad, olen;
1214:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int ret;
1215:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned char *p = output;
 3320              		.loc 1 1215 20
 3321 003a 488B4598 		movq	-104(%rbp), %rax
 3322 003e 488945E8 		movq	%rax, -24(%rbp)
1216:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
GAS LISTING /tmp/cc6OITWc.s 			page 94


1217:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
1218:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( mode == MBEDTLS_RSA_PRIVATE ||
1219:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       mode == MBEDTLS_RSA_PUBLIC );
1220:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( output != NULL );
1221:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( input != NULL );
1222:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1223:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mode == MBEDTLS_RSA_PRIVATE && ctx->padding != MBEDTLS_RSA_PKCS_V15 )
 3323              		.loc 1 1223 7
 3324 0042 837DB401 		cmpl	$1, -76(%rbp)
 3325 0046 7518     		jne	.L259
 3326              		.loc 1 1223 43 discriminator 1
 3327 0048 488B45C8 		movq	-56(%rbp), %rax
 3328 004c 8B804801 		movl	328(%rax), %eax
 3328      0000
 3329              		.loc 1 1223 37 discriminator 1
 3330 0052 85C0     		testl	%eax, %eax
 3331 0054 740A     		je	.L259
1224:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 3332              		.loc 1 1224 15
 3333 0056 B880BFFF 		movl	$-16512, %eax
 3333      FF
 3334 005b E97C0100 		jmp	.L260
 3334      00
 3335              	.L259:
1225:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1226:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     olen = ctx->len;
 3336              		.loc 1 1226 10
 3337 0060 488B45C8 		movq	-56(%rbp), %rax
 3338 0064 488B4008 		movq	8(%rax), %rax
 3339 0068 488945F0 		movq	%rax, -16(%rbp)
1227:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1228:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* first comparison checks for overflow */
1229:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ilen + 11 < ilen || olen < ilen + 11 )
 3340              		.loc 1 1229 7
 3341 006c 48837DA8 		cmpq	$-12, -88(%rbp)
 3341      F4
 3342 0071 770E     		ja	.L261
 3343              		.loc 1 1229 41 discriminator 1
 3344 0073 488B45A8 		movq	-88(%rbp), %rax
 3345 0077 4883C00B 		addq	$11, %rax
 3346              		.loc 1 1229 26 discriminator 1
 3347 007b 483945F0 		cmpq	%rax, -16(%rbp)
 3348 007f 730A     		jnb	.L262
 3349              	.L261:
1230:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 3350              		.loc 1 1230 15
 3351 0081 B880BFFF 		movl	$-16512, %eax
 3351      FF
 3352 0086 E9510100 		jmp	.L260
 3352      00
 3353              	.L262:
1231:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1232:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     nb_pad = olen - 3 - ilen;
 3354              		.loc 1 1232 23
 3355 008b 488B45F0 		movq	-16(%rbp), %rax
 3356 008f 482B45A8 		subq	-88(%rbp), %rax
 3357              		.loc 1 1232 12
GAS LISTING /tmp/cc6OITWc.s 			page 95


 3358 0093 4883E803 		subq	$3, %rax
 3359 0097 488945E0 		movq	%rax, -32(%rbp)
1233:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1234:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     *p++ = 0;
 3360              		.loc 1 1234 7
 3361 009b 488B45E8 		movq	-24(%rbp), %rax
 3362 009f 488D5001 		leaq	1(%rax), %rdx
 3363 00a3 488955E8 		movq	%rdx, -24(%rbp)
 3364              		.loc 1 1234 10
 3365 00a7 C60000   		movb	$0, (%rax)
1235:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mode == MBEDTLS_RSA_PUBLIC )
 3366              		.loc 1 1235 7
 3367 00aa 837DB400 		cmpl	$0, -76(%rbp)
 3368 00ae 0F859200 		jne	.L263
 3368      0000
1236:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
1237:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( f_rng == NULL )
 3369              		.loc 1 1237 11
 3370 00b4 48837DC0 		cmpq	$0, -64(%rbp)
 3370      00
 3371 00b9 750A     		jne	.L264
1238:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 3372              		.loc 1 1238 19
 3373 00bb B880BFFF 		movl	$-16512, %eax
 3373      FF
 3374 00c0 E9170100 		jmp	.L260
 3374      00
 3375              	.L264:
1239:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1240:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         *p++ = MBEDTLS_RSA_CRYPT;
 3376              		.loc 1 1240 11
 3377 00c5 488B45E8 		movq	-24(%rbp), %rax
 3378 00c9 488D5001 		leaq	1(%rax), %rdx
 3379 00cd 488955E8 		movq	%rdx, -24(%rbp)
 3380              		.loc 1 1240 14
 3381 00d1 C60002   		movb	$2, (%rax)
1241:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1242:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         while( nb_pad-- > 0 )
 3382              		.loc 1 1242 14
 3383 00d4 EB5D     		jmp	.L265
 3384              	.L270:
 3385              	.LBB2:
1243:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         {
1244:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             int rng_dl = 100;
 3386              		.loc 1 1244 17
 3387 00d6 C745D864 		movl	$100, -40(%rbp)
 3387      000000
 3388              	.L267:
1245:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1246:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             do {
1247:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                 ret = f_rng( p_rng, p, 1 );
 3389              		.loc 1 1247 23 discriminator 3
 3390 00dd 488B4DE8 		movq	-24(%rbp), %rcx
 3391 00e1 488B45B8 		movq	-72(%rbp), %rax
 3392 00e5 4C8B45C0 		movq	-64(%rbp), %r8
 3393 00e9 BA010000 		movl	$1, %edx
 3393      00
GAS LISTING /tmp/cc6OITWc.s 			page 96


 3394 00ee 4889CE   		movq	%rcx, %rsi
 3395 00f1 4889C7   		movq	%rax, %rdi
 3396 00f4 41FFD0   		call	*%r8
 3397              	.LVL1:
 3398 00f7 8945DC   		movl	%eax, -36(%rbp)
1248:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             } while( *p == 0 && --rng_dl && ret == 0 );
 3399              		.loc 1 1248 22 discriminator 3
 3400 00fa 488B45E8 		movq	-24(%rbp), %rax
 3401 00fe 0FB600   		movzbl	(%rax), %eax
 3402              		.loc 1 1248 13 discriminator 3
 3403 0101 84C0     		testb	%al, %al
 3404 0103 7510     		jne	.L266
 3405              		.loc 1 1248 30 discriminator 1
 3406 0105 836DD801 		subl	$1, -40(%rbp)
 3407 0109 837DD800 		cmpl	$0, -40(%rbp)
 3408 010d 7406     		je	.L266
 3409              		.loc 1 1248 42 discriminator 2
 3410 010f 837DDC00 		cmpl	$0, -36(%rbp)
 3411 0113 74C8     		je	.L267
 3412              	.L266:
1249:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1250:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             /* Check if RNG failed to generate data */
1251:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             if( rng_dl == 0 || ret != 0 )
 3413              		.loc 1 1251 15
 3414 0115 837DD800 		cmpl	$0, -40(%rbp)
 3415 0119 7406     		je	.L268
 3416              		.loc 1 1251 29 discriminator 1
 3417 011b 837DDC00 		cmpl	$0, -36(%rbp)
 3418 011f 740D     		je	.L269
 3419              	.L268:
1252:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                 return( MBEDTLS_ERR_RSA_RNG_FAILED + ret );
 3420              		.loc 1 1252 52
 3421 0121 8B45DC   		movl	-36(%rbp), %eax
 3422 0124 2D804400 		subl	$17536, %eax
 3422      00
 3423 0129 E9AE0000 		jmp	.L260
 3423      00
 3424              	.L269:
1253:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1254:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             p++;
 3425              		.loc 1 1254 14
 3426 012e 488345E8 		addq	$1, -24(%rbp)
 3426      01
 3427              	.L265:
 3428              	.LBE2:
1242:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         {
 3429              		.loc 1 1242 22
 3430 0133 488B45E0 		movq	-32(%rbp), %rax
 3431 0137 488D50FF 		leaq	-1(%rax), %rdx
 3432 013b 488955E0 		movq	%rdx, -32(%rbp)
1242:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         {
 3433              		.loc 1 1242 14
 3434 013f 4885C0   		testq	%rax, %rax
 3435 0142 7592     		jne	.L270
 3436 0144 EB31     		jmp	.L271
 3437              	.L263:
1255:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         }
GAS LISTING /tmp/cc6OITWc.s 			page 97


1256:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
1257:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     else
1258:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
1259:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         *p++ = MBEDTLS_RSA_SIGN;
 3438              		.loc 1 1259 11
 3439 0146 488B45E8 		movq	-24(%rbp), %rax
 3440 014a 488D5001 		leaq	1(%rax), %rdx
 3441 014e 488955E8 		movq	%rdx, -24(%rbp)
 3442              		.loc 1 1259 14
 3443 0152 C60001   		movb	$1, (%rax)
1260:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1261:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         while( nb_pad-- > 0 )
 3444              		.loc 1 1261 14
 3445 0155 EB0F     		jmp	.L272
 3446              	.L273:
1262:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             *p++ = 0xFF;
 3447              		.loc 1 1262 15
 3448 0157 488B45E8 		movq	-24(%rbp), %rax
 3449 015b 488D5001 		leaq	1(%rax), %rdx
 3450 015f 488955E8 		movq	%rdx, -24(%rbp)
 3451              		.loc 1 1262 18
 3452 0163 C600FF   		movb	$-1, (%rax)
 3453              	.L272:
1261:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             *p++ = 0xFF;
 3454              		.loc 1 1261 22
 3455 0166 488B45E0 		movq	-32(%rbp), %rax
 3456 016a 488D50FF 		leaq	-1(%rax), %rdx
 3457 016e 488955E0 		movq	%rdx, -32(%rbp)
1261:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             *p++ = 0xFF;
 3458              		.loc 1 1261 14
 3459 0172 4885C0   		testq	%rax, %rax
 3460 0175 75E0     		jne	.L273
 3461              	.L271:
1263:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
1264:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1265:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     *p++ = 0;
 3462              		.loc 1 1265 7
 3463 0177 488B45E8 		movq	-24(%rbp), %rax
 3464 017b 488D5001 		leaq	1(%rax), %rdx
 3465 017f 488955E8 		movq	%rdx, -24(%rbp)
 3466              		.loc 1 1265 10
 3467 0183 C60000   		movb	$0, (%rax)
1266:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     memcpy( p, input, ilen );
 3468              		.loc 1 1266 5
 3469 0186 488B55A8 		movq	-88(%rbp), %rdx
 3470 018a 488B4DA0 		movq	-96(%rbp), %rcx
 3471 018e 488B45E8 		movq	-24(%rbp), %rax
 3472 0192 4889CE   		movq	%rcx, %rsi
 3473 0195 4889C7   		movq	%rax, %rdi
 3474 0198 E8000000 		call	memcpy@PLT
 3474      00
1267:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1268:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( ( mode == MBEDTLS_RSA_PUBLIC )
1269:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             ? mbedtls_rsa_public(  ctx, output, output )
1270:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             : mbedtls_rsa_private( ctx, f_rng, p_rng, output, output ) );
 3475              		.loc 1 1270 13
 3476 019d 837DB400 		cmpl	$0, -76(%rbp)
GAS LISTING /tmp/cc6OITWc.s 			page 98


 3477 01a1 7519     		jne	.L274
1269:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             : mbedtls_rsa_private( ctx, f_rng, p_rng, output, output ) );
 3478              		.loc 1 1269 15
 3479 01a3 488B5598 		movq	-104(%rbp), %rdx
 3480 01a7 488B4D98 		movq	-104(%rbp), %rcx
 3481 01ab 488B45C8 		movq	-56(%rbp), %rax
 3482 01af 4889CE   		movq	%rcx, %rsi
 3483 01b2 4889C7   		movq	%rax, %rdi
 3484 01b5 E8000000 		call	mbedtls_rsa_public
 3484      00
 3485              		.loc 1 1270 13
 3486 01ba EB1F     		jmp	.L277
 3487              	.L274:
 3488              		.loc 1 1270 15 discriminator 1
 3489 01bc 488B7D98 		movq	-104(%rbp), %rdi
 3490 01c0 488B4D98 		movq	-104(%rbp), %rcx
 3491 01c4 488B55B8 		movq	-72(%rbp), %rdx
 3492 01c8 488B75C0 		movq	-64(%rbp), %rsi
 3493 01cc 488B45C8 		movq	-56(%rbp), %rax
 3494 01d0 4989F8   		movq	%rdi, %r8
 3495 01d3 4889C7   		movq	%rax, %rdi
 3496 01d6 E8000000 		call	mbedtls_rsa_private
 3496      00
 3497              	.L277:
 3498              		.loc 1 1270 13
 3499 01db 90       		nop
 3500              	.L260:
1271:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 3501              		.loc 1 1271 1
 3502 01dc 488B75F8 		movq	-8(%rbp), %rsi
 3503 01e0 64483334 		xorq	%fs:40, %rsi
 3503      25280000 
 3503      00
 3504 01e9 7405     		je	.L276
 3505 01eb E8000000 		call	__stack_chk_fail@PLT
 3505      00
 3506              	.L276:
 3507 01f0 C9       		leave
 3508              	.LCFI59:
 3509              		.cfi_def_cfa 7, 8
 3510 01f1 C3       		ret
 3511              		.cfi_endproc
 3512              	.LFE35:
 3514              		.section	.text.mbedtls_rsa_pkcs1_encrypt,"ax",@progbits
 3515              		.globl	mbedtls_rsa_pkcs1_encrypt
 3517              	mbedtls_rsa_pkcs1_encrypt:
 3518              	.LFB36:
1272:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif /* MBEDTLS_PKCS1_V15 */
1273:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1274:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
1275:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Add the message padding, then do an RSA operation
1276:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
1277:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_pkcs1_encrypt( mbedtls_rsa_context *ctx,
1278:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                        int (*f_rng)(void *, unsigned char *, size_t),
1279:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                        void *p_rng,
1280:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                        int mode, size_t ilen,
1281:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                        const unsigned char *input,
GAS LISTING /tmp/cc6OITWc.s 			page 99


1282:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                        unsigned char *output )
1283:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 3519              		.loc 1 1283 1
 3520              		.cfi_startproc
 3521 0000 F30F1EFA 		endbr64
 3522 0004 55       		pushq	%rbp
 3523              	.LCFI60:
 3524              		.cfi_def_cfa_offset 16
 3525              		.cfi_offset 6, -16
 3526 0005 4889E5   		movq	%rsp, %rbp
 3527              	.LCFI61:
 3528              		.cfi_def_cfa_register 6
 3529 0008 4883EC50 		subq	$80, %rsp
 3530 000c 48897DE8 		movq	%rdi, -24(%rbp)
 3531 0010 488975E0 		movq	%rsi, -32(%rbp)
 3532 0014 488955D8 		movq	%rdx, -40(%rbp)
 3533 0018 894DD4   		movl	%ecx, -44(%rbp)
 3534 001b 4C8945C8 		movq	%r8, -56(%rbp)
 3535 001f 4C894DC0 		movq	%r9, -64(%rbp)
 3536 0023 488B4510 		movq	16(%rbp), %rax
 3537 0027 488945B8 		movq	%rax, -72(%rbp)
 3538              		.loc 1 1283 1
 3539 002b 64488B04 		movq	%fs:40, %rax
 3539      25280000 
 3539      00
 3540 0034 488945F8 		movq	%rax, -8(%rbp)
 3541 0038 31C0     		xorl	%eax, %eax
1284:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
1285:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( mode == MBEDTLS_RSA_PRIVATE ||
1286:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       mode == MBEDTLS_RSA_PUBLIC );
1287:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( output != NULL );
1288:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( input != NULL );
1289:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1290:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     switch( ctx->padding )
 3542              		.loc 1 1290 16
 3543 003a 488B45E8 		movq	-24(%rbp), %rax
 3544 003e 8B804801 		movl	328(%rax), %eax
 3544      0000
 3545              		.loc 1 1290 5
 3546 0044 85C0     		testl	%eax, %eax
 3547 0046 7407     		je	.L279
 3548 0048 83F801   		cmpl	$1, %eax
 3549 004b 7434     		je	.L280
 3550 004d EB68     		jmp	.L284
 3551              	.L279:
1291:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
1292:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_PKCS1_V15)
1293:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         case MBEDTLS_RSA_PKCS_V15:
1294:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return mbedtls_rsa_rsaes_pkcs1_v15_encrypt( ctx, f_rng, p_rng, mode, ilen,
 3552              		.loc 1 1294 20
 3553 004f 4C8B45C0 		movq	-64(%rbp), %r8
 3554 0053 488B7DC8 		movq	-56(%rbp), %rdi
 3555 0057 8B4DD4   		movl	-44(%rbp), %ecx
 3556 005a 488B55D8 		movq	-40(%rbp), %rdx
 3557 005e 488B75E0 		movq	-32(%rbp), %rsi
 3558 0062 488B45E8 		movq	-24(%rbp), %rax
 3559 0066 4883EC08 		subq	$8, %rsp
GAS LISTING /tmp/cc6OITWc.s 			page 100


 3560 006a FF75B8   		pushq	-72(%rbp)
 3561 006d 4D89C1   		movq	%r8, %r9
 3562 0070 4989F8   		movq	%rdi, %r8
 3563 0073 4889C7   		movq	%rax, %rdi
 3564 0076 E8000000 		call	mbedtls_rsa_rsaes_pkcs1_v15_encrypt
 3564      00
 3565 007b 4883C410 		addq	$16, %rsp
 3566 007f EB3B     		jmp	.L282
 3567              	.L280:
1295:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                                 input, output );
1296:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
1297:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1298:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_PKCS1_V21)
1299:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         case MBEDTLS_RSA_PKCS_V21:
1300:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return mbedtls_rsa_rsaes_oaep_encrypt( ctx, f_rng, p_rng, mode, NULL, 0,
 3568              		.loc 1 1300 20
 3569 0081 8B4DD4   		movl	-44(%rbp), %ecx
 3570 0084 488B55D8 		movq	-40(%rbp), %rdx
 3571 0088 488B75E0 		movq	-32(%rbp), %rsi
 3572 008c 488B45E8 		movq	-24(%rbp), %rax
 3573 0090 4883EC08 		subq	$8, %rsp
 3574 0094 FF75B8   		pushq	-72(%rbp)
 3575 0097 FF75C0   		pushq	-64(%rbp)
 3576 009a FF75C8   		pushq	-56(%rbp)
 3577 009d 41B90000 		movl	$0, %r9d
 3577      0000
 3578 00a3 41B80000 		movl	$0, %r8d
 3578      0000
 3579 00a9 4889C7   		movq	%rax, %rdi
 3580 00ac E8000000 		call	mbedtls_rsa_rsaes_oaep_encrypt
 3580      00
 3581 00b1 4883C420 		addq	$32, %rsp
 3582 00b5 EB05     		jmp	.L282
 3583              	.L284:
1301:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                            ilen, input, output );
1302:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
1303:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1304:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         default:
1305:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return( MBEDTLS_ERR_RSA_INVALID_PADDING );
 3584              		.loc 1 1305 19
 3585 00b7 B800BFFF 		movl	$-16640, %eax
 3585      FF
 3586              	.L282:
1306:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
1307:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 3587              		.loc 1 1307 1
 3588 00bc 488B7DF8 		movq	-8(%rbp), %rdi
 3589 00c0 6448333C 		xorq	%fs:40, %rdi
 3589      25280000 
 3589      00
 3590 00c9 7405     		je	.L283
 3591 00cb E8000000 		call	__stack_chk_fail@PLT
 3591      00
 3592              	.L283:
 3593 00d0 C9       		leave
 3594              	.LCFI62:
 3595              		.cfi_def_cfa 7, 8
GAS LISTING /tmp/cc6OITWc.s 			page 101


 3596 00d1 C3       		ret
 3597              		.cfi_endproc
 3598              	.LFE36:
 3600              		.section	.text.mbedtls_rsa_rsaes_oaep_decrypt,"ax",@progbits
 3601              		.globl	mbedtls_rsa_rsaes_oaep_decrypt
 3603              	mbedtls_rsa_rsaes_oaep_decrypt:
 3604              	.LFB37:
1308:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1309:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_PKCS1_V21)
1310:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
1311:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Implementation of the PKCS#1 v2.1 RSAES-OAEP-DECRYPT function
1312:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
1313:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_rsaes_oaep_decrypt( mbedtls_rsa_context *ctx,
1314:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             int (*f_rng)(void *, unsigned char *, size_t),
1315:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             void *p_rng,
1316:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             int mode,
1317:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             const unsigned char *label, size_t label_len,
1318:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             size_t *olen,
1319:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             const unsigned char *input,
1320:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             unsigned char *output,
1321:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                             size_t output_max_len )
1322:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 3605              		.loc 1 1322 1
 3606              		.cfi_startproc
 3607 0000 F30F1EFA 		endbr64
 3608 0004 55       		pushq	%rbp
 3609              	.LCFI63:
 3610              		.cfi_def_cfa_offset 16
 3611              		.cfi_offset 6, -16
 3612 0005 4889E5   		movq	%rsp, %rbp
 3613              	.LCFI64:
 3614              		.cfi_def_cfa_register 6
 3615 0008 4881ECE0 		subq	$1248, %rsp
 3615      040000
 3616 000f 4889BD68 		movq	%rdi, -1176(%rbp)
 3616      FBFFFF
 3617 0016 4889B560 		movq	%rsi, -1184(%rbp)
 3617      FBFFFF
 3618 001d 48899558 		movq	%rdx, -1192(%rbp)
 3618      FBFFFF
 3619 0024 898D54FB 		movl	%ecx, -1196(%rbp)
 3619      FFFF
 3620 002a 4C898548 		movq	%r8, -1208(%rbp)
 3620      FBFFFF
 3621 0031 4C898D40 		movq	%r9, -1216(%rbp)
 3621      FBFFFF
 3622 0038 488B4510 		movq	16(%rbp), %rax
 3623 003c 48898538 		movq	%rax, -1224(%rbp)
 3623      FBFFFF
 3624 0043 488B4518 		movq	24(%rbp), %rax
 3625 0047 48898530 		movq	%rax, -1232(%rbp)
 3625      FBFFFF
 3626 004e 488B4520 		movq	32(%rbp), %rax
 3627 0052 48898528 		movq	%rax, -1240(%rbp)
 3627      FBFFFF
 3628 0059 488B4528 		movq	40(%rbp), %rax
 3629 005d 48898520 		movq	%rax, -1248(%rbp)
GAS LISTING /tmp/cc6OITWc.s 			page 102


 3629      FBFFFF
 3630              		.loc 1 1322 1
 3631 0064 64488B04 		movq	%fs:40, %rax
 3631      25280000 
 3631      00
 3632 006d 488945F8 		movq	%rax, -8(%rbp)
 3633 0071 31C0     		xorl	%eax, %eax
1323:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int ret;
1324:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     size_t ilen, i, pad_len;
1325:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned char *p, bad, pad_done;
1326:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned char buf[MBEDTLS_MPI_MAX_SIZE];
1327:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned char lhash[MBEDTLS_MD_MAX_SIZE];
1328:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned int hlen;
1329:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     const mbedtls_md_info_t *md_info;
1330:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_md_context_t md_ctx;
1331:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1332:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
1333:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( mode == MBEDTLS_RSA_PRIVATE ||
1334:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       mode == MBEDTLS_RSA_PUBLIC );
1335:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( output_max_len == 0 || output != NULL );
1336:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( label_len == 0 || label != NULL );
1337:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( input != NULL );
1338:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( olen != NULL );
1339:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1340:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
1341:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * Parameters sanity checks
1342:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
1343:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mode == MBEDTLS_RSA_PRIVATE && ctx->padding != MBEDTLS_RSA_PKCS_V21 )
 3634              		.loc 1 1343 7
 3635 0073 83BD54FB 		cmpl	$1, -1196(%rbp)
 3635      FFFF01
 3636 007a 751C     		jne	.L286
 3637              		.loc 1 1343 43 discriminator 1
 3638 007c 488B8568 		movq	-1176(%rbp), %rax
 3638      FBFFFF
 3639 0083 8B804801 		movl	328(%rax), %eax
 3639      0000
 3640              		.loc 1 1343 37 discriminator 1
 3641 0089 83F801   		cmpl	$1, %eax
 3642 008c 740A     		je	.L286
1344:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 3643              		.loc 1 1344 15
 3644 008e B880BFFF 		movl	$-16512, %eax
 3644      FF
 3645 0093 E9A50400 		jmp	.L306
 3645      00
 3646              	.L286:
1345:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1346:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     ilen = ctx->len;
 3647              		.loc 1 1346 10
 3648 0098 488B8568 		movq	-1176(%rbp), %rax
 3648      FBFFFF
 3649 009f 488B4008 		movq	8(%rax), %rax
 3650 00a3 488985A0 		movq	%rax, -1120(%rbp)
 3650      FBFFFF
1347:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1348:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ilen < 16 || ilen > sizeof( buf ) )
GAS LISTING /tmp/cc6OITWc.s 			page 103


 3651              		.loc 1 1348 7
 3652 00aa 4883BDA0 		cmpq	$15, -1120(%rbp)
 3652      FBFFFF0F 
 3653 00b2 760D     		jbe	.L288
 3654              		.loc 1 1348 19 discriminator 1
 3655 00b4 4881BDA0 		cmpq	$1024, -1120(%rbp)
 3655      FBFFFF00 
 3655      040000
 3656 00bf 760A     		jbe	.L289
 3657              	.L288:
1349:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 3658              		.loc 1 1349 15
 3659 00c1 B880BFFF 		movl	$-16512, %eax
 3659      FF
 3660 00c6 E9720400 		jmp	.L306
 3660      00
 3661              	.L289:
1350:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1351:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     md_info = mbedtls_md_info_from_type( (mbedtls_md_type_t) ctx->hash_id );
 3662              		.loc 1 1351 65
 3663 00cb 488B8568 		movq	-1176(%rbp), %rax
 3663      FBFFFF
 3664 00d2 8B804C01 		movl	332(%rax), %eax
 3664      0000
 3665              		.loc 1 1351 15
 3666 00d8 89C7     		movl	%eax, %edi
 3667 00da E8000000 		call	mbedtls_md_info_from_type@PLT
 3667      00
 3668 00df 488985A8 		movq	%rax, -1112(%rbp)
 3668      FBFFFF
1352:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( md_info == NULL )
 3669              		.loc 1 1352 7
 3670 00e6 4883BDA8 		cmpq	$0, -1112(%rbp)
 3670      FBFFFF00 
 3671 00ee 750A     		jne	.L290
1353:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 3672              		.loc 1 1353 15
 3673 00f0 B880BFFF 		movl	$-16512, %eax
 3673      FF
 3674 00f5 E9430400 		jmp	.L306
 3674      00
 3675              	.L290:
1354:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1355:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     hlen = mbedtls_md_get_size( md_info );
 3676              		.loc 1 1355 12
 3677 00fa 488B85A8 		movq	-1112(%rbp), %rax
 3677      FBFFFF
 3678 0101 4889C7   		movq	%rax, %rdi
 3679 0104 E8000000 		call	mbedtls_md_get_size@PLT
 3679      00
 3680              		.loc 1 1355 10
 3681 0109 0FB6C0   		movzbl	%al, %eax
 3682 010c 898584FB 		movl	%eax, -1148(%rbp)
 3682      FFFF
1356:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1357:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     // checking for integer underflow
1358:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( 2 * hlen + 2 > ilen )
GAS LISTING /tmp/cc6OITWc.s 			page 104


 3683              		.loc 1 1358 18
 3684 0112 8B8584FB 		movl	-1148(%rbp), %eax
 3684      FFFF
 3685 0118 83C001   		addl	$1, %eax
 3686 011b 01C0     		addl	%eax, %eax
 3687 011d 89C0     		movl	%eax, %eax
 3688              		.loc 1 1358 7
 3689 011f 483985A0 		cmpq	%rax, -1120(%rbp)
 3689      FBFFFF
 3690 0126 730A     		jnb	.L291
1359:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 3691              		.loc 1 1359 15
 3692 0128 B880BFFF 		movl	$-16512, %eax
 3692      FF
 3693 012d E90B0400 		jmp	.L306
 3693      00
 3694              	.L291:
1360:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1361:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
1362:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * RSA operation
1363:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
1364:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     ret = ( mode == MBEDTLS_RSA_PUBLIC )
1365:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****           ? mbedtls_rsa_public(  ctx, input, buf )
1366:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****           : mbedtls_rsa_private( ctx, f_rng, p_rng, input, buf );
 3695              		.loc 1 1366 11
 3696 0132 83BD54FB 		cmpl	$0, -1196(%rbp)
 3696      FFFF00
 3697 0139 7522     		jne	.L292
1365:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****           : mbedtls_rsa_private( ctx, f_rng, p_rng, input, buf );
 3698              		.loc 1 1365 13
 3699 013b 488D95F0 		leaq	-1040(%rbp), %rdx
 3699      FBFFFF
 3700 0142 488B8D30 		movq	-1232(%rbp), %rcx
 3700      FBFFFF
 3701 0149 488B8568 		movq	-1176(%rbp), %rax
 3701      FBFFFF
 3702 0150 4889CE   		movq	%rcx, %rsi
 3703 0153 4889C7   		movq	%rax, %rdi
 3704 0156 E8000000 		call	mbedtls_rsa_public
 3704      00
 3705 015b EB2E     		jmp	.L293
 3706              	.L292:
 3707              		.loc 1 1366 13 discriminator 1
 3708 015d 488DBDF0 		leaq	-1040(%rbp), %rdi
 3708      FBFFFF
 3709 0164 488B8D30 		movq	-1232(%rbp), %rcx
 3709      FBFFFF
 3710 016b 488B9558 		movq	-1192(%rbp), %rdx
 3710      FBFFFF
 3711 0172 488BB560 		movq	-1184(%rbp), %rsi
 3711      FBFFFF
 3712 0179 488B8568 		movq	-1176(%rbp), %rax
 3712      FBFFFF
 3713 0180 4989F8   		movq	%rdi, %r8
 3714 0183 4889C7   		movq	%rax, %rdi
 3715 0186 E8000000 		call	mbedtls_rsa_private
 3715      00
GAS LISTING /tmp/cc6OITWc.s 			page 105


 3716              	.L293:
1364:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****           ? mbedtls_rsa_public(  ctx, input, buf )
 3717              		.loc 1 1364 9
 3718 018b 898580FB 		movl	%eax, -1152(%rbp)
 3718      FFFF
1367:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1368:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ret != 0 )
 3719              		.loc 1 1368 7
 3720 0191 83BD80FB 		cmpl	$0, -1152(%rbp)
 3720      FFFF00
 3721 0198 0F856D03 		jne	.L308
 3721      0000
1369:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto cleanup;
1370:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1371:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
1372:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * Unmask data and generate lHash
1373:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
1374:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_md_init( &md_ctx );
 3722              		.loc 1 1374 5
 3723 019e 488D85B0 		leaq	-1104(%rbp), %rax
 3723      FBFFFF
 3724 01a5 4889C7   		movq	%rax, %rdi
 3725 01a8 E8000000 		call	mbedtls_md_init@PLT
 3725      00
1375:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = mbedtls_md_setup( &md_ctx, md_info, 0 ) ) != 0 )
 3726              		.loc 1 1375 17
 3727 01ad 488B8DA8 		movq	-1112(%rbp), %rcx
 3727      FBFFFF
 3728 01b4 488D85B0 		leaq	-1104(%rbp), %rax
 3728      FBFFFF
 3729 01bb BA000000 		movl	$0, %edx
 3729      00
 3730 01c0 4889CE   		movq	%rcx, %rsi
 3731 01c3 4889C7   		movq	%rax, %rdi
 3732 01c6 E8000000 		call	mbedtls_md_setup@PLT
 3732      00
 3733 01cb 898580FB 		movl	%eax, -1152(%rbp)
 3733      FFFF
 3734              		.loc 1 1375 7
 3735 01d1 83BD80FB 		cmpl	$0, -1152(%rbp)
 3735      FFFF00
 3736 01d8 7414     		je	.L296
1376:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
1377:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_md_free( &md_ctx );
 3737              		.loc 1 1377 9
 3738 01da 488D85B0 		leaq	-1104(%rbp), %rax
 3738      FBFFFF
 3739 01e1 4889C7   		movq	%rax, %rdi
 3740 01e4 E8000000 		call	mbedtls_md_free@PLT
 3740      00
1378:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto cleanup;
 3741              		.loc 1 1378 9
 3742 01e9 E9210300 		jmp	.L295
 3742      00
 3743              	.L296:
1379:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
1380:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
GAS LISTING /tmp/cc6OITWc.s 			page 106


1381:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* seed: Apply seedMask to maskedSeed */
1382:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = mgf_mask( buf + 1, hlen, buf + hlen + 1, ilen - hlen - 1,
 3744              		.loc 1 1382 63
 3745 01ee 8B8584FB 		movl	-1148(%rbp), %eax
 3745      FFFF
 3746 01f4 488B95A0 		movq	-1120(%rbp), %rdx
 3746      FBFFFF
 3747 01fb 4829C2   		subq	%rax, %rdx
 3748 01fe 4889D0   		movq	%rdx, %rax
 3749              		.loc 1 1382 17
 3750 0201 488D48FF 		leaq	-1(%rax), %rcx
 3751              		.loc 1 1382 53
 3752 0205 8B8584FB 		movl	-1148(%rbp), %eax
 3752      FFFF
 3753 020b 488D5001 		leaq	1(%rax), %rdx
 3754              		.loc 1 1382 17
 3755 020f 488D85F0 		leaq	-1040(%rbp), %rax
 3755      FBFFFF
 3756 0216 4801C2   		addq	%rax, %rdx
 3757 0219 8BB584FB 		movl	-1148(%rbp), %esi
 3757      FFFF
 3758 021f 488D85F0 		leaq	-1040(%rbp), %rax
 3758      FBFFFF
 3759 0226 4883C001 		addq	$1, %rax
 3760 022a 488DBDB0 		leaq	-1104(%rbp), %rdi
 3760      FBFFFF
 3761 0231 4989F8   		movq	%rdi, %r8
 3762 0234 4889C7   		movq	%rax, %rdi
 3763 0237 E8000000 		call	mgf_mask
 3763      00
 3764 023c 898580FB 		movl	%eax, -1152(%rbp)
 3764      FFFF
 3765              		.loc 1 1382 7
 3766 0242 83BD80FB 		cmpl	$0, -1152(%rbp)
 3766      FFFF00
 3767 0249 7560     		jne	.L297
1383:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                           &md_ctx ) ) != 0 ||
1384:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* DB: Apply dbMask to maskedDB */
1385:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ( ret = mgf_mask( buf + hlen + 1, ilen - hlen - 1, buf + 1, hlen,
 3768              		.loc 1 1385 17
 3769 024b 8B9584FB 		movl	-1148(%rbp), %edx
 3769      FFFF
 3770 0251 488D85F0 		leaq	-1040(%rbp), %rax
 3770      FBFFFF
 3771 0258 4883C001 		addq	$1, %rax
 3772              		.loc 1 1385 48
 3773 025c 8B8D84FB 		movl	-1148(%rbp), %ecx
 3773      FFFF
 3774 0262 488BB5A0 		movq	-1120(%rbp), %rsi
 3774      FBFFFF
 3775 0269 4829CE   		subq	%rcx, %rsi
 3776 026c 4889F1   		movq	%rsi, %rcx
 3777              		.loc 1 1385 17
 3778 026f 488D71FF 		leaq	-1(%rcx), %rsi
 3779              		.loc 1 1385 38
 3780 0273 8B8D84FB 		movl	-1148(%rbp), %ecx
 3780      FFFF
GAS LISTING /tmp/cc6OITWc.s 			page 107


 3781 0279 488D7901 		leaq	1(%rcx), %rdi
 3782              		.loc 1 1385 17
 3783 027d 488D8DF0 		leaq	-1040(%rbp), %rcx
 3783      FBFFFF
 3784 0284 4801CF   		addq	%rcx, %rdi
 3785 0287 488D8DB0 		leaq	-1104(%rbp), %rcx
 3785      FBFFFF
 3786 028e 4989C8   		movq	%rcx, %r8
 3787 0291 4889D1   		movq	%rdx, %rcx
 3788 0294 4889C2   		movq	%rax, %rdx
 3789 0297 E8000000 		call	mgf_mask
 3789      00
 3790 029c 898580FB 		movl	%eax, -1152(%rbp)
 3790      FFFF
1383:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                           &md_ctx ) ) != 0 ||
 3791              		.loc 1 1383 44
 3792 02a2 83BD80FB 		cmpl	$0, -1152(%rbp)
 3792      FFFF00
 3793 02a9 7414     		je	.L298
 3794              	.L297:
1386:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                           &md_ctx ) ) != 0 )
1387:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
1388:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_md_free( &md_ctx );
 3795              		.loc 1 1388 9
 3796 02ab 488D85B0 		leaq	-1104(%rbp), %rax
 3796      FBFFFF
 3797 02b2 4889C7   		movq	%rax, %rdi
 3798 02b5 E8000000 		call	mbedtls_md_free@PLT
 3798      00
1389:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto cleanup;
 3799              		.loc 1 1389 9
 3800 02ba E9500200 		jmp	.L295
 3800      00
 3801              	.L298:
1390:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
1391:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1392:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_md_free( &md_ctx );
 3802              		.loc 1 1392 5
 3803 02bf 488D85B0 		leaq	-1104(%rbp), %rax
 3803      FBFFFF
 3804 02c6 4889C7   		movq	%rax, %rdi
 3805 02c9 E8000000 		call	mbedtls_md_free@PLT
 3805      00
1393:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1394:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Generate lHash */
1395:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = mbedtls_md( md_info, label, label_len, lhash ) ) != 0 )
 3806              		.loc 1 1395 17
 3807 02ce 488D8DD0 		leaq	-1072(%rbp), %rcx
 3807      FBFFFF
 3808 02d5 488B9540 		movq	-1216(%rbp), %rdx
 3808      FBFFFF
 3809 02dc 488BB548 		movq	-1208(%rbp), %rsi
 3809      FBFFFF
 3810 02e3 488B85A8 		movq	-1112(%rbp), %rax
 3810      FBFFFF
 3811 02ea 4889C7   		movq	%rax, %rdi
 3812 02ed E8000000 		call	mbedtls_md@PLT
GAS LISTING /tmp/cc6OITWc.s 			page 108


 3812      00
 3813 02f2 898580FB 		movl	%eax, -1152(%rbp)
 3813      FFFF
 3814              		.loc 1 1395 7
 3815 02f8 83BD80FB 		cmpl	$0, -1152(%rbp)
 3815      FFFF00
 3816 02ff 0F850902 		jne	.L309
 3816      0000
1396:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto cleanup;
1397:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1398:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
1399:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * Check contents, in "constant-time"
1400:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
1401:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     p = buf;
 3817              		.loc 1 1401 7
 3818 0305 488D85F0 		leaq	-1040(%rbp), %rax
 3818      FBFFFF
 3819 030c 48898598 		movq	%rax, -1128(%rbp)
 3819      FBFFFF
1402:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     bad = 0;
 3820              		.loc 1 1402 9
 3821 0313 C6857EFB 		movb	$0, -1154(%rbp)
 3821      FFFF00
1403:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1404:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     bad |= *p++; /* First byte must be 0 */
 3822              		.loc 1 1404 14
 3823 031a 488B8598 		movq	-1128(%rbp), %rax
 3823      FBFFFF
 3824 0321 488D5001 		leaq	1(%rax), %rdx
 3825 0325 48899598 		movq	%rdx, -1128(%rbp)
 3825      FBFFFF
 3826              		.loc 1 1404 12
 3827 032c 0FB600   		movzbl	(%rax), %eax
 3828              		.loc 1 1404 9
 3829 032f 08857EFB 		orb	%al, -1154(%rbp)
 3829      FFFF
1405:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1406:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     p += hlen; /* Skip seed */
 3830              		.loc 1 1406 7
 3831 0335 8B8584FB 		movl	-1148(%rbp), %eax
 3831      FFFF
 3832 033b 48018598 		addq	%rax, -1128(%rbp)
 3832      FBFFFF
1407:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1408:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Check lHash */
1409:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     for( i = 0; i < hlen; i++ )
 3833              		.loc 1 1409 12
 3834 0342 48C78588 		movq	$0, -1144(%rbp)
 3834      FBFFFF00 
 3834      000000
 3835              		.loc 1 1409 5
 3836 034d EB47     		jmp	.L300
 3837              	.L301:
1410:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         bad |= lhash[i] ^ *p++;
 3838              		.loc 1 1410 21 discriminator 3
 3839 034f 488D95D0 		leaq	-1072(%rbp), %rdx
 3839      FBFFFF
GAS LISTING /tmp/cc6OITWc.s 			page 109


 3840 0356 488B8588 		movq	-1144(%rbp), %rax
 3840      FBFFFF
 3841 035d 4801D0   		addq	%rdx, %rax
 3842 0360 0FB608   		movzbl	(%rax), %ecx
 3843              		.loc 1 1410 29 discriminator 3
 3844 0363 488B8598 		movq	-1128(%rbp), %rax
 3844      FBFFFF
 3845 036a 488D5001 		leaq	1(%rax), %rdx
 3846 036e 48899598 		movq	%rdx, -1128(%rbp)
 3846      FBFFFF
 3847              		.loc 1 1410 27 discriminator 3
 3848 0375 0FB600   		movzbl	(%rax), %eax
 3849              		.loc 1 1410 25 discriminator 3
 3850 0378 31C8     		xorl	%ecx, %eax
 3851 037a 0FB6C0   		movzbl	%al, %eax
 3852              		.loc 1 1410 13 discriminator 3
 3853 037d 89C2     		movl	%eax, %edx
 3854 037f 0FB6857E 		movzbl	-1154(%rbp), %eax
 3854      FBFFFF
 3855 0386 09D0     		orl	%edx, %eax
 3856 0388 88857EFB 		movb	%al, -1154(%rbp)
 3856      FFFF
1409:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         bad |= lhash[i] ^ *p++;
 3857              		.loc 1 1409 28 discriminator 3
 3858 038e 48838588 		addq	$1, -1144(%rbp)
 3858      FBFFFF01 
 3859              	.L300:
1409:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         bad |= lhash[i] ^ *p++;
 3860              		.loc 1 1409 19 discriminator 1
 3861 0396 8B8584FB 		movl	-1148(%rbp), %eax
 3861      FFFF
1409:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         bad |= lhash[i] ^ *p++;
 3862              		.loc 1 1409 5 discriminator 1
 3863 039c 48398588 		cmpq	%rax, -1144(%rbp)
 3863      FBFFFF
 3864 03a3 72AA     		jb	.L301
1411:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1412:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Get zero-padding len, but always read till end of buffer
1413:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * (minus one, for the 01 byte) */
1414:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     pad_len = 0;
 3865              		.loc 1 1414 13
 3866 03a5 48C78590 		movq	$0, -1136(%rbp)
 3866      FBFFFF00 
 3866      000000
1415:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     pad_done = 0;
 3867              		.loc 1 1415 14
 3868 03b0 C6857FFB 		movb	$0, -1153(%rbp)
 3868      FFFF00
1416:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     for( i = 0; i < ilen - 2 * hlen - 2; i++ )
 3869              		.loc 1 1416 12
 3870 03b7 48C78588 		movq	$0, -1144(%rbp)
 3870      FBFFFF00 
 3870      000000
 3871              		.loc 1 1416 5
 3872 03c2 EB41     		jmp	.L302
 3873              	.L303:
1417:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
GAS LISTING /tmp/cc6OITWc.s 			page 110


1418:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         pad_done |= p[i];
 3874              		.loc 1 1418 22 discriminator 3
 3875 03c4 488B9598 		movq	-1128(%rbp), %rdx
 3875      FBFFFF
 3876 03cb 488B8588 		movq	-1144(%rbp), %rax
 3876      FBFFFF
 3877 03d2 4801D0   		addq	%rdx, %rax
 3878 03d5 0FB600   		movzbl	(%rax), %eax
 3879              		.loc 1 1418 18 discriminator 3
 3880 03d8 08857FFB 		orb	%al, -1153(%rbp)
 3880      FFFF
1419:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         pad_len += ((pad_done | (unsigned char)-pad_done) >> 7) ^ 1;
 3881              		.loc 1 1419 33 discriminator 3
 3882 03de 0FB6857F 		movzbl	-1153(%rbp), %eax
 3882      FBFFFF
 3883 03e5 F7D8     		negl	%eax
 3884              		.loc 1 1419 65 discriminator 3
 3885 03e7 0A857FFB 		orb	-1153(%rbp), %al
 3885      FFFF
 3886 03ed C0E807   		shrb	$7, %al
 3887 03f0 83F001   		xorl	$1, %eax
 3888 03f3 0FB6C0   		movzbl	%al, %eax
 3889              		.loc 1 1419 17 discriminator 3
 3890 03f6 48018590 		addq	%rax, -1136(%rbp)
 3890      FBFFFF
1416:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     for( i = 0; i < ilen - 2 * hlen - 2; i++ )
 3891              		.loc 1 1416 43 discriminator 3
 3892 03fd 48838588 		addq	$1, -1144(%rbp)
 3892      FBFFFF01 
 3893              	.L302:
1416:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     for( i = 0; i < ilen - 2 * hlen - 2; i++ )
 3894              		.loc 1 1416 30 discriminator 1
 3895 0405 8B8584FB 		movl	-1148(%rbp), %eax
 3895      FFFF
 3896 040b 01C0     		addl	%eax, %eax
 3897 040d 89C2     		movl	%eax, %edx
1416:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     for( i = 0; i < ilen - 2 * hlen - 2; i++ )
 3898              		.loc 1 1416 26 discriminator 1
 3899 040f 488B85A0 		movq	-1120(%rbp), %rax
 3899      FBFFFF
 3900 0416 4829D0   		subq	%rdx, %rax
1416:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     for( i = 0; i < ilen - 2 * hlen - 2; i++ )
 3901              		.loc 1 1416 37 discriminator 1
 3902 0419 4883E802 		subq	$2, %rax
1416:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     for( i = 0; i < ilen - 2 * hlen - 2; i++ )
 3903              		.loc 1 1416 5 discriminator 1
 3904 041d 48398588 		cmpq	%rax, -1144(%rbp)
 3904      FBFFFF
 3905 0424 729E     		jb	.L303
1420:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
1421:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1422:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     p += pad_len;
 3906              		.loc 1 1422 7
 3907 0426 488B8590 		movq	-1136(%rbp), %rax
 3907      FBFFFF
 3908 042d 48018598 		addq	%rax, -1128(%rbp)
 3908      FBFFFF
GAS LISTING /tmp/cc6OITWc.s 			page 111


1423:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     bad |= *p++ ^ 0x01;
 3909              		.loc 1 1423 14
 3910 0434 488B8598 		movq	-1128(%rbp), %rax
 3910      FBFFFF
 3911 043b 488D5001 		leaq	1(%rax), %rdx
 3912 043f 48899598 		movq	%rdx, -1128(%rbp)
 3912      FBFFFF
 3913              		.loc 1 1423 12
 3914 0446 0FB600   		movzbl	(%rax), %eax
 3915              		.loc 1 1423 17
 3916 0449 83F001   		xorl	$1, %eax
 3917 044c 0FB6C0   		movzbl	%al, %eax
 3918              		.loc 1 1423 9
 3919 044f 89C2     		movl	%eax, %edx
 3920 0451 0FB6857E 		movzbl	-1154(%rbp), %eax
 3920      FBFFFF
 3921 0458 09D0     		orl	%edx, %eax
 3922 045a 88857EFB 		movb	%al, -1154(%rbp)
 3922      FFFF
1424:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1425:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
1426:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * The only information "leaked" is whether the padding was correct or not
1427:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * (eg, no data is copied if it was not correct). This meets the
1428:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * recommendations in PKCS#1 v2.2: an opponent cannot distinguish between
1429:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * the different error conditions.
1430:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
1431:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( bad != 0 )
 3923              		.loc 1 1431 7
 3924 0460 80BD7EFB 		cmpb	$0, -1154(%rbp)
 3924      FFFF00
 3925 0467 740F     		je	.L304
1432:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
1433:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ret = MBEDTLS_ERR_RSA_INVALID_PADDING;
 3926              		.loc 1 1433 13
 3927 0469 C78580FB 		movl	$-16640, -1152(%rbp)
 3927      FFFF00BF 
 3927      FFFF
1434:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto cleanup;
 3928              		.loc 1 1434 9
 3929 0473 E9970000 		jmp	.L295
 3929      00
 3930              	.L304:
1435:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
1436:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1437:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ilen - ( p - buf ) > output_max_len )
 3931              		.loc 1 1437 20
 3932 0478 488D85F0 		leaq	-1040(%rbp), %rax
 3932      FBFFFF
 3933 047f 488B9598 		movq	-1128(%rbp), %rdx
 3933      FBFFFF
 3934 0486 4829C2   		subq	%rax, %rdx
 3935 0489 4889D0   		movq	%rdx, %rax
 3936 048c 4889C2   		movq	%rax, %rdx
 3937              		.loc 1 1437 14
 3938 048f 488B85A0 		movq	-1120(%rbp), %rax
 3938      FBFFFF
 3939 0496 4829D0   		subq	%rdx, %rax
GAS LISTING /tmp/cc6OITWc.s 			page 112


 3940              		.loc 1 1437 7
 3941 0499 48398520 		cmpq	%rax, -1248(%rbp)
 3941      FBFFFF
 3942 04a0 730C     		jnb	.L305
1438:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
1439:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ret = MBEDTLS_ERR_RSA_OUTPUT_TOO_LARGE;
 3943              		.loc 1 1439 13
 3944 04a2 C78580FB 		movl	$-17408, -1152(%rbp)
 3944      FFFF00BC 
 3944      FFFF
1440:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto cleanup;
 3945              		.loc 1 1440 9
 3946 04ac EB61     		jmp	.L295
 3947              	.L305:
1441:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
1442:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1443:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     *olen = ilen - (p - buf);
 3948              		.loc 1 1443 23
 3949 04ae 488D85F0 		leaq	-1040(%rbp), %rax
 3949      FBFFFF
 3950 04b5 488B9598 		movq	-1128(%rbp), %rdx
 3950      FBFFFF
 3951 04bc 4829C2   		subq	%rax, %rdx
 3952 04bf 4889D0   		movq	%rdx, %rax
 3953 04c2 4889C2   		movq	%rax, %rdx
 3954              		.loc 1 1443 18
 3955 04c5 488B85A0 		movq	-1120(%rbp), %rax
 3955      FBFFFF
 3956 04cc 4829D0   		subq	%rdx, %rax
 3957 04cf 4889C2   		movq	%rax, %rdx
 3958              		.loc 1 1443 11
 3959 04d2 488B8538 		movq	-1224(%rbp), %rax
 3959      FBFFFF
 3960 04d9 488910   		movq	%rdx, (%rax)
1444:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     memcpy( output, p, *olen );
 3961              		.loc 1 1444 5
 3962 04dc 488B8538 		movq	-1224(%rbp), %rax
 3962      FBFFFF
 3963 04e3 488B10   		movq	(%rax), %rdx
 3964 04e6 488B8D98 		movq	-1128(%rbp), %rcx
 3964      FBFFFF
 3965 04ed 488B8528 		movq	-1240(%rbp), %rax
 3965      FBFFFF
 3966 04f4 4889CE   		movq	%rcx, %rsi
 3967 04f7 4889C7   		movq	%rax, %rdi
 3968 04fa E8000000 		call	memcpy@PLT
 3968      00
1445:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     ret = 0;
 3969              		.loc 1 1445 9
 3970 04ff C78580FB 		movl	$0, -1152(%rbp)
 3970      FFFF0000 
 3970      0000
 3971 0509 EB04     		jmp	.L295
 3972              	.L308:
1369:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 3973              		.loc 1 1369 9
 3974 050b 90       		nop
GAS LISTING /tmp/cc6OITWc.s 			page 113


 3975 050c EB01     		jmp	.L295
 3976              	.L309:
1396:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 3977              		.loc 1 1396 9
 3978 050e 90       		nop
 3979              	.L295:
1446:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1447:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** cleanup:
1448:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_platform_zeroize( buf, sizeof( buf ) );
 3980              		.loc 1 1448 5
 3981 050f 488D85F0 		leaq	-1040(%rbp), %rax
 3981      FBFFFF
 3982 0516 BE000400 		movl	$1024, %esi
 3982      00
 3983 051b 4889C7   		movq	%rax, %rdi
 3984 051e E8000000 		call	mbedtls_platform_zeroize@PLT
 3984      00
1449:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_platform_zeroize( lhash, sizeof( lhash ) );
 3985              		.loc 1 1449 5
 3986 0523 488D85D0 		leaq	-1072(%rbp), %rax
 3986      FBFFFF
 3987 052a BE200000 		movl	$32, %esi
 3987      00
 3988 052f 4889C7   		movq	%rax, %rdi
 3989 0532 E8000000 		call	mbedtls_platform_zeroize@PLT
 3989      00
1450:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1451:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( ret );
 3990              		.loc 1 1451 11
 3991 0537 8B8580FB 		movl	-1152(%rbp), %eax
 3991      FFFF
 3992              	.L306:
1452:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 3993              		.loc 1 1452 1 discriminator 1
 3994 053d 488B75F8 		movq	-8(%rbp), %rsi
 3995 0541 64483334 		xorq	%fs:40, %rsi
 3995      25280000 
 3995      00
 3996 054a 7405     		je	.L307
 3997              		.loc 1 1452 1 is_stmt 0
 3998 054c E8000000 		call	__stack_chk_fail@PLT
 3998      00
 3999              	.L307:
 4000 0551 C9       		leave
 4001              	.LCFI65:
 4002              		.cfi_def_cfa 7, 8
 4003 0552 C3       		ret
 4004              		.cfi_endproc
 4005              	.LFE37:
 4007              		.section	.text.all_or_nothing_int,"ax",@progbits
 4009              	all_or_nothing_int:
 4010              	.LFB38:
1453:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif /* MBEDTLS_PKCS1_V21 */
1454:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1455:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_PKCS1_V15)
1456:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /** Turn zero-or-nonzero into zero-or-all-bits-one, without branches.
1457:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
GAS LISTING /tmp/cc6OITWc.s 			page 114


1458:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * \param value     The value to analyze.
1459:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * \return          Zero if \p value is zero, otherwise all-bits-one.
1460:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
1461:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** static unsigned all_or_nothing_int( unsigned value )
1462:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 4011              		.loc 1 1462 1 is_stmt 1
 4012              		.cfi_startproc
 4013 0000 F30F1EFA 		endbr64
 4014 0004 55       		pushq	%rbp
 4015              	.LCFI66:
 4016              		.cfi_def_cfa_offset 16
 4017              		.cfi_offset 6, -16
 4018 0005 4889E5   		movq	%rsp, %rbp
 4019              	.LCFI67:
 4020              		.cfi_def_cfa_register 6
 4021 0008 4883EC20 		subq	$32, %rsp
 4022 000c 897DEC   		movl	%edi, -20(%rbp)
 4023              		.loc 1 1462 1
 4024 000f 64488B04 		movq	%fs:40, %rax
 4024      25280000 
 4024      00
 4025 0018 488945F8 		movq	%rax, -8(%rbp)
 4026 001c 31C0     		xorl	%eax, %eax
1463:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* MSVC has a warning about unary minus on unsigned, but this is
1464:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * well-defined and precisely what we want to do here */
1465:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(_MSC_VER)
1466:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #pragma warning( push )
1467:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #pragma warning( disable : 4146 )
1468:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
1469:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( - ( ( value | - value ) >> ( sizeof( value ) * 8 - 1 ) ) );
 4027              		.loc 1 1469 27
 4028 001e 8B45EC   		movl	-20(%rbp), %eax
 4029 0021 F7D8     		negl	%eax
 4030              		.loc 1 1469 25
 4031 0023 0B45EC   		orl	-20(%rbp), %eax
 4032              		.loc 1 1469 13
 4033 0026 C1F81F   		sarl	$31, %eax
1470:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(_MSC_VER)
1471:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #pragma warning( pop )
1472:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
1473:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 4034              		.loc 1 1473 1
 4035 0029 488B55F8 		movq	-8(%rbp), %rdx
 4036 002d 64483314 		xorq	%fs:40, %rdx
 4036      25280000 
 4036      00
 4037 0036 7405     		je	.L312
 4038 0038 E8000000 		call	__stack_chk_fail@PLT
 4038      00
 4039              	.L312:
 4040 003d C9       		leave
 4041              	.LCFI68:
 4042              		.cfi_def_cfa 7, 8
 4043 003e C3       		ret
 4044              		.cfi_endproc
 4045              	.LFE38:
 4047              		.section	.text.size_greater_than,"ax",@progbits
GAS LISTING /tmp/cc6OITWc.s 			page 115


 4049              	size_greater_than:
 4050              	.LFB39:
1474:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1475:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /** Check whether a size is out of bounds, without branches.
1476:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
1477:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * This is equivalent to `size > max`, but is likely to be compiled to
1478:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * to code using bitwise operation rather than a branch.
1479:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
1480:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * \param size      Size to check.
1481:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * \param max       Maximum desired value for \p size.
1482:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * \return          \c 0 if `size <= max`.
1483:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * \return          \c 1 if `size > max`.
1484:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
1485:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** static unsigned size_greater_than( size_t size, size_t max )
1486:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 4051              		.loc 1 1486 1
 4052              		.cfi_startproc
 4053 0000 F30F1EFA 		endbr64
 4054 0004 55       		pushq	%rbp
 4055              	.LCFI69:
 4056              		.cfi_def_cfa_offset 16
 4057              		.cfi_offset 6, -16
 4058 0005 4889E5   		movq	%rsp, %rbp
 4059              	.LCFI70:
 4060              		.cfi_def_cfa_register 6
 4061 0008 4883EC20 		subq	$32, %rsp
 4062 000c 48897DE8 		movq	%rdi, -24(%rbp)
 4063 0010 488975E0 		movq	%rsi, -32(%rbp)
 4064              		.loc 1 1486 1
 4065 0014 64488B04 		movq	%fs:40, %rax
 4065      25280000 
 4065      00
 4066 001d 488945F8 		movq	%rax, -8(%rbp)
 4067 0021 31C0     		xorl	%eax, %eax
1487:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Return the sign bit (1 for negative) of (max - size). */
1488:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( ( max - size ) >> ( sizeof( size_t ) * 8 - 1 ) );
 4068              		.loc 1 1488 19
 4069 0023 488B45E0 		movq	-32(%rbp), %rax
 4070 0027 482B45E8 		subq	-24(%rbp), %rax
 4071              		.loc 1 1488 28
 4072 002b 48C1E83F 		shrq	$63, %rax
1489:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 4073              		.loc 1 1489 1
 4074 002f 488B55F8 		movq	-8(%rbp), %rdx
 4075 0033 64483314 		xorq	%fs:40, %rdx
 4075      25280000 
 4075      00
 4076 003c 7405     		je	.L315
 4077 003e E8000000 		call	__stack_chk_fail@PLT
 4077      00
 4078              	.L315:
 4079 0043 C9       		leave
 4080              	.LCFI71:
 4081              		.cfi_def_cfa 7, 8
 4082 0044 C3       		ret
 4083              		.cfi_endproc
 4084              	.LFE39:
GAS LISTING /tmp/cc6OITWc.s 			page 116


 4086              		.section	.text.if_int,"ax",@progbits
 4088              	if_int:
 4089              	.LFB40:
1490:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1491:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /** Choose between two integer values, without branches.
1492:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
1493:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * This is equivalent to `cond ? if1 : if0`, but is likely to be compiled
1494:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * to code using bitwise operation rather than a branch.
1495:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
1496:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * \param cond      Condition to test.
1497:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * \param if1       Value to use if \p cond is nonzero.
1498:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * \param if0       Value to use if \p cond is zero.
1499:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * \return          \c if1 if \p cond is nonzero, otherwise \c if0.
1500:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
1501:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** static unsigned if_int( unsigned cond, unsigned if1, unsigned if0 )
1502:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 4090              		.loc 1 1502 1
 4091              		.cfi_startproc
 4092 0000 F30F1EFA 		endbr64
 4093 0004 55       		pushq	%rbp
 4094              	.LCFI72:
 4095              		.cfi_def_cfa_offset 16
 4096              		.cfi_offset 6, -16
 4097 0005 4889E5   		movq	%rsp, %rbp
 4098              	.LCFI73:
 4099              		.cfi_def_cfa_register 6
 4100 0008 4883EC20 		subq	$32, %rsp
 4101 000c 897DEC   		movl	%edi, -20(%rbp)
 4102 000f 8975E8   		movl	%esi, -24(%rbp)
 4103 0012 8955E4   		movl	%edx, -28(%rbp)
 4104              		.loc 1 1502 1
 4105 0015 64488B04 		movq	%fs:40, %rax
 4105      25280000 
 4105      00
 4106 001e 488945F8 		movq	%rax, -8(%rbp)
 4107 0022 31C0     		xorl	%eax, %eax
1503:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned mask = all_or_nothing_int( cond );
 4108              		.loc 1 1503 21
 4109 0024 8B45EC   		movl	-20(%rbp), %eax
 4110 0027 89C7     		movl	%eax, %edi
 4111 0029 E8000000 		call	all_or_nothing_int
 4111      00
 4112 002e 8945F4   		movl	%eax, -12(%rbp)
1504:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( ( mask & if1 ) | (~mask & if0 ) );
 4113              		.loc 1 1504 20
 4114 0031 8B45F4   		movl	-12(%rbp), %eax
 4115 0034 2345E8   		andl	-24(%rbp), %eax
 4116 0037 89C2     		movl	%eax, %edx
 4117              		.loc 1 1504 31
 4118 0039 8B45F4   		movl	-12(%rbp), %eax
 4119 003c F7D0     		notl	%eax
 4120              		.loc 1 1504 37
 4121 003e 2345E4   		andl	-28(%rbp), %eax
 4122              		.loc 1 1504 28
 4123 0041 09D0     		orl	%edx, %eax
1505:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 4124              		.loc 1 1505 1
GAS LISTING /tmp/cc6OITWc.s 			page 117


 4125 0043 488B4DF8 		movq	-8(%rbp), %rcx
 4126 0047 6448330C 		xorq	%fs:40, %rcx
 4126      25280000 
 4126      00
 4127 0050 7405     		je	.L318
 4128 0052 E8000000 		call	__stack_chk_fail@PLT
 4128      00
 4129              	.L318:
 4130 0057 C9       		leave
 4131              	.LCFI74:
 4132              		.cfi_def_cfa 7, 8
 4133 0058 C3       		ret
 4134              		.cfi_endproc
 4135              	.LFE40:
 4137              		.section	.text.mem_move_to_left,"ax",@progbits
 4139              	mem_move_to_left:
 4140              	.LFB41:
1506:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1507:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /** Shift some data towards the left inside a buffer without leaking
1508:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * the length of the data through side channels.
1509:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
1510:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * `mem_move_to_left(start, total, offset)` is functionally equivalent to
1511:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * ```
1512:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * memmove(start, start + offset, total - offset);
1513:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * memset(start + offset, 0, total - offset);
1514:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * ```
1515:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * but it strives to use a memory access pattern (and thus total timing)
1516:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * that does not depend on \p offset. This timing independence comes at
1517:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * the expense of performance.
1518:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
1519:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * \param start     Pointer to the start of the buffer.
1520:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * \param total     Total size of the buffer.
1521:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * \param offset    Offset from which to copy \p total - \p offset bytes.
1522:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
1523:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** static void mem_move_to_left( void *start,
1524:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                               size_t total,
1525:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                               size_t offset )
1526:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 4141              		.loc 1 1526 1
 4142              		.cfi_startproc
 4143 0000 F30F1EFA 		endbr64
 4144 0004 55       		pushq	%rbp
 4145              	.LCFI75:
 4146              		.cfi_def_cfa_offset 16
 4147              		.cfi_offset 6, -16
 4148 0005 4889E5   		movq	%rsp, %rbp
 4149              	.LCFI76:
 4150              		.cfi_def_cfa_register 6
 4151 0008 4883EC50 		subq	$80, %rsp
 4152 000c 48897DC8 		movq	%rdi, -56(%rbp)
 4153 0010 488975C0 		movq	%rsi, -64(%rbp)
 4154 0014 488955B8 		movq	%rdx, -72(%rbp)
 4155              		.loc 1 1526 1
 4156 0018 64488B04 		movq	%fs:40, %rax
 4156      25280000 
 4156      00
 4157 0021 488945F8 		movq	%rax, -8(%rbp)
GAS LISTING /tmp/cc6OITWc.s 			page 118


 4158 0025 31C0     		xorl	%eax, %eax
1527:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     volatile unsigned char *buf = start;
 4159              		.loc 1 1527 29
 4160 0027 488B45C8 		movq	-56(%rbp), %rax
 4161 002b 488945F0 		movq	%rax, -16(%rbp)
1528:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     size_t i, n;
1529:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( total == 0 )
 4162              		.loc 1 1529 7
 4163 002f 48837DC0 		cmpq	$0, -64(%rbp)
 4163      00
 4164 0034 0F84DF00 		je	.L327
 4164      0000
1530:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return;
1531:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     for( i = 0; i < total; i++ )
 4165              		.loc 1 1531 12
 4166 003a 48C745E0 		movq	$0, -32(%rbp)
 4166      00000000 
 4167              		.loc 1 1531 5
 4168 0042 E9C20000 		jmp	.L322
 4168      00
 4169              	.L325:
 4170              	.LBB3:
1532:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
1533:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         unsigned no_op = size_greater_than( total - offset, i );
 4171              		.loc 1 1533 26
 4172 0047 488B45C0 		movq	-64(%rbp), %rax
 4173 004b 482B45B8 		subq	-72(%rbp), %rax
 4174 004f 488B55E0 		movq	-32(%rbp), %rdx
 4175 0053 4889D6   		movq	%rdx, %rsi
 4176 0056 4889C7   		movq	%rax, %rdi
 4177 0059 E8000000 		call	size_greater_than
 4177      00
 4178 005e 8945DC   		movl	%eax, -36(%rbp)
1534:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /* The first `total - offset` passes are a no-op. The last
1535:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          * `offset` passes shift the data one byte to the left and
1536:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          * zero out the last byte. */
1537:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         for( n = 0; n < total - 1; n++ )
 4179              		.loc 1 1537 16
 4180 0061 48C745E8 		movq	$0, -24(%rbp)
 4180      00000000 
 4181              		.loc 1 1537 9
 4182 0069 EB50     		jmp	.L323
 4183              	.L324:
 4184              	.LBB4:
1538:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         {
1539:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             unsigned char current = buf[n];
 4185              		.loc 1 1539 40 discriminator 3
 4186 006b 488B55F0 		movq	-16(%rbp), %rdx
 4187 006f 488B45E8 		movq	-24(%rbp), %rax
 4188 0073 4801D0   		addq	%rdx, %rax
 4189              		.loc 1 1539 27 discriminator 3
 4190 0076 0FB600   		movzbl	(%rax), %eax
 4191 0079 8845DA   		movb	%al, -38(%rbp)
1540:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             unsigned char next = buf[n+1];
 4192              		.loc 1 1540 37 discriminator 3
 4193 007c 488B45E8 		movq	-24(%rbp), %rax
 4194 0080 488D5001 		leaq	1(%rax), %rdx
GAS LISTING /tmp/cc6OITWc.s 			page 119


 4195 0084 488B45F0 		movq	-16(%rbp), %rax
 4196 0088 4801D0   		addq	%rdx, %rax
 4197              		.loc 1 1540 27 discriminator 3
 4198 008b 0FB600   		movzbl	(%rax), %eax
 4199 008e 8845DB   		movb	%al, -37(%rbp)
1541:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             buf[n] = if_int( no_op, current, next );
 4200              		.loc 1 1541 22 discriminator 3
 4201 0091 0FB655DB 		movzbl	-37(%rbp), %edx
 4202 0095 0FB64DDA 		movzbl	-38(%rbp), %ecx
 4203 0099 8B45DC   		movl	-36(%rbp), %eax
 4204 009c 89CE     		movl	%ecx, %esi
 4205 009e 89C7     		movl	%eax, %edi
 4206 00a0 E8000000 		call	if_int
 4206      00
 4207 00a5 89C1     		movl	%eax, %ecx
 4208              		.loc 1 1541 16 discriminator 3
 4209 00a7 488B55F0 		movq	-16(%rbp), %rdx
 4210 00ab 488B45E8 		movq	-24(%rbp), %rax
 4211 00af 4801D0   		addq	%rdx, %rax
 4212              		.loc 1 1541 20 discriminator 3
 4213 00b2 89CA     		movl	%ecx, %edx
 4214 00b4 8810     		movb	%dl, (%rax)
 4215              	.LBE4:
1537:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         {
 4216              		.loc 1 1537 37 discriminator 3
 4217 00b6 488345E8 		addq	$1, -24(%rbp)
 4217      01
 4218              	.L323:
1537:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         {
 4219              		.loc 1 1537 31 discriminator 1
 4220 00bb 488B45C0 		movq	-64(%rbp), %rax
 4221 00bf 4883E801 		subq	$1, %rax
1537:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         {
 4222              		.loc 1 1537 9 discriminator 1
 4223 00c3 483945E8 		cmpq	%rax, -24(%rbp)
 4224 00c7 72A2     		jb	.L324
1542:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         }
1543:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         buf[total-1] = if_int( no_op, buf[total-1], 0 );
 4225              		.loc 1 1543 42 discriminator 2
 4226 00c9 488B45C0 		movq	-64(%rbp), %rax
 4227 00cd 488D50FF 		leaq	-1(%rax), %rdx
 4228 00d1 488B45F0 		movq	-16(%rbp), %rax
 4229 00d5 4801D0   		addq	%rdx, %rax
 4230 00d8 0FB600   		movzbl	(%rax), %eax
 4231              		.loc 1 1543 24 discriminator 2
 4232 00db 0FB6C8   		movzbl	%al, %ecx
 4233 00de 8B45DC   		movl	-36(%rbp), %eax
 4234 00e1 BA000000 		movl	$0, %edx
 4234      00
 4235 00e6 89CE     		movl	%ecx, %esi
 4236 00e8 89C7     		movl	%eax, %edi
 4237 00ea E8000000 		call	if_int
 4237      00
 4238 00ef 89C1     		movl	%eax, %ecx
 4239              		.loc 1 1543 12 discriminator 2
 4240 00f1 488B45C0 		movq	-64(%rbp), %rax
 4241 00f5 488D50FF 		leaq	-1(%rax), %rdx
GAS LISTING /tmp/cc6OITWc.s 			page 120


 4242 00f9 488B45F0 		movq	-16(%rbp), %rax
 4243 00fd 4801D0   		addq	%rdx, %rax
 4244              		.loc 1 1543 22 discriminator 2
 4245 0100 89CA     		movl	%ecx, %edx
 4246 0102 8810     		movb	%dl, (%rax)
 4247              	.LBE3:
1531:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 4248              		.loc 1 1531 29 discriminator 2
 4249 0104 488345E0 		addq	$1, -32(%rbp)
 4249      01
 4250              	.L322:
1531:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
 4251              		.loc 1 1531 5 discriminator 1
 4252 0109 488B45E0 		movq	-32(%rbp), %rax
 4253 010d 483B45C0 		cmpq	-64(%rbp), %rax
 4254 0111 0F8230FF 		jb	.L325
 4254      FFFF
 4255 0117 EB01     		jmp	.L319
 4256              	.L327:
1530:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     for( i = 0; i < total; i++ )
 4257              		.loc 1 1530 9
 4258 0119 90       		nop
 4259              	.L319:
1544:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
1545:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 4260              		.loc 1 1545 1
 4261 011a 488B45F8 		movq	-8(%rbp), %rax
 4262 011e 64483304 		xorq	%fs:40, %rax
 4262      25280000 
 4262      00
 4263 0127 7405     		je	.L326
 4264 0129 E8000000 		call	__stack_chk_fail@PLT
 4264      00
 4265              	.L326:
 4266 012e C9       		leave
 4267              	.LCFI77:
 4268              		.cfi_def_cfa 7, 8
 4269 012f C3       		ret
 4270              		.cfi_endproc
 4271              	.LFE41:
 4273              		.section	.text.mbedtls_rsa_rsaes_pkcs1_v15_decrypt,"ax",@progbits
 4274              		.globl	mbedtls_rsa_rsaes_pkcs1_v15_decrypt
 4276              	mbedtls_rsa_rsaes_pkcs1_v15_decrypt:
 4277              	.LFB42:
1546:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1547:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
1548:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Implementation of the PKCS#1 v2.1 RSAES-PKCS1-V1_5-DECRYPT function
1549:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
1550:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_rsaes_pkcs1_v15_decrypt( mbedtls_rsa_context *ctx,
1551:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                  int (*f_rng)(void *, unsigned char *, size_t),
1552:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                  void *p_rng,
1553:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                  int mode, size_t *olen,
1554:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                  const unsigned char *input,
1555:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                  unsigned char *output,
1556:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                  size_t output_max_len )
1557:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 4278              		.loc 1 1557 1
GAS LISTING /tmp/cc6OITWc.s 			page 121


 4279              		.cfi_startproc
 4280 0000 F30F1EFA 		endbr64
 4281 0004 55       		pushq	%rbp
 4282              	.LCFI78:
 4283              		.cfi_def_cfa_offset 16
 4284              		.cfi_offset 6, -16
 4285 0005 4889E5   		movq	%rsp, %rbp
 4286              	.LCFI79:
 4287              		.cfi_def_cfa_register 6
 4288 0008 4881EC90 		subq	$1168, %rsp
 4288      040000
 4289 000f 4889BDA8 		movq	%rdi, -1112(%rbp)
 4289      FBFFFF
 4290 0016 4889B5A0 		movq	%rsi, -1120(%rbp)
 4290      FBFFFF
 4291 001d 48899598 		movq	%rdx, -1128(%rbp)
 4291      FBFFFF
 4292 0024 898D94FB 		movl	%ecx, -1132(%rbp)
 4292      FFFF
 4293 002a 4C898588 		movq	%r8, -1144(%rbp)
 4293      FBFFFF
 4294 0031 4C898D80 		movq	%r9, -1152(%rbp)
 4294      FBFFFF
 4295 0038 488B4510 		movq	16(%rbp), %rax
 4296 003c 48898578 		movq	%rax, -1160(%rbp)
 4296      FBFFFF
 4297 0043 488B4518 		movq	24(%rbp), %rax
 4298 0047 48898570 		movq	%rax, -1168(%rbp)
 4298      FBFFFF
 4299              		.loc 1 1557 1
 4300 004e 64488B04 		movq	%fs:40, %rax
 4300      25280000 
 4300      00
 4301 0057 488945F8 		movq	%rax, -8(%rbp)
 4302 005b 31C0     		xorl	%eax, %eax
1558:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int ret;
1559:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     size_t ilen, i, plaintext_max_size;
1560:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned char buf[MBEDTLS_MPI_MAX_SIZE];
1561:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* The following variables take sensitive values: their value must
1562:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * not leak into the observable behavior of the function other than
1563:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * the designated outputs (output, olen, return value). Otherwise
1564:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * this would open the execution of the function to
1565:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * side-channel-based variants of the Bleichenbacher padding oracle
1566:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * attack. Potential side channels include overall timing, memory
1567:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * access patterns (especially visible to an adversary who has access
1568:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * to a shared memory cache), and branches (especially visible to
1569:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * an adversary who has access to a shared code cache or to a shared
1570:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * branch predictor). */
1571:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     size_t pad_count = 0;
 4303              		.loc 1 1571 12
 4304 005d 48C785D0 		movq	$0, -1072(%rbp)
 4304      FBFFFF00 
 4304      000000
1572:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned bad = 0;
 4305              		.loc 1 1572 14
 4306 0068 C785C0FB 		movl	$0, -1088(%rbp)
 4306      FFFF0000 
GAS LISTING /tmp/cc6OITWc.s 			page 122


 4306      0000
1573:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned char pad_done = 0;
 4307              		.loc 1 1573 19
 4308 0072 C685BBFB 		movb	$0, -1093(%rbp)
 4308      FFFF00
1574:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     size_t plaintext_size = 0;
 4309              		.loc 1 1574 12
 4310 0079 48C785D8 		movq	$0, -1064(%rbp)
 4310      FBFFFF00 
 4310      000000
1575:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned output_too_large;
1576:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1577:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
1578:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( mode == MBEDTLS_RSA_PRIVATE ||
1579:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       mode == MBEDTLS_RSA_PUBLIC );
1580:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( output_max_len == 0 || output != NULL );
1581:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( input != NULL );
1582:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( olen != NULL );
1583:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1584:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     ilen = ctx->len;
 4311              		.loc 1 1584 10
 4312 0084 488B85A8 		movq	-1112(%rbp), %rax
 4312      FBFFFF
 4313 008b 488B4008 		movq	8(%rax), %rax
 4314 008f 488985E0 		movq	%rax, -1056(%rbp)
 4314      FBFFFF
1585:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     plaintext_max_size = ( output_max_len > ilen - 11 ?
 4315              		.loc 1 1585 50
 4316 0096 488B85E0 		movq	-1056(%rbp), %rax
 4316      FBFFFF
 4317 009d 4883E80B 		subq	$11, %rax
 4318              		.loc 1 1585 24
 4319 00a1 48398570 		cmpq	%rax, -1168(%rbp)
 4319      FBFFFF
 4320 00a8 480F4685 		cmovbe	-1168(%rbp), %rax
 4320      70FBFFFF 
 4321 00b0 488985E8 		movq	%rax, -1048(%rbp)
 4321      FBFFFF
1586:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                            ilen - 11 :
1587:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                            output_max_len );
1588:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1589:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mode == MBEDTLS_RSA_PRIVATE && ctx->padding != MBEDTLS_RSA_PKCS_V15 )
 4322              		.loc 1 1589 7
 4323 00b7 83BD94FB 		cmpl	$1, -1132(%rbp)
 4323      FFFF01
 4324 00be 751B     		jne	.L329
 4325              		.loc 1 1589 43 discriminator 1
 4326 00c0 488B85A8 		movq	-1112(%rbp), %rax
 4326      FBFFFF
 4327 00c7 8B804801 		movl	328(%rax), %eax
 4327      0000
 4328              		.loc 1 1589 37 discriminator 1
 4329 00cd 85C0     		testl	%eax, %eax
 4330 00cf 740A     		je	.L329
1590:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 4331              		.loc 1 1590 15
 4332 00d1 B880BFFF 		movl	$-16512, %eax
GAS LISTING /tmp/cc6OITWc.s 			page 123


 4332      FF
 4333 00d6 E9F40300 		jmp	.L345
 4333      00
 4334              	.L329:
1591:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1592:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ilen < 16 || ilen > sizeof( buf ) )
 4335              		.loc 1 1592 7
 4336 00db 4883BDE0 		cmpq	$15, -1056(%rbp)
 4336      FBFFFF0F 
 4337 00e3 760D     		jbe	.L331
 4338              		.loc 1 1592 19 discriminator 1
 4339 00e5 4881BDE0 		cmpq	$1024, -1056(%rbp)
 4339      FBFFFF00 
 4339      040000
 4340 00f0 760A     		jbe	.L332
 4341              	.L331:
1593:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 4342              		.loc 1 1593 15
 4343 00f2 B880BFFF 		movl	$-16512, %eax
 4343      FF
 4344 00f7 E9D30300 		jmp	.L345
 4344      00
 4345              	.L332:
1594:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1595:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     ret = ( mode == MBEDTLS_RSA_PUBLIC )
1596:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****           ? mbedtls_rsa_public(  ctx, input, buf )
1597:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****           : mbedtls_rsa_private( ctx, f_rng, p_rng, input, buf );
 4346              		.loc 1 1597 11
 4347 00fc 83BD94FB 		cmpl	$0, -1132(%rbp)
 4347      FFFF00
 4348 0103 7522     		jne	.L333
1596:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****           : mbedtls_rsa_private( ctx, f_rng, p_rng, input, buf );
 4349              		.loc 1 1596 13
 4350 0105 488D95F0 		leaq	-1040(%rbp), %rdx
 4350      FBFFFF
 4351 010c 488B8D80 		movq	-1152(%rbp), %rcx
 4351      FBFFFF
 4352 0113 488B85A8 		movq	-1112(%rbp), %rax
 4352      FBFFFF
 4353 011a 4889CE   		movq	%rcx, %rsi
 4354 011d 4889C7   		movq	%rax, %rdi
 4355 0120 E8000000 		call	mbedtls_rsa_public
 4355      00
 4356 0125 EB2E     		jmp	.L334
 4357              	.L333:
 4358              		.loc 1 1597 13 discriminator 1
 4359 0127 488DBDF0 		leaq	-1040(%rbp), %rdi
 4359      FBFFFF
 4360 012e 488B8D80 		movq	-1152(%rbp), %rcx
 4360      FBFFFF
 4361 0135 488B9598 		movq	-1128(%rbp), %rdx
 4361      FBFFFF
 4362 013c 488BB5A0 		movq	-1120(%rbp), %rsi
 4362      FBFFFF
 4363 0143 488B85A8 		movq	-1112(%rbp), %rax
 4363      FBFFFF
 4364 014a 4989F8   		movq	%rdi, %r8
GAS LISTING /tmp/cc6OITWc.s 			page 124


 4365 014d 4889C7   		movq	%rax, %rdi
 4366 0150 E8000000 		call	mbedtls_rsa_private
 4366      00
 4367              	.L334:
1595:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****           ? mbedtls_rsa_public(  ctx, input, buf )
 4368              		.loc 1 1595 9
 4369 0155 8985BCFB 		movl	%eax, -1092(%rbp)
 4369      FFFF
1598:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1599:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ret != 0 )
 4370              		.loc 1 1599 7
 4371 015b 83BDBCFB 		cmpl	$0, -1092(%rbp)
 4371      FFFF00
 4372 0162 0F854C03 		jne	.L347
 4372      0000
1600:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto cleanup;
1601:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1602:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Check and get padding length in constant time and constant
1603:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * memory trace. The first byte must be 0. */
1604:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     bad |= buf[0];
 4373              		.loc 1 1604 15
 4374 0168 0FB685F0 		movzbl	-1040(%rbp), %eax
 4374      FBFFFF
 4375 016f 0FB6C0   		movzbl	%al, %eax
 4376              		.loc 1 1604 9
 4377 0172 0985C0FB 		orl	%eax, -1088(%rbp)
 4377      FFFF
1605:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1606:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mode == MBEDTLS_RSA_PRIVATE )
 4378              		.loc 1 1606 7
 4379 0178 83BD94FB 		cmpl	$1, -1132(%rbp)
 4379      FFFF01
 4380 017f 0F859400 		jne	.L337
 4380      0000
1607:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
1608:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /* Decode EME-PKCS1-v1_5 padding: 0x00 || 0x02 || PS || 0x00
1609:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          * where PS must be at least 8 nonzero bytes. */
1610:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         bad |= buf[1] ^ MBEDTLS_RSA_CRYPT;
 4381              		.loc 1 1610 19
 4382 0185 0FB685F1 		movzbl	-1039(%rbp), %eax
 4382      FBFFFF
 4383              		.loc 1 1610 23
 4384 018c 83F002   		xorl	$2, %eax
 4385 018f 0FB6C0   		movzbl	%al, %eax
 4386              		.loc 1 1610 13
 4387 0192 0985C0FB 		orl	%eax, -1088(%rbp)
 4387      FFFF
1611:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1612:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /* Read the whole buffer. Set pad_done to nonzero if we find
1613:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          * the 0x00 byte and remember the padding length in pad_count. */
1614:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         for( i = 2; i < ilen; i++ )
 4388              		.loc 1 1614 16
 4389 0198 48C785C8 		movq	$2, -1080(%rbp)
 4389      FBFFFF02 
 4389      000000
 4390              		.loc 1 1614 9
 4391 01a3 EB5F     		jmp	.L338
GAS LISTING /tmp/cc6OITWc.s 			page 125


 4392              	.L339:
1615:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         {
1616:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             pad_done  |= ((buf[i] | (unsigned char)-buf[i]) >> 7) ^ 1;
 4393              		.loc 1 1616 31 discriminator 3
 4394 01a5 488D95F0 		leaq	-1040(%rbp), %rdx
 4394      FBFFFF
 4395 01ac 488B85C8 		movq	-1080(%rbp), %rax
 4395      FBFFFF
 4396 01b3 4801D0   		addq	%rdx, %rax
 4397 01b6 0FB608   		movzbl	(%rax), %ecx
 4398              		.loc 1 1616 56 discriminator 3
 4399 01b9 488D95F0 		leaq	-1040(%rbp), %rdx
 4399      FBFFFF
 4400 01c0 488B85C8 		movq	-1080(%rbp), %rax
 4400      FBFFFF
 4401 01c7 4801D0   		addq	%rdx, %rax
 4402 01ca 0FB600   		movzbl	(%rax), %eax
 4403              		.loc 1 1616 37 discriminator 3
 4404 01cd F7D8     		negl	%eax
 4405              		.loc 1 1616 23 discriminator 3
 4406 01cf 09C8     		orl	%ecx, %eax
 4407 01d1 C0E807   		shrb	$7, %al
 4408 01d4 83F001   		xorl	$1, %eax
 4409 01d7 0885BBFB 		orb	%al, -1093(%rbp)
 4409      FFFF
1617:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             pad_count += ((pad_done | (unsigned char)-pad_done) >> 7) ^ 1;
 4410              		.loc 1 1617 39 discriminator 3
 4411 01dd 0FB685BB 		movzbl	-1093(%rbp), %eax
 4411      FBFFFF
 4412 01e4 F7D8     		negl	%eax
 4413              		.loc 1 1617 71 discriminator 3
 4414 01e6 0A85BBFB 		orb	-1093(%rbp), %al
 4414      FFFF
 4415 01ec C0E807   		shrb	$7, %al
 4416 01ef 83F001   		xorl	$1, %eax
 4417 01f2 0FB6C0   		movzbl	%al, %eax
 4418              		.loc 1 1617 23 discriminator 3
 4419 01f5 480185D0 		addq	%rax, -1072(%rbp)
 4419      FBFFFF
1614:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         {
 4420              		.loc 1 1614 32 discriminator 3
 4421 01fc 488385C8 		addq	$1, -1080(%rbp)
 4421      FBFFFF01 
 4422              	.L338:
1614:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         {
 4423              		.loc 1 1614 9 discriminator 1
 4424 0204 488B85C8 		movq	-1080(%rbp), %rax
 4424      FBFFFF
 4425 020b 483B85E0 		cmpq	-1056(%rbp), %rax
 4425      FBFFFF
 4426 0212 7291     		jb	.L339
 4427 0214 E9C00000 		jmp	.L340
 4427      00
 4428              	.L337:
1618:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         }
1619:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
1620:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     else
GAS LISTING /tmp/cc6OITWc.s 			page 126


1621:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
1622:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /* Decode EMSA-PKCS1-v1_5 padding: 0x00 || 0x01 || PS || 0x00
1623:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          * where PS must be at least 8 bytes with the value 0xFF. */
1624:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         bad |= buf[1] ^ MBEDTLS_RSA_SIGN;
 4429              		.loc 1 1624 19
 4430 0219 0FB685F1 		movzbl	-1039(%rbp), %eax
 4430      FBFFFF
 4431              		.loc 1 1624 23
 4432 0220 83F001   		xorl	$1, %eax
 4433 0223 0FB6C0   		movzbl	%al, %eax
 4434              		.loc 1 1624 13
 4435 0226 0985C0FB 		orl	%eax, -1088(%rbp)
 4435      FFFF
1625:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1626:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /* Read the whole buffer. Set pad_done to nonzero if we find
1627:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          * the 0x00 byte and remember the padding length in pad_count.
1628:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          * If there's a non-0xff byte in the padding, the padding is bad. */
1629:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         for( i = 2; i < ilen; i++ )
 4436              		.loc 1 1629 16
 4437 022c 48C785C8 		movq	$2, -1080(%rbp)
 4437      FBFFFF02 
 4437      000000
 4438              		.loc 1 1629 9
 4439 0237 E9890000 		jmp	.L341
 4439      00
 4440              	.L342:
1630:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         {
1631:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             pad_done |= if_int( buf[i], 0, 1 );
 4441              		.loc 1 1631 36 discriminator 3
 4442 023c 488D95F0 		leaq	-1040(%rbp), %rdx
 4442      FBFFFF
 4443 0243 488B85C8 		movq	-1080(%rbp), %rax
 4443      FBFFFF
 4444 024a 4801D0   		addq	%rdx, %rax
 4445 024d 0FB600   		movzbl	(%rax), %eax
 4446              		.loc 1 1631 25 discriminator 3
 4447 0250 0FB6C0   		movzbl	%al, %eax
 4448 0253 BA010000 		movl	$1, %edx
 4448      00
 4449 0258 BE000000 		movl	$0, %esi
 4449      00
 4450 025d 89C7     		movl	%eax, %edi
 4451 025f E8000000 		call	if_int
 4451      00
 4452              		.loc 1 1631 22 discriminator 3
 4453 0264 0885BBFB 		orb	%al, -1093(%rbp)
 4453      FFFF
1632:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             pad_count += if_int( pad_done, 0, 1 );
 4454              		.loc 1 1632 26 discriminator 3
 4455 026a 0FB685BB 		movzbl	-1093(%rbp), %eax
 4455      FBFFFF
 4456 0271 BA010000 		movl	$1, %edx
 4456      00
 4457 0276 BE000000 		movl	$0, %esi
 4457      00
 4458 027b 89C7     		movl	%eax, %edi
 4459 027d E8000000 		call	if_int
GAS LISTING /tmp/cc6OITWc.s 			page 127


 4459      00
 4460 0282 89C0     		movl	%eax, %eax
 4461              		.loc 1 1632 23 discriminator 3
 4462 0284 480185D0 		addq	%rax, -1072(%rbp)
 4462      FBFFFF
1633:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             bad |= if_int( pad_done, 0, buf[i] ^ 0xFF );
 4463              		.loc 1 1633 44 discriminator 3
 4464 028b 488D95F0 		leaq	-1040(%rbp), %rdx
 4464      FBFFFF
 4465 0292 488B85C8 		movq	-1080(%rbp), %rax
 4465      FBFFFF
 4466 0299 4801D0   		addq	%rdx, %rax
 4467 029c 0FB600   		movzbl	(%rax), %eax
 4468              		.loc 1 1633 20 discriminator 3
 4469 029f F7D0     		notl	%eax
 4470 02a1 0FB6D0   		movzbl	%al, %edx
 4471 02a4 0FB685BB 		movzbl	-1093(%rbp), %eax
 4471      FBFFFF
 4472 02ab BE000000 		movl	$0, %esi
 4472      00
 4473 02b0 89C7     		movl	%eax, %edi
 4474 02b2 E8000000 		call	if_int
 4474      00
 4475              		.loc 1 1633 17 discriminator 3
 4476 02b7 0985C0FB 		orl	%eax, -1088(%rbp)
 4476      FFFF
1629:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         {
 4477              		.loc 1 1629 32 discriminator 3
 4478 02bd 488385C8 		addq	$1, -1080(%rbp)
 4478      FBFFFF01 
 4479              	.L341:
1629:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         {
 4480              		.loc 1 1629 9 discriminator 1
 4481 02c5 488B85C8 		movq	-1080(%rbp), %rax
 4481      FBFFFF
 4482 02cc 483B85E0 		cmpq	-1056(%rbp), %rax
 4482      FBFFFF
 4483 02d3 0F8263FF 		jb	.L342
 4483      FFFF
 4484              	.L340:
1634:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         }
1635:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
1636:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1637:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* If pad_done is still zero, there's no data, only unfinished padding. */
1638:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     bad |= if_int( pad_done, 0, 1 );
 4485              		.loc 1 1638 12
 4486 02d9 0FB685BB 		movzbl	-1093(%rbp), %eax
 4486      FBFFFF
 4487 02e0 BA010000 		movl	$1, %edx
 4487      00
 4488 02e5 BE000000 		movl	$0, %esi
 4488      00
 4489 02ea 89C7     		movl	%eax, %edi
 4490 02ec E8000000 		call	if_int
 4490      00
 4491              		.loc 1 1638 9
 4492 02f1 0985C0FB 		orl	%eax, -1088(%rbp)
GAS LISTING /tmp/cc6OITWc.s 			page 128


 4492      FFFF
1639:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1640:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* There must be at least 8 bytes of padding. */
1641:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     bad |= size_greater_than( 8, pad_count );
 4493              		.loc 1 1641 12
 4494 02f7 488B85D0 		movq	-1072(%rbp), %rax
 4494      FBFFFF
 4495 02fe 4889C6   		movq	%rax, %rsi
 4496 0301 BF080000 		movl	$8, %edi
 4496      00
 4497 0306 E8000000 		call	size_greater_than
 4497      00
 4498              		.loc 1 1641 9
 4499 030b 0985C0FB 		orl	%eax, -1088(%rbp)
 4499      FFFF
1642:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1643:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* If the padding is valid, set plaintext_size to the number of
1644:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * remaining bytes after stripping the padding. If the padding
1645:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * is invalid, avoid leaking this fact through the size of the
1646:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * output: use the maximum message size that fits in the output
1647:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * buffer. Do it without branches to avoid leaking the padding
1648:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * validity through timing. RSA keys are small enough that all the
1649:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * size_t values involved fit in unsigned int. */
1650:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     plaintext_size = if_int( bad,
1651:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                              (unsigned) plaintext_max_size,
1652:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                              (unsigned) ( ilen - pad_count - 3 ) );
 4500              		.loc 1 1652 48
 4501 0311 488B85E0 		movq	-1056(%rbp), %rax
 4501      FBFFFF
 4502 0318 89C2     		movl	%eax, %edx
 4503 031a 488B85D0 		movq	-1072(%rbp), %rax
 4503      FBFFFF
 4504 0321 29C2     		subl	%eax, %edx
 4505 0323 89D0     		movl	%edx, %eax
1650:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                              (unsigned) plaintext_max_size,
 4506              		.loc 1 1650 22
 4507 0325 8D50FD   		leal	-3(%rax), %edx
 4508 0328 488B85E8 		movq	-1048(%rbp), %rax
 4508      FBFFFF
 4509 032f 89C1     		movl	%eax, %ecx
 4510 0331 8B85C0FB 		movl	-1088(%rbp), %eax
 4510      FFFF
 4511 0337 89CE     		movl	%ecx, %esi
 4512 0339 89C7     		movl	%eax, %edi
 4513 033b E8000000 		call	if_int
 4513      00
1650:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                              (unsigned) plaintext_max_size,
 4514              		.loc 1 1650 20
 4515 0340 89C0     		movl	%eax, %eax
 4516 0342 488985D8 		movq	%rax, -1064(%rbp)
 4516      FBFFFF
1653:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1654:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Set output_too_large to 0 if the plaintext fits in the output
1655:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * buffer and to 1 otherwise. */
1656:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     output_too_large = size_greater_than( plaintext_size,
 4517              		.loc 1 1656 24
 4518 0349 488B95E8 		movq	-1048(%rbp), %rdx
GAS LISTING /tmp/cc6OITWc.s 			page 129


 4518      FBFFFF
 4519 0350 488B85D8 		movq	-1064(%rbp), %rax
 4519      FBFFFF
 4520 0357 4889D6   		movq	%rdx, %rsi
 4521 035a 4889C7   		movq	%rax, %rdi
 4522 035d E8000000 		call	size_greater_than
 4522      00
 4523 0362 8985C4FB 		movl	%eax, -1084(%rbp)
 4523      FFFF
1657:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                           plaintext_max_size );
1658:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1659:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Set ret without branches to avoid timing attacks. Return:
1660:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * - INVALID_PADDING if the padding is bad (bad != 0).
1661:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * - OUTPUT_TOO_LARGE if the padding is good but the decrypted
1662:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      *   plaintext does not fit in the output buffer.
1663:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * - 0 if the padding is correct. */
1664:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     ret = - (int) if_int( bad, - MBEDTLS_ERR_RSA_INVALID_PADDING,
 4524              		.loc 1 1664 19
 4525 0368 8B85C4FB 		movl	-1084(%rbp), %eax
 4525      FFFF
 4526 036e BA000000 		movl	$0, %edx
 4526      00
 4527 0373 BE004400 		movl	$17408, %esi
 4527      00
 4528 0378 89C7     		movl	%eax, %edi
 4529 037a E8000000 		call	if_int
 4529      00
 4530 037f 89C2     		movl	%eax, %edx
 4531 0381 8B85C0FB 		movl	-1088(%rbp), %eax
 4531      FFFF
 4532 0387 BE004100 		movl	$16640, %esi
 4532      00
 4533 038c 89C7     		movl	%eax, %edi
 4534 038e E8000000 		call	if_int
 4534      00
 4535              		.loc 1 1664 9
 4536 0393 F7D8     		negl	%eax
 4537 0395 8985BCFB 		movl	%eax, -1092(%rbp)
 4537      FFFF
1665:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                   if_int( output_too_large, - MBEDTLS_ERR_RSA_OUTPUT_TOO_LARGE,
1666:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                           0 ) );
1667:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1668:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* If the padding is bad or the plaintext is too large, zero the
1669:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * data that we're about to copy to the output buffer.
1670:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * We need to copy the same amount of data
1671:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * from the same buffer whether the padding is good or not to
1672:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * avoid leaking the padding validity through overall timing or
1673:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * through memory or cache access patterns. */
1674:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     bad = all_or_nothing_int( bad | output_too_large );
 4538              		.loc 1 1674 11
 4539 039b 8B85C0FB 		movl	-1088(%rbp), %eax
 4539      FFFF
 4540 03a1 0B85C4FB 		orl	-1084(%rbp), %eax
 4540      FFFF
 4541 03a7 89C7     		movl	%eax, %edi
 4542 03a9 E8000000 		call	all_or_nothing_int
 4542      00
GAS LISTING /tmp/cc6OITWc.s 			page 130


 4543 03ae 8985C0FB 		movl	%eax, -1088(%rbp)
 4543      FFFF
1675:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     for( i = 11; i < ilen; i++ )
 4544              		.loc 1 1675 12
 4545 03b4 48C785C8 		movq	$11, -1080(%rbp)
 4545      FBFFFF0B 
 4545      000000
 4546              		.loc 1 1675 5
 4547 03bf EB39     		jmp	.L343
 4548              	.L344:
1676:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         buf[i] &= ~bad;
 4549              		.loc 1 1676 16 discriminator 3
 4550 03c1 488D95F0 		leaq	-1040(%rbp), %rdx
 4550      FBFFFF
 4551 03c8 488B85C8 		movq	-1080(%rbp), %rax
 4551      FBFFFF
 4552 03cf 4801D0   		addq	%rdx, %rax
 4553 03d2 0FB600   		movzbl	(%rax), %eax
 4554 03d5 8B95C0FB 		movl	-1088(%rbp), %edx
 4554      FFFF
 4555 03db F7D2     		notl	%edx
 4556 03dd 21C2     		andl	%eax, %edx
 4557 03df 488D8DF0 		leaq	-1040(%rbp), %rcx
 4557      FBFFFF
 4558 03e6 488B85C8 		movq	-1080(%rbp), %rax
 4558      FBFFFF
 4559 03ed 4801C8   		addq	%rcx, %rax
 4560 03f0 8810     		movb	%dl, (%rax)
1675:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     for( i = 11; i < ilen; i++ )
 4561              		.loc 1 1675 29 discriminator 3
 4562 03f2 488385C8 		addq	$1, -1080(%rbp)
 4562      FBFFFF01 
 4563              	.L343:
1675:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     for( i = 11; i < ilen; i++ )
 4564              		.loc 1 1675 5 discriminator 1
 4565 03fa 488B85C8 		movq	-1080(%rbp), %rax
 4565      FBFFFF
 4566 0401 483B85E0 		cmpq	-1056(%rbp), %rax
 4566      FBFFFF
 4567 0408 72B7     		jb	.L344
1677:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1678:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* If the plaintext is too large, truncate it to the buffer size.
1679:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * Copy anyway to avoid revealing the length through timing, because
1680:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * revealing the length is as bad as revealing the padding validity
1681:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * for a Bleichenbacher attack. */
1682:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     plaintext_size = if_int( output_too_large,
 4568              		.loc 1 1682 22
 4569 040a 488B85D8 		movq	-1064(%rbp), %rax
 4569      FBFFFF
 4570 0411 89C2     		movl	%eax, %edx
 4571 0413 488B85E8 		movq	-1048(%rbp), %rax
 4571      FBFFFF
 4572 041a 89C1     		movl	%eax, %ecx
 4573 041c 8B85C4FB 		movl	-1084(%rbp), %eax
 4573      FFFF
 4574 0422 89CE     		movl	%ecx, %esi
 4575 0424 89C7     		movl	%eax, %edi
GAS LISTING /tmp/cc6OITWc.s 			page 131


 4576 0426 E8000000 		call	if_int
 4576      00
 4577              		.loc 1 1682 20
 4578 042b 89C0     		movl	%eax, %eax
 4579 042d 488985D8 		movq	%rax, -1064(%rbp)
 4579      FBFFFF
1683:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                              (unsigned) plaintext_max_size,
1684:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                              (unsigned) plaintext_size );
1685:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1686:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Move the plaintext to the leftmost position where it can start in
1687:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * the working buffer, i.e. make it start plaintext_max_size from
1688:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * the end of the buffer. Do this with a memory access trace that
1689:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * does not depend on the plaintext size. After this move, the
1690:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * starting location of the plaintext is no longer sensitive
1691:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * information. */
1692:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mem_move_to_left( buf + ilen - plaintext_max_size,
 4580              		.loc 1 1692 5
 4581 0434 488B85E8 		movq	-1048(%rbp), %rax
 4581      FBFFFF
 4582 043b 482B85D8 		subq	-1064(%rbp), %rax
 4582      FBFFFF
 4583 0442 4889C2   		movq	%rax, %rdx
 4584              		.loc 1 1692 34
 4585 0445 488B85E0 		movq	-1056(%rbp), %rax
 4585      FBFFFF
 4586 044c 482B85E8 		subq	-1048(%rbp), %rax
 4586      FBFFFF
 4587              		.loc 1 1692 5
 4588 0453 488D8DF0 		leaq	-1040(%rbp), %rcx
 4588      FBFFFF
 4589 045a 4801C1   		addq	%rax, %rcx
 4590 045d 488B85E8 		movq	-1048(%rbp), %rax
 4590      FBFFFF
 4591 0464 4889C6   		movq	%rax, %rsi
 4592 0467 4889CF   		movq	%rcx, %rdi
 4593 046a E8000000 		call	mem_move_to_left
 4593      00
1693:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       plaintext_max_size,
1694:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       plaintext_max_size - plaintext_size );
1695:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1696:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Finally copy the decrypted plaintext plus trailing zeros
1697:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * into the output buffer. */
1698:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     memcpy( output, buf + ilen - plaintext_max_size, plaintext_max_size );
 4594              		.loc 1 1698 32
 4595 046f 488B85E0 		movq	-1056(%rbp), %rax
 4595      FBFFFF
 4596 0476 482B85E8 		subq	-1048(%rbp), %rax
 4596      FBFFFF
 4597              		.loc 1 1698 5
 4598 047d 488D95F0 		leaq	-1040(%rbp), %rdx
 4598      FBFFFF
 4599 0484 488D0C02 		leaq	(%rdx,%rax), %rcx
 4600 0488 488B95E8 		movq	-1048(%rbp), %rdx
 4600      FBFFFF
 4601 048f 488B8578 		movq	-1160(%rbp), %rax
 4601      FBFFFF
 4602 0496 4889CE   		movq	%rcx, %rsi
GAS LISTING /tmp/cc6OITWc.s 			page 132


 4603 0499 4889C7   		movq	%rax, %rdi
 4604 049c E8000000 		call	memcpy@PLT
 4604      00
1699:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1700:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Report the amount of data we copied to the output buffer. In case
1701:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * of errors (bad padding or output too large), the value of *olen
1702:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * when this function returns is not specified. Making it equivalent
1703:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * to the good case limits the risks of leaking the padding validity. */
1704:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     *olen = plaintext_size;
 4605              		.loc 1 1704 11
 4606 04a1 488B8588 		movq	-1144(%rbp), %rax
 4606      FBFFFF
 4607 04a8 488B95D8 		movq	-1064(%rbp), %rdx
 4607      FBFFFF
 4608 04af 488910   		movq	%rdx, (%rax)
 4609 04b2 EB01     		jmp	.L336
 4610              	.L347:
1600:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 4611              		.loc 1 1600 9
 4612 04b4 90       		nop
 4613              	.L336:
1705:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1706:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** cleanup:
1707:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_platform_zeroize( buf, sizeof( buf ) );
 4614              		.loc 1 1707 5
 4615 04b5 488D85F0 		leaq	-1040(%rbp), %rax
 4615      FBFFFF
 4616 04bc BE000400 		movl	$1024, %esi
 4616      00
 4617 04c1 4889C7   		movq	%rax, %rdi
 4618 04c4 E8000000 		call	mbedtls_platform_zeroize@PLT
 4618      00
1708:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1709:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( ret );
 4619              		.loc 1 1709 11
 4620 04c9 8B85BCFB 		movl	-1092(%rbp), %eax
 4620      FFFF
 4621              	.L345:
1710:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 4622              		.loc 1 1710 1 discriminator 1
 4623 04cf 488B75F8 		movq	-8(%rbp), %rsi
 4624 04d3 64483334 		xorq	%fs:40, %rsi
 4624      25280000 
 4624      00
 4625 04dc 7405     		je	.L346
 4626              		.loc 1 1710 1 is_stmt 0
 4627 04de E8000000 		call	__stack_chk_fail@PLT
 4627      00
 4628              	.L346:
 4629 04e3 C9       		leave
 4630              	.LCFI80:
 4631              		.cfi_def_cfa 7, 8
 4632 04e4 C3       		ret
 4633              		.cfi_endproc
 4634              	.LFE42:
 4636              		.section	.text.mbedtls_rsa_pkcs1_decrypt,"ax",@progbits
 4637              		.globl	mbedtls_rsa_pkcs1_decrypt
GAS LISTING /tmp/cc6OITWc.s 			page 133


 4639              	mbedtls_rsa_pkcs1_decrypt:
 4640              	.LFB43:
1711:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif /* MBEDTLS_PKCS1_V15 */
1712:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1713:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
1714:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Do an RSA operation, then remove the message padding
1715:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
1716:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_pkcs1_decrypt( mbedtls_rsa_context *ctx,
1717:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                        int (*f_rng)(void *, unsigned char *, size_t),
1718:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                        void *p_rng,
1719:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                        int mode, size_t *olen,
1720:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                        const unsigned char *input,
1721:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                        unsigned char *output,
1722:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                        size_t output_max_len)
1723:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 4641              		.loc 1 1723 1 is_stmt 1
 4642              		.cfi_startproc
 4643 0000 F30F1EFA 		endbr64
 4644 0004 55       		pushq	%rbp
 4645              	.LCFI81:
 4646              		.cfi_def_cfa_offset 16
 4647              		.cfi_offset 6, -16
 4648 0005 4889E5   		movq	%rsp, %rbp
 4649              	.LCFI82:
 4650              		.cfi_def_cfa_register 6
 4651 0008 4883EC50 		subq	$80, %rsp
 4652 000c 48897DE8 		movq	%rdi, -24(%rbp)
 4653 0010 488975E0 		movq	%rsi, -32(%rbp)
 4654 0014 488955D8 		movq	%rdx, -40(%rbp)
 4655 0018 894DD4   		movl	%ecx, -44(%rbp)
 4656 001b 4C8945C8 		movq	%r8, -56(%rbp)
 4657 001f 4C894DC0 		movq	%r9, -64(%rbp)
 4658 0023 488B4510 		movq	16(%rbp), %rax
 4659 0027 488945B8 		movq	%rax, -72(%rbp)
 4660 002b 488B4518 		movq	24(%rbp), %rax
 4661 002f 488945B0 		movq	%rax, -80(%rbp)
 4662              		.loc 1 1723 1
 4663 0033 64488B04 		movq	%fs:40, %rax
 4663      25280000 
 4663      00
 4664 003c 488945F8 		movq	%rax, -8(%rbp)
 4665 0040 31C0     		xorl	%eax, %eax
1724:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
1725:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( mode == MBEDTLS_RSA_PRIVATE ||
1726:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       mode == MBEDTLS_RSA_PUBLIC );
1727:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( output_max_len == 0 || output != NULL );
1728:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( input != NULL );
1729:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( olen != NULL );
1730:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1731:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     switch( ctx->padding )
 4666              		.loc 1 1731 16
 4667 0042 488B45E8 		movq	-24(%rbp), %rax
 4668 0046 8B804801 		movl	328(%rax), %eax
 4668      0000
 4669              		.loc 1 1731 5
 4670 004c 85C0     		testl	%eax, %eax
 4671 004e 7407     		je	.L349
GAS LISTING /tmp/cc6OITWc.s 			page 134


 4672 0050 83F801   		cmpl	$1, %eax
 4673 0053 7433     		je	.L350
 4674 0055 EB66     		jmp	.L354
 4675              	.L349:
1732:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
1733:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_PKCS1_V15)
1734:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         case MBEDTLS_RSA_PKCS_V15:
1735:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return mbedtls_rsa_rsaes_pkcs1_v15_decrypt( ctx, f_rng, p_rng, mode, olen,
 4676              		.loc 1 1735 20
 4677 0057 4C8B45C0 		movq	-64(%rbp), %r8
 4678 005b 488B7DC8 		movq	-56(%rbp), %rdi
 4679 005f 8B4DD4   		movl	-44(%rbp), %ecx
 4680 0062 488B55D8 		movq	-40(%rbp), %rdx
 4681 0066 488B75E0 		movq	-32(%rbp), %rsi
 4682 006a 488B45E8 		movq	-24(%rbp), %rax
 4683 006e FF75B0   		pushq	-80(%rbp)
 4684 0071 FF75B8   		pushq	-72(%rbp)
 4685 0074 4D89C1   		movq	%r8, %r9
 4686 0077 4989F8   		movq	%rdi, %r8
 4687 007a 4889C7   		movq	%rax, %rdi
 4688 007d E8000000 		call	mbedtls_rsa_rsaes_pkcs1_v15_decrypt
 4688      00
 4689 0082 4883C410 		addq	$16, %rsp
 4690 0086 EB3A     		jmp	.L352
 4691              	.L350:
1736:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                                 input, output, output_max_len );
1737:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
1738:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1739:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_PKCS1_V21)
1740:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         case MBEDTLS_RSA_PKCS_V21:
1741:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return mbedtls_rsa_rsaes_oaep_decrypt( ctx, f_rng, p_rng, mode, NULL, 0,
 4692              		.loc 1 1741 20
 4693 0088 8B4DD4   		movl	-44(%rbp), %ecx
 4694 008b 488B55D8 		movq	-40(%rbp), %rdx
 4695 008f 488B75E0 		movq	-32(%rbp), %rsi
 4696 0093 488B45E8 		movq	-24(%rbp), %rax
 4697 0097 FF75B0   		pushq	-80(%rbp)
 4698 009a FF75B8   		pushq	-72(%rbp)
 4699 009d FF75C0   		pushq	-64(%rbp)
 4700 00a0 FF75C8   		pushq	-56(%rbp)
 4701 00a3 41B90000 		movl	$0, %r9d
 4701      0000
 4702 00a9 41B80000 		movl	$0, %r8d
 4702      0000
 4703 00af 4889C7   		movq	%rax, %rdi
 4704 00b2 E8000000 		call	mbedtls_rsa_rsaes_oaep_decrypt
 4704      00
 4705 00b7 4883C420 		addq	$32, %rsp
 4706 00bb EB05     		jmp	.L352
 4707              	.L354:
1742:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                            olen, input, output,
1743:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                            output_max_len );
1744:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
1745:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1746:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         default:
1747:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return( MBEDTLS_ERR_RSA_INVALID_PADDING );
 4708              		.loc 1 1747 19
GAS LISTING /tmp/cc6OITWc.s 			page 135


 4709 00bd B800BFFF 		movl	$-16640, %eax
 4709      FF
 4710              	.L352:
1748:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
1749:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 4711              		.loc 1 1749 1
 4712 00c2 488B7DF8 		movq	-8(%rbp), %rdi
 4713 00c6 6448333C 		xorq	%fs:40, %rdi
 4713      25280000 
 4713      00
 4714 00cf 7405     		je	.L353
 4715 00d1 E8000000 		call	__stack_chk_fail@PLT
 4715      00
 4716              	.L353:
 4717 00d6 C9       		leave
 4718              	.LCFI83:
 4719              		.cfi_def_cfa 7, 8
 4720 00d7 C3       		ret
 4721              		.cfi_endproc
 4722              	.LFE43:
 4724              		.section	.text.mbedtls_rsa_rsassa_pss_sign,"ax",@progbits
 4725              		.globl	mbedtls_rsa_rsassa_pss_sign
 4727              	mbedtls_rsa_rsassa_pss_sign:
 4728              	.LFB44:
1750:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1751:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_PKCS1_V21)
1752:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
1753:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Implementation of the PKCS#1 v2.1 RSASSA-PSS-SIGN function
1754:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
1755:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_rsassa_pss_sign( mbedtls_rsa_context *ctx,
1756:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                          int (*f_rng)(void *, unsigned char *, size_t),
1757:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                          void *p_rng,
1758:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                          int mode,
1759:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                          mbedtls_md_type_t md_alg,
1760:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                          unsigned int hashlen,
1761:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                          const unsigned char *hash,
1762:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                          unsigned char *sig )
1763:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 4729              		.loc 1 1763 1
 4730              		.cfi_startproc
 4731 0000 F30F1EFA 		endbr64
 4732 0004 55       		pushq	%rbp
 4733              	.LCFI84:
 4734              		.cfi_def_cfa_offset 16
 4735              		.cfi_offset 6, -16
 4736 0005 4889E5   		movq	%rsp, %rbp
 4737              	.LCFI85:
 4738              		.cfi_def_cfa_register 6
 4739 0008 4881ECE0 		subq	$224, %rsp
 4739      000000
 4740 000f 4889BD58 		movq	%rdi, -168(%rbp)
 4740      FFFFFF
 4741 0016 4889B550 		movq	%rsi, -176(%rbp)
 4741      FFFFFF
 4742 001d 48899548 		movq	%rdx, -184(%rbp)
 4742      FFFFFF
 4743 0024 898D44FF 		movl	%ecx, -188(%rbp)
GAS LISTING /tmp/cc6OITWc.s 			page 136


 4743      FFFF
 4744 002a 44898540 		movl	%r8d, -192(%rbp)
 4744      FFFFFF
 4745 0031 44898D3C 		movl	%r9d, -196(%rbp)
 4745      FFFFFF
 4746 0038 488B4510 		movq	16(%rbp), %rax
 4747 003c 48898530 		movq	%rax, -208(%rbp)
 4747      FFFFFF
 4748 0043 488B4518 		movq	24(%rbp), %rax
 4749 0047 48898528 		movq	%rax, -216(%rbp)
 4749      FFFFFF
 4750              		.loc 1 1763 1
 4751 004e 64488B04 		movq	%fs:40, %rax
 4751      25280000 
 4751      00
 4752 0057 488945F8 		movq	%rax, -8(%rbp)
 4753 005b 31C0     		xorl	%eax, %eax
1764:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     size_t olen;
1765:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned char *p = sig;
 4754              		.loc 1 1765 20
 4755 005d 488B8528 		movq	-216(%rbp), %rax
 4755      FFFFFF
 4756 0064 48894580 		movq	%rax, -128(%rbp)
1766:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned char salt[MBEDTLS_MD_MAX_SIZE];
1767:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     size_t slen, min_slen, hlen, offset = 0;
 4757              		.loc 1 1767 34
 4758 0068 48C78578 		movq	$0, -136(%rbp)
 4758      FFFFFF00 
 4758      000000
1768:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int ret;
1769:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     size_t msb;
1770:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     const mbedtls_md_info_t *md_info;
1771:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_md_context_t md_ctx;
1772:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
1773:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( mode == MBEDTLS_RSA_PRIVATE ||
1774:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       mode == MBEDTLS_RSA_PUBLIC );
1775:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ( md_alg  == MBEDTLS_MD_NONE &&
1776:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                         hashlen == 0 ) ||
1777:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       hash != NULL );
1778:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( sig != NULL );
1779:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1780:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mode == MBEDTLS_RSA_PRIVATE && ctx->padding != MBEDTLS_RSA_PKCS_V21 )
 4759              		.loc 1 1780 7
 4760 0073 83BD44FF 		cmpl	$1, -188(%rbp)
 4760      FFFF01
 4761 007a 751C     		jne	.L356
 4762              		.loc 1 1780 43 discriminator 1
 4763 007c 488B8558 		movq	-168(%rbp), %rax
 4763      FFFFFF
 4764 0083 8B804801 		movl	328(%rax), %eax
 4764      0000
 4765              		.loc 1 1780 37 discriminator 1
 4766 0089 83F801   		cmpl	$1, %eax
 4767 008c 740A     		je	.L356
1781:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 4768              		.loc 1 1781 15
 4769 008e B880BFFF 		movl	$-16512, %eax
GAS LISTING /tmp/cc6OITWc.s 			page 137


 4769      FF
 4770 0093 E92C0400 		jmp	.L378
 4770      00
 4771              	.L356:
1782:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1783:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( f_rng == NULL )
 4772              		.loc 1 1783 7
 4773 0098 4883BD50 		cmpq	$0, -176(%rbp)
 4773      FFFFFF00 
 4774 00a0 750A     		jne	.L358
1784:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 4775              		.loc 1 1784 15
 4776 00a2 B880BFFF 		movl	$-16512, %eax
 4776      FF
 4777 00a7 E9180400 		jmp	.L378
 4777      00
 4778              	.L358:
1785:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1786:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     olen = ctx->len;
 4779              		.loc 1 1786 10
 4780 00ac 488B8558 		movq	-168(%rbp), %rax
 4780      FFFFFF
 4781 00b3 488B4008 		movq	8(%rax), %rax
 4782 00b7 48894588 		movq	%rax, -120(%rbp)
1787:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1788:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( md_alg != MBEDTLS_MD_NONE )
 4783              		.loc 1 1788 7
 4784 00bb 83BD40FF 		cmpl	$0, -192(%rbp)
 4784      FFFF00
 4785 00c2 7437     		je	.L359
1789:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
1790:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /* Gather length of hash to sign */
1791:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         md_info = mbedtls_md_info_from_type( md_alg );
 4786              		.loc 1 1791 19
 4787 00c4 8B8540FF 		movl	-192(%rbp), %eax
 4787      FFFF
 4788 00ca 89C7     		movl	%eax, %edi
 4789 00cc E8000000 		call	mbedtls_md_info_from_type@PLT
 4789      00
 4790 00d1 48894590 		movq	%rax, -112(%rbp)
1792:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( md_info == NULL )
 4791              		.loc 1 1792 11
 4792 00d5 48837D90 		cmpq	$0, -112(%rbp)
 4792      00
 4793 00da 750A     		jne	.L360
1793:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 4794              		.loc 1 1793 19
 4795 00dc B880BFFF 		movl	$-16512, %eax
 4795      FF
 4796 00e1 E9DE0300 		jmp	.L378
 4796      00
 4797              	.L360:
1794:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1795:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         hashlen = mbedtls_md_get_size( md_info );
 4798              		.loc 1 1795 19
 4799 00e6 488B4590 		movq	-112(%rbp), %rax
 4800 00ea 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/cc6OITWc.s 			page 138


 4801 00ed E8000000 		call	mbedtls_md_get_size@PLT
 4801      00
 4802              		.loc 1 1795 17
 4803 00f2 0FB6C0   		movzbl	%al, %eax
 4804 00f5 89853CFF 		movl	%eax, -196(%rbp)
 4804      FFFF
 4805              	.L359:
1796:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
1797:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1798:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     md_info = mbedtls_md_info_from_type( (mbedtls_md_type_t) ctx->hash_id );
 4806              		.loc 1 1798 65
 4807 00fb 488B8558 		movq	-168(%rbp), %rax
 4807      FFFFFF
 4808 0102 8B804C01 		movl	332(%rax), %eax
 4808      0000
 4809              		.loc 1 1798 15
 4810 0108 89C7     		movl	%eax, %edi
 4811 010a E8000000 		call	mbedtls_md_info_from_type@PLT
 4811      00
 4812 010f 48894590 		movq	%rax, -112(%rbp)
1799:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( md_info == NULL )
 4813              		.loc 1 1799 7
 4814 0113 48837D90 		cmpq	$0, -112(%rbp)
 4814      00
 4815 0118 750A     		jne	.L361
1800:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 4816              		.loc 1 1800 15
 4817 011a B880BFFF 		movl	$-16512, %eax
 4817      FF
 4818 011f E9A00300 		jmp	.L378
 4818      00
 4819              	.L361:
1801:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1802:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     hlen = mbedtls_md_get_size( md_info );
 4820              		.loc 1 1802 12
 4821 0124 488B4590 		movq	-112(%rbp), %rax
 4822 0128 4889C7   		movq	%rax, %rdi
 4823 012b E8000000 		call	mbedtls_md_get_size@PLT
 4823      00
 4824              		.loc 1 1802 10
 4825 0130 0FB6C0   		movzbl	%al, %eax
 4826 0133 48894598 		movq	%rax, -104(%rbp)
1803:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1804:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Calculate the largest possible salt length. Normally this is the hash
1805:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * length, which is the maximum length the salt can have. If there is not
1806:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * enough room, use the maximum salt length that fits. The constraint is
1807:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * that the hash length plus the salt length plus 2 bytes must be at most
1808:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * the key length. This complies with FIPS 186-4 ¬ß5.5 (e) and RFC 8017
1809:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * (PKCS#1 v2.2) ¬ß9.1.1 step 3. */
1810:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     min_slen = hlen - 2;
 4827              		.loc 1 1810 14
 4828 0137 488B4598 		movq	-104(%rbp), %rax
 4829 013b 4883E802 		subq	$2, %rax
 4830 013f 488945A0 		movq	%rax, -96(%rbp)
1811:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( olen < hlen + min_slen + 2 )
 4831              		.loc 1 1811 21
 4832 0143 488B5598 		movq	-104(%rbp), %rdx
GAS LISTING /tmp/cc6OITWc.s 			page 139


 4833 0147 488B45A0 		movq	-96(%rbp), %rax
 4834 014b 4801D0   		addq	%rdx, %rax
 4835              		.loc 1 1811 32
 4836 014e 4883C002 		addq	$2, %rax
 4837              		.loc 1 1811 7
 4838 0152 48394588 		cmpq	%rax, -120(%rbp)
 4839 0156 730A     		jnb	.L362
1812:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 4840              		.loc 1 1812 15
 4841 0158 B880BFFF 		movl	$-16512, %eax
 4841      FF
 4842 015d E9620300 		jmp	.L378
 4842      00
 4843              	.L362:
1813:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     else if( olen >= hlen + hlen + 2 )
 4844              		.loc 1 1813 34
 4845 0162 488B4598 		movq	-104(%rbp), %rax
 4846 0166 4883C001 		addq	$1, %rax
 4847 016a 4801C0   		addq	%rax, %rax
 4848              		.loc 1 1813 12
 4849 016d 48394588 		cmpq	%rax, -120(%rbp)
 4850 0171 720D     		jb	.L363
1814:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         slen = hlen;
 4851              		.loc 1 1814 14
 4852 0173 488B4598 		movq	-104(%rbp), %rax
 4853 0177 48898570 		movq	%rax, -144(%rbp)
 4853      FFFFFF
 4854 017e EB13     		jmp	.L364
 4855              	.L363:
1815:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     else
1816:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         slen = olen - hlen - 2;
 4856              		.loc 1 1816 21
 4857 0180 488B4588 		movq	-120(%rbp), %rax
 4858 0184 482B4598 		subq	-104(%rbp), %rax
 4859              		.loc 1 1816 14
 4860 0188 4883E802 		subq	$2, %rax
 4861 018c 48898570 		movq	%rax, -144(%rbp)
 4861      FFFFFF
 4862              	.L364:
1817:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1818:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     memset( sig, 0, olen );
 4863              		.loc 1 1818 5
 4864 0193 488B5588 		movq	-120(%rbp), %rdx
 4865 0197 488B8528 		movq	-216(%rbp), %rax
 4865      FFFFFF
 4866 019e BE000000 		movl	$0, %esi
 4866      00
 4867 01a3 4889C7   		movq	%rax, %rdi
 4868 01a6 E8000000 		call	memset@PLT
 4868      00
1819:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1820:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Generate salt of length slen */
1821:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = f_rng( p_rng, salt, slen ) ) != 0 )
 4869              		.loc 1 1821 17
 4870 01ab 488B9570 		movq	-144(%rbp), %rdx
 4870      FFFFFF
 4871 01b2 488D4DD0 		leaq	-48(%rbp), %rcx
GAS LISTING /tmp/cc6OITWc.s 			page 140


 4872 01b6 488B8548 		movq	-184(%rbp), %rax
 4872      FFFFFF
 4873 01bd 4C8B8550 		movq	-176(%rbp), %r8
 4873      FFFFFF
 4874 01c4 4889CE   		movq	%rcx, %rsi
 4875 01c7 4889C7   		movq	%rax, %rdi
 4876 01ca 41FFD0   		call	*%r8
 4877              	.LVL2:
 4878 01cd 89856CFF 		movl	%eax, -148(%rbp)
 4878      FFFF
 4879              		.loc 1 1821 7
 4880 01d3 83BD6CFF 		cmpl	$0, -148(%rbp)
 4880      FFFF00
 4881 01da 7410     		je	.L365
1822:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_RNG_FAILED + ret );
 4882              		.loc 1 1822 44
 4883 01dc 8B856CFF 		movl	-148(%rbp), %eax
 4883      FFFF
 4884 01e2 2D804400 		subl	$17536, %eax
 4884      00
 4885 01e7 E9D80200 		jmp	.L378
 4885      00
 4886              	.L365:
1823:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1824:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Note: EMSA-PSS encoding is over the length of N - 1 bits */
1825:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     msb = mbedtls_mpi_bitlen( &ctx->N ) - 1;
 4887              		.loc 1 1825 31
 4888 01ec 488B8558 		movq	-168(%rbp), %rax
 4888      FFFFFF
 4889 01f3 4883C010 		addq	$16, %rax
 4890              		.loc 1 1825 11
 4891 01f7 4889C7   		movq	%rax, %rdi
 4892 01fa E8000000 		call	mbedtls_mpi_bitlen@PLT
 4892      00
 4893              		.loc 1 1825 9
 4894 01ff 4883E801 		subq	$1, %rax
 4895 0203 488945A8 		movq	%rax, -88(%rbp)
1826:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     p += olen - hlen - slen - 2;
 4896              		.loc 1 1826 15
 4897 0207 488B4588 		movq	-120(%rbp), %rax
 4898 020b 482B4598 		subq	-104(%rbp), %rax
 4899              		.loc 1 1826 22
 4900 020f 482B8570 		subq	-144(%rbp), %rax
 4900      FFFFFF
 4901              		.loc 1 1826 7
 4902 0216 4883E802 		subq	$2, %rax
 4903 021a 48014580 		addq	%rax, -128(%rbp)
1827:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     *p++ = 0x01;
 4904              		.loc 1 1827 7
 4905 021e 488B4580 		movq	-128(%rbp), %rax
 4906 0222 488D5001 		leaq	1(%rax), %rdx
 4907 0226 48895580 		movq	%rdx, -128(%rbp)
 4908              		.loc 1 1827 10
 4909 022a C60001   		movb	$1, (%rax)
1828:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     memcpy( p, salt, slen );
 4910              		.loc 1 1828 5
 4911 022d 488B9570 		movq	-144(%rbp), %rdx
GAS LISTING /tmp/cc6OITWc.s 			page 141


 4911      FFFFFF
 4912 0234 488D4DD0 		leaq	-48(%rbp), %rcx
 4913 0238 488B4580 		movq	-128(%rbp), %rax
 4914 023c 4889CE   		movq	%rcx, %rsi
 4915 023f 4889C7   		movq	%rax, %rdi
 4916 0242 E8000000 		call	memcpy@PLT
 4916      00
1829:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     p += slen;
 4917              		.loc 1 1829 7
 4918 0247 488B8570 		movq	-144(%rbp), %rax
 4918      FFFFFF
 4919 024e 48014580 		addq	%rax, -128(%rbp)
1830:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1831:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_md_init( &md_ctx );
 4920              		.loc 1 1831 5
 4921 0252 488D45B0 		leaq	-80(%rbp), %rax
 4922 0256 4889C7   		movq	%rax, %rdi
 4923 0259 E8000000 		call	mbedtls_md_init@PLT
 4923      00
1832:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = mbedtls_md_setup( &md_ctx, md_info, 0 ) ) != 0 )
 4924              		.loc 1 1832 17
 4925 025e 488B4D90 		movq	-112(%rbp), %rcx
 4926 0262 488D45B0 		leaq	-80(%rbp), %rax
 4927 0266 BA000000 		movl	$0, %edx
 4927      00
 4928 026b 4889CE   		movq	%rcx, %rsi
 4929 026e 4889C7   		movq	%rax, %rdi
 4930 0271 E8000000 		call	mbedtls_md_setup@PLT
 4930      00
 4931 0276 89856CFF 		movl	%eax, -148(%rbp)
 4931      FFFF
 4932              		.loc 1 1832 7
 4933 027c 83BD6CFF 		cmpl	$0, -148(%rbp)
 4933      FFFF00
 4934 0283 0F85B101 		jne	.L380
 4934      0000
1833:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto exit;
1834:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1835:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Generate H = Hash( M' ) */
1836:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = mbedtls_md_starts( &md_ctx ) ) != 0 )
 4935              		.loc 1 1836 17
 4936 0289 488D45B0 		leaq	-80(%rbp), %rax
 4937 028d 4889C7   		movq	%rax, %rdi
 4938 0290 E8000000 		call	mbedtls_md_starts@PLT
 4938      00
 4939 0295 89856CFF 		movl	%eax, -148(%rbp)
 4939      FFFF
 4940              		.loc 1 1836 7
 4941 029b 83BD6CFF 		cmpl	$0, -148(%rbp)
 4941      FFFF00
 4942 02a2 0F859501 		jne	.L381
 4942      0000
1837:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto exit;
1838:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = mbedtls_md_update( &md_ctx, p, 8 ) ) != 0 )
 4943              		.loc 1 1838 17
 4944 02a8 488B4D80 		movq	-128(%rbp), %rcx
 4945 02ac 488D45B0 		leaq	-80(%rbp), %rax
GAS LISTING /tmp/cc6OITWc.s 			page 142


 4946 02b0 BA080000 		movl	$8, %edx
 4946      00
 4947 02b5 4889CE   		movq	%rcx, %rsi
 4948 02b8 4889C7   		movq	%rax, %rdi
 4949 02bb E8000000 		call	mbedtls_md_update@PLT
 4949      00
 4950 02c0 89856CFF 		movl	%eax, -148(%rbp)
 4950      FFFF
 4951              		.loc 1 1838 7
 4952 02c6 83BD6CFF 		cmpl	$0, -148(%rbp)
 4952      FFFF00
 4953 02cd 0F856D01 		jne	.L382
 4953      0000
1839:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto exit;
1840:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = mbedtls_md_update( &md_ctx, hash, hashlen ) ) != 0 )
 4954              		.loc 1 1840 17
 4955 02d3 8B953CFF 		movl	-196(%rbp), %edx
 4955      FFFF
 4956 02d9 488B8D30 		movq	-208(%rbp), %rcx
 4956      FFFFFF
 4957 02e0 488D45B0 		leaq	-80(%rbp), %rax
 4958 02e4 4889CE   		movq	%rcx, %rsi
 4959 02e7 4889C7   		movq	%rax, %rdi
 4960 02ea E8000000 		call	mbedtls_md_update@PLT
 4960      00
 4961 02ef 89856CFF 		movl	%eax, -148(%rbp)
 4961      FFFF
 4962              		.loc 1 1840 7
 4963 02f5 83BD6CFF 		cmpl	$0, -148(%rbp)
 4963      FFFF00
 4964 02fc 0F854101 		jne	.L383
 4964      0000
1841:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto exit;
1842:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = mbedtls_md_update( &md_ctx, salt, slen ) ) != 0 )
 4965              		.loc 1 1842 17
 4966 0302 488B9570 		movq	-144(%rbp), %rdx
 4966      FFFFFF
 4967 0309 488D4DD0 		leaq	-48(%rbp), %rcx
 4968 030d 488D45B0 		leaq	-80(%rbp), %rax
 4969 0311 4889CE   		movq	%rcx, %rsi
 4970 0314 4889C7   		movq	%rax, %rdi
 4971 0317 E8000000 		call	mbedtls_md_update@PLT
 4971      00
 4972 031c 89856CFF 		movl	%eax, -148(%rbp)
 4972      FFFF
 4973              		.loc 1 1842 7
 4974 0322 83BD6CFF 		cmpl	$0, -148(%rbp)
 4974      FFFF00
 4975 0329 0F851701 		jne	.L384
 4975      0000
1843:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto exit;
1844:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = mbedtls_md_finish( &md_ctx, p ) ) != 0 )
 4976              		.loc 1 1844 17
 4977 032f 488B5580 		movq	-128(%rbp), %rdx
 4978 0333 488D45B0 		leaq	-80(%rbp), %rax
 4979 0337 4889D6   		movq	%rdx, %rsi
 4980 033a 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/cc6OITWc.s 			page 143


 4981 033d E8000000 		call	mbedtls_md_finish@PLT
 4981      00
 4982 0342 89856CFF 		movl	%eax, -148(%rbp)
 4982      FFFF
 4983              		.loc 1 1844 7
 4984 0348 83BD6CFF 		cmpl	$0, -148(%rbp)
 4984      FFFF00
 4985 034f 0F85F400 		jne	.L385
 4985      0000
1845:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto exit;
1846:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1847:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Compensate for boundary condition when applying mask */
1848:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( msb % 8 == 0 )
 4986              		.loc 1 1848 13
 4987 0355 488B45A8 		movq	-88(%rbp), %rax
 4988 0359 83E007   		andl	$7, %eax
 4989              		.loc 1 1848 7
 4990 035c 4885C0   		testq	%rax, %rax
 4991 035f 750B     		jne	.L373
1849:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         offset = 1;
 4992              		.loc 1 1849 16
 4993 0361 48C78578 		movq	$1, -136(%rbp)
 4993      FFFFFF01 
 4993      000000
 4994              	.L373:
1850:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1851:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* maskedDB: Apply dbMask to DB */
1852:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = mgf_mask( sig + offset, olen - hlen - 1 - offset, p, hlen,
 4995              		.loc 1 1852 46
 4996 036c 488B4588 		movq	-120(%rbp), %rax
 4997 0370 482B4598 		subq	-104(%rbp), %rax
 4998              		.loc 1 1852 57
 4999 0374 482B8578 		subq	-136(%rbp), %rax
 4999      FFFFFF
 5000              		.loc 1 1852 17
 5001 037b 488D70FF 		leaq	-1(%rax), %rsi
 5002 037f 488B9528 		movq	-216(%rbp), %rdx
 5002      FFFFFF
 5003 0386 488B8578 		movq	-136(%rbp), %rax
 5003      FFFFFF
 5004 038d 488D3C02 		leaq	(%rdx,%rax), %rdi
 5005 0391 488D4DB0 		leaq	-80(%rbp), %rcx
 5006 0395 488B5598 		movq	-104(%rbp), %rdx
 5007 0399 488B4580 		movq	-128(%rbp), %rax
 5008 039d 4989C8   		movq	%rcx, %r8
 5009 03a0 4889D1   		movq	%rdx, %rcx
 5010 03a3 4889C2   		movq	%rax, %rdx
 5011 03a6 E8000000 		call	mgf_mask
 5011      00
 5012 03ab 89856CFF 		movl	%eax, -148(%rbp)
 5012      FFFF
 5013              		.loc 1 1852 7
 5014 03b1 83BD6CFF 		cmpl	$0, -148(%rbp)
 5014      FFFF00
 5015 03b8 0F858E00 		jne	.L386
 5015      0000
1853:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                           &md_ctx ) ) != 0 )
GAS LISTING /tmp/cc6OITWc.s 			page 144


1854:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto exit;
1855:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1856:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     msb = mbedtls_mpi_bitlen( &ctx->N ) - 1;
 5016              		.loc 1 1856 31
 5017 03be 488B8558 		movq	-168(%rbp), %rax
 5017      FFFFFF
 5018 03c5 4883C010 		addq	$16, %rax
 5019              		.loc 1 1856 11
 5020 03c9 4889C7   		movq	%rax, %rdi
 5021 03cc E8000000 		call	mbedtls_mpi_bitlen@PLT
 5021      00
 5022              		.loc 1 1856 9
 5023 03d1 4883E801 		subq	$1, %rax
 5024 03d5 488945A8 		movq	%rax, -88(%rbp)
1857:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     sig[0] &= 0xFF >> ( olen * 8 - msb );
 5025              		.loc 1 1857 12
 5026 03d9 488B8528 		movq	-216(%rbp), %rax
 5026      FFFFFF
 5027 03e0 0FB600   		movzbl	(%rax), %eax
 5028 03e3 89C6     		movl	%eax, %esi
 5029              		.loc 1 1857 34
 5030 03e5 488B4588 		movq	-120(%rbp), %rax
 5031 03e9 8D14C500 		leal	0(,%rax,8), %edx
 5031      000000
 5032 03f0 488B45A8 		movq	-88(%rbp), %rax
 5033 03f4 29C2     		subl	%eax, %edx
 5034 03f6 89D0     		movl	%edx, %eax
 5035              		.loc 1 1857 20
 5036 03f8 BAFF0000 		movl	$255, %edx
 5036      00
 5037 03fd 89C1     		movl	%eax, %ecx
 5038 03ff D3FA     		sarl	%cl, %edx
 5039 0401 89D0     		movl	%edx, %eax
 5040              		.loc 1 1857 12
 5041 0403 21F0     		andl	%esi, %eax
 5042 0405 89C2     		movl	%eax, %edx
 5043 0407 488B8528 		movq	-216(%rbp), %rax
 5043      FFFFFF
 5044 040e 8810     		movb	%dl, (%rax)
1858:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1859:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     p += hlen;
 5045              		.loc 1 1859 7
 5046 0410 488B4598 		movq	-104(%rbp), %rax
 5047 0414 48014580 		addq	%rax, -128(%rbp)
1860:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     *p++ = 0xBC;
 5048              		.loc 1 1860 7
 5049 0418 488B4580 		movq	-128(%rbp), %rax
 5050 041c 488D5001 		leaq	1(%rax), %rdx
 5051 0420 48895580 		movq	%rdx, -128(%rbp)
 5052              		.loc 1 1860 10
 5053 0424 C600BC   		movb	$-68, (%rax)
1861:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1862:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_platform_zeroize( salt, sizeof( salt ) );
 5054              		.loc 1 1862 5
 5055 0427 488D45D0 		leaq	-48(%rbp), %rax
 5056 042b BE200000 		movl	$32, %esi
 5056      00
GAS LISTING /tmp/cc6OITWc.s 			page 145


 5057 0430 4889C7   		movq	%rax, %rdi
 5058 0433 E8000000 		call	mbedtls_platform_zeroize@PLT
 5058      00
 5059 0438 EB13     		jmp	.L367
 5060              	.L380:
1833:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 5061              		.loc 1 1833 9
 5062 043a 90       		nop
 5063 043b EB10     		jmp	.L367
 5064              	.L381:
1837:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = mbedtls_md_update( &md_ctx, p, 8 ) ) != 0 )
 5065              		.loc 1 1837 9
 5066 043d 90       		nop
 5067 043e EB0D     		jmp	.L367
 5068              	.L382:
1839:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = mbedtls_md_update( &md_ctx, hash, hashlen ) ) != 0 )
 5069              		.loc 1 1839 9
 5070 0440 90       		nop
 5071 0441 EB0A     		jmp	.L367
 5072              	.L383:
1841:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = mbedtls_md_update( &md_ctx, salt, slen ) ) != 0 )
 5073              		.loc 1 1841 9
 5074 0443 90       		nop
 5075 0444 EB07     		jmp	.L367
 5076              	.L384:
1843:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = mbedtls_md_finish( &md_ctx, p ) ) != 0 )
 5077              		.loc 1 1843 9
 5078 0446 90       		nop
 5079 0447 EB04     		jmp	.L367
 5080              	.L385:
1845:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 5081              		.loc 1 1845 9
 5082 0449 90       		nop
 5083 044a EB01     		jmp	.L367
 5084              	.L386:
1854:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 5085              		.loc 1 1854 9
 5086 044c 90       		nop
 5087              	.L367:
1863:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1864:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** exit:
1865:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_md_free( &md_ctx );
 5088              		.loc 1 1865 5
 5089 044d 488D45B0 		leaq	-80(%rbp), %rax
 5090 0451 4889C7   		movq	%rax, %rdi
 5091 0454 E8000000 		call	mbedtls_md_free@PLT
 5091      00
1866:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1867:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ret != 0 )
 5092              		.loc 1 1867 7
 5093 0459 83BD6CFF 		cmpl	$0, -148(%rbp)
 5093      FFFF00
 5094 0460 7408     		je	.L375
1868:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( ret );
 5095              		.loc 1 1868 15
 5096 0462 8B856CFF 		movl	-148(%rbp), %eax
 5096      FFFF
GAS LISTING /tmp/cc6OITWc.s 			page 146


 5097 0468 EB5A     		jmp	.L378
 5098              	.L375:
1869:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1870:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( ( mode == MBEDTLS_RSA_PUBLIC )
1871:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             ? mbedtls_rsa_public(  ctx, sig, sig )
1872:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             : mbedtls_rsa_private( ctx, f_rng, p_rng, sig, sig ) );
 5099              		.loc 1 1872 13
 5100 046a 83BD44FF 		cmpl	$0, -188(%rbp)
 5100      FFFF00
 5101 0471 7522     		jne	.L376
1871:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             : mbedtls_rsa_private( ctx, f_rng, p_rng, sig, sig ) );
 5102              		.loc 1 1871 15
 5103 0473 488B9528 		movq	-216(%rbp), %rdx
 5103      FFFFFF
 5104 047a 488B8D28 		movq	-216(%rbp), %rcx
 5104      FFFFFF
 5105 0481 488B8558 		movq	-168(%rbp), %rax
 5105      FFFFFF
 5106 0488 4889CE   		movq	%rcx, %rsi
 5107 048b 4889C7   		movq	%rax, %rdi
 5108 048e E8000000 		call	mbedtls_rsa_public
 5108      00
 5109              		.loc 1 1872 13
 5110 0493 EB2E     		jmp	.L387
 5111              	.L376:
 5112              		.loc 1 1872 15 discriminator 1
 5113 0495 488BBD28 		movq	-216(%rbp), %rdi
 5113      FFFFFF
 5114 049c 488B8D28 		movq	-216(%rbp), %rcx
 5114      FFFFFF
 5115 04a3 488B9548 		movq	-184(%rbp), %rdx
 5115      FFFFFF
 5116 04aa 488BB550 		movq	-176(%rbp), %rsi
 5116      FFFFFF
 5117 04b1 488B8558 		movq	-168(%rbp), %rax
 5117      FFFFFF
 5118 04b8 4989F8   		movq	%rdi, %r8
 5119 04bb 4889C7   		movq	%rax, %rdi
 5120 04be E8000000 		call	mbedtls_rsa_private
 5120      00
 5121              	.L387:
 5122              		.loc 1 1872 13
 5123 04c3 90       		nop
 5124              	.L378:
1873:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 5125              		.loc 1 1873 1 discriminator 1
 5126 04c4 488B75F8 		movq	-8(%rbp), %rsi
 5127 04c8 64483334 		xorq	%fs:40, %rsi
 5127      25280000 
 5127      00
 5128 04d1 7405     		je	.L379
 5129              		.loc 1 1873 1 is_stmt 0
 5130 04d3 E8000000 		call	__stack_chk_fail@PLT
 5130      00
 5131              	.L379:
 5132 04d8 C9       		leave
 5133              	.LCFI86:
GAS LISTING /tmp/cc6OITWc.s 			page 147


 5134              		.cfi_def_cfa 7, 8
 5135 04d9 C3       		ret
 5136              		.cfi_endproc
 5137              	.LFE44:
 5139              		.section	.text.rsa_rsassa_pkcs1_v15_encode,"ax",@progbits
 5141              	rsa_rsassa_pkcs1_v15_encode:
 5142              	.LFB45:
1874:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif /* MBEDTLS_PKCS1_V21 */
1875:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1876:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_PKCS1_V15)
1877:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
1878:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Implementation of the PKCS#1 v2.1 RSASSA-PKCS1-V1_5-SIGN function
1879:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
1880:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1881:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /* Construct a PKCS v1.5 encoding of a hashed message
1882:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
1883:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * This is used both for signature generation and verification.
1884:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
1885:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Parameters:
1886:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * - md_alg:  Identifies the hash algorithm used to generate the given hash;
1887:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *            MBEDTLS_MD_NONE if raw data is signed.
1888:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * - hashlen: Length of hash in case hashlen is MBEDTLS_MD_NONE.
1889:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * - hash:    Buffer containing the hashed message or the raw data.
1890:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * - dst_len: Length of the encoded message.
1891:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * - dst:     Buffer to hold the encoded message.
1892:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
1893:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Assumptions:
1894:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * - hash has size hashlen if md_alg == MBEDTLS_MD_NONE.
1895:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * - hash has size corresponding to md_alg if md_alg != MBEDTLS_MD_NONE.
1896:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * - dst points to a buffer of size at least dst_len.
1897:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  *
1898:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
1899:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** static int rsa_rsassa_pkcs1_v15_encode( mbedtls_md_type_t md_alg,
1900:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                         unsigned int hashlen,
1901:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                         const unsigned char *hash,
1902:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                         size_t dst_len,
1903:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                         unsigned char *dst )
1904:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 5143              		.loc 1 1904 1 is_stmt 1
 5144              		.cfi_startproc
 5145 0000 F30F1EFA 		endbr64
 5146 0004 55       		pushq	%rbp
 5147              	.LCFI87:
 5148              		.cfi_def_cfa_offset 16
 5149              		.cfi_offset 6, -16
 5150 0005 4889E5   		movq	%rsp, %rbp
 5151              	.LCFI88:
 5152              		.cfi_def_cfa_register 6
 5153 0008 4883EC50 		subq	$80, %rsp
 5154 000c 897DCC   		movl	%edi, -52(%rbp)
 5155 000f 8975C8   		movl	%esi, -56(%rbp)
 5156 0012 488955C0 		movq	%rdx, -64(%rbp)
 5157 0016 48894DB8 		movq	%rcx, -72(%rbp)
 5158 001a 4C8945B0 		movq	%r8, -80(%rbp)
 5159              		.loc 1 1904 1
 5160 001e 64488B04 		movq	%fs:40, %rax
 5160      25280000 
GAS LISTING /tmp/cc6OITWc.s 			page 148


 5160      00
 5161 0027 488945F8 		movq	%rax, -8(%rbp)
 5162 002b 31C0     		xorl	%eax, %eax
1905:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     size_t oid_size  = 0;
 5163              		.loc 1 1905 12
 5164 002d 48C745D0 		movq	$0, -48(%rbp)
 5164      00000000 
1906:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     size_t nb_pad    = dst_len;
 5165              		.loc 1 1906 12
 5166 0035 488B45B8 		movq	-72(%rbp), %rax
 5167 0039 488945E0 		movq	%rax, -32(%rbp)
1907:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned char *p = dst;
 5168              		.loc 1 1907 20
 5169 003d 488B45B0 		movq	-80(%rbp), %rax
 5170 0041 488945E8 		movq	%rax, -24(%rbp)
1908:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     const char *oid  = NULL;
 5171              		.loc 1 1908 17
 5172 0045 48C745D8 		movq	$0, -40(%rbp)
 5172      00000000 
1909:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1910:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Are we signing hashed or raw data? */
1911:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( md_alg != MBEDTLS_MD_NONE )
 5173              		.loc 1 1911 7
 5174 004d 837DCC00 		cmpl	$0, -52(%rbp)
 5175 0051 0F84C900 		je	.L389
 5175      0000
 5176              	.LBB5:
1912:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
1913:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         const mbedtls_md_info_t *md_info = mbedtls_md_info_from_type( md_alg );
 5177              		.loc 1 1913 44
 5178 0057 8B45CC   		movl	-52(%rbp), %eax
 5179 005a 89C7     		movl	%eax, %edi
 5180 005c E8000000 		call	mbedtls_md_info_from_type@PLT
 5180      00
 5181 0061 488945F0 		movq	%rax, -16(%rbp)
1914:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( md_info == NULL )
 5182              		.loc 1 1914 11
 5183 0065 48837DF0 		cmpq	$0, -16(%rbp)
 5183      00
 5184 006a 750A     		jne	.L390
1915:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 5185              		.loc 1 1915 19
 5186 006c B880BFFF 		movl	$-16512, %eax
 5186      FF
 5187 0071 E9690200 		jmp	.L401
 5187      00
 5188              	.L390:
1916:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1917:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( mbedtls_oid_get_oid_by_md( md_alg, &oid, &oid_size ) != 0 )
 5189              		.loc 1 1917 13
 5190 0076 488D55D0 		leaq	-48(%rbp), %rdx
 5191 007a 488D4DD8 		leaq	-40(%rbp), %rcx
 5192 007e 8B45CC   		movl	-52(%rbp), %eax
 5193 0081 4889CE   		movq	%rcx, %rsi
 5194 0084 89C7     		movl	%eax, %edi
 5195 0086 E8000000 		call	mbedtls_oid_get_oid_by_md@PLT
 5195      00
GAS LISTING /tmp/cc6OITWc.s 			page 149


 5196              		.loc 1 1917 11
 5197 008b 85C0     		testl	%eax, %eax
 5198 008d 740A     		je	.L392
1918:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 5199              		.loc 1 1918 19
 5200 008f B880BFFF 		movl	$-16512, %eax
 5200      FF
 5201 0094 E9460200 		jmp	.L401
 5201      00
 5202              	.L392:
1919:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1920:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         hashlen = mbedtls_md_get_size( md_info );
 5203              		.loc 1 1920 19
 5204 0099 488B45F0 		movq	-16(%rbp), %rax
 5205 009d 4889C7   		movq	%rax, %rdi
 5206 00a0 E8000000 		call	mbedtls_md_get_size@PLT
 5206      00
 5207              		.loc 1 1920 17
 5208 00a5 0FB6C0   		movzbl	%al, %eax
 5209 00a8 8945C8   		movl	%eax, -56(%rbp)
1921:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1922:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /* Double-check that 8 + hashlen + oid_size can be used as a
1923:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          * 1-byte ASN.1 length encoding and that there's no overflow. */
1924:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( 8 + hashlen + oid_size  >= 0x80         ||
 5210              		.loc 1 1924 15
 5211 00ab 8B45C8   		movl	-56(%rbp), %eax
 5212 00ae 83C008   		addl	$8, %eax
 5213 00b1 89C2     		movl	%eax, %edx
 5214              		.loc 1 1924 25
 5215 00b3 488B45D0 		movq	-48(%rbp), %rax
 5216 00b7 4801D0   		addq	%rdx, %rax
 5217              		.loc 1 1924 11
 5218 00ba 4883F87F 		cmpq	$127, %rax
 5219 00be 7722     		ja	.L393
 5220              		.loc 1 1924 53 discriminator 1
 5221 00c0 837DC8F5 		cmpl	$-11, -56(%rbp)
 5222 00c4 771C     		ja	.L393
1925:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             10 + hashlen            <  hashlen      ||
1926:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             10 + hashlen + oid_size <  10 + hashlen )
 5223              		.loc 1 1926 16
 5224 00c6 8B45C8   		movl	-56(%rbp), %eax
 5225 00c9 83C00A   		addl	$10, %eax
 5226 00cc 89C2     		movl	%eax, %edx
 5227              		.loc 1 1926 26
 5228 00ce 488B45D0 		movq	-48(%rbp), %rax
 5229 00d2 4801C2   		addq	%rax, %rdx
 5230              		.loc 1 1926 43
 5231 00d5 8B45C8   		movl	-56(%rbp), %eax
 5232 00d8 83C00A   		addl	$10, %eax
 5233 00db 89C0     		movl	%eax, %eax
1925:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             10 + hashlen            <  hashlen      ||
 5234              		.loc 1 1925 53
 5235 00dd 4839C2   		cmpq	%rax, %rdx
 5236 00e0 730A     		jnb	.L394
 5237              	.L393:
1927:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 5238              		.loc 1 1927 19
GAS LISTING /tmp/cc6OITWc.s 			page 150


 5239 00e2 B880BFFF 		movl	$-16512, %eax
 5239      FF
 5240 00e7 E9F30100 		jmp	.L401
 5240      00
 5241              	.L394:
1928:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1929:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /*
1930:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          * Static bounds check:
1931:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          * - Need 10 bytes for five tag-length pairs.
1932:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          *   (Insist on 1-byte length encodings to protect against variants of
1933:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          *    Bleichenbacher's forgery attack against lax PKCS#1v1.5 verification)
1934:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          * - Need hashlen bytes for hash
1935:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          * - Need oid_size bytes for hash alg OID.
1936:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****          */
1937:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( nb_pad < 10 + hashlen + oid_size )
 5242              		.loc 1 1937 25
 5243 00ec 8B45C8   		movl	-56(%rbp), %eax
 5244 00ef 83C00A   		addl	$10, %eax
 5245 00f2 89C2     		movl	%eax, %edx
 5246              		.loc 1 1937 35
 5247 00f4 488B45D0 		movq	-48(%rbp), %rax
 5248 00f8 4801D0   		addq	%rdx, %rax
 5249              		.loc 1 1937 11
 5250 00fb 483945E0 		cmpq	%rax, -32(%rbp)
 5251 00ff 730A     		jnb	.L395
1938:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 5252              		.loc 1 1938 19
 5253 0101 B880BFFF 		movl	$-16512, %eax
 5253      FF
 5254 0106 E9D40100 		jmp	.L401
 5254      00
 5255              	.L395:
1939:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         nb_pad -= 10 + hashlen + oid_size;
 5256              		.loc 1 1939 22
 5257 010b 8B45C8   		movl	-56(%rbp), %eax
 5258 010e 83C00A   		addl	$10, %eax
 5259 0111 89C2     		movl	%eax, %edx
 5260              		.loc 1 1939 32
 5261 0113 488B45D0 		movq	-48(%rbp), %rax
 5262 0117 4801D0   		addq	%rdx, %rax
 5263              		.loc 1 1939 16
 5264 011a 482945E0 		subq	%rax, -32(%rbp)
 5265              	.LBE5:
 5266 011e EB1A     		jmp	.L396
 5267              	.L389:
1940:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
1941:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     else
1942:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
1943:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( nb_pad < hashlen )
 5268              		.loc 1 1943 20
 5269 0120 8B45C8   		movl	-56(%rbp), %eax
 5270              		.loc 1 1943 11
 5271 0123 483945E0 		cmpq	%rax, -32(%rbp)
 5272 0127 730A     		jnb	.L397
1944:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 5273              		.loc 1 1944 19
 5274 0129 B880BFFF 		movl	$-16512, %eax
GAS LISTING /tmp/cc6OITWc.s 			page 151


 5274      FF
 5275 012e E9AC0100 		jmp	.L401
 5275      00
 5276              	.L397:
1945:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1946:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         nb_pad -= hashlen;
 5277              		.loc 1 1946 16
 5278 0133 8B45C8   		movl	-56(%rbp), %eax
 5279 0136 482945E0 		subq	%rax, -32(%rbp)
 5280              	.L396:
1947:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
1948:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1949:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Need space for signature header and padding delimiter (3 bytes),
1950:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * and 8 bytes for the minimal padding */
1951:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( nb_pad < 3 + 8 )
 5281              		.loc 1 1951 7
 5282 013a 48837DE0 		cmpq	$10, -32(%rbp)
 5282      0A
 5283 013f 770A     		ja	.L398
1952:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 5284              		.loc 1 1952 15
 5285 0141 B880BFFF 		movl	$-16512, %eax
 5285      FF
 5286 0146 E9940100 		jmp	.L401
 5286      00
 5287              	.L398:
1953:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     nb_pad -= 3;
 5288              		.loc 1 1953 12
 5289 014b 48836DE0 		subq	$3, -32(%rbp)
 5289      03
1954:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1955:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Now nb_pad is the amount of memory to be filled
1956:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * with padding, and at least 8 bytes long. */
1957:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1958:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Write signature header and padding */
1959:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     *p++ = 0;
 5290              		.loc 1 1959 7
 5291 0150 488B45E8 		movq	-24(%rbp), %rax
 5292 0154 488D5001 		leaq	1(%rax), %rdx
 5293 0158 488955E8 		movq	%rdx, -24(%rbp)
 5294              		.loc 1 1959 10
 5295 015c C60000   		movb	$0, (%rax)
1960:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     *p++ = MBEDTLS_RSA_SIGN;
 5296              		.loc 1 1960 7
 5297 015f 488B45E8 		movq	-24(%rbp), %rax
 5298 0163 488D5001 		leaq	1(%rax), %rdx
 5299 0167 488955E8 		movq	%rdx, -24(%rbp)
 5300              		.loc 1 1960 10
 5301 016b C60001   		movb	$1, (%rax)
1961:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     memset( p, 0xFF, nb_pad );
 5302              		.loc 1 1961 5
 5303 016e 488B55E0 		movq	-32(%rbp), %rdx
 5304 0172 488B45E8 		movq	-24(%rbp), %rax
 5305 0176 BEFF0000 		movl	$255, %esi
 5305      00
 5306 017b 4889C7   		movq	%rax, %rdi
 5307 017e E8000000 		call	memset@PLT
GAS LISTING /tmp/cc6OITWc.s 			page 152


 5307      00
1962:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     p += nb_pad;
 5308              		.loc 1 1962 7
 5309 0183 488B45E0 		movq	-32(%rbp), %rax
 5310 0187 480145E8 		addq	%rax, -24(%rbp)
1963:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     *p++ = 0;
 5311              		.loc 1 1963 7
 5312 018b 488B45E8 		movq	-24(%rbp), %rax
 5313 018f 488D5001 		leaq	1(%rax), %rdx
 5314 0193 488955E8 		movq	%rdx, -24(%rbp)
 5315              		.loc 1 1963 10
 5316 0197 C60000   		movb	$0, (%rax)
1964:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1965:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Are we signing raw data? */
1966:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( md_alg == MBEDTLS_MD_NONE )
 5317              		.loc 1 1966 7
 5318 019a 837DCC00 		cmpl	$0, -52(%rbp)
 5319 019e 7520     		jne	.L399
1967:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
1968:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         memcpy( p, hash, hashlen );
 5320              		.loc 1 1968 9
 5321 01a0 8B55C8   		movl	-56(%rbp), %edx
 5322 01a3 488B4DC0 		movq	-64(%rbp), %rcx
 5323 01a7 488B45E8 		movq	-24(%rbp), %rax
 5324 01ab 4889CE   		movq	%rcx, %rsi
 5325 01ae 4889C7   		movq	%rax, %rdi
 5326 01b1 E8000000 		call	memcpy@PLT
 5326      00
1969:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( 0 );
 5327              		.loc 1 1969 15
 5328 01b6 B8000000 		movl	$0, %eax
 5328      00
 5329 01bb E91F0100 		jmp	.L401
 5329      00
 5330              	.L399:
1970:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
1971:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
1972:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Signing hashed data, add corresponding ASN.1 structure
1973:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      *
1974:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * DigestInfo ::= SEQUENCE {
1975:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      *   digestAlgorithm DigestAlgorithmIdentifier,
1976:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      *   digest Digest }
1977:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * DigestAlgorithmIdentifier ::= AlgorithmIdentifier
1978:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * Digest ::= OCTET STRING
1979:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      *
1980:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * Schematic:
1981:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * TAG-SEQ + LEN [ TAG-SEQ + LEN [ TAG-OID  + LEN [ OID  ]
1982:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      *                                 TAG-NULL + LEN [ NULL ] ]
1983:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      *                 TAG-OCTET + LEN [ HASH ] ]
1984:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
1985:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     *p++ = MBEDTLS_ASN1_SEQUENCE | MBEDTLS_ASN1_CONSTRUCTED;
 5331              		.loc 1 1985 7
 5332 01c0 488B45E8 		movq	-24(%rbp), %rax
 5333 01c4 488D5001 		leaq	1(%rax), %rdx
 5334 01c8 488955E8 		movq	%rdx, -24(%rbp)
 5335              		.loc 1 1985 10
 5336 01cc C60030   		movb	$48, (%rax)
GAS LISTING /tmp/cc6OITWc.s 			page 153


1986:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     *p++ = (unsigned char)( 0x08 + oid_size + hashlen );
 5337              		.loc 1 1986 45
 5338 01cf 488B45D0 		movq	-48(%rbp), %rax
 5339 01d3 89C2     		movl	%eax, %edx
 5340 01d5 8B45C8   		movl	-56(%rbp), %eax
 5341 01d8 8D0C02   		leal	(%rdx,%rax), %ecx
 5342              		.loc 1 1986 7
 5343 01db 488B45E8 		movq	-24(%rbp), %rax
 5344 01df 488D5001 		leaq	1(%rax), %rdx
 5345 01e3 488955E8 		movq	%rdx, -24(%rbp)
 5346              		.loc 1 1986 12
 5347 01e7 8D5108   		leal	8(%rcx), %edx
 5348              		.loc 1 1986 10
 5349 01ea 8810     		movb	%dl, (%rax)
1987:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     *p++ = MBEDTLS_ASN1_SEQUENCE | MBEDTLS_ASN1_CONSTRUCTED;
 5350              		.loc 1 1987 7
 5351 01ec 488B45E8 		movq	-24(%rbp), %rax
 5352 01f0 488D5001 		leaq	1(%rax), %rdx
 5353 01f4 488955E8 		movq	%rdx, -24(%rbp)
 5354              		.loc 1 1987 10
 5355 01f8 C60030   		movb	$48, (%rax)
1988:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     *p++ = (unsigned char)( 0x04 + oid_size );
 5356              		.loc 1 1988 12
 5357 01fb 488B45D0 		movq	-48(%rbp), %rax
 5358 01ff 89C1     		movl	%eax, %ecx
 5359              		.loc 1 1988 7
 5360 0201 488B45E8 		movq	-24(%rbp), %rax
 5361 0205 488D5001 		leaq	1(%rax), %rdx
 5362 0209 488955E8 		movq	%rdx, -24(%rbp)
 5363              		.loc 1 1988 12
 5364 020d 8D5104   		leal	4(%rcx), %edx
 5365              		.loc 1 1988 10
 5366 0210 8810     		movb	%dl, (%rax)
1989:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     *p++ = MBEDTLS_ASN1_OID;
 5367              		.loc 1 1989 7
 5368 0212 488B45E8 		movq	-24(%rbp), %rax
 5369 0216 488D5001 		leaq	1(%rax), %rdx
 5370 021a 488955E8 		movq	%rdx, -24(%rbp)
 5371              		.loc 1 1989 10
 5372 021e C60006   		movb	$6, (%rax)
1990:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     *p++ = (unsigned char) oid_size;
 5373              		.loc 1 1990 12
 5374 0221 488B4DD0 		movq	-48(%rbp), %rcx
 5375              		.loc 1 1990 7
 5376 0225 488B45E8 		movq	-24(%rbp), %rax
 5377 0229 488D5001 		leaq	1(%rax), %rdx
 5378 022d 488955E8 		movq	%rdx, -24(%rbp)
 5379              		.loc 1 1990 12
 5380 0231 89CA     		movl	%ecx, %edx
 5381              		.loc 1 1990 10
 5382 0233 8810     		movb	%dl, (%rax)
1991:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     memcpy( p, oid, oid_size );
 5383              		.loc 1 1991 5
 5384 0235 488B55D0 		movq	-48(%rbp), %rdx
 5385 0239 488B4DD8 		movq	-40(%rbp), %rcx
 5386 023d 488B45E8 		movq	-24(%rbp), %rax
 5387 0241 4889CE   		movq	%rcx, %rsi
GAS LISTING /tmp/cc6OITWc.s 			page 154


 5388 0244 4889C7   		movq	%rax, %rdi
 5389 0247 E8000000 		call	memcpy@PLT
 5389      00
1992:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     p += oid_size;
 5390              		.loc 1 1992 7
 5391 024c 488B45D0 		movq	-48(%rbp), %rax
 5392 0250 480145E8 		addq	%rax, -24(%rbp)
1993:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     *p++ = MBEDTLS_ASN1_NULL;
 5393              		.loc 1 1993 7
 5394 0254 488B45E8 		movq	-24(%rbp), %rax
 5395 0258 488D5001 		leaq	1(%rax), %rdx
 5396 025c 488955E8 		movq	%rdx, -24(%rbp)
 5397              		.loc 1 1993 10
 5398 0260 C60005   		movb	$5, (%rax)
1994:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     *p++ = 0x00;
 5399              		.loc 1 1994 7
 5400 0263 488B45E8 		movq	-24(%rbp), %rax
 5401 0267 488D5001 		leaq	1(%rax), %rdx
 5402 026b 488955E8 		movq	%rdx, -24(%rbp)
 5403              		.loc 1 1994 10
 5404 026f C60000   		movb	$0, (%rax)
1995:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     *p++ = MBEDTLS_ASN1_OCTET_STRING;
 5405              		.loc 1 1995 7
 5406 0272 488B45E8 		movq	-24(%rbp), %rax
 5407 0276 488D5001 		leaq	1(%rax), %rdx
 5408 027a 488955E8 		movq	%rdx, -24(%rbp)
 5409              		.loc 1 1995 10
 5410 027e C60004   		movb	$4, (%rax)
1996:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     *p++ = (unsigned char) hashlen;
 5411              		.loc 1 1996 7
 5412 0281 488B45E8 		movq	-24(%rbp), %rax
 5413 0285 488D5001 		leaq	1(%rax), %rdx
 5414 0289 488955E8 		movq	%rdx, -24(%rbp)
 5415              		.loc 1 1996 12
 5416 028d 8B55C8   		movl	-56(%rbp), %edx
 5417              		.loc 1 1996 10
 5418 0290 8810     		movb	%dl, (%rax)
1997:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     memcpy( p, hash, hashlen );
 5419              		.loc 1 1997 5
 5420 0292 8B55C8   		movl	-56(%rbp), %edx
 5421 0295 488B4DC0 		movq	-64(%rbp), %rcx
 5422 0299 488B45E8 		movq	-24(%rbp), %rax
 5423 029d 4889CE   		movq	%rcx, %rsi
 5424 02a0 4889C7   		movq	%rax, %rdi
 5425 02a3 E8000000 		call	memcpy@PLT
 5425      00
1998:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     p += hashlen;
 5426              		.loc 1 1998 7
 5427 02a8 8B45C8   		movl	-56(%rbp), %eax
 5428 02ab 480145E8 		addq	%rax, -24(%rbp)
1999:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2000:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Just a sanity-check, should be automatic
2001:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * after the initial bounds check. */
2002:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( p != dst + dst_len )
 5429              		.loc 1 2002 18
 5430 02af 488B55B0 		movq	-80(%rbp), %rdx
 5431 02b3 488B45B8 		movq	-72(%rbp), %rax
GAS LISTING /tmp/cc6OITWc.s 			page 155


 5432 02b7 4801D0   		addq	%rdx, %rax
 5433              		.loc 1 2002 7
 5434 02ba 483945E8 		cmpq	%rax, -24(%rbp)
 5435 02be 741A     		je	.L400
2003:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
2004:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_platform_zeroize( dst, dst_len );
 5436              		.loc 1 2004 9
 5437 02c0 488B55B8 		movq	-72(%rbp), %rdx
 5438 02c4 488B45B0 		movq	-80(%rbp), %rax
 5439 02c8 4889D6   		movq	%rdx, %rsi
 5440 02cb 4889C7   		movq	%rax, %rdi
 5441 02ce E8000000 		call	mbedtls_platform_zeroize@PLT
 5441      00
2005:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 5442              		.loc 1 2005 15
 5443 02d3 B880BFFF 		movl	$-16512, %eax
 5443      FF
 5444 02d8 EB05     		jmp	.L401
 5445              	.L400:
2006:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
2007:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2008:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( 0 );
 5446              		.loc 1 2008 11
 5447 02da B8000000 		movl	$0, %eax
 5447      00
 5448              	.L401:
2009:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 5449              		.loc 1 2009 1 discriminator 1
 5450 02df 488B75F8 		movq	-8(%rbp), %rsi
 5451 02e3 64483334 		xorq	%fs:40, %rsi
 5451      25280000 
 5451      00
 5452 02ec 7405     		je	.L402
 5453              		.loc 1 2009 1 is_stmt 0
 5454 02ee E8000000 		call	__stack_chk_fail@PLT
 5454      00
 5455              	.L402:
 5456 02f3 C9       		leave
 5457              	.LCFI89:
 5458              		.cfi_def_cfa 7, 8
 5459 02f4 C3       		ret
 5460              		.cfi_endproc
 5461              	.LFE45:
 5463              		.section	.text.mbedtls_rsa_rsassa_pkcs1_v15_sign,"ax",@progbits
 5464              		.globl	mbedtls_rsa_rsassa_pkcs1_v15_sign
 5466              	mbedtls_rsa_rsassa_pkcs1_v15_sign:
 5467              	.LFB46:
2010:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2011:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
2012:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Do an RSA operation to sign the message digest
2013:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
2014:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_rsassa_pkcs1_v15_sign( mbedtls_rsa_context *ctx,
2015:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                int (*f_rng)(void *, unsigned char *, size_t),
2016:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                void *p_rng,
2017:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                int mode,
2018:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                mbedtls_md_type_t md_alg,
2019:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                unsigned int hashlen,
GAS LISTING /tmp/cc6OITWc.s 			page 156


2020:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                const unsigned char *hash,
2021:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                unsigned char *sig )
2022:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 5468              		.loc 1 2022 1 is_stmt 1
 5469              		.cfi_startproc
 5470 0000 F30F1EFA 		endbr64
 5471 0004 55       		pushq	%rbp
 5472              	.LCFI90:
 5473              		.cfi_def_cfa_offset 16
 5474              		.cfi_offset 6, -16
 5475 0005 4889E5   		movq	%rsp, %rbp
 5476              	.LCFI91:
 5477              		.cfi_def_cfa_register 6
 5478 0008 4883EC60 		subq	$96, %rsp
 5479 000c 48897DD8 		movq	%rdi, -40(%rbp)
 5480 0010 488975D0 		movq	%rsi, -48(%rbp)
 5481 0014 488955C8 		movq	%rdx, -56(%rbp)
 5482 0018 894DC4   		movl	%ecx, -60(%rbp)
 5483 001b 448945C0 		movl	%r8d, -64(%rbp)
 5484 001f 44894DBC 		movl	%r9d, -68(%rbp)
 5485 0023 488B4510 		movq	16(%rbp), %rax
 5486 0027 488945B0 		movq	%rax, -80(%rbp)
 5487 002b 488B4518 		movq	24(%rbp), %rax
 5488 002f 488945A8 		movq	%rax, -88(%rbp)
 5489              		.loc 1 2022 1
 5490 0033 64488B04 		movq	%fs:40, %rax
 5490      25280000 
 5490      00
 5491 003c 488945F8 		movq	%rax, -8(%rbp)
 5492 0040 31C0     		xorl	%eax, %eax
2023:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int ret;
2024:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned char *sig_try = NULL, *verif = NULL;
 5493              		.loc 1 2024 20
 5494 0042 48C745E8 		movq	$0, -24(%rbp)
 5494      00000000 
 5495              		.loc 1 2024 37
 5496 004a 48C745F0 		movq	$0, -16(%rbp)
 5496      00000000 
2025:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2026:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
2027:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( mode == MBEDTLS_RSA_PRIVATE ||
2028:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       mode == MBEDTLS_RSA_PUBLIC );
2029:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ( md_alg  == MBEDTLS_MD_NONE &&
2030:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                         hashlen == 0 ) ||
2031:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       hash != NULL );
2032:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( sig != NULL );
2033:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2034:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mode == MBEDTLS_RSA_PRIVATE && ctx->padding != MBEDTLS_RSA_PKCS_V15 )
 5497              		.loc 1 2034 7
 5498 0052 837DC401 		cmpl	$1, -60(%rbp)
 5499 0056 7518     		jne	.L404
 5500              		.loc 1 2034 43 discriminator 1
 5501 0058 488B45D8 		movq	-40(%rbp), %rax
 5502 005c 8B804801 		movl	328(%rax), %eax
 5502      0000
 5503              		.loc 1 2034 37 discriminator 1
 5504 0062 85C0     		testl	%eax, %eax
GAS LISTING /tmp/cc6OITWc.s 			page 157


 5505 0064 740A     		je	.L404
2035:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 5506              		.loc 1 2035 15
 5507 0066 B880BFFF 		movl	$-16512, %eax
 5507      FF
 5508 006b E95F0100 		jmp	.L405
 5508      00
 5509              	.L404:
2036:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2037:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
2038:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * Prepare PKCS1-v1.5 encoding (padding and hash identifier)
2039:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
2040:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2041:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = rsa_rsassa_pkcs1_v15_encode( md_alg, hashlen, hash,
 5510              		.loc 1 2041 17
 5511 0070 488B45D8 		movq	-40(%rbp), %rax
 5512 0074 488B4808 		movq	8(%rax), %rcx
 5513 0078 488B7DA8 		movq	-88(%rbp), %rdi
 5514 007c 488B55B0 		movq	-80(%rbp), %rdx
 5515 0080 8B75BC   		movl	-68(%rbp), %esi
 5516 0083 8B45C0   		movl	-64(%rbp), %eax
 5517 0086 4989F8   		movq	%rdi, %r8
 5518 0089 89C7     		movl	%eax, %edi
 5519 008b E8000000 		call	rsa_rsassa_pkcs1_v15_encode
 5519      00
 5520 0090 8945E4   		movl	%eax, -28(%rbp)
 5521              		.loc 1 2041 7
 5522 0093 837DE400 		cmpl	$0, -28(%rbp)
 5523 0097 7408     		je	.L406
2042:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                              ctx->len, sig ) ) != 0 )
2043:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( ret );
 5524              		.loc 1 2043 15
 5525 0099 8B45E4   		movl	-28(%rbp), %eax
 5526 009c E92E0100 		jmp	.L405
 5526      00
 5527              	.L406:
2044:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2045:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
2046:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * Call respective RSA primitive
2047:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
2048:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2049:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mode == MBEDTLS_RSA_PUBLIC )
 5528              		.loc 1 2049 7
 5529 00a1 837DC400 		cmpl	$0, -60(%rbp)
 5530 00a5 751C     		jne	.L407
2050:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
2051:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /* Skip verification on a public key operation */
2052:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( mbedtls_rsa_public( ctx, sig, sig ) );
 5531              		.loc 1 2052 17
 5532 00a7 488B55A8 		movq	-88(%rbp), %rdx
 5533 00ab 488B4DA8 		movq	-88(%rbp), %rcx
 5534 00af 488B45D8 		movq	-40(%rbp), %rax
 5535 00b3 4889CE   		movq	%rcx, %rsi
 5536 00b6 4889C7   		movq	%rax, %rdi
 5537 00b9 E8000000 		call	mbedtls_rsa_public
 5537      00
 5538 00be E90C0100 		jmp	.L405
GAS LISTING /tmp/cc6OITWc.s 			page 158


 5538      00
 5539              	.L407:
2053:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
2054:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2055:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Private key operation
2056:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      *
2057:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * In order to prevent Lenstra's attack, make the signature in a
2058:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * temporary buffer and check it before returning it.
2059:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
2060:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2061:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     sig_try = mbedtls_calloc( 1, ctx->len );
 5540              		.loc 1 2061 15
 5541 00c3 488B45D8 		movq	-40(%rbp), %rax
 5542 00c7 488B4008 		movq	8(%rax), %rax
 5543 00cb 4889C6   		movq	%rax, %rsi
 5544 00ce BF010000 		movl	$1, %edi
 5544      00
 5545 00d3 E8000000 		call	mbedtls_calloc@PLT
 5545      00
 5546 00d8 488945E8 		movq	%rax, -24(%rbp)
2062:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( sig_try == NULL )
 5547              		.loc 1 2062 7
 5548 00dc 48837DE8 		cmpq	$0, -24(%rbp)
 5548      00
 5549 00e1 750A     		jne	.L408
2063:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_MPI_ALLOC_FAILED );
 5550              		.loc 1 2063 15
 5551 00e3 B8F0FFFF 		movl	$-16, %eax
 5551      FF
 5552 00e8 E9E20000 		jmp	.L405
 5552      00
 5553              	.L408:
2064:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2065:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     verif = mbedtls_calloc( 1, ctx->len );
 5554              		.loc 1 2065 13
 5555 00ed 488B45D8 		movq	-40(%rbp), %rax
 5556 00f1 488B4008 		movq	8(%rax), %rax
 5557 00f5 4889C6   		movq	%rax, %rsi
 5558 00f8 BF010000 		movl	$1, %edi
 5558      00
 5559 00fd E8000000 		call	mbedtls_calloc@PLT
 5559      00
 5560 0102 488945F0 		movq	%rax, -16(%rbp)
2066:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( verif == NULL )
 5561              		.loc 1 2066 7
 5562 0106 48837DF0 		cmpq	$0, -16(%rbp)
 5562      00
 5563 010b 7516     		jne	.L409
2067:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
2068:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_free( sig_try );
 5564              		.loc 1 2068 9
 5565 010d 488B45E8 		movq	-24(%rbp), %rax
 5566 0111 4889C7   		movq	%rax, %rdi
 5567 0114 E8000000 		call	mbedtls_free@PLT
 5567      00
2069:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_MPI_ALLOC_FAILED );
 5568              		.loc 1 2069 15
GAS LISTING /tmp/cc6OITWc.s 			page 159


 5569 0119 B8F0FFFF 		movl	$-16, %eax
 5569      FF
 5570 011e E9AC0000 		jmp	.L405
 5570      00
 5571              	.L409:
2070:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
2071:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2072:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_rsa_private( ctx, f_rng, p_rng, sig, sig_try ) );
 5572              		.loc 1 2072 5
 5573 0123 488B7DE8 		movq	-24(%rbp), %rdi
 5574 0127 488B4DA8 		movq	-88(%rbp), %rcx
 5575 012b 488B55C8 		movq	-56(%rbp), %rdx
 5576 012f 488B75D0 		movq	-48(%rbp), %rsi
 5577 0133 488B45D8 		movq	-40(%rbp), %rax
 5578 0137 4989F8   		movq	%rdi, %r8
 5579 013a 4889C7   		movq	%rax, %rdi
 5580 013d E8000000 		call	mbedtls_rsa_private
 5580      00
 5581 0142 8945E4   		movl	%eax, -28(%rbp)
 5582 0145 837DE400 		cmpl	$0, -28(%rbp)
 5583 0149 7565     		jne	.L415
2073:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_rsa_public( ctx, sig_try, verif ) );
 5584              		.loc 1 2073 5
 5585 014b 488B55F0 		movq	-16(%rbp), %rdx
 5586 014f 488B4DE8 		movq	-24(%rbp), %rcx
 5587 0153 488B45D8 		movq	-40(%rbp), %rax
 5588 0157 4889CE   		movq	%rcx, %rsi
 5589 015a 4889C7   		movq	%rax, %rdi
 5590 015d E8000000 		call	mbedtls_rsa_public
 5590      00
 5591 0162 8945E4   		movl	%eax, -28(%rbp)
 5592 0165 837DE400 		cmpl	$0, -28(%rbp)
 5593 0169 7548     		jne	.L416
2074:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2075:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mbedtls_safer_memcmp( verif, sig, ctx->len ) != 0 )
 5594              		.loc 1 2075 9
 5595 016b 488B45D8 		movq	-40(%rbp), %rax
 5596 016f 488B5008 		movq	8(%rax), %rdx
 5597 0173 488B4DA8 		movq	-88(%rbp), %rcx
 5598 0177 488B45F0 		movq	-16(%rbp), %rax
 5599 017b 4889CE   		movq	%rcx, %rsi
 5600 017e 4889C7   		movq	%rax, %rdi
 5601 0181 E8000000 		call	mbedtls_safer_memcmp
 5601      00
 5602              		.loc 1 2075 7
 5603 0186 85C0     		testl	%eax, %eax
 5604 0188 7409     		je	.L413
2076:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
2077:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ret = MBEDTLS_ERR_RSA_PRIVATE_FAILED;
 5605              		.loc 1 2077 13
 5606 018a C745E400 		movl	$-17152, -28(%rbp)
 5606      BDFFFF
2078:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto cleanup;
 5607              		.loc 1 2078 9
 5608 0191 EB21     		jmp	.L411
 5609              	.L413:
2079:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
GAS LISTING /tmp/cc6OITWc.s 			page 160


2080:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2081:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     memcpy( sig, sig_try, ctx->len );
 5610              		.loc 1 2081 5
 5611 0193 488B45D8 		movq	-40(%rbp), %rax
 5612 0197 488B5008 		movq	8(%rax), %rdx
 5613 019b 488B4DE8 		movq	-24(%rbp), %rcx
 5614 019f 488B45A8 		movq	-88(%rbp), %rax
 5615 01a3 4889CE   		movq	%rcx, %rsi
 5616 01a6 4889C7   		movq	%rax, %rdi
 5617 01a9 E8000000 		call	memcpy@PLT
 5617      00
 5618 01ae EB04     		jmp	.L411
 5619              	.L415:
2072:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_rsa_public( ctx, sig_try, verif ) );
 5620              		.loc 1 2072 5
 5621 01b0 90       		nop
 5622 01b1 EB01     		jmp	.L411
 5623              	.L416:
2073:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 5624              		.loc 1 2073 5
 5625 01b3 90       		nop
 5626              	.L411:
2082:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2083:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** cleanup:
2084:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_free( sig_try );
 5627              		.loc 1 2084 5
 5628 01b4 488B45E8 		movq	-24(%rbp), %rax
 5629 01b8 4889C7   		movq	%rax, %rdi
 5630 01bb E8000000 		call	mbedtls_free@PLT
 5630      00
2085:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_free( verif );
 5631              		.loc 1 2085 5
 5632 01c0 488B45F0 		movq	-16(%rbp), %rax
 5633 01c4 4889C7   		movq	%rax, %rdi
 5634 01c7 E8000000 		call	mbedtls_free@PLT
 5634      00
2086:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2087:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( ret );
 5635              		.loc 1 2087 11
 5636 01cc 8B45E4   		movl	-28(%rbp), %eax
 5637              	.L405:
2088:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 5638              		.loc 1 2088 1
 5639 01cf 488B75F8 		movq	-8(%rbp), %rsi
 5640 01d3 64483334 		xorq	%fs:40, %rsi
 5640      25280000 
 5640      00
 5641 01dc 7405     		je	.L414
 5642 01de E8000000 		call	__stack_chk_fail@PLT
 5642      00
 5643              	.L414:
 5644 01e3 C9       		leave
 5645              	.LCFI92:
 5646              		.cfi_def_cfa 7, 8
 5647 01e4 C3       		ret
 5648              		.cfi_endproc
 5649              	.LFE46:
GAS LISTING /tmp/cc6OITWc.s 			page 161


 5651              		.section	.text.mbedtls_rsa_pkcs1_sign,"ax",@progbits
 5652              		.globl	mbedtls_rsa_pkcs1_sign
 5654              	mbedtls_rsa_pkcs1_sign:
 5655              	.LFB47:
2089:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif /* MBEDTLS_PKCS1_V15 */
2090:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2091:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
2092:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Do an RSA operation to sign the message digest
2093:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
2094:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_pkcs1_sign( mbedtls_rsa_context *ctx,
2095:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                     int (*f_rng)(void *, unsigned char *, size_t),
2096:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                     void *p_rng,
2097:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                     int mode,
2098:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                     mbedtls_md_type_t md_alg,
2099:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                     unsigned int hashlen,
2100:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                     const unsigned char *hash,
2101:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                     unsigned char *sig )
2102:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 5656              		.loc 1 2102 1
 5657              		.cfi_startproc
 5658 0000 F30F1EFA 		endbr64
 5659 0004 55       		pushq	%rbp
 5660              	.LCFI93:
 5661              		.cfi_def_cfa_offset 16
 5662              		.cfi_offset 6, -16
 5663 0005 4889E5   		movq	%rsp, %rbp
 5664              	.LCFI94:
 5665              		.cfi_def_cfa_register 6
 5666 0008 4883EC50 		subq	$80, %rsp
 5667 000c 48897DE8 		movq	%rdi, -24(%rbp)
 5668 0010 488975E0 		movq	%rsi, -32(%rbp)
 5669 0014 488955D8 		movq	%rdx, -40(%rbp)
 5670 0018 894DD4   		movl	%ecx, -44(%rbp)
 5671 001b 448945D0 		movl	%r8d, -48(%rbp)
 5672 001f 44894DCC 		movl	%r9d, -52(%rbp)
 5673 0023 488B4510 		movq	16(%rbp), %rax
 5674 0027 488945C0 		movq	%rax, -64(%rbp)
 5675 002b 488B4518 		movq	24(%rbp), %rax
 5676 002f 488945B8 		movq	%rax, -72(%rbp)
 5677              		.loc 1 2102 1
 5678 0033 64488B04 		movq	%fs:40, %rax
 5678      25280000 
 5678      00
 5679 003c 488945F8 		movq	%rax, -8(%rbp)
 5680 0040 31C0     		xorl	%eax, %eax
2103:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
2104:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( mode == MBEDTLS_RSA_PRIVATE ||
2105:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       mode == MBEDTLS_RSA_PUBLIC );
2106:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ( md_alg  == MBEDTLS_MD_NONE &&
2107:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                         hashlen == 0 ) ||
2108:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       hash != NULL );
2109:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( sig != NULL );
2110:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2111:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     switch( ctx->padding )
 5681              		.loc 1 2111 16
 5682 0042 488B45E8 		movq	-24(%rbp), %rax
 5683 0046 8B804801 		movl	328(%rax), %eax
GAS LISTING /tmp/cc6OITWc.s 			page 162


 5683      0000
 5684              		.loc 1 2111 5
 5685 004c 85C0     		testl	%eax, %eax
 5686 004e 7407     		je	.L418
 5687 0050 83F801   		cmpl	$1, %eax
 5688 0053 7432     		je	.L419
 5689 0055 EB60     		jmp	.L423
 5690              	.L418:
2112:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
2113:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_PKCS1_V15)
2114:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         case MBEDTLS_RSA_PKCS_V15:
2115:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return mbedtls_rsa_rsassa_pkcs1_v15_sign( ctx, f_rng, p_rng, mode, md_alg,
 5691              		.loc 1 2115 20
 5692 0057 448B45CC 		movl	-52(%rbp), %r8d
 5693 005b 8B7DD0   		movl	-48(%rbp), %edi
 5694 005e 8B4DD4   		movl	-44(%rbp), %ecx
 5695 0061 488B55D8 		movq	-40(%rbp), %rdx
 5696 0065 488B75E0 		movq	-32(%rbp), %rsi
 5697 0069 488B45E8 		movq	-24(%rbp), %rax
 5698 006d FF75B8   		pushq	-72(%rbp)
 5699 0070 FF75C0   		pushq	-64(%rbp)
 5700 0073 4589C1   		movl	%r8d, %r9d
 5701 0076 4189F8   		movl	%edi, %r8d
 5702 0079 4889C7   		movq	%rax, %rdi
 5703 007c E8000000 		call	mbedtls_rsa_rsassa_pkcs1_v15_sign
 5703      00
 5704 0081 4883C410 		addq	$16, %rsp
 5705 0085 EB35     		jmp	.L421
 5706              	.L419:
2116:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                               hashlen, hash, sig );
2117:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
2118:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2119:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_PKCS1_V21)
2120:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         case MBEDTLS_RSA_PKCS_V21:
2121:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return mbedtls_rsa_rsassa_pss_sign( ctx, f_rng, p_rng, mode, md_alg,
 5707              		.loc 1 2121 20
 5708 0087 448B45CC 		movl	-52(%rbp), %r8d
 5709 008b 8B7DD0   		movl	-48(%rbp), %edi
 5710 008e 8B4DD4   		movl	-44(%rbp), %ecx
 5711 0091 488B55D8 		movq	-40(%rbp), %rdx
 5712 0095 488B75E0 		movq	-32(%rbp), %rsi
 5713 0099 488B45E8 		movq	-24(%rbp), %rax
 5714 009d FF75B8   		pushq	-72(%rbp)
 5715 00a0 FF75C0   		pushq	-64(%rbp)
 5716 00a3 4589C1   		movl	%r8d, %r9d
 5717 00a6 4189F8   		movl	%edi, %r8d
 5718 00a9 4889C7   		movq	%rax, %rdi
 5719 00ac E8000000 		call	mbedtls_rsa_rsassa_pss_sign
 5719      00
 5720 00b1 4883C410 		addq	$16, %rsp
 5721 00b5 EB05     		jmp	.L421
 5722              	.L423:
2122:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                         hashlen, hash, sig );
2123:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
2124:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2125:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         default:
2126:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return( MBEDTLS_ERR_RSA_INVALID_PADDING );
GAS LISTING /tmp/cc6OITWc.s 			page 163


 5723              		.loc 1 2126 19
 5724 00b7 B800BFFF 		movl	$-16640, %eax
 5724      FF
 5725              	.L421:
2127:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
2128:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 5726              		.loc 1 2128 1
 5727 00bc 488B55F8 		movq	-8(%rbp), %rdx
 5728 00c0 64483314 		xorq	%fs:40, %rdx
 5728      25280000 
 5728      00
 5729 00c9 7405     		je	.L422
 5730 00cb E8000000 		call	__stack_chk_fail@PLT
 5730      00
 5731              	.L422:
 5732 00d0 C9       		leave
 5733              	.LCFI95:
 5734              		.cfi_def_cfa 7, 8
 5735 00d1 C3       		ret
 5736              		.cfi_endproc
 5737              	.LFE47:
 5739              		.section	.text.mbedtls_rsa_rsassa_pss_verify_ext,"ax",@progbits
 5740              		.globl	mbedtls_rsa_rsassa_pss_verify_ext
 5742              	mbedtls_rsa_rsassa_pss_verify_ext:
 5743              	.LFB48:
2129:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2130:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_PKCS1_V21)
2131:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
2132:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Implementation of the PKCS#1 v2.1 RSASSA-PSS-VERIFY function
2133:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
2134:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_rsassa_pss_verify_ext( mbedtls_rsa_context *ctx,
2135:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                int (*f_rng)(void *, unsigned char *, size_t),
2136:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                void *p_rng,
2137:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                int mode,
2138:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                mbedtls_md_type_t md_alg,
2139:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                unsigned int hashlen,
2140:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                const unsigned char *hash,
2141:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                mbedtls_md_type_t mgf1_hash_id,
2142:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                int expected_salt_len,
2143:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                const unsigned char *sig )
2144:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 5744              		.loc 1 2144 1
 5745              		.cfi_startproc
 5746 0000 F30F1EFA 		endbr64
 5747 0004 55       		pushq	%rbp
 5748              	.LCFI96:
 5749              		.cfi_def_cfa_offset 16
 5750              		.cfi_offset 6, -16
 5751 0005 4889E5   		movq	%rsp, %rbp
 5752              	.LCFI97:
 5753              		.cfi_def_cfa_register 6
 5754 0008 4881ECD0 		subq	$1232, %rsp
 5754      040000
 5755 000f 4889BD68 		movq	%rdi, -1176(%rbp)
 5755      FBFFFF
 5756 0016 4889B560 		movq	%rsi, -1184(%rbp)
 5756      FBFFFF
GAS LISTING /tmp/cc6OITWc.s 			page 164


 5757 001d 48899558 		movq	%rdx, -1192(%rbp)
 5757      FBFFFF
 5758 0024 898D54FB 		movl	%ecx, -1196(%rbp)
 5758      FFFF
 5759 002a 44898550 		movl	%r8d, -1200(%rbp)
 5759      FBFFFF
 5760 0031 44898D4C 		movl	%r9d, -1204(%rbp)
 5760      FBFFFF
 5761 0038 488B4510 		movq	16(%rbp), %rax
 5762 003c 48898540 		movq	%rax, -1216(%rbp)
 5762      FBFFFF
 5763 0043 8B4518   		movl	24(%rbp), %eax
 5764 0046 898548FB 		movl	%eax, -1208(%rbp)
 5764      FFFF
 5765 004c 8B4520   		movl	32(%rbp), %eax
 5766 004f 89853CFB 		movl	%eax, -1220(%rbp)
 5766      FFFF
 5767 0055 488B4528 		movq	40(%rbp), %rax
 5768 0059 48898530 		movq	%rax, -1232(%rbp)
 5768      FBFFFF
 5769              		.loc 1 2144 1
 5770 0060 64488B04 		movq	%fs:40, %rax
 5770      25280000 
 5770      00
 5771 0069 488945F8 		movq	%rax, -8(%rbp)
 5772 006d 31C0     		xorl	%eax, %eax
2145:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int ret;
2146:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     size_t siglen;
2147:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned char *p;
2148:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned char *hash_start;
2149:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned char result[MBEDTLS_MD_MAX_SIZE];
2150:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned char zeros[8];
2151:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned int hlen;
2152:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     size_t observed_salt_len, msb;
2153:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     const mbedtls_md_info_t *md_info;
2154:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_md_context_t md_ctx;
2155:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned char buf[MBEDTLS_MPI_MAX_SIZE];
2156:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2157:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
2158:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( mode == MBEDTLS_RSA_PRIVATE ||
2159:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       mode == MBEDTLS_RSA_PUBLIC );
2160:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( sig != NULL );
2161:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ( md_alg  == MBEDTLS_MD_NONE &&
2162:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                         hashlen == 0 ) ||
2163:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       hash != NULL );
2164:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2165:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mode == MBEDTLS_RSA_PRIVATE && ctx->padding != MBEDTLS_RSA_PKCS_V21 )
 5773              		.loc 1 2165 7
 5774 006f 83BD54FB 		cmpl	$1, -1196(%rbp)
 5774      FFFF01
 5775 0076 751C     		jne	.L425
 5776              		.loc 1 2165 43 discriminator 1
 5777 0078 488B8568 		movq	-1176(%rbp), %rax
 5777      FBFFFF
 5778 007f 8B804801 		movl	328(%rax), %eax
 5778      0000
 5779              		.loc 1 2165 37 discriminator 1
GAS LISTING /tmp/cc6OITWc.s 			page 165


 5780 0085 83F801   		cmpl	$1, %eax
 5781 0088 740A     		je	.L425
2166:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 5782              		.loc 1 2166 15
 5783 008a B880BFFF 		movl	$-16512, %eax
 5783      FF
 5784 008f E9C10400 		jmp	.L452
 5784      00
 5785              	.L425:
2167:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2168:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     siglen = ctx->len;
 5786              		.loc 1 2168 12
 5787 0094 488B8568 		movq	-1176(%rbp), %rax
 5787      FBFFFF
 5788 009b 488B4008 		movq	8(%rax), %rax
 5789 009f 48898580 		movq	%rax, -1152(%rbp)
 5789      FBFFFF
2169:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2170:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( siglen < 16 || siglen > sizeof( buf ) )
 5790              		.loc 1 2170 7
 5791 00a6 4883BD80 		cmpq	$15, -1152(%rbp)
 5791      FBFFFF0F 
 5792 00ae 760D     		jbe	.L427
 5793              		.loc 1 2170 21 discriminator 1
 5794 00b0 4881BD80 		cmpq	$1024, -1152(%rbp)
 5794      FBFFFF00 
 5794      040000
 5795 00bb 760A     		jbe	.L428
 5796              	.L427:
2171:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 5797              		.loc 1 2171 15
 5798 00bd B880BFFF 		movl	$-16512, %eax
 5798      FF
 5799 00c2 E98E0400 		jmp	.L452
 5799      00
 5800              	.L428:
2172:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2173:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     ret = ( mode == MBEDTLS_RSA_PUBLIC )
2174:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****           ? mbedtls_rsa_public(  ctx, sig, buf )
2175:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****           : mbedtls_rsa_private( ctx, f_rng, p_rng, sig, buf );
 5801              		.loc 1 2175 11
 5802 00c7 83BD54FB 		cmpl	$0, -1196(%rbp)
 5802      FFFF00
 5803 00ce 7522     		jne	.L429
2174:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****           : mbedtls_rsa_private( ctx, f_rng, p_rng, sig, buf );
 5804              		.loc 1 2174 13
 5805 00d0 488D95F0 		leaq	-1040(%rbp), %rdx
 5805      FBFFFF
 5806 00d7 488B8D30 		movq	-1232(%rbp), %rcx
 5806      FBFFFF
 5807 00de 488B8568 		movq	-1176(%rbp), %rax
 5807      FBFFFF
 5808 00e5 4889CE   		movq	%rcx, %rsi
 5809 00e8 4889C7   		movq	%rax, %rdi
 5810 00eb E8000000 		call	mbedtls_rsa_public
 5810      00
 5811 00f0 EB2E     		jmp	.L430
GAS LISTING /tmp/cc6OITWc.s 			page 166


 5812              	.L429:
 5813              		.loc 1 2175 13 discriminator 1
 5814 00f2 488DBDF0 		leaq	-1040(%rbp), %rdi
 5814      FBFFFF
 5815 00f9 488B8D30 		movq	-1232(%rbp), %rcx
 5815      FBFFFF
 5816 0100 488B9558 		movq	-1192(%rbp), %rdx
 5816      FBFFFF
 5817 0107 488BB560 		movq	-1184(%rbp), %rsi
 5817      FBFFFF
 5818 010e 488B8568 		movq	-1176(%rbp), %rax
 5818      FBFFFF
 5819 0115 4989F8   		movq	%rdi, %r8
 5820 0118 4889C7   		movq	%rax, %rdi
 5821 011b E8000000 		call	mbedtls_rsa_private
 5821      00
 5822              	.L430:
2173:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****           ? mbedtls_rsa_public(  ctx, sig, buf )
 5823              		.loc 1 2173 9
 5824 0120 898578FB 		movl	%eax, -1160(%rbp)
 5824      FFFF
2176:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2177:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ret != 0 )
 5825              		.loc 1 2177 7
 5826 0126 83BD78FB 		cmpl	$0, -1160(%rbp)
 5826      FFFF00
 5827 012d 740B     		je	.L431
2178:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( ret );
 5828              		.loc 1 2178 15
 5829 012f 8B8578FB 		movl	-1160(%rbp), %eax
 5829      FFFF
 5830 0135 E91B0400 		jmp	.L452
 5830      00
 5831              	.L431:
2179:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2180:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     p = buf;
 5832              		.loc 1 2180 7
 5833 013a 488D85F0 		leaq	-1040(%rbp), %rax
 5833      FBFFFF
 5834 0141 48898588 		movq	%rax, -1144(%rbp)
 5834      FBFFFF
2181:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2182:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( buf[siglen - 1] != 0xBC )
 5835              		.loc 1 2182 20
 5836 0148 488B8580 		movq	-1152(%rbp), %rax
 5836      FBFFFF
 5837 014f 4883E801 		subq	$1, %rax
 5838              		.loc 1 2182 12
 5839 0153 0FB68405 		movzbl	-1040(%rbp,%rax), %eax
 5839      F0FBFFFF 
 5840              		.loc 1 2182 7
 5841 015b 3CBC     		cmpb	$-68, %al
 5842 015d 740A     		je	.L432
2183:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_INVALID_PADDING );
 5843              		.loc 1 2183 15
 5844 015f B800BFFF 		movl	$-16640, %eax
 5844      FF
GAS LISTING /tmp/cc6OITWc.s 			page 167


 5845 0164 E9EC0300 		jmp	.L452
 5845      00
 5846              	.L432:
2184:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2185:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( md_alg != MBEDTLS_MD_NONE )
 5847              		.loc 1 2185 7
 5848 0169 83BD50FB 		cmpl	$0, -1200(%rbp)
 5848      FFFF00
 5849 0170 7440     		je	.L433
2186:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
2187:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         /* Gather length of hash to sign */
2188:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         md_info = mbedtls_md_info_from_type( md_alg );
 5850              		.loc 1 2188 19
 5851 0172 8B8550FB 		movl	-1200(%rbp), %eax
 5851      FFFF
 5852 0178 89C7     		movl	%eax, %edi
 5853 017a E8000000 		call	mbedtls_md_info_from_type@PLT
 5853      00
 5854 017f 48898590 		movq	%rax, -1136(%rbp)
 5854      FBFFFF
2189:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         if( md_info == NULL )
 5855              		.loc 1 2189 11
 5856 0186 4883BD90 		cmpq	$0, -1136(%rbp)
 5856      FBFFFF00 
 5857 018e 750A     		jne	.L434
2190:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 5858              		.loc 1 2190 19
 5859 0190 B880BFFF 		movl	$-16512, %eax
 5859      FF
 5860 0195 E9BB0300 		jmp	.L452
 5860      00
 5861              	.L434:
2191:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2192:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         hashlen = mbedtls_md_get_size( md_info );
 5862              		.loc 1 2192 19
 5863 019a 488B8590 		movq	-1136(%rbp), %rax
 5863      FBFFFF
 5864 01a1 4889C7   		movq	%rax, %rdi
 5865 01a4 E8000000 		call	mbedtls_md_get_size@PLT
 5865      00
 5866              		.loc 1 2192 17
 5867 01a9 0FB6C0   		movzbl	%al, %eax
 5868 01ac 89854CFB 		movl	%eax, -1204(%rbp)
 5868      FFFF
 5869              	.L433:
2193:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
2194:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2195:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     md_info = mbedtls_md_info_from_type( mgf1_hash_id );
 5870              		.loc 1 2195 15
 5871 01b2 8B8548FB 		movl	-1208(%rbp), %eax
 5871      FFFF
 5872 01b8 89C7     		movl	%eax, %edi
 5873 01ba E8000000 		call	mbedtls_md_info_from_type@PLT
 5873      00
 5874 01bf 48898590 		movq	%rax, -1136(%rbp)
 5874      FBFFFF
2196:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( md_info == NULL )
GAS LISTING /tmp/cc6OITWc.s 			page 168


 5875              		.loc 1 2196 7
 5876 01c6 4883BD90 		cmpq	$0, -1136(%rbp)
 5876      FBFFFF00 
 5877 01ce 750A     		jne	.L435
2197:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 5878              		.loc 1 2197 15
 5879 01d0 B880BFFF 		movl	$-16512, %eax
 5879      FF
 5880 01d5 E97B0300 		jmp	.L452
 5880      00
 5881              	.L435:
2198:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2199:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     hlen = mbedtls_md_get_size( md_info );
 5882              		.loc 1 2199 12
 5883 01da 488B8590 		movq	-1136(%rbp), %rax
 5883      FBFFFF
 5884 01e1 4889C7   		movq	%rax, %rdi
 5885 01e4 E8000000 		call	mbedtls_md_get_size@PLT
 5885      00
 5886              		.loc 1 2199 10
 5887 01e9 0FB6C0   		movzbl	%al, %eax
 5888 01ec 89857CFB 		movl	%eax, -1156(%rbp)
 5888      FFFF
2200:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2201:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     memset( zeros, 0, 8 );
 5889              		.loc 1 2201 5
 5890 01f2 488D85C8 		leaq	-1080(%rbp), %rax
 5890      FBFFFF
 5891 01f9 BA080000 		movl	$8, %edx
 5891      00
 5892 01fe BE000000 		movl	$0, %esi
 5892      00
 5893 0203 4889C7   		movq	%rax, %rdi
 5894 0206 E8000000 		call	memset@PLT
 5894      00
2202:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2203:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
2204:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * Note: EMSA-PSS verification is over the length of N - 1 bits
2205:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
2206:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     msb = mbedtls_mpi_bitlen( &ctx->N ) - 1;
 5895              		.loc 1 2206 31
 5896 020b 488B8568 		movq	-1176(%rbp), %rax
 5896      FBFFFF
 5897 0212 4883C010 		addq	$16, %rax
 5898              		.loc 1 2206 11
 5899 0216 4889C7   		movq	%rax, %rdi
 5900 0219 E8000000 		call	mbedtls_mpi_bitlen@PLT
 5900      00
 5901              		.loc 1 2206 9
 5902 021e 4883E801 		subq	$1, %rax
 5903 0222 48898598 		movq	%rax, -1128(%rbp)
 5903      FBFFFF
2207:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2208:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( buf[0] >> ( 8 - siglen * 8 + msb ) )
 5904              		.loc 1 2208 12
 5905 0229 0FB685F0 		movzbl	-1040(%rbp), %eax
 5905      FBFFFF
GAS LISTING /tmp/cc6OITWc.s 			page 169


 5906 0230 0FB6D0   		movzbl	%al, %edx
 5907              		.loc 1 2208 23
 5908 0233 B8010000 		movl	$1, %eax
 5908      00
 5909 0238 482B8580 		subq	-1152(%rbp), %rax
 5909      FBFFFF
 5910              		.loc 1 2208 36
 5911 023f 8D0CC500 		leal	0(,%rax,8), %ecx
 5911      000000
 5912 0246 488B8598 		movq	-1128(%rbp), %rax
 5912      FBFFFF
 5913 024d 01C8     		addl	%ecx, %eax
 5914              		.loc 1 2208 16
 5915 024f 89C1     		movl	%eax, %ecx
 5916 0251 D3FA     		sarl	%cl, %edx
 5917 0253 89D0     		movl	%edx, %eax
 5918              		.loc 1 2208 7
 5919 0255 85C0     		testl	%eax, %eax
 5920 0257 740A     		je	.L436
2209:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 5921              		.loc 1 2209 15
 5922 0259 B880BFFF 		movl	$-16512, %eax
 5922      FF
 5923 025e E9F20200 		jmp	.L452
 5923      00
 5924              	.L436:
2210:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2211:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /* Compensate for boundary condition when applying mask */
2212:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( msb % 8 == 0 )
 5925              		.loc 1 2212 13
 5926 0263 488B8598 		movq	-1128(%rbp), %rax
 5926      FBFFFF
 5927 026a 83E007   		andl	$7, %eax
 5928              		.loc 1 2212 7
 5929 026d 4885C0   		testq	%rax, %rax
 5930 0270 7510     		jne	.L437
2213:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
2214:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         p++;
 5931              		.loc 1 2214 10
 5932 0272 48838588 		addq	$1, -1144(%rbp)
 5932      FBFFFF01 
2215:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         siglen -= 1;
 5933              		.loc 1 2215 16
 5934 027a 4883AD80 		subq	$1, -1152(%rbp)
 5934      FBFFFF01 
 5935              	.L437:
2216:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
2217:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2218:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( siglen < hlen + 2 )
 5936              		.loc 1 2218 23
 5937 0282 8B857CFB 		movl	-1156(%rbp), %eax
 5937      FFFF
 5938 0288 83C002   		addl	$2, %eax
 5939 028b 89C0     		movl	%eax, %eax
 5940              		.loc 1 2218 7
 5941 028d 48398580 		cmpq	%rax, -1152(%rbp)
 5941      FBFFFF
GAS LISTING /tmp/cc6OITWc.s 			page 170


 5942 0294 730A     		jnb	.L438
2219:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 5943              		.loc 1 2219 15
 5944 0296 B880BFFF 		movl	$-16512, %eax
 5944      FF
 5945 029b E9B50200 		jmp	.L452
 5945      00
 5946              	.L438:
2220:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     hash_start = p + siglen - hlen - 1;
 5947              		.loc 1 2220 29
 5948 02a0 8B857CFB 		movl	-1156(%rbp), %eax
 5948      FFFF
 5949 02a6 488B9580 		movq	-1152(%rbp), %rdx
 5949      FBFFFF
 5950 02ad 4829C2   		subq	%rax, %rdx
 5951 02b0 4889D0   		movq	%rdx, %rax
 5952              		.loc 1 2220 36
 5953 02b3 488D50FF 		leaq	-1(%rax), %rdx
 5954              		.loc 1 2220 16
 5955 02b7 488B8588 		movq	-1144(%rbp), %rax
 5955      FBFFFF
 5956 02be 4801D0   		addq	%rdx, %rax
 5957 02c1 488985A0 		movq	%rax, -1120(%rbp)
 5957      FBFFFF
2221:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2222:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_md_init( &md_ctx );
 5958              		.loc 1 2222 5
 5959 02c8 488D85B0 		leaq	-1104(%rbp), %rax
 5959      FBFFFF
 5960 02cf 4889C7   		movq	%rax, %rdi
 5961 02d2 E8000000 		call	mbedtls_md_init@PLT
 5961      00
2223:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = mbedtls_md_setup( &md_ctx, md_info, 0 ) ) != 0 )
 5962              		.loc 1 2223 17
 5963 02d7 488B8D90 		movq	-1136(%rbp), %rcx
 5963      FBFFFF
 5964 02de 488D85B0 		leaq	-1104(%rbp), %rax
 5964      FBFFFF
 5965 02e5 BA000000 		movl	$0, %edx
 5965      00
 5966 02ea 4889CE   		movq	%rcx, %rsi
 5967 02ed 4889C7   		movq	%rax, %rdi
 5968 02f0 E8000000 		call	mbedtls_md_setup@PLT
 5968      00
 5969 02f5 898578FB 		movl	%eax, -1160(%rbp)
 5969      FFFF
 5970              		.loc 1 2223 7
 5971 02fb 83BD78FB 		cmpl	$0, -1160(%rbp)
 5971      FFFF00
 5972 0302 0F852202 		jne	.L454
 5972      0000
2224:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto exit;
2225:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2226:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     ret = mgf_mask( p, siglen - hlen - 1, hash_start, hlen, &md_ctx );
 5973              		.loc 1 2226 11
 5974 0308 8B8D7CFB 		movl	-1156(%rbp), %ecx
 5974      FFFF
GAS LISTING /tmp/cc6OITWc.s 			page 171


 5975              		.loc 1 2226 31
 5976 030e 8B857CFB 		movl	-1156(%rbp), %eax
 5976      FFFF
 5977 0314 488B9580 		movq	-1152(%rbp), %rdx
 5977      FBFFFF
 5978 031b 4829C2   		subq	%rax, %rdx
 5979 031e 4889D0   		movq	%rdx, %rax
 5980              		.loc 1 2226 11
 5981 0321 488D70FF 		leaq	-1(%rax), %rsi
 5982 0325 488DBDB0 		leaq	-1104(%rbp), %rdi
 5982      FBFFFF
 5983 032c 488B95A0 		movq	-1120(%rbp), %rdx
 5983      FBFFFF
 5984 0333 488B8588 		movq	-1144(%rbp), %rax
 5984      FBFFFF
 5985 033a 4989F8   		movq	%rdi, %r8
 5986 033d 4889C7   		movq	%rax, %rdi
 5987 0340 E8000000 		call	mgf_mask
 5987      00
 5988 0345 898578FB 		movl	%eax, -1160(%rbp)
 5988      FFFF
2227:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ret != 0 )
 5989              		.loc 1 2227 7
 5990 034b 83BD78FB 		cmpl	$0, -1160(%rbp)
 5990      FFFF00
 5991 0352 0F85D501 		jne	.L455
 5991      0000
2228:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto exit;
2229:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2230:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     buf[0] &= 0xFF >> ( siglen * 8 - msb );
 5992              		.loc 1 2230 12
 5993 0358 0FB685F0 		movzbl	-1040(%rbp), %eax
 5993      FBFFFF
 5994 035f 89C6     		movl	%eax, %esi
 5995              		.loc 1 2230 36
 5996 0361 488B8580 		movq	-1152(%rbp), %rax
 5996      FBFFFF
 5997 0368 8D14C500 		leal	0(,%rax,8), %edx
 5997      000000
 5998 036f 488B8598 		movq	-1128(%rbp), %rax
 5998      FBFFFF
 5999 0376 29C2     		subl	%eax, %edx
 6000 0378 89D0     		movl	%edx, %eax
 6001              		.loc 1 2230 20
 6002 037a BAFF0000 		movl	$255, %edx
 6002      00
 6003 037f 89C1     		movl	%eax, %ecx
 6004 0381 D3FA     		sarl	%cl, %edx
 6005 0383 89D0     		movl	%edx, %eax
 6006              		.loc 1 2230 12
 6007 0385 21F0     		andl	%esi, %eax
 6008 0387 8885F0FB 		movb	%al, -1040(%rbp)
 6008      FFFF
2231:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2232:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     while( p < hash_start - 1 && *p == 0 )
 6009              		.loc 1 2232 10
 6010 038d EB08     		jmp	.L442
GAS LISTING /tmp/cc6OITWc.s 			page 172


 6011              	.L444:
2233:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         p++;
 6012              		.loc 1 2233 10
 6013 038f 48838588 		addq	$1, -1144(%rbp)
 6013      FBFFFF01 
 6014              	.L442:
2232:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         p++;
 6015              		.loc 1 2232 27
 6016 0397 488B85A0 		movq	-1120(%rbp), %rax
 6016      FBFFFF
 6017 039e 4883E801 		subq	$1, %rax
2232:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         p++;
 6018              		.loc 1 2232 10
 6019 03a2 48398588 		cmpq	%rax, -1144(%rbp)
 6019      FBFFFF
 6020 03a9 730E     		jnb	.L443
2232:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         p++;
 6021              		.loc 1 2232 34 discriminator 1
 6022 03ab 488B8588 		movq	-1144(%rbp), %rax
 6022      FBFFFF
 6023 03b2 0FB600   		movzbl	(%rax), %eax
2232:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         p++;
 6024              		.loc 1 2232 31 discriminator 1
 6025 03b5 84C0     		testb	%al, %al
 6026 03b7 74D6     		je	.L444
 6027              	.L443:
2234:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2235:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( *p++ != 0x01 )
 6028              		.loc 1 2235 11
 6029 03b9 488B8588 		movq	-1144(%rbp), %rax
 6029      FBFFFF
 6030 03c0 488D5001 		leaq	1(%rax), %rdx
 6031 03c4 48899588 		movq	%rdx, -1144(%rbp)
 6031      FBFFFF
 6032              		.loc 1 2235 9
 6033 03cb 0FB600   		movzbl	(%rax), %eax
 6034              		.loc 1 2235 7
 6035 03ce 3C01     		cmpb	$1, %al
 6036 03d0 740F     		je	.L445
2236:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
2237:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ret = MBEDTLS_ERR_RSA_INVALID_PADDING;
 6037              		.loc 1 2237 13
 6038 03d2 C78578FB 		movl	$-16640, -1160(%rbp)
 6038      FFFF00BF 
 6038      FFFF
2238:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto exit;
 6039              		.loc 1 2238 9
 6040 03dc E95F0100 		jmp	.L440
 6040      00
 6041              	.L445:
2239:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
2240:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2241:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     observed_salt_len = hash_start - p;
 6042              		.loc 1 2241 36
 6043 03e1 488B85A0 		movq	-1120(%rbp), %rax
 6043      FBFFFF
 6044 03e8 482B8588 		subq	-1144(%rbp), %rax
GAS LISTING /tmp/cc6OITWc.s 			page 173


 6044      FBFFFF
 6045              		.loc 1 2241 23
 6046 03ef 488985A8 		movq	%rax, -1112(%rbp)
 6046      FBFFFF
2242:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2243:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( expected_salt_len != MBEDTLS_RSA_SALT_LEN_ANY &&
 6047              		.loc 1 2243 7
 6048 03f6 83BD3CFB 		cmpl	$-1, -1220(%rbp)
 6048      FFFFFF
 6049 03fd 7420     		je	.L446
2244:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         observed_salt_len != (size_t) expected_salt_len )
 6050              		.loc 1 2244 30 discriminator 1
 6051 03ff 8B853CFB 		movl	-1220(%rbp), %eax
 6051      FFFF
 6052 0405 4898     		cltq
2243:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         observed_salt_len != (size_t) expected_salt_len )
 6053              		.loc 1 2243 55 discriminator 1
 6054 0407 483985A8 		cmpq	%rax, -1112(%rbp)
 6054      FBFFFF
 6055 040e 740F     		je	.L446
2245:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
2246:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ret = MBEDTLS_ERR_RSA_INVALID_PADDING;
 6056              		.loc 1 2246 13
 6057 0410 C78578FB 		movl	$-16640, -1160(%rbp)
 6057      FFFF00BF 
 6057      FFFF
2247:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto exit;
 6058              		.loc 1 2247 9
 6059 041a E9210100 		jmp	.L440
 6059      00
 6060              	.L446:
2248:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
2249:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2250:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
2251:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * Generate H = Hash( M' )
2252:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
2253:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     ret = mbedtls_md_starts( &md_ctx );
 6061              		.loc 1 2253 11
 6062 041f 488D85B0 		leaq	-1104(%rbp), %rax
 6062      FBFFFF
 6063 0426 4889C7   		movq	%rax, %rdi
 6064 0429 E8000000 		call	mbedtls_md_starts@PLT
 6064      00
 6065 042e 898578FB 		movl	%eax, -1160(%rbp)
 6065      FFFF
2254:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if ( ret != 0 )
 6066              		.loc 1 2254 8
 6067 0434 83BD78FB 		cmpl	$0, -1160(%rbp)
 6067      FFFF00
 6068 043b 0F85EF00 		jne	.L456
 6068      0000
2255:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto exit;
2256:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     ret = mbedtls_md_update( &md_ctx, zeros, 8 );
 6069              		.loc 1 2256 11
 6070 0441 488D8DC8 		leaq	-1080(%rbp), %rcx
 6070      FBFFFF
 6071 0448 488D85B0 		leaq	-1104(%rbp), %rax
GAS LISTING /tmp/cc6OITWc.s 			page 174


 6071      FBFFFF
 6072 044f BA080000 		movl	$8, %edx
 6072      00
 6073 0454 4889CE   		movq	%rcx, %rsi
 6074 0457 4889C7   		movq	%rax, %rdi
 6075 045a E8000000 		call	mbedtls_md_update@PLT
 6075      00
 6076 045f 898578FB 		movl	%eax, -1160(%rbp)
 6076      FFFF
2257:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if ( ret != 0 )
 6077              		.loc 1 2257 8
 6078 0465 83BD78FB 		cmpl	$0, -1160(%rbp)
 6078      FFFF00
 6079 046c 0F85C100 		jne	.L457
 6079      0000
2258:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto exit;
2259:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     ret = mbedtls_md_update( &md_ctx, hash, hashlen );
 6080              		.loc 1 2259 11
 6081 0472 8B954CFB 		movl	-1204(%rbp), %edx
 6081      FFFF
 6082 0478 488B8D40 		movq	-1216(%rbp), %rcx
 6082      FBFFFF
 6083 047f 488D85B0 		leaq	-1104(%rbp), %rax
 6083      FBFFFF
 6084 0486 4889CE   		movq	%rcx, %rsi
 6085 0489 4889C7   		movq	%rax, %rdi
 6086 048c E8000000 		call	mbedtls_md_update@PLT
 6086      00
 6087 0491 898578FB 		movl	%eax, -1160(%rbp)
 6087      FFFF
2260:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if ( ret != 0 )
 6088              		.loc 1 2260 8
 6089 0497 83BD78FB 		cmpl	$0, -1160(%rbp)
 6089      FFFF00
 6090 049e 0F859200 		jne	.L458
 6090      0000
2261:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto exit;
2262:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     ret = mbedtls_md_update( &md_ctx, p, observed_salt_len );
 6091              		.loc 1 2262 11
 6092 04a4 488B95A8 		movq	-1112(%rbp), %rdx
 6092      FBFFFF
 6093 04ab 488B8D88 		movq	-1144(%rbp), %rcx
 6093      FBFFFF
 6094 04b2 488D85B0 		leaq	-1104(%rbp), %rax
 6094      FBFFFF
 6095 04b9 4889CE   		movq	%rcx, %rsi
 6096 04bc 4889C7   		movq	%rax, %rdi
 6097 04bf E8000000 		call	mbedtls_md_update@PLT
 6097      00
 6098 04c4 898578FB 		movl	%eax, -1160(%rbp)
 6098      FFFF
2263:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if ( ret != 0 )
 6099              		.loc 1 2263 8
 6100 04ca 83BD78FB 		cmpl	$0, -1160(%rbp)
 6100      FFFF00
 6101 04d1 7566     		jne	.L459
2264:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto exit;
GAS LISTING /tmp/cc6OITWc.s 			page 175


2265:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     ret = mbedtls_md_finish( &md_ctx, result );
 6102              		.loc 1 2265 11
 6103 04d3 488D95D0 		leaq	-1072(%rbp), %rdx
 6103      FBFFFF
 6104 04da 488D85B0 		leaq	-1104(%rbp), %rax
 6104      FBFFFF
 6105 04e1 4889D6   		movq	%rdx, %rsi
 6106 04e4 4889C7   		movq	%rax, %rdi
 6107 04e7 E8000000 		call	mbedtls_md_finish@PLT
 6107      00
 6108 04ec 898578FB 		movl	%eax, -1160(%rbp)
 6108      FFFF
2266:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if ( ret != 0 )
 6109              		.loc 1 2266 8
 6110 04f2 83BD78FB 		cmpl	$0, -1160(%rbp)
 6110      FFFF00
 6111 04f9 7541     		jne	.L460
2267:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto exit;
2268:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2269:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( memcmp( hash_start, result, hlen ) != 0 )
 6112              		.loc 1 2269 9
 6113 04fb 8B957CFB 		movl	-1156(%rbp), %edx
 6113      FFFF
 6114 0501 488D8DD0 		leaq	-1072(%rbp), %rcx
 6114      FBFFFF
 6115 0508 488B85A0 		movq	-1120(%rbp), %rax
 6115      FBFFFF
 6116 050f 4889CE   		movq	%rcx, %rsi
 6117 0512 4889C7   		movq	%rax, %rdi
 6118 0515 E8000000 		call	memcmp@PLT
 6118      00
 6119              		.loc 1 2269 7
 6120 051a 85C0     		testl	%eax, %eax
 6121 051c 7421     		je	.L461
2270:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
2271:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ret = MBEDTLS_ERR_RSA_VERIFY_FAILED;
 6122              		.loc 1 2271 13
 6123 051e C78578FB 		movl	$-17280, -1160(%rbp)
 6123      FFFF80BC 
 6123      FFFF
2272:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto exit;
 6124              		.loc 1 2272 9
 6125 0528 EB16     		jmp	.L440
 6126              	.L454:
2224:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 6127              		.loc 1 2224 9
 6128 052a 90       		nop
 6129 052b EB13     		jmp	.L440
 6130              	.L455:
2228:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 6131              		.loc 1 2228 9
 6132 052d 90       		nop
 6133 052e EB10     		jmp	.L440
 6134              	.L456:
2255:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     ret = mbedtls_md_update( &md_ctx, zeros, 8 );
 6135              		.loc 1 2255 9
 6136 0530 90       		nop
GAS LISTING /tmp/cc6OITWc.s 			page 176


 6137 0531 EB0D     		jmp	.L440
 6138              	.L457:
2258:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     ret = mbedtls_md_update( &md_ctx, hash, hashlen );
 6139              		.loc 1 2258 9
 6140 0533 90       		nop
 6141 0534 EB0A     		jmp	.L440
 6142              	.L458:
2261:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     ret = mbedtls_md_update( &md_ctx, p, observed_salt_len );
 6143              		.loc 1 2261 9
 6144 0536 90       		nop
 6145 0537 EB07     		jmp	.L440
 6146              	.L459:
2264:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     ret = mbedtls_md_finish( &md_ctx, result );
 6147              		.loc 1 2264 9
 6148 0539 90       		nop
 6149 053a EB04     		jmp	.L440
 6150              	.L460:
2267:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 6151              		.loc 1 2267 9
 6152 053c 90       		nop
 6153 053d EB01     		jmp	.L440
 6154              	.L461:
2273:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
2274:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2275:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** exit:
 6155              		.loc 1 2275 1
 6156 053f 90       		nop
 6157              	.L440:
2276:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_md_free( &md_ctx );
 6158              		.loc 1 2276 5
 6159 0540 488D85B0 		leaq	-1104(%rbp), %rax
 6159      FBFFFF
 6160 0547 4889C7   		movq	%rax, %rdi
 6161 054a E8000000 		call	mbedtls_md_free@PLT
 6161      00
2277:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2278:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( ret );
 6162              		.loc 1 2278 11
 6163 054f 8B8578FB 		movl	-1160(%rbp), %eax
 6163      FFFF
 6164              	.L452:
2279:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 6165              		.loc 1 2279 1 discriminator 1
 6166 0555 488B75F8 		movq	-8(%rbp), %rsi
 6167 0559 64483334 		xorq	%fs:40, %rsi
 6167      25280000 
 6167      00
 6168 0562 7405     		je	.L453
 6169              		.loc 1 2279 1 is_stmt 0
 6170 0564 E8000000 		call	__stack_chk_fail@PLT
 6170      00
 6171              	.L453:
 6172 0569 C9       		leave
 6173              	.LCFI98:
 6174              		.cfi_def_cfa 7, 8
 6175 056a C3       		ret
 6176              		.cfi_endproc
GAS LISTING /tmp/cc6OITWc.s 			page 177


 6177              	.LFE48:
 6179              		.section	.text.mbedtls_rsa_rsassa_pss_verify,"ax",@progbits
 6180              		.globl	mbedtls_rsa_rsassa_pss_verify
 6182              	mbedtls_rsa_rsassa_pss_verify:
 6183              	.LFB49:
2280:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2281:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
2282:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Simplified PKCS#1 v2.1 RSASSA-PSS-VERIFY function
2283:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
2284:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_rsassa_pss_verify( mbedtls_rsa_context *ctx,
2285:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                            int (*f_rng)(void *, unsigned char *, size_t),
2286:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                            void *p_rng,
2287:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                            int mode,
2288:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                            mbedtls_md_type_t md_alg,
2289:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                            unsigned int hashlen,
2290:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                            const unsigned char *hash,
2291:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                            const unsigned char *sig )
2292:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 6184              		.loc 1 2292 1 is_stmt 1
 6185              		.cfi_startproc
 6186 0000 F30F1EFA 		endbr64
 6187 0004 55       		pushq	%rbp
 6188              	.LCFI99:
 6189              		.cfi_def_cfa_offset 16
 6190              		.cfi_offset 6, -16
 6191 0005 4889E5   		movq	%rsp, %rbp
 6192              	.LCFI100:
 6193              		.cfi_def_cfa_register 6
 6194 0008 4883EC50 		subq	$80, %rsp
 6195 000c 48897DE8 		movq	%rdi, -24(%rbp)
 6196 0010 488975E0 		movq	%rsi, -32(%rbp)
 6197 0014 488955D8 		movq	%rdx, -40(%rbp)
 6198 0018 894DD4   		movl	%ecx, -44(%rbp)
 6199 001b 448945D0 		movl	%r8d, -48(%rbp)
 6200 001f 44894DCC 		movl	%r9d, -52(%rbp)
 6201 0023 488B4510 		movq	16(%rbp), %rax
 6202 0027 488945C0 		movq	%rax, -64(%rbp)
 6203 002b 488B4518 		movq	24(%rbp), %rax
 6204 002f 488945B8 		movq	%rax, -72(%rbp)
 6205              		.loc 1 2292 1
 6206 0033 64488B04 		movq	%fs:40, %rax
 6206      25280000 
 6206      00
 6207 003c 488945F8 		movq	%rax, -8(%rbp)
 6208 0040 31C0     		xorl	%eax, %eax
2293:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_md_type_t mgf1_hash_id;
2294:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
2295:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( mode == MBEDTLS_RSA_PRIVATE ||
2296:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       mode == MBEDTLS_RSA_PUBLIC );
2297:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( sig != NULL );
2298:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ( md_alg  == MBEDTLS_MD_NONE &&
2299:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                         hashlen == 0 ) ||
2300:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       hash != NULL );
2301:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2302:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mgf1_hash_id = ( ctx->hash_id != MBEDTLS_MD_NONE )
 6209              		.loc 1 2302 25
 6210 0042 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/cc6OITWc.s 			page 178


 6211 0046 8B804C01 		movl	332(%rax), %eax
 6211      0000
2303:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                              ? (mbedtls_md_type_t) ctx->hash_id
2304:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                              : md_alg;
 6212              		.loc 1 2304 30
 6213 004c 85C0     		testl	%eax, %eax
 6214 004e 740C     		je	.L463
2303:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                              ? (mbedtls_md_type_t) ctx->hash_id
 6215              		.loc 1 2303 55 discriminator 1
 6216 0050 488B45E8 		movq	-24(%rbp), %rax
 6217 0054 8B804C01 		movl	332(%rax), %eax
 6217      0000
 6218 005a EB03     		jmp	.L464
 6219              	.L463:
 6220              		.loc 1 2304 30 discriminator 2
 6221 005c 8B45D0   		movl	-48(%rbp), %eax
 6222              	.L464:
2302:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                              ? (mbedtls_md_type_t) ctx->hash_id
 6223              		.loc 1 2302 18
 6224 005f 8945F4   		movl	%eax, -12(%rbp)
2305:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2306:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( mbedtls_rsa_rsassa_pss_verify_ext( ctx, f_rng, p_rng, mode,
 6225              		.loc 1 2306 13
 6226 0062 448B4DCC 		movl	-52(%rbp), %r9d
 6227 0066 448B45D0 		movl	-48(%rbp), %r8d
 6228 006a 8B4DD4   		movl	-44(%rbp), %ecx
 6229 006d 488B55D8 		movq	-40(%rbp), %rdx
 6230 0071 488B75E0 		movq	-32(%rbp), %rsi
 6231 0075 488B45E8 		movq	-24(%rbp), %rax
 6232 0079 FF75B8   		pushq	-72(%rbp)
 6233 007c 6AFF     		pushq	$-1
 6234 007e 8B7DF4   		movl	-12(%rbp), %edi
 6235 0081 57       		pushq	%rdi
 6236 0082 FF75C0   		pushq	-64(%rbp)
 6237 0085 4889C7   		movq	%rax, %rdi
 6238 0088 E8000000 		call	mbedtls_rsa_rsassa_pss_verify_ext
 6238      00
 6239 008d 4883C420 		addq	$32, %rsp
2307:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                        md_alg, hashlen, hash,
2308:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                        mgf1_hash_id, MBEDTLS_RSA_SALT_LEN_ANY,
2309:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                        sig ) );
2310:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2311:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 6240              		.loc 1 2311 1
 6241 0091 488B55F8 		movq	-8(%rbp), %rdx
 6242 0095 64483314 		xorq	%fs:40, %rdx
 6242      25280000 
 6242      00
 6243 009e 7405     		je	.L466
 6244 00a0 E8000000 		call	__stack_chk_fail@PLT
 6244      00
 6245              	.L466:
 6246 00a5 C9       		leave
 6247              	.LCFI101:
 6248              		.cfi_def_cfa 7, 8
 6249 00a6 C3       		ret
 6250              		.cfi_endproc
GAS LISTING /tmp/cc6OITWc.s 			page 179


 6251              	.LFE49:
 6253              		.section	.text.mbedtls_rsa_rsassa_pkcs1_v15_verify,"ax",@progbits
 6254              		.globl	mbedtls_rsa_rsassa_pkcs1_v15_verify
 6256              	mbedtls_rsa_rsassa_pkcs1_v15_verify:
 6257              	.LFB50:
2312:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif /* MBEDTLS_PKCS1_V21 */
2313:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2314:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_PKCS1_V15)
2315:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
2316:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Implementation of the PKCS#1 v2.1 RSASSA-PKCS1-v1_5-VERIFY function
2317:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
2318:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_rsassa_pkcs1_v15_verify( mbedtls_rsa_context *ctx,
2319:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                  int (*f_rng)(void *, unsigned char *, size_t),
2320:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                  void *p_rng,
2321:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                  int mode,
2322:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                  mbedtls_md_type_t md_alg,
2323:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                  unsigned int hashlen,
2324:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                  const unsigned char *hash,
2325:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                  const unsigned char *sig )
2326:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 6258              		.loc 1 2326 1
 6259              		.cfi_startproc
 6260 0000 F30F1EFA 		endbr64
 6261 0004 55       		pushq	%rbp
 6262              	.LCFI102:
 6263              		.cfi_def_cfa_offset 16
 6264              		.cfi_offset 6, -16
 6265 0005 4889E5   		movq	%rsp, %rbp
 6266              	.LCFI103:
 6267              		.cfi_def_cfa_register 6
 6268 0008 4883EC70 		subq	$112, %rsp
 6269 000c 48897DC8 		movq	%rdi, -56(%rbp)
 6270 0010 488975C0 		movq	%rsi, -64(%rbp)
 6271 0014 488955B8 		movq	%rdx, -72(%rbp)
 6272 0018 894DB4   		movl	%ecx, -76(%rbp)
 6273 001b 448945B0 		movl	%r8d, -80(%rbp)
 6274 001f 44894DAC 		movl	%r9d, -84(%rbp)
 6275 0023 488B4510 		movq	16(%rbp), %rax
 6276 0027 488945A0 		movq	%rax, -96(%rbp)
 6277 002b 488B4518 		movq	24(%rbp), %rax
 6278 002f 48894598 		movq	%rax, -104(%rbp)
 6279              		.loc 1 2326 1
 6280 0033 64488B04 		movq	%fs:40, %rax
 6280      25280000 
 6280      00
 6281 003c 488945F8 		movq	%rax, -8(%rbp)
 6282 0040 31C0     		xorl	%eax, %eax
2327:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int ret = 0;
 6283              		.loc 1 2327 9
 6284 0042 C745DC00 		movl	$0, -36(%rbp)
 6284      000000
2328:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     size_t sig_len;
2329:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     unsigned char *encoded = NULL, *encoded_expected = NULL;
 6285              		.loc 1 2329 20
 6286 0049 48C745E8 		movq	$0, -24(%rbp)
 6286      00000000 
 6287              		.loc 1 2329 37
GAS LISTING /tmp/cc6OITWc.s 			page 180


 6288 0051 48C745E0 		movq	$0, -32(%rbp)
 6288      00000000 
2330:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2331:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
2332:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( mode == MBEDTLS_RSA_PRIVATE ||
2333:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       mode == MBEDTLS_RSA_PUBLIC );
2334:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( sig != NULL );
2335:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ( md_alg  == MBEDTLS_MD_NONE &&
2336:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                         hashlen == 0 ) ||
2337:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       hash != NULL );
2338:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2339:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     sig_len = ctx->len;
 6289              		.loc 1 2339 13
 6290 0059 488B45C8 		movq	-56(%rbp), %rax
 6291 005d 488B4008 		movq	8(%rax), %rax
 6292 0061 488945F0 		movq	%rax, -16(%rbp)
2340:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2341:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( mode == MBEDTLS_RSA_PRIVATE && ctx->padding != MBEDTLS_RSA_PKCS_V15 )
 6293              		.loc 1 2341 7
 6294 0065 837DB401 		cmpl	$1, -76(%rbp)
 6295 0069 7518     		jne	.L468
 6296              		.loc 1 2341 43 discriminator 1
 6297 006b 488B45C8 		movq	-56(%rbp), %rax
 6298 006f 8B804801 		movl	328(%rax), %eax
 6298      0000
 6299              		.loc 1 2341 37 discriminator 1
 6300 0075 85C0     		testl	%eax, %eax
 6301 0077 740A     		je	.L468
2342:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return( MBEDTLS_ERR_RSA_BAD_INPUT_DATA );
 6302              		.loc 1 2342 15
 6303 0079 B880BFFF 		movl	$-16512, %eax
 6303      FF
 6304 007e E92F0100 		jmp	.L469
 6304      00
 6305              	.L468:
2343:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2344:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
2345:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * Prepare expected PKCS1 v1.5 encoding of hash.
2346:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
2347:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2348:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( encoded          = mbedtls_calloc( 1, sig_len ) ) == NULL ||
 6306              		.loc 1 2348 30
 6307 0083 488B45F0 		movq	-16(%rbp), %rax
 6308 0087 4889C6   		movq	%rax, %rsi
 6309 008a BF010000 		movl	$1, %edi
 6309      00
 6310 008f E8000000 		call	mbedtls_calloc@PLT
 6310      00
 6311 0094 488945E8 		movq	%rax, -24(%rbp)
 6312              		.loc 1 2348 7
 6313 0098 48837DE8 		cmpq	$0, -24(%rbp)
 6313      00
 6314 009d 741C     		je	.L470
2349:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ( encoded_expected = mbedtls_calloc( 1, sig_len ) ) == NULL )
 6315              		.loc 1 2349 30 discriminator 1
 6316 009f 488B45F0 		movq	-16(%rbp), %rax
 6317 00a3 4889C6   		movq	%rax, %rsi
GAS LISTING /tmp/cc6OITWc.s 			page 181


 6318 00a6 BF010000 		movl	$1, %edi
 6318      00
 6319 00ab E8000000 		call	mbedtls_calloc@PLT
 6319      00
 6320 00b0 488945E0 		movq	%rax, -32(%rbp)
2348:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ( encoded_expected = mbedtls_calloc( 1, sig_len ) ) == NULL )
 6321              		.loc 1 2348 69 discriminator 1
 6322 00b4 48837DE0 		cmpq	$0, -32(%rbp)
 6322      00
 6323 00b9 750C     		jne	.L471
 6324              	.L470:
2350:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
2351:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ret = MBEDTLS_ERR_MPI_ALLOC_FAILED;
 6325              		.loc 1 2351 13
 6326 00bb C745DCF0 		movl	$-16, -36(%rbp)
 6326      FFFFFF
2352:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto cleanup;
 6327              		.loc 1 2352 9
 6328 00c2 E99C0000 		jmp	.L472
 6328      00
 6329              	.L471:
2353:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
2354:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2355:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = rsa_rsassa_pkcs1_v15_encode( md_alg, hashlen, hash, sig_len,
 6330              		.loc 1 2355 17
 6331 00c7 488B7DE0 		movq	-32(%rbp), %rdi
 6332 00cb 488B4DF0 		movq	-16(%rbp), %rcx
 6333 00cf 488B55A0 		movq	-96(%rbp), %rdx
 6334 00d3 8B75AC   		movl	-84(%rbp), %esi
 6335 00d6 8B45B0   		movl	-80(%rbp), %eax
 6336 00d9 4989F8   		movq	%rdi, %r8
 6337 00dc 89C7     		movl	%eax, %edi
 6338 00de E8000000 		call	rsa_rsassa_pkcs1_v15_encode
 6338      00
 6339 00e3 8945DC   		movl	%eax, -36(%rbp)
 6340              		.loc 1 2355 7
 6341 00e6 837DDC00 		cmpl	$0, -36(%rbp)
 6342 00ea 7570     		jne	.L480
2356:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                              encoded_expected ) ) != 0 )
2357:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto cleanup;
2358:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2359:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
2360:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * Apply RSA primitive to get what should be PKCS1 encoded hash.
2361:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
2362:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2363:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     ret = ( mode == MBEDTLS_RSA_PUBLIC )
2364:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****           ? mbedtls_rsa_public(  ctx, sig, encoded )
2365:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****           : mbedtls_rsa_private( ctx, f_rng, p_rng, sig, encoded );
 6343              		.loc 1 2365 11
 6344 00ec 837DB400 		cmpl	$0, -76(%rbp)
 6345 00f0 7519     		jne	.L474
2364:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****           : mbedtls_rsa_private( ctx, f_rng, p_rng, sig, encoded );
 6346              		.loc 1 2364 13
 6347 00f2 488B55E8 		movq	-24(%rbp), %rdx
 6348 00f6 488B4D98 		movq	-104(%rbp), %rcx
 6349 00fa 488B45C8 		movq	-56(%rbp), %rax
 6350 00fe 4889CE   		movq	%rcx, %rsi
GAS LISTING /tmp/cc6OITWc.s 			page 182


 6351 0101 4889C7   		movq	%rax, %rdi
 6352 0104 E8000000 		call	mbedtls_rsa_public
 6352      00
 6353 0109 EB1F     		jmp	.L475
 6354              	.L474:
 6355              		.loc 1 2365 13 discriminator 1
 6356 010b 488B7DE8 		movq	-24(%rbp), %rdi
 6357 010f 488B4D98 		movq	-104(%rbp), %rcx
 6358 0113 488B55B8 		movq	-72(%rbp), %rdx
 6359 0117 488B75C0 		movq	-64(%rbp), %rsi
 6360 011b 488B45C8 		movq	-56(%rbp), %rax
 6361 011f 4989F8   		movq	%rdi, %r8
 6362 0122 4889C7   		movq	%rax, %rdi
 6363 0125 E8000000 		call	mbedtls_rsa_private
 6363      00
 6364              	.L475:
2363:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****           ? mbedtls_rsa_public(  ctx, sig, encoded )
 6365              		.loc 1 2363 9
 6366 012a 8945DC   		movl	%eax, -36(%rbp)
2366:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ret != 0 )
 6367              		.loc 1 2366 7
 6368 012d 837DDC00 		cmpl	$0, -36(%rbp)
 6369 0131 752C     		jne	.L481
2367:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto cleanup;
2368:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2369:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     /*
2370:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      * Compare
2371:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****      */
2372:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2373:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ( ret = mbedtls_safer_memcmp( encoded, encoded_expected,
 6370              		.loc 1 2373 17
 6371 0133 488B55F0 		movq	-16(%rbp), %rdx
 6372 0137 488B4DE0 		movq	-32(%rbp), %rcx
 6373 013b 488B45E8 		movq	-24(%rbp), %rax
 6374 013f 4889CE   		movq	%rcx, %rsi
 6375 0142 4889C7   		movq	%rax, %rdi
 6376 0145 E8000000 		call	mbedtls_safer_memcmp
 6376      00
 6377 014a 8945DC   		movl	%eax, -36(%rbp)
 6378              		.loc 1 2373 7
 6379 014d 837DDC00 		cmpl	$0, -36(%rbp)
 6380 0151 740F     		je	.L482
2374:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                       sig_len ) ) != 0 )
2375:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
2376:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         ret = MBEDTLS_ERR_RSA_VERIFY_FAILED;
 6381              		.loc 1 2376 13
 6382 0153 C745DC80 		movl	$-17280, -36(%rbp)
 6382      BCFFFF
2377:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         goto cleanup;
 6383              		.loc 1 2377 9
 6384 015a EB07     		jmp	.L472
 6385              	.L480:
2357:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 6386              		.loc 1 2357 9
 6387 015c 90       		nop
 6388 015d EB04     		jmp	.L472
 6389              	.L481:
GAS LISTING /tmp/cc6OITWc.s 			page 183


2367:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 6390              		.loc 1 2367 9
 6391 015f 90       		nop
 6392 0160 EB01     		jmp	.L472
 6393              	.L482:
2378:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
2379:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2380:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** cleanup:
 6394              		.loc 1 2380 1
 6395 0162 90       		nop
 6396              	.L472:
2381:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2382:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( encoded != NULL )
 6397              		.loc 1 2382 7
 6398 0163 48837DE8 		cmpq	$0, -24(%rbp)
 6398      00
 6399 0168 741F     		je	.L477
2383:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
2384:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_platform_zeroize( encoded, sig_len );
 6400              		.loc 1 2384 9
 6401 016a 488B55F0 		movq	-16(%rbp), %rdx
 6402 016e 488B45E8 		movq	-24(%rbp), %rax
 6403 0172 4889D6   		movq	%rdx, %rsi
 6404 0175 4889C7   		movq	%rax, %rdi
 6405 0178 E8000000 		call	mbedtls_platform_zeroize@PLT
 6405      00
2385:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_free( encoded );
 6406              		.loc 1 2385 9
 6407 017d 488B45E8 		movq	-24(%rbp), %rax
 6408 0181 4889C7   		movq	%rax, %rdi
 6409 0184 E8000000 		call	mbedtls_free@PLT
 6409      00
 6410              	.L477:
2386:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
2387:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2388:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( encoded_expected != NULL )
 6411              		.loc 1 2388 7
 6412 0189 48837DE0 		cmpq	$0, -32(%rbp)
 6412      00
 6413 018e 741F     		je	.L478
2389:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
2390:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_platform_zeroize( encoded_expected, sig_len );
 6414              		.loc 1 2390 9
 6415 0190 488B55F0 		movq	-16(%rbp), %rdx
 6416 0194 488B45E0 		movq	-32(%rbp), %rax
 6417 0198 4889D6   		movq	%rdx, %rsi
 6418 019b 4889C7   		movq	%rax, %rdi
 6419 019e E8000000 		call	mbedtls_platform_zeroize@PLT
 6419      00
2391:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_free( encoded_expected );
 6420              		.loc 1 2391 9
 6421 01a3 488B45E0 		movq	-32(%rbp), %rax
 6422 01a7 4889C7   		movq	%rax, %rdi
 6423 01aa E8000000 		call	mbedtls_free@PLT
 6423      00
 6424              	.L478:
2392:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
GAS LISTING /tmp/cc6OITWc.s 			page 184


2393:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2394:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( ret );
 6425              		.loc 1 2394 11
 6426 01af 8B45DC   		movl	-36(%rbp), %eax
 6427              	.L469:
2395:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 6428              		.loc 1 2395 1
 6429 01b2 488B4DF8 		movq	-8(%rbp), %rcx
 6430 01b6 6448330C 		xorq	%fs:40, %rcx
 6430      25280000 
 6430      00
 6431 01bf 7405     		je	.L479
 6432 01c1 E8000000 		call	__stack_chk_fail@PLT
 6432      00
 6433              	.L479:
 6434 01c6 C9       		leave
 6435              	.LCFI104:
 6436              		.cfi_def_cfa 7, 8
 6437 01c7 C3       		ret
 6438              		.cfi_endproc
 6439              	.LFE50:
 6441              		.section	.text.mbedtls_rsa_pkcs1_verify,"ax",@progbits
 6442              		.globl	mbedtls_rsa_pkcs1_verify
 6444              	mbedtls_rsa_pkcs1_verify:
 6445              	.LFB51:
2396:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif /* MBEDTLS_PKCS1_V15 */
2397:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2398:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
2399:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Do an RSA operation and check the message digest
2400:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
2401:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_pkcs1_verify( mbedtls_rsa_context *ctx,
2402:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       int (*f_rng)(void *, unsigned char *, size_t),
2403:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       void *p_rng,
2404:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       int mode,
2405:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       mbedtls_md_type_t md_alg,
2406:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       unsigned int hashlen,
2407:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       const unsigned char *hash,
2408:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       const unsigned char *sig )
2409:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 6446              		.loc 1 2409 1
 6447              		.cfi_startproc
 6448 0000 F30F1EFA 		endbr64
 6449 0004 55       		pushq	%rbp
 6450              	.LCFI105:
 6451              		.cfi_def_cfa_offset 16
 6452              		.cfi_offset 6, -16
 6453 0005 4889E5   		movq	%rsp, %rbp
 6454              	.LCFI106:
 6455              		.cfi_def_cfa_register 6
 6456 0008 4883EC50 		subq	$80, %rsp
 6457 000c 48897DE8 		movq	%rdi, -24(%rbp)
 6458 0010 488975E0 		movq	%rsi, -32(%rbp)
 6459 0014 488955D8 		movq	%rdx, -40(%rbp)
 6460 0018 894DD4   		movl	%ecx, -44(%rbp)
 6461 001b 448945D0 		movl	%r8d, -48(%rbp)
 6462 001f 44894DCC 		movl	%r9d, -52(%rbp)
 6463 0023 488B4510 		movq	16(%rbp), %rax
GAS LISTING /tmp/cc6OITWc.s 			page 185


 6464 0027 488945C0 		movq	%rax, -64(%rbp)
 6465 002b 488B4518 		movq	24(%rbp), %rax
 6466 002f 488945B8 		movq	%rax, -72(%rbp)
 6467              		.loc 1 2409 1
 6468 0033 64488B04 		movq	%fs:40, %rax
 6468      25280000 
 6468      00
 6469 003c 488945F8 		movq	%rax, -8(%rbp)
 6470 0040 31C0     		xorl	%eax, %eax
2410:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ctx != NULL );
2411:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( mode == MBEDTLS_RSA_PRIVATE ||
2412:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       mode == MBEDTLS_RSA_PUBLIC );
2413:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( sig != NULL );
2414:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( ( md_alg  == MBEDTLS_MD_NONE &&
2415:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                         hashlen == 0 ) ||
2416:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                       hash != NULL );
2417:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2418:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     switch( ctx->padding )
 6471              		.loc 1 2418 16
 6472 0042 488B45E8 		movq	-24(%rbp), %rax
 6473 0046 8B804801 		movl	328(%rax), %eax
 6473      0000
 6474              		.loc 1 2418 5
 6475 004c 85C0     		testl	%eax, %eax
 6476 004e 7407     		je	.L484
 6477 0050 83F801   		cmpl	$1, %eax
 6478 0053 7432     		je	.L485
 6479 0055 EB60     		jmp	.L489
 6480              	.L484:
2419:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     {
2420:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_PKCS1_V15)
2421:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         case MBEDTLS_RSA_PKCS_V15:
2422:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return mbedtls_rsa_rsassa_pkcs1_v15_verify( ctx, f_rng, p_rng, mode, md_alg,
 6481              		.loc 1 2422 20
 6482 0057 448B45CC 		movl	-52(%rbp), %r8d
 6483 005b 8B7DD0   		movl	-48(%rbp), %edi
 6484 005e 8B4DD4   		movl	-44(%rbp), %ecx
 6485 0061 488B55D8 		movq	-40(%rbp), %rdx
 6486 0065 488B75E0 		movq	-32(%rbp), %rsi
 6487 0069 488B45E8 		movq	-24(%rbp), %rax
 6488 006d FF75B8   		pushq	-72(%rbp)
 6489 0070 FF75C0   		pushq	-64(%rbp)
 6490 0073 4589C1   		movl	%r8d, %r9d
 6491 0076 4189F8   		movl	%edi, %r8d
 6492 0079 4889C7   		movq	%rax, %rdi
 6493 007c E8000000 		call	mbedtls_rsa_rsassa_pkcs1_v15_verify
 6493      00
 6494 0081 4883C410 		addq	$16, %rsp
 6495 0085 EB35     		jmp	.L487
 6496              	.L485:
2423:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                                 hashlen, hash, sig );
2424:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
2425:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2426:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_PKCS1_V21)
2427:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         case MBEDTLS_RSA_PKCS_V21:
2428:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return mbedtls_rsa_rsassa_pss_verify( ctx, f_rng, p_rng, mode, md_alg,
 6497              		.loc 1 2428 20
GAS LISTING /tmp/cc6OITWc.s 			page 186


 6498 0087 448B45CC 		movl	-52(%rbp), %r8d
 6499 008b 8B7DD0   		movl	-48(%rbp), %edi
 6500 008e 8B4DD4   		movl	-44(%rbp), %ecx
 6501 0091 488B55D8 		movq	-40(%rbp), %rdx
 6502 0095 488B75E0 		movq	-32(%rbp), %rsi
 6503 0099 488B45E8 		movq	-24(%rbp), %rax
 6504 009d FF75B8   		pushq	-72(%rbp)
 6505 00a0 FF75C0   		pushq	-64(%rbp)
 6506 00a3 4589C1   		movl	%r8d, %r9d
 6507 00a6 4189F8   		movl	%edi, %r8d
 6508 00a9 4889C7   		movq	%rax, %rdi
 6509 00ac E8000000 		call	mbedtls_rsa_rsassa_pss_verify
 6509      00
 6510 00b1 4883C410 		addq	$16, %rsp
 6511 00b5 EB05     		jmp	.L487
 6512              	.L489:
2429:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****                                           hashlen, hash, sig );
2430:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
2431:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2432:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         default:
2433:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****             return( MBEDTLS_ERR_RSA_INVALID_PADDING );
 6513              		.loc 1 2433 19
 6514 00b7 B800BFFF 		movl	$-16640, %eax
 6514      FF
 6515              	.L487:
2434:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     }
2435:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 6516              		.loc 1 2435 1
 6517 00bc 488B55F8 		movq	-8(%rbp), %rdx
 6518 00c0 64483314 		xorq	%fs:40, %rdx
 6518      25280000 
 6518      00
 6519 00c9 7405     		je	.L488
 6520 00cb E8000000 		call	__stack_chk_fail@PLT
 6520      00
 6521              	.L488:
 6522 00d0 C9       		leave
 6523              	.LCFI107:
 6524              		.cfi_def_cfa 7, 8
 6525 00d1 C3       		ret
 6526              		.cfi_endproc
 6527              	.LFE51:
 6529              		.section	.text.mbedtls_rsa_copy,"ax",@progbits
 6530              		.globl	mbedtls_rsa_copy
 6532              	mbedtls_rsa_copy:
 6533              	.LFB52:
2436:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2437:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
2438:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Copy the components of an RSA key
2439:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
2440:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** int mbedtls_rsa_copy( mbedtls_rsa_context *dst, const mbedtls_rsa_context *src )
2441:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 6534              		.loc 1 2441 1
 6535              		.cfi_startproc
 6536 0000 F30F1EFA 		endbr64
 6537 0004 55       		pushq	%rbp
 6538              	.LCFI108:
GAS LISTING /tmp/cc6OITWc.s 			page 187


 6539              		.cfi_def_cfa_offset 16
 6540              		.cfi_offset 6, -16
 6541 0005 4889E5   		movq	%rsp, %rbp
 6542              	.LCFI109:
 6543              		.cfi_def_cfa_register 6
 6544 0008 4883EC20 		subq	$32, %rsp
 6545 000c 48897DE8 		movq	%rdi, -24(%rbp)
 6546 0010 488975E0 		movq	%rsi, -32(%rbp)
 6547              		.loc 1 2441 1
 6548 0014 64488B04 		movq	%fs:40, %rax
 6548      25280000 
 6548      00
 6549 001d 488945F8 		movq	%rax, -8(%rbp)
 6550 0021 31C0     		xorl	%eax, %eax
2442:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     int ret;
2443:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( dst != NULL );
2444:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     RSA_VALIDATE_RET( src != NULL );
2445:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2446:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     dst->ver = src->ver;
 6551              		.loc 1 2446 19
 6552 0023 488B45E0 		movq	-32(%rbp), %rax
 6553 0027 8B10     		movl	(%rax), %edx
 6554              		.loc 1 2446 14
 6555 0029 488B45E8 		movq	-24(%rbp), %rax
 6556 002d 8910     		movl	%edx, (%rax)
2447:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     dst->len = src->len;
 6557              		.loc 1 2447 19
 6558 002f 488B45E0 		movq	-32(%rbp), %rax
 6559 0033 488B5008 		movq	8(%rax), %rdx
 6560              		.loc 1 2447 14
 6561 0037 488B45E8 		movq	-24(%rbp), %rax
 6562 003b 48895008 		movq	%rdx, 8(%rax)
2448:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2449:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &dst->N, &src->N ) );
 6563              		.loc 1 2449 5
 6564 003f 488B45E0 		movq	-32(%rbp), %rax
 6565 0043 488D5010 		leaq	16(%rax), %rdx
 6566 0047 488B45E8 		movq	-24(%rbp), %rax
 6567 004b 4883C010 		addq	$16, %rax
 6568 004f 4889D6   		movq	%rdx, %rsi
 6569 0052 4889C7   		movq	%rax, %rdi
 6570 0055 E8000000 		call	mbedtls_mpi_copy@PLT
 6570      00
 6571 005a 8945F4   		movl	%eax, -12(%rbp)
 6572 005d 837DF400 		cmpl	$0, -12(%rbp)
 6573 0061 0F852A02 		jne	.L508
 6573      0000
2450:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &dst->E, &src->E ) );
 6574              		.loc 1 2450 5
 6575 0067 488B45E0 		movq	-32(%rbp), %rax
 6576 006b 488D5028 		leaq	40(%rax), %rdx
 6577 006f 488B45E8 		movq	-24(%rbp), %rax
 6578 0073 4883C028 		addq	$40, %rax
 6579 0077 4889D6   		movq	%rdx, %rsi
 6580 007a 4889C7   		movq	%rax, %rdi
 6581 007d E8000000 		call	mbedtls_mpi_copy@PLT
 6581      00
GAS LISTING /tmp/cc6OITWc.s 			page 188


 6582 0082 8945F4   		movl	%eax, -12(%rbp)
 6583 0085 837DF400 		cmpl	$0, -12(%rbp)
 6584 0089 0F850502 		jne	.L509
 6584      0000
2451:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2452:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &dst->D, &src->D ) );
 6585              		.loc 1 2452 5
 6586 008f 488B45E0 		movq	-32(%rbp), %rax
 6587 0093 488D5040 		leaq	64(%rax), %rdx
 6588 0097 488B45E8 		movq	-24(%rbp), %rax
 6589 009b 4883C040 		addq	$64, %rax
 6590 009f 4889D6   		movq	%rdx, %rsi
 6591 00a2 4889C7   		movq	%rax, %rdi
 6592 00a5 E8000000 		call	mbedtls_mpi_copy@PLT
 6592      00
 6593 00aa 8945F4   		movl	%eax, -12(%rbp)
 6594 00ad 837DF400 		cmpl	$0, -12(%rbp)
 6595 00b1 0F85E001 		jne	.L510
 6595      0000
2453:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &dst->P, &src->P ) );
 6596              		.loc 1 2453 5
 6597 00b7 488B45E0 		movq	-32(%rbp), %rax
 6598 00bb 488D5058 		leaq	88(%rax), %rdx
 6599 00bf 488B45E8 		movq	-24(%rbp), %rax
 6600 00c3 4883C058 		addq	$88, %rax
 6601 00c7 4889D6   		movq	%rdx, %rsi
 6602 00ca 4889C7   		movq	%rax, %rdi
 6603 00cd E8000000 		call	mbedtls_mpi_copy@PLT
 6603      00
 6604 00d2 8945F4   		movl	%eax, -12(%rbp)
 6605 00d5 837DF400 		cmpl	$0, -12(%rbp)
 6606 00d9 0F85BB01 		jne	.L511
 6606      0000
2454:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &dst->Q, &src->Q ) );
 6607              		.loc 1 2454 5
 6608 00df 488B45E0 		movq	-32(%rbp), %rax
 6609 00e3 488D5070 		leaq	112(%rax), %rdx
 6610 00e7 488B45E8 		movq	-24(%rbp), %rax
 6611 00eb 4883C070 		addq	$112, %rax
 6612 00ef 4889D6   		movq	%rdx, %rsi
 6613 00f2 4889C7   		movq	%rax, %rdi
 6614 00f5 E8000000 		call	mbedtls_mpi_copy@PLT
 6614      00
 6615 00fa 8945F4   		movl	%eax, -12(%rbp)
 6616 00fd 837DF400 		cmpl	$0, -12(%rbp)
 6617 0101 0F859601 		jne	.L512
 6617      0000
2455:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2456:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if !defined(MBEDTLS_RSA_NO_CRT)
2457:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &dst->DP, &src->DP ) );
 6618              		.loc 1 2457 5
 6619 0107 488B45E0 		movq	-32(%rbp), %rax
 6620 010b 488D9088 		leaq	136(%rax), %rdx
 6620      000000
 6621 0112 488B45E8 		movq	-24(%rbp), %rax
 6622 0116 48058800 		addq	$136, %rax
 6622      0000
GAS LISTING /tmp/cc6OITWc.s 			page 189


 6623 011c 4889D6   		movq	%rdx, %rsi
 6624 011f 4889C7   		movq	%rax, %rdi
 6625 0122 E8000000 		call	mbedtls_mpi_copy@PLT
 6625      00
 6626 0127 8945F4   		movl	%eax, -12(%rbp)
 6627 012a 837DF400 		cmpl	$0, -12(%rbp)
 6628 012e 0F856C01 		jne	.L513
 6628      0000
2458:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &dst->DQ, &src->DQ ) );
 6629              		.loc 1 2458 5
 6630 0134 488B45E0 		movq	-32(%rbp), %rax
 6631 0138 488D90A0 		leaq	160(%rax), %rdx
 6631      000000
 6632 013f 488B45E8 		movq	-24(%rbp), %rax
 6633 0143 4805A000 		addq	$160, %rax
 6633      0000
 6634 0149 4889D6   		movq	%rdx, %rsi
 6635 014c 4889C7   		movq	%rax, %rdi
 6636 014f E8000000 		call	mbedtls_mpi_copy@PLT
 6636      00
 6637 0154 8945F4   		movl	%eax, -12(%rbp)
 6638 0157 837DF400 		cmpl	$0, -12(%rbp)
 6639 015b 0F854201 		jne	.L514
 6639      0000
2459:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &dst->QP, &src->QP ) );
 6640              		.loc 1 2459 5
 6641 0161 488B45E0 		movq	-32(%rbp), %rax
 6642 0165 488D90B8 		leaq	184(%rax), %rdx
 6642      000000
 6643 016c 488B45E8 		movq	-24(%rbp), %rax
 6644 0170 4805B800 		addq	$184, %rax
 6644      0000
 6645 0176 4889D6   		movq	%rdx, %rsi
 6646 0179 4889C7   		movq	%rax, %rdi
 6647 017c E8000000 		call	mbedtls_mpi_copy@PLT
 6647      00
 6648 0181 8945F4   		movl	%eax, -12(%rbp)
 6649 0184 837DF400 		cmpl	$0, -12(%rbp)
 6650 0188 0F851801 		jne	.L515
 6650      0000
2460:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &dst->RP, &src->RP ) );
 6651              		.loc 1 2460 5
 6652 018e 488B45E0 		movq	-32(%rbp), %rax
 6653 0192 488D90E8 		leaq	232(%rax), %rdx
 6653      000000
 6654 0199 488B45E8 		movq	-24(%rbp), %rax
 6655 019d 4805E800 		addq	$232, %rax
 6655      0000
 6656 01a3 4889D6   		movq	%rdx, %rsi
 6657 01a6 4889C7   		movq	%rax, %rdi
 6658 01a9 E8000000 		call	mbedtls_mpi_copy@PLT
 6658      00
 6659 01ae 8945F4   		movl	%eax, -12(%rbp)
 6660 01b1 837DF400 		cmpl	$0, -12(%rbp)
 6661 01b5 0F85EE00 		jne	.L516
 6661      0000
2461:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &dst->RQ, &src->RQ ) );
GAS LISTING /tmp/cc6OITWc.s 			page 190


 6662              		.loc 1 2461 5
 6663 01bb 488B45E0 		movq	-32(%rbp), %rax
 6664 01bf 488D9000 		leaq	256(%rax), %rdx
 6664      010000
 6665 01c6 488B45E8 		movq	-24(%rbp), %rax
 6666 01ca 48050001 		addq	$256, %rax
 6666      0000
 6667 01d0 4889D6   		movq	%rdx, %rsi
 6668 01d3 4889C7   		movq	%rax, %rdi
 6669 01d6 E8000000 		call	mbedtls_mpi_copy@PLT
 6669      00
 6670 01db 8945F4   		movl	%eax, -12(%rbp)
 6671 01de 837DF400 		cmpl	$0, -12(%rbp)
 6672 01e2 0F85C400 		jne	.L517
 6672      0000
2462:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
2463:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2464:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &dst->RN, &src->RN ) );
 6673              		.loc 1 2464 5
 6674 01e8 488B45E0 		movq	-32(%rbp), %rax
 6675 01ec 488D90D0 		leaq	208(%rax), %rdx
 6675      000000
 6676 01f3 488B45E8 		movq	-24(%rbp), %rax
 6677 01f7 4805D000 		addq	$208, %rax
 6677      0000
 6678 01fd 4889D6   		movq	%rdx, %rsi
 6679 0200 4889C7   		movq	%rax, %rdi
 6680 0203 E8000000 		call	mbedtls_mpi_copy@PLT
 6680      00
 6681 0208 8945F4   		movl	%eax, -12(%rbp)
 6682 020b 837DF400 		cmpl	$0, -12(%rbp)
 6683 020f 0F859A00 		jne	.L518
 6683      0000
2465:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2466:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &dst->Vi, &src->Vi ) );
 6684              		.loc 1 2466 5
 6685 0215 488B45E0 		movq	-32(%rbp), %rax
 6686 0219 488D9018 		leaq	280(%rax), %rdx
 6686      010000
 6687 0220 488B45E8 		movq	-24(%rbp), %rax
 6688 0224 48051801 		addq	$280, %rax
 6688      0000
 6689 022a 4889D6   		movq	%rdx, %rsi
 6690 022d 4889C7   		movq	%rax, %rdi
 6691 0230 E8000000 		call	mbedtls_mpi_copy@PLT
 6691      00
 6692 0235 8945F4   		movl	%eax, -12(%rbp)
 6693 0238 837DF400 		cmpl	$0, -12(%rbp)
 6694 023c 7574     		jne	.L519
2467:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &dst->Vf, &src->Vf ) );
 6695              		.loc 1 2467 5
 6696 023e 488B45E0 		movq	-32(%rbp), %rax
 6697 0242 488D9030 		leaq	304(%rax), %rdx
 6697      010000
 6698 0249 488B45E8 		movq	-24(%rbp), %rax
 6699 024d 48053001 		addq	$304, %rax
 6699      0000
GAS LISTING /tmp/cc6OITWc.s 			page 191


 6700 0253 4889D6   		movq	%rdx, %rsi
 6701 0256 4889C7   		movq	%rax, %rdi
 6702 0259 E8000000 		call	mbedtls_mpi_copy@PLT
 6702      00
 6703 025e 8945F4   		movl	%eax, -12(%rbp)
 6704 0261 837DF400 		cmpl	$0, -12(%rbp)
 6705 0265 754E     		jne	.L520
2468:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2469:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     dst->padding = src->padding;
 6706              		.loc 1 2469 23
 6707 0267 488B45E0 		movq	-32(%rbp), %rax
 6708 026b 8B904801 		movl	328(%rax), %edx
 6708      0000
 6709              		.loc 1 2469 18
 6710 0271 488B45E8 		movq	-24(%rbp), %rax
 6711 0275 89904801 		movl	%edx, 328(%rax)
 6711      0000
2470:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     dst->hash_id = src->hash_id;
 6712              		.loc 1 2470 23
 6713 027b 488B45E0 		movq	-32(%rbp), %rax
 6714 027f 8B904C01 		movl	332(%rax), %edx
 6714      0000
 6715              		.loc 1 2470 18
 6716 0285 488B45E8 		movq	-24(%rbp), %rax
 6717 0289 89904C01 		movl	%edx, 332(%rax)
 6717      0000
 6718 028f EB25     		jmp	.L492
 6719              	.L508:
2449:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &dst->E, &src->E ) );
 6720              		.loc 1 2449 5
 6721 0291 90       		nop
 6722 0292 EB22     		jmp	.L492
 6723              	.L509:
2450:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 6724              		.loc 1 2450 5
 6725 0294 90       		nop
 6726 0295 EB1F     		jmp	.L492
 6727              	.L510:
2452:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &dst->P, &src->P ) );
 6728              		.loc 1 2452 5
 6729 0297 90       		nop
 6730 0298 EB1C     		jmp	.L492
 6731              	.L511:
2453:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &dst->Q, &src->Q ) );
 6732              		.loc 1 2453 5
 6733 029a 90       		nop
 6734 029b EB19     		jmp	.L492
 6735              	.L512:
2454:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 6736              		.loc 1 2454 5
 6737 029d 90       		nop
 6738 029e EB16     		jmp	.L492
 6739              	.L513:
2457:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &dst->DQ, &src->DQ ) );
 6740              		.loc 1 2457 5
 6741 02a0 90       		nop
 6742 02a1 EB13     		jmp	.L492
GAS LISTING /tmp/cc6OITWc.s 			page 192


 6743              	.L514:
2458:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &dst->QP, &src->QP ) );
 6744              		.loc 1 2458 5
 6745 02a3 90       		nop
 6746 02a4 EB10     		jmp	.L492
 6747              	.L515:
2459:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &dst->RP, &src->RP ) );
 6748              		.loc 1 2459 5
 6749 02a6 90       		nop
 6750 02a7 EB0D     		jmp	.L492
 6751              	.L516:
2460:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &dst->RQ, &src->RQ ) );
 6752              		.loc 1 2460 5
 6753 02a9 90       		nop
 6754 02aa EB0A     		jmp	.L492
 6755              	.L517:
2461:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
 6756              		.loc 1 2461 5
 6757 02ac 90       		nop
 6758 02ad EB07     		jmp	.L492
 6759              	.L518:
2464:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 6760              		.loc 1 2464 5
 6761 02af 90       		nop
 6762 02b0 EB04     		jmp	.L492
 6763              	.L519:
2466:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &dst->Vf, &src->Vf ) );
 6764              		.loc 1 2466 5
 6765 02b2 90       		nop
 6766 02b3 EB01     		jmp	.L492
 6767              	.L520:
2467:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 6768              		.loc 1 2467 5
 6769 02b5 90       		nop
 6770              	.L492:
2471:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2472:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** cleanup:
2473:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ret != 0 )
 6771              		.loc 1 2473 7
 6772 02b6 837DF400 		cmpl	$0, -12(%rbp)
 6773 02ba 740C     		je	.L505
2474:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         mbedtls_rsa_free( dst );
 6774              		.loc 1 2474 9
 6775 02bc 488B45E8 		movq	-24(%rbp), %rax
 6776 02c0 4889C7   		movq	%rax, %rdi
 6777 02c3 E8000000 		call	mbedtls_rsa_free
 6777      00
 6778              	.L505:
2475:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2476:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     return( ret );
 6779              		.loc 1 2476 11
 6780 02c8 8B45F4   		movl	-12(%rbp), %eax
2477:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 6781              		.loc 1 2477 1
 6782 02cb 488B4DF8 		movq	-8(%rbp), %rcx
 6783 02cf 6448330C 		xorq	%fs:40, %rcx
 6783      25280000 
GAS LISTING /tmp/cc6OITWc.s 			page 193


 6783      00
 6784 02d8 7405     		je	.L507
 6785 02da E8000000 		call	__stack_chk_fail@PLT
 6785      00
 6786              	.L507:
 6787 02df C9       		leave
 6788              	.LCFI110:
 6789              		.cfi_def_cfa 7, 8
 6790 02e0 C3       		ret
 6791              		.cfi_endproc
 6792              	.LFE52:
 6794              		.section	.text.mbedtls_rsa_free,"ax",@progbits
 6795              		.globl	mbedtls_rsa_free
 6797              	mbedtls_rsa_free:
 6798              	.LFB53:
2478:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2479:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** /*
2480:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  * Free the components of an RSA key
2481:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****  */
2482:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** void mbedtls_rsa_free( mbedtls_rsa_context *ctx )
2483:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** {
 6799              		.loc 1 2483 1
 6800              		.cfi_startproc
 6801 0000 F30F1EFA 		endbr64
 6802 0004 55       		pushq	%rbp
 6803              	.LCFI111:
 6804              		.cfi_def_cfa_offset 16
 6805              		.cfi_offset 6, -16
 6806 0005 4889E5   		movq	%rsp, %rbp
 6807              	.LCFI112:
 6808              		.cfi_def_cfa_register 6
 6809 0008 4883EC20 		subq	$32, %rsp
 6810 000c 48897DE8 		movq	%rdi, -24(%rbp)
 6811              		.loc 1 2483 1
 6812 0010 64488B04 		movq	%fs:40, %rax
 6812      25280000 
 6812      00
 6813 0019 488945F8 		movq	%rax, -8(%rbp)
 6814 001d 31C0     		xorl	%eax, %eax
2484:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     if( ctx == NULL )
 6815              		.loc 1 2484 7
 6816 001f 48837DE8 		cmpq	$0, -24(%rbp)
 6816      00
 6817 0024 0F84E200 		je	.L525
 6817      0000
2485:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****         return;
2486:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2487:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &ctx->Vi );
 6818              		.loc 1 2487 5
 6819 002a 488B45E8 		movq	-24(%rbp), %rax
 6820 002e 48051801 		addq	$280, %rax
 6820      0000
 6821 0034 4889C7   		movq	%rax, %rdi
 6822 0037 E8000000 		call	mbedtls_mpi_free@PLT
 6822      00
2488:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &ctx->Vf );
 6823              		.loc 1 2488 5
GAS LISTING /tmp/cc6OITWc.s 			page 194


 6824 003c 488B45E8 		movq	-24(%rbp), %rax
 6825 0040 48053001 		addq	$304, %rax
 6825      0000
 6826 0046 4889C7   		movq	%rax, %rdi
 6827 0049 E8000000 		call	mbedtls_mpi_free@PLT
 6827      00
2489:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &ctx->RN );
 6828              		.loc 1 2489 5
 6829 004e 488B45E8 		movq	-24(%rbp), %rax
 6830 0052 4805D000 		addq	$208, %rax
 6830      0000
 6831 0058 4889C7   		movq	%rax, %rdi
 6832 005b E8000000 		call	mbedtls_mpi_free@PLT
 6832      00
2490:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &ctx->D  );
 6833              		.loc 1 2490 5
 6834 0060 488B45E8 		movq	-24(%rbp), %rax
 6835 0064 4883C040 		addq	$64, %rax
 6836 0068 4889C7   		movq	%rax, %rdi
 6837 006b E8000000 		call	mbedtls_mpi_free@PLT
 6837      00
2491:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &ctx->Q  );
 6838              		.loc 1 2491 5
 6839 0070 488B45E8 		movq	-24(%rbp), %rax
 6840 0074 4883C070 		addq	$112, %rax
 6841 0078 4889C7   		movq	%rax, %rdi
 6842 007b E8000000 		call	mbedtls_mpi_free@PLT
 6842      00
2492:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &ctx->P  );
 6843              		.loc 1 2492 5
 6844 0080 488B45E8 		movq	-24(%rbp), %rax
 6845 0084 4883C058 		addq	$88, %rax
 6846 0088 4889C7   		movq	%rax, %rdi
 6847 008b E8000000 		call	mbedtls_mpi_free@PLT
 6847      00
2493:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &ctx->E  );
 6848              		.loc 1 2493 5
 6849 0090 488B45E8 		movq	-24(%rbp), %rax
 6850 0094 4883C028 		addq	$40, %rax
 6851 0098 4889C7   		movq	%rax, %rdi
 6852 009b E8000000 		call	mbedtls_mpi_free@PLT
 6852      00
2494:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &ctx->N  );
 6853              		.loc 1 2494 5
 6854 00a0 488B45E8 		movq	-24(%rbp), %rax
 6855 00a4 4883C010 		addq	$16, %rax
 6856 00a8 4889C7   		movq	%rax, %rdi
 6857 00ab E8000000 		call	mbedtls_mpi_free@PLT
 6857      00
2495:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2496:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if !defined(MBEDTLS_RSA_NO_CRT)
2497:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &ctx->RQ );
 6858              		.loc 1 2497 5
 6859 00b0 488B45E8 		movq	-24(%rbp), %rax
 6860 00b4 48050001 		addq	$256, %rax
 6860      0000
 6861 00ba 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/cc6OITWc.s 			page 195


 6862 00bd E8000000 		call	mbedtls_mpi_free@PLT
 6862      00
2498:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &ctx->RP );
 6863              		.loc 1 2498 5
 6864 00c2 488B45E8 		movq	-24(%rbp), %rax
 6865 00c6 4805E800 		addq	$232, %rax
 6865      0000
 6866 00cc 4889C7   		movq	%rax, %rdi
 6867 00cf E8000000 		call	mbedtls_mpi_free@PLT
 6867      00
2499:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &ctx->QP );
 6868              		.loc 1 2499 5
 6869 00d4 488B45E8 		movq	-24(%rbp), %rax
 6870 00d8 4805B800 		addq	$184, %rax
 6870      0000
 6871 00de 4889C7   		movq	%rax, %rdi
 6872 00e1 E8000000 		call	mbedtls_mpi_free@PLT
 6872      00
2500:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &ctx->DQ );
 6873              		.loc 1 2500 5
 6874 00e6 488B45E8 		movq	-24(%rbp), %rax
 6875 00ea 4805A000 		addq	$160, %rax
 6875      0000
 6876 00f0 4889C7   		movq	%rax, %rdi
 6877 00f3 E8000000 		call	mbedtls_mpi_free@PLT
 6877      00
2501:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mpi_free( &ctx->DP );
 6878              		.loc 1 2501 5
 6879 00f8 488B45E8 		movq	-24(%rbp), %rax
 6880 00fc 48058800 		addq	$136, %rax
 6880      0000
 6881 0102 4889C7   		movq	%rax, %rdi
 6882 0105 E8000000 		call	mbedtls_mpi_free@PLT
 6882      00
 6883 010a EB01     		jmp	.L521
 6884              	.L525:
2485:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
 6885              		.loc 1 2485 9
 6886 010c 90       		nop
 6887              	.L521:
2502:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif /* MBEDTLS_RSA_NO_CRT */
2503:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** 
2504:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #if defined(MBEDTLS_THREADING_C)
2505:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c ****     mbedtls_mutex_free( &ctx->mutex );
2506:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** #endif
2507:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/rsa.c **** }
 6888              		.loc 1 2507 1
 6889 010d 488B45F8 		movq	-8(%rbp), %rax
 6890 0111 64483304 		xorq	%fs:40, %rax
 6890      25280000 
 6890      00
 6891 011a 7405     		je	.L524
 6892 011c E8000000 		call	__stack_chk_fail@PLT
 6892      00
 6893              	.L524:
 6894 0121 C9       		leave
 6895              	.LCFI113:
GAS LISTING /tmp/cc6OITWc.s 			page 196


 6896              		.cfi_def_cfa 7, 8
 6897 0122 C3       		ret
 6898              		.cfi_endproc
 6899              	.LFE53:
 6901              		.text
 6902              	.Letext0:
 6903              		.file 2 "/usr/lib/gcc/x86_64-linux-gnu/9/include/stddef.h"
 6904              		.file 3 "/usr/include/x86_64-linux-gnu/bits/types.h"
 6905              		.file 4 "/usr/include/x86_64-linux-gnu/bits/stdint-uintn.h"
 6906              		.file 5 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/bignum.
 6907              		.file 6 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/md.h"
 6908              		.file 7 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/rsa.h"
 6909              		.file 8 "/usr/include/x86_64-linux-gnu/bits/types/struct_FILE.h"
 6910              		.file 9 "/usr/include/x86_64-linux-gnu/bits/types/FILE.h"
 6911              		.file 10 "/usr/include/stdio.h"
 6912              		.file 11 "/usr/include/x86_64-linux-gnu/bits/sys_errlist.h"
 6913              		.file 12 "/usr/include/time.h"
 6914              		.file 13 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/platfo
 13507              		.section	.note.gnu.property,"a"
 13508              		.align 8
 13509 0000 04000000 		.long	 1f - 0f
 13510 0004 10000000 		.long	 4f - 1f
 13511 0008 05000000 		.long	 5
 13512              	0:
 13513 000c 474E5500 		.string	 "GNU"
 13514              	1:
 13515              		.align 8
 13516 0010 020000C0 		.long	 0xc0000002
 13517 0014 04000000 		.long	 3f - 2f
 13518              	2:
 13519 0018 03000000 		.long	 0x3
 13520              	3:
 13521 001c 00000000 		.align 8
 13522              	4:
GAS LISTING /tmp/cc6OITWc.s 			page 197


DEFINED SYMBOLS
                            *ABS*:0000000000000000 rsa.c
     /tmp/cc6OITWc.s:6      .text.mbedtls_safer_memcmp:0000000000000000 mbedtls_safer_memcmp
     /tmp/cc6OITWc.s:77     .text.mbedtls_rsa_import:0000000000000000 mbedtls_rsa_import
     /tmp/cc6OITWc.s:212    .text.mbedtls_rsa_import_raw:0000000000000000 mbedtls_rsa_import_raw
     /tmp/cc6OITWc.s:377    .text.rsa_check_context:0000000000000000 rsa_check_context
     /tmp/cc6OITWc.s:564    .text.mbedtls_rsa_complete:0000000000000000 mbedtls_rsa_complete
     /tmp/cc6OITWc.s:922    .text.mbedtls_rsa_export_raw:0000000000000000 mbedtls_rsa_export_raw
     /tmp/cc6OITWc.s:1142   .text.mbedtls_rsa_export:0000000000000000 mbedtls_rsa_export
     /tmp/cc6OITWc.s:1334   .text.mbedtls_rsa_export_crt:0000000000000000 mbedtls_rsa_export_crt
     /tmp/cc6OITWc.s:1485   .text.mbedtls_rsa_init:0000000000000000 mbedtls_rsa_init
     /tmp/cc6OITWc.s:1535   .text.mbedtls_rsa_set_padding:0000000000000000 mbedtls_rsa_set_padding
     /tmp/cc6OITWc.s:1580   .text.mbedtls_rsa_get_len:0000000000000000 mbedtls_rsa_get_len
     /tmp/cc6OITWc.s:1617   .text.mbedtls_rsa_check_pubkey:0000000000000000 mbedtls_rsa_check_pubkey
     /tmp/cc6OITWc.s:1712   .text.mbedtls_rsa_check_privkey:0000000000000000 mbedtls_rsa_check_privkey
     /tmp/cc6OITWc.s:1819   .text.mbedtls_rsa_check_pub_priv:0000000000000000 mbedtls_rsa_check_pub_priv
     /tmp/cc6OITWc.s:1903   .text.mbedtls_rsa_public:0000000000000000 mbedtls_rsa_public
     /tmp/cc6OITWc.s:2036   .text.rsa_prepare_blinding:0000000000000000 rsa_prepare_blinding
     /tmp/cc6OITWc.s:2240   .text.mbedtls_rsa_private:0000000000000000 mbedtls_rsa_private
     /tmp/cc6OITWc.s:2805   .text.mgf_mask:0000000000000000 mgf_mask
     /tmp/cc6OITWc.s:2986   .text.mbedtls_rsa_rsaes_oaep_encrypt:0000000000000000 mbedtls_rsa_rsaes_oaep_encrypt
     /tmp/cc6OITWc.s:3295   .text.mbedtls_rsa_rsaes_pkcs1_v15_encrypt:0000000000000000 mbedtls_rsa_rsaes_pkcs1_v15_encrypt
     /tmp/cc6OITWc.s:3517   .text.mbedtls_rsa_pkcs1_encrypt:0000000000000000 mbedtls_rsa_pkcs1_encrypt
     /tmp/cc6OITWc.s:3603   .text.mbedtls_rsa_rsaes_oaep_decrypt:0000000000000000 mbedtls_rsa_rsaes_oaep_decrypt
     /tmp/cc6OITWc.s:4009   .text.all_or_nothing_int:0000000000000000 all_or_nothing_int
     /tmp/cc6OITWc.s:4049   .text.size_greater_than:0000000000000000 size_greater_than
     /tmp/cc6OITWc.s:4088   .text.if_int:0000000000000000 if_int
     /tmp/cc6OITWc.s:4139   .text.mem_move_to_left:0000000000000000 mem_move_to_left
     /tmp/cc6OITWc.s:4276   .text.mbedtls_rsa_rsaes_pkcs1_v15_decrypt:0000000000000000 mbedtls_rsa_rsaes_pkcs1_v15_decrypt
     /tmp/cc6OITWc.s:4639   .text.mbedtls_rsa_pkcs1_decrypt:0000000000000000 mbedtls_rsa_pkcs1_decrypt
     /tmp/cc6OITWc.s:4727   .text.mbedtls_rsa_rsassa_pss_sign:0000000000000000 mbedtls_rsa_rsassa_pss_sign
     /tmp/cc6OITWc.s:5141   .text.rsa_rsassa_pkcs1_v15_encode:0000000000000000 rsa_rsassa_pkcs1_v15_encode
     /tmp/cc6OITWc.s:5466   .text.mbedtls_rsa_rsassa_pkcs1_v15_sign:0000000000000000 mbedtls_rsa_rsassa_pkcs1_v15_sign
     /tmp/cc6OITWc.s:5654   .text.mbedtls_rsa_pkcs1_sign:0000000000000000 mbedtls_rsa_pkcs1_sign
     /tmp/cc6OITWc.s:5742   .text.mbedtls_rsa_rsassa_pss_verify_ext:0000000000000000 mbedtls_rsa_rsassa_pss_verify_ext
     /tmp/cc6OITWc.s:6182   .text.mbedtls_rsa_rsassa_pss_verify:0000000000000000 mbedtls_rsa_rsassa_pss_verify
     /tmp/cc6OITWc.s:6256   .text.mbedtls_rsa_rsassa_pkcs1_v15_verify:0000000000000000 mbedtls_rsa_rsassa_pkcs1_v15_verify
     /tmp/cc6OITWc.s:6444   .text.mbedtls_rsa_pkcs1_verify:0000000000000000 mbedtls_rsa_pkcs1_verify
     /tmp/cc6OITWc.s:6532   .text.mbedtls_rsa_copy:0000000000000000 mbedtls_rsa_copy
     /tmp/cc6OITWc.s:6797   .text.mbedtls_rsa_free:0000000000000000 mbedtls_rsa_free

UNDEFINED SYMBOLS
_GLOBAL_OFFSET_TABLE_
__stack_chk_fail
mbedtls_mpi_copy
mbedtls_mpi_size
mbedtls_mpi_read_binary
mbedtls_mpi_cmp_int
mbedtls_mpi_get_bit
mbedtls_mpi_mul_mpi
mbedtls_rsa_deduce_primes
mbedtls_rsa_deduce_private_exponent
mbedtls_rsa_deduce_crt
mbedtls_mpi_write_binary
memset
mbedtls_mpi_bitlen
mbedtls_mpi_cmp_mpi
GAS LISTING /tmp/cc6OITWc.s 			page 198


mbedtls_rsa_validate_params
mbedtls_rsa_validate_crt
mbedtls_mpi_init
mbedtls_mpi_exp_mod
mbedtls_mpi_free
mbedtls_mpi_mod_mpi
mbedtls_mpi_fill_random
mbedtls_mpi_gcd
mbedtls_mpi_inv_mod
mbedtls_mpi_sub_int
mbedtls_mpi_add_mpi
mbedtls_mpi_sub_mpi
mbedtls_md_get_size
mbedtls_md_starts
mbedtls_md_update
mbedtls_md_finish
mbedtls_platform_zeroize
mbedtls_md_info_from_type
mbedtls_md
memcpy
mbedtls_md_init
mbedtls_md_setup
mbedtls_md_free
mbedtls_oid_get_oid_by_md
mbedtls_calloc
mbedtls_free
memcmp
