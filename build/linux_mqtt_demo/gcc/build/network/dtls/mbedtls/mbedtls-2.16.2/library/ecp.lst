GAS LISTING /tmp/ccajKZL5.s 			page 1


   1              		.file	"ecp.c"
   2              		.text
   3              	.Ltext0:
   4              		.section	.rodata
   5              	.LC0:
   6 0000 73656370 		.string	"secp521r1"
   6      35323172 
   6      3100
   7              	.LC1:
   8 000a 73656370 		.string	"secp384r1"
   8      33383472 
   8      3100
   9              	.LC2:
  10 0014 73656370 		.string	"secp256r1"
  10      32353672 
  10      3100
  11              	.LC3:
  12 001e 73656370 		.string	"secp256k1"
  12      3235366B 
  12      3100
  13              	.LC4:
  14 0028 73656370 		.string	"secp224r1"
  14      32323472 
  14      3100
  15              	.LC5:
  16 0032 73656370 		.string	"secp224k1"
  16      3232346B 
  16      3100
  17              	.LC6:
  18 003c 73656370 		.string	"secp192r1"
  18      31393272 
  18      3100
  19              	.LC7:
  20 0046 73656370 		.string	"secp192k1"
  20      3139326B 
  20      3100
  21              		.section	.data.rel.ro.local.ecp_supported_curves,"aw"
  22              		.align 32
  25              	ecp_supported_curves:
  26 0000 05000000 		.long	5
  29 0008 00000000 		.quad	.LC0
  29      00000000 
  30 0010 04000000 		.long	4
  33 0018 00000000 		.quad	.LC1
  33      00000000 
  34 0020 03000000 		.long	3
  37 0028 00000000 		.quad	.LC2
  37      00000000 
  38 0030 0C000000 		.long	12
  41 0038 00000000 		.quad	.LC3
  41      00000000 
  42 0040 02000000 		.long	2
  45 0048 00000000 		.quad	.LC4
  45      00000000 
  46 0050 0B000000 		.long	11
  49 0058 00000000 		.quad	.LC5
  49      00000000 
GAS LISTING /tmp/ccajKZL5.s 			page 2


  50 0060 01000000 		.long	1
  53 0068 00000000 		.quad	.LC6
  53      00000000 
  54 0070 0A000000 		.long	10
  57 0078 00000000 		.quad	.LC7
  57      00000000 
  58 0080 00000000 		.long	0
  61 0088 00000000 		.quad	0
  61      00000000 
  62              		.section	.bss.ecp_supported_grp_id,"aw",@nobits
  63              		.align 32
  66              	ecp_supported_grp_id:
  67 0000 00000000 		.zero	36
  67      00000000 
  67      00000000 
  67      00000000 
  67      00000000 
  68              		.section	.text.mbedtls_ecp_curve_list,"ax",@progbits
  69              		.globl	mbedtls_ecp_curve_list
  71              	mbedtls_ecp_curve_list:
  72              	.LFB6:
  73              		.file 1 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c"
   1:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
   2:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *  Elliptic curves over GF(p): generic functions
   3:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
   4:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *  Copyright (C) 2006-2015, ARM Limited, All Rights Reserved
   5:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *  SPDX-License-Identifier: Apache-2.0
   6:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
   7:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *  Licensed under the Apache License, Version 2.0 (the "License"); you may
   8:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *  not use this file except in compliance with the License.
   9:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *  You may obtain a copy of the License at
  10:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
  11:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *  http://www.apache.org/licenses/LICENSE-2.0
  12:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
  13:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *  Unless required by applicable law or agreed to in writing, software
  14:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  15:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  16:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *  See the License for the specific language governing permissions and
  17:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *  limitations under the License.
  18:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
  19:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *  This file is part of mbed TLS (https://tls.mbed.org)
  20:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
  21:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
  22:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
  23:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * References:
  24:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
  25:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * SEC1 http://www.secg.org/index.php?action=secg,docs_secg
  26:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * GECC = Guide to Elliptic Curve Cryptography - Hankerson, Menezes, Vanstone
  27:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * FIPS 186-3 http://csrc.nist.gov/publications/fips/fips186-3/fips_186-3.pdf
  28:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * RFC 4492 for the related TLS structures and constants
  29:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * RFC 7748 for the Curve448 and Curve25519 curve definitions
  30:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
  31:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * [Curve25519] http://cr.yp.to/ecdh/curve25519-20060209.pdf
  32:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
  33:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * [2] CORON, Jean-S'ebastien. Resistance against differential power analysis
  34:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *     for elliptic curve cryptosystems. In : Cryptographic Hardware and
  35:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *     Embedded Systems. Springer Berlin Heidelberg, 1999. p. 292-302.
GAS LISTING /tmp/ccajKZL5.s 			page 3


  36:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *     <http://link.springer.com/chapter/10.1007/3-540-48059-5_25>
  37:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
  38:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * [3] HEDABOU, Mustapha, PINEL, Pierre, et B'EN'ETEAU, Lucien. A comb method to
  39:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *     render ECC resistant against Side Channel Attacks. IACR Cryptology
  40:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *     ePrint Archive, 2004, vol. 2004, p. 342.
  41:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *     <http://eprint.iacr.org/2004/342.pdf>
  42:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
  43:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
  44:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if !defined(MBEDTLS_CONFIG_FILE)
  45:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #include "mbedtls/config.h"
  46:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #else
  47:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #include MBEDTLS_CONFIG_FILE
  48:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
  49:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
  50:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /**
  51:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * \brief Function level alternative implementation.
  52:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
  53:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * The MBEDTLS_ECP_INTERNAL_ALT macro enables alternative implementations to
  54:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * replace certain functions in this module. The alternative implementations are
  55:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * typically hardware accelerators and need to activate the hardware before the
  56:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * computation starts and deactivate it after it finishes. The
  57:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * mbedtls_internal_ecp_init() and mbedtls_internal_ecp_free() functions serve
  58:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * this purpose.
  59:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
  60:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * To preserve the correct functionality the following conditions must hold:
  61:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
  62:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * - The alternative implementation must be activated by
  63:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   mbedtls_internal_ecp_init() before any of the replaceable functions is
  64:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   called.
  65:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * - mbedtls_internal_ecp_free() must \b only be called when the alternative
  66:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   implementation is activated.
  67:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * - mbedtls_internal_ecp_init() must \b not be called when the alternative
  68:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   implementation is activated.
  69:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * - Public functions must not return while the alternative implementation is
  70:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   activated.
  71:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * - Replaceable functions are guarded by \c MBEDTLS_ECP_XXX_ALT macros and
  72:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   before calling them an \code if( mbedtls_internal_ecp_grp_capable( grp ) )
  73:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   \endcode ensures that the alternative implementation supports the current
  74:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   group.
  75:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
  76:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_INTERNAL_ALT)
  77:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
  78:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
  79:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_C)
  80:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
  81:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #include "mbedtls/ecp.h"
  82:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #include "mbedtls/threading.h"
  83:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #include "mbedtls/platform_util.h"
  84:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
  85:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #include <string.h>
  86:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
  87:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if !defined(MBEDTLS_ECP_ALT)
  88:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
  89:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /* Parameter validation macros based on platform_util.h */
  90:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #define ECP_VALIDATE_RET( cond )    \
  91:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_INTERNAL_VALIDATE_RET( cond, MBEDTLS_ERR_ECP_BAD_INPUT_DATA )
  92:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #define ECP_VALIDATE( cond )        \
GAS LISTING /tmp/ccajKZL5.s 			page 4


  93:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_INTERNAL_VALIDATE( cond )
  94:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
  95:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_PLATFORM_C)
  96:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #include "mbedtls/platform.h"
  97:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #else
  98:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #include <stdlib.h>
  99:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #include <stdio.h>
 100:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #define mbedtls_printf     printf
 101:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #define mbedtls_calloc    calloc
 102:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #define mbedtls_free       free
 103:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
 104:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 105:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #include "mbedtls/ecp_internal.h"
 106:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 107:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if ( defined(__ARMCC_VERSION) || defined(_MSC_VER) ) && \
 108:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     !defined(inline) && !defined(__cplusplus)
 109:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #define inline __inline
 110:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
 111:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 112:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_SELF_TEST)
 113:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 114:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Counts of point addition and doubling, and field multiplications.
 115:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Used to test resistance of point multiplication to simple timing attacks.
 116:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 117:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static unsigned long add_count, dbl_count, mul_count;
 118:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
 119:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 120:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
 121:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 122:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Maximum number of "basic operations" to be done in a row.
 123:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
 124:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Default value 0 means that ECC operations will not yield.
 125:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Note that regardless of the value of ecp_max_ops, always at
 126:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * least one step is performed before yielding.
 127:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
 128:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Setting ecp_max_ops=1 can be suitable for testing purposes
 129:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * as it will interrupt computation at all possible points.
 130:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 131:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static unsigned ecp_max_ops = 0;
 132:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 133:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 134:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Set ecp_max_ops
 135:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 136:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** void mbedtls_ecp_set_max_ops( unsigned max_ops )
 137:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 138:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ecp_max_ops = max_ops;
 139:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 140:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 141:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 142:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Check if restart is enabled
 143:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 144:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_restart_is_enabled( void )
 145:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 146:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ecp_max_ops != 0 );
 147:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 148:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 149:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
GAS LISTING /tmp/ccajKZL5.s 			page 5


 150:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Restart sub-context for ecp_mul_comb()
 151:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 152:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** struct mbedtls_ecp_restart_mul
 153:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 154:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point R;    /* current intermediate result                  */
 155:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     size_t i;               /* current index in various loops, 0 outside    */
 156:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point *T;   /* table for precomputed points                 */
 157:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     unsigned char T_size;   /* number of points in table T                  */
 158:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     enum {                  /* what were we doing last time we returned?    */
 159:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         ecp_rsm_init = 0,       /* nothing so far, dummy initial state      */
 160:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         ecp_rsm_pre_dbl,        /* precompute 2^n multiples                 */
 161:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         ecp_rsm_pre_norm_dbl,   /* normalize precomputed 2^n multiples      */
 162:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         ecp_rsm_pre_add,        /* precompute remaining points by adding    */
 163:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         ecp_rsm_pre_norm_add,   /* normalize all precomputed points         */
 164:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         ecp_rsm_comb_core,      /* ecp_mul_comb_core()                      */
 165:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         ecp_rsm_final_norm,     /* do the final normalization               */
 166:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     } state;
 167:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** };
 168:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 169:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 170:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Init restart_mul sub-context
 171:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 172:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static void ecp_restart_rsm_init( mbedtls_ecp_restart_mul_ctx *ctx )
 173:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 174:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point_init( &ctx->R );
 175:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ctx->i = 0;
 176:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ctx->T = NULL;
 177:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ctx->T_size = 0;
 178:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ctx->state = ecp_rsm_init;
 179:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 180:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 181:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 182:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Free the components of a restart_mul sub-context
 183:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 184:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static void ecp_restart_rsm_free( mbedtls_ecp_restart_mul_ctx *ctx )
 185:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 186:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     unsigned char i;
 187:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 188:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ctx == NULL )
 189:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return;
 190:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 191:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point_free( &ctx->R );
 192:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 193:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ctx->T != NULL )
 194:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 195:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         for( i = 0; i < ctx->T_size; i++ )
 196:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             mbedtls_ecp_point_free( ctx->T + i );
 197:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_free( ctx->T );
 198:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 199:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 200:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ecp_restart_rsm_init( ctx );
 201:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 202:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 203:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 204:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Restart context for ecp_muladd()
 205:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 206:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** struct mbedtls_ecp_restart_muladd
GAS LISTING /tmp/ccajKZL5.s 			page 6


 207:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 208:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point mP;       /* mP value                             */
 209:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point R;        /* R intermediate result                */
 210:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     enum {                      /* what should we do next?              */
 211:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         ecp_rsma_mul1 = 0,      /* first multiplication                 */
 212:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         ecp_rsma_mul2,          /* second multiplication                */
 213:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         ecp_rsma_add,           /* addition                             */
 214:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         ecp_rsma_norm,          /* normalization                        */
 215:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     } state;
 216:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** };
 217:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 218:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 219:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Init restart_muladd sub-context
 220:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 221:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static void ecp_restart_ma_init( mbedtls_ecp_restart_muladd_ctx *ctx )
 222:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 223:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point_init( &ctx->mP );
 224:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point_init( &ctx->R );
 225:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ctx->state = ecp_rsma_mul1;
 226:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 227:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 228:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 229:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Free the components of a restart_muladd sub-context
 230:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 231:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static void ecp_restart_ma_free( mbedtls_ecp_restart_muladd_ctx *ctx )
 232:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 233:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ctx == NULL )
 234:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return;
 235:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 236:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point_free( &ctx->mP );
 237:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point_free( &ctx->R );
 238:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 239:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ecp_restart_ma_init( ctx );
 240:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 241:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 242:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 243:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Initialize a restart context
 244:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 245:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** void mbedtls_ecp_restart_init( mbedtls_ecp_restart_ctx *ctx )
 246:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 247:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE( ctx != NULL );
 248:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ctx->ops_done = 0;
 249:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ctx->depth = 0;
 250:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ctx->rsm = NULL;
 251:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ctx->ma = NULL;
 252:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 253:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 254:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 255:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Free the components of a restart context
 256:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 257:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** void mbedtls_ecp_restart_free( mbedtls_ecp_restart_ctx *ctx )
 258:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 259:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ctx == NULL )
 260:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return;
 261:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 262:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ecp_restart_rsm_free( ctx->rsm );
 263:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_free( ctx->rsm );
GAS LISTING /tmp/ccajKZL5.s 			page 7


 264:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 265:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ecp_restart_ma_free( ctx->ma );
 266:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_free( ctx->ma );
 267:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 268:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_restart_init( ctx );
 269:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 270:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 271:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 272:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Check if we can do the next step
 273:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 274:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_check_budget( const mbedtls_ecp_group *grp,
 275:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                               mbedtls_ecp_restart_ctx *rs_ctx,
 276:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                               unsigned ops )
 277:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 278:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( grp != NULL );
 279:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 280:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && ecp_max_ops != 0 )
 281:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 282:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* scale depending on curve size: the chosen reference is 256-bit,
 283:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          * and multiplication is quadratic. Round to the closest integer. */
 284:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( grp->pbits >= 512 )
 285:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             ops *= 4;
 286:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         else if( grp->pbits >= 384 )
 287:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             ops *= 2;
 288:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 289:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* Avoid infinite loops: always allow first step.
 290:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          * Because of that, however, it's not generally true
 291:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          * that ops_done <= ecp_max_ops, so the check
 292:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          * ops_done > ecp_max_ops below is mandatory. */
 293:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( ( rs_ctx->ops_done != 0 ) &&
 294:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             ( rs_ctx->ops_done > ecp_max_ops ||
 295:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****               ops > ecp_max_ops - rs_ctx->ops_done ) )
 296:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         {
 297:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             return( MBEDTLS_ERR_ECP_IN_PROGRESS );
 298:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         }
 299:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 300:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* update running count */
 301:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->ops_done += ops;
 302:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 303:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 304:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( 0 );
 305:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 306:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 307:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /* Call this when entering a function that needs its own sub-context */
 308:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #define ECP_RS_ENTER( SUB )   do {                                      \
 309:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* reset ops count for this call if top-level */                    \
 310:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && rs_ctx->depth++ == 0 )                        \
 311:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->ops_done = 0;                                           \
 312:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                                                         \
 313:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* set up our own sub-context if needed */                          \
 314:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( mbedtls_ecp_restart_is_enabled() &&                             \
 315:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx != NULL && rs_ctx->SUB == NULL )                         \
 316:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {                                                                   \
 317:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->SUB = mbedtls_calloc( 1, sizeof( *rs_ctx->SUB ) );      \
 318:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( rs_ctx->SUB == NULL )                                       \
 319:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             return( MBEDTLS_ERR_ECP_ALLOC_FAILED );                     \
 320:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                                                         \
GAS LISTING /tmp/ccajKZL5.s 			page 8


 321:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         ecp_restart_## SUB ##_init( rs_ctx->SUB );                      \
 322:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }                                                                   \
 323:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** } while( 0 )
 324:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 325:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /* Call this when leaving a function that needs its own sub-context */
 326:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #define ECP_RS_LEAVE( SUB )   do {                                      \
 327:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* clear our sub-context when not in progress (done or error) */    \
 328:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && rs_ctx->SUB != NULL &&                        \
 329:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         ret != MBEDTLS_ERR_ECP_IN_PROGRESS )                            \
 330:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {                                                                   \
 331:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         ecp_restart_## SUB ##_free( rs_ctx->SUB );                      \
 332:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_free( rs_ctx->SUB );                                    \
 333:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->SUB = NULL;                                             \
 334:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }                                                                   \
 335:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                                                         \
 336:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL )                                                \
 337:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->depth--;                                                \
 338:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** } while( 0 )
 339:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 340:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #else /* MBEDTLS_ECP_RESTARTABLE */
 341:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 342:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #define ECP_RS_ENTER( sub )     (void) rs_ctx;
 343:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #define ECP_RS_LEAVE( sub )     (void) rs_ctx;
 344:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 345:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif /* MBEDTLS_ECP_RESTARTABLE */
 346:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 347:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_DP_SECP192R1_ENABLED) ||   \
 348:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     defined(MBEDTLS_ECP_DP_SECP224R1_ENABLED) ||   \
 349:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     defined(MBEDTLS_ECP_DP_SECP256R1_ENABLED) ||   \
 350:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     defined(MBEDTLS_ECP_DP_SECP384R1_ENABLED) ||   \
 351:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     defined(MBEDTLS_ECP_DP_SECP521R1_ENABLED) ||   \
 352:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     defined(MBEDTLS_ECP_DP_BP256R1_ENABLED)   ||   \
 353:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     defined(MBEDTLS_ECP_DP_BP384R1_ENABLED)   ||   \
 354:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     defined(MBEDTLS_ECP_DP_BP512R1_ENABLED)   ||   \
 355:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     defined(MBEDTLS_ECP_DP_SECP192K1_ENABLED) ||   \
 356:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     defined(MBEDTLS_ECP_DP_SECP224K1_ENABLED) ||   \
 357:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     defined(MBEDTLS_ECP_DP_SECP256K1_ENABLED)
 358:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #define ECP_SHORTWEIERSTRASS
 359:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
 360:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 361:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_DP_CURVE25519_ENABLED) || \
 362:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     defined(MBEDTLS_ECP_DP_CURVE448_ENABLED)
 363:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #define ECP_MONTGOMERY
 364:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
 365:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 366:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 367:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Curve types: internal for now, might be exposed later
 368:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 369:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** typedef enum
 370:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 371:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_TYPE_NONE = 0,
 372:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_TYPE_SHORT_WEIERSTRASS,    /* y^2 = x^3 + a x + b      */
 373:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_TYPE_MONTGOMERY,           /* y^2 = x^3 + a x^2 + x    */
 374:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** } ecp_curve_type;
 375:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 376:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 377:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * List of supported curves:
GAS LISTING /tmp/ccajKZL5.s 			page 9


 378:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *  - internal ID
 379:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *  - TLS NamedCurve ID (RFC 4492 sec. 5.1.1, RFC 7071 sec. 2)
 380:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *  - size in bits
 381:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *  - readable name
 382:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
 383:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Curves are listed in order: largest curves first, and for a given size,
 384:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * fastest curves first. This provides the default order for the SSL module.
 385:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
 386:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Reminder: update profiles in x509_crt.c when adding a new curves!
 387:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 388:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static const mbedtls_ecp_curve_info ecp_supported_curves[] =
 389:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 390:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_DP_SECP521R1_ENABLED)
 391:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     { MBEDTLS_ECP_DP_SECP521R1,    25,     521,    "secp521r1"         },
 392:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
 393:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_DP_BP512R1_ENABLED)
 394:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     { MBEDTLS_ECP_DP_BP512R1,      28,     512,    "brainpoolP512r1"   },
 395:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
 396:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_DP_SECP384R1_ENABLED)
 397:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     { MBEDTLS_ECP_DP_SECP384R1,    24,     384,    "secp384r1"         },
 398:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
 399:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_DP_BP384R1_ENABLED)
 400:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     { MBEDTLS_ECP_DP_BP384R1,      27,     384,    "brainpoolP384r1"   },
 401:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
 402:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_DP_SECP256R1_ENABLED)
 403:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     { MBEDTLS_ECP_DP_SECP256R1,    23,     256,    "secp256r1"         },
 404:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
 405:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_DP_SECP256K1_ENABLED)
 406:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     { MBEDTLS_ECP_DP_SECP256K1,    22,     256,    "secp256k1"         },
 407:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
 408:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_DP_BP256R1_ENABLED)
 409:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     { MBEDTLS_ECP_DP_BP256R1,      26,     256,    "brainpoolP256r1"   },
 410:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
 411:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_DP_SECP224R1_ENABLED)
 412:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     { MBEDTLS_ECP_DP_SECP224R1,    21,     224,    "secp224r1"         },
 413:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
 414:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_DP_SECP224K1_ENABLED)
 415:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     { MBEDTLS_ECP_DP_SECP224K1,    20,     224,    "secp224k1"         },
 416:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
 417:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_DP_SECP192R1_ENABLED)
 418:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     { MBEDTLS_ECP_DP_SECP192R1,    19,     192,    "secp192r1"         },
 419:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
 420:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_DP_SECP192K1_ENABLED)
 421:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     { MBEDTLS_ECP_DP_SECP192K1,    18,     192,    "secp192k1"         },
 422:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
 423:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     { MBEDTLS_ECP_DP_NONE,          0,     0,      NULL                },
 424:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** };
 425:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 426:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #define ECP_NB_CURVES   sizeof( ecp_supported_curves ) /    \
 427:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                         sizeof( ecp_supported_curves[0] )
 428:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 429:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static mbedtls_ecp_group_id ecp_supported_grp_id[ECP_NB_CURVES];
 430:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 431:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 432:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * List of supported curves and associated info
 433:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 434:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** const mbedtls_ecp_curve_info *mbedtls_ecp_curve_list( void )
GAS LISTING /tmp/ccajKZL5.s 			page 10


 435:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
  74              		.loc 1 435 1
  75              		.cfi_startproc
  76 0000 F30F1EFA 		endbr64
  77 0004 55       		pushq	%rbp
  78              	.LCFI0:
  79              		.cfi_def_cfa_offset 16
  80              		.cfi_offset 6, -16
  81 0005 4889E5   		movq	%rsp, %rbp
  82              	.LCFI1:
  83              		.cfi_def_cfa_register 6
  84 0008 4883EC10 		subq	$16, %rsp
  85              		.loc 1 435 1
  86 000c 64488B04 		movq	%fs:40, %rax
  86      25280000 
  86      00
  87 0015 488945F8 		movq	%rax, -8(%rbp)
  88 0019 31C0     		xorl	%eax, %eax
 436:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ecp_supported_curves );
  89              		.loc 1 436 11
  90 001b 488D0500 		leaq	ecp_supported_curves(%rip), %rax
  90      000000
 437:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
  91              		.loc 1 437 1
  92 0022 488B55F8 		movq	-8(%rbp), %rdx
  93 0026 64483314 		xorq	%fs:40, %rdx
  93      25280000 
  93      00
  94 002f 7405     		je	.L3
  95 0031 E8000000 		call	__stack_chk_fail@PLT
  95      00
  96              	.L3:
  97 0036 C9       		leave
  98              	.LCFI2:
  99              		.cfi_def_cfa 7, 8
 100 0037 C3       		ret
 101              		.cfi_endproc
 102              	.LFE6:
 104              		.section	.text.mbedtls_ecp_grp_id_list,"ax",@progbits
 105              		.globl	mbedtls_ecp_grp_id_list
 107              	mbedtls_ecp_grp_id_list:
 108              	.LFB7:
 438:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 439:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 440:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * List of supported curves, group ID only
 441:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 442:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** const mbedtls_ecp_group_id *mbedtls_ecp_grp_id_list( void )
 443:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 109              		.loc 1 443 1
 110              		.cfi_startproc
 111 0000 F30F1EFA 		endbr64
 112 0004 55       		pushq	%rbp
 113              	.LCFI3:
 114              		.cfi_def_cfa_offset 16
 115              		.cfi_offset 6, -16
 116 0005 4889E5   		movq	%rsp, %rbp
 117              	.LCFI4:
GAS LISTING /tmp/ccajKZL5.s 			page 11


 118              		.cfi_def_cfa_register 6
 119 0008 4883EC20 		subq	$32, %rsp
 120              		.loc 1 443 1
 121 000c 64488B04 		movq	%fs:40, %rax
 121      25280000 
 121      00
 122 0015 488945F8 		movq	%rax, -8(%rbp)
 123 0019 31C0     		xorl	%eax, %eax
 444:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     static int init_done = 0;
 445:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 446:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ! init_done )
 124              		.loc 1 446 9
 125 001b 8B050000 		movl	init_done.3593(%rip), %eax
 125      0000
 126              		.loc 1 446 7
 127 0021 85C0     		testl	%eax, %eax
 128 0023 756A     		jne	.L5
 129              	.LBB2:
 447:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 448:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         size_t i = 0;
 130              		.loc 1 448 16
 131 0025 48C745E8 		movq	$0, -24(%rbp)
 131      00000000 
 449:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         const mbedtls_ecp_curve_info *curve_info;
 450:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 451:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         for( curve_info = mbedtls_ecp_curve_list();
 132              		.loc 1 451 27
 133 002d E8000000 		call	mbedtls_ecp_curve_list
 133      00
 134 0032 488945F0 		movq	%rax, -16(%rbp)
 135              		.loc 1 451 9
 136 0036 EB29     		jmp	.L6
 137              	.L7:
 452:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              curve_info->grp_id != MBEDTLS_ECP_DP_NONE;
 453:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              curve_info++ )
 454:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         {
 455:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             ecp_supported_grp_id[i++] = curve_info->grp_id;
 138              		.loc 1 455 35
 139 0038 488B45E8 		movq	-24(%rbp), %rax
 140 003c 488D5001 		leaq	1(%rax), %rdx
 141 0040 488955E8 		movq	%rdx, -24(%rbp)
 142              		.loc 1 455 51
 143 0044 488B55F0 		movq	-16(%rbp), %rdx
 144 0048 8B12     		movl	(%rdx), %edx
 145              		.loc 1 455 39
 146 004a 488D0C85 		leaq	0(,%rax,4), %rcx
 146      00000000 
 147 0052 488D0500 		leaq	ecp_supported_grp_id(%rip), %rax
 147      000000
 148 0059 891401   		movl	%edx, (%rcx,%rax)
 453:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         {
 149              		.loc 1 453 24
 150 005c 488345F0 		addq	$16, -16(%rbp)
 150      10
 151              	.L6:
 452:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              curve_info->grp_id != MBEDTLS_ECP_DP_NONE;
 152              		.loc 1 452 24 discriminator 1
GAS LISTING /tmp/ccajKZL5.s 			page 12


 153 0061 488B45F0 		movq	-16(%rbp), %rax
 154 0065 8B00     		movl	(%rax), %eax
 451:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              curve_info->grp_id != MBEDTLS_ECP_DP_NONE;
 155              		.loc 1 451 9 discriminator 1
 156 0067 85C0     		testl	%eax, %eax
 157 0069 75CD     		jne	.L7
 456:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         }
 457:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         ecp_supported_grp_id[i] = MBEDTLS_ECP_DP_NONE;
 158              		.loc 1 457 33
 159 006b 488B45E8 		movq	-24(%rbp), %rax
 160 006f 488D1485 		leaq	0(,%rax,4), %rdx
 160      00000000 
 161 0077 488D0500 		leaq	ecp_supported_grp_id(%rip), %rax
 161      000000
 162 007e C7040200 		movl	$0, (%rdx,%rax)
 162      000000
 458:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 459:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         init_done = 1;
 163              		.loc 1 459 19
 164 0085 C7050000 		movl	$1, init_done.3593(%rip)
 164      00000100 
 164      0000
 165              	.L5:
 166              	.LBE2:
 460:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 461:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 462:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ecp_supported_grp_id );
 167              		.loc 1 462 11
 168 008f 488D0500 		leaq	ecp_supported_grp_id(%rip), %rax
 168      000000
 463:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 169              		.loc 1 463 1
 170 0096 488B75F8 		movq	-8(%rbp), %rsi
 171 009a 64483334 		xorq	%fs:40, %rsi
 171      25280000 
 171      00
 172 00a3 7405     		je	.L9
 173 00a5 E8000000 		call	__stack_chk_fail@PLT
 173      00
 174              	.L9:
 175 00aa C9       		leave
 176              	.LCFI5:
 177              		.cfi_def_cfa 7, 8
 178 00ab C3       		ret
 179              		.cfi_endproc
 180              	.LFE7:
 182              		.section	.text.mbedtls_ecp_curve_info_from_grp_id,"ax",@progbits
 183              		.globl	mbedtls_ecp_curve_info_from_grp_id
 185              	mbedtls_ecp_curve_info_from_grp_id:
 186              	.LFB8:
 464:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 465:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 466:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Get the curve info for the internal identifier
 467:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 468:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** const mbedtls_ecp_curve_info *mbedtls_ecp_curve_info_from_grp_id( mbedtls_ecp_group_id grp_id )
 469:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 187              		.loc 1 469 1
GAS LISTING /tmp/ccajKZL5.s 			page 13


 188              		.cfi_startproc
 189 0000 F30F1EFA 		endbr64
 190 0004 55       		pushq	%rbp
 191              	.LCFI6:
 192              		.cfi_def_cfa_offset 16
 193              		.cfi_offset 6, -16
 194 0005 4889E5   		movq	%rsp, %rbp
 195              	.LCFI7:
 196              		.cfi_def_cfa_register 6
 197 0008 4883EC20 		subq	$32, %rsp
 198 000c 897DEC   		movl	%edi, -20(%rbp)
 199              		.loc 1 469 1
 200 000f 64488B04 		movq	%fs:40, %rax
 200      25280000 
 200      00
 201 0018 488945F8 		movq	%rax, -8(%rbp)
 202 001c 31C0     		xorl	%eax, %eax
 470:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     const mbedtls_ecp_curve_info *curve_info;
 471:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 472:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     for( curve_info = mbedtls_ecp_curve_list();
 203              		.loc 1 472 23
 204 001e E8000000 		call	mbedtls_ecp_curve_list
 204      00
 205 0023 488945F0 		movq	%rax, -16(%rbp)
 206              		.loc 1 472 5
 207 0027 EB16     		jmp	.L11
 208              	.L14:
 473:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          curve_info->grp_id != MBEDTLS_ECP_DP_NONE;
 474:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          curve_info++ )
 475:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 476:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( curve_info->grp_id == grp_id )
 209              		.loc 1 476 23
 210 0029 488B45F0 		movq	-16(%rbp), %rax
 211 002d 8B00     		movl	(%rax), %eax
 212              		.loc 1 476 11
 213 002f 3945EC   		cmpl	%eax, -20(%rbp)
 214 0032 7506     		jne	.L12
 477:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             return( curve_info );
 215              		.loc 1 477 19
 216 0034 488B45F0 		movq	-16(%rbp), %rax
 217 0038 EB14     		jmp	.L13
 218              	.L12:
 474:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 219              		.loc 1 474 20
 220 003a 488345F0 		addq	$16, -16(%rbp)
 220      10
 221              	.L11:
 473:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          curve_info->grp_id != MBEDTLS_ECP_DP_NONE;
 222              		.loc 1 473 20 discriminator 1
 223 003f 488B45F0 		movq	-16(%rbp), %rax
 224 0043 8B00     		movl	(%rax), %eax
 472:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          curve_info->grp_id != MBEDTLS_ECP_DP_NONE;
 225              		.loc 1 472 5 discriminator 1
 226 0045 85C0     		testl	%eax, %eax
 227 0047 75E0     		jne	.L14
 478:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 479:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
GAS LISTING /tmp/ccajKZL5.s 			page 14


 480:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( NULL );
 228              		.loc 1 480 11
 229 0049 B8000000 		movl	$0, %eax
 229      00
 230              	.L13:
 481:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 231              		.loc 1 481 1
 232 004e 488B55F8 		movq	-8(%rbp), %rdx
 233 0052 64483314 		xorq	%fs:40, %rdx
 233      25280000 
 233      00
 234 005b 7405     		je	.L15
 235 005d E8000000 		call	__stack_chk_fail@PLT
 235      00
 236              	.L15:
 237 0062 C9       		leave
 238              	.LCFI8:
 239              		.cfi_def_cfa 7, 8
 240 0063 C3       		ret
 241              		.cfi_endproc
 242              	.LFE8:
 244              		.section	.text.mbedtls_ecp_curve_info_from_tls_id,"ax",@progbits
 245              		.globl	mbedtls_ecp_curve_info_from_tls_id
 247              	mbedtls_ecp_curve_info_from_tls_id:
 248              	.LFB9:
 482:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 483:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 484:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Get the curve info from the TLS identifier
 485:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 486:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** const mbedtls_ecp_curve_info *mbedtls_ecp_curve_info_from_tls_id( uint16_t tls_id )
 487:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 249              		.loc 1 487 1
 250              		.cfi_startproc
 251 0000 F30F1EFA 		endbr64
 252 0004 55       		pushq	%rbp
 253              	.LCFI9:
 254              		.cfi_def_cfa_offset 16
 255              		.cfi_offset 6, -16
 256 0005 4889E5   		movq	%rsp, %rbp
 257              	.LCFI10:
 258              		.cfi_def_cfa_register 6
 259 0008 4883EC20 		subq	$32, %rsp
 260 000c 89F8     		movl	%edi, %eax
 261 000e 668945EC 		movw	%ax, -20(%rbp)
 262              		.loc 1 487 1
 263 0012 64488B04 		movq	%fs:40, %rax
 263      25280000 
 263      00
 264 001b 488945F8 		movq	%rax, -8(%rbp)
 265 001f 31C0     		xorl	%eax, %eax
 488:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     const mbedtls_ecp_curve_info *curve_info;
 489:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 490:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     for( curve_info = mbedtls_ecp_curve_list();
 266              		.loc 1 490 23
 267 0021 E8000000 		call	mbedtls_ecp_curve_list
 267      00
 268 0026 488945F0 		movq	%rax, -16(%rbp)
GAS LISTING /tmp/ccajKZL5.s 			page 15


 269              		.loc 1 490 5
 270 002a EB19     		jmp	.L17
 271              	.L20:
 491:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          curve_info->grp_id != MBEDTLS_ECP_DP_NONE;
 492:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          curve_info++ )
 493:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 494:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( curve_info->tls_id == tls_id )
 272              		.loc 1 494 23
 273 002c 488B45F0 		movq	-16(%rbp), %rax
 274 0030 0FB74004 		movzwl	4(%rax), %eax
 275              		.loc 1 494 11
 276 0034 663945EC 		cmpw	%ax, -20(%rbp)
 277 0038 7506     		jne	.L18
 495:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             return( curve_info );
 278              		.loc 1 495 19
 279 003a 488B45F0 		movq	-16(%rbp), %rax
 280 003e EB14     		jmp	.L19
 281              	.L18:
 492:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 282              		.loc 1 492 20
 283 0040 488345F0 		addq	$16, -16(%rbp)
 283      10
 284              	.L17:
 491:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          curve_info->grp_id != MBEDTLS_ECP_DP_NONE;
 285              		.loc 1 491 20 discriminator 1
 286 0045 488B45F0 		movq	-16(%rbp), %rax
 287 0049 8B00     		movl	(%rax), %eax
 490:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          curve_info->grp_id != MBEDTLS_ECP_DP_NONE;
 288              		.loc 1 490 5 discriminator 1
 289 004b 85C0     		testl	%eax, %eax
 290 004d 75DD     		jne	.L20
 496:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 497:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 498:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( NULL );
 291              		.loc 1 498 11
 292 004f B8000000 		movl	$0, %eax
 292      00
 293              	.L19:
 499:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 294              		.loc 1 499 1
 295 0054 488B55F8 		movq	-8(%rbp), %rdx
 296 0058 64483314 		xorq	%fs:40, %rdx
 296      25280000 
 296      00
 297 0061 7405     		je	.L21
 298 0063 E8000000 		call	__stack_chk_fail@PLT
 298      00
 299              	.L21:
 300 0068 C9       		leave
 301              	.LCFI11:
 302              		.cfi_def_cfa 7, 8
 303 0069 C3       		ret
 304              		.cfi_endproc
 305              	.LFE9:
 307              		.section	.text.mbedtls_ecp_curve_info_from_name,"ax",@progbits
 308              		.globl	mbedtls_ecp_curve_info_from_name
 310              	mbedtls_ecp_curve_info_from_name:
GAS LISTING /tmp/ccajKZL5.s 			page 16


 311              	.LFB10:
 500:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 501:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 502:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Get the curve info from the name
 503:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 504:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** const mbedtls_ecp_curve_info *mbedtls_ecp_curve_info_from_name( const char *name )
 505:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 312              		.loc 1 505 1
 313              		.cfi_startproc
 314 0000 F30F1EFA 		endbr64
 315 0004 55       		pushq	%rbp
 316              	.LCFI12:
 317              		.cfi_def_cfa_offset 16
 318              		.cfi_offset 6, -16
 319 0005 4889E5   		movq	%rsp, %rbp
 320              	.LCFI13:
 321              		.cfi_def_cfa_register 6
 322 0008 4883EC20 		subq	$32, %rsp
 323 000c 48897DE8 		movq	%rdi, -24(%rbp)
 324              		.loc 1 505 1
 325 0010 64488B04 		movq	%fs:40, %rax
 325      25280000 
 325      00
 326 0019 488945F8 		movq	%rax, -8(%rbp)
 327 001d 31C0     		xorl	%eax, %eax
 506:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     const mbedtls_ecp_curve_info *curve_info;
 507:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 508:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( name == NULL )
 328              		.loc 1 508 7
 329 001f 48837DE8 		cmpq	$0, -24(%rbp)
 329      00
 330 0024 7507     		jne	.L23
 509:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( NULL );
 331              		.loc 1 509 15
 332 0026 B8000000 		movl	$0, %eax
 332      00
 333 002b EB40     		jmp	.L24
 334              	.L23:
 510:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 511:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     for( curve_info = mbedtls_ecp_curve_list();
 335              		.loc 1 511 23
 336 002d E8000000 		call	mbedtls_ecp_curve_list
 336      00
 337 0032 488945F0 		movq	%rax, -16(%rbp)
 338              		.loc 1 511 5
 339 0036 EB26     		jmp	.L25
 340              	.L27:
 512:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          curve_info->grp_id != MBEDTLS_ECP_DP_NONE;
 513:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          curve_info++ )
 514:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 515:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( strcmp( curve_info->name, name ) == 0 )
 341              		.loc 1 515 13
 342 0038 488B45F0 		movq	-16(%rbp), %rax
 343 003c 488B4008 		movq	8(%rax), %rax
 344 0040 488B55E8 		movq	-24(%rbp), %rdx
 345 0044 4889D6   		movq	%rdx, %rsi
 346 0047 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/ccajKZL5.s 			page 17


 347 004a E8000000 		call	strcmp@PLT
 347      00
 348              		.loc 1 515 11
 349 004f 85C0     		testl	%eax, %eax
 350 0051 7506     		jne	.L26
 516:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             return( curve_info );
 351              		.loc 1 516 19
 352 0053 488B45F0 		movq	-16(%rbp), %rax
 353 0057 EB14     		jmp	.L24
 354              	.L26:
 513:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 355              		.loc 1 513 20
 356 0059 488345F0 		addq	$16, -16(%rbp)
 356      10
 357              	.L25:
 512:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          curve_info->grp_id != MBEDTLS_ECP_DP_NONE;
 358              		.loc 1 512 20 discriminator 1
 359 005e 488B45F0 		movq	-16(%rbp), %rax
 360 0062 8B00     		movl	(%rax), %eax
 511:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          curve_info->grp_id != MBEDTLS_ECP_DP_NONE;
 361              		.loc 1 511 5 discriminator 1
 362 0064 85C0     		testl	%eax, %eax
 363 0066 75D0     		jne	.L27
 517:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 518:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 519:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( NULL );
 364              		.loc 1 519 11
 365 0068 B8000000 		movl	$0, %eax
 365      00
 366              	.L24:
 520:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 367              		.loc 1 520 1
 368 006d 488B4DF8 		movq	-8(%rbp), %rcx
 369 0071 6448330C 		xorq	%fs:40, %rcx
 369      25280000 
 369      00
 370 007a 7405     		je	.L28
 371 007c E8000000 		call	__stack_chk_fail@PLT
 371      00
 372              	.L28:
 373 0081 C9       		leave
 374              	.LCFI14:
 375              		.cfi_def_cfa 7, 8
 376 0082 C3       		ret
 377              		.cfi_endproc
 378              	.LFE10:
 380              		.section	.text.ecp_get_type,"ax",@progbits
 382              	ecp_get_type:
 383              	.LFB11:
 521:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 522:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 523:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Get the type of a curve
 524:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 525:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static inline ecp_curve_type ecp_get_type( const mbedtls_ecp_group *grp )
 526:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 384              		.loc 1 526 1
 385              		.cfi_startproc
GAS LISTING /tmp/ccajKZL5.s 			page 18


 386 0000 55       		pushq	%rbp
 387              	.LCFI15:
 388              		.cfi_def_cfa_offset 16
 389              		.cfi_offset 6, -16
 390 0001 4889E5   		movq	%rsp, %rbp
 391              	.LCFI16:
 392              		.cfi_def_cfa_register 6
 393 0004 4883EC20 		subq	$32, %rsp
 394 0008 48897DE8 		movq	%rdi, -24(%rbp)
 395              		.loc 1 526 1
 396 000c 64488B04 		movq	%fs:40, %rax
 396      25280000 
 396      00
 397 0015 488945F8 		movq	%rax, -8(%rbp)
 398 0019 31C0     		xorl	%eax, %eax
 527:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( grp->G.X.p == NULL )
 399              		.loc 1 527 17
 400 001b 488B45E8 		movq	-24(%rbp), %rax
 401 001f 488B4060 		movq	96(%rax), %rax
 402              		.loc 1 527 7
 403 0023 4885C0   		testq	%rax, %rax
 404 0026 7507     		jne	.L30
 528:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( ECP_TYPE_NONE );
 405              		.loc 1 528 15
 406 0028 B8000000 		movl	$0, %eax
 406      00
 407 002d EB19     		jmp	.L31
 408              	.L30:
 529:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 530:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( grp->G.Y.p == NULL )
 409              		.loc 1 530 17
 410 002f 488B45E8 		movq	-24(%rbp), %rax
 411 0033 488B4078 		movq	120(%rax), %rax
 412              		.loc 1 530 7
 413 0037 4885C0   		testq	%rax, %rax
 414 003a 7507     		jne	.L32
 531:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( ECP_TYPE_MONTGOMERY );
 415              		.loc 1 531 15
 416 003c B8020000 		movl	$2, %eax
 416      00
 417 0041 EB05     		jmp	.L31
 418              	.L32:
 532:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     else
 533:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( ECP_TYPE_SHORT_WEIERSTRASS );
 419              		.loc 1 533 15
 420 0043 B8010000 		movl	$1, %eax
 420      00
 421              	.L31:
 534:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 422              		.loc 1 534 1
 423 0048 488B55F8 		movq	-8(%rbp), %rdx
 424 004c 64483314 		xorq	%fs:40, %rdx
 424      25280000 
 424      00
 425 0055 7405     		je	.L33
 426 0057 E8000000 		call	__stack_chk_fail@PLT
 426      00
GAS LISTING /tmp/ccajKZL5.s 			page 19


 427              	.L33:
 428 005c C9       		leave
 429              	.LCFI17:
 430              		.cfi_def_cfa 7, 8
 431 005d C3       		ret
 432              		.cfi_endproc
 433              	.LFE11:
 435              		.section	.text.mbedtls_ecp_point_init,"ax",@progbits
 436              		.globl	mbedtls_ecp_point_init
 438              	mbedtls_ecp_point_init:
 439              	.LFB12:
 535:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 536:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 537:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Initialize (the components of) a point
 538:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 539:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** void mbedtls_ecp_point_init( mbedtls_ecp_point *pt )
 540:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 440              		.loc 1 540 1
 441              		.cfi_startproc
 442 0000 F30F1EFA 		endbr64
 443 0004 55       		pushq	%rbp
 444              	.LCFI18:
 445              		.cfi_def_cfa_offset 16
 446              		.cfi_offset 6, -16
 447 0005 4889E5   		movq	%rsp, %rbp
 448              	.LCFI19:
 449              		.cfi_def_cfa_register 6
 450 0008 4883EC20 		subq	$32, %rsp
 451 000c 48897DE8 		movq	%rdi, -24(%rbp)
 452              		.loc 1 540 1
 453 0010 64488B04 		movq	%fs:40, %rax
 453      25280000 
 453      00
 454 0019 488945F8 		movq	%rax, -8(%rbp)
 455 001d 31C0     		xorl	%eax, %eax
 541:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE( pt != NULL );
 542:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 543:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_init( &pt->X );
 456              		.loc 1 543 5
 457 001f 488B45E8 		movq	-24(%rbp), %rax
 458 0023 4889C7   		movq	%rax, %rdi
 459 0026 E8000000 		call	mbedtls_mpi_init@PLT
 459      00
 544:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_init( &pt->Y );
 460              		.loc 1 544 5
 461 002b 488B45E8 		movq	-24(%rbp), %rax
 462 002f 4883C018 		addq	$24, %rax
 463 0033 4889C7   		movq	%rax, %rdi
 464 0036 E8000000 		call	mbedtls_mpi_init@PLT
 464      00
 545:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_init( &pt->Z );
 465              		.loc 1 545 5
 466 003b 488B45E8 		movq	-24(%rbp), %rax
 467 003f 4883C030 		addq	$48, %rax
 468 0043 4889C7   		movq	%rax, %rdi
 469 0046 E8000000 		call	mbedtls_mpi_init@PLT
 469      00
GAS LISTING /tmp/ccajKZL5.s 			page 20


 546:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 470              		.loc 1 546 1
 471 004b 90       		nop
 472 004c 488B45F8 		movq	-8(%rbp), %rax
 473 0050 64483304 		xorq	%fs:40, %rax
 473      25280000 
 473      00
 474 0059 7405     		je	.L35
 475 005b E8000000 		call	__stack_chk_fail@PLT
 475      00
 476              	.L35:
 477 0060 C9       		leave
 478              	.LCFI20:
 479              		.cfi_def_cfa 7, 8
 480 0061 C3       		ret
 481              		.cfi_endproc
 482              	.LFE12:
 484              		.section	.text.mbedtls_ecp_group_init,"ax",@progbits
 485              		.globl	mbedtls_ecp_group_init
 487              	mbedtls_ecp_group_init:
 488              	.LFB13:
 547:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 548:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 549:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Initialize (the components of) a group
 550:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 551:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** void mbedtls_ecp_group_init( mbedtls_ecp_group *grp )
 552:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 489              		.loc 1 552 1
 490              		.cfi_startproc
 491 0000 F30F1EFA 		endbr64
 492 0004 55       		pushq	%rbp
 493              	.LCFI21:
 494              		.cfi_def_cfa_offset 16
 495              		.cfi_offset 6, -16
 496 0005 4889E5   		movq	%rsp, %rbp
 497              	.LCFI22:
 498              		.cfi_def_cfa_register 6
 499 0008 4883EC20 		subq	$32, %rsp
 500 000c 48897DE8 		movq	%rdi, -24(%rbp)
 501              		.loc 1 552 1
 502 0010 64488B04 		movq	%fs:40, %rax
 502      25280000 
 502      00
 503 0019 488945F8 		movq	%rax, -8(%rbp)
 504 001d 31C0     		xorl	%eax, %eax
 553:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE( grp != NULL );
 554:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 555:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     grp->id = MBEDTLS_ECP_DP_NONE;
 505              		.loc 1 555 13
 506 001f 488B45E8 		movq	-24(%rbp), %rax
 507 0023 C7000000 		movl	$0, (%rax)
 507      0000
 556:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_init( &grp->P );
 508              		.loc 1 556 5
 509 0029 488B45E8 		movq	-24(%rbp), %rax
 510 002d 4883C008 		addq	$8, %rax
 511 0031 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/ccajKZL5.s 			page 21


 512 0034 E8000000 		call	mbedtls_mpi_init@PLT
 512      00
 557:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_init( &grp->A );
 513              		.loc 1 557 5
 514 0039 488B45E8 		movq	-24(%rbp), %rax
 515 003d 4883C020 		addq	$32, %rax
 516 0041 4889C7   		movq	%rax, %rdi
 517 0044 E8000000 		call	mbedtls_mpi_init@PLT
 517      00
 558:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_init( &grp->B );
 518              		.loc 1 558 5
 519 0049 488B45E8 		movq	-24(%rbp), %rax
 520 004d 4883C038 		addq	$56, %rax
 521 0051 4889C7   		movq	%rax, %rdi
 522 0054 E8000000 		call	mbedtls_mpi_init@PLT
 522      00
 559:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point_init( &grp->G );
 523              		.loc 1 559 5
 524 0059 488B45E8 		movq	-24(%rbp), %rax
 525 005d 4883C050 		addq	$80, %rax
 526 0061 4889C7   		movq	%rax, %rdi
 527 0064 E8000000 		call	mbedtls_ecp_point_init
 527      00
 560:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_init( &grp->N );
 528              		.loc 1 560 5
 529 0069 488B45E8 		movq	-24(%rbp), %rax
 530 006d 48059800 		addq	$152, %rax
 530      0000
 531 0073 4889C7   		movq	%rax, %rdi
 532 0076 E8000000 		call	mbedtls_mpi_init@PLT
 532      00
 561:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     grp->pbits = 0;
 533              		.loc 1 561 16
 534 007b 488B45E8 		movq	-24(%rbp), %rax
 535 007f 48C780B0 		movq	$0, 176(%rax)
 535      00000000 
 535      000000
 562:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     grp->nbits = 0;
 536              		.loc 1 562 16
 537 008a 488B45E8 		movq	-24(%rbp), %rax
 538 008e 48C780B8 		movq	$0, 184(%rax)
 538      00000000 
 538      000000
 563:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     grp->h = 0;
 539              		.loc 1 563 12
 540 0099 488B45E8 		movq	-24(%rbp), %rax
 541 009d C780C000 		movl	$0, 192(%rax)
 541      00000000 
 541      0000
 564:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     grp->modp = NULL;
 542              		.loc 1 564 15
 543 00a7 488B45E8 		movq	-24(%rbp), %rax
 544 00ab 48C780C8 		movq	$0, 200(%rax)
 544      00000000 
 544      000000
 565:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     grp->t_pre = NULL;
 545              		.loc 1 565 16
GAS LISTING /tmp/ccajKZL5.s 			page 22


 546 00b6 488B45E8 		movq	-24(%rbp), %rax
 547 00ba 48C780D0 		movq	$0, 208(%rax)
 547      00000000 
 547      000000
 566:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     grp->t_post = NULL;
 548              		.loc 1 566 17
 549 00c5 488B45E8 		movq	-24(%rbp), %rax
 550 00c9 48C780D8 		movq	$0, 216(%rax)
 550      00000000 
 550      000000
 567:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     grp->t_data = NULL;
 551              		.loc 1 567 17
 552 00d4 488B45E8 		movq	-24(%rbp), %rax
 553 00d8 48C780E0 		movq	$0, 224(%rax)
 553      00000000 
 553      000000
 568:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     grp->T = NULL;
 554              		.loc 1 568 12
 555 00e3 488B45E8 		movq	-24(%rbp), %rax
 556 00e7 48C780E8 		movq	$0, 232(%rax)
 556      00000000 
 556      000000
 569:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     grp->T_size = 0;
 557              		.loc 1 569 17
 558 00f2 488B45E8 		movq	-24(%rbp), %rax
 559 00f6 48C780F0 		movq	$0, 240(%rax)
 559      00000000 
 559      000000
 570:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 560              		.loc 1 570 1
 561 0101 90       		nop
 562 0102 488B45F8 		movq	-8(%rbp), %rax
 563 0106 64483304 		xorq	%fs:40, %rax
 563      25280000 
 563      00
 564 010f 7405     		je	.L37
 565 0111 E8000000 		call	__stack_chk_fail@PLT
 565      00
 566              	.L37:
 567 0116 C9       		leave
 568              	.LCFI23:
 569              		.cfi_def_cfa 7, 8
 570 0117 C3       		ret
 571              		.cfi_endproc
 572              	.LFE13:
 574              		.section	.text.mbedtls_ecp_keypair_init,"ax",@progbits
 575              		.globl	mbedtls_ecp_keypair_init
 577              	mbedtls_ecp_keypair_init:
 578              	.LFB14:
 571:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 572:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 573:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Initialize (the components of) a key pair
 574:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 575:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** void mbedtls_ecp_keypair_init( mbedtls_ecp_keypair *key )
 576:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 579              		.loc 1 576 1
 580              		.cfi_startproc
GAS LISTING /tmp/ccajKZL5.s 			page 23


 581 0000 F30F1EFA 		endbr64
 582 0004 55       		pushq	%rbp
 583              	.LCFI24:
 584              		.cfi_def_cfa_offset 16
 585              		.cfi_offset 6, -16
 586 0005 4889E5   		movq	%rsp, %rbp
 587              	.LCFI25:
 588              		.cfi_def_cfa_register 6
 589 0008 4883EC20 		subq	$32, %rsp
 590 000c 48897DE8 		movq	%rdi, -24(%rbp)
 591              		.loc 1 576 1
 592 0010 64488B04 		movq	%fs:40, %rax
 592      25280000 
 592      00
 593 0019 488945F8 		movq	%rax, -8(%rbp)
 594 001d 31C0     		xorl	%eax, %eax
 577:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE( key != NULL );
 578:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 579:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_group_init( &key->grp );
 595              		.loc 1 579 5
 596 001f 488B45E8 		movq	-24(%rbp), %rax
 597 0023 4889C7   		movq	%rax, %rdi
 598 0026 E8000000 		call	mbedtls_ecp_group_init
 598      00
 580:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_init( &key->d );
 599              		.loc 1 580 5
 600 002b 488B45E8 		movq	-24(%rbp), %rax
 601 002f 4805F800 		addq	$248, %rax
 601      0000
 602 0035 4889C7   		movq	%rax, %rdi
 603 0038 E8000000 		call	mbedtls_mpi_init@PLT
 603      00
 581:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point_init( &key->Q );
 604              		.loc 1 581 5
 605 003d 488B45E8 		movq	-24(%rbp), %rax
 606 0041 48051001 		addq	$272, %rax
 606      0000
 607 0047 4889C7   		movq	%rax, %rdi
 608 004a E8000000 		call	mbedtls_ecp_point_init
 608      00
 582:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 609              		.loc 1 582 1
 610 004f 90       		nop
 611 0050 488B45F8 		movq	-8(%rbp), %rax
 612 0054 64483304 		xorq	%fs:40, %rax
 612      25280000 
 612      00
 613 005d 7405     		je	.L39
 614 005f E8000000 		call	__stack_chk_fail@PLT
 614      00
 615              	.L39:
 616 0064 C9       		leave
 617              	.LCFI26:
 618              		.cfi_def_cfa 7, 8
 619 0065 C3       		ret
 620              		.cfi_endproc
 621              	.LFE14:
GAS LISTING /tmp/ccajKZL5.s 			page 24


 623              		.section	.text.mbedtls_ecp_point_free,"ax",@progbits
 624              		.globl	mbedtls_ecp_point_free
 626              	mbedtls_ecp_point_free:
 627              	.LFB15:
 583:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 584:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 585:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Unallocate (the components of) a point
 586:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 587:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** void mbedtls_ecp_point_free( mbedtls_ecp_point *pt )
 588:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 628              		.loc 1 588 1
 629              		.cfi_startproc
 630 0000 F30F1EFA 		endbr64
 631 0004 55       		pushq	%rbp
 632              	.LCFI27:
 633              		.cfi_def_cfa_offset 16
 634              		.cfi_offset 6, -16
 635 0005 4889E5   		movq	%rsp, %rbp
 636              	.LCFI28:
 637              		.cfi_def_cfa_register 6
 638 0008 4883EC20 		subq	$32, %rsp
 639 000c 48897DE8 		movq	%rdi, -24(%rbp)
 640              		.loc 1 588 1
 641 0010 64488B04 		movq	%fs:40, %rax
 641      25280000 
 641      00
 642 0019 488945F8 		movq	%rax, -8(%rbp)
 643 001d 31C0     		xorl	%eax, %eax
 589:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( pt == NULL )
 644              		.loc 1 589 7
 645 001f 48837DE8 		cmpq	$0, -24(%rbp)
 645      00
 646 0024 742E     		je	.L44
 590:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return;
 591:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 592:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_free( &( pt->X ) );
 647              		.loc 1 592 5
 648 0026 488B45E8 		movq	-24(%rbp), %rax
 649 002a 4889C7   		movq	%rax, %rdi
 650 002d E8000000 		call	mbedtls_mpi_free@PLT
 650      00
 593:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_free( &( pt->Y ) );
 651              		.loc 1 593 5
 652 0032 488B45E8 		movq	-24(%rbp), %rax
 653 0036 4883C018 		addq	$24, %rax
 654 003a 4889C7   		movq	%rax, %rdi
 655 003d E8000000 		call	mbedtls_mpi_free@PLT
 655      00
 594:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_free( &( pt->Z ) );
 656              		.loc 1 594 5
 657 0042 488B45E8 		movq	-24(%rbp), %rax
 658 0046 4883C030 		addq	$48, %rax
 659 004a 4889C7   		movq	%rax, %rdi
 660 004d E8000000 		call	mbedtls_mpi_free@PLT
 660      00
 661 0052 EB01     		jmp	.L40
 662              	.L44:
GAS LISTING /tmp/ccajKZL5.s 			page 25


 590:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return;
 663              		.loc 1 590 9
 664 0054 90       		nop
 665              	.L40:
 595:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 666              		.loc 1 595 1
 667 0055 488B45F8 		movq	-8(%rbp), %rax
 668 0059 64483304 		xorq	%fs:40, %rax
 668      25280000 
 668      00
 669 0062 7405     		je	.L43
 670 0064 E8000000 		call	__stack_chk_fail@PLT
 670      00
 671              	.L43:
 672 0069 C9       		leave
 673              	.LCFI29:
 674              		.cfi_def_cfa 7, 8
 675 006a C3       		ret
 676              		.cfi_endproc
 677              	.LFE15:
 679              		.section	.text.mbedtls_ecp_group_free,"ax",@progbits
 680              		.globl	mbedtls_ecp_group_free
 682              	mbedtls_ecp_group_free:
 683              	.LFB16:
 596:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 597:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 598:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Unallocate (the components of) a group
 599:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 600:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** void mbedtls_ecp_group_free( mbedtls_ecp_group *grp )
 601:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 684              		.loc 1 601 1
 685              		.cfi_startproc
 686 0000 F30F1EFA 		endbr64
 687 0004 55       		pushq	%rbp
 688              	.LCFI30:
 689              		.cfi_def_cfa_offset 16
 690              		.cfi_offset 6, -16
 691 0005 4889E5   		movq	%rsp, %rbp
 692              	.LCFI31:
 693              		.cfi_def_cfa_register 6
 694 0008 4883EC20 		subq	$32, %rsp
 695 000c 48897DE8 		movq	%rdi, -24(%rbp)
 696              		.loc 1 601 1
 697 0010 64488B04 		movq	%fs:40, %rax
 697      25280000 
 697      00
 698 0019 488945F8 		movq	%rax, -8(%rbp)
 699 001d 31C0     		xorl	%eax, %eax
 602:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     size_t i;
 603:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 604:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( grp == NULL )
 700              		.loc 1 604 7
 701 001f 48837DE8 		cmpq	$0, -24(%rbp)
 701      00
 702 0024 0F84DF00 		je	.L53
 702      0000
 605:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return;
GAS LISTING /tmp/ccajKZL5.s 			page 26


 606:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 607:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( grp->h != 1 )
 703              		.loc 1 607 12
 704 002a 488B45E8 		movq	-24(%rbp), %rax
 705 002e 8B80C000 		movl	192(%rax), %eax
 705      0000
 706              		.loc 1 607 7
 707 0034 83F801   		cmpl	$1, %eax
 708 0037 7452     		je	.L48
 608:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 609:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_free( &grp->P );
 709              		.loc 1 609 9
 710 0039 488B45E8 		movq	-24(%rbp), %rax
 711 003d 4883C008 		addq	$8, %rax
 712 0041 4889C7   		movq	%rax, %rdi
 713 0044 E8000000 		call	mbedtls_mpi_free@PLT
 713      00
 610:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_free( &grp->A );
 714              		.loc 1 610 9
 715 0049 488B45E8 		movq	-24(%rbp), %rax
 716 004d 4883C020 		addq	$32, %rax
 717 0051 4889C7   		movq	%rax, %rdi
 718 0054 E8000000 		call	mbedtls_mpi_free@PLT
 718      00
 611:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_free( &grp->B );
 719              		.loc 1 611 9
 720 0059 488B45E8 		movq	-24(%rbp), %rax
 721 005d 4883C038 		addq	$56, %rax
 722 0061 4889C7   		movq	%rax, %rdi
 723 0064 E8000000 		call	mbedtls_mpi_free@PLT
 723      00
 612:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_ecp_point_free( &grp->G );
 724              		.loc 1 612 9
 725 0069 488B45E8 		movq	-24(%rbp), %rax
 726 006d 4883C050 		addq	$80, %rax
 727 0071 4889C7   		movq	%rax, %rdi
 728 0074 E8000000 		call	mbedtls_ecp_point_free
 728      00
 613:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_free( &grp->N );
 729              		.loc 1 613 9
 730 0079 488B45E8 		movq	-24(%rbp), %rax
 731 007d 48059800 		addq	$152, %rax
 731      0000
 732 0083 4889C7   		movq	%rax, %rdi
 733 0086 E8000000 		call	mbedtls_mpi_free@PLT
 733      00
 734              	.L48:
 614:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 615:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 616:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( grp->T != NULL )
 735              		.loc 1 616 12
 736 008b 488B45E8 		movq	-24(%rbp), %rax
 737 008f 488B80E8 		movq	232(%rax), %rax
 737      000000
 738              		.loc 1 616 7
 739 0096 4885C0   		testq	%rax, %rax
 740 0099 745B     		je	.L49
GAS LISTING /tmp/ccajKZL5.s 			page 27


 617:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 618:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         for( i = 0; i < grp->T_size; i++ )
 741              		.loc 1 618 16
 742 009b 48C745F0 		movq	$0, -16(%rbp)
 742      00000000 
 743              		.loc 1 618 9
 744 00a3 EB2D     		jmp	.L50
 745              	.L51:
 619:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             mbedtls_ecp_point_free( &grp->T[i] );
 746              		.loc 1 619 41 discriminator 3
 747 00a5 488B45E8 		movq	-24(%rbp), %rax
 748 00a9 488B88E8 		movq	232(%rax), %rcx
 748      000000
 749              		.loc 1 619 44 discriminator 3
 750 00b0 488B55F0 		movq	-16(%rbp), %rdx
 751 00b4 4889D0   		movq	%rdx, %rax
 752 00b7 48C1E003 		salq	$3, %rax
 753 00bb 4801D0   		addq	%rdx, %rax
 754 00be 48C1E003 		salq	$3, %rax
 755              		.loc 1 619 13 discriminator 3
 756 00c2 4801C8   		addq	%rcx, %rax
 757 00c5 4889C7   		movq	%rax, %rdi
 758 00c8 E8000000 		call	mbedtls_ecp_point_free
 758      00
 618:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             mbedtls_ecp_point_free( &grp->T[i] );
 759              		.loc 1 618 39 discriminator 3
 760 00cd 488345F0 		addq	$1, -16(%rbp)
 760      01
 761              	.L50:
 618:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             mbedtls_ecp_point_free( &grp->T[i] );
 762              		.loc 1 618 28 discriminator 1
 763 00d2 488B45E8 		movq	-24(%rbp), %rax
 764 00d6 488B80F0 		movq	240(%rax), %rax
 764      000000
 618:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             mbedtls_ecp_point_free( &grp->T[i] );
 765              		.loc 1 618 9 discriminator 1
 766 00dd 483945F0 		cmpq	%rax, -16(%rbp)
 767 00e1 72C2     		jb	.L51
 620:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_free( grp->T );
 768              		.loc 1 620 26
 769 00e3 488B45E8 		movq	-24(%rbp), %rax
 770 00e7 488B80E8 		movq	232(%rax), %rax
 770      000000
 771              		.loc 1 620 9
 772 00ee 4889C7   		movq	%rax, %rdi
 773 00f1 E8000000 		call	mbedtls_free@PLT
 773      00
 774              	.L49:
 621:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 622:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 623:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_platform_zeroize( grp, sizeof( mbedtls_ecp_group ) );
 775              		.loc 1 623 5
 776 00f6 488B45E8 		movq	-24(%rbp), %rax
 777 00fa BEF80000 		movl	$248, %esi
 777      00
 778 00ff 4889C7   		movq	%rax, %rdi
 779 0102 E8000000 		call	mbedtls_platform_zeroize@PLT
GAS LISTING /tmp/ccajKZL5.s 			page 28


 779      00
 780 0107 EB01     		jmp	.L45
 781              	.L53:
 605:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 782              		.loc 1 605 9
 783 0109 90       		nop
 784              	.L45:
 624:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 785              		.loc 1 624 1
 786 010a 488B45F8 		movq	-8(%rbp), %rax
 787 010e 64483304 		xorq	%fs:40, %rax
 787      25280000 
 787      00
 788 0117 7405     		je	.L52
 789 0119 E8000000 		call	__stack_chk_fail@PLT
 789      00
 790              	.L52:
 791 011e C9       		leave
 792              	.LCFI32:
 793              		.cfi_def_cfa 7, 8
 794 011f C3       		ret
 795              		.cfi_endproc
 796              	.LFE16:
 798              		.section	.text.mbedtls_ecp_keypair_free,"ax",@progbits
 799              		.globl	mbedtls_ecp_keypair_free
 801              	mbedtls_ecp_keypair_free:
 802              	.LFB17:
 625:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 626:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 627:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Unallocate (the components of) a key pair
 628:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 629:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** void mbedtls_ecp_keypair_free( mbedtls_ecp_keypair *key )
 630:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 803              		.loc 1 630 1
 804              		.cfi_startproc
 805 0000 F30F1EFA 		endbr64
 806 0004 55       		pushq	%rbp
 807              	.LCFI33:
 808              		.cfi_def_cfa_offset 16
 809              		.cfi_offset 6, -16
 810 0005 4889E5   		movq	%rsp, %rbp
 811              	.LCFI34:
 812              		.cfi_def_cfa_register 6
 813 0008 4883EC20 		subq	$32, %rsp
 814 000c 48897DE8 		movq	%rdi, -24(%rbp)
 815              		.loc 1 630 1
 816 0010 64488B04 		movq	%fs:40, %rax
 816      25280000 
 816      00
 817 0019 488945F8 		movq	%rax, -8(%rbp)
 818 001d 31C0     		xorl	%eax, %eax
 631:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( key == NULL )
 819              		.loc 1 631 7
 820 001f 48837DE8 		cmpq	$0, -24(%rbp)
 820      00
 821 0024 7432     		je	.L58
 632:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return;
GAS LISTING /tmp/ccajKZL5.s 			page 29


 633:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 634:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_group_free( &key->grp );
 822              		.loc 1 634 5
 823 0026 488B45E8 		movq	-24(%rbp), %rax
 824 002a 4889C7   		movq	%rax, %rdi
 825 002d E8000000 		call	mbedtls_ecp_group_free
 825      00
 635:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_free( &key->d );
 826              		.loc 1 635 5
 827 0032 488B45E8 		movq	-24(%rbp), %rax
 828 0036 4805F800 		addq	$248, %rax
 828      0000
 829 003c 4889C7   		movq	%rax, %rdi
 830 003f E8000000 		call	mbedtls_mpi_free@PLT
 830      00
 636:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point_free( &key->Q );
 831              		.loc 1 636 5
 832 0044 488B45E8 		movq	-24(%rbp), %rax
 833 0048 48051001 		addq	$272, %rax
 833      0000
 834 004e 4889C7   		movq	%rax, %rdi
 835 0051 E8000000 		call	mbedtls_ecp_point_free
 835      00
 836 0056 EB01     		jmp	.L54
 837              	.L58:
 632:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return;
 838              		.loc 1 632 9
 839 0058 90       		nop
 840              	.L54:
 637:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 841              		.loc 1 637 1
 842 0059 488B45F8 		movq	-8(%rbp), %rax
 843 005d 64483304 		xorq	%fs:40, %rax
 843      25280000 
 843      00
 844 0066 7405     		je	.L57
 845 0068 E8000000 		call	__stack_chk_fail@PLT
 845      00
 846              	.L57:
 847 006d C9       		leave
 848              	.LCFI35:
 849              		.cfi_def_cfa 7, 8
 850 006e C3       		ret
 851              		.cfi_endproc
 852              	.LFE17:
 854              		.section	.text.mbedtls_ecp_copy,"ax",@progbits
 855              		.globl	mbedtls_ecp_copy
 857              	mbedtls_ecp_copy:
 858              	.LFB18:
 638:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 639:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 640:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Copy the contents of a point
 641:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 642:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_copy( mbedtls_ecp_point *P, const mbedtls_ecp_point *Q )
 643:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 859              		.loc 1 643 1
 860              		.cfi_startproc
GAS LISTING /tmp/ccajKZL5.s 			page 30


 861 0000 F30F1EFA 		endbr64
 862 0004 55       		pushq	%rbp
 863              	.LCFI36:
 864              		.cfi_def_cfa_offset 16
 865              		.cfi_offset 6, -16
 866 0005 4889E5   		movq	%rsp, %rbp
 867              	.LCFI37:
 868              		.cfi_def_cfa_register 6
 869 0008 4883EC20 		subq	$32, %rsp
 870 000c 48897DE8 		movq	%rdi, -24(%rbp)
 871 0010 488975E0 		movq	%rsi, -32(%rbp)
 872              		.loc 1 643 1
 873 0014 64488B04 		movq	%fs:40, %rax
 873      25280000 
 873      00
 874 001d 488945F8 		movq	%rax, -8(%rbp)
 875 0021 31C0     		xorl	%eax, %eax
 644:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
 645:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( P != NULL );
 646:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( Q != NULL );
 647:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 648:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &P->X, &Q->X ) );
 876              		.loc 1 648 5
 877 0023 488B55E0 		movq	-32(%rbp), %rdx
 878 0027 488B45E8 		movq	-24(%rbp), %rax
 879 002b 4889D6   		movq	%rdx, %rsi
 880 002e 4889C7   		movq	%rax, %rdi
 881 0031 E8000000 		call	mbedtls_mpi_copy@PLT
 881      00
 882 0036 8945F4   		movl	%eax, -12(%rbp)
 883 0039 837DF400 		cmpl	$0, -12(%rbp)
 884 003d 7548     		jne	.L65
 649:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &P->Y, &Q->Y ) );
 885              		.loc 1 649 5
 886 003f 488B45E0 		movq	-32(%rbp), %rax
 887 0043 488D5018 		leaq	24(%rax), %rdx
 888 0047 488B45E8 		movq	-24(%rbp), %rax
 889 004b 4883C018 		addq	$24, %rax
 890 004f 4889D6   		movq	%rdx, %rsi
 891 0052 4889C7   		movq	%rax, %rdi
 892 0055 E8000000 		call	mbedtls_mpi_copy@PLT
 892      00
 893 005a 8945F4   		movl	%eax, -12(%rbp)
 894 005d 837DF400 		cmpl	$0, -12(%rbp)
 895 0061 7527     		jne	.L66
 650:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &P->Z, &Q->Z ) );
 896              		.loc 1 650 5
 897 0063 488B45E0 		movq	-32(%rbp), %rax
 898 0067 488D5030 		leaq	48(%rax), %rdx
 899 006b 488B45E8 		movq	-24(%rbp), %rax
 900 006f 4883C030 		addq	$48, %rax
 901 0073 4889D6   		movq	%rdx, %rsi
 902 0076 4889C7   		movq	%rax, %rdi
 903 0079 E8000000 		call	mbedtls_mpi_copy@PLT
 903      00
 904 007e 8945F4   		movl	%eax, -12(%rbp)
 905 0081 837DF400 		cmpl	$0, -12(%rbp)
GAS LISTING /tmp/ccajKZL5.s 			page 31


 651:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 652:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
 906              		.loc 1 652 1
 907 0085 EB04     		jmp	.L61
 908              	.L65:
 648:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &P->Y, &Q->Y ) );
 909              		.loc 1 648 5
 910 0087 90       		nop
 911 0088 EB01     		jmp	.L61
 912              	.L66:
 649:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &P->Z, &Q->Z ) );
 913              		.loc 1 649 5
 914 008a 90       		nop
 915              	.L61:
 653:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 916              		.loc 1 653 11
 917 008b 8B45F4   		movl	-12(%rbp), %eax
 654:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 918              		.loc 1 654 1
 919 008e 488B4DF8 		movq	-8(%rbp), %rcx
 920 0092 6448330C 		xorq	%fs:40, %rcx
 920      25280000 
 920      00
 921 009b 7405     		je	.L64
 922 009d E8000000 		call	__stack_chk_fail@PLT
 922      00
 923              	.L64:
 924 00a2 C9       		leave
 925              	.LCFI38:
 926              		.cfi_def_cfa 7, 8
 927 00a3 C3       		ret
 928              		.cfi_endproc
 929              	.LFE18:
 931              		.section	.text.mbedtls_ecp_group_copy,"ax",@progbits
 932              		.globl	mbedtls_ecp_group_copy
 934              	mbedtls_ecp_group_copy:
 935              	.LFB19:
 655:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 656:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 657:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Copy the contents of a group object
 658:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 659:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_group_copy( mbedtls_ecp_group *dst, const mbedtls_ecp_group *src )
 660:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 936              		.loc 1 660 1
 937              		.cfi_startproc
 938 0000 F30F1EFA 		endbr64
 939 0004 55       		pushq	%rbp
 940              	.LCFI39:
 941              		.cfi_def_cfa_offset 16
 942              		.cfi_offset 6, -16
 943 0005 4889E5   		movq	%rsp, %rbp
 944              	.LCFI40:
 945              		.cfi_def_cfa_register 6
 946 0008 4883EC20 		subq	$32, %rsp
 947 000c 48897DE8 		movq	%rdi, -24(%rbp)
 948 0010 488975E0 		movq	%rsi, -32(%rbp)
 949              		.loc 1 660 1
GAS LISTING /tmp/ccajKZL5.s 			page 32


 950 0014 64488B04 		movq	%fs:40, %rax
 950      25280000 
 950      00
 951 001d 488945F8 		movq	%rax, -8(%rbp)
 952 0021 31C0     		xorl	%eax, %eax
 661:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( dst != NULL );
 662:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( src != NULL );
 663:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 664:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( mbedtls_ecp_group_load( dst, src->id ) );
 953              		.loc 1 664 13
 954 0023 488B45E0 		movq	-32(%rbp), %rax
 955 0027 8B10     		movl	(%rax), %edx
 956 0029 488B45E8 		movq	-24(%rbp), %rax
 957 002d 89D6     		movl	%edx, %esi
 958 002f 4889C7   		movq	%rax, %rdi
 959 0032 E8000000 		call	mbedtls_ecp_group_load@PLT
 959      00
 665:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 960              		.loc 1 665 1
 961 0037 488B4DF8 		movq	-8(%rbp), %rcx
 962 003b 6448330C 		xorq	%fs:40, %rcx
 962      25280000 
 962      00
 963 0044 7405     		je	.L69
 964 0046 E8000000 		call	__stack_chk_fail@PLT
 964      00
 965              	.L69:
 966 004b C9       		leave
 967              	.LCFI41:
 968              		.cfi_def_cfa 7, 8
 969 004c C3       		ret
 970              		.cfi_endproc
 971              	.LFE19:
 973              		.section	.text.mbedtls_ecp_set_zero,"ax",@progbits
 974              		.globl	mbedtls_ecp_set_zero
 976              	mbedtls_ecp_set_zero:
 977              	.LFB20:
 666:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 667:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 668:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Set point to zero
 669:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 670:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_set_zero( mbedtls_ecp_point *pt )
 671:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 978              		.loc 1 671 1
 979              		.cfi_startproc
 980 0000 F30F1EFA 		endbr64
 981 0004 55       		pushq	%rbp
 982              	.LCFI42:
 983              		.cfi_def_cfa_offset 16
 984              		.cfi_offset 6, -16
 985 0005 4889E5   		movq	%rsp, %rbp
 986              	.LCFI43:
 987              		.cfi_def_cfa_register 6
 988 0008 4883EC20 		subq	$32, %rsp
 989 000c 48897DE8 		movq	%rdi, -24(%rbp)
 990              		.loc 1 671 1
 991 0010 64488B04 		movq	%fs:40, %rax
GAS LISTING /tmp/ccajKZL5.s 			page 33


 991      25280000 
 991      00
 992 0019 488945F8 		movq	%rax, -8(%rbp)
 993 001d 31C0     		xorl	%eax, %eax
 672:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
 673:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( pt != NULL );
 674:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 675:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_lset( &pt->X , 1 ) );
 994              		.loc 1 675 5
 995 001f 488B45E8 		movq	-24(%rbp), %rax
 996 0023 BE010000 		movl	$1, %esi
 996      00
 997 0028 4889C7   		movq	%rax, %rdi
 998 002b E8000000 		call	mbedtls_mpi_lset@PLT
 998      00
 999 0030 8945F4   		movl	%eax, -12(%rbp)
 1000 0033 837DF400 		cmpl	$0, -12(%rbp)
 1001 0037 753C     		jne	.L76
 676:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_lset( &pt->Y , 1 ) );
 1002              		.loc 1 676 5
 1003 0039 488B45E8 		movq	-24(%rbp), %rax
 1004 003d 4883C018 		addq	$24, %rax
 1005 0041 BE010000 		movl	$1, %esi
 1005      00
 1006 0046 4889C7   		movq	%rax, %rdi
 1007 0049 E8000000 		call	mbedtls_mpi_lset@PLT
 1007      00
 1008 004e 8945F4   		movl	%eax, -12(%rbp)
 1009 0051 837DF400 		cmpl	$0, -12(%rbp)
 1010 0055 7521     		jne	.L77
 677:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_lset( &pt->Z , 0 ) );
 1011              		.loc 1 677 5
 1012 0057 488B45E8 		movq	-24(%rbp), %rax
 1013 005b 4883C030 		addq	$48, %rax
 1014 005f BE000000 		movl	$0, %esi
 1014      00
 1015 0064 4889C7   		movq	%rax, %rdi
 1016 0067 E8000000 		call	mbedtls_mpi_lset@PLT
 1016      00
 1017 006c 8945F4   		movl	%eax, -12(%rbp)
 1018 006f 837DF400 		cmpl	$0, -12(%rbp)
 678:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 679:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
 1019              		.loc 1 679 1
 1020 0073 EB04     		jmp	.L72
 1021              	.L76:
 675:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_lset( &pt->Y , 1 ) );
 1022              		.loc 1 675 5
 1023 0075 90       		nop
 1024 0076 EB01     		jmp	.L72
 1025              	.L77:
 676:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_lset( &pt->Z , 0 ) );
 1026              		.loc 1 676 5
 1027 0078 90       		nop
 1028              	.L72:
 680:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 1029              		.loc 1 680 11
GAS LISTING /tmp/ccajKZL5.s 			page 34


 1030 0079 8B45F4   		movl	-12(%rbp), %eax
 681:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 1031              		.loc 1 681 1
 1032 007c 488B55F8 		movq	-8(%rbp), %rdx
 1033 0080 64483314 		xorq	%fs:40, %rdx
 1033      25280000 
 1033      00
 1034 0089 7405     		je	.L75
 1035 008b E8000000 		call	__stack_chk_fail@PLT
 1035      00
 1036              	.L75:
 1037 0090 C9       		leave
 1038              	.LCFI44:
 1039              		.cfi_def_cfa 7, 8
 1040 0091 C3       		ret
 1041              		.cfi_endproc
 1042              	.LFE20:
 1044              		.section	.text.mbedtls_ecp_is_zero,"ax",@progbits
 1045              		.globl	mbedtls_ecp_is_zero
 1047              	mbedtls_ecp_is_zero:
 1048              	.LFB21:
 682:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 683:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 684:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Tell if a point is zero
 685:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 686:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_is_zero( mbedtls_ecp_point *pt )
 687:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 1049              		.loc 1 687 1
 1050              		.cfi_startproc
 1051 0000 F30F1EFA 		endbr64
 1052 0004 55       		pushq	%rbp
 1053              	.LCFI45:
 1054              		.cfi_def_cfa_offset 16
 1055              		.cfi_offset 6, -16
 1056 0005 4889E5   		movq	%rsp, %rbp
 1057              	.LCFI46:
 1058              		.cfi_def_cfa_register 6
 1059 0008 4883EC20 		subq	$32, %rsp
 1060 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1061              		.loc 1 687 1
 1062 0010 64488B04 		movq	%fs:40, %rax
 1062      25280000 
 1062      00
 1063 0019 488945F8 		movq	%rax, -8(%rbp)
 1064 001d 31C0     		xorl	%eax, %eax
 688:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( pt != NULL );
 689:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 690:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( mbedtls_mpi_cmp_int( &pt->Z, 0 ) == 0 );
 1065              		.loc 1 690 34
 1066 001f 488B45E8 		movq	-24(%rbp), %rax
 1067 0023 4883C030 		addq	$48, %rax
 1068              		.loc 1 690 13
 1069 0027 BE000000 		movl	$0, %esi
 1069      00
 1070 002c 4889C7   		movq	%rax, %rdi
 1071 002f E8000000 		call	mbedtls_mpi_cmp_int@PLT
 1071      00
GAS LISTING /tmp/ccajKZL5.s 			page 35


 1072              		.loc 1 690 46
 1073 0034 85C0     		testl	%eax, %eax
 1074 0036 0F94C0   		sete	%al
 1075 0039 0FB6C0   		movzbl	%al, %eax
 691:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 1076              		.loc 1 691 1
 1077 003c 488B55F8 		movq	-8(%rbp), %rdx
 1078 0040 64483314 		xorq	%fs:40, %rdx
 1078      25280000 
 1078      00
 1079 0049 7405     		je	.L80
 1080 004b E8000000 		call	__stack_chk_fail@PLT
 1080      00
 1081              	.L80:
 1082 0050 C9       		leave
 1083              	.LCFI47:
 1084              		.cfi_def_cfa 7, 8
 1085 0051 C3       		ret
 1086              		.cfi_endproc
 1087              	.LFE21:
 1089              		.section	.text.mbedtls_ecp_point_cmp,"ax",@progbits
 1090              		.globl	mbedtls_ecp_point_cmp
 1092              	mbedtls_ecp_point_cmp:
 1093              	.LFB22:
 692:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 693:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 694:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Compare two points lazily
 695:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 696:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_point_cmp( const mbedtls_ecp_point *P,
 697:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                            const mbedtls_ecp_point *Q )
 698:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 1094              		.loc 1 698 1
 1095              		.cfi_startproc
 1096 0000 F30F1EFA 		endbr64
 1097 0004 55       		pushq	%rbp
 1098              	.LCFI48:
 1099              		.cfi_def_cfa_offset 16
 1100              		.cfi_offset 6, -16
 1101 0005 4889E5   		movq	%rsp, %rbp
 1102              	.LCFI49:
 1103              		.cfi_def_cfa_register 6
 1104 0008 4883EC20 		subq	$32, %rsp
 1105 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1106 0010 488975E0 		movq	%rsi, -32(%rbp)
 1107              		.loc 1 698 1
 1108 0014 64488B04 		movq	%fs:40, %rax
 1108      25280000 
 1108      00
 1109 001d 488945F8 		movq	%rax, -8(%rbp)
 1110 0021 31C0     		xorl	%eax, %eax
 699:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( P != NULL );
 700:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( Q != NULL );
 701:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 702:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( mbedtls_mpi_cmp_mpi( &P->X, &Q->X ) == 0 &&
 1111              		.loc 1 702 9
 1112 0023 488B55E0 		movq	-32(%rbp), %rdx
 1113 0027 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/ccajKZL5.s 			page 36


 1114 002b 4889D6   		movq	%rdx, %rsi
 1115 002e 4889C7   		movq	%rax, %rdi
 1116 0031 E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 1116      00
 1117              		.loc 1 702 7
 1118 0036 85C0     		testl	%eax, %eax
 1119 0038 7545     		jne	.L82
 703:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_cmp_mpi( &P->Y, &Q->Y ) == 0 &&
 1120              		.loc 1 703 9 discriminator 1
 1121 003a 488B45E0 		movq	-32(%rbp), %rax
 1122 003e 488D5018 		leaq	24(%rax), %rdx
 1123 0042 488B45E8 		movq	-24(%rbp), %rax
 1124 0046 4883C018 		addq	$24, %rax
 1125 004a 4889D6   		movq	%rdx, %rsi
 1126 004d 4889C7   		movq	%rax, %rdi
 1127 0050 E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 1127      00
 702:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_cmp_mpi( &P->Y, &Q->Y ) == 0 &&
 1128              		.loc 1 702 50 discriminator 1
 1129 0055 85C0     		testl	%eax, %eax
 1130 0057 7526     		jne	.L82
 704:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_cmp_mpi( &P->Z, &Q->Z ) == 0 )
 1131              		.loc 1 704 9
 1132 0059 488B45E0 		movq	-32(%rbp), %rax
 1133 005d 488D5030 		leaq	48(%rax), %rdx
 1134 0061 488B45E8 		movq	-24(%rbp), %rax
 1135 0065 4883C030 		addq	$48, %rax
 1136 0069 4889D6   		movq	%rdx, %rsi
 1137 006c 4889C7   		movq	%rax, %rdi
 1138 006f E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 1138      00
 703:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_cmp_mpi( &P->Y, &Q->Y ) == 0 &&
 1139              		.loc 1 703 50
 1140 0074 85C0     		testl	%eax, %eax
 1141 0076 7507     		jne	.L82
 705:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 706:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( 0 );
 1142              		.loc 1 706 15
 1143 0078 B8000000 		movl	$0, %eax
 1143      00
 1144 007d EB05     		jmp	.L83
 1145              	.L82:
 707:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 708:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 709:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( MBEDTLS_ERR_ECP_BAD_INPUT_DATA );
 1146              		.loc 1 709 11
 1147 007f B880B0FF 		movl	$-20352, %eax
 1147      FF
 1148              	.L83:
 710:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 1149              		.loc 1 710 1
 1150 0084 488B4DF8 		movq	-8(%rbp), %rcx
 1151 0088 6448330C 		xorq	%fs:40, %rcx
 1151      25280000 
 1151      00
 1152 0091 7405     		je	.L84
 1153 0093 E8000000 		call	__stack_chk_fail@PLT
GAS LISTING /tmp/ccajKZL5.s 			page 37


 1153      00
 1154              	.L84:
 1155 0098 C9       		leave
 1156              	.LCFI50:
 1157              		.cfi_def_cfa 7, 8
 1158 0099 C3       		ret
 1159              		.cfi_endproc
 1160              	.LFE22:
 1162              		.section	.text.mbedtls_ecp_point_read_string,"ax",@progbits
 1163              		.globl	mbedtls_ecp_point_read_string
 1165              	mbedtls_ecp_point_read_string:
 1166              	.LFB23:
 711:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 712:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 713:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Import a non-zero point from ASCII strings
 714:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 715:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_point_read_string( mbedtls_ecp_point *P, int radix,
 716:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                            const char *x, const char *y )
 717:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 1167              		.loc 1 717 1
 1168              		.cfi_startproc
 1169 0000 F30F1EFA 		endbr64
 1170 0004 55       		pushq	%rbp
 1171              	.LCFI51:
 1172              		.cfi_def_cfa_offset 16
 1173              		.cfi_offset 6, -16
 1174 0005 4889E5   		movq	%rsp, %rbp
 1175              	.LCFI52:
 1176              		.cfi_def_cfa_register 6
 1177 0008 4883EC30 		subq	$48, %rsp
 1178 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1179 0010 8975E4   		movl	%esi, -28(%rbp)
 1180 0013 488955D8 		movq	%rdx, -40(%rbp)
 1181 0017 48894DD0 		movq	%rcx, -48(%rbp)
 1182              		.loc 1 717 1
 1183 001b 64488B04 		movq	%fs:40, %rax
 1183      25280000 
 1183      00
 1184 0024 488945F8 		movq	%rax, -8(%rbp)
 1185 0028 31C0     		xorl	%eax, %eax
 718:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
 719:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( P != NULL );
 720:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( x != NULL );
 721:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( y != NULL );
 722:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 723:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_read_string( &P->X, radix, x ) );
 1186              		.loc 1 723 5
 1187 002a 488B45E8 		movq	-24(%rbp), %rax
 1188 002e 488B55D8 		movq	-40(%rbp), %rdx
 1189 0032 8B4DE4   		movl	-28(%rbp), %ecx
 1190 0035 89CE     		movl	%ecx, %esi
 1191 0037 4889C7   		movq	%rax, %rdi
 1192 003a E8000000 		call	mbedtls_mpi_read_string@PLT
 1192      00
 1193 003f 8945F4   		movl	%eax, -12(%rbp)
 1194 0042 837DF400 		cmpl	$0, -12(%rbp)
 1195 0046 7540     		jne	.L91
GAS LISTING /tmp/ccajKZL5.s 			page 38


 724:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_read_string( &P->Y, radix, y ) );
 1196              		.loc 1 724 5
 1197 0048 488B45E8 		movq	-24(%rbp), %rax
 1198 004c 488D4818 		leaq	24(%rax), %rcx
 1199 0050 488B55D0 		movq	-48(%rbp), %rdx
 1200 0054 8B45E4   		movl	-28(%rbp), %eax
 1201 0057 89C6     		movl	%eax, %esi
 1202 0059 4889CF   		movq	%rcx, %rdi
 1203 005c E8000000 		call	mbedtls_mpi_read_string@PLT
 1203      00
 1204 0061 8945F4   		movl	%eax, -12(%rbp)
 1205 0064 837DF400 		cmpl	$0, -12(%rbp)
 1206 0068 7521     		jne	.L92
 725:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_lset( &P->Z, 1 ) );
 1207              		.loc 1 725 5
 1208 006a 488B45E8 		movq	-24(%rbp), %rax
 1209 006e 4883C030 		addq	$48, %rax
 1210 0072 BE010000 		movl	$1, %esi
 1210      00
 1211 0077 4889C7   		movq	%rax, %rdi
 1212 007a E8000000 		call	mbedtls_mpi_lset@PLT
 1212      00
 1213 007f 8945F4   		movl	%eax, -12(%rbp)
 1214 0082 837DF400 		cmpl	$0, -12(%rbp)
 726:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 727:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
 1215              		.loc 1 727 1
 1216 0086 EB04     		jmp	.L87
 1217              	.L91:
 723:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_read_string( &P->Y, radix, y ) );
 1218              		.loc 1 723 5
 1219 0088 90       		nop
 1220 0089 EB01     		jmp	.L87
 1221              	.L92:
 724:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_lset( &P->Z, 1 ) );
 1222              		.loc 1 724 5
 1223 008b 90       		nop
 1224              	.L87:
 728:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 1225              		.loc 1 728 11
 1226 008c 8B45F4   		movl	-12(%rbp), %eax
 729:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 1227              		.loc 1 729 1
 1228 008f 488B75F8 		movq	-8(%rbp), %rsi
 1229 0093 64483334 		xorq	%fs:40, %rsi
 1229      25280000 
 1229      00
 1230 009c 7405     		je	.L90
 1231 009e E8000000 		call	__stack_chk_fail@PLT
 1231      00
 1232              	.L90:
 1233 00a3 C9       		leave
 1234              	.LCFI53:
 1235              		.cfi_def_cfa 7, 8
 1236 00a4 C3       		ret
 1237              		.cfi_endproc
 1238              	.LFE23:
GAS LISTING /tmp/ccajKZL5.s 			page 39


 1240              		.section	.text.mbedtls_ecp_point_write_binary,"ax",@progbits
 1241              		.globl	mbedtls_ecp_point_write_binary
 1243              	mbedtls_ecp_point_write_binary:
 1244              	.LFB24:
 730:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 731:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 732:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Export a point into unsigned binary data (SEC1 2.3.3)
 733:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 734:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_point_write_binary( const mbedtls_ecp_group *grp,
 735:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                     const mbedtls_ecp_point *P,
 736:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                     int format, size_t *olen,
 737:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                     unsigned char *buf, size_t buflen )
 738:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 1245              		.loc 1 738 1
 1246              		.cfi_startproc
 1247 0000 F30F1EFA 		endbr64
 1248 0004 55       		pushq	%rbp
 1249              	.LCFI54:
 1250              		.cfi_def_cfa_offset 16
 1251              		.cfi_offset 6, -16
 1252 0005 4889E5   		movq	%rsp, %rbp
 1253              	.LCFI55:
 1254              		.cfi_def_cfa_register 6
 1255 0008 4883EC50 		subq	$80, %rsp
 1256 000c 48897DD8 		movq	%rdi, -40(%rbp)
 1257 0010 488975D0 		movq	%rsi, -48(%rbp)
 1258 0014 8955CC   		movl	%edx, -52(%rbp)
 1259 0017 48894DC0 		movq	%rcx, -64(%rbp)
 1260 001b 4C8945B8 		movq	%r8, -72(%rbp)
 1261 001f 4C894DB0 		movq	%r9, -80(%rbp)
 1262              		.loc 1 738 1
 1263 0023 64488B04 		movq	%fs:40, %rax
 1263      25280000 
 1263      00
 1264 002c 488945F8 		movq	%rax, -8(%rbp)
 1265 0030 31C0     		xorl	%eax, %eax
 739:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret = 0;
 1266              		.loc 1 739 9
 1267 0032 C745EC00 		movl	$0, -20(%rbp)
 1267      000000
 740:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     size_t plen;
 741:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( grp  != NULL );
 742:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( P    != NULL );
 743:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( olen != NULL );
 744:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( buf  != NULL );
 745:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( format == MBEDTLS_ECP_PF_UNCOMPRESSED ||
 746:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                       format == MBEDTLS_ECP_PF_COMPRESSED );
 747:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 748:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
 749:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * Common case: P == 0
 750:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
 751:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( mbedtls_mpi_cmp_int( &P->Z, 0 ) == 0 )
 1268              		.loc 1 751 9
 1269 0039 488B45D0 		movq	-48(%rbp), %rax
 1270 003d 4883C030 		addq	$48, %rax
 1271 0041 BE000000 		movl	$0, %esi
 1271      00
GAS LISTING /tmp/ccajKZL5.s 			page 40


 1272 0046 4889C7   		movq	%rax, %rdi
 1273 0049 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 1273      00
 1274              		.loc 1 751 7
 1275 004e 85C0     		testl	%eax, %eax
 1276 0050 752D     		jne	.L94
 752:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 753:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( buflen < 1 )
 1277              		.loc 1 753 11
 1278 0052 48837DB0 		cmpq	$0, -80(%rbp)
 1278      00
 1279 0057 750A     		jne	.L95
 754:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             return( MBEDTLS_ERR_ECP_BUFFER_TOO_SMALL );
 1280              		.loc 1 754 19
 1281 0059 B800B1FF 		movl	$-20224, %eax
 1281      FF
 1282 005e E9340100 		jmp	.L96
 1282      00
 1283              	.L95:
 755:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 756:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         buf[0] = 0x00;
 1284              		.loc 1 756 16
 1285 0063 488B45B8 		movq	-72(%rbp), %rax
 1286 0067 C60000   		movb	$0, (%rax)
 757:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         *olen = 1;
 1287              		.loc 1 757 15
 1288 006a 488B45C0 		movq	-64(%rbp), %rax
 1289 006e 48C70001 		movq	$1, (%rax)
 1289      000000
 758:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 759:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( 0 );
 1290              		.loc 1 759 15
 1291 0075 B8000000 		movl	$0, %eax
 1291      00
 1292 007a E9180100 		jmp	.L96
 1292      00
 1293              	.L94:
 760:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 761:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 762:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     plen = mbedtls_mpi_size( &grp->P );
 1294              		.loc 1 762 12
 1295 007f 488B45D8 		movq	-40(%rbp), %rax
 1296 0083 4883C008 		addq	$8, %rax
 1297 0087 4889C7   		movq	%rax, %rdi
 1298 008a E8000000 		call	mbedtls_mpi_size@PLT
 1298      00
 1299 008f 488945F0 		movq	%rax, -16(%rbp)
 763:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 764:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( format == MBEDTLS_ECP_PF_UNCOMPRESSED )
 1300              		.loc 1 764 7
 1301 0093 837DCC00 		cmpl	$0, -52(%rbp)
 1302 0097 0F858800 		jne	.L97
 1302      0000
 765:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 766:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         *olen = 2 * plen + 1;
 1303              		.loc 1 766 19
 1304 009d 488B45F0 		movq	-16(%rbp), %rax
GAS LISTING /tmp/ccajKZL5.s 			page 41


 1305 00a1 4801C0   		addq	%rax, %rax
 1306              		.loc 1 766 26
 1307 00a4 488D5001 		leaq	1(%rax), %rdx
 1308              		.loc 1 766 15
 1309 00a8 488B45C0 		movq	-64(%rbp), %rax
 1310 00ac 488910   		movq	%rdx, (%rax)
 767:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 768:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( buflen < *olen )
 1311              		.loc 1 768 22
 1312 00af 488B45C0 		movq	-64(%rbp), %rax
 1313 00b3 488B00   		movq	(%rax), %rax
 1314              		.loc 1 768 11
 1315 00b6 483945B0 		cmpq	%rax, -80(%rbp)
 1316 00ba 730A     		jnb	.L98
 769:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             return( MBEDTLS_ERR_ECP_BUFFER_TOO_SMALL );
 1317              		.loc 1 769 19
 1318 00bc B800B1FF 		movl	$-20224, %eax
 1318      FF
 1319 00c1 E9D10000 		jmp	.L96
 1319      00
 1320              	.L98:
 770:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 771:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         buf[0] = 0x04;
 1321              		.loc 1 771 16
 1322 00c6 488B45B8 		movq	-72(%rbp), %rax
 1323 00ca C60004   		movb	$4, (%rax)
 772:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_write_binary( &P->X, buf + 1, plen ) );
 1324              		.loc 1 772 9
 1325 00cd 488B45B8 		movq	-72(%rbp), %rax
 1326 00d1 488D4801 		leaq	1(%rax), %rcx
 1327 00d5 488B45D0 		movq	-48(%rbp), %rax
 1328 00d9 488B55F0 		movq	-16(%rbp), %rdx
 1329 00dd 4889CE   		movq	%rcx, %rsi
 1330 00e0 4889C7   		movq	%rax, %rdi
 1331 00e3 E8000000 		call	mbedtls_mpi_write_binary@PLT
 1331      00
 1332 00e8 8945EC   		movl	%eax, -20(%rbp)
 1333 00eb 837DEC00 		cmpl	$0, -20(%rbp)
 1334 00ef 0F859B00 		jne	.L103
 1334      0000
 773:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_write_binary( &P->Y, buf + 1 + plen, plen ) );
 1335              		.loc 1 773 9
 1336 00f5 488B45F0 		movq	-16(%rbp), %rax
 1337 00f9 488D5001 		leaq	1(%rax), %rdx
 1338 00fd 488B45B8 		movq	-72(%rbp), %rax
 1339 0101 488D3402 		leaq	(%rdx,%rax), %rsi
 1340 0105 488B45D0 		movq	-48(%rbp), %rax
 1341 0109 488D4818 		leaq	24(%rax), %rcx
 1342 010d 488B45F0 		movq	-16(%rbp), %rax
 1343 0111 4889C2   		movq	%rax, %rdx
 1344 0114 4889CF   		movq	%rcx, %rdi
 1345 0117 E8000000 		call	mbedtls_mpi_write_binary@PLT
 1345      00
 1346 011c 8945EC   		movl	%eax, -20(%rbp)
 1347 011f 837DEC00 		cmpl	$0, -20(%rbp)
 1348 0123 EB6F     		jmp	.L100
 1349              	.L97:
GAS LISTING /tmp/ccajKZL5.s 			page 42


 774:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 775:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     else if( format == MBEDTLS_ECP_PF_COMPRESSED )
 1350              		.loc 1 775 12
 1351 0125 837DCC01 		cmpl	$1, -52(%rbp)
 1352 0129 7568     		jne	.L104
 776:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 777:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         *olen = plen + 1;
 1353              		.loc 1 777 22
 1354 012b 488B45F0 		movq	-16(%rbp), %rax
 1355 012f 488D5001 		leaq	1(%rax), %rdx
 1356              		.loc 1 777 15
 1357 0133 488B45C0 		movq	-64(%rbp), %rax
 1358 0137 488910   		movq	%rdx, (%rax)
 778:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 779:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( buflen < *olen )
 1359              		.loc 1 779 22
 1360 013a 488B45C0 		movq	-64(%rbp), %rax
 1361 013e 488B00   		movq	(%rax), %rax
 1362              		.loc 1 779 11
 1363 0141 483945B0 		cmpq	%rax, -80(%rbp)
 1364 0145 7307     		jnb	.L101
 780:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             return( MBEDTLS_ERR_ECP_BUFFER_TOO_SMALL );
 1365              		.loc 1 780 19
 1366 0147 B800B1FF 		movl	$-20224, %eax
 1366      FF
 1367 014c EB49     		jmp	.L96
 1368              	.L101:
 781:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 782:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         buf[0] = 0x02 + mbedtls_mpi_get_bit( &P->Y, 0 );
 1369              		.loc 1 782 25
 1370 014e 488B45D0 		movq	-48(%rbp), %rax
 1371 0152 4883C018 		addq	$24, %rax
 1372 0156 BE000000 		movl	$0, %esi
 1372      00
 1373 015b 4889C7   		movq	%rax, %rdi
 1374 015e E8000000 		call	mbedtls_mpi_get_bit@PLT
 1374      00
 1375              		.loc 1 782 23
 1376 0163 8D5002   		leal	2(%rax), %edx
 1377              		.loc 1 782 16
 1378 0166 488B45B8 		movq	-72(%rbp), %rax
 1379 016a 8810     		movb	%dl, (%rax)
 783:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_write_binary( &P->X, buf + 1, plen ) );
 1380              		.loc 1 783 9
 1381 016c 488B45B8 		movq	-72(%rbp), %rax
 1382 0170 488D4801 		leaq	1(%rax), %rcx
 1383 0174 488B45D0 		movq	-48(%rbp), %rax
 1384 0178 488B55F0 		movq	-16(%rbp), %rdx
 1385 017c 4889CE   		movq	%rcx, %rsi
 1386 017f 4889C7   		movq	%rax, %rdi
 1387 0182 E8000000 		call	mbedtls_mpi_write_binary@PLT
 1387      00
 1388 0187 8945EC   		movl	%eax, -20(%rbp)
 1389 018a 837DEC00 		cmpl	$0, -20(%rbp)
 784:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 785:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 786:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
GAS LISTING /tmp/ccajKZL5.s 			page 43


 1390              		.loc 1 786 1
 1391 018e EB03     		jmp	.L104
 1392              	.L103:
 772:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_write_binary( &P->Y, buf + 1 + plen, plen ) );
 1393              		.loc 1 772 9
 1394 0190 90       		nop
 1395 0191 EB01     		jmp	.L100
 1396              	.L104:
 1397              		.loc 1 786 1
 1398 0193 90       		nop
 1399              	.L100:
 787:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 1400              		.loc 1 787 11
 1401 0194 8B45EC   		movl	-20(%rbp), %eax
 1402              	.L96:
 788:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 1403              		.loc 1 788 1
 1404 0197 488B4DF8 		movq	-8(%rbp), %rcx
 1405 019b 6448330C 		xorq	%fs:40, %rcx
 1405      25280000 
 1405      00
 1406 01a4 7405     		je	.L102
 1407 01a6 E8000000 		call	__stack_chk_fail@PLT
 1407      00
 1408              	.L102:
 1409 01ab C9       		leave
 1410              	.LCFI56:
 1411              		.cfi_def_cfa 7, 8
 1412 01ac C3       		ret
 1413              		.cfi_endproc
 1414              	.LFE24:
 1416              		.section	.text.mbedtls_ecp_point_read_binary,"ax",@progbits
 1417              		.globl	mbedtls_ecp_point_read_binary
 1419              	mbedtls_ecp_point_read_binary:
 1420              	.LFB25:
 789:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 790:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 791:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Import a point from unsigned binary data (SEC1 2.3.4)
 792:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 793:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_point_read_binary( const mbedtls_ecp_group *grp,
 794:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                    mbedtls_ecp_point *pt,
 795:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                    const unsigned char *buf, size_t ilen )
 796:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 1421              		.loc 1 796 1
 1422              		.cfi_startproc
 1423 0000 F30F1EFA 		endbr64
 1424 0004 55       		pushq	%rbp
 1425              	.LCFI57:
 1426              		.cfi_def_cfa_offset 16
 1427              		.cfi_offset 6, -16
 1428 0005 4889E5   		movq	%rsp, %rbp
 1429              	.LCFI58:
 1430              		.cfi_def_cfa_register 6
 1431 0008 4883EC40 		subq	$64, %rsp
 1432 000c 48897DD8 		movq	%rdi, -40(%rbp)
 1433 0010 488975D0 		movq	%rsi, -48(%rbp)
 1434 0014 488955C8 		movq	%rdx, -56(%rbp)
GAS LISTING /tmp/ccajKZL5.s 			page 44


 1435 0018 48894DC0 		movq	%rcx, -64(%rbp)
 1436              		.loc 1 796 1
 1437 001c 64488B04 		movq	%fs:40, %rax
 1437      25280000 
 1437      00
 1438 0025 488945F8 		movq	%rax, -8(%rbp)
 1439 0029 31C0     		xorl	%eax, %eax
 797:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
 798:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     size_t plen;
 799:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( grp != NULL );
 800:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( pt  != NULL );
 801:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( buf != NULL );
 802:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 803:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ilen < 1 )
 1440              		.loc 1 803 7
 1441 002b 48837DC0 		cmpq	$0, -64(%rbp)
 1441      00
 1442 0030 750A     		jne	.L106
 804:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( MBEDTLS_ERR_ECP_BAD_INPUT_DATA );
 1443              		.loc 1 804 15
 1444 0032 B880B0FF 		movl	$-20352, %eax
 1444      FF
 1445 0037 E9E70000 		jmp	.L107
 1445      00
 1446              	.L106:
 805:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 806:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( buf[0] == 0x00 )
 1447              		.loc 1 806 12
 1448 003c 488B45C8 		movq	-56(%rbp), %rax
 1449 0040 0FB600   		movzbl	(%rax), %eax
 1450              		.loc 1 806 7
 1451 0043 84C0     		testb	%al, %al
 1452 0045 7522     		jne	.L108
 807:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 808:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( ilen == 1 )
 1453              		.loc 1 808 11
 1454 0047 48837DC0 		cmpq	$1, -64(%rbp)
 1454      01
 1455 004c 7511     		jne	.L109
 809:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             return( mbedtls_ecp_set_zero( pt ) );
 1456              		.loc 1 809 21
 1457 004e 488B45D0 		movq	-48(%rbp), %rax
 1458 0052 4889C7   		movq	%rax, %rdi
 1459 0055 E8000000 		call	mbedtls_ecp_set_zero
 1459      00
 1460 005a E9C40000 		jmp	.L107
 1460      00
 1461              	.L109:
 810:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         else
 811:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             return( MBEDTLS_ERR_ECP_BAD_INPUT_DATA );
 1462              		.loc 1 811 19
 1463 005f B880B0FF 		movl	$-20352, %eax
 1463      FF
 1464 0064 E9BA0000 		jmp	.L107
 1464      00
 1465              	.L108:
 812:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
GAS LISTING /tmp/ccajKZL5.s 			page 45


 813:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 814:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     plen = mbedtls_mpi_size( &grp->P );
 1466              		.loc 1 814 12
 1467 0069 488B45D8 		movq	-40(%rbp), %rax
 1468 006d 4883C008 		addq	$8, %rax
 1469 0071 4889C7   		movq	%rax, %rdi
 1470 0074 E8000000 		call	mbedtls_mpi_size@PLT
 1470      00
 1471 0079 488945F0 		movq	%rax, -16(%rbp)
 815:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 816:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( buf[0] != 0x04 )
 1472              		.loc 1 816 12
 1473 007d 488B45C8 		movq	-56(%rbp), %rax
 1474 0081 0FB600   		movzbl	(%rax), %eax
 1475              		.loc 1 816 7
 1476 0084 3C04     		cmpb	$4, %al
 1477 0086 740A     		je	.L110
 817:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( MBEDTLS_ERR_ECP_FEATURE_UNAVAILABLE );
 1478              		.loc 1 817 15
 1479 0088 B880B1FF 		movl	$-20096, %eax
 1479      FF
 1480 008d E9910000 		jmp	.L107
 1480      00
 1481              	.L110:
 818:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 819:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ilen != 2 * plen + 1 )
 1482              		.loc 1 819 19
 1483 0092 488B45F0 		movq	-16(%rbp), %rax
 1484 0096 4801C0   		addq	%rax, %rax
 1485              		.loc 1 819 26
 1486 0099 4883C001 		addq	$1, %rax
 1487              		.loc 1 819 7
 1488 009d 483945C0 		cmpq	%rax, -64(%rbp)
 1489 00a1 7407     		je	.L111
 820:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( MBEDTLS_ERR_ECP_BAD_INPUT_DATA );
 1490              		.loc 1 820 15
 1491 00a3 B880B0FF 		movl	$-20352, %eax
 1491      FF
 1492 00a8 EB79     		jmp	.L107
 1493              	.L111:
 821:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 822:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_read_binary( &pt->X, buf + 1, plen ) );
 1494              		.loc 1 822 5
 1495 00aa 488B45C8 		movq	-56(%rbp), %rax
 1496 00ae 488D4801 		leaq	1(%rax), %rcx
 1497 00b2 488B45D0 		movq	-48(%rbp), %rax
 1498 00b6 488B55F0 		movq	-16(%rbp), %rdx
 1499 00ba 4889CE   		movq	%rcx, %rsi
 1500 00bd 4889C7   		movq	%rax, %rdi
 1501 00c0 E8000000 		call	mbedtls_mpi_read_binary@PLT
 1501      00
 1502 00c5 8945EC   		movl	%eax, -20(%rbp)
 1503 00c8 837DEC00 		cmpl	$0, -20(%rbp)
 1504 00cc 754E     		jne	.L116
 823:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_read_binary( &pt->Y, buf + 1 + plen, plen ) );
 1505              		.loc 1 823 5
 1506 00ce 488B45F0 		movq	-16(%rbp), %rax
GAS LISTING /tmp/ccajKZL5.s 			page 46


 1507 00d2 488D5001 		leaq	1(%rax), %rdx
 1508 00d6 488B45C8 		movq	-56(%rbp), %rax
 1509 00da 488D3402 		leaq	(%rdx,%rax), %rsi
 1510 00de 488B45D0 		movq	-48(%rbp), %rax
 1511 00e2 488D4818 		leaq	24(%rax), %rcx
 1512 00e6 488B45F0 		movq	-16(%rbp), %rax
 1513 00ea 4889C2   		movq	%rax, %rdx
 1514 00ed 4889CF   		movq	%rcx, %rdi
 1515 00f0 E8000000 		call	mbedtls_mpi_read_binary@PLT
 1515      00
 1516 00f5 8945EC   		movl	%eax, -20(%rbp)
 1517 00f8 837DEC00 		cmpl	$0, -20(%rbp)
 1518 00fc 7521     		jne	.L117
 824:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_lset( &pt->Z, 1 ) );
 1519              		.loc 1 824 5
 1520 00fe 488B45D0 		movq	-48(%rbp), %rax
 1521 0102 4883C030 		addq	$48, %rax
 1522 0106 BE010000 		movl	$1, %esi
 1522      00
 1523 010b 4889C7   		movq	%rax, %rdi
 1524 010e E8000000 		call	mbedtls_mpi_lset@PLT
 1524      00
 1525 0113 8945EC   		movl	%eax, -20(%rbp)
 1526 0116 837DEC00 		cmpl	$0, -20(%rbp)
 825:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 826:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
 1527              		.loc 1 826 1
 1528 011a EB04     		jmp	.L113
 1529              	.L116:
 822:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_read_binary( &pt->Y, buf + 1 + plen, plen ) );
 1530              		.loc 1 822 5
 1531 011c 90       		nop
 1532 011d EB01     		jmp	.L113
 1533              	.L117:
 823:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_lset( &pt->Z, 1 ) );
 1534              		.loc 1 823 5
 1535 011f 90       		nop
 1536              	.L113:
 827:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 1537              		.loc 1 827 11
 1538 0120 8B45EC   		movl	-20(%rbp), %eax
 1539              	.L107:
 828:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 1540              		.loc 1 828 1
 1541 0123 488B4DF8 		movq	-8(%rbp), %rcx
 1542 0127 6448330C 		xorq	%fs:40, %rcx
 1542      25280000 
 1542      00
 1543 0130 7405     		je	.L115
 1544 0132 E8000000 		call	__stack_chk_fail@PLT
 1544      00
 1545              	.L115:
 1546 0137 C9       		leave
 1547              	.LCFI59:
 1548              		.cfi_def_cfa 7, 8
 1549 0138 C3       		ret
 1550              		.cfi_endproc
GAS LISTING /tmp/ccajKZL5.s 			page 47


 1551              	.LFE25:
 1553              		.section	.text.mbedtls_ecp_tls_read_point,"ax",@progbits
 1554              		.globl	mbedtls_ecp_tls_read_point
 1556              	mbedtls_ecp_tls_read_point:
 1557              	.LFB26:
 829:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 830:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 831:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Import a point from a TLS ECPoint record (RFC 4492)
 832:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *      struct {
 833:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *          opaque point <1..2^8-1>;
 834:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *      } ECPoint;
 835:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 836:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_tls_read_point( const mbedtls_ecp_group *grp,
 837:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                 mbedtls_ecp_point *pt,
 838:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                 const unsigned char **buf, size_t buf_len )
 839:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 1558              		.loc 1 839 1
 1559              		.cfi_startproc
 1560 0000 F30F1EFA 		endbr64
 1561 0004 55       		pushq	%rbp
 1562              	.LCFI60:
 1563              		.cfi_def_cfa_offset 16
 1564              		.cfi_offset 6, -16
 1565 0005 4889E5   		movq	%rsp, %rbp
 1566              	.LCFI61:
 1567              		.cfi_def_cfa_register 6
 1568 0008 4883EC40 		subq	$64, %rsp
 1569 000c 48897DD8 		movq	%rdi, -40(%rbp)
 1570 0010 488975D0 		movq	%rsi, -48(%rbp)
 1571 0014 488955C8 		movq	%rdx, -56(%rbp)
 1572 0018 48894DC0 		movq	%rcx, -64(%rbp)
 1573              		.loc 1 839 1
 1574 001c 64488B04 		movq	%fs:40, %rax
 1574      25280000 
 1574      00
 1575 0025 488945F8 		movq	%rax, -8(%rbp)
 1576 0029 31C0     		xorl	%eax, %eax
 840:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     unsigned char data_len;
 841:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     const unsigned char *buf_start;
 842:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( grp != NULL );
 843:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( pt  != NULL );
 844:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( buf != NULL );
 845:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( *buf != NULL );
 846:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 847:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
 848:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * We must have at least two bytes (1 for length, at least one for data)
 849:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
 850:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( buf_len < 2 )
 1577              		.loc 1 850 7
 1578 002b 48837DC0 		cmpq	$1, -64(%rbp)
 1578      01
 1579 0030 7707     		ja	.L119
 851:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( MBEDTLS_ERR_ECP_BAD_INPUT_DATA );
 1580              		.loc 1 851 15
 1581 0032 B880B0FF 		movl	$-20352, %eax
 1581      FF
 1582 0037 EB6E     		jmp	.L120
GAS LISTING /tmp/ccajKZL5.s 			page 48


 1583              	.L119:
 852:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 853:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     data_len = *(*buf)++;
 1584              		.loc 1 853 18
 1585 0039 488B45C8 		movq	-56(%rbp), %rax
 1586 003d 488B00   		movq	(%rax), %rax
 1587              		.loc 1 853 23
 1588 0040 488D4801 		leaq	1(%rax), %rcx
 1589 0044 488B55C8 		movq	-56(%rbp), %rdx
 1590 0048 48890A   		movq	%rcx, (%rdx)
 1591              		.loc 1 853 14
 1592 004b 0FB600   		movzbl	(%rax), %eax
 1593 004e 8845EF   		movb	%al, -17(%rbp)
 854:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( data_len < 1 || data_len > buf_len - 1 )
 1594              		.loc 1 854 7
 1595 0051 807DEF00 		cmpb	$0, -17(%rbp)
 1596 0055 7411     		je	.L121
 1597              		.loc 1 854 34 discriminator 1
 1598 0057 0FB645EF 		movzbl	-17(%rbp), %eax
 1599              		.loc 1 854 44 discriminator 1
 1600 005b 488B55C0 		movq	-64(%rbp), %rdx
 1601 005f 4883EA01 		subq	$1, %rdx
 1602              		.loc 1 854 22 discriminator 1
 1603 0063 4839D0   		cmpq	%rdx, %rax
 1604 0066 7607     		jbe	.L122
 1605              	.L121:
 855:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( MBEDTLS_ERR_ECP_BAD_INPUT_DATA );
 1606              		.loc 1 855 15
 1607 0068 B880B0FF 		movl	$-20352, %eax
 1607      FF
 1608 006d EB38     		jmp	.L120
 1609              	.L122:
 856:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 857:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
 858:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * Save buffer start for read_binary and update buf
 859:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
 860:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     buf_start = *buf;
 1610              		.loc 1 860 15
 1611 006f 488B45C8 		movq	-56(%rbp), %rax
 1612 0073 488B00   		movq	(%rax), %rax
 1613 0076 488945F0 		movq	%rax, -16(%rbp)
 861:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     *buf += data_len;
 1614              		.loc 1 861 10
 1615 007a 488B45C8 		movq	-56(%rbp), %rax
 1616 007e 488B10   		movq	(%rax), %rdx
 1617 0081 0FB645EF 		movzbl	-17(%rbp), %eax
 1618 0085 4801C2   		addq	%rax, %rdx
 1619 0088 488B45C8 		movq	-56(%rbp), %rax
 1620 008c 488910   		movq	%rdx, (%rax)
 862:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 863:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( mbedtls_ecp_point_read_binary( grp, pt, buf_start, data_len ) );
 1621              		.loc 1 863 13
 1622 008f 0FB64DEF 		movzbl	-17(%rbp), %ecx
 1623 0093 488B55F0 		movq	-16(%rbp), %rdx
 1624 0097 488B75D0 		movq	-48(%rbp), %rsi
 1625 009b 488B45D8 		movq	-40(%rbp), %rax
 1626 009f 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/ccajKZL5.s 			page 49


 1627 00a2 E8000000 		call	mbedtls_ecp_point_read_binary
 1627      00
 1628              	.L120:
 864:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 1629              		.loc 1 864 1
 1630 00a7 488B7DF8 		movq	-8(%rbp), %rdi
 1631 00ab 6448333C 		xorq	%fs:40, %rdi
 1631      25280000 
 1631      00
 1632 00b4 7405     		je	.L123
 1633 00b6 E8000000 		call	__stack_chk_fail@PLT
 1633      00
 1634              	.L123:
 1635 00bb C9       		leave
 1636              	.LCFI62:
 1637              		.cfi_def_cfa 7, 8
 1638 00bc C3       		ret
 1639              		.cfi_endproc
 1640              	.LFE26:
 1642              		.section	.text.mbedtls_ecp_tls_write_point,"ax",@progbits
 1643              		.globl	mbedtls_ecp_tls_write_point
 1645              	mbedtls_ecp_tls_write_point:
 1646              	.LFB27:
 865:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 866:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 867:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Export a point as a TLS ECPoint record (RFC 4492)
 868:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *      struct {
 869:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *          opaque point <1..2^8-1>;
 870:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *      } ECPoint;
 871:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 872:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_tls_write_point( const mbedtls_ecp_group *grp, const mbedtls_ecp_point *pt,
 873:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                          int format, size_t *olen,
 874:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                          unsigned char *buf, size_t blen )
 875:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 1647              		.loc 1 875 1
 1648              		.cfi_startproc
 1649 0000 F30F1EFA 		endbr64
 1650 0004 55       		pushq	%rbp
 1651              	.LCFI63:
 1652              		.cfi_def_cfa_offset 16
 1653              		.cfi_offset 6, -16
 1654 0005 4889E5   		movq	%rsp, %rbp
 1655              	.LCFI64:
 1656              		.cfi_def_cfa_register 6
 1657 0008 4883EC40 		subq	$64, %rsp
 1658 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1659 0010 488975E0 		movq	%rsi, -32(%rbp)
 1660 0014 8955DC   		movl	%edx, -36(%rbp)
 1661 0017 48894DD0 		movq	%rcx, -48(%rbp)
 1662 001b 4C8945C8 		movq	%r8, -56(%rbp)
 1663 001f 4C894DC0 		movq	%r9, -64(%rbp)
 1664              		.loc 1 875 1
 1665 0023 64488B04 		movq	%fs:40, %rax
 1665      25280000 
 1665      00
 1666 002c 488945F8 		movq	%rax, -8(%rbp)
 1667 0030 31C0     		xorl	%eax, %eax
GAS LISTING /tmp/ccajKZL5.s 			page 50


 876:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
 877:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( grp  != NULL );
 878:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( pt   != NULL );
 879:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( olen != NULL );
 880:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( buf  != NULL );
 881:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( format == MBEDTLS_ECP_PF_UNCOMPRESSED ||
 882:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                       format == MBEDTLS_ECP_PF_COMPRESSED );
 883:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 884:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
 885:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * buffer length must be at least one, for our length byte
 886:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
 887:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( blen < 1 )
 1668              		.loc 1 887 7
 1669 0032 48837DC0 		cmpq	$0, -64(%rbp)
 1669      00
 1670 0037 7507     		jne	.L125
 888:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( MBEDTLS_ERR_ECP_BAD_INPUT_DATA );
 1671              		.loc 1 888 15
 1672 0039 B880B0FF 		movl	$-20352, %eax
 1672      FF
 1673 003e EB61     		jmp	.L126
 1674              	.L125:
 889:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 890:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ( ret = mbedtls_ecp_point_write_binary( grp, pt, format,
 1675              		.loc 1 890 17
 1676 0040 488B45C0 		movq	-64(%rbp), %rax
 1677 0044 4C8D40FF 		leaq	-1(%rax), %r8
 1678 0048 488B45C8 		movq	-56(%rbp), %rax
 1679 004c 488D7801 		leaq	1(%rax), %rdi
 1680 0050 488B4DD0 		movq	-48(%rbp), %rcx
 1681 0054 8B55DC   		movl	-36(%rbp), %edx
 1682 0057 488B75E0 		movq	-32(%rbp), %rsi
 1683 005b 488B45E8 		movq	-24(%rbp), %rax
 1684 005f 4D89C1   		movq	%r8, %r9
 1685 0062 4989F8   		movq	%rdi, %r8
 1686 0065 4889C7   		movq	%rax, %rdi
 1687 0068 E8000000 		call	mbedtls_ecp_point_write_binary
 1687      00
 1688 006d 8945F4   		movl	%eax, -12(%rbp)
 1689              		.loc 1 890 7
 1690 0070 837DF400 		cmpl	$0, -12(%rbp)
 1691 0074 7405     		je	.L127
 891:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                     olen, buf + 1, blen - 1) ) != 0 )
 892:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( ret );
 1692              		.loc 1 892 15
 1693 0076 8B45F4   		movl	-12(%rbp), %eax
 1694 0079 EB26     		jmp	.L126
 1695              	.L127:
 893:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 894:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
 895:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * write length to the first byte and update total length
 896:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
 897:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     buf[0] = (unsigned char) *olen;
 1696              		.loc 1 897 30
 1697 007b 488B45D0 		movq	-48(%rbp), %rax
 1698 007f 488B00   		movq	(%rax), %rax
 1699              		.loc 1 897 14
GAS LISTING /tmp/ccajKZL5.s 			page 51


 1700 0082 89C2     		movl	%eax, %edx
 1701              		.loc 1 897 12
 1702 0084 488B45C8 		movq	-56(%rbp), %rax
 1703 0088 8810     		movb	%dl, (%rax)
 898:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ++*olen;
 1704              		.loc 1 898 7
 1705 008a 488B45D0 		movq	-48(%rbp), %rax
 1706 008e 488B00   		movq	(%rax), %rax
 1707              		.loc 1 898 5
 1708 0091 488D5001 		leaq	1(%rax), %rdx
 1709 0095 488B45D0 		movq	-48(%rbp), %rax
 1710 0099 488910   		movq	%rdx, (%rax)
 899:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 900:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( 0 );
 1711              		.loc 1 900 11
 1712 009c B8000000 		movl	$0, %eax
 1712      00
 1713              	.L126:
 901:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 1714              		.loc 1 901 1
 1715 00a1 488B4DF8 		movq	-8(%rbp), %rcx
 1716 00a5 6448330C 		xorq	%fs:40, %rcx
 1716      25280000 
 1716      00
 1717 00ae 7405     		je	.L128
 1718 00b0 E8000000 		call	__stack_chk_fail@PLT
 1718      00
 1719              	.L128:
 1720 00b5 C9       		leave
 1721              	.LCFI65:
 1722              		.cfi_def_cfa 7, 8
 1723 00b6 C3       		ret
 1724              		.cfi_endproc
 1725              	.LFE27:
 1727              		.section	.text.mbedtls_ecp_tls_read_group,"ax",@progbits
 1728              		.globl	mbedtls_ecp_tls_read_group
 1730              	mbedtls_ecp_tls_read_group:
 1731              	.LFB28:
 902:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 903:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 904:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Set a group from an ECParameters record (RFC 4492)
 905:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 906:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_tls_read_group( mbedtls_ecp_group *grp,
 907:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                 const unsigned char **buf, size_t len )
 908:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 1732              		.loc 1 908 1
 1733              		.cfi_startproc
 1734 0000 F30F1EFA 		endbr64
 1735 0004 55       		pushq	%rbp
 1736              	.LCFI66:
 1737              		.cfi_def_cfa_offset 16
 1738              		.cfi_offset 6, -16
 1739 0005 4889E5   		movq	%rsp, %rbp
 1740              	.LCFI67:
 1741              		.cfi_def_cfa_register 6
 1742 0008 4883EC30 		subq	$48, %rsp
 1743 000c 48897DE8 		movq	%rdi, -24(%rbp)
GAS LISTING /tmp/ccajKZL5.s 			page 52


 1744 0010 488975E0 		movq	%rsi, -32(%rbp)
 1745 0014 488955D8 		movq	%rdx, -40(%rbp)
 1746              		.loc 1 908 1
 1747 0018 64488B04 		movq	%fs:40, %rax
 1747      25280000 
 1747      00
 1748 0021 488945F8 		movq	%rax, -8(%rbp)
 1749 0025 31C0     		xorl	%eax, %eax
 909:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
 910:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_group_id grp_id;
 911:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( grp  != NULL );
 912:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( buf  != NULL );
 913:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( *buf != NULL );
 914:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 915:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ( ret = mbedtls_ecp_tls_read_group_id( &grp_id, buf, len ) ) != 0 )
 1750              		.loc 1 915 17
 1751 0027 488B55D8 		movq	-40(%rbp), %rdx
 1752 002b 488B4DE0 		movq	-32(%rbp), %rcx
 1753 002f 488D45F0 		leaq	-16(%rbp), %rax
 1754 0033 4889CE   		movq	%rcx, %rsi
 1755 0036 4889C7   		movq	%rax, %rdi
 1756 0039 E8000000 		call	mbedtls_ecp_tls_read_group_id
 1756      00
 1757 003e 8945F4   		movl	%eax, -12(%rbp)
 1758              		.loc 1 915 7
 1759 0041 837DF400 		cmpl	$0, -12(%rbp)
 1760 0045 7405     		je	.L130
 916:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( ret );
 1761              		.loc 1 916 15
 1762 0047 8B45F4   		movl	-12(%rbp), %eax
 1763 004a EB11     		jmp	.L132
 1764              	.L130:
 917:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 918:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( mbedtls_ecp_group_load( grp, grp_id ) );
 1765              		.loc 1 918 13
 1766 004c 8B55F0   		movl	-16(%rbp), %edx
 1767 004f 488B45E8 		movq	-24(%rbp), %rax
 1768 0053 89D6     		movl	%edx, %esi
 1769 0055 4889C7   		movq	%rax, %rdi
 1770 0058 E8000000 		call	mbedtls_ecp_group_load@PLT
 1770      00
 1771              	.L132:
 919:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 1772              		.loc 1 919 1 discriminator 1
 1773 005d 488B4DF8 		movq	-8(%rbp), %rcx
 1774 0061 6448330C 		xorq	%fs:40, %rcx
 1774      25280000 
 1774      00
 1775 006a 7405     		je	.L133
 1776              		.loc 1 919 1 is_stmt 0
 1777 006c E8000000 		call	__stack_chk_fail@PLT
 1777      00
 1778              	.L133:
 1779 0071 C9       		leave
 1780              	.LCFI68:
 1781              		.cfi_def_cfa 7, 8
 1782 0072 C3       		ret
GAS LISTING /tmp/ccajKZL5.s 			page 53


 1783              		.cfi_endproc
 1784              	.LFE28:
 1786              		.section	.text.mbedtls_ecp_tls_read_group_id,"ax",@progbits
 1787              		.globl	mbedtls_ecp_tls_read_group_id
 1789              	mbedtls_ecp_tls_read_group_id:
 1790              	.LFB29:
 920:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 921:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 922:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Read a group id from an ECParameters record (RFC 4492) and convert it to
 923:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * mbedtls_ecp_group_id.
 924:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 925:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_tls_read_group_id( mbedtls_ecp_group_id *grp,
 926:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                    const unsigned char **buf, size_t len )
 927:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 1791              		.loc 1 927 1 is_stmt 1
 1792              		.cfi_startproc
 1793 0000 F30F1EFA 		endbr64
 1794 0004 55       		pushq	%rbp
 1795              	.LCFI69:
 1796              		.cfi_def_cfa_offset 16
 1797              		.cfi_offset 6, -16
 1798 0005 4889E5   		movq	%rsp, %rbp
 1799              	.LCFI70:
 1800              		.cfi_def_cfa_register 6
 1801 0008 4883EC40 		subq	$64, %rsp
 1802 000c 48897DD8 		movq	%rdi, -40(%rbp)
 1803 0010 488975D0 		movq	%rsi, -48(%rbp)
 1804 0014 488955C8 		movq	%rdx, -56(%rbp)
 1805              		.loc 1 927 1
 1806 0018 64488B04 		movq	%fs:40, %rax
 1806      25280000 
 1806      00
 1807 0021 488945F8 		movq	%rax, -8(%rbp)
 1808 0025 31C0     		xorl	%eax, %eax
 928:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     uint16_t tls_id;
 929:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     const mbedtls_ecp_curve_info *curve_info;
 930:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( grp  != NULL );
 931:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( buf  != NULL );
 932:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( *buf != NULL );
 933:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 934:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
 935:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * We expect at least three bytes (see below)
 936:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
 937:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( len < 3 )
 1809              		.loc 1 937 7
 1810 0027 48837DC8 		cmpq	$2, -56(%rbp)
 1810      02
 1811 002c 770A     		ja	.L135
 938:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( MBEDTLS_ERR_ECP_BAD_INPUT_DATA );
 1812              		.loc 1 938 15
 1813 002e B880B0FF 		movl	$-20352, %eax
 1813      FF
 1814 0033 E98B0000 		jmp	.L136
 1814      00
 1815              	.L135:
 939:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 940:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
GAS LISTING /tmp/ccajKZL5.s 			page 54


 941:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * First byte is curve_type; only named_curve is handled
 942:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
 943:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( *(*buf)++ != MBEDTLS_ECP_TLS_NAMED_CURVE )
 1816              		.loc 1 943 11
 1817 0038 488B45D0 		movq	-48(%rbp), %rax
 1818 003c 488B00   		movq	(%rax), %rax
 1819              		.loc 1 943 16
 1820 003f 488D4801 		leaq	1(%rax), %rcx
 1821 0043 488B55D0 		movq	-48(%rbp), %rdx
 1822 0047 48890A   		movq	%rcx, (%rdx)
 1823              		.loc 1 943 9
 1824 004a 0FB600   		movzbl	(%rax), %eax
 1825              		.loc 1 943 7
 1826 004d 3C03     		cmpb	$3, %al
 1827 004f 7407     		je	.L137
 944:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( MBEDTLS_ERR_ECP_BAD_INPUT_DATA );
 1828              		.loc 1 944 15
 1829 0051 B880B0FF 		movl	$-20352, %eax
 1829      FF
 1830 0056 EB6B     		jmp	.L136
 1831              	.L137:
 945:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 946:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
 947:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * Next two bytes are the namedcurve value
 948:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
 949:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     tls_id = *(*buf)++;
 1832              		.loc 1 949 16
 1833 0058 488B45D0 		movq	-48(%rbp), %rax
 1834 005c 488B00   		movq	(%rax), %rax
 1835              		.loc 1 949 21
 1836 005f 488D4801 		leaq	1(%rax), %rcx
 1837 0063 488B55D0 		movq	-48(%rbp), %rdx
 1838 0067 48890A   		movq	%rcx, (%rdx)
 1839              		.loc 1 949 14
 1840 006a 0FB600   		movzbl	(%rax), %eax
 1841              		.loc 1 949 12
 1842 006d 0FB6C0   		movzbl	%al, %eax
 1843 0070 668945EE 		movw	%ax, -18(%rbp)
 950:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     tls_id <<= 8;
 1844              		.loc 1 950 12
 1845 0074 66C165EE 		salw	$8, -18(%rbp)
 1845      08
 951:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     tls_id |= *(*buf)++;
 1846              		.loc 1 951 17
 1847 0079 488B45D0 		movq	-48(%rbp), %rax
 1848 007d 488B00   		movq	(%rax), %rax
 1849              		.loc 1 951 22
 1850 0080 488D4801 		leaq	1(%rax), %rcx
 1851 0084 488B55D0 		movq	-48(%rbp), %rdx
 1852 0088 48890A   		movq	%rcx, (%rdx)
 1853              		.loc 1 951 15
 1854 008b 0FB600   		movzbl	(%rax), %eax
 1855 008e 0FB6C0   		movzbl	%al, %eax
 1856              		.loc 1 951 12
 1857 0091 660945EE 		orw	%ax, -18(%rbp)
 952:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 953:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ( curve_info = mbedtls_ecp_curve_info_from_tls_id( tls_id ) ) == NULL )
GAS LISTING /tmp/ccajKZL5.s 			page 55


 1858              		.loc 1 953 24
 1859 0095 0FB745EE 		movzwl	-18(%rbp), %eax
 1860 0099 89C7     		movl	%eax, %edi
 1861 009b E8000000 		call	mbedtls_ecp_curve_info_from_tls_id
 1861      00
 1862 00a0 488945F0 		movq	%rax, -16(%rbp)
 1863              		.loc 1 953 7
 1864 00a4 48837DF0 		cmpq	$0, -16(%rbp)
 1864      00
 1865 00a9 7507     		jne	.L138
 954:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( MBEDTLS_ERR_ECP_FEATURE_UNAVAILABLE );
 1866              		.loc 1 954 15
 1867 00ab B880B1FF 		movl	$-20096, %eax
 1867      FF
 1868 00b0 EB11     		jmp	.L136
 1869              	.L138:
 955:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 956:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     *grp = curve_info->grp_id;
 1870              		.loc 1 956 22
 1871 00b2 488B45F0 		movq	-16(%rbp), %rax
 1872 00b6 8B10     		movl	(%rax), %edx
 1873              		.loc 1 956 10
 1874 00b8 488B45D8 		movq	-40(%rbp), %rax
 1875 00bc 8910     		movl	%edx, (%rax)
 957:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 958:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( 0 );
 1876              		.loc 1 958 11
 1877 00be B8000000 		movl	$0, %eax
 1877      00
 1878              	.L136:
 959:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 1879              		.loc 1 959 1
 1880 00c3 488B75F8 		movq	-8(%rbp), %rsi
 1881 00c7 64483334 		xorq	%fs:40, %rsi
 1881      25280000 
 1881      00
 1882 00d0 7405     		je	.L139
 1883 00d2 E8000000 		call	__stack_chk_fail@PLT
 1883      00
 1884              	.L139:
 1885 00d7 C9       		leave
 1886              	.LCFI71:
 1887              		.cfi_def_cfa 7, 8
 1888 00d8 C3       		ret
 1889              		.cfi_endproc
 1890              	.LFE29:
 1892              		.section	.text.mbedtls_ecp_tls_write_group,"ax",@progbits
 1893              		.globl	mbedtls_ecp_tls_write_group
 1895              	mbedtls_ecp_tls_write_group:
 1896              	.LFB30:
 960:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 961:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 962:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Write the ECParameters record corresponding to a group (RFC 4492)
 963:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
 964:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_tls_write_group( const mbedtls_ecp_group *grp, size_t *olen,
 965:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                          unsigned char *buf, size_t blen )
 966:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
GAS LISTING /tmp/ccajKZL5.s 			page 56


 1897              		.loc 1 966 1
 1898              		.cfi_startproc
 1899 0000 F30F1EFA 		endbr64
 1900 0004 55       		pushq	%rbp
 1901              	.LCFI72:
 1902              		.cfi_def_cfa_offset 16
 1903              		.cfi_offset 6, -16
 1904 0005 4889E5   		movq	%rsp, %rbp
 1905              	.LCFI73:
 1906              		.cfi_def_cfa_register 6
 1907 0008 4883EC30 		subq	$48, %rsp
 1908 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1909 0010 488975E0 		movq	%rsi, -32(%rbp)
 1910 0014 488955D8 		movq	%rdx, -40(%rbp)
 1911 0018 48894DD0 		movq	%rcx, -48(%rbp)
 1912              		.loc 1 966 1
 1913 001c 64488B04 		movq	%fs:40, %rax
 1913      25280000 
 1913      00
 1914 0025 488945F8 		movq	%rax, -8(%rbp)
 1915 0029 31C0     		xorl	%eax, %eax
 967:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     const mbedtls_ecp_curve_info *curve_info;
 968:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( grp  != NULL );
 969:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( buf  != NULL );
 970:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( olen != NULL );
 971:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 972:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ( curve_info = mbedtls_ecp_curve_info_from_grp_id( grp->id ) ) == NULL )
 1916              		.loc 1 972 24
 1917 002b 488B45E8 		movq	-24(%rbp), %rax
 1918 002f 8B00     		movl	(%rax), %eax
 1919 0031 89C7     		movl	%eax, %edi
 1920 0033 E8000000 		call	mbedtls_ecp_curve_info_from_grp_id
 1920      00
 1921 0038 488945F0 		movq	%rax, -16(%rbp)
 1922              		.loc 1 972 7
 1923 003c 48837DF0 		cmpq	$0, -16(%rbp)
 1923      00
 1924 0041 7507     		jne	.L141
 973:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( MBEDTLS_ERR_ECP_BAD_INPUT_DATA );
 1925              		.loc 1 973 15
 1926 0043 B880B0FF 		movl	$-20352, %eax
 1926      FF
 1927 0048 EB59     		jmp	.L142
 1928              	.L141:
 974:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 975:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
 976:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * We are going to write 3 bytes (see below)
 977:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
 978:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     *olen = 3;
 1929              		.loc 1 978 11
 1930 004a 488B45E0 		movq	-32(%rbp), %rax
 1931 004e 48C70003 		movq	$3, (%rax)
 1931      000000
 979:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( blen < *olen )
 1932              		.loc 1 979 16
 1933 0055 488B45E0 		movq	-32(%rbp), %rax
 1934 0059 488B00   		movq	(%rax), %rax
GAS LISTING /tmp/ccajKZL5.s 			page 57


 1935              		.loc 1 979 7
 1936 005c 483945D0 		cmpq	%rax, -48(%rbp)
 1937 0060 7307     		jnb	.L143
 980:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( MBEDTLS_ERR_ECP_BUFFER_TOO_SMALL );
 1938              		.loc 1 980 15
 1939 0062 B800B1FF 		movl	$-20224, %eax
 1939      FF
 1940 0067 EB3A     		jmp	.L142
 1941              	.L143:
 981:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 982:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
 983:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * First byte is curve_type, always named_curve
 984:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
 985:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     *buf++ = MBEDTLS_ECP_TLS_NAMED_CURVE;
 1942              		.loc 1 985 9
 1943 0069 488B45D8 		movq	-40(%rbp), %rax
 1944 006d 488D5001 		leaq	1(%rax), %rdx
 1945 0071 488955D8 		movq	%rdx, -40(%rbp)
 1946              		.loc 1 985 12
 1947 0075 C60003   		movb	$3, (%rax)
 986:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 987:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
 988:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * Next two bytes are the namedcurve value
 989:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
 990:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     buf[0] = curve_info->tls_id >> 8;
 1948              		.loc 1 990 24
 1949 0078 488B45F0 		movq	-16(%rbp), %rax
 1950 007c 0FB74004 		movzwl	4(%rax), %eax
 1951              		.loc 1 990 12
 1952 0080 66C1E808 		shrw	$8, %ax
 1953 0084 89C2     		movl	%eax, %edx
 1954 0086 488B45D8 		movq	-40(%rbp), %rax
 1955 008a 8810     		movb	%dl, (%rax)
 991:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     buf[1] = curve_info->tls_id & 0xFF;
 1956              		.loc 1 991 24
 1957 008c 488B45F0 		movq	-16(%rbp), %rax
 1958 0090 0FB75004 		movzwl	4(%rax), %edx
 1959              		.loc 1 991 8
 1960 0094 488B45D8 		movq	-40(%rbp), %rax
 1961 0098 4883C001 		addq	$1, %rax
 1962              		.loc 1 991 12
 1963 009c 8810     		movb	%dl, (%rax)
 992:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 993:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( 0 );
 1964              		.loc 1 993 11
 1965 009e B8000000 		movl	$0, %eax
 1965      00
 1966              	.L142:
 994:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 1967              		.loc 1 994 1
 1968 00a3 488B4DF8 		movq	-8(%rbp), %rcx
 1969 00a7 6448330C 		xorq	%fs:40, %rcx
 1969      25280000 
 1969      00
 1970 00b0 7405     		je	.L144
 1971 00b2 E8000000 		call	__stack_chk_fail@PLT
 1971      00
GAS LISTING /tmp/ccajKZL5.s 			page 58


 1972              	.L144:
 1973 00b7 C9       		leave
 1974              	.LCFI74:
 1975              		.cfi_def_cfa 7, 8
 1976 00b8 C3       		ret
 1977              		.cfi_endproc
 1978              	.LFE30:
 1980              		.section	.text.ecp_modp,"ax",@progbits
 1982              	ecp_modp:
 1983              	.LFB31:
 995:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 996:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
 997:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Wrapper around fast quasi-modp functions, with fall-back to mbedtls_mpi_mod_mpi.
 998:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * See the documentation of struct mbedtls_ecp_group.
 999:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1000:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * This function is in the critial loop for mbedtls_ecp_mul, so pay attention to perf.
1001:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
1002:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static int ecp_modp( mbedtls_mpi *N, const mbedtls_ecp_group *grp )
1003:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 1984              		.loc 1 1003 1
 1985              		.cfi_startproc
 1986 0000 F30F1EFA 		endbr64
 1987 0004 55       		pushq	%rbp
 1988              	.LCFI75:
 1989              		.cfi_def_cfa_offset 16
 1990              		.cfi_offset 6, -16
 1991 0005 4889E5   		movq	%rsp, %rbp
 1992              	.LCFI76:
 1993              		.cfi_def_cfa_register 6
 1994 0008 4883EC20 		subq	$32, %rsp
 1995 000c 48897DE8 		movq	%rdi, -24(%rbp)
 1996 0010 488975E0 		movq	%rsi, -32(%rbp)
 1997              		.loc 1 1003 1
 1998 0014 64488B04 		movq	%fs:40, %rax
 1998      25280000 
 1998      00
 1999 001d 488945F8 		movq	%rax, -8(%rbp)
 2000 0021 31C0     		xorl	%eax, %eax
1004:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
1005:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1006:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( grp->modp == NULL )
 2001              		.loc 1 1006 12
 2002 0023 488B45E0 		movq	-32(%rbp), %rax
 2003 0027 488B80C8 		movq	200(%rax), %rax
 2003      000000
 2004              		.loc 1 1006 7
 2005 002e 4885C0   		testq	%rax, %rax
 2006 0031 7520     		jne	.L146
1007:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( mbedtls_mpi_mod_mpi( N, N, &grp->P ) );
 2007              		.loc 1 1007 17
 2008 0033 488B45E0 		movq	-32(%rbp), %rax
 2009 0037 488D5008 		leaq	8(%rax), %rdx
 2010 003b 488B4DE8 		movq	-24(%rbp), %rcx
 2011 003f 488B45E8 		movq	-24(%rbp), %rax
 2012 0043 4889CE   		movq	%rcx, %rsi
 2013 0046 4889C7   		movq	%rax, %rdi
 2014 0049 E8000000 		call	mbedtls_mpi_mod_mpi@PLT
GAS LISTING /tmp/ccajKZL5.s 			page 59


 2014      00
 2015 004e E9FB0000 		jmp	.L147
 2015      00
 2016              	.L146:
1008:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1009:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* N->s < 0 is a much faster test, which fails only if N is 0 */
1010:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ( N->s < 0 && mbedtls_mpi_cmp_int( N, 0 ) != 0 ) ||
 2017              		.loc 1 1010 12
 2018 0053 488B45E8 		movq	-24(%rbp), %rax
 2019 0057 8B00     		movl	(%rax), %eax
 2020              		.loc 1 1010 7
 2021 0059 85C0     		testl	%eax, %eax
 2022 005b 7915     		jns	.L148
 2023              		.loc 1 1010 23 discriminator 1
 2024 005d 488B45E8 		movq	-24(%rbp), %rax
 2025 0061 BE000000 		movl	$0, %esi
 2025      00
 2026 0066 4889C7   		movq	%rax, %rdi
 2027 0069 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 2027      00
 2028              		.loc 1 1010 20 discriminator 1
 2029 006e 85C0     		testl	%eax, %eax
 2030 0070 751F     		jne	.L149
 2031              	.L148:
1011:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_bitlen( N ) > 2 * grp->pbits )
 2032              		.loc 1 1011 9 discriminator 3
 2033 0072 488B45E8 		movq	-24(%rbp), %rax
 2034 0076 4889C7   		movq	%rax, %rdi
 2035 0079 E8000000 		call	mbedtls_mpi_bitlen@PLT
 2035      00
 2036              		.loc 1 1011 42 discriminator 3
 2037 007e 488B55E0 		movq	-32(%rbp), %rdx
 2038 0082 488B92B0 		movq	176(%rdx), %rdx
 2038      000000
 2039              		.loc 1 1011 37 discriminator 3
 2040 0089 4801D2   		addq	%rdx, %rdx
1010:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_bitlen( N ) > 2 * grp->pbits )
 2041              		.loc 1 1010 58 discriminator 3
 2042 008c 4839D0   		cmpq	%rdx, %rax
 2043 008f 760A     		jbe	.L150
 2044              	.L149:
1012:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
1013:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( MBEDTLS_ERR_ECP_BAD_INPUT_DATA );
 2045              		.loc 1 1013 15
 2046 0091 B880B0FF 		movl	$-20352, %eax
 2046      FF
 2047 0096 E9B30000 		jmp	.L147
 2047      00
 2048              	.L150:
1014:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
1015:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1016:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( grp->modp( N ) );
 2049              		.loc 1 1016 5
 2050 009b 488B45E0 		movq	-32(%rbp), %rax
 2051 009f 488B90C8 		movq	200(%rax), %rdx
 2051      000000
 2052 00a6 488B45E8 		movq	-24(%rbp), %rax
GAS LISTING /tmp/ccajKZL5.s 			page 60


 2053 00aa 4889C7   		movq	%rax, %rdi
 2054 00ad FFD2     		call	*%rdx
 2055              	.LVL0:
 2056 00af 8945F4   		movl	%eax, -12(%rbp)
 2057 00b2 837DF400 		cmpl	$0, -12(%rbp)
 2058 00b6 0F858800 		jne	.L159
 2058      0000
1017:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1018:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* N->s < 0 is a much faster test, which fails only if N is 0 */
1019:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     while( N->s < 0 && mbedtls_mpi_cmp_int( N, 0 ) != 0 )
 2059              		.loc 1 1019 10
 2060 00bc EB24     		jmp	.L153
 2061              	.L155:
1020:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( N, N, &grp->P ) );
 2062              		.loc 1 1020 9
 2063 00be 488B45E0 		movq	-32(%rbp), %rax
 2064 00c2 488D5008 		leaq	8(%rax), %rdx
 2065 00c6 488B4DE8 		movq	-24(%rbp), %rcx
 2066 00ca 488B45E8 		movq	-24(%rbp), %rax
 2067 00ce 4889CE   		movq	%rcx, %rsi
 2068 00d1 4889C7   		movq	%rax, %rdi
 2069 00d4 E8000000 		call	mbedtls_mpi_add_mpi@PLT
 2069      00
 2070 00d9 8945F4   		movl	%eax, -12(%rbp)
 2071 00dc 837DF400 		cmpl	$0, -12(%rbp)
 2072 00e0 7565     		jne	.L160
 2073              	.L153:
1019:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( N, N, &grp->P ) );
 2074              		.loc 1 1019 13
 2075 00e2 488B45E8 		movq	-24(%rbp), %rax
 2076 00e6 8B00     		movl	(%rax), %eax
1019:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( N, N, &grp->P ) );
 2077              		.loc 1 1019 10
 2078 00e8 85C0     		testl	%eax, %eax
 2079 00ea 793B     		jns	.L156
1019:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( N, N, &grp->P ) );
 2080              		.loc 1 1019 24 discriminator 1
 2081 00ec 488B45E8 		movq	-24(%rbp), %rax
 2082 00f0 BE000000 		movl	$0, %esi
 2082      00
 2083 00f5 4889C7   		movq	%rax, %rdi
 2084 00f8 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 2084      00
1019:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( N, N, &grp->P ) );
 2085              		.loc 1 1019 21 discriminator 1
 2086 00fd 85C0     		testl	%eax, %eax
 2087 00ff 75BD     		jne	.L155
1021:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1022:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     while( mbedtls_mpi_cmp_mpi( N, &grp->P ) >= 0 )
 2088              		.loc 1 1022 10
 2089 0101 EB24     		jmp	.L156
 2090              	.L157:
1023:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* we known P, N and the result are positive */
1024:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_sub_abs( N, N, &grp->P ) );
 2091              		.loc 1 1024 9
 2092 0103 488B45E0 		movq	-32(%rbp), %rax
 2093 0107 488D5008 		leaq	8(%rax), %rdx
GAS LISTING /tmp/ccajKZL5.s 			page 61


 2094 010b 488B4DE8 		movq	-24(%rbp), %rcx
 2095 010f 488B45E8 		movq	-24(%rbp), %rax
 2096 0113 4889CE   		movq	%rcx, %rsi
 2097 0116 4889C7   		movq	%rax, %rdi
 2098 0119 E8000000 		call	mbedtls_mpi_sub_abs@PLT
 2098      00
 2099 011e 8945F4   		movl	%eax, -12(%rbp)
 2100 0121 837DF400 		cmpl	$0, -12(%rbp)
 2101 0125 7523     		jne	.L161
 2102              	.L156:
1022:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* we known P, N and the result are positive */
 2103              		.loc 1 1022 12
 2104 0127 488B45E0 		movq	-32(%rbp), %rax
 2105 012b 488D5008 		leaq	8(%rax), %rdx
 2106 012f 488B45E8 		movq	-24(%rbp), %rax
 2107 0133 4889D6   		movq	%rdx, %rsi
 2108 0136 4889C7   		movq	%rax, %rdi
 2109 0139 E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 2109      00
1022:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* we known P, N and the result are positive */
 2110              		.loc 1 1022 10
 2111 013e 85C0     		testl	%eax, %eax
 2112 0140 79C1     		jns	.L157
1025:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1026:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
 2113              		.loc 1 1026 1
 2114 0142 EB07     		jmp	.L152
 2115              	.L159:
1016:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 2116              		.loc 1 1016 5
 2117 0144 90       		nop
 2118 0145 EB04     		jmp	.L152
 2119              	.L160:
1020:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 2120              		.loc 1 1020 9
 2121 0147 90       		nop
 2122 0148 EB01     		jmp	.L152
 2123              	.L161:
1024:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 2124              		.loc 1 1024 9
 2125 014a 90       		nop
 2126              	.L152:
1027:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 2127              		.loc 1 1027 11
 2128 014b 8B45F4   		movl	-12(%rbp), %eax
 2129              	.L147:
1028:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 2130              		.loc 1 1028 1
 2131 014e 488B4DF8 		movq	-8(%rbp), %rcx
 2132 0152 6448330C 		xorq	%fs:40, %rcx
 2132      25280000 
 2132      00
 2133 015b 7405     		je	.L158
 2134 015d E8000000 		call	__stack_chk_fail@PLT
 2134      00
 2135              	.L158:
 2136 0162 C9       		leave
GAS LISTING /tmp/ccajKZL5.s 			page 62


 2137              	.LCFI77:
 2138              		.cfi_def_cfa 7, 8
 2139 0163 C3       		ret
 2140              		.cfi_endproc
 2141              	.LFE31:
 2143              		.section	.text.ecp_normalize_jac,"ax",@progbits
 2145              	ecp_normalize_jac:
 2146              	.LFB32:
1029:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1030:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
1031:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Fast mod-p functions expect their argument to be in the 0..p^2 range.
1032:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1033:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * In order to guarantee that, we need to ensure that operands of
1034:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * mbedtls_mpi_mul_mpi are in the 0..p range. So, after each operation we will
1035:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * bring the result back to this range.
1036:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1037:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * The following macros are shortcuts for doing that.
1038:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
1039:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1040:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
1041:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Reduce a mbedtls_mpi mod p in-place, general case, to use after mbedtls_mpi_mul_mpi
1042:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
1043:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_SELF_TEST)
1044:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #define INC_MUL_COUNT   mul_count++;
1045:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #else
1046:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #define INC_MUL_COUNT
1047:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
1048:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1049:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #define MOD_MUL( N )                                                    \
1050:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     do                                                                  \
1051:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {                                                                   \
1052:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( ecp_modp( &(N), grp ) );                       \
1053:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         INC_MUL_COUNT                                                   \
1054:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     } while( 0 )
1055:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1056:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
1057:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Reduce a mbedtls_mpi mod p in-place, to use after mbedtls_mpi_sub_mpi
1058:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * N->s < 0 is a very fast test, which fails only if N is 0
1059:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
1060:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #define MOD_SUB( N )                                                    \
1061:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     while( (N).s < 0 && mbedtls_mpi_cmp_int( &(N), 0 ) != 0 )           \
1062:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( &(N), &(N), &grp->P ) )
1063:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1064:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
1065:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Reduce a mbedtls_mpi mod p in-place, to use after mbedtls_mpi_add_mpi and mbedtls_mpi_mul_int.
1066:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * We known P, N and the result are positive, so sub_abs is correct, and
1067:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * a bit faster.
1068:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
1069:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #define MOD_ADD( N )                                                    \
1070:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     while( mbedtls_mpi_cmp_mpi( &(N), &grp->P ) >= 0 )                  \
1071:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_sub_abs( &(N), &(N), &grp->P ) )
1072:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1073:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(ECP_SHORTWEIERSTRASS)
1074:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
1075:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * For curves in short Weierstrass form, we do all the internal operations in
1076:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Jacobian coordinates.
1077:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
GAS LISTING /tmp/ccajKZL5.s 			page 63


1078:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * For multiplication, we'll use a comb method with coutermeasueres against
1079:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * SPA, hence timing attacks.
1080:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
1081:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1082:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
1083:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Normalize jacobian coordinates so that Z == 0 || Z == 1  (GECC 3.2.1)
1084:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Cost: 1N := 1I + 3M + 1S
1085:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
1086:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static int ecp_normalize_jac( const mbedtls_ecp_group *grp, mbedtls_ecp_point *pt )
1087:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 2147              		.loc 1 1087 1
 2148              		.cfi_startproc
 2149 0000 F30F1EFA 		endbr64
 2150 0004 55       		pushq	%rbp
 2151              	.LCFI78:
 2152              		.cfi_def_cfa_offset 16
 2153              		.cfi_offset 6, -16
 2154 0005 4889E5   		movq	%rsp, %rbp
 2155              	.LCFI79:
 2156              		.cfi_def_cfa_register 6
 2157 0008 4883EC60 		subq	$96, %rsp
 2158 000c 48897DA8 		movq	%rdi, -88(%rbp)
 2159 0010 488975A0 		movq	%rsi, -96(%rbp)
 2160              		.loc 1 1087 1
 2161 0014 64488B04 		movq	%fs:40, %rax
 2161      25280000 
 2161      00
 2162 001d 488945F8 		movq	%rax, -8(%rbp)
 2163 0021 31C0     		xorl	%eax, %eax
1088:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
1089:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi Zi, ZZi;
1090:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1091:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( mbedtls_mpi_cmp_int( &pt->Z, 0 ) == 0 )
 2164              		.loc 1 1091 30
 2165 0023 488B45A0 		movq	-96(%rbp), %rax
 2166 0027 4883C030 		addq	$48, %rax
 2167              		.loc 1 1091 9
 2168 002b BE000000 		movl	$0, %esi
 2168      00
 2169 0030 4889C7   		movq	%rax, %rdi
 2170 0033 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 2170      00
 2171              		.loc 1 1091 7
 2172 0038 85C0     		testl	%eax, %eax
 2173 003a 750A     		jne	.L163
1092:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( 0 );
 2174              		.loc 1 1092 15
 2175 003c B8000000 		movl	$0, %eax
 2175      00
 2176 0041 E9B20100 		jmp	.L175
 2176      00
 2177              	.L163:
1093:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1094:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_NORMALIZE_JAC_ALT)
1095:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( mbedtls_internal_ecp_grp_capable( grp ) )
1096:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( mbedtls_internal_ecp_normalize_jac( grp, pt ) );
1097:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif /* MBEDTLS_ECP_NORMALIZE_JAC_ALT */
GAS LISTING /tmp/ccajKZL5.s 			page 64


1098:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1099:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_init( &Zi ); mbedtls_mpi_init( &ZZi );
 2178              		.loc 1 1099 5
 2179 0046 488D45C0 		leaq	-64(%rbp), %rax
 2180 004a 4889C7   		movq	%rax, %rdi
 2181 004d E8000000 		call	mbedtls_mpi_init@PLT
 2181      00
 2182              		.loc 1 1099 30
 2183 0052 488D45E0 		leaq	-32(%rbp), %rax
 2184 0056 4889C7   		movq	%rax, %rdi
 2185 0059 E8000000 		call	mbedtls_mpi_init@PLT
 2185      00
1100:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1101:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
1102:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * X = X / Z^2  mod p
1103:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
1104:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_inv_mod( &Zi,      &pt->Z,     &grp->P ) );
 2186              		.loc 1 1104 5
 2187 005e 488B45A8 		movq	-88(%rbp), %rax
 2188 0062 488D5008 		leaq	8(%rax), %rdx
 2189 0066 488B45A0 		movq	-96(%rbp), %rax
 2190 006a 488D4830 		leaq	48(%rax), %rcx
 2191 006e 488D45C0 		leaq	-64(%rbp), %rax
 2192 0072 4889CE   		movq	%rcx, %rsi
 2193 0075 4889C7   		movq	%rax, %rdi
 2194 0078 E8000000 		call	mbedtls_mpi_inv_mod@PLT
 2194      00
 2195 007d 8945BC   		movl	%eax, -68(%rbp)
 2196 0080 837DBC00 		cmpl	$0, -68(%rbp)
 2197 0084 0F853A01 		jne	.L177
 2197      0000
1105:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &ZZi,     &Zi,        &Zi     ) ); MOD_MUL( ZZi );
 2198              		.loc 1 1105 5
 2199 008a 488D55C0 		leaq	-64(%rbp), %rdx
 2200 008e 488D4DC0 		leaq	-64(%rbp), %rcx
 2201 0092 488D45E0 		leaq	-32(%rbp), %rax
 2202 0096 4889CE   		movq	%rcx, %rsi
 2203 0099 4889C7   		movq	%rax, %rdi
 2204 009c E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 2204      00
 2205 00a1 8945BC   		movl	%eax, -68(%rbp)
 2206 00a4 837DBC00 		cmpl	$0, -68(%rbp)
 2207 00a8 0F851901 		jne	.L178
 2207      0000
 2208              		.loc 1 1105 78 discriminator 2
 2209 00ae 488B55A8 		movq	-88(%rbp), %rdx
 2210 00b2 488D45E0 		leaq	-32(%rbp), %rax
 2211 00b6 4889D6   		movq	%rdx, %rsi
 2212 00b9 4889C7   		movq	%rax, %rdi
 2213 00bc E8000000 		call	ecp_modp
 2213      00
 2214 00c1 8945BC   		movl	%eax, -68(%rbp)
 2215 00c4 837DBC00 		cmpl	$0, -68(%rbp)
 2216 00c8 0F85FC00 		jne	.L179
 2216      0000
1106:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &pt->X,   &pt->X,     &ZZi    ) ); MOD_MUL( pt->X );
 2217              		.loc 1 1106 5
GAS LISTING /tmp/ccajKZL5.s 			page 65


 2218 00ce 488B4DA0 		movq	-96(%rbp), %rcx
 2219 00d2 488B45A0 		movq	-96(%rbp), %rax
 2220 00d6 488D55E0 		leaq	-32(%rbp), %rdx
 2221 00da 4889CE   		movq	%rcx, %rsi
 2222 00dd 4889C7   		movq	%rax, %rdi
 2223 00e0 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 2223      00
 2224 00e5 8945BC   		movl	%eax, -68(%rbp)
 2225 00e8 837DBC00 		cmpl	$0, -68(%rbp)
 2226 00ec 0F85DB00 		jne	.L180
 2226      0000
 2227              		.loc 1 1106 78 discriminator 2
 2228 00f2 488B45A0 		movq	-96(%rbp), %rax
 2229 00f6 488B55A8 		movq	-88(%rbp), %rdx
 2230 00fa 4889D6   		movq	%rdx, %rsi
 2231 00fd 4889C7   		movq	%rax, %rdi
 2232 0100 E8000000 		call	ecp_modp
 2232      00
 2233 0105 8945BC   		movl	%eax, -68(%rbp)
 2234 0108 837DBC00 		cmpl	$0, -68(%rbp)
 2235 010c 0F85BE00 		jne	.L181
 2235      0000
1107:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1108:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
1109:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * Y = Y / Z^3  mod p
1110:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
1111:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &pt->Y,   &pt->Y,     &ZZi    ) ); MOD_MUL( pt->Y );
 2236              		.loc 1 1111 5
 2237 0112 488B45A0 		movq	-96(%rbp), %rax
 2238 0116 488D7018 		leaq	24(%rax), %rsi
 2239 011a 488B45A0 		movq	-96(%rbp), %rax
 2240 011e 488D4818 		leaq	24(%rax), %rcx
 2241 0122 488D45E0 		leaq	-32(%rbp), %rax
 2242 0126 4889C2   		movq	%rax, %rdx
 2243 0129 4889CF   		movq	%rcx, %rdi
 2244 012c E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 2244      00
 2245 0131 8945BC   		movl	%eax, -68(%rbp)
 2246 0134 837DBC00 		cmpl	$0, -68(%rbp)
 2247 0138 0F859500 		jne	.L182
 2247      0000
 2248              		.loc 1 1111 78 discriminator 2
 2249 013e 488B45A0 		movq	-96(%rbp), %rax
 2250 0142 488D5018 		leaq	24(%rax), %rdx
 2251 0146 488B45A8 		movq	-88(%rbp), %rax
 2252 014a 4889C6   		movq	%rax, %rsi
 2253 014d 4889D7   		movq	%rdx, %rdi
 2254 0150 E8000000 		call	ecp_modp
 2254      00
 2255 0155 8945BC   		movl	%eax, -68(%rbp)
 2256 0158 837DBC00 		cmpl	$0, -68(%rbp)
 2257 015c 7578     		jne	.L183
1112:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &pt->Y,   &pt->Y,     &Zi     ) ); MOD_MUL( pt->Y );
 2258              		.loc 1 1112 5
 2259 015e 488B45A0 		movq	-96(%rbp), %rax
 2260 0162 488D7018 		leaq	24(%rax), %rsi
 2261 0166 488B45A0 		movq	-96(%rbp), %rax
GAS LISTING /tmp/ccajKZL5.s 			page 66


 2262 016a 488D4818 		leaq	24(%rax), %rcx
 2263 016e 488D45C0 		leaq	-64(%rbp), %rax
 2264 0172 4889C2   		movq	%rax, %rdx
 2265 0175 4889CF   		movq	%rcx, %rdi
 2266 0178 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 2266      00
 2267 017d 8945BC   		movl	%eax, -68(%rbp)
 2268 0180 837DBC00 		cmpl	$0, -68(%rbp)
 2269 0184 7553     		jne	.L184
 2270              		.loc 1 1112 78 discriminator 2
 2271 0186 488B45A0 		movq	-96(%rbp), %rax
 2272 018a 488D5018 		leaq	24(%rax), %rdx
 2273 018e 488B45A8 		movq	-88(%rbp), %rax
 2274 0192 4889C6   		movq	%rax, %rsi
 2275 0195 4889D7   		movq	%rdx, %rdi
 2276 0198 E8000000 		call	ecp_modp
 2276      00
 2277 019d 8945BC   		movl	%eax, -68(%rbp)
 2278 01a0 837DBC00 		cmpl	$0, -68(%rbp)
 2279 01a4 7536     		jne	.L185
1113:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1114:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
1115:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * Z = 1
1116:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
1117:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_lset( &pt->Z, 1 ) );
 2280              		.loc 1 1117 5
 2281 01a6 488B45A0 		movq	-96(%rbp), %rax
 2282 01aa 4883C030 		addq	$48, %rax
 2283 01ae BE010000 		movl	$1, %esi
 2283      00
 2284 01b3 4889C7   		movq	%rax, %rdi
 2285 01b6 E8000000 		call	mbedtls_mpi_lset@PLT
 2285      00
 2286 01bb 8945BC   		movl	%eax, -68(%rbp)
 2287 01be 837DBC00 		cmpl	$0, -68(%rbp)
1118:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1119:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
 2288              		.loc 1 1119 1
 2289 01c2 EB19     		jmp	.L166
 2290              	.L177:
1104:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &ZZi,     &Zi,        &Zi     ) ); MOD_MUL( ZZi );
 2291              		.loc 1 1104 5
 2292 01c4 90       		nop
 2293 01c5 EB16     		jmp	.L166
 2294              	.L178:
1105:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &pt->X,   &pt->X,     &ZZi    ) ); MOD_MUL( pt->X );
 2295              		.loc 1 1105 5
 2296 01c7 90       		nop
 2297 01c8 EB13     		jmp	.L166
 2298              	.L179:
1105:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &pt->X,   &pt->X,     &ZZi    ) ); MOD_MUL( pt->X );
 2299              		.loc 1 1105 78
 2300 01ca 90       		nop
 2301 01cb EB10     		jmp	.L166
 2302              	.L180:
1106:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 2303              		.loc 1 1106 5
GAS LISTING /tmp/ccajKZL5.s 			page 67


 2304 01cd 90       		nop
 2305 01ce EB0D     		jmp	.L166
 2306              	.L181:
1106:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 2307              		.loc 1 1106 78
 2308 01d0 90       		nop
 2309 01d1 EB0A     		jmp	.L166
 2310              	.L182:
1111:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &pt->Y,   &pt->Y,     &Zi     ) ); MOD_MUL( pt->Y );
 2311              		.loc 1 1111 5
 2312 01d3 90       		nop
 2313 01d4 EB07     		jmp	.L166
 2314              	.L183:
1111:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &pt->Y,   &pt->Y,     &Zi     ) ); MOD_MUL( pt->Y );
 2315              		.loc 1 1111 78
 2316 01d6 90       		nop
 2317 01d7 EB04     		jmp	.L166
 2318              	.L184:
1112:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 2319              		.loc 1 1112 5
 2320 01d9 90       		nop
 2321 01da EB01     		jmp	.L166
 2322              	.L185:
1112:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 2323              		.loc 1 1112 78
 2324 01dc 90       		nop
 2325              	.L166:
1120:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1121:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_free( &Zi ); mbedtls_mpi_free( &ZZi );
 2326              		.loc 1 1121 5
 2327 01dd 488D45C0 		leaq	-64(%rbp), %rax
 2328 01e1 4889C7   		movq	%rax, %rdi
 2329 01e4 E8000000 		call	mbedtls_mpi_free@PLT
 2329      00
 2330              		.loc 1 1121 30
 2331 01e9 488D45E0 		leaq	-32(%rbp), %rax
 2332 01ed 4889C7   		movq	%rax, %rdi
 2333 01f0 E8000000 		call	mbedtls_mpi_free@PLT
 2333      00
1122:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1123:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 2334              		.loc 1 1123 11
 2335 01f5 8B45BC   		movl	-68(%rbp), %eax
 2336              	.L175:
1124:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 2337              		.loc 1 1124 1 discriminator 1
 2338 01f8 488B4DF8 		movq	-8(%rbp), %rcx
 2339 01fc 6448330C 		xorq	%fs:40, %rcx
 2339      25280000 
 2339      00
 2340 0205 7405     		je	.L176
 2341              		.loc 1 1124 1 is_stmt 0
 2342 0207 E8000000 		call	__stack_chk_fail@PLT
 2342      00
 2343              	.L176:
 2344 020c C9       		leave
 2345              	.LCFI80:
GAS LISTING /tmp/ccajKZL5.s 			page 68


 2346              		.cfi_def_cfa 7, 8
 2347 020d C3       		ret
 2348              		.cfi_endproc
 2349              	.LFE32:
 2351              		.section	.text.ecp_normalize_jac_many,"ax",@progbits
 2353              	ecp_normalize_jac_many:
 2354              	.LFB33:
1125:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1126:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
1127:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Normalize jacobian coordinates of an array of (pointers to) points,
1128:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * using Montgomery's trick to perform only one inversion mod P.
1129:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * (See for example Cohen's "A Course in Computational Algebraic Number
1130:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Theory", Algorithm 10.3.4.)
1131:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1132:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Warning: fails (returning an error) if one of the points is zero!
1133:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * This should never happen, see choice of w in ecp_mul_comb().
1134:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1135:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Cost: 1N(t) := 1I + (6t - 3)M + 1S
1136:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
1137:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static int ecp_normalize_jac_many( const mbedtls_ecp_group *grp,
1138:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                    mbedtls_ecp_point *T[], size_t T_size )
1139:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 2355              		.loc 1 1139 1 is_stmt 1
 2356              		.cfi_startproc
 2357 0000 F30F1EFA 		endbr64
 2358 0004 55       		pushq	%rbp
 2359              	.LCFI81:
 2360              		.cfi_def_cfa_offset 16
 2361              		.cfi_offset 6, -16
 2362 0005 4889E5   		movq	%rsp, %rbp
 2363              	.LCFI82:
 2364              		.cfi_def_cfa_register 6
 2365 0008 4881ECA0 		subq	$160, %rsp
 2365      000000
 2366 000f 4889BD78 		movq	%rdi, -136(%rbp)
 2366      FFFFFF
 2367 0016 4889B570 		movq	%rsi, -144(%rbp)
 2367      FFFFFF
 2368 001d 48899568 		movq	%rdx, -152(%rbp)
 2368      FFFFFF
 2369              		.loc 1 1139 1
 2370 0024 64488B04 		movq	%fs:40, %rax
 2370      25280000 
 2370      00
 2371 002d 488945F8 		movq	%rax, -8(%rbp)
 2372 0031 31C0     		xorl	%eax, %eax
1140:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
1141:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     size_t i;
1142:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi *c, u, Zi, ZZi;
1143:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1144:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( T_size < 2 )
 2373              		.loc 1 1144 7
 2374 0033 4883BD68 		cmpq	$1, -152(%rbp)
 2374      FFFFFF01 
 2375 003b 7721     		ja	.L187
1145:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( ecp_normalize_jac( grp, *T ) );
 2376              		.loc 1 1145 17
GAS LISTING /tmp/ccajKZL5.s 			page 69


 2377 003d 488B8570 		movq	-144(%rbp), %rax
 2377      FFFFFF
 2378 0044 488B10   		movq	(%rax), %rdx
 2379 0047 488B8578 		movq	-136(%rbp), %rax
 2379      FFFFFF
 2380 004e 4889D6   		movq	%rdx, %rsi
 2381 0051 4889C7   		movq	%rax, %rdi
 2382 0054 E8000000 		call	ecp_normalize_jac
 2382      00
 2383 0059 E9180600 		jmp	.L218
 2383      00
 2384              	.L187:
1146:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1147:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_NORMALIZE_JAC_MANY_ALT)
1148:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( mbedtls_internal_ecp_grp_capable( grp ) )
1149:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( mbedtls_internal_ecp_normalize_jac_many( grp, T, T_size ) );
1150:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
1151:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1152:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ( c = mbedtls_calloc( T_size, sizeof( mbedtls_mpi ) ) ) == NULL )
 2385              		.loc 1 1152 15
 2386 005e 488B8568 		movq	-152(%rbp), %rax
 2386      FFFFFF
 2387 0065 BE180000 		movl	$24, %esi
 2387      00
 2388 006a 4889C7   		movq	%rax, %rdi
 2389 006d E8000000 		call	mbedtls_calloc@PLT
 2389      00
 2390 0072 48894598 		movq	%rax, -104(%rbp)
 2391              		.loc 1 1152 7
 2392 0076 48837D98 		cmpq	$0, -104(%rbp)
 2392      00
 2393 007b 750A     		jne	.L189
1153:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( MBEDTLS_ERR_ECP_ALLOC_FAILED );
 2394              		.loc 1 1153 15
 2395 007d B880B2FF 		movl	$-19840, %eax
 2395      FF
 2396 0082 E9EF0500 		jmp	.L218
 2396      00
 2397              	.L189:
1154:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1155:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     for( i = 0; i < T_size; i++ )
 2398              		.loc 1 1155 12
 2399 0087 48C74590 		movq	$0, -112(%rbp)
 2399      00000000 
 2400              		.loc 1 1155 5
 2401 008f EB28     		jmp	.L190
 2402              	.L191:
1156:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_init( &c[i] );
 2403              		.loc 1 1156 29 discriminator 3
 2404 0091 488B5590 		movq	-112(%rbp), %rdx
 2405 0095 4889D0   		movq	%rdx, %rax
 2406 0098 4801C0   		addq	%rax, %rax
 2407 009b 4801D0   		addq	%rdx, %rax
 2408 009e 48C1E003 		salq	$3, %rax
 2409 00a2 4889C2   		movq	%rax, %rdx
 2410              		.loc 1 1156 9 discriminator 3
 2411 00a5 488B4598 		movq	-104(%rbp), %rax
GAS LISTING /tmp/ccajKZL5.s 			page 70


 2412 00a9 4801D0   		addq	%rdx, %rax
 2413 00ac 4889C7   		movq	%rax, %rdi
 2414 00af E8000000 		call	mbedtls_mpi_init@PLT
 2414      00
1155:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_init( &c[i] );
 2415              		.loc 1 1155 30 discriminator 3
 2416 00b4 48834590 		addq	$1, -112(%rbp)
 2416      01
 2417              	.L190:
1155:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_init( &c[i] );
 2418              		.loc 1 1155 5 discriminator 1
 2419 00b9 488B4590 		movq	-112(%rbp), %rax
 2420 00bd 483B8568 		cmpq	-152(%rbp), %rax
 2420      FFFFFF
 2421 00c4 72CB     		jb	.L191
1157:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1158:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_init( &u ); mbedtls_mpi_init( &Zi ); mbedtls_mpi_init( &ZZi );
 2422              		.loc 1 1158 5
 2423 00c6 488D45A0 		leaq	-96(%rbp), %rax
 2424 00ca 4889C7   		movq	%rax, %rdi
 2425 00cd E8000000 		call	mbedtls_mpi_init@PLT
 2425      00
 2426              		.loc 1 1158 29
 2427 00d2 488D45C0 		leaq	-64(%rbp), %rax
 2428 00d6 4889C7   		movq	%rax, %rdi
 2429 00d9 E8000000 		call	mbedtls_mpi_init@PLT
 2429      00
 2430              		.loc 1 1158 54
 2431 00de 488D45E0 		leaq	-32(%rbp), %rax
 2432 00e2 4889C7   		movq	%rax, %rdi
 2433 00e5 E8000000 		call	mbedtls_mpi_init@PLT
 2433      00
1159:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1160:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
1161:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * c[i] = Z_0 * ... * Z_i
1162:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
1163:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &c[0], &T[0]->Z ) );
 2434              		.loc 1 1163 5
 2435 00ea 488B8570 		movq	-144(%rbp), %rax
 2435      FFFFFF
 2436 00f1 488B00   		movq	(%rax), %rax
 2437 00f4 488D5030 		leaq	48(%rax), %rdx
 2438 00f8 488B4598 		movq	-104(%rbp), %rax
 2439 00fc 4889D6   		movq	%rdx, %rsi
 2440 00ff 4889C7   		movq	%rax, %rdi
 2441 0102 E8000000 		call	mbedtls_mpi_copy@PLT
 2441      00
 2442 0107 89458C   		movl	%eax, -116(%rbp)
 2443 010a 837D8C00 		cmpl	$0, -116(%rbp)
 2444 010e 0F85B904 		jne	.L220
 2444      0000
1164:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     for( i = 1; i < T_size; i++ )
 2445              		.loc 1 1164 12
 2446 0114 48C74590 		movq	$1, -112(%rbp)
 2446      01000000 
 2447              		.loc 1 1164 5
 2448 011c E9AF0000 		jmp	.L194
GAS LISTING /tmp/ccajKZL5.s 			page 71


 2448      00
 2449              	.L197:
1165:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
1166:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &c[i], &c[i-1], &T[i]->Z ) );
 2450              		.loc 1 1166 9
 2451 0121 488B4590 		movq	-112(%rbp), %rax
 2452 0125 488D14C5 		leaq	0(,%rax,8), %rdx
 2452      00000000 
 2453 012d 488B8570 		movq	-144(%rbp), %rax
 2453      FFFFFF
 2454 0134 4801D0   		addq	%rdx, %rax
 2455 0137 488B00   		movq	(%rax), %rax
 2456 013a 488D7030 		leaq	48(%rax), %rsi
 2457 013e 488B5590 		movq	-112(%rbp), %rdx
 2458 0142 4889D0   		movq	%rdx, %rax
 2459 0145 4801C0   		addq	%rax, %rax
 2460 0148 4801D0   		addq	%rdx, %rax
 2461 014b 48C1E003 		salq	$3, %rax
 2462 014f 488D50E8 		leaq	-24(%rax), %rdx
 2463 0153 488B4598 		movq	-104(%rbp), %rax
 2464 0157 488D0C02 		leaq	(%rdx,%rax), %rcx
 2465 015b 488B5590 		movq	-112(%rbp), %rdx
 2466 015f 4889D0   		movq	%rdx, %rax
 2467 0162 4801C0   		addq	%rax, %rax
 2468 0165 4801D0   		addq	%rdx, %rax
 2469 0168 48C1E003 		salq	$3, %rax
 2470 016c 4889C2   		movq	%rax, %rdx
 2471 016f 488B4598 		movq	-104(%rbp), %rax
 2472 0173 4801D0   		addq	%rdx, %rax
 2473 0176 4889F2   		movq	%rsi, %rdx
 2474 0179 4889CE   		movq	%rcx, %rsi
 2475 017c 4889C7   		movq	%rax, %rdi
 2476 017f E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 2476      00
 2477 0184 89458C   		movl	%eax, -116(%rbp)
 2478 0187 837D8C00 		cmpl	$0, -116(%rbp)
 2479 018b 0F853F04 		jne	.L221
 2479      0000
1167:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MOD_MUL( c[i] );
 2480              		.loc 1 1167 9
 2481 0191 488B5590 		movq	-112(%rbp), %rdx
 2482 0195 4889D0   		movq	%rdx, %rax
 2483 0198 4801C0   		addq	%rax, %rax
 2484 019b 4801D0   		addq	%rdx, %rax
 2485 019e 48C1E003 		salq	$3, %rax
 2486 01a2 4889C2   		movq	%rax, %rdx
 2487 01a5 488B4598 		movq	-104(%rbp), %rax
 2488 01a9 4801C2   		addq	%rax, %rdx
 2489 01ac 488B8578 		movq	-136(%rbp), %rax
 2489      FFFFFF
 2490 01b3 4889C6   		movq	%rax, %rsi
 2491 01b6 4889D7   		movq	%rdx, %rdi
 2492 01b9 E8000000 		call	ecp_modp
 2492      00
 2493 01be 89458C   		movl	%eax, -116(%rbp)
 2494 01c1 837D8C00 		cmpl	$0, -116(%rbp)
 2495 01c5 0F850804 		jne	.L222
GAS LISTING /tmp/ccajKZL5.s 			page 72


 2495      0000
1164:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     for( i = 1; i < T_size; i++ )
 2496              		.loc 1 1164 30 discriminator 2
 2497 01cb 48834590 		addq	$1, -112(%rbp)
 2497      01
 2498              	.L194:
1164:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     for( i = 1; i < T_size; i++ )
 2499              		.loc 1 1164 5 discriminator 1
 2500 01d0 488B4590 		movq	-112(%rbp), %rax
 2501 01d4 483B8568 		cmpq	-152(%rbp), %rax
 2501      FFFFFF
 2502 01db 0F8240FF 		jb	.L197
 2502      FFFF
1168:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
1169:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1170:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
1171:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * u = 1 / (Z_0 * ... * Z_n) mod P
1172:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
1173:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_inv_mod( &u, &c[T_size-1], &grp->P ) );
 2503              		.loc 1 1173 5
 2504 01e1 488B8578 		movq	-136(%rbp), %rax
 2504      FFFFFF
 2505 01e8 488D7008 		leaq	8(%rax), %rsi
 2506 01ec 488B9568 		movq	-152(%rbp), %rdx
 2506      FFFFFF
 2507 01f3 4889D0   		movq	%rdx, %rax
 2508 01f6 4801C0   		addq	%rax, %rax
 2509 01f9 4801D0   		addq	%rdx, %rax
 2510 01fc 48C1E003 		salq	$3, %rax
 2511 0200 488D50E8 		leaq	-24(%rax), %rdx
 2512 0204 488B4598 		movq	-104(%rbp), %rax
 2513 0208 488D0C02 		leaq	(%rdx,%rax), %rcx
 2514 020c 488D45A0 		leaq	-96(%rbp), %rax
 2515 0210 4889F2   		movq	%rsi, %rdx
 2516 0213 4889CE   		movq	%rcx, %rsi
 2517 0216 4889C7   		movq	%rax, %rdi
 2518 0219 E8000000 		call	mbedtls_mpi_inv_mod@PLT
 2518      00
 2519 021e 89458C   		movl	%eax, -116(%rbp)
 2520 0221 837D8C00 		cmpl	$0, -116(%rbp)
 2521 0225 0F85AB03 		jne	.L223
 2521      0000
1174:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1175:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     for( i = T_size - 1; ; i-- )
 2522              		.loc 1 1175 12
 2523 022b 488B8568 		movq	-152(%rbp), %rax
 2523      FFFFFF
 2524 0232 4883E801 		subq	$1, %rax
 2525 0236 48894590 		movq	%rax, -112(%rbp)
 2526              	.L215:
1176:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
1177:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /*
1178:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          * Zi = 1 / Z_i mod p
1179:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          * u = 1 / (Z_0 * ... * Z_i) mod P
1180:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          */
1181:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( i == 0 ) {
 2527              		.loc 1 1181 11
GAS LISTING /tmp/ccajKZL5.s 			page 73


 2528 023a 48837D90 		cmpq	$0, -112(%rbp)
 2528      00
 2529 023f 7525     		jne	.L199
1182:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &Zi, &u ) );
 2530              		.loc 1 1182 13
 2531 0241 488D55A0 		leaq	-96(%rbp), %rdx
 2532 0245 488D45C0 		leaq	-64(%rbp), %rax
 2533 0249 4889D6   		movq	%rdx, %rsi
 2534 024c 4889C7   		movq	%rax, %rdi
 2535 024f E8000000 		call	mbedtls_mpi_copy@PLT
 2535      00
 2536 0254 89458C   		movl	%eax, -116(%rbp)
 2537 0257 837D8C00 		cmpl	$0, -116(%rbp)
 2538 025b 0F84C400 		je	.L200
 2538      0000
 2539 0261 E99E0300 		jmp	.L193
 2539      00
 2540              	.L199:
1183:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         }
1184:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         else
1185:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         {
1186:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &Zi, &u, &c[i-1]  ) ); MOD_MUL( Zi );
 2541              		.loc 1 1186 13
 2542 0266 488B5590 		movq	-112(%rbp), %rdx
 2543 026a 4889D0   		movq	%rdx, %rax
 2544 026d 4801C0   		addq	%rax, %rax
 2545 0270 4801D0   		addq	%rdx, %rax
 2546 0273 48C1E003 		salq	$3, %rax
 2547 0277 488D50E8 		leaq	-24(%rax), %rdx
 2548 027b 488B4598 		movq	-104(%rbp), %rax
 2549 027f 4801C2   		addq	%rax, %rdx
 2550 0282 488D4DA0 		leaq	-96(%rbp), %rcx
 2551 0286 488D45C0 		leaq	-64(%rbp), %rax
 2552 028a 4889CE   		movq	%rcx, %rsi
 2553 028d 4889C7   		movq	%rax, %rdi
 2554 0290 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 2554      00
 2555 0295 89458C   		movl	%eax, -116(%rbp)
 2556 0298 837D8C00 		cmpl	$0, -116(%rbp)
 2557 029c 0F853703 		jne	.L224
 2557      0000
 2558              		.loc 1 1186 74 discriminator 2
 2559 02a2 488B9578 		movq	-136(%rbp), %rdx
 2559      FFFFFF
 2560 02a9 488D45C0 		leaq	-64(%rbp), %rax
 2561 02ad 4889D6   		movq	%rdx, %rsi
 2562 02b0 4889C7   		movq	%rax, %rdi
 2563 02b3 E8000000 		call	ecp_modp
 2563      00
 2564 02b8 89458C   		movl	%eax, -116(%rbp)
 2565 02bb 837D8C00 		cmpl	$0, -116(%rbp)
 2566 02bf 0F851703 		jne	.L225
 2566      0000
1187:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &u,  &u, &T[i]->Z ) ); MOD_MUL( u );
 2567              		.loc 1 1187 13
 2568 02c5 488B4590 		movq	-112(%rbp), %rax
 2569 02c9 488D14C5 		leaq	0(,%rax,8), %rdx
GAS LISTING /tmp/ccajKZL5.s 			page 74


 2569      00000000 
 2570 02d1 488B8570 		movq	-144(%rbp), %rax
 2570      FFFFFF
 2571 02d8 4801D0   		addq	%rdx, %rax
 2572 02db 488B00   		movq	(%rax), %rax
 2573 02de 488D5030 		leaq	48(%rax), %rdx
 2574 02e2 488D4DA0 		leaq	-96(%rbp), %rcx
 2575 02e6 488D45A0 		leaq	-96(%rbp), %rax
 2576 02ea 4889CE   		movq	%rcx, %rsi
 2577 02ed 4889C7   		movq	%rax, %rdi
 2578 02f0 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 2578      00
 2579 02f5 89458C   		movl	%eax, -116(%rbp)
 2580 02f8 837D8C00 		cmpl	$0, -116(%rbp)
 2581 02fc 0F85DD02 		jne	.L226
 2581      0000
 2582              		.loc 1 1187 74 discriminator 2
 2583 0302 488B9578 		movq	-136(%rbp), %rdx
 2583      FFFFFF
 2584 0309 488D45A0 		leaq	-96(%rbp), %rax
 2585 030d 4889D6   		movq	%rdx, %rsi
 2586 0310 4889C7   		movq	%rax, %rdi
 2587 0313 E8000000 		call	ecp_modp
 2587      00
 2588 0318 89458C   		movl	%eax, -116(%rbp)
 2589 031b 837D8C00 		cmpl	$0, -116(%rbp)
 2590 031f 0F85BD02 		jne	.L227
 2590      0000
 2591              	.L200:
1188:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         }
1189:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1190:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /*
1191:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          * proceed as in normalize()
1192:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          */
1193:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &ZZi,     &Zi,      &Zi  ) ); MOD_MUL( ZZi );
 2592              		.loc 1 1193 9
 2593 0325 488D55C0 		leaq	-64(%rbp), %rdx
 2594 0329 488D4DC0 		leaq	-64(%rbp), %rcx
 2595 032d 488D45E0 		leaq	-32(%rbp), %rax
 2596 0331 4889CE   		movq	%rcx, %rsi
 2597 0334 4889C7   		movq	%rax, %rdi
 2598 0337 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 2598      00
 2599 033c 89458C   		movl	%eax, -116(%rbp)
 2600 033f 837D8C00 		cmpl	$0, -116(%rbp)
 2601 0343 0F859C02 		jne	.L228
 2601      0000
 2602              		.loc 1 1193 77 discriminator 2
 2603 0349 488B9578 		movq	-136(%rbp), %rdx
 2603      FFFFFF
 2604 0350 488D45E0 		leaq	-32(%rbp), %rax
 2605 0354 4889D6   		movq	%rdx, %rsi
 2606 0357 4889C7   		movq	%rax, %rdi
 2607 035a E8000000 		call	ecp_modp
 2607      00
 2608 035f 89458C   		movl	%eax, -116(%rbp)
 2609 0362 837D8C00 		cmpl	$0, -116(%rbp)
GAS LISTING /tmp/ccajKZL5.s 			page 75


 2610 0366 0F857C02 		jne	.L229
 2610      0000
1194:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T[i]->X, &T[i]->X, &ZZi ) ); MOD_MUL( T[i]->X );
 2611              		.loc 1 1194 9
 2612 036c 488B4590 		movq	-112(%rbp), %rax
 2613 0370 488D14C5 		leaq	0(,%rax,8), %rdx
 2613      00000000 
 2614 0378 488B8570 		movq	-144(%rbp), %rax
 2614      FFFFFF
 2615 037f 4801D0   		addq	%rdx, %rax
 2616 0382 488B00   		movq	(%rax), %rax
 2617 0385 4889C6   		movq	%rax, %rsi
 2618 0388 488B4590 		movq	-112(%rbp), %rax
 2619 038c 488D14C5 		leaq	0(,%rax,8), %rdx
 2619      00000000 
 2620 0394 488B8570 		movq	-144(%rbp), %rax
 2620      FFFFFF
 2621 039b 4801D0   		addq	%rdx, %rax
 2622 039e 488B00   		movq	(%rax), %rax
 2623 03a1 4889C1   		movq	%rax, %rcx
 2624 03a4 488D45E0 		leaq	-32(%rbp), %rax
 2625 03a8 4889C2   		movq	%rax, %rdx
 2626 03ab 4889CF   		movq	%rcx, %rdi
 2627 03ae E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 2627      00
 2628 03b3 89458C   		movl	%eax, -116(%rbp)
 2629 03b6 837D8C00 		cmpl	$0, -116(%rbp)
 2630 03ba 0F852B02 		jne	.L230
 2630      0000
 2631              		.loc 1 1194 77 discriminator 2
 2632 03c0 488B4590 		movq	-112(%rbp), %rax
 2633 03c4 488D14C5 		leaq	0(,%rax,8), %rdx
 2633      00000000 
 2634 03cc 488B8570 		movq	-144(%rbp), %rax
 2634      FFFFFF
 2635 03d3 4801D0   		addq	%rdx, %rax
 2636 03d6 488B00   		movq	(%rax), %rax
 2637 03d9 4889C2   		movq	%rax, %rdx
 2638 03dc 488B8578 		movq	-136(%rbp), %rax
 2638      FFFFFF
 2639 03e3 4889C6   		movq	%rax, %rsi
 2640 03e6 4889D7   		movq	%rdx, %rdi
 2641 03e9 E8000000 		call	ecp_modp
 2641      00
 2642 03ee 89458C   		movl	%eax, -116(%rbp)
 2643 03f1 837D8C00 		cmpl	$0, -116(%rbp)
 2644 03f5 0F85F301 		jne	.L231
 2644      0000
1195:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T[i]->Y, &T[i]->Y, &ZZi ) ); MOD_MUL( T[i]->Y );
 2645              		.loc 1 1195 9
 2646 03fb 488B4590 		movq	-112(%rbp), %rax
 2647 03ff 488D14C5 		leaq	0(,%rax,8), %rdx
 2647      00000000 
 2648 0407 488B8570 		movq	-144(%rbp), %rax
 2648      FFFFFF
 2649 040e 4801D0   		addq	%rdx, %rax
 2650 0411 488B00   		movq	(%rax), %rax
GAS LISTING /tmp/ccajKZL5.s 			page 76


 2651 0414 488D7018 		leaq	24(%rax), %rsi
 2652 0418 488B4590 		movq	-112(%rbp), %rax
 2653 041c 488D14C5 		leaq	0(,%rax,8), %rdx
 2653      00000000 
 2654 0424 488B8570 		movq	-144(%rbp), %rax
 2654      FFFFFF
 2655 042b 4801D0   		addq	%rdx, %rax
 2656 042e 488B00   		movq	(%rax), %rax
 2657 0431 488D4818 		leaq	24(%rax), %rcx
 2658 0435 488D45E0 		leaq	-32(%rbp), %rax
 2659 0439 4889C2   		movq	%rax, %rdx
 2660 043c 4889CF   		movq	%rcx, %rdi
 2661 043f E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 2661      00
 2662 0444 89458C   		movl	%eax, -116(%rbp)
 2663 0447 837D8C00 		cmpl	$0, -116(%rbp)
 2664 044b 0F85A001 		jne	.L232
 2664      0000
 2665              		.loc 1 1195 77 discriminator 2
 2666 0451 488B4590 		movq	-112(%rbp), %rax
 2667 0455 488D14C5 		leaq	0(,%rax,8), %rdx
 2667      00000000 
 2668 045d 488B8570 		movq	-144(%rbp), %rax
 2668      FFFFFF
 2669 0464 4801D0   		addq	%rdx, %rax
 2670 0467 488B00   		movq	(%rax), %rax
 2671 046a 488D5018 		leaq	24(%rax), %rdx
 2672 046e 488B8578 		movq	-136(%rbp), %rax
 2672      FFFFFF
 2673 0475 4889C6   		movq	%rax, %rsi
 2674 0478 4889D7   		movq	%rdx, %rdi
 2675 047b E8000000 		call	ecp_modp
 2675      00
 2676 0480 89458C   		movl	%eax, -116(%rbp)
 2677 0483 837D8C00 		cmpl	$0, -116(%rbp)
 2678 0487 0F856701 		jne	.L233
 2678      0000
1196:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T[i]->Y, &T[i]->Y, &Zi  ) ); MOD_MUL( T[i]->Y );
 2679              		.loc 1 1196 9
 2680 048d 488B4590 		movq	-112(%rbp), %rax
 2681 0491 488D14C5 		leaq	0(,%rax,8), %rdx
 2681      00000000 
 2682 0499 488B8570 		movq	-144(%rbp), %rax
 2682      FFFFFF
 2683 04a0 4801D0   		addq	%rdx, %rax
 2684 04a3 488B00   		movq	(%rax), %rax
 2685 04a6 488D7018 		leaq	24(%rax), %rsi
 2686 04aa 488B4590 		movq	-112(%rbp), %rax
 2687 04ae 488D14C5 		leaq	0(,%rax,8), %rdx
 2687      00000000 
 2688 04b6 488B8570 		movq	-144(%rbp), %rax
 2688      FFFFFF
 2689 04bd 4801D0   		addq	%rdx, %rax
 2690 04c0 488B00   		movq	(%rax), %rax
 2691 04c3 488D4818 		leaq	24(%rax), %rcx
 2692 04c7 488D45C0 		leaq	-64(%rbp), %rax
 2693 04cb 4889C2   		movq	%rax, %rdx
GAS LISTING /tmp/ccajKZL5.s 			page 77


 2694 04ce 4889CF   		movq	%rcx, %rdi
 2695 04d1 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 2695      00
 2696 04d6 89458C   		movl	%eax, -116(%rbp)
 2697 04d9 837D8C00 		cmpl	$0, -116(%rbp)
 2698 04dd 0F851401 		jne	.L234
 2698      0000
 2699              		.loc 1 1196 77 discriminator 2
 2700 04e3 488B4590 		movq	-112(%rbp), %rax
 2701 04e7 488D14C5 		leaq	0(,%rax,8), %rdx
 2701      00000000 
 2702 04ef 488B8570 		movq	-144(%rbp), %rax
 2702      FFFFFF
 2703 04f6 4801D0   		addq	%rdx, %rax
 2704 04f9 488B00   		movq	(%rax), %rax
 2705 04fc 488D5018 		leaq	24(%rax), %rdx
 2706 0500 488B8578 		movq	-136(%rbp), %rax
 2706      FFFFFF
 2707 0507 4889C6   		movq	%rax, %rsi
 2708 050a 4889D7   		movq	%rdx, %rdi
 2709 050d E8000000 		call	ecp_modp
 2709      00
 2710 0512 89458C   		movl	%eax, -116(%rbp)
 2711 0515 837D8C00 		cmpl	$0, -116(%rbp)
 2712 0519 0F85DB00 		jne	.L235
 2712      0000
1197:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1198:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /*
1199:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          * Post-precessing: reclaim some memory by shrinking coordinates
1200:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          * - not storing Z (always 1)
1201:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          * - shrinking other coordinates, but still keeping the same number of
1202:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          *   limbs as P, as otherwise it will too likely be regrown too fast.
1203:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          */
1204:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_shrink( &T[i]->X, grp->P.n ) );
 2713              		.loc 1 1204 9
 2714 051f 488B8578 		movq	-136(%rbp), %rax
 2714      FFFFFF
 2715 0526 488B4010 		movq	16(%rax), %rax
 2716 052a 488B5590 		movq	-112(%rbp), %rdx
 2717 052e 488D0CD5 		leaq	0(,%rdx,8), %rcx
 2717      00000000 
 2718 0536 488B9570 		movq	-144(%rbp), %rdx
 2718      FFFFFF
 2719 053d 4801CA   		addq	%rcx, %rdx
 2720 0540 488B12   		movq	(%rdx), %rdx
 2721 0543 4889C6   		movq	%rax, %rsi
 2722 0546 4889D7   		movq	%rdx, %rdi
 2723 0549 E8000000 		call	mbedtls_mpi_shrink@PLT
 2723      00
 2724 054e 89458C   		movl	%eax, -116(%rbp)
 2725 0551 837D8C00 		cmpl	$0, -116(%rbp)
 2726 0555 0F85A200 		jne	.L236
 2726      0000
1205:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_shrink( &T[i]->Y, grp->P.n ) );
 2727              		.loc 1 1205 9
 2728 055b 488B8578 		movq	-136(%rbp), %rax
 2728      FFFFFF
GAS LISTING /tmp/ccajKZL5.s 			page 78


 2729 0562 488B4010 		movq	16(%rax), %rax
 2730 0566 488B5590 		movq	-112(%rbp), %rdx
 2731 056a 488D0CD5 		leaq	0(,%rdx,8), %rcx
 2731      00000000 
 2732 0572 488B9570 		movq	-144(%rbp), %rdx
 2732      FFFFFF
 2733 0579 4801CA   		addq	%rcx, %rdx
 2734 057c 488B12   		movq	(%rdx), %rdx
 2735 057f 4883C218 		addq	$24, %rdx
 2736 0583 4889C6   		movq	%rax, %rsi
 2737 0586 4889D7   		movq	%rdx, %rdi
 2738 0589 E8000000 		call	mbedtls_mpi_shrink@PLT
 2738      00
 2739 058e 89458C   		movl	%eax, -116(%rbp)
 2740 0591 837D8C00 		cmpl	$0, -116(%rbp)
 2741 0595 7569     		jne	.L237
1206:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_free( &T[i]->Z );
 2742              		.loc 1 1206 29
 2743 0597 488B4590 		movq	-112(%rbp), %rax
 2744 059b 488D14C5 		leaq	0(,%rax,8), %rdx
 2744      00000000 
 2745 05a3 488B8570 		movq	-144(%rbp), %rax
 2745      FFFFFF
 2746 05aa 4801D0   		addq	%rdx, %rax
 2747 05ad 488B00   		movq	(%rax), %rax
 2748              		.loc 1 1206 9
 2749 05b0 4883C030 		addq	$48, %rax
 2750 05b4 4889C7   		movq	%rax, %rdi
 2751 05b7 E8000000 		call	mbedtls_mpi_free@PLT
 2751      00
1207:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1208:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( i == 0 )
 2752              		.loc 1 1208 11
 2753 05bc 48837D90 		cmpq	$0, -112(%rbp)
 2753      00
 2754 05c1 7440     		je	.L238
1175:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 2755              		.loc 1 1175 29
 2756 05c3 48836D90 		subq	$1, -112(%rbp)
 2756      01
1181:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &Zi, &u ) );
 2757              		.loc 1 1181 11
 2758 05c8 E96DFCFF 		jmp	.L215
 2758      FF
 2759              	.L220:
1163:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     for( i = 1; i < T_size; i++ )
 2760              		.loc 1 1163 5
 2761 05cd 90       		nop
 2762 05ce EB34     		jmp	.L193
 2763              	.L221:
1166:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MOD_MUL( c[i] );
 2764              		.loc 1 1166 9
 2765 05d0 90       		nop
 2766 05d1 EB31     		jmp	.L193
 2767              	.L222:
1167:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 2768              		.loc 1 1167 9
GAS LISTING /tmp/ccajKZL5.s 			page 79


 2769 05d3 90       		nop
 2770 05d4 EB2E     		jmp	.L193
 2771              	.L223:
1173:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 2772              		.loc 1 1173 5
 2773 05d6 90       		nop
 2774 05d7 EB2B     		jmp	.L193
 2775              	.L224:
1186:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &u,  &u, &T[i]->Z ) ); MOD_MUL( u );
 2776              		.loc 1 1186 13
 2777 05d9 90       		nop
 2778 05da EB28     		jmp	.L193
 2779              	.L225:
1186:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &u,  &u, &T[i]->Z ) ); MOD_MUL( u );
 2780              		.loc 1 1186 74
 2781 05dc 90       		nop
 2782 05dd EB25     		jmp	.L193
 2783              	.L226:
1187:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         }
 2784              		.loc 1 1187 13
 2785 05df 90       		nop
 2786 05e0 EB22     		jmp	.L193
 2787              	.L227:
1187:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         }
 2788              		.loc 1 1187 74
 2789 05e2 90       		nop
 2790 05e3 EB1F     		jmp	.L193
 2791              	.L228:
1193:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T[i]->X, &T[i]->X, &ZZi ) ); MOD_MUL( T[i]->X );
 2792              		.loc 1 1193 9
 2793 05e5 90       		nop
 2794 05e6 EB1C     		jmp	.L193
 2795              	.L229:
1193:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T[i]->X, &T[i]->X, &ZZi ) ); MOD_MUL( T[i]->X );
 2796              		.loc 1 1193 77
 2797 05e8 90       		nop
 2798 05e9 EB19     		jmp	.L193
 2799              	.L230:
1194:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T[i]->Y, &T[i]->Y, &ZZi ) ); MOD_MUL( T[i]->Y );
 2800              		.loc 1 1194 9
 2801 05eb 90       		nop
 2802 05ec EB16     		jmp	.L193
 2803              	.L231:
1194:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T[i]->Y, &T[i]->Y, &ZZi ) ); MOD_MUL( T[i]->Y );
 2804              		.loc 1 1194 77
 2805 05ee 90       		nop
 2806 05ef EB13     		jmp	.L193
 2807              	.L232:
1195:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T[i]->Y, &T[i]->Y, &Zi  ) ); MOD_MUL( T[i]->Y );
 2808              		.loc 1 1195 9
 2809 05f1 90       		nop
 2810 05f2 EB10     		jmp	.L193
 2811              	.L233:
1195:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T[i]->Y, &T[i]->Y, &Zi  ) ); MOD_MUL( T[i]->Y );
 2812              		.loc 1 1195 77
 2813 05f4 90       		nop
 2814 05f5 EB0D     		jmp	.L193
GAS LISTING /tmp/ccajKZL5.s 			page 80


 2815              	.L234:
1196:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 2816              		.loc 1 1196 9
 2817 05f7 90       		nop
 2818 05f8 EB0A     		jmp	.L193
 2819              	.L235:
1196:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 2820              		.loc 1 1196 77
 2821 05fa 90       		nop
 2822 05fb EB07     		jmp	.L193
 2823              	.L236:
1204:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_shrink( &T[i]->Y, grp->P.n ) );
 2824              		.loc 1 1204 9
 2825 05fd 90       		nop
 2826 05fe EB04     		jmp	.L193
 2827              	.L237:
1205:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_free( &T[i]->Z );
 2828              		.loc 1 1205 9
 2829 0600 90       		nop
 2830 0601 EB01     		jmp	.L193
 2831              	.L238:
1209:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             break;
 2832              		.loc 1 1209 13
 2833 0603 90       		nop
 2834              	.L193:
1210:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
1211:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1212:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
1213:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1214:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_free( &u ); mbedtls_mpi_free( &Zi ); mbedtls_mpi_free( &ZZi );
 2835              		.loc 1 1214 5
 2836 0604 488D45A0 		leaq	-96(%rbp), %rax
 2837 0608 4889C7   		movq	%rax, %rdi
 2838 060b E8000000 		call	mbedtls_mpi_free@PLT
 2838      00
 2839              		.loc 1 1214 29
 2840 0610 488D45C0 		leaq	-64(%rbp), %rax
 2841 0614 4889C7   		movq	%rax, %rdi
 2842 0617 E8000000 		call	mbedtls_mpi_free@PLT
 2842      00
 2843              		.loc 1 1214 54
 2844 061c 488D45E0 		leaq	-32(%rbp), %rax
 2845 0620 4889C7   		movq	%rax, %rdi
 2846 0623 E8000000 		call	mbedtls_mpi_free@PLT
 2846      00
1215:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     for( i = 0; i < T_size; i++ )
 2847              		.loc 1 1215 12
 2848 0628 48C74590 		movq	$0, -112(%rbp)
 2848      00000000 
 2849              		.loc 1 1215 5
 2850 0630 EB28     		jmp	.L216
 2851              	.L217:
1216:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_free( &c[i] );
 2852              		.loc 1 1216 29 discriminator 3
 2853 0632 488B5590 		movq	-112(%rbp), %rdx
 2854 0636 4889D0   		movq	%rdx, %rax
 2855 0639 4801C0   		addq	%rax, %rax
GAS LISTING /tmp/ccajKZL5.s 			page 81


 2856 063c 4801D0   		addq	%rdx, %rax
 2857 063f 48C1E003 		salq	$3, %rax
 2858 0643 4889C2   		movq	%rax, %rdx
 2859              		.loc 1 1216 9 discriminator 3
 2860 0646 488B4598 		movq	-104(%rbp), %rax
 2861 064a 4801D0   		addq	%rdx, %rax
 2862 064d 4889C7   		movq	%rax, %rdi
 2863 0650 E8000000 		call	mbedtls_mpi_free@PLT
 2863      00
1215:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     for( i = 0; i < T_size; i++ )
 2864              		.loc 1 1215 30 discriminator 3
 2865 0655 48834590 		addq	$1, -112(%rbp)
 2865      01
 2866              	.L216:
1215:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     for( i = 0; i < T_size; i++ )
 2867              		.loc 1 1215 5 discriminator 1
 2868 065a 488B4590 		movq	-112(%rbp), %rax
 2869 065e 483B8568 		cmpq	-152(%rbp), %rax
 2869      FFFFFF
 2870 0665 72CB     		jb	.L217
1217:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_free( c );
 2871              		.loc 1 1217 5
 2872 0667 488B4598 		movq	-104(%rbp), %rax
 2873 066b 4889C7   		movq	%rax, %rdi
 2874 066e E8000000 		call	mbedtls_free@PLT
 2874      00
1218:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1219:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 2875              		.loc 1 1219 11
 2876 0673 8B458C   		movl	-116(%rbp), %eax
 2877              	.L218:
1220:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 2878              		.loc 1 1220 1 discriminator 1
 2879 0676 488B4DF8 		movq	-8(%rbp), %rcx
 2880 067a 6448330C 		xorq	%fs:40, %rcx
 2880      25280000 
 2880      00
 2881 0683 7405     		je	.L219
 2882              		.loc 1 1220 1 is_stmt 0
 2883 0685 E8000000 		call	__stack_chk_fail@PLT
 2883      00
 2884              	.L219:
 2885 068a C9       		leave
 2886              	.LCFI83:
 2887              		.cfi_def_cfa 7, 8
 2888 068b C3       		ret
 2889              		.cfi_endproc
 2890              	.LFE33:
 2892              		.section	.text.ecp_safe_invert_jac,"ax",@progbits
 2894              	ecp_safe_invert_jac:
 2895              	.LFB34:
1221:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1222:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
1223:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Conditional point inversion: Q -> -Q = (Q.X, -Q.Y, Q.Z) without leak.
1224:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * "inv" must be 0 (don't invert) or 1 (invert) or the result will be invalid
1225:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
1226:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static int ecp_safe_invert_jac( const mbedtls_ecp_group *grp,
GAS LISTING /tmp/ccajKZL5.s 			page 82


1227:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                             mbedtls_ecp_point *Q,
1228:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                             unsigned char inv )
1229:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 2896              		.loc 1 1229 1 is_stmt 1
 2897              		.cfi_startproc
 2898 0000 F30F1EFA 		endbr64
 2899 0004 55       		pushq	%rbp
 2900              	.LCFI84:
 2901              		.cfi_def_cfa_offset 16
 2902              		.cfi_offset 6, -16
 2903 0005 4889E5   		movq	%rsp, %rbp
 2904              	.LCFI85:
 2905              		.cfi_def_cfa_register 6
 2906 0008 4883EC50 		subq	$80, %rsp
 2907 000c 48897DC8 		movq	%rdi, -56(%rbp)
 2908 0010 488975C0 		movq	%rsi, -64(%rbp)
 2909 0014 89D0     		movl	%edx, %eax
 2910 0016 8845BC   		movb	%al, -68(%rbp)
 2911              		.loc 1 1229 1
 2912 0019 64488B04 		movq	%fs:40, %rax
 2912      25280000 
 2912      00
 2913 0022 488945F8 		movq	%rax, -8(%rbp)
 2914 0026 31C0     		xorl	%eax, %eax
1230:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
1231:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     unsigned char nonzero;
1232:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi mQY;
1233:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1234:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_init( &mQY );
 2915              		.loc 1 1234 5
 2916 0028 488D45E0 		leaq	-32(%rbp), %rax
 2917 002c 4889C7   		movq	%rax, %rdi
 2918 002f E8000000 		call	mbedtls_mpi_init@PLT
 2918      00
1235:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1236:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Use the fact that -Q.Y mod P = P - Q.Y unless Q.Y == 0 */
1237:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &mQY, &grp->P, &Q->Y ) );
 2919              		.loc 1 1237 5
 2920 0034 488B45C0 		movq	-64(%rbp), %rax
 2921 0038 488D5018 		leaq	24(%rax), %rdx
 2922 003c 488B45C8 		movq	-56(%rbp), %rax
 2923 0040 488D4808 		leaq	8(%rax), %rcx
 2924 0044 488D45E0 		leaq	-32(%rbp), %rax
 2925 0048 4889CE   		movq	%rcx, %rsi
 2926 004b 4889C7   		movq	%rax, %rdi
 2927 004e E8000000 		call	mbedtls_mpi_sub_mpi@PLT
 2927      00
 2928 0053 8945DC   		movl	%eax, -36(%rbp)
 2929 0056 837DDC00 		cmpl	$0, -36(%rbp)
 2930 005a 7547     		jne	.L244
1238:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     nonzero = mbedtls_mpi_cmp_int( &Q->Y, 0 ) != 0;
 2931              		.loc 1 1238 36
 2932 005c 488B45C0 		movq	-64(%rbp), %rax
 2933 0060 4883C018 		addq	$24, %rax
 2934              		.loc 1 1238 15
 2935 0064 BE000000 		movl	$0, %esi
 2935      00
GAS LISTING /tmp/ccajKZL5.s 			page 83


 2936 0069 4889C7   		movq	%rax, %rdi
 2937 006c E8000000 		call	mbedtls_mpi_cmp_int@PLT
 2937      00
 2938              		.loc 1 1238 47
 2939 0071 85C0     		testl	%eax, %eax
 2940 0073 0F95C0   		setne	%al
 2941              		.loc 1 1238 13
 2942 0076 8845DB   		movb	%al, -37(%rbp)
1239:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_safe_cond_assign( &Q->Y, &mQY, inv & nonzero ) );
 2943              		.loc 1 1239 5
 2944 0079 0FB645BC 		movzbl	-68(%rbp), %eax
 2945 007d 2245DB   		andb	-37(%rbp), %al
 2946 0080 0FB6D0   		movzbl	%al, %edx
 2947 0083 488B45C0 		movq	-64(%rbp), %rax
 2948 0087 488D4818 		leaq	24(%rax), %rcx
 2949 008b 488D45E0 		leaq	-32(%rbp), %rax
 2950 008f 4889C6   		movq	%rax, %rsi
 2951 0092 4889CF   		movq	%rcx, %rdi
 2952 0095 E8000000 		call	mbedtls_mpi_safe_cond_assign@PLT
 2952      00
 2953 009a 8945DC   		movl	%eax, -36(%rbp)
 2954 009d 837DDC00 		cmpl	$0, -36(%rbp)
1240:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1241:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
 2955              		.loc 1 1241 1
 2956 00a1 EB01     		jmp	.L241
 2957              	.L244:
1237:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     nonzero = mbedtls_mpi_cmp_int( &Q->Y, 0 ) != 0;
 2958              		.loc 1 1237 5
 2959 00a3 90       		nop
 2960              	.L241:
1242:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_free( &mQY );
 2961              		.loc 1 1242 5
 2962 00a4 488D45E0 		leaq	-32(%rbp), %rax
 2963 00a8 4889C7   		movq	%rax, %rdi
 2964 00ab E8000000 		call	mbedtls_mpi_free@PLT
 2964      00
1243:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1244:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 2965              		.loc 1 1244 11
 2966 00b0 8B45DC   		movl	-36(%rbp), %eax
1245:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 2967              		.loc 1 1245 1
 2968 00b3 488B4DF8 		movq	-8(%rbp), %rcx
 2969 00b7 6448330C 		xorq	%fs:40, %rcx
 2969      25280000 
 2969      00
 2970 00c0 7405     		je	.L243
 2971 00c2 E8000000 		call	__stack_chk_fail@PLT
 2971      00
 2972              	.L243:
 2973 00c7 C9       		leave
 2974              	.LCFI86:
 2975              		.cfi_def_cfa 7, 8
 2976 00c8 C3       		ret
 2977              		.cfi_endproc
 2978              	.LFE34:
GAS LISTING /tmp/ccajKZL5.s 			page 84


 2980              		.section	.text.ecp_double_jac,"ax",@progbits
 2982              	ecp_double_jac:
 2983              	.LFB35:
1246:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1247:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
1248:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Point doubling R = 2 P, Jacobian coordinates
1249:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1250:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Based on http://www.hyperelliptic.org/EFD/g1p/auto-shortw-jacobian.html#doubling-dbl-1998-cmo-2 
1251:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1252:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * We follow the variable naming fairly closely. The formula variations that trade a MUL for a SQR
1253:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * (plus a few ADDs) aren't useful as our bignum implementation doesn't distinguish squaring.
1254:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1255:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Standard optimizations are applied when curve parameter A is one of { 0, -3 }.
1256:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1257:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Cost: 1D := 3M + 4S          (A ==  0)
1258:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *             4M + 4S          (A == -3)
1259:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *             3M + 6S + 1a     otherwise
1260:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
1261:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static int ecp_double_jac( const mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
1262:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                            const mbedtls_ecp_point *P )
1263:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 2984              		.loc 1 1263 1
 2985              		.cfi_startproc
 2986 0000 F30F1EFA 		endbr64
 2987 0004 55       		pushq	%rbp
 2988              	.LCFI87:
 2989              		.cfi_def_cfa_offset 16
 2990              		.cfi_offset 6, -16
 2991 0005 4889E5   		movq	%rsp, %rbp
 2992              	.LCFI88:
 2993              		.cfi_def_cfa_register 6
 2994 0008 4881ECB0 		subq	$176, %rsp
 2994      000000
 2995 000f 4889BD68 		movq	%rdi, -152(%rbp)
 2995      FFFFFF
 2996 0016 4889B560 		movq	%rsi, -160(%rbp)
 2996      FFFFFF
 2997 001d 48899558 		movq	%rdx, -168(%rbp)
 2997      FFFFFF
 2998              		.loc 1 1263 1
 2999 0024 64488B04 		movq	%fs:40, %rax
 2999      25280000 
 2999      00
 3000 002d 488945F8 		movq	%rax, -8(%rbp)
 3001 0031 31C0     		xorl	%eax, %eax
1264:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
1265:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi M, S, T, U;
1266:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1267:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_SELF_TEST)
1268:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     dbl_count++;
1269:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
1270:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1271:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_DOUBLE_JAC_ALT)
1272:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( mbedtls_internal_ecp_grp_capable( grp ) )
1273:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( mbedtls_internal_ecp_double_jac( grp, R, P ) );
1274:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif /* MBEDTLS_ECP_DOUBLE_JAC_ALT */
1275:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
GAS LISTING /tmp/ccajKZL5.s 			page 85


1276:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_init( &M ); mbedtls_mpi_init( &S ); mbedtls_mpi_init( &T ); mbedtls_mpi_init( &U );
 3002              		.loc 1 1276 5
 3003 0033 488D4580 		leaq	-128(%rbp), %rax
 3004 0037 4889C7   		movq	%rax, %rdi
 3005 003a E8000000 		call	mbedtls_mpi_init@PLT
 3005      00
 3006              		.loc 1 1276 29
 3007 003f 488D45A0 		leaq	-96(%rbp), %rax
 3008 0043 4889C7   		movq	%rax, %rdi
 3009 0046 E8000000 		call	mbedtls_mpi_init@PLT
 3009      00
 3010              		.loc 1 1276 53
 3011 004b 488D45C0 		leaq	-64(%rbp), %rax
 3012 004f 4889C7   		movq	%rax, %rdi
 3013 0052 E8000000 		call	mbedtls_mpi_init@PLT
 3013      00
 3014              		.loc 1 1276 77
 3015 0057 488D45E0 		leaq	-32(%rbp), %rax
 3016 005b 4889C7   		movq	%rax, %rdi
 3017 005e E8000000 		call	mbedtls_mpi_init@PLT
 3017      00
1277:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1278:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Special case for A = -3 */
1279:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( grp->A.p == NULL )
 3018              		.loc 1 1279 15
 3019 0063 488B8568 		movq	-152(%rbp), %rax
 3019      FFFFFF
 3020 006a 488B4030 		movq	48(%rax), %rax
 3021              		.loc 1 1279 7
 3022 006e 4885C0   		testq	%rax, %rax
 3023 0071 0F852F02 		jne	.L246
 3023      0000
1280:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
1281:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* M = 3(X + Z^2)(X - Z^2) */
1282:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &S,  &P->Z,  &P->Z   ) ); MOD_MUL( S );
 3024              		.loc 1 1282 9
 3025 0077 488B8558 		movq	-168(%rbp), %rax
 3025      FFFFFF
 3026 007e 488D5030 		leaq	48(%rax), %rdx
 3027 0082 488B8558 		movq	-168(%rbp), %rax
 3027      FFFFFF
 3028 0089 488D4830 		leaq	48(%rax), %rcx
 3029 008d 488D45A0 		leaq	-96(%rbp), %rax
 3030 0091 4889CE   		movq	%rcx, %rsi
 3031 0094 4889C7   		movq	%rax, %rdi
 3032 0097 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 3032      00
 3033 009c 89857CFF 		movl	%eax, -132(%rbp)
 3033      FFFF
 3034 00a2 83BD7CFF 		cmpl	$0, -132(%rbp)
 3034      FFFF00
 3035 00a9 0F85C00A 		jne	.L321
 3035      0000
 3036              		.loc 1 1282 73 discriminator 2
 3037 00af 488B9568 		movq	-152(%rbp), %rdx
 3037      FFFFFF
 3038 00b6 488D45A0 		leaq	-96(%rbp), %rax
GAS LISTING /tmp/ccajKZL5.s 			page 86


 3039 00ba 4889D6   		movq	%rdx, %rsi
 3040 00bd 4889C7   		movq	%rax, %rdi
 3041 00c0 E8000000 		call	ecp_modp
 3041      00
 3042 00c5 89857CFF 		movl	%eax, -132(%rbp)
 3042      FFFF
 3043 00cb 83BD7CFF 		cmpl	$0, -132(%rbp)
 3043      FFFF00
 3044 00d2 0F859D0A 		jne	.L322
 3044      0000
1283:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( &T,  &P->X,  &S      ) ); MOD_ADD( T );
 3045              		.loc 1 1283 9
 3046 00d8 488B8D58 		movq	-168(%rbp), %rcx
 3046      FFFFFF
 3047 00df 488D55A0 		leaq	-96(%rbp), %rdx
 3048 00e3 488D45C0 		leaq	-64(%rbp), %rax
 3049 00e7 4889CE   		movq	%rcx, %rsi
 3050 00ea 4889C7   		movq	%rax, %rdi
 3051 00ed E8000000 		call	mbedtls_mpi_add_mpi@PLT
 3051      00
 3052 00f2 89857CFF 		movl	%eax, -132(%rbp)
 3052      FFFF
 3053 00f8 83BD7CFF 		cmpl	$0, -132(%rbp)
 3053      FFFF00
 3054 00ff 0F85760A 		jne	.L323
 3054      0000
 3055              		.loc 1 1283 73
 3056 0105 EB31     		jmp	.L251
 3057              	.L252:
 3058              		.loc 1 1283 73 is_stmt 0 discriminator 4
 3059 0107 488B8568 		movq	-152(%rbp), %rax
 3059      FFFFFF
 3060 010e 488D5008 		leaq	8(%rax), %rdx
 3061 0112 488D4DC0 		leaq	-64(%rbp), %rcx
 3062 0116 488D45C0 		leaq	-64(%rbp), %rax
 3063 011a 4889CE   		movq	%rcx, %rsi
 3064 011d 4889C7   		movq	%rax, %rdi
 3065 0120 E8000000 		call	mbedtls_mpi_sub_abs@PLT
 3065      00
 3066 0125 89857CFF 		movl	%eax, -132(%rbp)
 3066      FFFF
 3067 012b 83BD7CFF 		cmpl	$0, -132(%rbp)
 3067      FFFF00
 3068 0132 0F85490A 		jne	.L324
 3068      0000
 3069              	.L251:
 3070              		.loc 1 1283 73 discriminator 3
 3071 0138 488B8568 		movq	-152(%rbp), %rax
 3071      FFFFFF
 3072 013f 488D5008 		leaq	8(%rax), %rdx
 3073 0143 488D45C0 		leaq	-64(%rbp), %rax
 3074 0147 4889D6   		movq	%rdx, %rsi
 3075 014a 4889C7   		movq	%rax, %rdi
 3076 014d E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 3076      00
 3077 0152 85C0     		testl	%eax, %eax
 3078 0154 79B1     		jns	.L252
GAS LISTING /tmp/ccajKZL5.s 			page 87


1284:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &U,  &P->X,  &S      ) ); MOD_SUB( U );
 3079              		.loc 1 1284 9 is_stmt 1
 3080 0156 488B8D58 		movq	-168(%rbp), %rcx
 3080      FFFFFF
 3081 015d 488D55A0 		leaq	-96(%rbp), %rdx
 3082 0161 488D45E0 		leaq	-32(%rbp), %rax
 3083 0165 4889CE   		movq	%rcx, %rsi
 3084 0168 4889C7   		movq	%rax, %rdi
 3085 016b E8000000 		call	mbedtls_mpi_sub_mpi@PLT
 3085      00
 3086 0170 89857CFF 		movl	%eax, -132(%rbp)
 3086      FFFF
 3087 0176 83BD7CFF 		cmpl	$0, -132(%rbp)
 3087      FFFF00
 3088 017d 0F85040A 		jne	.L325
 3088      0000
 3089              		.loc 1 1284 73
 3090 0183 EB31     		jmp	.L254
 3091              	.L256:
 3092              		.loc 1 1284 73 is_stmt 0 discriminator 5
 3093 0185 488B8568 		movq	-152(%rbp), %rax
 3093      FFFFFF
 3094 018c 488D5008 		leaq	8(%rax), %rdx
 3095 0190 488D4DE0 		leaq	-32(%rbp), %rcx
 3096 0194 488D45E0 		leaq	-32(%rbp), %rax
 3097 0198 4889CE   		movq	%rcx, %rsi
 3098 019b 4889C7   		movq	%rax, %rdi
 3099 019e E8000000 		call	mbedtls_mpi_add_mpi@PLT
 3099      00
 3100 01a3 89857CFF 		movl	%eax, -132(%rbp)
 3100      FFFF
 3101 01a9 83BD7CFF 		cmpl	$0, -132(%rbp)
 3101      FFFF00
 3102 01b0 0F85D709 		jne	.L326
 3102      0000
 3103              	.L254:
 3104              		.loc 1 1284 73 discriminator 3
 3105 01b6 8B45E0   		movl	-32(%rbp), %eax
 3106 01b9 85C0     		testl	%eax, %eax
 3107 01bb 7915     		jns	.L255
 3108              		.loc 1 1284 73 discriminator 4
 3109 01bd 488D45E0 		leaq	-32(%rbp), %rax
 3110 01c1 BE000000 		movl	$0, %esi
 3110      00
 3111 01c6 4889C7   		movq	%rax, %rdi
 3112 01c9 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 3112      00
 3113 01ce 85C0     		testl	%eax, %eax
 3114 01d0 75B3     		jne	.L256
 3115              	.L255:
1285:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &S,  &T,     &U      ) ); MOD_MUL( S );
 3116              		.loc 1 1285 9 is_stmt 1
 3117 01d2 488D55E0 		leaq	-32(%rbp), %rdx
 3118 01d6 488D4DC0 		leaq	-64(%rbp), %rcx
 3119 01da 488D45A0 		leaq	-96(%rbp), %rax
 3120 01de 4889CE   		movq	%rcx, %rsi
 3121 01e1 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/ccajKZL5.s 			page 88


 3122 01e4 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 3122      00
 3123 01e9 89857CFF 		movl	%eax, -132(%rbp)
 3123      FFFF
 3124 01ef 83BD7CFF 		cmpl	$0, -132(%rbp)
 3124      FFFF00
 3125 01f6 0F859709 		jne	.L327
 3125      0000
 3126              		.loc 1 1285 73 discriminator 2
 3127 01fc 488B9568 		movq	-152(%rbp), %rdx
 3127      FFFFFF
 3128 0203 488D45A0 		leaq	-96(%rbp), %rax
 3129 0207 4889D6   		movq	%rdx, %rsi
 3130 020a 4889C7   		movq	%rax, %rdi
 3131 020d E8000000 		call	ecp_modp
 3131      00
 3132 0212 89857CFF 		movl	%eax, -132(%rbp)
 3132      FFFF
 3133 0218 83BD7CFF 		cmpl	$0, -132(%rbp)
 3133      FFFF00
 3134 021f 0F857409 		jne	.L328
 3134      0000
1286:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_int( &M,  &S,     3       ) ); MOD_ADD( M );
 3135              		.loc 1 1286 9
 3136 0225 488D4DA0 		leaq	-96(%rbp), %rcx
 3137 0229 488D4580 		leaq	-128(%rbp), %rax
 3138 022d BA030000 		movl	$3, %edx
 3138      00
 3139 0232 4889CE   		movq	%rcx, %rsi
 3140 0235 4889C7   		movq	%rax, %rdi
 3141 0238 E8000000 		call	mbedtls_mpi_mul_int@PLT
 3141      00
 3142 023d 89857CFF 		movl	%eax, -132(%rbp)
 3142      FFFF
 3143 0243 83BD7CFF 		cmpl	$0, -132(%rbp)
 3143      FFFF00
 3144 024a 0F854F09 		jne	.L329
 3144      0000
 3145              		.loc 1 1286 73
 3146 0250 EB31     		jmp	.L260
 3147              	.L261:
 3148              		.loc 1 1286 73 is_stmt 0 discriminator 4
 3149 0252 488B8568 		movq	-152(%rbp), %rax
 3149      FFFFFF
 3150 0259 488D5008 		leaq	8(%rax), %rdx
 3151 025d 488D4D80 		leaq	-128(%rbp), %rcx
 3152 0261 488D4580 		leaq	-128(%rbp), %rax
 3153 0265 4889CE   		movq	%rcx, %rsi
 3154 0268 4889C7   		movq	%rax, %rdi
 3155 026b E8000000 		call	mbedtls_mpi_sub_abs@PLT
 3155      00
 3156 0270 89857CFF 		movl	%eax, -132(%rbp)
 3156      FFFF
 3157 0276 83BD7CFF 		cmpl	$0, -132(%rbp)
 3157      FFFF00
 3158 027d 0F851F09 		jne	.L330
 3158      0000
GAS LISTING /tmp/ccajKZL5.s 			page 89


 3159              	.L260:
 3160              		.loc 1 1286 73 discriminator 3
 3161 0283 488B8568 		movq	-152(%rbp), %rax
 3161      FFFFFF
 3162 028a 488D5008 		leaq	8(%rax), %rdx
 3163 028e 488D4580 		leaq	-128(%rbp), %rax
 3164 0292 4889D6   		movq	%rdx, %rsi
 3165 0295 4889C7   		movq	%rax, %rdi
 3166 0298 E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 3166      00
 3167 029d 85C0     		testl	%eax, %eax
 3168 029f 79B1     		jns	.L261
 3169 02a1 E97E0200 		jmp	.L262
 3169      00
 3170              	.L246:
1287:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
1288:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     else
1289:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
1290:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* M = 3.X^2 */
1291:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &S,  &P->X,  &P->X   ) ); MOD_MUL( S );
 3171              		.loc 1 1291 9 is_stmt 1
 3172 02a6 488B9558 		movq	-168(%rbp), %rdx
 3172      FFFFFF
 3173 02ad 488B8D58 		movq	-168(%rbp), %rcx
 3173      FFFFFF
 3174 02b4 488D45A0 		leaq	-96(%rbp), %rax
 3175 02b8 4889CE   		movq	%rcx, %rsi
 3176 02bb 4889C7   		movq	%rax, %rdi
 3177 02be E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 3177      00
 3178 02c3 89857CFF 		movl	%eax, -132(%rbp)
 3178      FFFF
 3179 02c9 83BD7CFF 		cmpl	$0, -132(%rbp)
 3179      FFFF00
 3180 02d0 0F85CF08 		jne	.L331
 3180      0000
 3181              		.loc 1 1291 73 discriminator 2
 3182 02d6 488B9568 		movq	-152(%rbp), %rdx
 3182      FFFFFF
 3183 02dd 488D45A0 		leaq	-96(%rbp), %rax
 3184 02e1 4889D6   		movq	%rdx, %rsi
 3185 02e4 4889C7   		movq	%rax, %rdi
 3186 02e7 E8000000 		call	ecp_modp
 3186      00
 3187 02ec 89857CFF 		movl	%eax, -132(%rbp)
 3187      FFFF
 3188 02f2 83BD7CFF 		cmpl	$0, -132(%rbp)
 3188      FFFF00
 3189 02f9 0F85A908 		jne	.L332
 3189      0000
1292:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_int( &M,  &S,     3       ) ); MOD_ADD( M );
 3190              		.loc 1 1292 9
 3191 02ff 488D4DA0 		leaq	-96(%rbp), %rcx
 3192 0303 488D4580 		leaq	-128(%rbp), %rax
 3193 0307 BA030000 		movl	$3, %edx
 3193      00
 3194 030c 4889CE   		movq	%rcx, %rsi
GAS LISTING /tmp/ccajKZL5.s 			page 90


 3195 030f 4889C7   		movq	%rax, %rdi
 3196 0312 E8000000 		call	mbedtls_mpi_mul_int@PLT
 3196      00
 3197 0317 89857CFF 		movl	%eax, -132(%rbp)
 3197      FFFF
 3198 031d 83BD7CFF 		cmpl	$0, -132(%rbp)
 3198      FFFF00
 3199 0324 0F858108 		jne	.L333
 3199      0000
 3200              		.loc 1 1292 73
 3201 032a EB31     		jmp	.L266
 3202              	.L267:
 3203              		.loc 1 1292 73 is_stmt 0 discriminator 4
 3204 032c 488B8568 		movq	-152(%rbp), %rax
 3204      FFFFFF
 3205 0333 488D5008 		leaq	8(%rax), %rdx
 3206 0337 488D4D80 		leaq	-128(%rbp), %rcx
 3207 033b 488D4580 		leaq	-128(%rbp), %rax
 3208 033f 4889CE   		movq	%rcx, %rsi
 3209 0342 4889C7   		movq	%rax, %rdi
 3210 0345 E8000000 		call	mbedtls_mpi_sub_abs@PLT
 3210      00
 3211 034a 89857CFF 		movl	%eax, -132(%rbp)
 3211      FFFF
 3212 0350 83BD7CFF 		cmpl	$0, -132(%rbp)
 3212      FFFF00
 3213 0357 0F855108 		jne	.L334
 3213      0000
 3214              	.L266:
 3215              		.loc 1 1292 73 discriminator 3
 3216 035d 488B8568 		movq	-152(%rbp), %rax
 3216      FFFFFF
 3217 0364 488D5008 		leaq	8(%rax), %rdx
 3218 0368 488D4580 		leaq	-128(%rbp), %rax
 3219 036c 4889D6   		movq	%rdx, %rsi
 3220 036f 4889C7   		movq	%rax, %rdi
 3221 0372 E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 3221      00
 3222 0377 85C0     		testl	%eax, %eax
 3223 0379 79B1     		jns	.L267
1293:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1294:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* Optimize away for "koblitz" curves with A = 0 */
1295:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( mbedtls_mpi_cmp_int( &grp->A, 0 ) != 0 )
 3224              		.loc 1 1295 13 is_stmt 1
 3225 037b 488B8568 		movq	-152(%rbp), %rax
 3225      FFFFFF
 3226 0382 4883C020 		addq	$32, %rax
 3227 0386 BE000000 		movl	$0, %esi
 3227      00
 3228 038b 4889C7   		movq	%rax, %rdi
 3229 038e E8000000 		call	mbedtls_mpi_cmp_int@PLT
 3229      00
 3230              		.loc 1 1295 11
 3231 0393 85C0     		testl	%eax, %eax
 3232 0395 0F848901 		je	.L262
 3232      0000
1296:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         {
GAS LISTING /tmp/ccajKZL5.s 			page 91


1297:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             /* M += A.Z^4 */
1298:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &S,  &P->Z,  &P->Z   ) ); MOD_MUL( S );
 3233              		.loc 1 1298 13
 3234 039b 488B8558 		movq	-168(%rbp), %rax
 3234      FFFFFF
 3235 03a2 488D5030 		leaq	48(%rax), %rdx
 3236 03a6 488B8558 		movq	-168(%rbp), %rax
 3236      FFFFFF
 3237 03ad 488D4830 		leaq	48(%rax), %rcx
 3238 03b1 488D45A0 		leaq	-96(%rbp), %rax
 3239 03b5 4889CE   		movq	%rcx, %rsi
 3240 03b8 4889C7   		movq	%rax, %rdi
 3241 03bb E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 3241      00
 3242 03c0 89857CFF 		movl	%eax, -132(%rbp)
 3242      FFFF
 3243 03c6 83BD7CFF 		cmpl	$0, -132(%rbp)
 3243      FFFF00
 3244 03cd 0F85DE07 		jne	.L335
 3244      0000
 3245              		.loc 1 1298 77 discriminator 2
 3246 03d3 488B9568 		movq	-152(%rbp), %rdx
 3246      FFFFFF
 3247 03da 488D45A0 		leaq	-96(%rbp), %rax
 3248 03de 4889D6   		movq	%rdx, %rsi
 3249 03e1 4889C7   		movq	%rax, %rdi
 3250 03e4 E8000000 		call	ecp_modp
 3250      00
 3251 03e9 89857CFF 		movl	%eax, -132(%rbp)
 3251      FFFF
 3252 03ef 83BD7CFF 		cmpl	$0, -132(%rbp)
 3252      FFFF00
 3253 03f6 0F85B807 		jne	.L336
 3253      0000
1299:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T,  &S,     &S      ) ); MOD_MUL( T );
 3254              		.loc 1 1299 13
 3255 03fc 488D55A0 		leaq	-96(%rbp), %rdx
 3256 0400 488D4DA0 		leaq	-96(%rbp), %rcx
 3257 0404 488D45C0 		leaq	-64(%rbp), %rax
 3258 0408 4889CE   		movq	%rcx, %rsi
 3259 040b 4889C7   		movq	%rax, %rdi
 3260 040e E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 3260      00
 3261 0413 89857CFF 		movl	%eax, -132(%rbp)
 3261      FFFF
 3262 0419 83BD7CFF 		cmpl	$0, -132(%rbp)
 3262      FFFF00
 3263 0420 0F859107 		jne	.L337
 3263      0000
 3264              		.loc 1 1299 77 discriminator 2
 3265 0426 488B9568 		movq	-152(%rbp), %rdx
 3265      FFFFFF
 3266 042d 488D45C0 		leaq	-64(%rbp), %rax
 3267 0431 4889D6   		movq	%rdx, %rsi
 3268 0434 4889C7   		movq	%rax, %rdi
 3269 0437 E8000000 		call	ecp_modp
 3269      00
GAS LISTING /tmp/ccajKZL5.s 			page 92


 3270 043c 89857CFF 		movl	%eax, -132(%rbp)
 3270      FFFF
 3271 0442 83BD7CFF 		cmpl	$0, -132(%rbp)
 3271      FFFF00
 3272 0449 0F856B07 		jne	.L338
 3272      0000
1300:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &S,  &T,     &grp->A ) ); MOD_MUL( S );
 3273              		.loc 1 1300 13
 3274 044f 488B8568 		movq	-152(%rbp), %rax
 3274      FFFFFF
 3275 0456 488D5020 		leaq	32(%rax), %rdx
 3276 045a 488D4DC0 		leaq	-64(%rbp), %rcx
 3277 045e 488D45A0 		leaq	-96(%rbp), %rax
 3278 0462 4889CE   		movq	%rcx, %rsi
 3279 0465 4889C7   		movq	%rax, %rdi
 3280 0468 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 3280      00
 3281 046d 89857CFF 		movl	%eax, -132(%rbp)
 3281      FFFF
 3282 0473 83BD7CFF 		cmpl	$0, -132(%rbp)
 3282      FFFF00
 3283 047a 0F853D07 		jne	.L339
 3283      0000
 3284              		.loc 1 1300 77 discriminator 2
 3285 0480 488B9568 		movq	-152(%rbp), %rdx
 3285      FFFFFF
 3286 0487 488D45A0 		leaq	-96(%rbp), %rax
 3287 048b 4889D6   		movq	%rdx, %rsi
 3288 048e 4889C7   		movq	%rax, %rdi
 3289 0491 E8000000 		call	ecp_modp
 3289      00
 3290 0496 89857CFF 		movl	%eax, -132(%rbp)
 3290      FFFF
 3291 049c 83BD7CFF 		cmpl	$0, -132(%rbp)
 3291      FFFF00
 3292 04a3 0F851707 		jne	.L340
 3292      0000
1301:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( &M,  &M,     &S      ) ); MOD_ADD( M );
 3293              		.loc 1 1301 13
 3294 04a9 488D55A0 		leaq	-96(%rbp), %rdx
 3295 04ad 488D4D80 		leaq	-128(%rbp), %rcx
 3296 04b1 488D4580 		leaq	-128(%rbp), %rax
 3297 04b5 4889CE   		movq	%rcx, %rsi
 3298 04b8 4889C7   		movq	%rax, %rdi
 3299 04bb E8000000 		call	mbedtls_mpi_add_mpi@PLT
 3299      00
 3300 04c0 89857CFF 		movl	%eax, -132(%rbp)
 3300      FFFF
 3301 04c6 83BD7CFF 		cmpl	$0, -132(%rbp)
 3301      FFFF00
 3302 04cd 0F85F006 		jne	.L341
 3302      0000
 3303              		.loc 1 1301 77
 3304 04d3 EB31     		jmp	.L275
 3305              	.L276:
 3306              		.loc 1 1301 77 is_stmt 0 discriminator 4
 3307 04d5 488B8568 		movq	-152(%rbp), %rax
GAS LISTING /tmp/ccajKZL5.s 			page 93


 3307      FFFFFF
 3308 04dc 488D5008 		leaq	8(%rax), %rdx
 3309 04e0 488D4D80 		leaq	-128(%rbp), %rcx
 3310 04e4 488D4580 		leaq	-128(%rbp), %rax
 3311 04e8 4889CE   		movq	%rcx, %rsi
 3312 04eb 4889C7   		movq	%rax, %rdi
 3313 04ee E8000000 		call	mbedtls_mpi_sub_abs@PLT
 3313      00
 3314 04f3 89857CFF 		movl	%eax, -132(%rbp)
 3314      FFFF
 3315 04f9 83BD7CFF 		cmpl	$0, -132(%rbp)
 3315      FFFF00
 3316 0500 0F85C006 		jne	.L342
 3316      0000
 3317              	.L275:
 3318              		.loc 1 1301 77 discriminator 3
 3319 0506 488B8568 		movq	-152(%rbp), %rax
 3319      FFFFFF
 3320 050d 488D5008 		leaq	8(%rax), %rdx
 3321 0511 488D4580 		leaq	-128(%rbp), %rax
 3322 0515 4889D6   		movq	%rdx, %rsi
 3323 0518 4889C7   		movq	%rax, %rdi
 3324 051b E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 3324      00
 3325 0520 85C0     		testl	%eax, %eax
 3326 0522 79B1     		jns	.L276
 3327              	.L262:
1302:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         }
1303:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
1304:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1305:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* S = 4.X.Y^2 */
1306:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T,  &P->Y,  &P->Y   ) ); MOD_MUL( T );
 3328              		.loc 1 1306 5 is_stmt 1
 3329 0524 488B8558 		movq	-168(%rbp), %rax
 3329      FFFFFF
 3330 052b 488D5018 		leaq	24(%rax), %rdx
 3331 052f 488B8558 		movq	-168(%rbp), %rax
 3331      FFFFFF
 3332 0536 488D4818 		leaq	24(%rax), %rcx
 3333 053a 488D45C0 		leaq	-64(%rbp), %rax
 3334 053e 4889CE   		movq	%rcx, %rsi
 3335 0541 4889C7   		movq	%rax, %rdi
 3336 0544 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 3336      00
 3337 0549 89857CFF 		movl	%eax, -132(%rbp)
 3337      FFFF
 3338 054f 83BD7CFF 		cmpl	$0, -132(%rbp)
 3338      FFFF00
 3339 0556 0F856D06 		jne	.L343
 3339      0000
 3340              		.loc 1 1306 69 discriminator 2
 3341 055c 488B9568 		movq	-152(%rbp), %rdx
 3341      FFFFFF
 3342 0563 488D45C0 		leaq	-64(%rbp), %rax
 3343 0567 4889D6   		movq	%rdx, %rsi
 3344 056a 4889C7   		movq	%rax, %rdi
 3345 056d E8000000 		call	ecp_modp
GAS LISTING /tmp/ccajKZL5.s 			page 94


 3345      00
 3346 0572 89857CFF 		movl	%eax, -132(%rbp)
 3346      FFFF
 3347 0578 83BD7CFF 		cmpl	$0, -132(%rbp)
 3347      FFFF00
 3348 057f 0F854706 		jne	.L344
 3348      0000
1307:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_shift_l( &T,  1               ) ); MOD_ADD( T );
 3349              		.loc 1 1307 5
 3350 0585 488D45C0 		leaq	-64(%rbp), %rax
 3351 0589 BE010000 		movl	$1, %esi
 3351      00
 3352 058e 4889C7   		movq	%rax, %rdi
 3353 0591 E8000000 		call	mbedtls_mpi_shift_l@PLT
 3353      00
 3354 0596 89857CFF 		movl	%eax, -132(%rbp)
 3354      FFFF
 3355 059c 83BD7CFF 		cmpl	$0, -132(%rbp)
 3355      FFFF00
 3356 05a3 0F852606 		jne	.L345
 3356      0000
 3357              		.loc 1 1307 69
 3358 05a9 EB31     		jmp	.L280
 3359              	.L281:
 3360              		.loc 1 1307 69 is_stmt 0 discriminator 4
 3361 05ab 488B8568 		movq	-152(%rbp), %rax
 3361      FFFFFF
 3362 05b2 488D5008 		leaq	8(%rax), %rdx
 3363 05b6 488D4DC0 		leaq	-64(%rbp), %rcx
 3364 05ba 488D45C0 		leaq	-64(%rbp), %rax
 3365 05be 4889CE   		movq	%rcx, %rsi
 3366 05c1 4889C7   		movq	%rax, %rdi
 3367 05c4 E8000000 		call	mbedtls_mpi_sub_abs@PLT
 3367      00
 3368 05c9 89857CFF 		movl	%eax, -132(%rbp)
 3368      FFFF
 3369 05cf 83BD7CFF 		cmpl	$0, -132(%rbp)
 3369      FFFF00
 3370 05d6 0F85F605 		jne	.L346
 3370      0000
 3371              	.L280:
 3372              		.loc 1 1307 69 discriminator 3
 3373 05dc 488B8568 		movq	-152(%rbp), %rax
 3373      FFFFFF
 3374 05e3 488D5008 		leaq	8(%rax), %rdx
 3375 05e7 488D45C0 		leaq	-64(%rbp), %rax
 3376 05eb 4889D6   		movq	%rdx, %rsi
 3377 05ee 4889C7   		movq	%rax, %rdi
 3378 05f1 E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 3378      00
 3379 05f6 85C0     		testl	%eax, %eax
 3380 05f8 79B1     		jns	.L281
1308:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &S,  &P->X,  &T      ) ); MOD_MUL( S );
 3381              		.loc 1 1308 5 is_stmt 1
 3382 05fa 488B8D58 		movq	-168(%rbp), %rcx
 3382      FFFFFF
 3383 0601 488D55C0 		leaq	-64(%rbp), %rdx
GAS LISTING /tmp/ccajKZL5.s 			page 95


 3384 0605 488D45A0 		leaq	-96(%rbp), %rax
 3385 0609 4889CE   		movq	%rcx, %rsi
 3386 060c 4889C7   		movq	%rax, %rdi
 3387 060f E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 3387      00
 3388 0614 89857CFF 		movl	%eax, -132(%rbp)
 3388      FFFF
 3389 061a 83BD7CFF 		cmpl	$0, -132(%rbp)
 3389      FFFF00
 3390 0621 0F85AE05 		jne	.L347
 3390      0000
 3391              		.loc 1 1308 69 discriminator 2
 3392 0627 488B9568 		movq	-152(%rbp), %rdx
 3392      FFFFFF
 3393 062e 488D45A0 		leaq	-96(%rbp), %rax
 3394 0632 4889D6   		movq	%rdx, %rsi
 3395 0635 4889C7   		movq	%rax, %rdi
 3396 0638 E8000000 		call	ecp_modp
 3396      00
 3397 063d 89857CFF 		movl	%eax, -132(%rbp)
 3397      FFFF
 3398 0643 83BD7CFF 		cmpl	$0, -132(%rbp)
 3398      FFFF00
 3399 064a 0F858805 		jne	.L348
 3399      0000
1309:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_shift_l( &S,  1               ) ); MOD_ADD( S );
 3400              		.loc 1 1309 5
 3401 0650 488D45A0 		leaq	-96(%rbp), %rax
 3402 0654 BE010000 		movl	$1, %esi
 3402      00
 3403 0659 4889C7   		movq	%rax, %rdi
 3404 065c E8000000 		call	mbedtls_mpi_shift_l@PLT
 3404      00
 3405 0661 89857CFF 		movl	%eax, -132(%rbp)
 3405      FFFF
 3406 0667 83BD7CFF 		cmpl	$0, -132(%rbp)
 3406      FFFF00
 3407 066e 0F856705 		jne	.L349
 3407      0000
 3408              		.loc 1 1309 69
 3409 0674 EB31     		jmp	.L285
 3410              	.L286:
 3411              		.loc 1 1309 69 is_stmt 0 discriminator 4
 3412 0676 488B8568 		movq	-152(%rbp), %rax
 3412      FFFFFF
 3413 067d 488D5008 		leaq	8(%rax), %rdx
 3414 0681 488D4DA0 		leaq	-96(%rbp), %rcx
 3415 0685 488D45A0 		leaq	-96(%rbp), %rax
 3416 0689 4889CE   		movq	%rcx, %rsi
 3417 068c 4889C7   		movq	%rax, %rdi
 3418 068f E8000000 		call	mbedtls_mpi_sub_abs@PLT
 3418      00
 3419 0694 89857CFF 		movl	%eax, -132(%rbp)
 3419      FFFF
 3420 069a 83BD7CFF 		cmpl	$0, -132(%rbp)
 3420      FFFF00
 3421 06a1 0F853705 		jne	.L350
GAS LISTING /tmp/ccajKZL5.s 			page 96


 3421      0000
 3422              	.L285:
 3423              		.loc 1 1309 69 discriminator 3
 3424 06a7 488B8568 		movq	-152(%rbp), %rax
 3424      FFFFFF
 3425 06ae 488D5008 		leaq	8(%rax), %rdx
 3426 06b2 488D45A0 		leaq	-96(%rbp), %rax
 3427 06b6 4889D6   		movq	%rdx, %rsi
 3428 06b9 4889C7   		movq	%rax, %rdi
 3429 06bc E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 3429      00
 3430 06c1 85C0     		testl	%eax, %eax
 3431 06c3 79B1     		jns	.L286
1310:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1311:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* U = 8.Y^4 */
1312:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &U,  &T,     &T      ) ); MOD_MUL( U );
 3432              		.loc 1 1312 5 is_stmt 1
 3433 06c5 488D55C0 		leaq	-64(%rbp), %rdx
 3434 06c9 488D4DC0 		leaq	-64(%rbp), %rcx
 3435 06cd 488D45E0 		leaq	-32(%rbp), %rax
 3436 06d1 4889CE   		movq	%rcx, %rsi
 3437 06d4 4889C7   		movq	%rax, %rdi
 3438 06d7 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 3438      00
 3439 06dc 89857CFF 		movl	%eax, -132(%rbp)
 3439      FFFF
 3440 06e2 83BD7CFF 		cmpl	$0, -132(%rbp)
 3440      FFFF00
 3441 06e9 0F85F204 		jne	.L351
 3441      0000
 3442              		.loc 1 1312 69 discriminator 2
 3443 06ef 488B9568 		movq	-152(%rbp), %rdx
 3443      FFFFFF
 3444 06f6 488D45E0 		leaq	-32(%rbp), %rax
 3445 06fa 4889D6   		movq	%rdx, %rsi
 3446 06fd 4889C7   		movq	%rax, %rdi
 3447 0700 E8000000 		call	ecp_modp
 3447      00
 3448 0705 89857CFF 		movl	%eax, -132(%rbp)
 3448      FFFF
 3449 070b 83BD7CFF 		cmpl	$0, -132(%rbp)
 3449      FFFF00
 3450 0712 0F85CC04 		jne	.L352
 3450      0000
1313:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_shift_l( &U,  1               ) ); MOD_ADD( U );
 3451              		.loc 1 1313 5
 3452 0718 488D45E0 		leaq	-32(%rbp), %rax
 3453 071c BE010000 		movl	$1, %esi
 3453      00
 3454 0721 4889C7   		movq	%rax, %rdi
 3455 0724 E8000000 		call	mbedtls_mpi_shift_l@PLT
 3455      00
 3456 0729 89857CFF 		movl	%eax, -132(%rbp)
 3456      FFFF
 3457 072f 83BD7CFF 		cmpl	$0, -132(%rbp)
 3457      FFFF00
 3458 0736 0F85AB04 		jne	.L353
GAS LISTING /tmp/ccajKZL5.s 			page 97


 3458      0000
 3459              		.loc 1 1313 69
 3460 073c EB31     		jmp	.L290
 3461              	.L291:
 3462              		.loc 1 1313 69 is_stmt 0 discriminator 4
 3463 073e 488B8568 		movq	-152(%rbp), %rax
 3463      FFFFFF
 3464 0745 488D5008 		leaq	8(%rax), %rdx
 3465 0749 488D4DE0 		leaq	-32(%rbp), %rcx
 3466 074d 488D45E0 		leaq	-32(%rbp), %rax
 3467 0751 4889CE   		movq	%rcx, %rsi
 3468 0754 4889C7   		movq	%rax, %rdi
 3469 0757 E8000000 		call	mbedtls_mpi_sub_abs@PLT
 3469      00
 3470 075c 89857CFF 		movl	%eax, -132(%rbp)
 3470      FFFF
 3471 0762 83BD7CFF 		cmpl	$0, -132(%rbp)
 3471      FFFF00
 3472 0769 0F857B04 		jne	.L354
 3472      0000
 3473              	.L290:
 3474              		.loc 1 1313 69 discriminator 3
 3475 076f 488B8568 		movq	-152(%rbp), %rax
 3475      FFFFFF
 3476 0776 488D5008 		leaq	8(%rax), %rdx
 3477 077a 488D45E0 		leaq	-32(%rbp), %rax
 3478 077e 4889D6   		movq	%rdx, %rsi
 3479 0781 4889C7   		movq	%rax, %rdi
 3480 0784 E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 3480      00
 3481 0789 85C0     		testl	%eax, %eax
 3482 078b 79B1     		jns	.L291
1314:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1315:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* T = M^2 - 2.S */
1316:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T,  &M,     &M      ) ); MOD_MUL( T );
 3483              		.loc 1 1316 5 is_stmt 1
 3484 078d 488D5580 		leaq	-128(%rbp), %rdx
 3485 0791 488D4D80 		leaq	-128(%rbp), %rcx
 3486 0795 488D45C0 		leaq	-64(%rbp), %rax
 3487 0799 4889CE   		movq	%rcx, %rsi
 3488 079c 4889C7   		movq	%rax, %rdi
 3489 079f E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 3489      00
 3490 07a4 89857CFF 		movl	%eax, -132(%rbp)
 3490      FFFF
 3491 07aa 83BD7CFF 		cmpl	$0, -132(%rbp)
 3491      FFFF00
 3492 07b1 0F853604 		jne	.L355
 3492      0000
 3493              		.loc 1 1316 69 discriminator 2
 3494 07b7 488B9568 		movq	-152(%rbp), %rdx
 3494      FFFFFF
 3495 07be 488D45C0 		leaq	-64(%rbp), %rax
 3496 07c2 4889D6   		movq	%rdx, %rsi
 3497 07c5 4889C7   		movq	%rax, %rdi
 3498 07c8 E8000000 		call	ecp_modp
 3498      00
GAS LISTING /tmp/ccajKZL5.s 			page 98


 3499 07cd 89857CFF 		movl	%eax, -132(%rbp)
 3499      FFFF
 3500 07d3 83BD7CFF 		cmpl	$0, -132(%rbp)
 3500      FFFF00
 3501 07da 0F851004 		jne	.L356
 3501      0000
1317:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &T,  &T,     &S      ) ); MOD_SUB( T );
 3502              		.loc 1 1317 5
 3503 07e0 488D55A0 		leaq	-96(%rbp), %rdx
 3504 07e4 488D4DC0 		leaq	-64(%rbp), %rcx
 3505 07e8 488D45C0 		leaq	-64(%rbp), %rax
 3506 07ec 4889CE   		movq	%rcx, %rsi
 3507 07ef 4889C7   		movq	%rax, %rdi
 3508 07f2 E8000000 		call	mbedtls_mpi_sub_mpi@PLT
 3508      00
 3509 07f7 89857CFF 		movl	%eax, -132(%rbp)
 3509      FFFF
 3510 07fd 83BD7CFF 		cmpl	$0, -132(%rbp)
 3510      FFFF00
 3511 0804 0F85E903 		jne	.L357
 3511      0000
 3512              		.loc 1 1317 69
 3513 080a EB31     		jmp	.L295
 3514              	.L297:
 3515              		.loc 1 1317 69 is_stmt 0 discriminator 5
 3516 080c 488B8568 		movq	-152(%rbp), %rax
 3516      FFFFFF
 3517 0813 488D5008 		leaq	8(%rax), %rdx
 3518 0817 488D4DC0 		leaq	-64(%rbp), %rcx
 3519 081b 488D45C0 		leaq	-64(%rbp), %rax
 3520 081f 4889CE   		movq	%rcx, %rsi
 3521 0822 4889C7   		movq	%rax, %rdi
 3522 0825 E8000000 		call	mbedtls_mpi_add_mpi@PLT
 3522      00
 3523 082a 89857CFF 		movl	%eax, -132(%rbp)
 3523      FFFF
 3524 0830 83BD7CFF 		cmpl	$0, -132(%rbp)
 3524      FFFF00
 3525 0837 0F85B903 		jne	.L358
 3525      0000
 3526              	.L295:
 3527              		.loc 1 1317 69 discriminator 3
 3528 083d 8B45C0   		movl	-64(%rbp), %eax
 3529 0840 85C0     		testl	%eax, %eax
 3530 0842 7915     		jns	.L296
 3531              		.loc 1 1317 69 discriminator 4
 3532 0844 488D45C0 		leaq	-64(%rbp), %rax
 3533 0848 BE000000 		movl	$0, %esi
 3533      00
 3534 084d 4889C7   		movq	%rax, %rdi
 3535 0850 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 3535      00
 3536 0855 85C0     		testl	%eax, %eax
 3537 0857 75B3     		jne	.L297
 3538              	.L296:
1318:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &T,  &T,     &S      ) ); MOD_SUB( T );
 3539              		.loc 1 1318 5 is_stmt 1
GAS LISTING /tmp/ccajKZL5.s 			page 99


 3540 0859 488D55A0 		leaq	-96(%rbp), %rdx
 3541 085d 488D4DC0 		leaq	-64(%rbp), %rcx
 3542 0861 488D45C0 		leaq	-64(%rbp), %rax
 3543 0865 4889CE   		movq	%rcx, %rsi
 3544 0868 4889C7   		movq	%rax, %rdi
 3545 086b E8000000 		call	mbedtls_mpi_sub_mpi@PLT
 3545      00
 3546 0870 89857CFF 		movl	%eax, -132(%rbp)
 3546      FFFF
 3547 0876 83BD7CFF 		cmpl	$0, -132(%rbp)
 3547      FFFF00
 3548 087d 0F857603 		jne	.L359
 3548      0000
 3549              		.loc 1 1318 69
 3550 0883 EB31     		jmp	.L299
 3551              	.L301:
 3552              		.loc 1 1318 69 is_stmt 0 discriminator 5
 3553 0885 488B8568 		movq	-152(%rbp), %rax
 3553      FFFFFF
 3554 088c 488D5008 		leaq	8(%rax), %rdx
 3555 0890 488D4DC0 		leaq	-64(%rbp), %rcx
 3556 0894 488D45C0 		leaq	-64(%rbp), %rax
 3557 0898 4889CE   		movq	%rcx, %rsi
 3558 089b 4889C7   		movq	%rax, %rdi
 3559 089e E8000000 		call	mbedtls_mpi_add_mpi@PLT
 3559      00
 3560 08a3 89857CFF 		movl	%eax, -132(%rbp)
 3560      FFFF
 3561 08a9 83BD7CFF 		cmpl	$0, -132(%rbp)
 3561      FFFF00
 3562 08b0 0F854603 		jne	.L360
 3562      0000
 3563              	.L299:
 3564              		.loc 1 1318 69 discriminator 3
 3565 08b6 8B45C0   		movl	-64(%rbp), %eax
 3566 08b9 85C0     		testl	%eax, %eax
 3567 08bb 7915     		jns	.L300
 3568              		.loc 1 1318 69 discriminator 4
 3569 08bd 488D45C0 		leaq	-64(%rbp), %rax
 3570 08c1 BE000000 		movl	$0, %esi
 3570      00
 3571 08c6 4889C7   		movq	%rax, %rdi
 3572 08c9 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 3572      00
 3573 08ce 85C0     		testl	%eax, %eax
 3574 08d0 75B3     		jne	.L301
 3575              	.L300:
1319:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1320:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* S = M(S - T) - U */
1321:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &S,  &S,     &T      ) ); MOD_SUB( S );
 3576              		.loc 1 1321 5 is_stmt 1
 3577 08d2 488D55C0 		leaq	-64(%rbp), %rdx
 3578 08d6 488D4DA0 		leaq	-96(%rbp), %rcx
 3579 08da 488D45A0 		leaq	-96(%rbp), %rax
 3580 08de 4889CE   		movq	%rcx, %rsi
 3581 08e1 4889C7   		movq	%rax, %rdi
 3582 08e4 E8000000 		call	mbedtls_mpi_sub_mpi@PLT
GAS LISTING /tmp/ccajKZL5.s 			page 100


 3582      00
 3583 08e9 89857CFF 		movl	%eax, -132(%rbp)
 3583      FFFF
 3584 08ef 83BD7CFF 		cmpl	$0, -132(%rbp)
 3584      FFFF00
 3585 08f6 0F850303 		jne	.L361
 3585      0000
 3586              		.loc 1 1321 69
 3587 08fc EB31     		jmp	.L303
 3588              	.L305:
 3589              		.loc 1 1321 69 is_stmt 0 discriminator 5
 3590 08fe 488B8568 		movq	-152(%rbp), %rax
 3590      FFFFFF
 3591 0905 488D5008 		leaq	8(%rax), %rdx
 3592 0909 488D4DA0 		leaq	-96(%rbp), %rcx
 3593 090d 488D45A0 		leaq	-96(%rbp), %rax
 3594 0911 4889CE   		movq	%rcx, %rsi
 3595 0914 4889C7   		movq	%rax, %rdi
 3596 0917 E8000000 		call	mbedtls_mpi_add_mpi@PLT
 3596      00
 3597 091c 89857CFF 		movl	%eax, -132(%rbp)
 3597      FFFF
 3598 0922 83BD7CFF 		cmpl	$0, -132(%rbp)
 3598      FFFF00
 3599 0929 0F85D302 		jne	.L362
 3599      0000
 3600              	.L303:
 3601              		.loc 1 1321 69 discriminator 3
 3602 092f 8B45A0   		movl	-96(%rbp), %eax
 3603 0932 85C0     		testl	%eax, %eax
 3604 0934 7915     		jns	.L304
 3605              		.loc 1 1321 69 discriminator 4
 3606 0936 488D45A0 		leaq	-96(%rbp), %rax
 3607 093a BE000000 		movl	$0, %esi
 3607      00
 3608 093f 4889C7   		movq	%rax, %rdi
 3609 0942 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 3609      00
 3610 0947 85C0     		testl	%eax, %eax
 3611 0949 75B3     		jne	.L305
 3612              	.L304:
1322:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &S,  &S,     &M      ) ); MOD_MUL( S );
 3613              		.loc 1 1322 5 is_stmt 1
 3614 094b 488D5580 		leaq	-128(%rbp), %rdx
 3615 094f 488D4DA0 		leaq	-96(%rbp), %rcx
 3616 0953 488D45A0 		leaq	-96(%rbp), %rax
 3617 0957 4889CE   		movq	%rcx, %rsi
 3618 095a 4889C7   		movq	%rax, %rdi
 3619 095d E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 3619      00
 3620 0962 89857CFF 		movl	%eax, -132(%rbp)
 3620      FFFF
 3621 0968 83BD7CFF 		cmpl	$0, -132(%rbp)
 3621      FFFF00
 3622 096f 0F859002 		jne	.L363
 3622      0000
 3623              		.loc 1 1322 69 discriminator 2
GAS LISTING /tmp/ccajKZL5.s 			page 101


 3624 0975 488B9568 		movq	-152(%rbp), %rdx
 3624      FFFFFF
 3625 097c 488D45A0 		leaq	-96(%rbp), %rax
 3626 0980 4889D6   		movq	%rdx, %rsi
 3627 0983 4889C7   		movq	%rax, %rdi
 3628 0986 E8000000 		call	ecp_modp
 3628      00
 3629 098b 89857CFF 		movl	%eax, -132(%rbp)
 3629      FFFF
 3630 0991 83BD7CFF 		cmpl	$0, -132(%rbp)
 3630      FFFF00
 3631 0998 0F856A02 		jne	.L364
 3631      0000
1323:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &S,  &S,     &U      ) ); MOD_SUB( S );
 3632              		.loc 1 1323 5
 3633 099e 488D55E0 		leaq	-32(%rbp), %rdx
 3634 09a2 488D4DA0 		leaq	-96(%rbp), %rcx
 3635 09a6 488D45A0 		leaq	-96(%rbp), %rax
 3636 09aa 4889CE   		movq	%rcx, %rsi
 3637 09ad 4889C7   		movq	%rax, %rdi
 3638 09b0 E8000000 		call	mbedtls_mpi_sub_mpi@PLT
 3638      00
 3639 09b5 89857CFF 		movl	%eax, -132(%rbp)
 3639      FFFF
 3640 09bb 83BD7CFF 		cmpl	$0, -132(%rbp)
 3640      FFFF00
 3641 09c2 0F854302 		jne	.L365
 3641      0000
 3642              		.loc 1 1323 69
 3643 09c8 EB31     		jmp	.L309
 3644              	.L311:
 3645              		.loc 1 1323 69 is_stmt 0 discriminator 5
 3646 09ca 488B8568 		movq	-152(%rbp), %rax
 3646      FFFFFF
 3647 09d1 488D5008 		leaq	8(%rax), %rdx
 3648 09d5 488D4DA0 		leaq	-96(%rbp), %rcx
 3649 09d9 488D45A0 		leaq	-96(%rbp), %rax
 3650 09dd 4889CE   		movq	%rcx, %rsi
 3651 09e0 4889C7   		movq	%rax, %rdi
 3652 09e3 E8000000 		call	mbedtls_mpi_add_mpi@PLT
 3652      00
 3653 09e8 89857CFF 		movl	%eax, -132(%rbp)
 3653      FFFF
 3654 09ee 83BD7CFF 		cmpl	$0, -132(%rbp)
 3654      FFFF00
 3655 09f5 0F851302 		jne	.L366
 3655      0000
 3656              	.L309:
 3657              		.loc 1 1323 69 discriminator 3
 3658 09fb 8B45A0   		movl	-96(%rbp), %eax
 3659 09fe 85C0     		testl	%eax, %eax
 3660 0a00 7915     		jns	.L310
 3661              		.loc 1 1323 69 discriminator 4
 3662 0a02 488D45A0 		leaq	-96(%rbp), %rax
 3663 0a06 BE000000 		movl	$0, %esi
 3663      00
 3664 0a0b 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/ccajKZL5.s 			page 102


 3665 0a0e E8000000 		call	mbedtls_mpi_cmp_int@PLT
 3665      00
 3666 0a13 85C0     		testl	%eax, %eax
 3667 0a15 75B3     		jne	.L311
 3668              	.L310:
1324:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1325:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* U = 2.Y.Z */
1326:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &U,  &P->Y,  &P->Z   ) ); MOD_MUL( U );
 3669              		.loc 1 1326 5 is_stmt 1
 3670 0a17 488B8558 		movq	-168(%rbp), %rax
 3670      FFFFFF
 3671 0a1e 488D5030 		leaq	48(%rax), %rdx
 3672 0a22 488B8558 		movq	-168(%rbp), %rax
 3672      FFFFFF
 3673 0a29 488D4818 		leaq	24(%rax), %rcx
 3674 0a2d 488D45E0 		leaq	-32(%rbp), %rax
 3675 0a31 4889CE   		movq	%rcx, %rsi
 3676 0a34 4889C7   		movq	%rax, %rdi
 3677 0a37 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 3677      00
 3678 0a3c 89857CFF 		movl	%eax, -132(%rbp)
 3678      FFFF
 3679 0a42 83BD7CFF 		cmpl	$0, -132(%rbp)
 3679      FFFF00
 3680 0a49 0F85C201 		jne	.L367
 3680      0000
 3681              		.loc 1 1326 69 discriminator 2
 3682 0a4f 488B9568 		movq	-152(%rbp), %rdx
 3682      FFFFFF
 3683 0a56 488D45E0 		leaq	-32(%rbp), %rax
 3684 0a5a 4889D6   		movq	%rdx, %rsi
 3685 0a5d 4889C7   		movq	%rax, %rdi
 3686 0a60 E8000000 		call	ecp_modp
 3686      00
 3687 0a65 89857CFF 		movl	%eax, -132(%rbp)
 3687      FFFF
 3688 0a6b 83BD7CFF 		cmpl	$0, -132(%rbp)
 3688      FFFF00
 3689 0a72 0F859C01 		jne	.L368
 3689      0000
1327:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_shift_l( &U,  1               ) ); MOD_ADD( U );
 3690              		.loc 1 1327 5
 3691 0a78 488D45E0 		leaq	-32(%rbp), %rax
 3692 0a7c BE010000 		movl	$1, %esi
 3692      00
 3693 0a81 4889C7   		movq	%rax, %rdi
 3694 0a84 E8000000 		call	mbedtls_mpi_shift_l@PLT
 3694      00
 3695 0a89 89857CFF 		movl	%eax, -132(%rbp)
 3695      FFFF
 3696 0a8f 83BD7CFF 		cmpl	$0, -132(%rbp)
 3696      FFFF00
 3697 0a96 0F857B01 		jne	.L369
 3697      0000
 3698              		.loc 1 1327 69
 3699 0a9c EB31     		jmp	.L315
 3700              	.L316:
GAS LISTING /tmp/ccajKZL5.s 			page 103


 3701              		.loc 1 1327 69 is_stmt 0 discriminator 4
 3702 0a9e 488B8568 		movq	-152(%rbp), %rax
 3702      FFFFFF
 3703 0aa5 488D5008 		leaq	8(%rax), %rdx
 3704 0aa9 488D4DE0 		leaq	-32(%rbp), %rcx
 3705 0aad 488D45E0 		leaq	-32(%rbp), %rax
 3706 0ab1 4889CE   		movq	%rcx, %rsi
 3707 0ab4 4889C7   		movq	%rax, %rdi
 3708 0ab7 E8000000 		call	mbedtls_mpi_sub_abs@PLT
 3708      00
 3709 0abc 89857CFF 		movl	%eax, -132(%rbp)
 3709      FFFF
 3710 0ac2 83BD7CFF 		cmpl	$0, -132(%rbp)
 3710      FFFF00
 3711 0ac9 0F854B01 		jne	.L370
 3711      0000
 3712              	.L315:
 3713              		.loc 1 1327 69 discriminator 3
 3714 0acf 488B8568 		movq	-152(%rbp), %rax
 3714      FFFFFF
 3715 0ad6 488D5008 		leaq	8(%rax), %rdx
 3716 0ada 488D45E0 		leaq	-32(%rbp), %rax
 3717 0ade 4889D6   		movq	%rdx, %rsi
 3718 0ae1 4889C7   		movq	%rax, %rdi
 3719 0ae4 E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 3719      00
 3720 0ae9 85C0     		testl	%eax, %eax
 3721 0aeb 79B1     		jns	.L316
1328:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1329:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &R->X, &T ) );
 3722              		.loc 1 1329 5 is_stmt 1
 3723 0aed 488B8560 		movq	-160(%rbp), %rax
 3723      FFFFFF
 3724 0af4 488D55C0 		leaq	-64(%rbp), %rdx
 3725 0af8 4889D6   		movq	%rdx, %rsi
 3726 0afb 4889C7   		movq	%rax, %rdi
 3727 0afe E8000000 		call	mbedtls_mpi_copy@PLT
 3727      00
 3728 0b03 89857CFF 		movl	%eax, -132(%rbp)
 3728      FFFF
 3729 0b09 83BD7CFF 		cmpl	$0, -132(%rbp)
 3729      FFFF00
 3730 0b10 0F850701 		jne	.L371
 3730      0000
1330:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &R->Y, &S ) );
 3731              		.loc 1 1330 5
 3732 0b16 488B8560 		movq	-160(%rbp), %rax
 3732      FFFFFF
 3733 0b1d 488D5018 		leaq	24(%rax), %rdx
 3734 0b21 488D45A0 		leaq	-96(%rbp), %rax
 3735 0b25 4889C6   		movq	%rax, %rsi
 3736 0b28 4889D7   		movq	%rdx, %rdi
 3737 0b2b E8000000 		call	mbedtls_mpi_copy@PLT
 3737      00
 3738 0b30 89857CFF 		movl	%eax, -132(%rbp)
 3738      FFFF
 3739 0b36 83BD7CFF 		cmpl	$0, -132(%rbp)
GAS LISTING /tmp/ccajKZL5.s 			page 104


 3739      FFFF00
 3740 0b3d 0F85DD00 		jne	.L372
 3740      0000
1331:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &R->Z, &U ) );
 3741              		.loc 1 1331 5
 3742 0b43 488B8560 		movq	-160(%rbp), %rax
 3742      FFFFFF
 3743 0b4a 488D5030 		leaq	48(%rax), %rdx
 3744 0b4e 488D45E0 		leaq	-32(%rbp), %rax
 3745 0b52 4889C6   		movq	%rax, %rsi
 3746 0b55 4889D7   		movq	%rdx, %rdi
 3747 0b58 E8000000 		call	mbedtls_mpi_copy@PLT
 3747      00
 3748 0b5d 89857CFF 		movl	%eax, -132(%rbp)
 3748      FFFF
 3749 0b63 83BD7CFF 		cmpl	$0, -132(%rbp)
 3749      FFFF00
1332:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1333:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
 3750              		.loc 1 1333 1
 3751 0b6a E9B20000 		jmp	.L248
 3751      00
 3752              	.L321:
1282:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( &T,  &P->X,  &S      ) ); MOD_ADD( T );
 3753              		.loc 1 1282 9
 3754 0b6f 90       		nop
 3755 0b70 E9AC0000 		jmp	.L248
 3755      00
 3756              	.L322:
1282:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( &T,  &P->X,  &S      ) ); MOD_ADD( T );
 3757              		.loc 1 1282 73
 3758 0b75 90       		nop
 3759 0b76 E9A60000 		jmp	.L248
 3759      00
 3760              	.L323:
1283:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &U,  &P->X,  &S      ) ); MOD_SUB( U );
 3761              		.loc 1 1283 9
 3762 0b7b 90       		nop
 3763 0b7c E9A00000 		jmp	.L248
 3763      00
 3764              	.L324:
1283:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &U,  &P->X,  &S      ) ); MOD_SUB( U );
 3765              		.loc 1 1283 73
 3766 0b81 90       		nop
 3767 0b82 E99A0000 		jmp	.L248
 3767      00
 3768              	.L325:
1284:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &S,  &T,     &U      ) ); MOD_MUL( S );
 3769              		.loc 1 1284 9
 3770 0b87 90       		nop
 3771 0b88 E9940000 		jmp	.L248
 3771      00
 3772              	.L326:
1284:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &S,  &T,     &U      ) ); MOD_MUL( S );
 3773              		.loc 1 1284 73
 3774 0b8d 90       		nop
 3775 0b8e E98E0000 		jmp	.L248
GAS LISTING /tmp/ccajKZL5.s 			page 105


 3775      00
 3776              	.L327:
1285:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_int( &M,  &S,     3       ) ); MOD_ADD( M );
 3777              		.loc 1 1285 9
 3778 0b93 90       		nop
 3779 0b94 E9880000 		jmp	.L248
 3779      00
 3780              	.L328:
1285:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_int( &M,  &S,     3       ) ); MOD_ADD( M );
 3781              		.loc 1 1285 73
 3782 0b99 90       		nop
 3783 0b9a E9820000 		jmp	.L248
 3783      00
 3784              	.L329:
1286:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 3785              		.loc 1 1286 9
 3786 0b9f 90       		nop
 3787 0ba0 EB7F     		jmp	.L248
 3788              	.L330:
1286:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 3789              		.loc 1 1286 73
 3790 0ba2 90       		nop
 3791 0ba3 EB7C     		jmp	.L248
 3792              	.L331:
1291:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_int( &M,  &S,     3       ) ); MOD_ADD( M );
 3793              		.loc 1 1291 9
 3794 0ba5 90       		nop
 3795 0ba6 EB79     		jmp	.L248
 3796              	.L332:
1291:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_mul_int( &M,  &S,     3       ) ); MOD_ADD( M );
 3797              		.loc 1 1291 73
 3798 0ba8 90       		nop
 3799 0ba9 EB76     		jmp	.L248
 3800              	.L333:
1292:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 3801              		.loc 1 1292 9
 3802 0bab 90       		nop
 3803 0bac EB73     		jmp	.L248
 3804              	.L334:
1292:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 3805              		.loc 1 1292 73
 3806 0bae 90       		nop
 3807 0baf EB70     		jmp	.L248
 3808              	.L335:
1298:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T,  &S,     &S      ) ); MOD_MUL( T );
 3809              		.loc 1 1298 13
 3810 0bb1 90       		nop
 3811 0bb2 EB6D     		jmp	.L248
 3812              	.L336:
1298:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T,  &S,     &S      ) ); MOD_MUL( T );
 3813              		.loc 1 1298 77
 3814 0bb4 90       		nop
 3815 0bb5 EB6A     		jmp	.L248
 3816              	.L337:
1299:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &S,  &T,     &grp->A ) ); MOD_MUL( S );
 3817              		.loc 1 1299 13
 3818 0bb7 90       		nop
GAS LISTING /tmp/ccajKZL5.s 			page 106


 3819 0bb8 EB67     		jmp	.L248
 3820              	.L338:
1299:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &S,  &T,     &grp->A ) ); MOD_MUL( S );
 3821              		.loc 1 1299 77
 3822 0bba 90       		nop
 3823 0bbb EB64     		jmp	.L248
 3824              	.L339:
1300:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( &M,  &M,     &S      ) ); MOD_ADD( M );
 3825              		.loc 1 1300 13
 3826 0bbd 90       		nop
 3827 0bbe EB61     		jmp	.L248
 3828              	.L340:
1300:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( &M,  &M,     &S      ) ); MOD_ADD( M );
 3829              		.loc 1 1300 77
 3830 0bc0 90       		nop
 3831 0bc1 EB5E     		jmp	.L248
 3832              	.L341:
1301:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         }
 3833              		.loc 1 1301 13
 3834 0bc3 90       		nop
 3835 0bc4 EB5B     		jmp	.L248
 3836              	.L342:
1301:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         }
 3837              		.loc 1 1301 77
 3838 0bc6 90       		nop
 3839 0bc7 EB58     		jmp	.L248
 3840              	.L343:
1306:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_shift_l( &T,  1               ) ); MOD_ADD( T );
 3841              		.loc 1 1306 5
 3842 0bc9 90       		nop
 3843 0bca EB55     		jmp	.L248
 3844              	.L344:
1306:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_shift_l( &T,  1               ) ); MOD_ADD( T );
 3845              		.loc 1 1306 69
 3846 0bcc 90       		nop
 3847 0bcd EB52     		jmp	.L248
 3848              	.L345:
1307:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &S,  &P->X,  &T      ) ); MOD_MUL( S );
 3849              		.loc 1 1307 5
 3850 0bcf 90       		nop
 3851 0bd0 EB4F     		jmp	.L248
 3852              	.L346:
1307:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &S,  &P->X,  &T      ) ); MOD_MUL( S );
 3853              		.loc 1 1307 69
 3854 0bd2 90       		nop
 3855 0bd3 EB4C     		jmp	.L248
 3856              	.L347:
1308:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_shift_l( &S,  1               ) ); MOD_ADD( S );
 3857              		.loc 1 1308 5
 3858 0bd5 90       		nop
 3859 0bd6 EB49     		jmp	.L248
 3860              	.L348:
1308:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_shift_l( &S,  1               ) ); MOD_ADD( S );
 3861              		.loc 1 1308 69
 3862 0bd8 90       		nop
 3863 0bd9 EB46     		jmp	.L248
 3864              	.L349:
GAS LISTING /tmp/ccajKZL5.s 			page 107


1309:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 3865              		.loc 1 1309 5
 3866 0bdb 90       		nop
 3867 0bdc EB43     		jmp	.L248
 3868              	.L350:
1309:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 3869              		.loc 1 1309 69
 3870 0bde 90       		nop
 3871 0bdf EB40     		jmp	.L248
 3872              	.L351:
1312:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_shift_l( &U,  1               ) ); MOD_ADD( U );
 3873              		.loc 1 1312 5
 3874 0be1 90       		nop
 3875 0be2 EB3D     		jmp	.L248
 3876              	.L352:
1312:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_shift_l( &U,  1               ) ); MOD_ADD( U );
 3877              		.loc 1 1312 69
 3878 0be4 90       		nop
 3879 0be5 EB3A     		jmp	.L248
 3880              	.L353:
1313:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 3881              		.loc 1 1313 5
 3882 0be7 90       		nop
 3883 0be8 EB37     		jmp	.L248
 3884              	.L354:
1313:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 3885              		.loc 1 1313 69
 3886 0bea 90       		nop
 3887 0beb EB34     		jmp	.L248
 3888              	.L355:
1316:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &T,  &T,     &S      ) ); MOD_SUB( T );
 3889              		.loc 1 1316 5
 3890 0bed 90       		nop
 3891 0bee EB31     		jmp	.L248
 3892              	.L356:
1316:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &T,  &T,     &S      ) ); MOD_SUB( T );
 3893              		.loc 1 1316 69
 3894 0bf0 90       		nop
 3895 0bf1 EB2E     		jmp	.L248
 3896              	.L357:
1317:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &T,  &T,     &S      ) ); MOD_SUB( T );
 3897              		.loc 1 1317 5
 3898 0bf3 90       		nop
 3899 0bf4 EB2B     		jmp	.L248
 3900              	.L358:
1317:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &T,  &T,     &S      ) ); MOD_SUB( T );
 3901              		.loc 1 1317 69
 3902 0bf6 90       		nop
 3903 0bf7 EB28     		jmp	.L248
 3904              	.L359:
1318:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 3905              		.loc 1 1318 5
 3906 0bf9 90       		nop
 3907 0bfa EB25     		jmp	.L248
 3908              	.L360:
1318:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 3909              		.loc 1 1318 69
GAS LISTING /tmp/ccajKZL5.s 			page 108


 3910 0bfc 90       		nop
 3911 0bfd EB22     		jmp	.L248
 3912              	.L361:
1321:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &S,  &S,     &M      ) ); MOD_MUL( S );
 3913              		.loc 1 1321 5
 3914 0bff 90       		nop
 3915 0c00 EB1F     		jmp	.L248
 3916              	.L362:
1321:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &S,  &S,     &M      ) ); MOD_MUL( S );
 3917              		.loc 1 1321 69
 3918 0c02 90       		nop
 3919 0c03 EB1C     		jmp	.L248
 3920              	.L363:
1322:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &S,  &S,     &U      ) ); MOD_SUB( S );
 3921              		.loc 1 1322 5
 3922 0c05 90       		nop
 3923 0c06 EB19     		jmp	.L248
 3924              	.L364:
1322:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &S,  &S,     &U      ) ); MOD_SUB( S );
 3925              		.loc 1 1322 69
 3926 0c08 90       		nop
 3927 0c09 EB16     		jmp	.L248
 3928              	.L365:
1323:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 3929              		.loc 1 1323 5
 3930 0c0b 90       		nop
 3931 0c0c EB13     		jmp	.L248
 3932              	.L366:
1323:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 3933              		.loc 1 1323 69
 3934 0c0e 90       		nop
 3935 0c0f EB10     		jmp	.L248
 3936              	.L367:
1326:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_shift_l( &U,  1               ) ); MOD_ADD( U );
 3937              		.loc 1 1326 5
 3938 0c11 90       		nop
 3939 0c12 EB0D     		jmp	.L248
 3940              	.L368:
1326:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_shift_l( &U,  1               ) ); MOD_ADD( U );
 3941              		.loc 1 1326 69
 3942 0c14 90       		nop
 3943 0c15 EB0A     		jmp	.L248
 3944              	.L369:
1327:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 3945              		.loc 1 1327 5
 3946 0c17 90       		nop
 3947 0c18 EB07     		jmp	.L248
 3948              	.L370:
1327:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 3949              		.loc 1 1327 69
 3950 0c1a 90       		nop
 3951 0c1b EB04     		jmp	.L248
 3952              	.L371:
1329:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &R->Y, &S ) );
 3953              		.loc 1 1329 5
 3954 0c1d 90       		nop
 3955 0c1e EB01     		jmp	.L248
GAS LISTING /tmp/ccajKZL5.s 			page 109


 3956              	.L372:
1330:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &R->Z, &U ) );
 3957              		.loc 1 1330 5
 3958 0c20 90       		nop
 3959              	.L248:
1334:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_free( &M ); mbedtls_mpi_free( &S ); mbedtls_mpi_free( &T ); mbedtls_mpi_free( &U );
 3960              		.loc 1 1334 5
 3961 0c21 488D4580 		leaq	-128(%rbp), %rax
 3962 0c25 4889C7   		movq	%rax, %rdi
 3963 0c28 E8000000 		call	mbedtls_mpi_free@PLT
 3963      00
 3964              		.loc 1 1334 29
 3965 0c2d 488D45A0 		leaq	-96(%rbp), %rax
 3966 0c31 4889C7   		movq	%rax, %rdi
 3967 0c34 E8000000 		call	mbedtls_mpi_free@PLT
 3967      00
 3968              		.loc 1 1334 53
 3969 0c39 488D45C0 		leaq	-64(%rbp), %rax
 3970 0c3d 4889C7   		movq	%rax, %rdi
 3971 0c40 E8000000 		call	mbedtls_mpi_free@PLT
 3971      00
 3972              		.loc 1 1334 77
 3973 0c45 488D45E0 		leaq	-32(%rbp), %rax
 3974 0c49 4889C7   		movq	%rax, %rdi
 3975 0c4c E8000000 		call	mbedtls_mpi_free@PLT
 3975      00
1335:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1336:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 3976              		.loc 1 1336 11
 3977 0c51 8B857CFF 		movl	-132(%rbp), %eax
 3977      FFFF
1337:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 3978              		.loc 1 1337 1
 3979 0c57 488B4DF8 		movq	-8(%rbp), %rcx
 3980 0c5b 6448330C 		xorq	%fs:40, %rcx
 3980      25280000 
 3980      00
 3981 0c64 7405     		je	.L320
 3982 0c66 E8000000 		call	__stack_chk_fail@PLT
 3982      00
 3983              	.L320:
 3984 0c6b C9       		leave
 3985              	.LCFI89:
 3986              		.cfi_def_cfa 7, 8
 3987 0c6c C3       		ret
 3988              		.cfi_endproc
 3989              	.LFE35:
 3991              		.section	.text.ecp_add_mixed,"ax",@progbits
 3993              	ecp_add_mixed:
 3994              	.LFB36:
1338:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1339:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
1340:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Addition: R = P + Q, mixed affine-Jacobian coordinates (GECC 3.22)
1341:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1342:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * The coordinates of Q must be normalized (= affine),
1343:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * but those of P don't need to. R is not normalized.
1344:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
GAS LISTING /tmp/ccajKZL5.s 			page 110


1345:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Special cases: (1) P or Q is zero, (2) R is zero, (3) P == Q.
1346:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * None of these cases can happen as intermediate step in ecp_mul_comb():
1347:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * - at each step, P, Q and R are multiples of the base point, the factor
1348:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   being less than its order, so none of them is zero;
1349:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * - Q is an odd multiple of the base point, P an even multiple,
1350:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   due to the choice of precomputed points in the modified comb method.
1351:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * So branches for these cases do not leak secret information.
1352:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1353:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * We accept Q->Z being unset (saving memory in tables) as meaning 1.
1354:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1355:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Cost: 1A := 8M + 3S
1356:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
1357:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static int ecp_add_mixed( const mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
1358:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                           const mbedtls_ecp_point *P, const mbedtls_ecp_point *Q )
1359:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 3995              		.loc 1 1359 1
 3996              		.cfi_startproc
 3997 0000 F30F1EFA 		endbr64
 3998 0004 55       		pushq	%rbp
 3999              	.LCFI90:
 4000              		.cfi_def_cfa_offset 16
 4001              		.cfi_offset 6, -16
 4002 0005 4889E5   		movq	%rsp, %rbp
 4003              	.LCFI91:
 4004              		.cfi_def_cfa_register 6
 4005 0008 4881EC10 		subq	$272, %rsp
 4005      010000
 4006 000f 4889BD08 		movq	%rdi, -248(%rbp)
 4006      FFFFFF
 4007 0016 4889B500 		movq	%rsi, -256(%rbp)
 4007      FFFFFF
 4008 001d 488995F8 		movq	%rdx, -264(%rbp)
 4008      FEFFFF
 4009 0024 48898DF0 		movq	%rcx, -272(%rbp)
 4009      FEFFFF
 4010              		.loc 1 1359 1
 4011 002b 64488B04 		movq	%fs:40, %rax
 4011      25280000 
 4011      00
 4012 0034 488945F8 		movq	%rax, -8(%rbp)
 4013 0038 31C0     		xorl	%eax, %eax
1360:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
1361:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi T1, T2, T3, T4, X, Y, Z;
1362:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1363:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_SELF_TEST)
1364:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     add_count++;
1365:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
1366:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1367:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_ADD_MIXED_ALT)
1368:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( mbedtls_internal_ecp_grp_capable( grp ) )
1369:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( mbedtls_internal_ecp_add_mixed( grp, R, P, Q ) );
1370:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif /* MBEDTLS_ECP_ADD_MIXED_ALT */
1371:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1372:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
1373:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * Trivial cases: P == 0 or Q == 0 (case 1)
1374:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
1375:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( mbedtls_mpi_cmp_int( &P->Z, 0 ) == 0 )
GAS LISTING /tmp/ccajKZL5.s 			page 111


 4014              		.loc 1 1375 9
 4015 003a 488B85F8 		movq	-264(%rbp), %rax
 4015      FEFFFF
 4016 0041 4883C030 		addq	$48, %rax
 4017 0045 BE000000 		movl	$0, %esi
 4017      00
 4018 004a 4889C7   		movq	%rax, %rdi
 4019 004d E8000000 		call	mbedtls_mpi_cmp_int@PLT
 4019      00
 4020              		.loc 1 1375 7
 4021 0052 85C0     		testl	%eax, %eax
 4022 0054 751E     		jne	.L374
1376:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( mbedtls_ecp_copy( R, Q ) );
 4023              		.loc 1 1376 17
 4024 0056 488B95F0 		movq	-272(%rbp), %rdx
 4024      FEFFFF
 4025 005d 488B8500 		movq	-256(%rbp), %rax
 4025      FFFFFF
 4026 0064 4889D6   		movq	%rdx, %rsi
 4027 0067 4889C7   		movq	%rax, %rdi
 4028 006a E8000000 		call	mbedtls_ecp_copy
 4028      00
 4029 006f E95D0A00 		jmp	.L432
 4029      00
 4030              	.L374:
1377:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1378:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( Q->Z.p != NULL && mbedtls_mpi_cmp_int( &Q->Z, 0 ) == 0 )
 4031              		.loc 1 1378 13
 4032 0074 488B85F0 		movq	-272(%rbp), %rax
 4032      FEFFFF
 4033 007b 488B4040 		movq	64(%rax), %rax
 4034              		.loc 1 1378 7
 4035 007f 4885C0   		testq	%rax, %rax
 4036 0082 743A     		je	.L376
 4037              		.loc 1 1378 27 discriminator 1
 4038 0084 488B85F0 		movq	-272(%rbp), %rax
 4038      FEFFFF
 4039 008b 4883C030 		addq	$48, %rax
 4040 008f BE000000 		movl	$0, %esi
 4040      00
 4041 0094 4889C7   		movq	%rax, %rdi
 4042 0097 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 4042      00
 4043              		.loc 1 1378 24 discriminator 1
 4044 009c 85C0     		testl	%eax, %eax
 4045 009e 751E     		jne	.L376
1379:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( mbedtls_ecp_copy( R, P ) );
 4046              		.loc 1 1379 17
 4047 00a0 488B95F8 		movq	-264(%rbp), %rdx
 4047      FEFFFF
 4048 00a7 488B8500 		movq	-256(%rbp), %rax
 4048      FFFFFF
 4049 00ae 4889D6   		movq	%rdx, %rsi
 4050 00b1 4889C7   		movq	%rax, %rdi
 4051 00b4 E8000000 		call	mbedtls_ecp_copy
 4051      00
 4052 00b9 E9130A00 		jmp	.L432
GAS LISTING /tmp/ccajKZL5.s 			page 112


 4052      00
 4053              	.L376:
1380:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1381:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
1382:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * Make sure Q coordinates are normalized
1383:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
1384:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( Q->Z.p != NULL && mbedtls_mpi_cmp_int( &Q->Z, 1 ) != 0 )
 4054              		.loc 1 1384 13
 4055 00be 488B85F0 		movq	-272(%rbp), %rax
 4055      FEFFFF
 4056 00c5 488B4040 		movq	64(%rax), %rax
 4057              		.loc 1 1384 7
 4058 00c9 4885C0   		testq	%rax, %rax
 4059 00cc 7426     		je	.L377
 4060              		.loc 1 1384 27 discriminator 1
 4061 00ce 488B85F0 		movq	-272(%rbp), %rax
 4061      FEFFFF
 4062 00d5 4883C030 		addq	$48, %rax
 4063 00d9 BE010000 		movl	$1, %esi
 4063      00
 4064 00de 4889C7   		movq	%rax, %rdi
 4065 00e1 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 4065      00
 4066              		.loc 1 1384 24 discriminator 1
 4067 00e6 85C0     		testl	%eax, %eax
 4068 00e8 740A     		je	.L377
1385:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( MBEDTLS_ERR_ECP_BAD_INPUT_DATA );
 4069              		.loc 1 1385 15
 4070 00ea B880B0FF 		movl	$-20352, %eax
 4070      FF
 4071 00ef E9DD0900 		jmp	.L432
 4071      00
 4072              	.L377:
1386:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1387:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_init( &T1 ); mbedtls_mpi_init( &T2 ); mbedtls_mpi_init( &T3 ); mbedtls_mpi_init( &T
 4073              		.loc 1 1387 5
 4074 00f4 488D8520 		leaq	-224(%rbp), %rax
 4074      FFFFFF
 4075 00fb 4889C7   		movq	%rax, %rdi
 4076 00fe E8000000 		call	mbedtls_mpi_init@PLT
 4076      00
 4077              		.loc 1 1387 30
 4078 0103 488D8540 		leaq	-192(%rbp), %rax
 4078      FFFFFF
 4079 010a 4889C7   		movq	%rax, %rdi
 4080 010d E8000000 		call	mbedtls_mpi_init@PLT
 4080      00
 4081              		.loc 1 1387 55
 4082 0112 488D8560 		leaq	-160(%rbp), %rax
 4082      FFFFFF
 4083 0119 4889C7   		movq	%rax, %rdi
 4084 011c E8000000 		call	mbedtls_mpi_init@PLT
 4084      00
 4085              		.loc 1 1387 80
 4086 0121 488D4580 		leaq	-128(%rbp), %rax
 4087 0125 4889C7   		movq	%rax, %rdi
 4088 0128 E8000000 		call	mbedtls_mpi_init@PLT
GAS LISTING /tmp/ccajKZL5.s 			page 113


 4088      00
1388:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_init( &X ); mbedtls_mpi_init( &Y ); mbedtls_mpi_init( &Z );
 4089              		.loc 1 1388 5
 4090 012d 488D45A0 		leaq	-96(%rbp), %rax
 4091 0131 4889C7   		movq	%rax, %rdi
 4092 0134 E8000000 		call	mbedtls_mpi_init@PLT
 4092      00
 4093              		.loc 1 1388 29
 4094 0139 488D45C0 		leaq	-64(%rbp), %rax
 4095 013d 4889C7   		movq	%rax, %rdi
 4096 0140 E8000000 		call	mbedtls_mpi_init@PLT
 4096      00
 4097              		.loc 1 1388 53
 4098 0145 488D45E0 		leaq	-32(%rbp), %rax
 4099 0149 4889C7   		movq	%rax, %rdi
 4100 014c E8000000 		call	mbedtls_mpi_init@PLT
 4100      00
1389:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1390:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T1,  &P->Z,  &P->Z ) );  MOD_MUL( T1 );
 4101              		.loc 1 1390 5
 4102 0151 488B85F8 		movq	-264(%rbp), %rax
 4102      FEFFFF
 4103 0158 488D5030 		leaq	48(%rax), %rdx
 4104 015c 488B85F8 		movq	-264(%rbp), %rax
 4104      FEFFFF
 4105 0163 488D4830 		leaq	48(%rax), %rcx
 4106 0167 488D8520 		leaq	-224(%rbp), %rax
 4106      FFFFFF
 4107 016e 4889CE   		movq	%rcx, %rsi
 4108 0171 4889C7   		movq	%rax, %rdi
 4109 0174 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 4109      00
 4110 0179 89851CFF 		movl	%eax, -228(%rbp)
 4110      FFFF
 4111 017f 83BD1CFF 		cmpl	$0, -228(%rbp)
 4111      FFFF00
 4112 0186 0F857208 		jne	.L434
 4112      0000
 4113              		.loc 1 1390 69 discriminator 2
 4114 018c 488B9508 		movq	-248(%rbp), %rdx
 4114      FFFFFF
 4115 0193 488D8520 		leaq	-224(%rbp), %rax
 4115      FFFFFF
 4116 019a 4889D6   		movq	%rdx, %rsi
 4117 019d 4889C7   		movq	%rax, %rdi
 4118 01a0 E8000000 		call	ecp_modp
 4118      00
 4119 01a5 89851CFF 		movl	%eax, -228(%rbp)
 4119      FFFF
 4120 01ab 83BD1CFF 		cmpl	$0, -228(%rbp)
 4120      FFFF00
 4121 01b2 0F854908 		jne	.L435
 4121      0000
1391:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T2,  &T1,    &P->Z ) );  MOD_MUL( T2 );
 4122              		.loc 1 1391 5
 4123 01b8 488B85F8 		movq	-264(%rbp), %rax
 4123      FEFFFF
GAS LISTING /tmp/ccajKZL5.s 			page 114


 4124 01bf 488D5030 		leaq	48(%rax), %rdx
 4125 01c3 488D8D20 		leaq	-224(%rbp), %rcx
 4125      FFFFFF
 4126 01ca 488D8540 		leaq	-192(%rbp), %rax
 4126      FFFFFF
 4127 01d1 4889CE   		movq	%rcx, %rsi
 4128 01d4 4889C7   		movq	%rax, %rdi
 4129 01d7 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 4129      00
 4130 01dc 89851CFF 		movl	%eax, -228(%rbp)
 4130      FFFF
 4131 01e2 83BD1CFF 		cmpl	$0, -228(%rbp)
 4131      FFFF00
 4132 01e9 0F851508 		jne	.L436
 4132      0000
 4133              		.loc 1 1391 69 discriminator 2
 4134 01ef 488B9508 		movq	-248(%rbp), %rdx
 4134      FFFFFF
 4135 01f6 488D8540 		leaq	-192(%rbp), %rax
 4135      FFFFFF
 4136 01fd 4889D6   		movq	%rdx, %rsi
 4137 0200 4889C7   		movq	%rax, %rdi
 4138 0203 E8000000 		call	ecp_modp
 4138      00
 4139 0208 89851CFF 		movl	%eax, -228(%rbp)
 4139      FFFF
 4140 020e 83BD1CFF 		cmpl	$0, -228(%rbp)
 4140      FFFF00
 4141 0215 0F85EC07 		jne	.L437
 4141      0000
1392:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T1,  &T1,    &Q->X ) );  MOD_MUL( T1 );
 4142              		.loc 1 1392 5
 4143 021b 488B95F0 		movq	-272(%rbp), %rdx
 4143      FEFFFF
 4144 0222 488D8D20 		leaq	-224(%rbp), %rcx
 4144      FFFFFF
 4145 0229 488D8520 		leaq	-224(%rbp), %rax
 4145      FFFFFF
 4146 0230 4889CE   		movq	%rcx, %rsi
 4147 0233 4889C7   		movq	%rax, %rdi
 4148 0236 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 4148      00
 4149 023b 89851CFF 		movl	%eax, -228(%rbp)
 4149      FFFF
 4150 0241 83BD1CFF 		cmpl	$0, -228(%rbp)
 4150      FFFF00
 4151 0248 0F85BC07 		jne	.L438
 4151      0000
 4152              		.loc 1 1392 69 discriminator 2
 4153 024e 488B9508 		movq	-248(%rbp), %rdx
 4153      FFFFFF
 4154 0255 488D8520 		leaq	-224(%rbp), %rax
 4154      FFFFFF
 4155 025c 4889D6   		movq	%rdx, %rsi
 4156 025f 4889C7   		movq	%rax, %rdi
 4157 0262 E8000000 		call	ecp_modp
 4157      00
GAS LISTING /tmp/ccajKZL5.s 			page 115


 4158 0267 89851CFF 		movl	%eax, -228(%rbp)
 4158      FFFF
 4159 026d 83BD1CFF 		cmpl	$0, -228(%rbp)
 4159      FFFF00
 4160 0274 0F859307 		jne	.L439
 4160      0000
1393:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T2,  &T2,    &Q->Y ) );  MOD_MUL( T2 );
 4161              		.loc 1 1393 5
 4162 027a 488B85F0 		movq	-272(%rbp), %rax
 4162      FEFFFF
 4163 0281 488D5018 		leaq	24(%rax), %rdx
 4164 0285 488D8D40 		leaq	-192(%rbp), %rcx
 4164      FFFFFF
 4165 028c 488D8540 		leaq	-192(%rbp), %rax
 4165      FFFFFF
 4166 0293 4889CE   		movq	%rcx, %rsi
 4167 0296 4889C7   		movq	%rax, %rdi
 4168 0299 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 4168      00
 4169 029e 89851CFF 		movl	%eax, -228(%rbp)
 4169      FFFF
 4170 02a4 83BD1CFF 		cmpl	$0, -228(%rbp)
 4170      FFFF00
 4171 02ab 0F855F07 		jne	.L440
 4171      0000
 4172              		.loc 1 1393 69 discriminator 2
 4173 02b1 488B9508 		movq	-248(%rbp), %rdx
 4173      FFFFFF
 4174 02b8 488D8540 		leaq	-192(%rbp), %rax
 4174      FFFFFF
 4175 02bf 4889D6   		movq	%rdx, %rsi
 4176 02c2 4889C7   		movq	%rax, %rdi
 4177 02c5 E8000000 		call	ecp_modp
 4177      00
 4178 02ca 89851CFF 		movl	%eax, -228(%rbp)
 4178      FFFF
 4179 02d0 83BD1CFF 		cmpl	$0, -228(%rbp)
 4179      FFFF00
 4180 02d7 0F853607 		jne	.L441
 4180      0000
1394:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &T1,  &T1,    &P->X ) );  MOD_SUB( T1 );
 4181              		.loc 1 1394 5
 4182 02dd 488B95F8 		movq	-264(%rbp), %rdx
 4182      FEFFFF
 4183 02e4 488D8D20 		leaq	-224(%rbp), %rcx
 4183      FFFFFF
 4184 02eb 488D8520 		leaq	-224(%rbp), %rax
 4184      FFFFFF
 4185 02f2 4889CE   		movq	%rcx, %rsi
 4186 02f5 4889C7   		movq	%rax, %rdi
 4187 02f8 E8000000 		call	mbedtls_mpi_sub_mpi@PLT
 4187      00
 4188 02fd 89851CFF 		movl	%eax, -228(%rbp)
 4188      FFFF
 4189 0303 83BD1CFF 		cmpl	$0, -228(%rbp)
 4189      FFFF00
 4190 030a 0F850607 		jne	.L442
GAS LISTING /tmp/ccajKZL5.s 			page 116


 4190      0000
 4191              		.loc 1 1394 69
 4192 0310 EB37     		jmp	.L388
 4193              	.L390:
 4194              		.loc 1 1394 69 is_stmt 0 discriminator 5
 4195 0312 488B8508 		movq	-248(%rbp), %rax
 4195      FFFFFF
 4196 0319 488D5008 		leaq	8(%rax), %rdx
 4197 031d 488D8D20 		leaq	-224(%rbp), %rcx
 4197      FFFFFF
 4198 0324 488D8520 		leaq	-224(%rbp), %rax
 4198      FFFFFF
 4199 032b 4889CE   		movq	%rcx, %rsi
 4200 032e 4889C7   		movq	%rax, %rdi
 4201 0331 E8000000 		call	mbedtls_mpi_add_mpi@PLT
 4201      00
 4202 0336 89851CFF 		movl	%eax, -228(%rbp)
 4202      FFFF
 4203 033c 83BD1CFF 		cmpl	$0, -228(%rbp)
 4203      FFFF00
 4204 0343 0F85D006 		jne	.L443
 4204      0000
 4205              	.L388:
 4206              		.loc 1 1394 69 discriminator 3
 4207 0349 8B8520FF 		movl	-224(%rbp), %eax
 4207      FFFF
 4208 034f 85C0     		testl	%eax, %eax
 4209 0351 7918     		jns	.L389
 4210              		.loc 1 1394 69 discriminator 4
 4211 0353 488D8520 		leaq	-224(%rbp), %rax
 4211      FFFFFF
 4212 035a BE000000 		movl	$0, %esi
 4212      00
 4213 035f 4889C7   		movq	%rax, %rdi
 4214 0362 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 4214      00
 4215 0367 85C0     		testl	%eax, %eax
 4216 0369 75A7     		jne	.L390
 4217              	.L389:
1395:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &T2,  &T2,    &P->Y ) );  MOD_SUB( T2 );
 4218              		.loc 1 1395 5 is_stmt 1
 4219 036b 488B85F8 		movq	-264(%rbp), %rax
 4219      FEFFFF
 4220 0372 488D5018 		leaq	24(%rax), %rdx
 4221 0376 488D8D40 		leaq	-192(%rbp), %rcx
 4221      FFFFFF
 4222 037d 488D8540 		leaq	-192(%rbp), %rax
 4222      FFFFFF
 4223 0384 4889CE   		movq	%rcx, %rsi
 4224 0387 4889C7   		movq	%rax, %rdi
 4225 038a E8000000 		call	mbedtls_mpi_sub_mpi@PLT
 4225      00
 4226 038f 89851CFF 		movl	%eax, -228(%rbp)
 4226      FFFF
 4227 0395 83BD1CFF 		cmpl	$0, -228(%rbp)
 4227      FFFF00
 4228 039c 0F857A06 		jne	.L444
GAS LISTING /tmp/ccajKZL5.s 			page 117


 4228      0000
 4229              		.loc 1 1395 69
 4230 03a2 EB37     		jmp	.L392
 4231              	.L394:
 4232              		.loc 1 1395 69 is_stmt 0 discriminator 5
 4233 03a4 488B8508 		movq	-248(%rbp), %rax
 4233      FFFFFF
 4234 03ab 488D5008 		leaq	8(%rax), %rdx
 4235 03af 488D8D40 		leaq	-192(%rbp), %rcx
 4235      FFFFFF
 4236 03b6 488D8540 		leaq	-192(%rbp), %rax
 4236      FFFFFF
 4237 03bd 4889CE   		movq	%rcx, %rsi
 4238 03c0 4889C7   		movq	%rax, %rdi
 4239 03c3 E8000000 		call	mbedtls_mpi_add_mpi@PLT
 4239      00
 4240 03c8 89851CFF 		movl	%eax, -228(%rbp)
 4240      FFFF
 4241 03ce 83BD1CFF 		cmpl	$0, -228(%rbp)
 4241      FFFF00
 4242 03d5 0F854406 		jne	.L445
 4242      0000
 4243              	.L392:
 4244              		.loc 1 1395 69 discriminator 3
 4245 03db 8B8540FF 		movl	-192(%rbp), %eax
 4245      FFFF
 4246 03e1 85C0     		testl	%eax, %eax
 4247 03e3 7918     		jns	.L393
 4248              		.loc 1 1395 69 discriminator 4
 4249 03e5 488D8540 		leaq	-192(%rbp), %rax
 4249      FFFFFF
 4250 03ec BE000000 		movl	$0, %esi
 4250      00
 4251 03f1 4889C7   		movq	%rax, %rdi
 4252 03f4 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 4252      00
 4253 03f9 85C0     		testl	%eax, %eax
 4254 03fb 75A7     		jne	.L394
 4255              	.L393:
1396:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1397:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Special cases (2) and (3) */
1398:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( mbedtls_mpi_cmp_int( &T1, 0 ) == 0 )
 4256              		.loc 1 1398 9 is_stmt 1
 4257 03fd 488D8520 		leaq	-224(%rbp), %rax
 4257      FFFFFF
 4258 0404 BE000000 		movl	$0, %esi
 4258      00
 4259 0409 4889C7   		movq	%rax, %rdi
 4260 040c E8000000 		call	mbedtls_mpi_cmp_int@PLT
 4260      00
 4261              		.loc 1 1398 7
 4262 0411 85C0     		testl	%eax, %eax
 4263 0413 755D     		jne	.L395
1399:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
1400:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( mbedtls_mpi_cmp_int( &T2, 0 ) == 0 )
 4264              		.loc 1 1400 13
 4265 0415 488D8540 		leaq	-192(%rbp), %rax
GAS LISTING /tmp/ccajKZL5.s 			page 118


 4265      FFFFFF
 4266 041c BE000000 		movl	$0, %esi
 4266      00
 4267 0421 4889C7   		movq	%rax, %rdi
 4268 0424 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 4268      00
 4269              		.loc 1 1400 11
 4270 0429 85C0     		testl	%eax, %eax
 4271 042b 752B     		jne	.L396
1401:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         {
1402:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             ret = ecp_double_jac( grp, R, P );
 4272              		.loc 1 1402 19
 4273 042d 488B95F8 		movq	-264(%rbp), %rdx
 4273      FEFFFF
 4274 0434 488B8D00 		movq	-256(%rbp), %rcx
 4274      FFFFFF
 4275 043b 488B8508 		movq	-248(%rbp), %rax
 4275      FFFFFF
 4276 0442 4889CE   		movq	%rcx, %rsi
 4277 0445 4889C7   		movq	%rax, %rdi
 4278 0448 E8000000 		call	ecp_double_jac
 4278      00
 4279 044d 89851CFF 		movl	%eax, -228(%rbp)
 4279      FFFF
1403:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             goto cleanup;
 4280              		.loc 1 1403 13
 4281 0453 E9160600 		jmp	.L379
 4281      00
 4282              	.L396:
1404:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         }
1405:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         else
1406:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         {
1407:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             ret = mbedtls_ecp_set_zero( R );
 4283              		.loc 1 1407 19
 4284 0458 488B8500 		movq	-256(%rbp), %rax
 4284      FFFFFF
 4285 045f 4889C7   		movq	%rax, %rdi
 4286 0462 E8000000 		call	mbedtls_ecp_set_zero
 4286      00
 4287 0467 89851CFF 		movl	%eax, -228(%rbp)
 4287      FFFF
1408:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             goto cleanup;
 4288              		.loc 1 1408 13
 4289 046d E9FC0500 		jmp	.L379
 4289      00
 4290              	.L395:
1409:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         }
1410:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
1411:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1412:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &Z,   &P->Z,  &T1   ) );  MOD_MUL( Z  );
 4291              		.loc 1 1412 5
 4292 0472 488B85F8 		movq	-264(%rbp), %rax
 4292      FEFFFF
 4293 0479 488D4830 		leaq	48(%rax), %rcx
 4294 047d 488D9520 		leaq	-224(%rbp), %rdx
 4294      FFFFFF
 4295 0484 488D45E0 		leaq	-32(%rbp), %rax
GAS LISTING /tmp/ccajKZL5.s 			page 119


 4296 0488 4889CE   		movq	%rcx, %rsi
 4297 048b 4889C7   		movq	%rax, %rdi
 4298 048e E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 4298      00
 4299 0493 89851CFF 		movl	%eax, -228(%rbp)
 4299      FFFF
 4300 0499 83BD1CFF 		cmpl	$0, -228(%rbp)
 4300      FFFF00
 4301 04a0 0F857C05 		jne	.L446
 4301      0000
 4302              		.loc 1 1412 69 discriminator 2
 4303 04a6 488B9508 		movq	-248(%rbp), %rdx
 4303      FFFFFF
 4304 04ad 488D45E0 		leaq	-32(%rbp), %rax
 4305 04b1 4889D6   		movq	%rdx, %rsi
 4306 04b4 4889C7   		movq	%rax, %rdi
 4307 04b7 E8000000 		call	ecp_modp
 4307      00
 4308 04bc 89851CFF 		movl	%eax, -228(%rbp)
 4308      FFFF
 4309 04c2 83BD1CFF 		cmpl	$0, -228(%rbp)
 4309      FFFF00
 4310 04c9 0F855605 		jne	.L447
 4310      0000
1413:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T3,  &T1,    &T1   ) );  MOD_MUL( T3 );
 4311              		.loc 1 1413 5
 4312 04cf 488D9520 		leaq	-224(%rbp), %rdx
 4312      FFFFFF
 4313 04d6 488D8D20 		leaq	-224(%rbp), %rcx
 4313      FFFFFF
 4314 04dd 488D8560 		leaq	-160(%rbp), %rax
 4314      FFFFFF
 4315 04e4 4889CE   		movq	%rcx, %rsi
 4316 04e7 4889C7   		movq	%rax, %rdi
 4317 04ea E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 4317      00
 4318 04ef 89851CFF 		movl	%eax, -228(%rbp)
 4318      FFFF
 4319 04f5 83BD1CFF 		cmpl	$0, -228(%rbp)
 4319      FFFF00
 4320 04fc 0F852605 		jne	.L448
 4320      0000
 4321              		.loc 1 1413 69 discriminator 2
 4322 0502 488B9508 		movq	-248(%rbp), %rdx
 4322      FFFFFF
 4323 0509 488D8560 		leaq	-160(%rbp), %rax
 4323      FFFFFF
 4324 0510 4889D6   		movq	%rdx, %rsi
 4325 0513 4889C7   		movq	%rax, %rdi
 4326 0516 E8000000 		call	ecp_modp
 4326      00
 4327 051b 89851CFF 		movl	%eax, -228(%rbp)
 4327      FFFF
 4328 0521 83BD1CFF 		cmpl	$0, -228(%rbp)
 4328      FFFF00
 4329 0528 0F85FD04 		jne	.L449
 4329      0000
GAS LISTING /tmp/ccajKZL5.s 			page 120


1414:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T4,  &T3,    &T1   ) );  MOD_MUL( T4 );
 4330              		.loc 1 1414 5
 4331 052e 488D9520 		leaq	-224(%rbp), %rdx
 4331      FFFFFF
 4332 0535 488D8D60 		leaq	-160(%rbp), %rcx
 4332      FFFFFF
 4333 053c 488D4580 		leaq	-128(%rbp), %rax
 4334 0540 4889CE   		movq	%rcx, %rsi
 4335 0543 4889C7   		movq	%rax, %rdi
 4336 0546 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 4336      00
 4337 054b 89851CFF 		movl	%eax, -228(%rbp)
 4337      FFFF
 4338 0551 83BD1CFF 		cmpl	$0, -228(%rbp)
 4338      FFFF00
 4339 0558 0F85D004 		jne	.L450
 4339      0000
 4340              		.loc 1 1414 69 discriminator 2
 4341 055e 488B9508 		movq	-248(%rbp), %rdx
 4341      FFFFFF
 4342 0565 488D4580 		leaq	-128(%rbp), %rax
 4343 0569 4889D6   		movq	%rdx, %rsi
 4344 056c 4889C7   		movq	%rax, %rdi
 4345 056f E8000000 		call	ecp_modp
 4345      00
 4346 0574 89851CFF 		movl	%eax, -228(%rbp)
 4346      FFFF
 4347 057a 83BD1CFF 		cmpl	$0, -228(%rbp)
 4347      FFFF00
 4348 0581 0F85AA04 		jne	.L451
 4348      0000
1415:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T3,  &T3,    &P->X ) );  MOD_MUL( T3 );
 4349              		.loc 1 1415 5
 4350 0587 488B95F8 		movq	-264(%rbp), %rdx
 4350      FEFFFF
 4351 058e 488D8D60 		leaq	-160(%rbp), %rcx
 4351      FFFFFF
 4352 0595 488D8560 		leaq	-160(%rbp), %rax
 4352      FFFFFF
 4353 059c 4889CE   		movq	%rcx, %rsi
 4354 059f 4889C7   		movq	%rax, %rdi
 4355 05a2 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 4355      00
 4356 05a7 89851CFF 		movl	%eax, -228(%rbp)
 4356      FFFF
 4357 05ad 83BD1CFF 		cmpl	$0, -228(%rbp)
 4357      FFFF00
 4358 05b4 0F857A04 		jne	.L452
 4358      0000
 4359              		.loc 1 1415 69 discriminator 2
 4360 05ba 488B9508 		movq	-248(%rbp), %rdx
 4360      FFFFFF
 4361 05c1 488D8560 		leaq	-160(%rbp), %rax
 4361      FFFFFF
 4362 05c8 4889D6   		movq	%rdx, %rsi
 4363 05cb 4889C7   		movq	%rax, %rdi
 4364 05ce E8000000 		call	ecp_modp
GAS LISTING /tmp/ccajKZL5.s 			page 121


 4364      00
 4365 05d3 89851CFF 		movl	%eax, -228(%rbp)
 4365      FFFF
 4366 05d9 83BD1CFF 		cmpl	$0, -228(%rbp)
 4366      FFFF00
 4367 05e0 0F855104 		jne	.L453
 4367      0000
1416:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_int( &T1,  &T3,    2     ) );  MOD_ADD( T1 );
 4368              		.loc 1 1416 5
 4369 05e6 488D8D60 		leaq	-160(%rbp), %rcx
 4369      FFFFFF
 4370 05ed 488D8520 		leaq	-224(%rbp), %rax
 4370      FFFFFF
 4371 05f4 BA020000 		movl	$2, %edx
 4371      00
 4372 05f9 4889CE   		movq	%rcx, %rsi
 4373 05fc 4889C7   		movq	%rax, %rdi
 4374 05ff E8000000 		call	mbedtls_mpi_mul_int@PLT
 4374      00
 4375 0604 89851CFF 		movl	%eax, -228(%rbp)
 4375      FFFF
 4376 060a 83BD1CFF 		cmpl	$0, -228(%rbp)
 4376      FFFF00
 4377 0611 0F852304 		jne	.L454
 4377      0000
 4378              		.loc 1 1416 69
 4379 0617 EB37     		jmp	.L406
 4380              	.L407:
 4381              		.loc 1 1416 69 is_stmt 0 discriminator 4
 4382 0619 488B8508 		movq	-248(%rbp), %rax
 4382      FFFFFF
 4383 0620 488D5008 		leaq	8(%rax), %rdx
 4384 0624 488D8D20 		leaq	-224(%rbp), %rcx
 4384      FFFFFF
 4385 062b 488D8520 		leaq	-224(%rbp), %rax
 4385      FFFFFF
 4386 0632 4889CE   		movq	%rcx, %rsi
 4387 0635 4889C7   		movq	%rax, %rdi
 4388 0638 E8000000 		call	mbedtls_mpi_sub_abs@PLT
 4388      00
 4389 063d 89851CFF 		movl	%eax, -228(%rbp)
 4389      FFFF
 4390 0643 83BD1CFF 		cmpl	$0, -228(%rbp)
 4390      FFFF00
 4391 064a 0F85ED03 		jne	.L455
 4391      0000
 4392              	.L406:
 4393              		.loc 1 1416 69 discriminator 3
 4394 0650 488B8508 		movq	-248(%rbp), %rax
 4394      FFFFFF
 4395 0657 488D5008 		leaq	8(%rax), %rdx
 4396 065b 488D8520 		leaq	-224(%rbp), %rax
 4396      FFFFFF
 4397 0662 4889D6   		movq	%rdx, %rsi
 4398 0665 4889C7   		movq	%rax, %rdi
 4399 0668 E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 4399      00
GAS LISTING /tmp/ccajKZL5.s 			page 122


 4400 066d 85C0     		testl	%eax, %eax
 4401 066f 79A8     		jns	.L407
1417:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &X,   &T2,    &T2   ) );  MOD_MUL( X  );
 4402              		.loc 1 1417 5 is_stmt 1
 4403 0671 488D9540 		leaq	-192(%rbp), %rdx
 4403      FFFFFF
 4404 0678 488D8D40 		leaq	-192(%rbp), %rcx
 4404      FFFFFF
 4405 067f 488D45A0 		leaq	-96(%rbp), %rax
 4406 0683 4889CE   		movq	%rcx, %rsi
 4407 0686 4889C7   		movq	%rax, %rdi
 4408 0689 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 4408      00
 4409 068e 89851CFF 		movl	%eax, -228(%rbp)
 4409      FFFF
 4410 0694 83BD1CFF 		cmpl	$0, -228(%rbp)
 4410      FFFF00
 4411 069b 0F859F03 		jne	.L456
 4411      0000
 4412              		.loc 1 1417 69 discriminator 2
 4413 06a1 488B9508 		movq	-248(%rbp), %rdx
 4413      FFFFFF
 4414 06a8 488D45A0 		leaq	-96(%rbp), %rax
 4415 06ac 4889D6   		movq	%rdx, %rsi
 4416 06af 4889C7   		movq	%rax, %rdi
 4417 06b2 E8000000 		call	ecp_modp
 4417      00
 4418 06b7 89851CFF 		movl	%eax, -228(%rbp)
 4418      FFFF
 4419 06bd 83BD1CFF 		cmpl	$0, -228(%rbp)
 4419      FFFF00
 4420 06c4 0F857903 		jne	.L457
 4420      0000
1418:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &X,   &X,     &T1   ) );  MOD_SUB( X  );
 4421              		.loc 1 1418 5
 4422 06ca 488D9520 		leaq	-224(%rbp), %rdx
 4422      FFFFFF
 4423 06d1 488D4DA0 		leaq	-96(%rbp), %rcx
 4424 06d5 488D45A0 		leaq	-96(%rbp), %rax
 4425 06d9 4889CE   		movq	%rcx, %rsi
 4426 06dc 4889C7   		movq	%rax, %rdi
 4427 06df E8000000 		call	mbedtls_mpi_sub_mpi@PLT
 4427      00
 4428 06e4 89851CFF 		movl	%eax, -228(%rbp)
 4428      FFFF
 4429 06ea 83BD1CFF 		cmpl	$0, -228(%rbp)
 4429      FFFF00
 4430 06f1 0F854F03 		jne	.L458
 4430      0000
 4431              		.loc 1 1418 69
 4432 06f7 EB31     		jmp	.L411
 4433              	.L413:
 4434              		.loc 1 1418 69 is_stmt 0 discriminator 5
 4435 06f9 488B8508 		movq	-248(%rbp), %rax
 4435      FFFFFF
 4436 0700 488D5008 		leaq	8(%rax), %rdx
 4437 0704 488D4DA0 		leaq	-96(%rbp), %rcx
GAS LISTING /tmp/ccajKZL5.s 			page 123


 4438 0708 488D45A0 		leaq	-96(%rbp), %rax
 4439 070c 4889CE   		movq	%rcx, %rsi
 4440 070f 4889C7   		movq	%rax, %rdi
 4441 0712 E8000000 		call	mbedtls_mpi_add_mpi@PLT
 4441      00
 4442 0717 89851CFF 		movl	%eax, -228(%rbp)
 4442      FFFF
 4443 071d 83BD1CFF 		cmpl	$0, -228(%rbp)
 4443      FFFF00
 4444 0724 0F851F03 		jne	.L459
 4444      0000
 4445              	.L411:
 4446              		.loc 1 1418 69 discriminator 3
 4447 072a 8B45A0   		movl	-96(%rbp), %eax
 4448 072d 85C0     		testl	%eax, %eax
 4449 072f 7915     		jns	.L412
 4450              		.loc 1 1418 69 discriminator 4
 4451 0731 488D45A0 		leaq	-96(%rbp), %rax
 4452 0735 BE000000 		movl	$0, %esi
 4452      00
 4453 073a 4889C7   		movq	%rax, %rdi
 4454 073d E8000000 		call	mbedtls_mpi_cmp_int@PLT
 4454      00
 4455 0742 85C0     		testl	%eax, %eax
 4456 0744 75B3     		jne	.L413
 4457              	.L412:
1419:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &X,   &X,     &T4   ) );  MOD_SUB( X  );
 4458              		.loc 1 1419 5 is_stmt 1
 4459 0746 488D5580 		leaq	-128(%rbp), %rdx
 4460 074a 488D4DA0 		leaq	-96(%rbp), %rcx
 4461 074e 488D45A0 		leaq	-96(%rbp), %rax
 4462 0752 4889CE   		movq	%rcx, %rsi
 4463 0755 4889C7   		movq	%rax, %rdi
 4464 0758 E8000000 		call	mbedtls_mpi_sub_mpi@PLT
 4464      00
 4465 075d 89851CFF 		movl	%eax, -228(%rbp)
 4465      FFFF
 4466 0763 83BD1CFF 		cmpl	$0, -228(%rbp)
 4466      FFFF00
 4467 076a 0F85DC02 		jne	.L460
 4467      0000
 4468              		.loc 1 1419 69
 4469 0770 EB31     		jmp	.L415
 4470              	.L417:
 4471              		.loc 1 1419 69 is_stmt 0 discriminator 5
 4472 0772 488B8508 		movq	-248(%rbp), %rax
 4472      FFFFFF
 4473 0779 488D5008 		leaq	8(%rax), %rdx
 4474 077d 488D4DA0 		leaq	-96(%rbp), %rcx
 4475 0781 488D45A0 		leaq	-96(%rbp), %rax
 4476 0785 4889CE   		movq	%rcx, %rsi
 4477 0788 4889C7   		movq	%rax, %rdi
 4478 078b E8000000 		call	mbedtls_mpi_add_mpi@PLT
 4478      00
 4479 0790 89851CFF 		movl	%eax, -228(%rbp)
 4479      FFFF
 4480 0796 83BD1CFF 		cmpl	$0, -228(%rbp)
GAS LISTING /tmp/ccajKZL5.s 			page 124


 4480      FFFF00
 4481 079d 0F85AC02 		jne	.L461
 4481      0000
 4482              	.L415:
 4483              		.loc 1 1419 69 discriminator 3
 4484 07a3 8B45A0   		movl	-96(%rbp), %eax
 4485 07a6 85C0     		testl	%eax, %eax
 4486 07a8 7915     		jns	.L416
 4487              		.loc 1 1419 69 discriminator 4
 4488 07aa 488D45A0 		leaq	-96(%rbp), %rax
 4489 07ae BE000000 		movl	$0, %esi
 4489      00
 4490 07b3 4889C7   		movq	%rax, %rdi
 4491 07b6 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 4491      00
 4492 07bb 85C0     		testl	%eax, %eax
 4493 07bd 75B3     		jne	.L417
 4494              	.L416:
1420:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &T3,  &T3,    &X    ) );  MOD_SUB( T3 );
 4495              		.loc 1 1420 5 is_stmt 1
 4496 07bf 488D55A0 		leaq	-96(%rbp), %rdx
 4497 07c3 488D8D60 		leaq	-160(%rbp), %rcx
 4497      FFFFFF
 4498 07ca 488D8560 		leaq	-160(%rbp), %rax
 4498      FFFFFF
 4499 07d1 4889CE   		movq	%rcx, %rsi
 4500 07d4 4889C7   		movq	%rax, %rdi
 4501 07d7 E8000000 		call	mbedtls_mpi_sub_mpi@PLT
 4501      00
 4502 07dc 89851CFF 		movl	%eax, -228(%rbp)
 4502      FFFF
 4503 07e2 83BD1CFF 		cmpl	$0, -228(%rbp)
 4503      FFFF00
 4504 07e9 0F856302 		jne	.L462
 4504      0000
 4505              		.loc 1 1420 69
 4506 07ef EB37     		jmp	.L419
 4507              	.L421:
 4508              		.loc 1 1420 69 is_stmt 0 discriminator 5
 4509 07f1 488B8508 		movq	-248(%rbp), %rax
 4509      FFFFFF
 4510 07f8 488D5008 		leaq	8(%rax), %rdx
 4511 07fc 488D8D60 		leaq	-160(%rbp), %rcx
 4511      FFFFFF
 4512 0803 488D8560 		leaq	-160(%rbp), %rax
 4512      FFFFFF
 4513 080a 4889CE   		movq	%rcx, %rsi
 4514 080d 4889C7   		movq	%rax, %rdi
 4515 0810 E8000000 		call	mbedtls_mpi_add_mpi@PLT
 4515      00
 4516 0815 89851CFF 		movl	%eax, -228(%rbp)
 4516      FFFF
 4517 081b 83BD1CFF 		cmpl	$0, -228(%rbp)
 4517      FFFF00
 4518 0822 0F852D02 		jne	.L463
 4518      0000
 4519              	.L419:
GAS LISTING /tmp/ccajKZL5.s 			page 125


 4520              		.loc 1 1420 69 discriminator 3
 4521 0828 8B8560FF 		movl	-160(%rbp), %eax
 4521      FFFF
 4522 082e 85C0     		testl	%eax, %eax
 4523 0830 7918     		jns	.L420
 4524              		.loc 1 1420 69 discriminator 4
 4525 0832 488D8560 		leaq	-160(%rbp), %rax
 4525      FFFFFF
 4526 0839 BE000000 		movl	$0, %esi
 4526      00
 4527 083e 4889C7   		movq	%rax, %rdi
 4528 0841 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 4528      00
 4529 0846 85C0     		testl	%eax, %eax
 4530 0848 75A7     		jne	.L421
 4531              	.L420:
1421:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T3,  &T3,    &T2   ) );  MOD_MUL( T3 );
 4532              		.loc 1 1421 5 is_stmt 1
 4533 084a 488D9540 		leaq	-192(%rbp), %rdx
 4533      FFFFFF
 4534 0851 488D8D60 		leaq	-160(%rbp), %rcx
 4534      FFFFFF
 4535 0858 488D8560 		leaq	-160(%rbp), %rax
 4535      FFFFFF
 4536 085f 4889CE   		movq	%rcx, %rsi
 4537 0862 4889C7   		movq	%rax, %rdi
 4538 0865 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 4538      00
 4539 086a 89851CFF 		movl	%eax, -228(%rbp)
 4539      FFFF
 4540 0870 83BD1CFF 		cmpl	$0, -228(%rbp)
 4540      FFFF00
 4541 0877 0F85DB01 		jne	.L464
 4541      0000
 4542              		.loc 1 1421 69 discriminator 2
 4543 087d 488B9508 		movq	-248(%rbp), %rdx
 4543      FFFFFF
 4544 0884 488D8560 		leaq	-160(%rbp), %rax
 4544      FFFFFF
 4545 088b 4889D6   		movq	%rdx, %rsi
 4546 088e 4889C7   		movq	%rax, %rdi
 4547 0891 E8000000 		call	ecp_modp
 4547      00
 4548 0896 89851CFF 		movl	%eax, -228(%rbp)
 4548      FFFF
 4549 089c 83BD1CFF 		cmpl	$0, -228(%rbp)
 4549      FFFF00
 4550 08a3 0F85B201 		jne	.L465
 4550      0000
1422:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T4,  &T4,    &P->Y ) );  MOD_MUL( T4 );
 4551              		.loc 1 1422 5
 4552 08a9 488B85F8 		movq	-264(%rbp), %rax
 4552      FEFFFF
 4553 08b0 488D5018 		leaq	24(%rax), %rdx
 4554 08b4 488D4D80 		leaq	-128(%rbp), %rcx
 4555 08b8 488D4580 		leaq	-128(%rbp), %rax
 4556 08bc 4889CE   		movq	%rcx, %rsi
GAS LISTING /tmp/ccajKZL5.s 			page 126


 4557 08bf 4889C7   		movq	%rax, %rdi
 4558 08c2 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 4558      00
 4559 08c7 89851CFF 		movl	%eax, -228(%rbp)
 4559      FFFF
 4560 08cd 83BD1CFF 		cmpl	$0, -228(%rbp)
 4560      FFFF00
 4561 08d4 0F858401 		jne	.L466
 4561      0000
 4562              		.loc 1 1422 69 discriminator 2
 4563 08da 488B9508 		movq	-248(%rbp), %rdx
 4563      FFFFFF
 4564 08e1 488D4580 		leaq	-128(%rbp), %rax
 4565 08e5 4889D6   		movq	%rdx, %rsi
 4566 08e8 4889C7   		movq	%rax, %rdi
 4567 08eb E8000000 		call	ecp_modp
 4567      00
 4568 08f0 89851CFF 		movl	%eax, -228(%rbp)
 4568      FFFF
 4569 08f6 83BD1CFF 		cmpl	$0, -228(%rbp)
 4569      FFFF00
 4570 08fd 0F855E01 		jne	.L467
 4570      0000
1423:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &Y,   &T3,    &T4   ) );  MOD_SUB( Y  );
 4571              		.loc 1 1423 5
 4572 0903 488D5580 		leaq	-128(%rbp), %rdx
 4573 0907 488D8D60 		leaq	-160(%rbp), %rcx
 4573      FFFFFF
 4574 090e 488D45C0 		leaq	-64(%rbp), %rax
 4575 0912 4889CE   		movq	%rcx, %rsi
 4576 0915 4889C7   		movq	%rax, %rdi
 4577 0918 E8000000 		call	mbedtls_mpi_sub_mpi@PLT
 4577      00
 4578 091d 89851CFF 		movl	%eax, -228(%rbp)
 4578      FFFF
 4579 0923 83BD1CFF 		cmpl	$0, -228(%rbp)
 4579      FFFF00
 4580 092a 0F853401 		jne	.L468
 4580      0000
 4581              		.loc 1 1423 69
 4582 0930 EB31     		jmp	.L427
 4583              	.L429:
 4584              		.loc 1 1423 69 is_stmt 0 discriminator 5
 4585 0932 488B8508 		movq	-248(%rbp), %rax
 4585      FFFFFF
 4586 0939 488D5008 		leaq	8(%rax), %rdx
 4587 093d 488D4DC0 		leaq	-64(%rbp), %rcx
 4588 0941 488D45C0 		leaq	-64(%rbp), %rax
 4589 0945 4889CE   		movq	%rcx, %rsi
 4590 0948 4889C7   		movq	%rax, %rdi
 4591 094b E8000000 		call	mbedtls_mpi_add_mpi@PLT
 4591      00
 4592 0950 89851CFF 		movl	%eax, -228(%rbp)
 4592      FFFF
 4593 0956 83BD1CFF 		cmpl	$0, -228(%rbp)
 4593      FFFF00
 4594 095d 0F850401 		jne	.L469
GAS LISTING /tmp/ccajKZL5.s 			page 127


 4594      0000
 4595              	.L427:
 4596              		.loc 1 1423 69 discriminator 3
 4597 0963 8B45C0   		movl	-64(%rbp), %eax
 4598 0966 85C0     		testl	%eax, %eax
 4599 0968 7915     		jns	.L428
 4600              		.loc 1 1423 69 discriminator 4
 4601 096a 488D45C0 		leaq	-64(%rbp), %rax
 4602 096e BE000000 		movl	$0, %esi
 4602      00
 4603 0973 4889C7   		movq	%rax, %rdi
 4604 0976 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 4604      00
 4605 097b 85C0     		testl	%eax, %eax
 4606 097d 75B3     		jne	.L429
 4607              	.L428:
1424:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1425:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &R->X, &X ) );
 4608              		.loc 1 1425 5 is_stmt 1
 4609 097f 488B8500 		movq	-256(%rbp), %rax
 4609      FFFFFF
 4610 0986 488D55A0 		leaq	-96(%rbp), %rdx
 4611 098a 4889D6   		movq	%rdx, %rsi
 4612 098d 4889C7   		movq	%rax, %rdi
 4613 0990 E8000000 		call	mbedtls_mpi_copy@PLT
 4613      00
 4614 0995 89851CFF 		movl	%eax, -228(%rbp)
 4614      FFFF
 4615 099b 83BD1CFF 		cmpl	$0, -228(%rbp)
 4615      FFFF00
 4616 09a2 0F85C200 		jne	.L470
 4616      0000
1426:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &R->Y, &Y ) );
 4617              		.loc 1 1426 5
 4618 09a8 488B8500 		movq	-256(%rbp), %rax
 4618      FFFFFF
 4619 09af 488D5018 		leaq	24(%rax), %rdx
 4620 09b3 488D45C0 		leaq	-64(%rbp), %rax
 4621 09b7 4889C6   		movq	%rax, %rsi
 4622 09ba 4889D7   		movq	%rdx, %rdi
 4623 09bd E8000000 		call	mbedtls_mpi_copy@PLT
 4623      00
 4624 09c2 89851CFF 		movl	%eax, -228(%rbp)
 4624      FFFF
 4625 09c8 83BD1CFF 		cmpl	$0, -228(%rbp)
 4625      FFFF00
 4626 09cf 0F859800 		jne	.L471
 4626      0000
1427:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &R->Z, &Z ) );
 4627              		.loc 1 1427 5
 4628 09d5 488B8500 		movq	-256(%rbp), %rax
 4628      FFFFFF
 4629 09dc 488D5030 		leaq	48(%rax), %rdx
 4630 09e0 488D45E0 		leaq	-32(%rbp), %rax
 4631 09e4 4889C6   		movq	%rax, %rsi
 4632 09e7 4889D7   		movq	%rdx, %rdi
 4633 09ea E8000000 		call	mbedtls_mpi_copy@PLT
GAS LISTING /tmp/ccajKZL5.s 			page 128


 4633      00
 4634 09ef 89851CFF 		movl	%eax, -228(%rbp)
 4634      FFFF
 4635 09f5 83BD1CFF 		cmpl	$0, -228(%rbp)
 4635      FFFF00
1428:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1429:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
 4636              		.loc 1 1429 1
 4637 09fc EB70     		jmp	.L379
 4638              	.L434:
1390:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T2,  &T1,    &P->Z ) );  MOD_MUL( T2 );
 4639              		.loc 1 1390 5
 4640 09fe 90       		nop
 4641 09ff EB6D     		jmp	.L379
 4642              	.L435:
1390:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T2,  &T1,    &P->Z ) );  MOD_MUL( T2 );
 4643              		.loc 1 1390 69
 4644 0a01 90       		nop
 4645 0a02 EB6A     		jmp	.L379
 4646              	.L436:
1391:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T1,  &T1,    &Q->X ) );  MOD_MUL( T1 );
 4647              		.loc 1 1391 5
 4648 0a04 90       		nop
 4649 0a05 EB67     		jmp	.L379
 4650              	.L437:
1391:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T1,  &T1,    &Q->X ) );  MOD_MUL( T1 );
 4651              		.loc 1 1391 69
 4652 0a07 90       		nop
 4653 0a08 EB64     		jmp	.L379
 4654              	.L438:
1392:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T2,  &T2,    &Q->Y ) );  MOD_MUL( T2 );
 4655              		.loc 1 1392 5
 4656 0a0a 90       		nop
 4657 0a0b EB61     		jmp	.L379
 4658              	.L439:
1392:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T2,  &T2,    &Q->Y ) );  MOD_MUL( T2 );
 4659              		.loc 1 1392 69
 4660 0a0d 90       		nop
 4661 0a0e EB5E     		jmp	.L379
 4662              	.L440:
1393:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &T1,  &T1,    &P->X ) );  MOD_SUB( T1 );
 4663              		.loc 1 1393 5
 4664 0a10 90       		nop
 4665 0a11 EB5B     		jmp	.L379
 4666              	.L441:
1393:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &T1,  &T1,    &P->X ) );  MOD_SUB( T1 );
 4667              		.loc 1 1393 69
 4668 0a13 90       		nop
 4669 0a14 EB58     		jmp	.L379
 4670              	.L442:
1394:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &T2,  &T2,    &P->Y ) );  MOD_SUB( T2 );
 4671              		.loc 1 1394 5
 4672 0a16 90       		nop
 4673 0a17 EB55     		jmp	.L379
 4674              	.L443:
1394:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &T2,  &T2,    &P->Y ) );  MOD_SUB( T2 );
 4675              		.loc 1 1394 69
GAS LISTING /tmp/ccajKZL5.s 			page 129


 4676 0a19 90       		nop
 4677 0a1a EB52     		jmp	.L379
 4678              	.L444:
1395:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 4679              		.loc 1 1395 5
 4680 0a1c 90       		nop
 4681 0a1d EB4F     		jmp	.L379
 4682              	.L445:
1395:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 4683              		.loc 1 1395 69
 4684 0a1f 90       		nop
 4685 0a20 EB4C     		jmp	.L379
 4686              	.L446:
1412:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T3,  &T1,    &T1   ) );  MOD_MUL( T3 );
 4687              		.loc 1 1412 5
 4688 0a22 90       		nop
 4689 0a23 EB49     		jmp	.L379
 4690              	.L447:
1412:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T3,  &T1,    &T1   ) );  MOD_MUL( T3 );
 4691              		.loc 1 1412 69
 4692 0a25 90       		nop
 4693 0a26 EB46     		jmp	.L379
 4694              	.L448:
1413:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T4,  &T3,    &T1   ) );  MOD_MUL( T4 );
 4695              		.loc 1 1413 5
 4696 0a28 90       		nop
 4697 0a29 EB43     		jmp	.L379
 4698              	.L449:
1413:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T4,  &T3,    &T1   ) );  MOD_MUL( T4 );
 4699              		.loc 1 1413 69
 4700 0a2b 90       		nop
 4701 0a2c EB40     		jmp	.L379
 4702              	.L450:
1414:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T3,  &T3,    &P->X ) );  MOD_MUL( T3 );
 4703              		.loc 1 1414 5
 4704 0a2e 90       		nop
 4705 0a2f EB3D     		jmp	.L379
 4706              	.L451:
1414:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T3,  &T3,    &P->X ) );  MOD_MUL( T3 );
 4707              		.loc 1 1414 69
 4708 0a31 90       		nop
 4709 0a32 EB3A     		jmp	.L379
 4710              	.L452:
1415:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_int( &T1,  &T3,    2     ) );  MOD_ADD( T1 );
 4711              		.loc 1 1415 5
 4712 0a34 90       		nop
 4713 0a35 EB37     		jmp	.L379
 4714              	.L453:
1415:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_int( &T1,  &T3,    2     ) );  MOD_ADD( T1 );
 4715              		.loc 1 1415 69
 4716 0a37 90       		nop
 4717 0a38 EB34     		jmp	.L379
 4718              	.L454:
1416:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &X,   &T2,    &T2   ) );  MOD_MUL( X  );
 4719              		.loc 1 1416 5
 4720 0a3a 90       		nop
 4721 0a3b EB31     		jmp	.L379
GAS LISTING /tmp/ccajKZL5.s 			page 130


 4722              	.L455:
1416:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &X,   &T2,    &T2   ) );  MOD_MUL( X  );
 4723              		.loc 1 1416 69
 4724 0a3d 90       		nop
 4725 0a3e EB2E     		jmp	.L379
 4726              	.L456:
1417:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &X,   &X,     &T1   ) );  MOD_SUB( X  );
 4727              		.loc 1 1417 5
 4728 0a40 90       		nop
 4729 0a41 EB2B     		jmp	.L379
 4730              	.L457:
1417:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &X,   &X,     &T1   ) );  MOD_SUB( X  );
 4731              		.loc 1 1417 69
 4732 0a43 90       		nop
 4733 0a44 EB28     		jmp	.L379
 4734              	.L458:
1418:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &X,   &X,     &T4   ) );  MOD_SUB( X  );
 4735              		.loc 1 1418 5
 4736 0a46 90       		nop
 4737 0a47 EB25     		jmp	.L379
 4738              	.L459:
1418:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &X,   &X,     &T4   ) );  MOD_SUB( X  );
 4739              		.loc 1 1418 69
 4740 0a49 90       		nop
 4741 0a4a EB22     		jmp	.L379
 4742              	.L460:
1419:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &T3,  &T3,    &X    ) );  MOD_SUB( T3 );
 4743              		.loc 1 1419 5
 4744 0a4c 90       		nop
 4745 0a4d EB1F     		jmp	.L379
 4746              	.L461:
1419:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &T3,  &T3,    &X    ) );  MOD_SUB( T3 );
 4747              		.loc 1 1419 69
 4748 0a4f 90       		nop
 4749 0a50 EB1C     		jmp	.L379
 4750              	.L462:
1420:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T3,  &T3,    &T2   ) );  MOD_MUL( T3 );
 4751              		.loc 1 1420 5
 4752 0a52 90       		nop
 4753 0a53 EB19     		jmp	.L379
 4754              	.L463:
1420:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T3,  &T3,    &T2   ) );  MOD_MUL( T3 );
 4755              		.loc 1 1420 69
 4756 0a55 90       		nop
 4757 0a56 EB16     		jmp	.L379
 4758              	.L464:
1421:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T4,  &T4,    &P->Y ) );  MOD_MUL( T4 );
 4759              		.loc 1 1421 5
 4760 0a58 90       		nop
 4761 0a59 EB13     		jmp	.L379
 4762              	.L465:
1421:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &T4,  &T4,    &P->Y ) );  MOD_MUL( T4 );
 4763              		.loc 1 1421 69
 4764 0a5b 90       		nop
 4765 0a5c EB10     		jmp	.L379
 4766              	.L466:
1422:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &Y,   &T3,    &T4   ) );  MOD_SUB( Y  );
GAS LISTING /tmp/ccajKZL5.s 			page 131


 4767              		.loc 1 1422 5
 4768 0a5e 90       		nop
 4769 0a5f EB0D     		jmp	.L379
 4770              	.L467:
1422:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &Y,   &T3,    &T4   ) );  MOD_SUB( Y  );
 4771              		.loc 1 1422 69
 4772 0a61 90       		nop
 4773 0a62 EB0A     		jmp	.L379
 4774              	.L468:
1423:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 4775              		.loc 1 1423 5
 4776 0a64 90       		nop
 4777 0a65 EB07     		jmp	.L379
 4778              	.L469:
1423:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 4779              		.loc 1 1423 69
 4780 0a67 90       		nop
 4781 0a68 EB04     		jmp	.L379
 4782              	.L470:
1425:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &R->Y, &Y ) );
 4783              		.loc 1 1425 5
 4784 0a6a 90       		nop
 4785 0a6b EB01     		jmp	.L379
 4786              	.L471:
1426:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &R->Z, &Z ) );
 4787              		.loc 1 1426 5
 4788 0a6d 90       		nop
 4789              	.L379:
1430:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1431:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_free( &T1 ); mbedtls_mpi_free( &T2 ); mbedtls_mpi_free( &T3 ); mbedtls_mpi_free( &T
 4790              		.loc 1 1431 5
 4791 0a6e 488D8520 		leaq	-224(%rbp), %rax
 4791      FFFFFF
 4792 0a75 4889C7   		movq	%rax, %rdi
 4793 0a78 E8000000 		call	mbedtls_mpi_free@PLT
 4793      00
 4794              		.loc 1 1431 30
 4795 0a7d 488D8540 		leaq	-192(%rbp), %rax
 4795      FFFFFF
 4796 0a84 4889C7   		movq	%rax, %rdi
 4797 0a87 E8000000 		call	mbedtls_mpi_free@PLT
 4797      00
 4798              		.loc 1 1431 55
 4799 0a8c 488D8560 		leaq	-160(%rbp), %rax
 4799      FFFFFF
 4800 0a93 4889C7   		movq	%rax, %rdi
 4801 0a96 E8000000 		call	mbedtls_mpi_free@PLT
 4801      00
 4802              		.loc 1 1431 80
 4803 0a9b 488D4580 		leaq	-128(%rbp), %rax
 4804 0a9f 4889C7   		movq	%rax, %rdi
 4805 0aa2 E8000000 		call	mbedtls_mpi_free@PLT
 4805      00
1432:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_free( &X ); mbedtls_mpi_free( &Y ); mbedtls_mpi_free( &Z );
 4806              		.loc 1 1432 5
 4807 0aa7 488D45A0 		leaq	-96(%rbp), %rax
 4808 0aab 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/ccajKZL5.s 			page 132


 4809 0aae E8000000 		call	mbedtls_mpi_free@PLT
 4809      00
 4810              		.loc 1 1432 29
 4811 0ab3 488D45C0 		leaq	-64(%rbp), %rax
 4812 0ab7 4889C7   		movq	%rax, %rdi
 4813 0aba E8000000 		call	mbedtls_mpi_free@PLT
 4813      00
 4814              		.loc 1 1432 53
 4815 0abf 488D45E0 		leaq	-32(%rbp), %rax
 4816 0ac3 4889C7   		movq	%rax, %rdi
 4817 0ac6 E8000000 		call	mbedtls_mpi_free@PLT
 4817      00
1433:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1434:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 4818              		.loc 1 1434 11
 4819 0acb 8B851CFF 		movl	-228(%rbp), %eax
 4819      FFFF
 4820              	.L432:
1435:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 4821              		.loc 1 1435 1 discriminator 1
 4822 0ad1 488B4DF8 		movq	-8(%rbp), %rcx
 4823 0ad5 6448330C 		xorq	%fs:40, %rcx
 4823      25280000 
 4823      00
 4824 0ade 7405     		je	.L433
 4825              		.loc 1 1435 1 is_stmt 0
 4826 0ae0 E8000000 		call	__stack_chk_fail@PLT
 4826      00
 4827              	.L433:
 4828 0ae5 C9       		leave
 4829              	.LCFI92:
 4830              		.cfi_def_cfa 7, 8
 4831 0ae6 C3       		ret
 4832              		.cfi_endproc
 4833              	.LFE36:
 4835              		.section	.text.ecp_randomize_jac,"ax",@progbits
 4837              	ecp_randomize_jac:
 4838              	.LFB37:
1436:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1437:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
1438:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Randomize jacobian coordinates:
1439:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * (X, Y, Z) -> (l^2 X, l^3 Y, l Z) for random l
1440:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * This is sort of the reverse operation of ecp_normalize_jac().
1441:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1442:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * This countermeasure was first suggested in [2].
1443:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
1444:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static int ecp_randomize_jac( const mbedtls_ecp_group *grp, mbedtls_ecp_point *pt,
1445:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                 int (*f_rng)(void *, unsigned char *, size_t), void *p_rng )
1446:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 4839              		.loc 1 1446 1 is_stmt 1
 4840              		.cfi_startproc
 4841 0000 F30F1EFA 		endbr64
 4842 0004 55       		pushq	%rbp
 4843              	.LCFI93:
 4844              		.cfi_def_cfa_offset 16
 4845              		.cfi_offset 6, -16
 4846 0005 4889E5   		movq	%rsp, %rbp
GAS LISTING /tmp/ccajKZL5.s 			page 133


 4847              	.LCFI94:
 4848              		.cfi_def_cfa_register 6
 4849 0008 4883EC70 		subq	$112, %rsp
 4850 000c 48897DA8 		movq	%rdi, -88(%rbp)
 4851 0010 488975A0 		movq	%rsi, -96(%rbp)
 4852 0014 48895598 		movq	%rdx, -104(%rbp)
 4853 0018 48894D90 		movq	%rcx, -112(%rbp)
 4854              		.loc 1 1446 1
 4855 001c 64488B04 		movq	%fs:40, %rax
 4855      25280000 
 4855      00
 4856 0025 488945F8 		movq	%rax, -8(%rbp)
 4857 0029 31C0     		xorl	%eax, %eax
1447:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
1448:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi l, ll;
1449:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     size_t p_size;
1450:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int count = 0;
 4858              		.loc 1 1450 9
 4859 002b C745B400 		movl	$0, -76(%rbp)
 4859      000000
1451:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1452:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RANDOMIZE_JAC_ALT)
1453:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( mbedtls_internal_ecp_grp_capable( grp ) )
1454:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( mbedtls_internal_ecp_randomize_jac( grp, pt, f_rng, p_rng ) );
1455:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif /* MBEDTLS_ECP_RANDOMIZE_JAC_ALT */
1456:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1457:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     p_size = ( grp->pbits + 7 ) / 8;
 4860              		.loc 1 1457 19
 4861 0032 488B45A8 		movq	-88(%rbp), %rax
 4862 0036 488B80B0 		movq	176(%rax), %rax
 4862      000000
 4863              		.loc 1 1457 27
 4864 003d 4883C007 		addq	$7, %rax
 4865              		.loc 1 1457 12
 4866 0041 48C1E803 		shrq	$3, %rax
 4867 0045 488945B8 		movq	%rax, -72(%rbp)
1458:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_init( &l ); mbedtls_mpi_init( &ll );
 4868              		.loc 1 1458 5
 4869 0049 488D45C0 		leaq	-64(%rbp), %rax
 4870 004d 4889C7   		movq	%rax, %rdi
 4871 0050 E8000000 		call	mbedtls_mpi_init@PLT
 4871      00
 4872              		.loc 1 1458 29
 4873 0055 488D45E0 		leaq	-32(%rbp), %rax
 4874 0059 4889C7   		movq	%rax, %rdi
 4875 005c E8000000 		call	mbedtls_mpi_init@PLT
 4875      00
 4876              	.L479:
1459:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1460:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Generate l such that 1 < l < p */
1461:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     do
1462:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
1463:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_fill_random( &l, p_size, f_rng, p_rng ) );
 4877              		.loc 1 1463 9
 4878 0061 488B4D90 		movq	-112(%rbp), %rcx
 4879 0065 488B5598 		movq	-104(%rbp), %rdx
 4880 0069 488B75B8 		movq	-72(%rbp), %rsi
GAS LISTING /tmp/ccajKZL5.s 			page 134


 4881 006d 488D45C0 		leaq	-64(%rbp), %rax
 4882 0071 4889C7   		movq	%rax, %rdi
 4883 0074 E8000000 		call	mbedtls_mpi_fill_random@PLT
 4883      00
 4884 0079 8945B0   		movl	%eax, -80(%rbp)
 4885 007c 837DB000 		cmpl	$0, -80(%rbp)
 4886 0080 0F85C801 		jne	.L491
 4886      0000
1464:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1465:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         while( mbedtls_mpi_cmp_mpi( &l, &grp->P ) >= 0 )
 4887              		.loc 1 1465 14
 4888 0086 EB1E     		jmp	.L475
 4889              	.L476:
1466:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_shift_r( &l, 1 ) );
 4890              		.loc 1 1466 13
 4891 0088 488D45C0 		leaq	-64(%rbp), %rax
 4892 008c BE010000 		movl	$1, %esi
 4892      00
 4893 0091 4889C7   		movq	%rax, %rdi
 4894 0094 E8000000 		call	mbedtls_mpi_shift_r@PLT
 4894      00
 4895 0099 8945B0   		movl	%eax, -80(%rbp)
 4896 009c 837DB000 		cmpl	$0, -80(%rbp)
 4897 00a0 0F85AB01 		jne	.L492
 4897      0000
 4898              	.L475:
1465:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_shift_r( &l, 1 ) );
 4899              		.loc 1 1465 16
 4900 00a6 488B45A8 		movq	-88(%rbp), %rax
 4901 00aa 488D5008 		leaq	8(%rax), %rdx
 4902 00ae 488D45C0 		leaq	-64(%rbp), %rax
 4903 00b2 4889D6   		movq	%rdx, %rsi
 4904 00b5 4889C7   		movq	%rax, %rdi
 4905 00b8 E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 4905      00
1465:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_shift_r( &l, 1 ) );
 4906              		.loc 1 1465 14
 4907 00bd 85C0     		testl	%eax, %eax
 4908 00bf 79C7     		jns	.L476
1467:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1468:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( count++ > 10 )
 4909              		.loc 1 1468 18
 4910 00c1 8B45B4   		movl	-76(%rbp), %eax
 4911 00c4 8D5001   		leal	1(%rax), %edx
 4912 00c7 8955B4   		movl	%edx, -76(%rbp)
 4913              		.loc 1 1468 11
 4914 00ca 83F80A   		cmpl	$10, %eax
 4915 00cd 7E0A     		jle	.L477
1469:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             return( MBEDTLS_ERR_ECP_RANDOM_FAILED );
 4916              		.loc 1 1469 19
 4917 00cf B800B3FF 		movl	$-19712, %eax
 4917      FF
 4918 00d4 E9AF0100 		jmp	.L489
 4918      00
 4919              	.L477:
1470:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
1471:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     while( mbedtls_mpi_cmp_int( &l, 1 ) <= 0 );
GAS LISTING /tmp/ccajKZL5.s 			page 135


 4920              		.loc 1 1471 12
 4921 00d9 488D45C0 		leaq	-64(%rbp), %rax
 4922 00dd BE010000 		movl	$1, %esi
 4922      00
 4923 00e2 4889C7   		movq	%rax, %rdi
 4924 00e5 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 4924      00
 4925              		.loc 1 1471 5
 4926 00ea 85C0     		testl	%eax, %eax
 4927 00ec 0F8E6FFF 		jle	.L479
 4927      FFFF
1472:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1473:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Z = l * Z */
1474:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &pt->Z,   &pt->Z,     &l  ) ); MOD_MUL( pt->Z );
 4928              		.loc 1 1474 5
 4929 00f2 488B45A0 		movq	-96(%rbp), %rax
 4930 00f6 488D7030 		leaq	48(%rax), %rsi
 4931 00fa 488B45A0 		movq	-96(%rbp), %rax
 4932 00fe 488D4830 		leaq	48(%rax), %rcx
 4933 0102 488D45C0 		leaq	-64(%rbp), %rax
 4934 0106 4889C2   		movq	%rax, %rdx
 4935 0109 4889CF   		movq	%rcx, %rdi
 4936 010c E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 4936      00
 4937 0111 8945B0   		movl	%eax, -80(%rbp)
 4938 0114 837DB000 		cmpl	$0, -80(%rbp)
 4939 0118 0F853601 		jne	.L493
 4939      0000
 4940              		.loc 1 1474 74 discriminator 2
 4941 011e 488B45A0 		movq	-96(%rbp), %rax
 4942 0122 488D5030 		leaq	48(%rax), %rdx
 4943 0126 488B45A8 		movq	-88(%rbp), %rax
 4944 012a 4889C6   		movq	%rax, %rsi
 4945 012d 4889D7   		movq	%rdx, %rdi
 4946 0130 E8000000 		call	ecp_modp
 4946      00
 4947 0135 8945B0   		movl	%eax, -80(%rbp)
 4948 0138 837DB000 		cmpl	$0, -80(%rbp)
 4949 013c 0F851501 		jne	.L494
 4949      0000
1475:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1476:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* X = l^2 * X */
1477:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &ll,      &l,         &l  ) ); MOD_MUL( ll );
 4950              		.loc 1 1477 5
 4951 0142 488D55C0 		leaq	-64(%rbp), %rdx
 4952 0146 488D4DC0 		leaq	-64(%rbp), %rcx
 4953 014a 488D45E0 		leaq	-32(%rbp), %rax
 4954 014e 4889CE   		movq	%rcx, %rsi
 4955 0151 4889C7   		movq	%rax, %rdi
 4956 0154 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 4956      00
 4957 0159 8945B0   		movl	%eax, -80(%rbp)
 4958 015c 837DB000 		cmpl	$0, -80(%rbp)
 4959 0160 0F85F400 		jne	.L495
 4959      0000
 4960              		.loc 1 1477 74 discriminator 2
 4961 0166 488B55A8 		movq	-88(%rbp), %rdx
GAS LISTING /tmp/ccajKZL5.s 			page 136


 4962 016a 488D45E0 		leaq	-32(%rbp), %rax
 4963 016e 4889D6   		movq	%rdx, %rsi
 4964 0171 4889C7   		movq	%rax, %rdi
 4965 0174 E8000000 		call	ecp_modp
 4965      00
 4966 0179 8945B0   		movl	%eax, -80(%rbp)
 4967 017c 837DB000 		cmpl	$0, -80(%rbp)
 4968 0180 0F85D700 		jne	.L496
 4968      0000
1478:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &pt->X,   &pt->X,     &ll ) ); MOD_MUL( pt->X );
 4969              		.loc 1 1478 5
 4970 0186 488B4DA0 		movq	-96(%rbp), %rcx
 4971 018a 488B45A0 		movq	-96(%rbp), %rax
 4972 018e 488D55E0 		leaq	-32(%rbp), %rdx
 4973 0192 4889CE   		movq	%rcx, %rsi
 4974 0195 4889C7   		movq	%rax, %rdi
 4975 0198 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 4975      00
 4976 019d 8945B0   		movl	%eax, -80(%rbp)
 4977 01a0 837DB000 		cmpl	$0, -80(%rbp)
 4978 01a4 0F85B600 		jne	.L497
 4978      0000
 4979              		.loc 1 1478 74 discriminator 2
 4980 01aa 488B45A0 		movq	-96(%rbp), %rax
 4981 01ae 488B55A8 		movq	-88(%rbp), %rdx
 4982 01b2 4889D6   		movq	%rdx, %rsi
 4983 01b5 4889C7   		movq	%rax, %rdi
 4984 01b8 E8000000 		call	ecp_modp
 4984      00
 4985 01bd 8945B0   		movl	%eax, -80(%rbp)
 4986 01c0 837DB000 		cmpl	$0, -80(%rbp)
 4987 01c4 0F859900 		jne	.L498
 4987      0000
1479:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1480:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Y = l^3 * Y */
1481:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &ll,      &ll,        &l  ) ); MOD_MUL( ll );
 4988              		.loc 1 1481 5
 4989 01ca 488D55C0 		leaq	-64(%rbp), %rdx
 4990 01ce 488D4DE0 		leaq	-32(%rbp), %rcx
 4991 01d2 488D45E0 		leaq	-32(%rbp), %rax
 4992 01d6 4889CE   		movq	%rcx, %rsi
 4993 01d9 4889C7   		movq	%rax, %rdi
 4994 01dc E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 4994      00
 4995 01e1 8945B0   		movl	%eax, -80(%rbp)
 4996 01e4 837DB000 		cmpl	$0, -80(%rbp)
 4997 01e8 757C     		jne	.L499
 4998              		.loc 1 1481 74 discriminator 2
 4999 01ea 488B55A8 		movq	-88(%rbp), %rdx
 5000 01ee 488D45E0 		leaq	-32(%rbp), %rax
 5001 01f2 4889D6   		movq	%rdx, %rsi
 5002 01f5 4889C7   		movq	%rax, %rdi
 5003 01f8 E8000000 		call	ecp_modp
 5003      00
 5004 01fd 8945B0   		movl	%eax, -80(%rbp)
 5005 0200 837DB000 		cmpl	$0, -80(%rbp)
 5006 0204 7563     		jne	.L500
GAS LISTING /tmp/ccajKZL5.s 			page 137


1482:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &pt->Y,   &pt->Y,     &ll ) ); MOD_MUL( pt->Y );
 5007              		.loc 1 1482 5
 5008 0206 488B45A0 		movq	-96(%rbp), %rax
 5009 020a 488D7018 		leaq	24(%rax), %rsi
 5010 020e 488B45A0 		movq	-96(%rbp), %rax
 5011 0212 488D4818 		leaq	24(%rax), %rcx
 5012 0216 488D45E0 		leaq	-32(%rbp), %rax
 5013 021a 4889C2   		movq	%rax, %rdx
 5014 021d 4889CF   		movq	%rcx, %rdi
 5015 0220 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 5015      00
 5016 0225 8945B0   		movl	%eax, -80(%rbp)
 5017 0228 837DB000 		cmpl	$0, -80(%rbp)
 5018 022c 753E     		jne	.L501
 5019              		.loc 1 1482 74 discriminator 2
 5020 022e 488B45A0 		movq	-96(%rbp), %rax
 5021 0232 488D5018 		leaq	24(%rax), %rdx
 5022 0236 488B45A8 		movq	-88(%rbp), %rax
 5023 023a 4889C6   		movq	%rax, %rsi
 5024 023d 4889D7   		movq	%rdx, %rdi
 5025 0240 E8000000 		call	ecp_modp
 5025      00
 5026 0245 8945B0   		movl	%eax, -80(%rbp)
 5027 0248 837DB000 		cmpl	$0, -80(%rbp)
1483:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1484:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
 5028              		.loc 1 1484 1 discriminator 2
 5029 024c EB1F     		jmp	.L474
 5030              	.L491:
1463:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 5031              		.loc 1 1463 9
 5032 024e 90       		nop
 5033 024f EB1C     		jmp	.L474
 5034              	.L492:
1466:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 5035              		.loc 1 1466 13
 5036 0251 90       		nop
 5037 0252 EB19     		jmp	.L474
 5038              	.L493:
1474:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 5039              		.loc 1 1474 5
 5040 0254 90       		nop
 5041 0255 EB16     		jmp	.L474
 5042              	.L494:
1474:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 5043              		.loc 1 1474 74
 5044 0257 90       		nop
 5045 0258 EB13     		jmp	.L474
 5046              	.L495:
1477:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &pt->X,   &pt->X,     &ll ) ); MOD_MUL( pt->X );
 5047              		.loc 1 1477 5
 5048 025a 90       		nop
 5049 025b EB10     		jmp	.L474
 5050              	.L496:
1477:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &pt->X,   &pt->X,     &ll ) ); MOD_MUL( pt->X );
 5051              		.loc 1 1477 74
 5052 025d 90       		nop
GAS LISTING /tmp/ccajKZL5.s 			page 138


 5053 025e EB0D     		jmp	.L474
 5054              	.L497:
1478:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 5055              		.loc 1 1478 5
 5056 0260 90       		nop
 5057 0261 EB0A     		jmp	.L474
 5058              	.L498:
1478:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 5059              		.loc 1 1478 74
 5060 0263 90       		nop
 5061 0264 EB07     		jmp	.L474
 5062              	.L499:
1481:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &pt->Y,   &pt->Y,     &ll ) ); MOD_MUL( pt->Y );
 5063              		.loc 1 1481 5
 5064 0266 90       		nop
 5065 0267 EB04     		jmp	.L474
 5066              	.L500:
1481:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &pt->Y,   &pt->Y,     &ll ) ); MOD_MUL( pt->Y );
 5067              		.loc 1 1481 74
 5068 0269 90       		nop
 5069 026a EB01     		jmp	.L474
 5070              	.L501:
1482:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 5071              		.loc 1 1482 5
 5072 026c 90       		nop
 5073              	.L474:
1485:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_free( &l ); mbedtls_mpi_free( &ll );
 5074              		.loc 1 1485 5
 5075 026d 488D45C0 		leaq	-64(%rbp), %rax
 5076 0271 4889C7   		movq	%rax, %rdi
 5077 0274 E8000000 		call	mbedtls_mpi_free@PLT
 5077      00
 5078              		.loc 1 1485 29
 5079 0279 488D45E0 		leaq	-32(%rbp), %rax
 5080 027d 4889C7   		movq	%rax, %rdi
 5081 0280 E8000000 		call	mbedtls_mpi_free@PLT
 5081      00
1486:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1487:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 5082              		.loc 1 1487 11
 5083 0285 8B45B0   		movl	-80(%rbp), %eax
 5084              	.L489:
1488:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 5085              		.loc 1 1488 1 discriminator 1
 5086 0288 488B4DF8 		movq	-8(%rbp), %rcx
 5087 028c 6448330C 		xorq	%fs:40, %rcx
 5087      25280000 
 5087      00
 5088 0295 7405     		je	.L490
 5089              		.loc 1 1488 1 is_stmt 0
 5090 0297 E8000000 		call	__stack_chk_fail@PLT
 5090      00
 5091              	.L490:
 5092 029c C9       		leave
 5093              	.LCFI95:
 5094              		.cfi_def_cfa 7, 8
 5095 029d C3       		ret
GAS LISTING /tmp/ccajKZL5.s 			page 139


 5096              		.cfi_endproc
 5097              	.LFE37:
 5099              		.section	.text.ecp_comb_recode_core,"ax",@progbits
 5101              	ecp_comb_recode_core:
 5102              	.LFB38:
1489:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1490:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
1491:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Check and define parameters used by the comb method (see below for details)
1492:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
1493:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if MBEDTLS_ECP_WINDOW_SIZE < 2 || MBEDTLS_ECP_WINDOW_SIZE > 7
1494:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #error "MBEDTLS_ECP_WINDOW_SIZE out of bounds"
1495:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
1496:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1497:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /* d = ceil( n / w ) */
1498:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #define COMB_MAX_D      ( MBEDTLS_ECP_MAX_BITS + 1 ) / 2
1499:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1500:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /* number of precomputed points */
1501:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #define COMB_MAX_PRE    ( 1 << ( MBEDTLS_ECP_WINDOW_SIZE - 1 ) )
1502:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1503:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
1504:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Compute the representation of m that will be used with our comb method.
1505:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1506:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * The basic comb method is described in GECC 3.44 for example. We use a
1507:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * modified version that provides resistance to SPA by avoiding zero
1508:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * digits in the representation as in [3]. We modify the method further by
1509:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * requiring that all K_i be odd, which has the small cost that our
1510:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * representation uses one more K_i, due to carries, but saves on the size of
1511:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * the precomputed table.
1512:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1513:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Summary of the comb method and its modifications:
1514:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1515:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * - The goal is to compute m*P for some w*d-bit integer m.
1516:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1517:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * - The basic comb method splits m into the w-bit integers
1518:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   x[0] .. x[d-1] where x[i] consists of the bits in m whose
1519:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   index has residue i modulo d, and computes m * P as
1520:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   S[x[0]] + 2 * S[x[1]] + .. + 2^(d-1) S[x[d-1]], where
1521:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   S[i_{w-1} .. i_0] := i_{w-1} 2^{(w-1)d} P + ... + i_1 2^d P + i_0 P.
1522:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1523:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * - If it happens that, say, x[i+1]=0 (=> S[x[i+1]]=0), one can replace the sum by
1524:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *    .. + 2^{i-1} S[x[i-1]] - 2^i S[x[i]] + 2^{i+1} S[x[i]] + 2^{i+2} S[x[i+2]] ..,
1525:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   thereby successively converting it into a form where all summands
1526:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   are nonzero, at the cost of negative summands. This is the basic idea of [3].
1527:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1528:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * - More generally, even if x[i+1] != 0, we can first transform the sum as
1529:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   .. - 2^i S[x[i]] + 2^{i+1} ( S[x[i]] + S[x[i+1]] ) + 2^{i+2} S[x[i+2]] ..,
1530:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   and then replace S[x[i]] + S[x[i+1]] = S[x[i] ^ x[i+1]] + 2 S[x[i] & x[i+1]].
1531:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   Performing and iterating this procedure for those x[i] that are even
1532:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   (keeping track of carry), we can transform the original sum into one of the form
1533:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   S[x'[0]] +- 2 S[x'[1]] +- .. +- 2^{d-1} S[x'[d-1]] + 2^d S[x'[d]]
1534:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   with all x'[i] odd. It is therefore only necessary to know S at odd indices,
1535:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   which is why we are only computing half of it in the first place in
1536:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   ecp_precompute_comb and accessing it with index abs(i) / 2 in ecp_select_comb.
1537:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1538:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * - For the sake of compactness, only the seven low-order bits of x[i]
1539:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   are used to represent its absolute value (K_i in the paper), and the msb
1540:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   of x[i] encodes the sign (s_i in the paper): it is set if and only if
GAS LISTING /tmp/ccajKZL5.s 			page 140


1541:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   if s_i == -1;
1542:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1543:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Calling conventions:
1544:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * - x is an array of size d + 1
1545:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * - w is the size, ie number of teeth, of the comb, and must be between
1546:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   2 and 7 (in practice, between 2 and MBEDTLS_ECP_WINDOW_SIZE)
1547:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * - m is the MPI, expected to be odd and such that bitlength(m) <= w * d
1548:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   (the result will be incorrect if these assumptions are not satisfied)
1549:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
1550:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static void ecp_comb_recode_core( unsigned char x[], size_t d,
1551:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                   unsigned char w, const mbedtls_mpi *m )
1552:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 5103              		.loc 1 1552 1 is_stmt 1
 5104              		.cfi_startproc
 5105 0000 F30F1EFA 		endbr64
 5106 0004 55       		pushq	%rbp
 5107              	.LCFI96:
 5108              		.cfi_def_cfa_offset 16
 5109              		.cfi_offset 6, -16
 5110 0005 4889E5   		movq	%rsp, %rbp
 5111              	.LCFI97:
 5112              		.cfi_def_cfa_register 6
 5113 0008 4883EC40 		subq	$64, %rsp
 5114 000c 48897DD8 		movq	%rdi, -40(%rbp)
 5115 0010 488975D0 		movq	%rsi, -48(%rbp)
 5116 0014 89D0     		movl	%edx, %eax
 5117 0016 48894DC0 		movq	%rcx, -64(%rbp)
 5118 001a 8845CC   		movb	%al, -52(%rbp)
 5119              		.loc 1 1552 1
 5120 001d 64488B04 		movq	%fs:40, %rax
 5120      25280000 
 5120      00
 5121 0026 488945F8 		movq	%rax, -8(%rbp)
 5122 002a 31C0     		xorl	%eax, %eax
1553:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     size_t i, j;
1554:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     unsigned char c, cc, adjust;
1555:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1556:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     memset( x, 0, d+1 );
 5123              		.loc 1 1556 5
 5124 002c 488B45D0 		movq	-48(%rbp), %rax
 5125 0030 488D5001 		leaq	1(%rax), %rdx
 5126 0034 488B45D8 		movq	-40(%rbp), %rax
 5127 0038 BE000000 		movl	$0, %esi
 5127      00
 5128 003d 4889C7   		movq	%rax, %rdi
 5129 0040 E8000000 		call	memset@PLT
 5129      00
1557:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1558:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* First get the classical comb values (except for x_d = 0) */
1559:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     for( i = 0; i < d; i++ )
 5130              		.loc 1 1559 12
 5131 0045 48C745E8 		movq	$0, -24(%rbp)
 5131      00000000 
 5132              		.loc 1 1559 5
 5133 004d EB6F     		jmp	.L503
 5134              	.L506:
1560:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         for( j = 0; j < w; j++ )
GAS LISTING /tmp/ccajKZL5.s 			page 141


 5135              		.loc 1 1560 16
 5136 004f 48C745F0 		movq	$0, -16(%rbp)
 5136      00000000 
 5137              		.loc 1 1560 9
 5138 0057 EB56     		jmp	.L504
 5139              	.L505:
1561:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             x[i] |= mbedtls_mpi_get_bit( m, i + d * j ) << j;
 5140              		.loc 1 1561 51 discriminator 3
 5141 0059 488B45D0 		movq	-48(%rbp), %rax
 5142 005d 480FAF45 		imulq	-16(%rbp), %rax
 5142      F0
 5143 0062 4889C2   		movq	%rax, %rdx
 5144              		.loc 1 1561 21 discriminator 3
 5145 0065 488B45E8 		movq	-24(%rbp), %rax
 5146 0069 4801C2   		addq	%rax, %rdx
 5147 006c 488B45C0 		movq	-64(%rbp), %rax
 5148 0070 4889D6   		movq	%rdx, %rsi
 5149 0073 4889C7   		movq	%rax, %rdi
 5150 0076 E8000000 		call	mbedtls_mpi_get_bit@PLT
 5150      00
 5151              		.loc 1 1561 57 discriminator 3
 5152 007b 488B55F0 		movq	-16(%rbp), %rdx
 5153 007f 89D1     		movl	%edx, %ecx
 5154 0081 D3E0     		sall	%cl, %eax
 5155 0083 89C1     		movl	%eax, %ecx
 5156              		.loc 1 1561 18 discriminator 3
 5157 0085 488B55D8 		movq	-40(%rbp), %rdx
 5158 0089 488B45E8 		movq	-24(%rbp), %rax
 5159 008d 4801D0   		addq	%rdx, %rax
 5160 0090 0FB600   		movzbl	(%rax), %eax
 5161 0093 89C2     		movl	%eax, %edx
 5162 0095 89C8     		movl	%ecx, %eax
 5163 0097 89D1     		movl	%edx, %ecx
 5164 0099 09C1     		orl	%eax, %ecx
 5165 009b 488B55D8 		movq	-40(%rbp), %rdx
 5166 009f 488B45E8 		movq	-24(%rbp), %rax
 5167 00a3 4801D0   		addq	%rdx, %rax
 5168 00a6 89CA     		movl	%ecx, %edx
 5169 00a8 8810     		movb	%dl, (%rax)
1560:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         for( j = 0; j < w; j++ )
 5170              		.loc 1 1560 29 discriminator 3
 5171 00aa 488345F0 		addq	$1, -16(%rbp)
 5171      01
 5172              	.L504:
1560:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         for( j = 0; j < w; j++ )
 5173              		.loc 1 1560 23 discriminator 1
 5174 00af 0FB645CC 		movzbl	-52(%rbp), %eax
1560:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         for( j = 0; j < w; j++ )
 5175              		.loc 1 1560 9 discriminator 1
 5176 00b3 483945F0 		cmpq	%rax, -16(%rbp)
 5177 00b7 72A0     		jb	.L505
1559:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         for( j = 0; j < w; j++ )
 5178              		.loc 1 1559 25 discriminator 2
 5179 00b9 488345E8 		addq	$1, -24(%rbp)
 5179      01
 5180              	.L503:
1559:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         for( j = 0; j < w; j++ )
GAS LISTING /tmp/ccajKZL5.s 			page 142


 5181              		.loc 1 1559 5 discriminator 1
 5182 00be 488B45E8 		movq	-24(%rbp), %rax
 5183 00c2 483B45D0 		cmpq	-48(%rbp), %rax
 5184 00c6 7287     		jb	.L506
1562:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1563:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Now make sure x_1 .. x_d are odd */
1564:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     c = 0;
 5185              		.loc 1 1564 7
 5186 00c8 C645E500 		movb	$0, -27(%rbp)
1565:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     for( i = 1; i <= d; i++ )
 5187              		.loc 1 1565 12
 5188 00cc 48C745E8 		movq	$1, -24(%rbp)
 5188      01000000 
 5189              		.loc 1 1565 5
 5190 00d4 E9F40000 		jmp	.L507
 5190      00
 5191              	.L508:
1566:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
1567:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* Add carry and update it */
1568:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         cc   = x[i] & c;
 5192              		.loc 1 1568 17 discriminator 3
 5193 00d9 488B55D8 		movq	-40(%rbp), %rdx
 5194 00dd 488B45E8 		movq	-24(%rbp), %rax
 5195 00e1 4801D0   		addq	%rdx, %rax
 5196 00e4 0FB600   		movzbl	(%rax), %eax
 5197              		.loc 1 1568 14 discriminator 3
 5198 00e7 2245E5   		andb	-27(%rbp), %al
 5199 00ea 8845E6   		movb	%al, -26(%rbp)
1569:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         x[i] = x[i] ^ c;
 5200              		.loc 1 1569 17 discriminator 3
 5201 00ed 488B55D8 		movq	-40(%rbp), %rdx
 5202 00f1 488B45E8 		movq	-24(%rbp), %rax
 5203 00f5 4801D0   		addq	%rdx, %rax
 5204 00f8 0FB600   		movzbl	(%rax), %eax
 5205              		.loc 1 1569 10 discriminator 3
 5206 00fb 488B4DD8 		movq	-40(%rbp), %rcx
 5207 00ff 488B55E8 		movq	-24(%rbp), %rdx
 5208 0103 4801CA   		addq	%rcx, %rdx
 5209              		.loc 1 1569 14 discriminator 3
 5210 0106 3245E5   		xorb	-27(%rbp), %al
 5211 0109 8802     		movb	%al, (%rdx)
1570:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         c = cc;
 5212              		.loc 1 1570 11 discriminator 3
 5213 010b 0FB645E6 		movzbl	-26(%rbp), %eax
 5214 010f 8845E5   		movb	%al, -27(%rbp)
1571:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1572:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* Adjust if needed, avoiding branches */
1573:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         adjust = 1 - ( x[i] & 0x01 );
 5215              		.loc 1 1573 25 discriminator 3
 5216 0112 488B55D8 		movq	-40(%rbp), %rdx
 5217 0116 488B45E8 		movq	-24(%rbp), %rax
 5218 011a 4801D0   		addq	%rdx, %rax
 5219 011d 0FB600   		movzbl	(%rax), %eax
 5220              		.loc 1 1573 20 discriminator 3
 5221 0120 0FB6C0   		movzbl	%al, %eax
 5222 0123 83E001   		andl	$1, %eax
 5223 0126 85C0     		testl	%eax, %eax
GAS LISTING /tmp/ccajKZL5.s 			page 143


 5224 0128 0F94C0   		sete	%al
 5225              		.loc 1 1573 16 discriminator 3
 5226 012b 8845E7   		movb	%al, -25(%rbp)
1574:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         c   |= x[i] & ( x[i-1] * adjust );
 5227              		.loc 1 1574 17 discriminator 3
 5228 012e 488B55D8 		movq	-40(%rbp), %rdx
 5229 0132 488B45E8 		movq	-24(%rbp), %rax
 5230 0136 4801D0   		addq	%rdx, %rax
 5231 0139 0FB600   		movzbl	(%rax), %eax
 5232 013c 89C1     		movl	%eax, %ecx
 5233              		.loc 1 1574 26 discriminator 3
 5234 013e 488B45E8 		movq	-24(%rbp), %rax
 5235 0142 488D50FF 		leaq	-1(%rax), %rdx
 5236 0146 488B45D8 		movq	-40(%rbp), %rax
 5237 014a 4801D0   		addq	%rdx, %rax
 5238 014d 0FB600   		movzbl	(%rax), %eax
 5239              		.loc 1 1574 32 discriminator 3
 5240 0150 F665E7   		mulb	-25(%rbp)
 5241              		.loc 1 1574 21 discriminator 3
 5242 0153 21C1     		andl	%eax, %ecx
 5243 0155 89CA     		movl	%ecx, %edx
 5244              		.loc 1 1574 13 discriminator 3
 5245 0157 0FB645E5 		movzbl	-27(%rbp), %eax
 5246 015b 09D0     		orl	%edx, %eax
 5247 015d 8845E5   		movb	%al, -27(%rbp)
1575:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         x[i] = x[i] ^ ( x[i-1] * adjust );
 5248              		.loc 1 1575 17 discriminator 3
 5249 0160 488B55D8 		movq	-40(%rbp), %rdx
 5250 0164 488B45E8 		movq	-24(%rbp), %rax
 5251 0168 4801D0   		addq	%rdx, %rax
 5252 016b 0FB600   		movzbl	(%rax), %eax
 5253 016e 89C1     		movl	%eax, %ecx
 5254              		.loc 1 1575 26 discriminator 3
 5255 0170 488B45E8 		movq	-24(%rbp), %rax
 5256 0174 488D50FF 		leaq	-1(%rax), %rdx
 5257 0178 488B45D8 		movq	-40(%rbp), %rax
 5258 017c 4801D0   		addq	%rdx, %rax
 5259 017f 0FB600   		movzbl	(%rax), %eax
 5260              		.loc 1 1575 32 discriminator 3
 5261 0182 F665E7   		mulb	-25(%rbp)
 5262              		.loc 1 1575 21 discriminator 3
 5263 0185 31C1     		xorl	%eax, %ecx
 5264              		.loc 1 1575 10 discriminator 3
 5265 0187 488B55D8 		movq	-40(%rbp), %rdx
 5266 018b 488B45E8 		movq	-24(%rbp), %rax
 5267 018f 4801D0   		addq	%rdx, %rax
 5268              		.loc 1 1575 21 discriminator 3
 5269 0192 89CA     		movl	%ecx, %edx
 5270              		.loc 1 1575 14 discriminator 3
 5271 0194 8810     		movb	%dl, (%rax)
1576:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         x[i-1] |= adjust << 7;
 5272              		.loc 1 1576 16 discriminator 3
 5273 0196 488B45E8 		movq	-24(%rbp), %rax
 5274 019a 488D50FF 		leaq	-1(%rax), %rdx
 5275 019e 488B45D8 		movq	-40(%rbp), %rax
 5276 01a2 4801D0   		addq	%rdx, %rax
 5277 01a5 0FB600   		movzbl	(%rax), %eax
GAS LISTING /tmp/ccajKZL5.s 			page 144


 5278 01a8 89C2     		movl	%eax, %edx
 5279              		.loc 1 1576 26 discriminator 3
 5280 01aa 0FB645E7 		movzbl	-25(%rbp), %eax
 5281 01ae C1E007   		sall	$7, %eax
 5282              		.loc 1 1576 16 discriminator 3
 5283 01b1 89D1     		movl	%edx, %ecx
 5284 01b3 09C1     		orl	%eax, %ecx
 5285 01b5 488B45E8 		movq	-24(%rbp), %rax
 5286 01b9 488D50FF 		leaq	-1(%rax), %rdx
 5287 01bd 488B45D8 		movq	-40(%rbp), %rax
 5288 01c1 4801D0   		addq	%rdx, %rax
 5289 01c4 89CA     		movl	%ecx, %edx
 5290 01c6 8810     		movb	%dl, (%rax)
1565:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 5291              		.loc 1 1565 26 discriminator 3
 5292 01c8 488345E8 		addq	$1, -24(%rbp)
 5292      01
 5293              	.L507:
1565:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 5294              		.loc 1 1565 5 discriminator 1
 5295 01cd 488B45E8 		movq	-24(%rbp), %rax
 5296 01d1 483B45D0 		cmpq	-48(%rbp), %rax
 5297 01d5 0F86FEFE 		jbe	.L508
 5297      FFFF
1577:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
1578:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 5298              		.loc 1 1578 1
 5299 01db 90       		nop
 5300 01dc 488B45F8 		movq	-8(%rbp), %rax
 5301 01e0 64483304 		xorq	%fs:40, %rax
 5301      25280000 
 5301      00
 5302 01e9 7405     		je	.L509
 5303 01eb E8000000 		call	__stack_chk_fail@PLT
 5303      00
 5304              	.L509:
 5305 01f0 C9       		leave
 5306              	.LCFI98:
 5307              		.cfi_def_cfa 7, 8
 5308 01f1 C3       		ret
 5309              		.cfi_endproc
 5310              	.LFE38:
 5312              		.section	.text.ecp_precompute_comb,"ax",@progbits
 5314              	ecp_precompute_comb:
 5315              	.LFB39:
1579:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1580:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
1581:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Precompute points for the adapted comb method
1582:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1583:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Assumption: T must be able to hold 2^{w - 1} elements.
1584:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1585:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Operation: If i = i_{w-1} ... i_1 is the binary representation of i,
1586:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *            sets T[i] = i_{w-1} 2^{(w-1)d} P + ... + i_1 2^d P + P.
1587:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1588:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Cost: d(w-1) D + (2^{w-1} - 1) A + 1 N(w-1) + 1 N(2^{w-1} - 1)
1589:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1590:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Note: Even comb values (those where P would be omitted from the
GAS LISTING /tmp/ccajKZL5.s 			page 145


1591:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *       sum defining T[i] above) are not needed in our adaption
1592:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *       the comb method. See ecp_comb_recode_core().
1593:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1594:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * This function currently works in four steps:
1595:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * (1) [dbl]      Computation of intermediate T[i] for 2-power values of i
1596:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * (2) [norm_dbl] Normalization of coordinates of these T[i]
1597:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * (3) [add]      Computation of all T[i]
1598:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * (4) [norm_add] Normalization of all T[i]
1599:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1600:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Step 1 can be interrupted but not the others; together with the final
1601:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * coordinate normalization they are the largest steps done at once, depending
1602:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * on the window size. Here are operation counts for P-256:
1603:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1604:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * step     (2)     (3)     (4)
1605:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * w = 5    142     165     208
1606:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * w = 4    136      77     160
1607:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * w = 3    130      33     136
1608:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * w = 2    124      11     124
1609:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1610:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * So if ECC operations are blocking for too long even with a low max_ops
1611:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * value, it's useful to set MBEDTLS_ECP_WINDOW_SIZE to a lower value in order
1612:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * to minimize maximum blocking time.
1613:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
1614:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static int ecp_precompute_comb( const mbedtls_ecp_group *grp,
1615:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                 mbedtls_ecp_point T[], const mbedtls_ecp_point *P,
1616:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                 unsigned char w, size_t d,
1617:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                 mbedtls_ecp_restart_ctx *rs_ctx )
1618:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 5316              		.loc 1 1618 1
 5317              		.cfi_startproc
 5318 0000 F30F1EFA 		endbr64
 5319 0004 55       		pushq	%rbp
 5320              	.LCFI99:
 5321              		.cfi_def_cfa_offset 16
 5322              		.cfi_offset 6, -16
 5323 0005 4889E5   		movq	%rsp, %rbp
 5324              	.LCFI100:
 5325              		.cfi_def_cfa_register 6
 5326 0008 4881EC50 		subq	$336, %rsp
 5326      010000
 5327 000f 4889BDD8 		movq	%rdi, -296(%rbp)
 5327      FEFFFF
 5328 0016 4889B5D0 		movq	%rsi, -304(%rbp)
 5328      FEFFFF
 5329 001d 488995C8 		movq	%rdx, -312(%rbp)
 5329      FEFFFF
 5330 0024 89C8     		movl	%ecx, %eax
 5331 0026 4C8985B8 		movq	%r8, -328(%rbp)
 5331      FEFFFF
 5332 002d 4C898DB0 		movq	%r9, -336(%rbp)
 5332      FEFFFF
 5333 0034 8885C4FE 		movb	%al, -316(%rbp)
 5333      FFFF
 5334              		.loc 1 1618 1
 5335 003a 64488B04 		movq	%fs:40, %rax
 5335      25280000 
 5335      00
GAS LISTING /tmp/ccajKZL5.s 			page 146


 5336 0043 488945F8 		movq	%rax, -8(%rbp)
 5337 0047 31C0     		xorl	%eax, %eax
1619:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
1620:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     unsigned char i;
1621:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     size_t j = 0;
 5338              		.loc 1 1621 12
 5339 0049 48C785F0 		movq	$0, -272(%rbp)
 5339      FEFFFF00 
 5339      000000
1622:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     const unsigned char T_size = 1U << ( w - 1 );
 5340              		.loc 1 1622 44
 5341 0054 0FB685C4 		movzbl	-316(%rbp), %eax
 5341      FEFFFF
 5342 005b 83E801   		subl	$1, %eax
 5343              		.loc 1 1622 37
 5344 005e BA010000 		movl	$1, %edx
 5344      00
 5345 0063 89C1     		movl	%eax, %ecx
 5346 0065 D3E2     		sall	%cl, %edx
 5347 0067 89D0     		movl	%edx, %eax
 5348              		.loc 1 1622 25
 5349 0069 8885EBFE 		movb	%al, -277(%rbp)
 5349      FFFF
1623:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point *cur, *TT[COMB_MAX_PRE - 1];
1624:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1625:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
1626:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && rs_ctx->rsm != NULL )
1627:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
1628:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( rs_ctx->rsm->state == ecp_rsm_pre_dbl )
1629:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             goto dbl;
1630:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( rs_ctx->rsm->state == ecp_rsm_pre_norm_dbl )
1631:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             goto norm_dbl;
1632:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( rs_ctx->rsm->state == ecp_rsm_pre_add )
1633:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             goto add;
1634:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( rs_ctx->rsm->state == ecp_rsm_pre_norm_add )
1635:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             goto norm_add;
1636:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
1637:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #else
1638:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     (void) rs_ctx;
1639:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
1640:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1641:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
1642:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && rs_ctx->rsm != NULL )
1643:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
1644:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->rsm->state = ecp_rsm_pre_dbl;
1645:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1646:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* initial state for the loop */
1647:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->rsm->i = 0;
1648:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
1649:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1650:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** dbl:
1651:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
1652:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
1653:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * Set T[0] = P and
1654:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * T[2^{l-1}] = 2^{dl} P for l = 1 .. w-1 (this is not the final value)
1655:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
1656:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_ecp_copy( &T[0], P ) );
GAS LISTING /tmp/ccajKZL5.s 			page 147


 5350              		.loc 1 1656 5
 5351 006f 488B95C8 		movq	-312(%rbp), %rdx
 5351      FEFFFF
 5352 0076 488B85D0 		movq	-304(%rbp), %rax
 5352      FEFFFF
 5353 007d 4889D6   		movq	%rdx, %rsi
 5354 0080 4889C7   		movq	%rax, %rdi
 5355 0083 E8000000 		call	mbedtls_ecp_copy
 5355      00
 5356 0088 8985ECFE 		movl	%eax, -276(%rbp)
 5356      FFFF
 5357 008e 83BDECFE 		cmpl	$0, -276(%rbp)
 5357      FFFF00
 5358 0095 0F853303 		jne	.L528
 5358      0000
1657:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1658:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
1659:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && rs_ctx->rsm != NULL && rs_ctx->rsm->i != 0 )
1660:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         j = rs_ctx->rsm->i;
1661:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     else
1662:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
1663:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         j = 0;
 5359              		.loc 1 1663 11
 5360 009b 48C785F0 		movq	$0, -272(%rbp)
 5360      FEFFFF00 
 5360      000000
1664:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1665:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     for( ; j < d * ( w - 1 ); j++ )
 5361              		.loc 1 1665 5
 5362 00a6 E9EF0000 		jmp	.L513
 5362      00
 5363              	.L516:
1666:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
1667:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_ECP_BUDGET( MBEDTLS_ECP_OPS_DBL );
1668:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1669:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         i = 1U << ( j / d );
 5364              		.loc 1 1669 23
 5365 00ab 488B85F0 		movq	-272(%rbp), %rax
 5365      FEFFFF
 5366 00b2 BA000000 		movl	$0, %edx
 5366      00
 5367 00b7 48F7B5B8 		divq	-328(%rbp)
 5367      FEFFFF
 5368              		.loc 1 1669 16
 5369 00be BA010000 		movl	$1, %edx
 5369      00
 5370 00c3 89C1     		movl	%eax, %ecx
 5371 00c5 D3E2     		sall	%cl, %edx
 5372 00c7 89D0     		movl	%edx, %eax
 5373              		.loc 1 1669 11
 5374 00c9 8885EAFE 		movb	%al, -278(%rbp)
 5374      FFFF
1670:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         cur = T + i;
 5375              		.loc 1 1670 17
 5376 00cf 0FB695EA 		movzbl	-278(%rbp), %edx
 5376      FEFFFF
 5377 00d6 4889D0   		movq	%rdx, %rax
GAS LISTING /tmp/ccajKZL5.s 			page 148


 5378 00d9 48C1E003 		salq	$3, %rax
 5379 00dd 4801D0   		addq	%rdx, %rax
 5380 00e0 48C1E003 		salq	$3, %rax
 5381 00e4 4889C2   		movq	%rax, %rdx
 5382              		.loc 1 1670 13
 5383 00e7 488B85D0 		movq	-304(%rbp), %rax
 5383      FEFFFF
 5384 00ee 4801D0   		addq	%rdx, %rax
 5385 00f1 488985F8 		movq	%rax, -264(%rbp)
 5385      FEFFFF
1671:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1672:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( j % d == 0 )
 5386              		.loc 1 1672 15
 5387 00f8 488B85F0 		movq	-272(%rbp), %rax
 5387      FEFFFF
 5388 00ff BA000000 		movl	$0, %edx
 5388      00
 5389 0104 48F7B5B8 		divq	-328(%rbp)
 5389      FEFFFF
 5390 010b 4889D0   		movq	%rdx, %rax
 5391              		.loc 1 1672 11
 5392 010e 4885C0   		testq	%rax, %rax
 5393 0111 754C     		jne	.L514
1673:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_ecp_copy( cur, T + ( i >> 1 ) ) );
 5394              		.loc 1 1673 13
 5395 0113 0FB685EA 		movzbl	-278(%rbp), %eax
 5395      FEFFFF
 5396 011a D0E8     		shrb	%al
 5397 011c 0FB6D0   		movzbl	%al, %edx
 5398 011f 4889D0   		movq	%rdx, %rax
 5399 0122 48C1E003 		salq	$3, %rax
 5400 0126 4801D0   		addq	%rdx, %rax
 5401 0129 48C1E003 		salq	$3, %rax
 5402 012d 4889C2   		movq	%rax, %rdx
 5403 0130 488B85D0 		movq	-304(%rbp), %rax
 5403      FEFFFF
 5404 0137 4801C2   		addq	%rax, %rdx
 5405 013a 488B85F8 		movq	-264(%rbp), %rax
 5405      FEFFFF
 5406 0141 4889D6   		movq	%rdx, %rsi
 5407 0144 4889C7   		movq	%rax, %rdi
 5408 0147 E8000000 		call	mbedtls_ecp_copy
 5408      00
 5409 014c 8985ECFE 		movl	%eax, -276(%rbp)
 5409      FFFF
 5410 0152 83BDECFE 		cmpl	$0, -276(%rbp)
 5410      FFFF00
 5411 0159 0F857202 		jne	.L529
 5411      0000
 5412              	.L514:
1674:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1675:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( ecp_double_jac( grp, cur, cur ) );
 5413              		.loc 1 1675 9
 5414 015f 488B95F8 		movq	-264(%rbp), %rdx
 5414      FEFFFF
 5415 0166 488B8DF8 		movq	-264(%rbp), %rcx
 5415      FEFFFF
GAS LISTING /tmp/ccajKZL5.s 			page 149


 5416 016d 488B85D8 		movq	-296(%rbp), %rax
 5416      FEFFFF
 5417 0174 4889CE   		movq	%rcx, %rsi
 5418 0177 4889C7   		movq	%rax, %rdi
 5419 017a E8000000 		call	ecp_double_jac
 5419      00
 5420 017f 8985ECFE 		movl	%eax, -276(%rbp)
 5420      FFFF
 5421 0185 83BDECFE 		cmpl	$0, -276(%rbp)
 5421      FFFF00
 5422 018c 0F854202 		jne	.L530
 5422      0000
1665:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 5423              		.loc 1 1665 32
 5424 0192 488385F0 		addq	$1, -272(%rbp)
 5424      FEFFFF01 
 5425              	.L513:
1665:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 5426              		.loc 1 1665 24 discriminator 1
 5427 019a 0FB685C4 		movzbl	-316(%rbp), %eax
 5427      FEFFFF
 5428 01a1 83E801   		subl	$1, %eax
 5429 01a4 4898     		cltq
1665:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 5430              		.loc 1 1665 18 discriminator 1
 5431 01a6 480FAF85 		imulq	-328(%rbp), %rax
 5431      B8FEFFFF 
1665:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 5432              		.loc 1 1665 5 discriminator 1
 5433 01ae 483985F0 		cmpq	%rax, -272(%rbp)
 5433      FEFFFF
 5434 01b5 0F82F0FE 		jb	.L516
 5434      FFFF
1676:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
1677:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1678:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
1679:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && rs_ctx->rsm != NULL )
1680:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->rsm->state = ecp_rsm_pre_norm_dbl;
1681:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1682:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** norm_dbl:
1683:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
1684:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
1685:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * Normalize current elements in T. As T has holes,
1686:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * use an auxiliary array of pointers to elements in T.
1687:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
1688:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     j = 0;
 5435              		.loc 1 1688 7
 5436 01bb 48C785F0 		movq	$0, -272(%rbp)
 5436      FEFFFF00 
 5436      000000
1689:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     for( i = 1; i < T_size; i <<= 1 )
 5437              		.loc 1 1689 12
 5438 01c6 C685EAFE 		movb	$1, -278(%rbp)
 5438      FFFF01
 5439              		.loc 1 1689 5
 5440 01cd EB42     		jmp	.L517
 5441              	.L518:
GAS LISTING /tmp/ccajKZL5.s 			page 150


1690:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         TT[j++] = T + i;
 5442              		.loc 1 1690 21 discriminator 3
 5443 01cf 0FB695EA 		movzbl	-278(%rbp), %edx
 5443      FEFFFF
 5444 01d6 4889D0   		movq	%rdx, %rax
 5445 01d9 48C1E003 		salq	$3, %rax
 5446 01dd 4801D0   		addq	%rdx, %rax
 5447 01e0 48C1E003 		salq	$3, %rax
 5448 01e4 4889C1   		movq	%rax, %rcx
 5449              		.loc 1 1690 13 discriminator 3
 5450 01e7 488B85F0 		movq	-272(%rbp), %rax
 5450      FEFFFF
 5451 01ee 488D5001 		leaq	1(%rax), %rdx
 5452 01f2 488995F0 		movq	%rdx, -272(%rbp)
 5452      FEFFFF
 5453              		.loc 1 1690 21 discriminator 3
 5454 01f9 488B95D0 		movq	-304(%rbp), %rdx
 5454      FEFFFF
 5455 0200 4801CA   		addq	%rcx, %rdx
 5456              		.loc 1 1690 17 discriminator 3
 5457 0203 488994C5 		movq	%rdx, -256(%rbp,%rax,8)
 5457      00FFFFFF 
1689:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     for( i = 1; i < T_size; i <<= 1 )
 5458              		.loc 1 1689 31 discriminator 3
 5459 020b D0A5EAFE 		salb	-278(%rbp)
 5459      FFFF
 5460              	.L517:
1689:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     for( i = 1; i < T_size; i <<= 1 )
 5461              		.loc 1 1689 5 discriminator 1
 5462 0211 0FB685EA 		movzbl	-278(%rbp), %eax
 5462      FEFFFF
 5463 0218 3A85EBFE 		cmpb	-277(%rbp), %al
 5463      FFFF
 5464 021e 72AF     		jb	.L518
1691:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1692:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_ECP_BUDGET( MBEDTLS_ECP_OPS_INV + 6 * j - 2 );
1693:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1694:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( ecp_normalize_jac_many( grp, TT, j ) );
 5465              		.loc 1 1694 5
 5466 0220 488B95F0 		movq	-272(%rbp), %rdx
 5466      FEFFFF
 5467 0227 488D8D00 		leaq	-256(%rbp), %rcx
 5467      FFFFFF
 5468 022e 488B85D8 		movq	-296(%rbp), %rax
 5468      FEFFFF
 5469 0235 4889CE   		movq	%rcx, %rsi
 5470 0238 4889C7   		movq	%rax, %rdi
 5471 023b E8000000 		call	ecp_normalize_jac_many
 5471      00
 5472 0240 8985ECFE 		movl	%eax, -276(%rbp)
 5472      FFFF
 5473 0246 83BDECFE 		cmpl	$0, -276(%rbp)
 5473      FFFF00
 5474 024d 0F858401 		jne	.L531
 5474      0000
1695:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1696:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
GAS LISTING /tmp/ccajKZL5.s 			page 151


1697:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && rs_ctx->rsm != NULL )
1698:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->rsm->state = ecp_rsm_pre_add;
1699:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1700:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** add:
1701:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
1702:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
1703:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * Compute the remaining ones using the minimal number of additions
1704:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * Be careful to update T[2^l] only after using it!
1705:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
1706:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_ECP_BUDGET( ( T_size - 1 ) * MBEDTLS_ECP_OPS_ADD );
1707:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1708:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     for( i = 1; i < T_size; i <<= 1 )
 5475              		.loc 1 1708 12
 5476 0253 C685EAFE 		movb	$1, -278(%rbp)
 5476      FFFF01
 5477              		.loc 1 1708 5
 5478 025a E9CC0000 		jmp	.L520
 5478      00
 5479              	.L523:
1709:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
1710:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         j = i;
 5480              		.loc 1 1710 11
 5481 025f 0FB685EA 		movzbl	-278(%rbp), %eax
 5481      FEFFFF
 5482 0266 488985F0 		movq	%rax, -272(%rbp)
 5482      FEFFFF
1711:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         while( j-- )
 5483              		.loc 1 1711 14
 5484 026d E9980000 		jmp	.L521
 5484      00
 5485              	.L522:
1712:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( ecp_add_mixed( grp, &T[i + j], &T[j], &T[i] ) );
 5486              		.loc 1 1712 13
 5487 0272 0FB695EA 		movzbl	-278(%rbp), %edx
 5487      FEFFFF
 5488 0279 4889D0   		movq	%rdx, %rax
 5489 027c 48C1E003 		salq	$3, %rax
 5490 0280 4801D0   		addq	%rdx, %rax
 5491 0283 48C1E003 		salq	$3, %rax
 5492 0287 4889C2   		movq	%rax, %rdx
 5493 028a 488B85D0 		movq	-304(%rbp), %rax
 5493      FEFFFF
 5494 0291 488D0C02 		leaq	(%rdx,%rax), %rcx
 5495 0295 488B95F0 		movq	-272(%rbp), %rdx
 5495      FEFFFF
 5496 029c 4889D0   		movq	%rdx, %rax
 5497 029f 48C1E003 		salq	$3, %rax
 5498 02a3 4801D0   		addq	%rdx, %rax
 5499 02a6 48C1E003 		salq	$3, %rax
 5500 02aa 4889C2   		movq	%rax, %rdx
 5501 02ad 488B85D0 		movq	-304(%rbp), %rax
 5501      FEFFFF
 5502 02b4 488D3C02 		leaq	(%rdx,%rax), %rdi
 5503 02b8 0FB695EA 		movzbl	-278(%rbp), %edx
 5503      FEFFFF
 5504 02bf 488B85F0 		movq	-272(%rbp), %rax
 5504      FEFFFF
GAS LISTING /tmp/ccajKZL5.s 			page 152


 5505 02c6 4801C2   		addq	%rax, %rdx
 5506 02c9 4889D0   		movq	%rdx, %rax
 5507 02cc 48C1E003 		salq	$3, %rax
 5508 02d0 4801D0   		addq	%rdx, %rax
 5509 02d3 48C1E003 		salq	$3, %rax
 5510 02d7 4889C2   		movq	%rax, %rdx
 5511 02da 488B85D0 		movq	-304(%rbp), %rax
 5511      FEFFFF
 5512 02e1 488D3402 		leaq	(%rdx,%rax), %rsi
 5513 02e5 488B85D8 		movq	-296(%rbp), %rax
 5513      FEFFFF
 5514 02ec 4889FA   		movq	%rdi, %rdx
 5515 02ef 4889C7   		movq	%rax, %rdi
 5516 02f2 E8000000 		call	ecp_add_mixed
 5516      00
 5517 02f7 8985ECFE 		movl	%eax, -276(%rbp)
 5517      FFFF
 5518 02fd 83BDECFE 		cmpl	$0, -276(%rbp)
 5518      FFFF00
 5519 0304 0F85D000 		jne	.L532
 5519      0000
 5520              	.L521:
1711:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         while( j-- )
 5521              		.loc 1 1711 17
 5522 030a 488B85F0 		movq	-272(%rbp), %rax
 5522      FEFFFF
 5523 0311 488D50FF 		leaq	-1(%rax), %rdx
 5524 0315 488995F0 		movq	%rdx, -272(%rbp)
 5524      FEFFFF
1711:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         while( j-- )
 5525              		.loc 1 1711 14
 5526 031c 4885C0   		testq	%rax, %rax
 5527 031f 0F854DFF 		jne	.L522
 5527      FFFF
1708:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 5528              		.loc 1 1708 31 discriminator 2
 5529 0325 D0A5EAFE 		salb	-278(%rbp)
 5529      FFFF
 5530              	.L520:
1708:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 5531              		.loc 1 1708 5 discriminator 1
 5532 032b 0FB685EA 		movzbl	-278(%rbp), %eax
 5532      FEFFFF
 5533 0332 3A85EBFE 		cmpb	-277(%rbp), %al
 5533      FFFF
 5534 0338 0F8221FF 		jb	.L523
 5534      FFFF
1713:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
1714:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1715:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
1716:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && rs_ctx->rsm != NULL )
1717:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->rsm->state = ecp_rsm_pre_norm_add;
1718:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1719:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** norm_add:
1720:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
1721:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
1722:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * Normalize final elements in T. Even though there are no holes now, we
GAS LISTING /tmp/ccajKZL5.s 			page 153


1723:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * still need the auxiliary array for homogeneity with the previous
1724:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * call. Also, skip T[0] which is already normalised, being a copy of P.
1725:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
1726:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     for( j = 0; j + 1 < T_size; j++ )
 5535              		.loc 1 1726 12
 5536 033e 48C785F0 		movq	$0, -272(%rbp)
 5536      FEFFFF00 
 5536      000000
 5537              		.loc 1 1726 5
 5538 0349 EB3D     		jmp	.L524
 5539              	.L525:
1727:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         TT[j] = T + j + 1;
 5540              		.loc 1 1727 23 discriminator 3
 5541 034b 488B85F0 		movq	-272(%rbp), %rax
 5541      FEFFFF
 5542 0352 488D5001 		leaq	1(%rax), %rdx
 5543 0356 4889D0   		movq	%rdx, %rax
 5544 0359 48C1E003 		salq	$3, %rax
 5545 035d 4801D0   		addq	%rdx, %rax
 5546 0360 48C1E003 		salq	$3, %rax
 5547 0364 4889C2   		movq	%rax, %rdx
 5548 0367 488B85D0 		movq	-304(%rbp), %rax
 5548      FEFFFF
 5549 036e 4801C2   		addq	%rax, %rdx
 5550              		.loc 1 1727 15 discriminator 3
 5551 0371 488B85F0 		movq	-272(%rbp), %rax
 5551      FEFFFF
 5552 0378 488994C5 		movq	%rdx, -256(%rbp,%rax,8)
 5552      00FFFFFF 
1726:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         TT[j] = T + j + 1;
 5553              		.loc 1 1726 34 discriminator 3
 5554 0380 488385F0 		addq	$1, -272(%rbp)
 5554      FEFFFF01 
 5555              	.L524:
1726:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         TT[j] = T + j + 1;
 5556              		.loc 1 1726 19 discriminator 1
 5557 0388 488B85F0 		movq	-272(%rbp), %rax
 5557      FEFFFF
 5558 038f 488D5001 		leaq	1(%rax), %rdx
1726:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         TT[j] = T + j + 1;
 5559              		.loc 1 1726 23 discriminator 1
 5560 0393 0FB685EB 		movzbl	-277(%rbp), %eax
 5560      FEFFFF
1726:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         TT[j] = T + j + 1;
 5561              		.loc 1 1726 5 discriminator 1
 5562 039a 4839C2   		cmpq	%rax, %rdx
 5563 039d 72AC     		jb	.L525
1728:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1729:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_ECP_BUDGET( MBEDTLS_ECP_OPS_INV + 6 * j - 2 );
1730:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1731:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( ecp_normalize_jac_many( grp, TT, j ) );
 5564              		.loc 1 1731 5
 5565 039f 488B95F0 		movq	-272(%rbp), %rdx
 5565      FEFFFF
 5566 03a6 488D8D00 		leaq	-256(%rbp), %rcx
 5566      FFFFFF
 5567 03ad 488B85D8 		movq	-296(%rbp), %rax
GAS LISTING /tmp/ccajKZL5.s 			page 154


 5567      FEFFFF
 5568 03b4 4889CE   		movq	%rcx, %rsi
 5569 03b7 4889C7   		movq	%rax, %rdi
 5570 03ba E8000000 		call	ecp_normalize_jac_many
 5570      00
 5571 03bf 8985ECFE 		movl	%eax, -276(%rbp)
 5571      FFFF
 5572 03c5 83BDECFE 		cmpl	$0, -276(%rbp)
 5572      FFFF00
1732:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1733:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
 5573              		.loc 1 1733 1
 5574 03cc EB0D     		jmp	.L512
 5575              	.L528:
1656:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 5576              		.loc 1 1656 5
 5577 03ce 90       		nop
 5578 03cf EB0A     		jmp	.L512
 5579              	.L529:
1673:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 5580              		.loc 1 1673 13
 5581 03d1 90       		nop
 5582 03d2 EB07     		jmp	.L512
 5583              	.L530:
1675:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 5584              		.loc 1 1675 9
 5585 03d4 90       		nop
 5586 03d5 EB04     		jmp	.L512
 5587              	.L531:
1694:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 5588              		.loc 1 1694 5
 5589 03d7 90       		nop
 5590 03d8 EB01     		jmp	.L512
 5591              	.L532:
1712:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 5592              		.loc 1 1712 13
 5593 03da 90       		nop
 5594              	.L512:
1734:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
1735:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && rs_ctx->rsm != NULL &&
1736:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         ret == MBEDTLS_ERR_ECP_IN_PROGRESS )
1737:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
1738:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( rs_ctx->rsm->state == ecp_rsm_pre_dbl )
1739:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             rs_ctx->rsm->i = j;
1740:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
1741:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
1742:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1743:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 5595              		.loc 1 1743 11
 5596 03db 8B85ECFE 		movl	-276(%rbp), %eax
 5596      FFFF
1744:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 5597              		.loc 1 1744 1
 5598 03e1 488B75F8 		movq	-8(%rbp), %rsi
 5599 03e5 64483334 		xorq	%fs:40, %rsi
 5599      25280000 
 5599      00
GAS LISTING /tmp/ccajKZL5.s 			page 155


 5600 03ee 7405     		je	.L527
 5601 03f0 E8000000 		call	__stack_chk_fail@PLT
 5601      00
 5602              	.L527:
 5603 03f5 C9       		leave
 5604              	.LCFI101:
 5605              		.cfi_def_cfa 7, 8
 5606 03f6 C3       		ret
 5607              		.cfi_endproc
 5608              	.LFE39:
 5610              		.section	.text.ecp_select_comb,"ax",@progbits
 5612              	ecp_select_comb:
 5613              	.LFB40:
1745:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1746:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
1747:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Select precomputed point: R = sign(i) * T[ abs(i) / 2 ]
1748:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1749:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * See ecp_comb_recode_core() for background
1750:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
1751:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static int ecp_select_comb( const mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
1752:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                             const mbedtls_ecp_point T[], unsigned char T_size,
1753:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                             unsigned char i )
1754:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 5614              		.loc 1 1754 1
 5615              		.cfi_startproc
 5616 0000 F30F1EFA 		endbr64
 5617 0004 55       		pushq	%rbp
 5618              	.LCFI102:
 5619              		.cfi_def_cfa_offset 16
 5620              		.cfi_offset 6, -16
 5621 0005 4889E5   		movq	%rsp, %rbp
 5622              	.LCFI103:
 5623              		.cfi_def_cfa_register 6
 5624 0008 4883EC30 		subq	$48, %rsp
 5625 000c 48897DE8 		movq	%rdi, -24(%rbp)
 5626 0010 488975E0 		movq	%rsi, -32(%rbp)
 5627 0014 488955D8 		movq	%rdx, -40(%rbp)
 5628 0018 89C8     		movl	%ecx, %eax
 5629 001a 4489C2   		movl	%r8d, %edx
 5630 001d 8845D4   		movb	%al, -44(%rbp)
 5631 0020 89D0     		movl	%edx, %eax
 5632 0022 8845D0   		movb	%al, -48(%rbp)
 5633              		.loc 1 1754 1
 5634 0025 64488B04 		movq	%fs:40, %rax
 5634      25280000 
 5634      00
 5635 002e 488945F8 		movq	%rax, -8(%rbp)
 5636 0032 31C0     		xorl	%eax, %eax
1755:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
1756:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     unsigned char ii, j;
1757:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1758:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Ignore the "sign" bit and scale down */
1759:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ii =  ( i & 0x7Fu ) >> 1;
 5637              		.loc 1 1759 25
 5638 0034 0FB645D0 		movzbl	-48(%rbp), %eax
 5639 0038 D1E8     		shrl	%eax
 5640              		.loc 1 1759 8
GAS LISTING /tmp/ccajKZL5.s 			page 156


 5641 003a 83E03F   		andl	$63, %eax
 5642 003d 8845F3   		movb	%al, -13(%rbp)
1760:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1761:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Read the whole table to thwart cache-based timing attacks */
1762:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     for( j = 0; j < T_size; j++ )
 5643              		.loc 1 1762 12
 5644 0040 C645F200 		movb	$0, -14(%rbp)
 5645              		.loc 1 1762 5
 5646 0044 E9990000 		jmp	.L534
 5646      00
 5647              	.L538:
1763:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
1764:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_safe_cond_assign( &R->X, &T[j].X, j == ii ) );
 5648              		.loc 1 1764 9
 5649 0049 0FB645F2 		movzbl	-14(%rbp), %eax
 5650 004d 3A45F3   		cmpb	-13(%rbp), %al
 5651 0050 0F94C0   		sete	%al
 5652 0053 0FB6C8   		movzbl	%al, %ecx
 5653 0056 0FB655F2 		movzbl	-14(%rbp), %edx
 5654 005a 4889D0   		movq	%rdx, %rax
 5655 005d 48C1E003 		salq	$3, %rax
 5656 0061 4801D0   		addq	%rdx, %rax
 5657 0064 48C1E003 		salq	$3, %rax
 5658 0068 4889C2   		movq	%rax, %rdx
 5659 006b 488B45D8 		movq	-40(%rbp), %rax
 5660 006f 4801D0   		addq	%rdx, %rax
 5661 0072 4889C6   		movq	%rax, %rsi
 5662 0075 488B45E0 		movq	-32(%rbp), %rax
 5663 0079 89CA     		movl	%ecx, %edx
 5664 007b 4889C7   		movq	%rax, %rdi
 5665 007e E8000000 		call	mbedtls_mpi_safe_cond_assign@PLT
 5665      00
 5666 0083 8945F4   		movl	%eax, -12(%rbp)
 5667 0086 837DF400 		cmpl	$0, -12(%rbp)
 5668 008a 0F858500 		jne	.L541
 5668      0000
1765:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_safe_cond_assign( &R->Y, &T[j].Y, j == ii ) );
 5669              		.loc 1 1765 9
 5670 0090 0FB645F2 		movzbl	-14(%rbp), %eax
 5671 0094 3A45F3   		cmpb	-13(%rbp), %al
 5672 0097 0F94C0   		sete	%al
 5673 009a 0FB6C8   		movzbl	%al, %ecx
 5674 009d 0FB655F2 		movzbl	-14(%rbp), %edx
 5675 00a1 4889D0   		movq	%rdx, %rax
 5676 00a4 48C1E003 		salq	$3, %rax
 5677 00a8 4801D0   		addq	%rdx, %rax
 5678 00ab 48C1E003 		salq	$3, %rax
 5679 00af 4889C2   		movq	%rax, %rdx
 5680 00b2 488B45D8 		movq	-40(%rbp), %rax
 5681 00b6 4801D0   		addq	%rdx, %rax
 5682 00b9 488D7018 		leaq	24(%rax), %rsi
 5683 00bd 488B45E0 		movq	-32(%rbp), %rax
 5684 00c1 4883C018 		addq	$24, %rax
 5685 00c5 89CA     		movl	%ecx, %edx
 5686 00c7 4889C7   		movq	%rax, %rdi
 5687 00ca E8000000 		call	mbedtls_mpi_safe_cond_assign@PLT
 5687      00
GAS LISTING /tmp/ccajKZL5.s 			page 157


 5688 00cf 8945F4   		movl	%eax, -12(%rbp)
 5689 00d2 837DF400 		cmpl	$0, -12(%rbp)
 5690 00d6 7540     		jne	.L542
1762:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 5691              		.loc 1 1762 30 discriminator 2
 5692 00d8 0FB645F2 		movzbl	-14(%rbp), %eax
 5693 00dc 83C001   		addl	$1, %eax
 5694 00df 8845F2   		movb	%al, -14(%rbp)
 5695              	.L534:
1762:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 5696              		.loc 1 1762 5 discriminator 1
 5697 00e2 0FB645F2 		movzbl	-14(%rbp), %eax
 5698 00e6 3A45D4   		cmpb	-44(%rbp), %al
 5699 00e9 0F825AFF 		jb	.L538
 5699      FFFF
1766:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
1767:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1768:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Safely invert result if i is "negative" */
1769:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( ecp_safe_invert_jac( grp, R, i >> 7 ) );
 5700              		.loc 1 1769 5
 5701 00ef 0FB645D0 		movzbl	-48(%rbp), %eax
 5702 00f3 C0E807   		shrb	$7, %al
 5703 00f6 0FB6D0   		movzbl	%al, %edx
 5704 00f9 488B4DE0 		movq	-32(%rbp), %rcx
 5705 00fd 488B45E8 		movq	-24(%rbp), %rax
 5706 0101 4889CE   		movq	%rcx, %rsi
 5707 0104 4889C7   		movq	%rax, %rdi
 5708 0107 E8000000 		call	ecp_safe_invert_jac
 5708      00
 5709 010c 8945F4   		movl	%eax, -12(%rbp)
 5710 010f 837DF400 		cmpl	$0, -12(%rbp)
1770:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1771:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
 5711              		.loc 1 1771 1
 5712 0113 EB04     		jmp	.L536
 5713              	.L541:
1764:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_safe_cond_assign( &R->Y, &T[j].Y, j == ii ) );
 5714              		.loc 1 1764 9
 5715 0115 90       		nop
 5716 0116 EB01     		jmp	.L536
 5717              	.L542:
1765:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 5718              		.loc 1 1765 9
 5719 0118 90       		nop
 5720              	.L536:
1772:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 5721              		.loc 1 1772 11
 5722 0119 8B45F4   		movl	-12(%rbp), %eax
1773:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 5723              		.loc 1 1773 1
 5724 011c 488B7DF8 		movq	-8(%rbp), %rdi
 5725 0120 6448333C 		xorq	%fs:40, %rdi
 5725      25280000 
 5725      00
 5726 0129 7405     		je	.L540
 5727 012b E8000000 		call	__stack_chk_fail@PLT
 5727      00
GAS LISTING /tmp/ccajKZL5.s 			page 158


 5728              	.L540:
 5729 0130 C9       		leave
 5730              	.LCFI104:
 5731              		.cfi_def_cfa 7, 8
 5732 0131 C3       		ret
 5733              		.cfi_endproc
 5734              	.LFE40:
 5736              		.section	.text.ecp_mul_comb_core,"ax",@progbits
 5738              	ecp_mul_comb_core:
 5739              	.LFB41:
1774:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1775:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
1776:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Core multiplication algorithm for the (modified) comb method.
1777:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * This part is actually common with the basic comb method (GECC 3.44)
1778:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1779:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Cost: d A + d D + 1 R
1780:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
1781:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static int ecp_mul_comb_core( const mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
1782:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                               const mbedtls_ecp_point T[], unsigned char T_size,
1783:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                               const unsigned char x[], size_t d,
1784:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                               int (*f_rng)(void *, unsigned char *, size_t),
1785:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                               void *p_rng,
1786:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                               mbedtls_ecp_restart_ctx *rs_ctx )
1787:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 5740              		.loc 1 1787 1
 5741              		.cfi_startproc
 5742 0000 F30F1EFA 		endbr64
 5743 0004 55       		pushq	%rbp
 5744              	.LCFI105:
 5745              		.cfi_def_cfa_offset 16
 5746              		.cfi_offset 6, -16
 5747 0005 4889E5   		movq	%rsp, %rbp
 5748              	.LCFI106:
 5749              		.cfi_def_cfa_register 6
 5750 0008 4881ECB0 		subq	$176, %rsp
 5750      000000
 5751 000f 48897D98 		movq	%rdi, -104(%rbp)
 5752 0013 48897590 		movq	%rsi, -112(%rbp)
 5753 0017 48895588 		movq	%rdx, -120(%rbp)
 5754 001b 89C8     		movl	%ecx, %eax
 5755 001d 4C898578 		movq	%r8, -136(%rbp)
 5755      FFFFFF
 5756 0024 4C898D70 		movq	%r9, -144(%rbp)
 5756      FFFFFF
 5757 002b 884584   		movb	%al, -124(%rbp)
 5758 002e 488B4510 		movq	16(%rbp), %rax
 5759 0032 48898568 		movq	%rax, -152(%rbp)
 5759      FFFFFF
 5760 0039 488B4518 		movq	24(%rbp), %rax
 5761 003d 48898560 		movq	%rax, -160(%rbp)
 5761      FFFFFF
 5762 0044 488B4520 		movq	32(%rbp), %rax
 5763 0048 48898558 		movq	%rax, -168(%rbp)
 5763      FFFFFF
 5764              		.loc 1 1787 1
 5765 004f 64488B04 		movq	%fs:40, %rax
 5765      25280000 
GAS LISTING /tmp/ccajKZL5.s 			page 159


 5765      00
 5766 0058 488945F8 		movq	%rax, -8(%rbp)
 5767 005c 31C0     		xorl	%eax, %eax
1788:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
1789:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point Txi;
1790:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     size_t i;
1791:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1792:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point_init( &Txi );
 5768              		.loc 1 1792 5
 5769 005e 488D45B0 		leaq	-80(%rbp), %rax
 5770 0062 4889C7   		movq	%rax, %rdi
 5771 0065 E8000000 		call	mbedtls_ecp_point_init
 5771      00
1793:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1794:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if !defined(MBEDTLS_ECP_RESTARTABLE)
1795:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     (void) rs_ctx;
1796:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
1797:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1798:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
1799:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && rs_ctx->rsm != NULL &&
1800:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->rsm->state != ecp_rsm_comb_core )
1801:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
1802:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->rsm->i = 0;
1803:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->rsm->state = ecp_rsm_comb_core;
1804:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
1805:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1806:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* new 'if' instead of nested for the sake of the 'else' branch */
1807:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && rs_ctx->rsm != NULL && rs_ctx->rsm->i != 0 )
1808:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
1809:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* restore current index (R already pointing to rs_ctx->rsm->R) */
1810:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         i = rs_ctx->rsm->i;
1811:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
1812:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     else
1813:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
1814:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
1815:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* Start with a non-zero point and randomize its coordinates */
1816:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         i = d;
 5772              		.loc 1 1816 11
 5773 006a 488B8570 		movq	-144(%rbp), %rax
 5773      FFFFFF
 5774 0071 488945A8 		movq	%rax, -88(%rbp)
1817:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( ecp_select_comb( grp, R, T, T_size, x[i] ) );
 5775              		.loc 1 1817 9
 5776 0075 488B9578 		movq	-136(%rbp), %rdx
 5776      FFFFFF
 5777 007c 488B45A8 		movq	-88(%rbp), %rax
 5778 0080 4801D0   		addq	%rdx, %rax
 5779 0083 0FB600   		movzbl	(%rax), %eax
 5780 0086 0FB6F8   		movzbl	%al, %edi
 5781 0089 0FB64D84 		movzbl	-124(%rbp), %ecx
 5782 008d 488B5588 		movq	-120(%rbp), %rdx
 5783 0091 488B7590 		movq	-112(%rbp), %rsi
 5784 0095 488B4598 		movq	-104(%rbp), %rax
 5785 0099 4189F8   		movl	%edi, %r8d
 5786 009c 4889C7   		movq	%rax, %rdi
 5787 009f E8000000 		call	ecp_select_comb
 5787      00
GAS LISTING /tmp/ccajKZL5.s 			page 160


 5788 00a4 8945A4   		movl	%eax, -92(%rbp)
 5789 00a7 837DA400 		cmpl	$0, -92(%rbp)
 5790 00ab 0F85E800 		jne	.L554
 5790      0000
1818:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_lset( &R->Z, 1 ) );
 5791              		.loc 1 1818 9
 5792 00b1 488B4590 		movq	-112(%rbp), %rax
 5793 00b5 4883C030 		addq	$48, %rax
 5794 00b9 BE010000 		movl	$1, %esi
 5794      00
 5795 00be 4889C7   		movq	%rax, %rdi
 5796 00c1 E8000000 		call	mbedtls_mpi_lset@PLT
 5796      00
 5797 00c6 8945A4   		movl	%eax, -92(%rbp)
 5798 00c9 837DA400 		cmpl	$0, -92(%rbp)
 5799 00cd 0F85C900 		jne	.L555
 5799      0000
1819:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( f_rng != 0 )
 5800              		.loc 1 1819 11
 5801 00d3 4883BD68 		cmpq	$0, -152(%rbp)
 5801      FFFFFF00 
 5802 00db 0F84AB00 		je	.L548
 5802      0000
1820:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( ecp_randomize_jac( grp, R, f_rng, p_rng ) );
 5803              		.loc 1 1820 13
 5804 00e1 488B8D60 		movq	-160(%rbp), %rcx
 5804      FFFFFF
 5805 00e8 488B9568 		movq	-152(%rbp), %rdx
 5805      FFFFFF
 5806 00ef 488B7590 		movq	-112(%rbp), %rsi
 5807 00f3 488B4598 		movq	-104(%rbp), %rax
 5808 00f7 4889C7   		movq	%rax, %rdi
 5809 00fa E8000000 		call	ecp_randomize_jac
 5809      00
 5810 00ff 8945A4   		movl	%eax, -92(%rbp)
 5811 0102 837DA400 		cmpl	$0, -92(%rbp)
 5812 0106 0F859300 		jne	.L556
 5812      0000
1821:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
1822:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1823:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     while( i != 0 )
 5813              		.loc 1 1823 10
 5814 010c EB7E     		jmp	.L548
 5815              	.L551:
1824:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
1825:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_ECP_BUDGET( MBEDTLS_ECP_OPS_DBL + MBEDTLS_ECP_OPS_ADD );
1826:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         --i;
 5816              		.loc 1 1826 9
 5817 010e 48836DA8 		subq	$1, -88(%rbp)
 5817      01
1827:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1828:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( ecp_double_jac( grp, R, R ) );
 5818              		.loc 1 1828 9
 5819 0113 488B5590 		movq	-112(%rbp), %rdx
 5820 0117 488B4D90 		movq	-112(%rbp), %rcx
 5821 011b 488B4598 		movq	-104(%rbp), %rax
 5822 011f 4889CE   		movq	%rcx, %rsi
GAS LISTING /tmp/ccajKZL5.s 			page 161


 5823 0122 4889C7   		movq	%rax, %rdi
 5824 0125 E8000000 		call	ecp_double_jac
 5824      00
 5825 012a 8945A4   		movl	%eax, -92(%rbp)
 5826 012d 837DA400 		cmpl	$0, -92(%rbp)
 5827 0131 756F     		jne	.L557
1829:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( ecp_select_comb( grp, &Txi, T, T_size, x[i] ) );
 5828              		.loc 1 1829 9
 5829 0133 488B9578 		movq	-136(%rbp), %rdx
 5829      FFFFFF
 5830 013a 488B45A8 		movq	-88(%rbp), %rax
 5831 013e 4801D0   		addq	%rdx, %rax
 5832 0141 0FB600   		movzbl	(%rax), %eax
 5833 0144 0FB6F8   		movzbl	%al, %edi
 5834 0147 0FB64D84 		movzbl	-124(%rbp), %ecx
 5835 014b 488B5588 		movq	-120(%rbp), %rdx
 5836 014f 488D75B0 		leaq	-80(%rbp), %rsi
 5837 0153 488B4598 		movq	-104(%rbp), %rax
 5838 0157 4189F8   		movl	%edi, %r8d
 5839 015a 4889C7   		movq	%rax, %rdi
 5840 015d E8000000 		call	ecp_select_comb
 5840      00
 5841 0162 8945A4   		movl	%eax, -92(%rbp)
 5842 0165 837DA400 		cmpl	$0, -92(%rbp)
 5843 0169 753A     		jne	.L558
1830:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( ecp_add_mixed( grp, R, R, &Txi ) );
 5844              		.loc 1 1830 9
 5845 016b 488D4DB0 		leaq	-80(%rbp), %rcx
 5846 016f 488B5590 		movq	-112(%rbp), %rdx
 5847 0173 488B7590 		movq	-112(%rbp), %rsi
 5848 0177 488B4598 		movq	-104(%rbp), %rax
 5849 017b 4889C7   		movq	%rax, %rdi
 5850 017e E8000000 		call	ecp_add_mixed
 5850      00
 5851 0183 8945A4   		movl	%eax, -92(%rbp)
 5852 0186 837DA400 		cmpl	$0, -92(%rbp)
 5853 018a 751C     		jne	.L559
 5854              	.L548:
1823:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
 5855              		.loc 1 1823 10
 5856 018c 48837DA8 		cmpq	$0, -88(%rbp)
 5856      00
 5857 0191 0F8577FF 		jne	.L551
 5857      FFFF
1831:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
1832:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1833:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
 5858              		.loc 1 1833 1
 5859 0197 EB10     		jmp	.L545
 5860              	.L554:
1817:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_lset( &R->Z, 1 ) );
 5861              		.loc 1 1817 9
 5862 0199 90       		nop
 5863 019a EB0D     		jmp	.L545
 5864              	.L555:
1818:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( f_rng != 0 )
 5865              		.loc 1 1818 9
GAS LISTING /tmp/ccajKZL5.s 			page 162


 5866 019c 90       		nop
 5867 019d EB0A     		jmp	.L545
 5868              	.L556:
1820:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 5869              		.loc 1 1820 13
 5870 019f 90       		nop
 5871 01a0 EB07     		jmp	.L545
 5872              	.L557:
1828:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( ecp_select_comb( grp, &Txi, T, T_size, x[i] ) );
 5873              		.loc 1 1828 9
 5874 01a2 90       		nop
 5875 01a3 EB04     		jmp	.L545
 5876              	.L558:
1829:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( ecp_add_mixed( grp, R, R, &Txi ) );
 5877              		.loc 1 1829 9
 5878 01a5 90       		nop
 5879 01a6 EB01     		jmp	.L545
 5880              	.L559:
1830:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 5881              		.loc 1 1830 9
 5882 01a8 90       		nop
 5883              	.L545:
1834:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1835:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point_free( &Txi );
 5884              		.loc 1 1835 5
 5885 01a9 488D45B0 		leaq	-80(%rbp), %rax
 5886 01ad 4889C7   		movq	%rax, %rdi
 5887 01b0 E8000000 		call	mbedtls_ecp_point_free
 5887      00
1836:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1837:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
1838:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && rs_ctx->rsm != NULL &&
1839:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         ret == MBEDTLS_ERR_ECP_IN_PROGRESS )
1840:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
1841:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->rsm->i = i;
1842:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* no need to save R, already pointing to rs_ctx->rsm->R */
1843:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
1844:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
1845:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1846:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 5888              		.loc 1 1846 11
 5889 01b5 8B45A4   		movl	-92(%rbp), %eax
1847:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 5890              		.loc 1 1847 1
 5891 01b8 488B7DF8 		movq	-8(%rbp), %rdi
 5892 01bc 6448333C 		xorq	%fs:40, %rdi
 5892      25280000 
 5892      00
 5893 01c5 7405     		je	.L553
 5894 01c7 E8000000 		call	__stack_chk_fail@PLT
 5894      00
 5895              	.L553:
 5896 01cc C9       		leave
 5897              	.LCFI107:
 5898              		.cfi_def_cfa 7, 8
 5899 01cd C3       		ret
 5900              		.cfi_endproc
GAS LISTING /tmp/ccajKZL5.s 			page 163


 5901              	.LFE41:
 5903              		.section	.text.ecp_comb_recode_scalar,"ax",@progbits
 5905              	ecp_comb_recode_scalar:
 5906              	.LFB42:
1848:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1849:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
1850:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Recode the scalar to get constant-time comb multiplication
1851:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1852:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * As the actual scalar recoding needs an odd scalar as a starting point,
1853:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * this wrapper ensures that by replacing m by N - m if necessary, and
1854:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * informs the caller that the result of multiplication will be negated.
1855:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1856:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * This works because we only support large prime order for Short Weierstrass
1857:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * curves, so N is always odd hence either m or N - m is.
1858:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1859:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * See ecp_comb_recode_core() for background.
1860:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
1861:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static int ecp_comb_recode_scalar( const mbedtls_ecp_group *grp,
1862:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                    const mbedtls_mpi *m,
1863:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                    unsigned char k[COMB_MAX_D + 1],
1864:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                    size_t d,
1865:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                    unsigned char w,
1866:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                    unsigned char *parity_trick )
1867:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 5907              		.loc 1 1867 1
 5908              		.cfi_startproc
 5909 0000 F30F1EFA 		endbr64
 5910 0004 55       		pushq	%rbp
 5911              	.LCFI108:
 5912              		.cfi_def_cfa_offset 16
 5913              		.cfi_offset 6, -16
 5914 0005 4889E5   		movq	%rsp, %rbp
 5915              	.LCFI109:
 5916              		.cfi_def_cfa_register 6
 5917 0008 4883C480 		addq	$-128, %rsp
 5918 000c 48897DA8 		movq	%rdi, -88(%rbp)
 5919 0010 488975A0 		movq	%rsi, -96(%rbp)
 5920 0014 48895598 		movq	%rdx, -104(%rbp)
 5921 0018 48894D90 		movq	%rcx, -112(%rbp)
 5922 001c 4489C0   		movl	%r8d, %eax
 5923 001f 4C894D80 		movq	%r9, -128(%rbp)
 5924 0023 88458C   		movb	%al, -116(%rbp)
 5925              		.loc 1 1867 1
 5926 0026 64488B04 		movq	%fs:40, %rax
 5926      25280000 
 5926      00
 5927 002f 488945F8 		movq	%rax, -8(%rbp)
 5928 0033 31C0     		xorl	%eax, %eax
1868:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
1869:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi M, mm;
1870:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1871:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_init( &M );
 5929              		.loc 1 1871 5
 5930 0035 488D45C0 		leaq	-64(%rbp), %rax
 5931 0039 4889C7   		movq	%rax, %rdi
 5932 003c E8000000 		call	mbedtls_mpi_init@PLT
 5932      00
GAS LISTING /tmp/ccajKZL5.s 			page 164


1872:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_init( &mm );
 5933              		.loc 1 1872 5
 5934 0041 488D45E0 		leaq	-32(%rbp), %rax
 5935 0045 4889C7   		movq	%rax, %rdi
 5936 0048 E8000000 		call	mbedtls_mpi_init@PLT
 5936      00
1873:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1874:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* N is always odd (see above), just make extra sure */
1875:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( mbedtls_mpi_get_bit( &grp->N, 0 ) != 1 )
 5937              		.loc 1 1875 9
 5938 004d 488B45A8 		movq	-88(%rbp), %rax
 5939 0051 48059800 		addq	$152, %rax
 5939      0000
 5940 0057 BE000000 		movl	$0, %esi
 5940      00
 5941 005c 4889C7   		movq	%rax, %rdi
 5942 005f E8000000 		call	mbedtls_mpi_get_bit@PLT
 5942      00
 5943              		.loc 1 1875 7
 5944 0064 83F801   		cmpl	$1, %eax
 5945 0067 740A     		je	.L561
1876:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( MBEDTLS_ERR_ECP_BAD_INPUT_DATA );
 5946              		.loc 1 1876 15
 5947 0069 B880B0FF 		movl	$-20352, %eax
 5947      FF
 5948 006e E9C30000 		jmp	.L567
 5948      00
 5949              	.L561:
1877:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1878:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* do we need the parity trick? */
1879:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     *parity_trick = ( mbedtls_mpi_get_bit( m, 0 ) == 0 );
 5950              		.loc 1 1879 23
 5951 0073 488B45A0 		movq	-96(%rbp), %rax
 5952 0077 BE000000 		movl	$0, %esi
 5952      00
 5953 007c 4889C7   		movq	%rax, %rdi
 5954 007f E8000000 		call	mbedtls_mpi_get_bit@PLT
 5954      00
 5955              		.loc 1 1879 51
 5956 0084 85C0     		testl	%eax, %eax
 5957 0086 0F94C0   		sete	%al
 5958 0089 89C2     		movl	%eax, %edx
 5959              		.loc 1 1879 19
 5960 008b 488B4580 		movq	-128(%rbp), %rax
 5961 008f 8810     		movb	%dl, (%rax)
1880:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1881:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* execute parity fix in constant time */
1882:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &M, m ) );
 5962              		.loc 1 1882 5
 5963 0091 488B55A0 		movq	-96(%rbp), %rdx
 5964 0095 488D45C0 		leaq	-64(%rbp), %rax
 5965 0099 4889D6   		movq	%rdx, %rsi
 5966 009c 4889C7   		movq	%rax, %rdi
 5967 009f E8000000 		call	mbedtls_mpi_copy@PLT
 5967      00
 5968 00a4 8945BC   		movl	%eax, -68(%rbp)
 5969 00a7 837DBC00 		cmpl	$0, -68(%rbp)
GAS LISTING /tmp/ccajKZL5.s 			page 165


 5970 00ab 7567     		jne	.L569
1883:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &mm, &grp->N, m ) );
 5971              		.loc 1 1883 5
 5972 00ad 488B45A8 		movq	-88(%rbp), %rax
 5973 00b1 488D8898 		leaq	152(%rax), %rcx
 5973      000000
 5974 00b8 488B55A0 		movq	-96(%rbp), %rdx
 5975 00bc 488D45E0 		leaq	-32(%rbp), %rax
 5976 00c0 4889CE   		movq	%rcx, %rsi
 5977 00c3 4889C7   		movq	%rax, %rdi
 5978 00c6 E8000000 		call	mbedtls_mpi_sub_mpi@PLT
 5978      00
 5979 00cb 8945BC   		movl	%eax, -68(%rbp)
 5980 00ce 837DBC00 		cmpl	$0, -68(%rbp)
 5981 00d2 7543     		jne	.L570
1884:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_safe_cond_assign( &M, &mm, *parity_trick ) );
 5982              		.loc 1 1884 5
 5983 00d4 488B4580 		movq	-128(%rbp), %rax
 5984 00d8 0FB600   		movzbl	(%rax), %eax
 5985 00db 0FB6D0   		movzbl	%al, %edx
 5986 00de 488D4DE0 		leaq	-32(%rbp), %rcx
 5987 00e2 488D45C0 		leaq	-64(%rbp), %rax
 5988 00e6 4889CE   		movq	%rcx, %rsi
 5989 00e9 4889C7   		movq	%rax, %rdi
 5990 00ec E8000000 		call	mbedtls_mpi_safe_cond_assign@PLT
 5990      00
 5991 00f1 8945BC   		movl	%eax, -68(%rbp)
 5992 00f4 837DBC00 		cmpl	$0, -68(%rbp)
 5993 00f8 7520     		jne	.L571
1885:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1886:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* actual scalar recoding */
1887:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ecp_comb_recode_core( k, d, w, &M );
 5994              		.loc 1 1887 5
 5995 00fa 0FB6558C 		movzbl	-116(%rbp), %edx
 5996 00fe 488D4DC0 		leaq	-64(%rbp), %rcx
 5997 0102 488B7590 		movq	-112(%rbp), %rsi
 5998 0106 488B4598 		movq	-104(%rbp), %rax
 5999 010a 4889C7   		movq	%rax, %rdi
 6000 010d E8000000 		call	ecp_comb_recode_core
 6000      00
 6001 0112 EB07     		jmp	.L564
 6002              	.L569:
1882:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &mm, &grp->N, m ) );
 6003              		.loc 1 1882 5
 6004 0114 90       		nop
 6005 0115 EB04     		jmp	.L564
 6006              	.L570:
1883:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_safe_cond_assign( &M, &mm, *parity_trick ) );
 6007              		.loc 1 1883 5
 6008 0117 90       		nop
 6009 0118 EB01     		jmp	.L564
 6010              	.L571:
1884:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 6011              		.loc 1 1884 5
 6012 011a 90       		nop
 6013              	.L564:
1888:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
GAS LISTING /tmp/ccajKZL5.s 			page 166


1889:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
1890:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_free( &mm );
 6014              		.loc 1 1890 5
 6015 011b 488D45E0 		leaq	-32(%rbp), %rax
 6016 011f 4889C7   		movq	%rax, %rdi
 6017 0122 E8000000 		call	mbedtls_mpi_free@PLT
 6017      00
1891:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_free( &M );
 6018              		.loc 1 1891 5
 6019 0127 488D45C0 		leaq	-64(%rbp), %rax
 6020 012b 4889C7   		movq	%rax, %rdi
 6021 012e E8000000 		call	mbedtls_mpi_free@PLT
 6021      00
1892:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1893:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 6022              		.loc 1 1893 11
 6023 0133 8B45BC   		movl	-68(%rbp), %eax
 6024              	.L567:
1894:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 6025              		.loc 1 1894 1 discriminator 1
 6026 0136 488B4DF8 		movq	-8(%rbp), %rcx
 6027 013a 6448330C 		xorq	%fs:40, %rcx
 6027      25280000 
 6027      00
 6028 0143 7405     		je	.L568
 6029              		.loc 1 1894 1 is_stmt 0
 6030 0145 E8000000 		call	__stack_chk_fail@PLT
 6030      00
 6031              	.L568:
 6032 014a C9       		leave
 6033              	.LCFI110:
 6034              		.cfi_def_cfa 7, 8
 6035 014b C3       		ret
 6036              		.cfi_endproc
 6037              	.LFE42:
 6039              		.section	.text.ecp_mul_comb_after_precomp,"ax",@progbits
 6041              	ecp_mul_comb_after_precomp:
 6042              	.LFB43:
1895:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1896:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
1897:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Perform comb multiplication (for short Weierstrass curves)
1898:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * once the auxiliary table has been pre-computed.
1899:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1900:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Scalar recoding may use a parity trick that makes us compute -m * P,
1901:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * if that is the case we'll need to recover m * P at the end.
1902:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
1903:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static int ecp_mul_comb_after_precomp( const mbedtls_ecp_group *grp,
1904:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                 mbedtls_ecp_point *R,
1905:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                 const mbedtls_mpi *m,
1906:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                 const mbedtls_ecp_point *T,
1907:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                 unsigned char T_size,
1908:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                 unsigned char w,
1909:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                 size_t d,
1910:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                 int (*f_rng)(void *, unsigned char *, size_t),
1911:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                 void *p_rng,
1912:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                 mbedtls_ecp_restart_ctx *rs_ctx )
1913:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
GAS LISTING /tmp/ccajKZL5.s 			page 167


 6043              		.loc 1 1913 1 is_stmt 1
 6044              		.cfi_startproc
 6045 0000 F30F1EFA 		endbr64
 6046 0004 55       		pushq	%rbp
 6047              	.LCFI111:
 6048              		.cfi_def_cfa_offset 16
 6049              		.cfi_offset 6, -16
 6050 0005 4889E5   		movq	%rsp, %rbp
 6051              	.LCFI112:
 6052              		.cfi_def_cfa_register 6
 6053 0008 4881EC70 		subq	$368, %rsp
 6053      010000
 6054 000f 4889BDD8 		movq	%rdi, -296(%rbp)
 6054      FEFFFF
 6055 0016 4889B5D0 		movq	%rsi, -304(%rbp)
 6055      FEFFFF
 6056 001d 488995C8 		movq	%rdx, -312(%rbp)
 6056      FEFFFF
 6057 0024 48898DC0 		movq	%rcx, -320(%rbp)
 6057      FEFFFF
 6058 002b 4489C0   		movl	%r8d, %eax
 6059 002e 4489CA   		movl	%r9d, %edx
 6060 0031 8885BCFE 		movb	%al, -324(%rbp)
 6060      FFFF
 6061 0037 89D0     		movl	%edx, %eax
 6062 0039 8885B8FE 		movb	%al, -328(%rbp)
 6062      FFFF
 6063 003f 488B4510 		movq	16(%rbp), %rax
 6064 0043 488985B0 		movq	%rax, -336(%rbp)
 6064      FEFFFF
 6065 004a 488B4518 		movq	24(%rbp), %rax
 6066 004e 488985A8 		movq	%rax, -344(%rbp)
 6066      FEFFFF
 6067 0055 488B4520 		movq	32(%rbp), %rax
 6068 0059 488985A0 		movq	%rax, -352(%rbp)
 6068      FEFFFF
 6069 0060 488B4528 		movq	40(%rbp), %rax
 6070 0064 48898598 		movq	%rax, -360(%rbp)
 6070      FEFFFF
 6071              		.loc 1 1913 1
 6072 006b 64488B04 		movq	%fs:40, %rax
 6072      25280000 
 6072      00
 6073 0074 488945F8 		movq	%rax, -8(%rbp)
 6074 0078 31C0     		xorl	%eax, %eax
1914:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
1915:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     unsigned char parity_trick;
1916:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     unsigned char k[COMB_MAX_D + 1];
1917:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point *RR = R;
 6075              		.loc 1 1917 24
 6076 007a 488B85D0 		movq	-304(%rbp), %rax
 6076      FEFFFF
 6077 0081 488985E8 		movq	%rax, -280(%rbp)
 6077      FEFFFF
1918:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1919:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
1920:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && rs_ctx->rsm != NULL )
GAS LISTING /tmp/ccajKZL5.s 			page 168


1921:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
1922:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         RR = &rs_ctx->rsm->R;
1923:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1924:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( rs_ctx->rsm->state == ecp_rsm_final_norm )
1925:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             goto final_norm;
1926:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
1927:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
1928:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1929:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( ecp_comb_recode_scalar( grp, m, k, d, w,
 6078              		.loc 1 1929 5
 6079 0088 0FB6BDB8 		movzbl	-328(%rbp), %edi
 6079      FEFFFF
 6080 008f 4C8D85E3 		leaq	-285(%rbp), %r8
 6080      FEFFFF
 6081 0096 488B8DB0 		movq	-336(%rbp), %rcx
 6081      FEFFFF
 6082 009d 488D95F0 		leaq	-272(%rbp), %rdx
 6082      FEFFFF
 6083 00a4 488BB5C8 		movq	-312(%rbp), %rsi
 6083      FEFFFF
 6084 00ab 488B85D8 		movq	-296(%rbp), %rax
 6084      FEFFFF
 6085 00b2 4D89C1   		movq	%r8, %r9
 6086 00b5 4189F8   		movl	%edi, %r8d
 6087 00b8 4889C7   		movq	%rax, %rdi
 6088 00bb E8000000 		call	ecp_comb_recode_scalar
 6088      00
 6089 00c0 8985E4FE 		movl	%eax, -284(%rbp)
 6089      FFFF
 6090 00c6 83BDE4FE 		cmpl	$0, -284(%rbp)
 6090      FFFF00
 6091 00cd 0F85BB00 		jne	.L579
 6091      0000
1930:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                             &parity_trick ) );
1931:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( ecp_mul_comb_core( grp, RR, T, T_size, k, d,
 6092              		.loc 1 1931 5
 6093 00d3 0FB68DBC 		movzbl	-324(%rbp), %ecx
 6093      FEFFFF
 6094 00da 4C8B85B0 		movq	-336(%rbp), %r8
 6094      FEFFFF
 6095 00e1 488DBDF0 		leaq	-272(%rbp), %rdi
 6095      FEFFFF
 6096 00e8 488B95C0 		movq	-320(%rbp), %rdx
 6096      FEFFFF
 6097 00ef 488BB5E8 		movq	-280(%rbp), %rsi
 6097      FEFFFF
 6098 00f6 488B85D8 		movq	-296(%rbp), %rax
 6098      FEFFFF
 6099 00fd 4883EC08 		subq	$8, %rsp
 6100 0101 FFB598FE 		pushq	-360(%rbp)
 6100      FFFF
 6101 0107 FFB5A0FE 		pushq	-352(%rbp)
 6101      FFFF
 6102 010d FFB5A8FE 		pushq	-344(%rbp)
 6102      FFFF
 6103 0113 4D89C1   		movq	%r8, %r9
 6104 0116 4989F8   		movq	%rdi, %r8
GAS LISTING /tmp/ccajKZL5.s 			page 169


 6105 0119 4889C7   		movq	%rax, %rdi
 6106 011c E8000000 		call	ecp_mul_comb_core
 6106      00
 6107 0121 4883C420 		addq	$32, %rsp
 6108 0125 8985E4FE 		movl	%eax, -284(%rbp)
 6108      FFFF
 6109 012b 83BDE4FE 		cmpl	$0, -284(%rbp)
 6109      FFFF00
 6110 0132 755D     		jne	.L580
1932:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                         f_rng, p_rng, rs_ctx ) );
1933:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( ecp_safe_invert_jac( grp, RR, parity_trick ) );
 6111              		.loc 1 1933 5
 6112 0134 0FB685E3 		movzbl	-285(%rbp), %eax
 6112      FEFFFF
 6113 013b 0FB6D0   		movzbl	%al, %edx
 6114 013e 488B8DE8 		movq	-280(%rbp), %rcx
 6114      FEFFFF
 6115 0145 488B85D8 		movq	-296(%rbp), %rax
 6115      FEFFFF
 6116 014c 4889CE   		movq	%rcx, %rsi
 6117 014f 4889C7   		movq	%rax, %rdi
 6118 0152 E8000000 		call	ecp_safe_invert_jac
 6118      00
 6119 0157 8985E4FE 		movl	%eax, -284(%rbp)
 6119      FFFF
 6120 015d 83BDE4FE 		cmpl	$0, -284(%rbp)
 6120      FFFF00
 6121 0164 752E     		jne	.L581
1934:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1935:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
1936:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && rs_ctx->rsm != NULL )
1937:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->rsm->state = ecp_rsm_final_norm;
1938:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1939:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** final_norm:
1940:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
1941:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_ECP_BUDGET( MBEDTLS_ECP_OPS_INV );
1942:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( ecp_normalize_jac( grp, RR ) );
 6122              		.loc 1 1942 5
 6123 0166 488B95E8 		movq	-280(%rbp), %rdx
 6123      FEFFFF
 6124 016d 488B85D8 		movq	-296(%rbp), %rax
 6124      FEFFFF
 6125 0174 4889D6   		movq	%rdx, %rsi
 6126 0177 4889C7   		movq	%rax, %rdi
 6127 017a E8000000 		call	ecp_normalize_jac
 6127      00
 6128 017f 8985E4FE 		movl	%eax, -284(%rbp)
 6128      FFFF
 6129 0185 83BDE4FE 		cmpl	$0, -284(%rbp)
 6129      FFFF00
1943:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1944:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
1945:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && rs_ctx->rsm != NULL )
1946:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_ecp_copy( R, RR ) );
1947:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
1948:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1949:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
GAS LISTING /tmp/ccajKZL5.s 			page 170


 6130              		.loc 1 1949 1
 6131 018c EB07     		jmp	.L574
 6132              	.L579:
1929:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                             &parity_trick ) );
 6133              		.loc 1 1929 5
 6134 018e 90       		nop
 6135 018f EB04     		jmp	.L574
 6136              	.L580:
1931:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                         f_rng, p_rng, rs_ctx ) );
 6137              		.loc 1 1931 5
 6138 0191 90       		nop
 6139 0192 EB01     		jmp	.L574
 6140              	.L581:
1933:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 6141              		.loc 1 1933 5
 6142 0194 90       		nop
 6143              	.L574:
1950:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 6144              		.loc 1 1950 11
 6145 0195 8B85E4FE 		movl	-284(%rbp), %eax
 6145      FFFF
1951:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 6146              		.loc 1 1951 1
 6147 019b 488B4DF8 		movq	-8(%rbp), %rcx
 6148 019f 6448330C 		xorq	%fs:40, %rcx
 6148      25280000 
 6148      00
 6149 01a8 7405     		je	.L578
 6150 01aa E8000000 		call	__stack_chk_fail@PLT
 6150      00
 6151              	.L578:
 6152 01af C9       		leave
 6153              	.LCFI113:
 6154              		.cfi_def_cfa 7, 8
 6155 01b0 C3       		ret
 6156              		.cfi_endproc
 6157              	.LFE43:
 6159              		.section	.text.ecp_pick_window_size,"ax",@progbits
 6161              	ecp_pick_window_size:
 6162              	.LFB44:
1952:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1953:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
1954:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Pick window size based on curve size and whether we optimize for base point
1955:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
1956:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static unsigned char ecp_pick_window_size( const mbedtls_ecp_group *grp,
1957:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                            unsigned char p_eq_g )
1958:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 6163              		.loc 1 1958 1
 6164              		.cfi_startproc
 6165 0000 F30F1EFA 		endbr64
 6166 0004 55       		pushq	%rbp
 6167              	.LCFI114:
 6168              		.cfi_def_cfa_offset 16
 6169              		.cfi_offset 6, -16
 6170 0005 4889E5   		movq	%rsp, %rbp
 6171              	.LCFI115:
 6172              		.cfi_def_cfa_register 6
GAS LISTING /tmp/ccajKZL5.s 			page 171


 6173 0008 4883EC20 		subq	$32, %rsp
 6174 000c 48897DE8 		movq	%rdi, -24(%rbp)
 6175 0010 89F0     		movl	%esi, %eax
 6176 0012 8845E4   		movb	%al, -28(%rbp)
 6177              		.loc 1 1958 1
 6178 0015 64488B04 		movq	%fs:40, %rax
 6178      25280000 
 6178      00
 6179 001e 488945F8 		movq	%rax, -8(%rbp)
 6180 0022 31C0     		xorl	%eax, %eax
1959:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     unsigned char w;
1960:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1961:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
1962:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * Minimize the number of multiplications, that is minimize
1963:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * 10 * d * w + 18 * 2^(w-1) + 11 * d + 7 * w, with d = ceil( nbits / w )
1964:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * (see costs of the various parts, with 1S = 1M)
1965:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
1966:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     w = grp->nbits >= 384 ? 5 : 4;
 6181              		.loc 1 1966 12
 6182 0024 488B45E8 		movq	-24(%rbp), %rax
 6183 0028 488B80B8 		movq	184(%rax), %rax
 6183      000000
 6184              		.loc 1 1966 7
 6185 002f 483D7F01 		cmpq	$383, %rax
 6185      0000
 6186 0035 7607     		jbe	.L583
 6187              		.loc 1 1966 7 is_stmt 0 discriminator 1
 6188 0037 B8050000 		movl	$5, %eax
 6188      00
 6189 003c EB05     		jmp	.L584
 6190              	.L583:
 6191              		.loc 1 1966 7 discriminator 2
 6192 003e B8040000 		movl	$4, %eax
 6192      00
 6193              	.L584:
 6194              		.loc 1 1966 7 discriminator 4
 6195 0043 8845F7   		movb	%al, -9(%rbp)
1967:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1968:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
1969:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * If P == G, pre-compute a bit more, since this may be re-used later.
1970:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * Just adding one avoids upping the cost of the first mul too much,
1971:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * and the memory cost too.
1972:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
1973:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( p_eq_g )
 6196              		.loc 1 1973 7 is_stmt 1 discriminator 4
 6197 0046 807DE400 		cmpb	$0, -28(%rbp)
 6198 004a 740A     		je	.L585
1974:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         w++;
 6199              		.loc 1 1974 10
 6200 004c 0FB645F7 		movzbl	-9(%rbp), %eax
 6201 0050 83C001   		addl	$1, %eax
 6202 0053 8845F7   		movb	%al, -9(%rbp)
 6203              	.L585:
1975:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1976:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
1977:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * Make sure w is within bounds.
1978:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * (The last test is useful only for very small curves in the test suite.)
GAS LISTING /tmp/ccajKZL5.s 			page 172


1979:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
1980:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( w > MBEDTLS_ECP_WINDOW_SIZE )
 6204              		.loc 1 1980 7
 6205 0056 807DF706 		cmpb	$6, -9(%rbp)
 6206 005a 7604     		jbe	.L586
1981:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         w = MBEDTLS_ECP_WINDOW_SIZE;
 6207              		.loc 1 1981 11
 6208 005c C645F706 		movb	$6, -9(%rbp)
 6209              	.L586:
1982:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( w >= grp->nbits )
 6210              		.loc 1 1982 11
 6211 0060 0FB655F7 		movzbl	-9(%rbp), %edx
 6212              		.loc 1 1982 17
 6213 0064 488B45E8 		movq	-24(%rbp), %rax
 6214 0068 488B80B8 		movq	184(%rax), %rax
 6214      000000
 6215              		.loc 1 1982 7
 6216 006f 4839C2   		cmpq	%rax, %rdx
 6217 0072 7204     		jb	.L587
1983:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         w = 2;
 6218              		.loc 1 1983 11
 6219 0074 C645F702 		movb	$2, -9(%rbp)
 6220              	.L587:
1984:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1985:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( w );
 6221              		.loc 1 1985 11
 6222 0078 0FB645F7 		movzbl	-9(%rbp), %eax
1986:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 6223              		.loc 1 1986 1
 6224 007c 488B4DF8 		movq	-8(%rbp), %rcx
 6225 0080 6448330C 		xorq	%fs:40, %rcx
 6225      25280000 
 6225      00
 6226 0089 7405     		je	.L589
 6227 008b E8000000 		call	__stack_chk_fail@PLT
 6227      00
 6228              	.L589:
 6229 0090 C9       		leave
 6230              	.LCFI116:
 6231              		.cfi_def_cfa 7, 8
 6232 0091 C3       		ret
 6233              		.cfi_endproc
 6234              	.LFE44:
 6236              		.section	.text.ecp_mul_comb,"ax",@progbits
 6238              	ecp_mul_comb:
 6239              	.LFB45:
1987:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
1988:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
1989:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Multiplication using the comb method - for curves in short Weierstrass form
1990:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1991:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * This function is mainly responsible for administrative work:
1992:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * - managing the restart context if enabled
1993:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * - managing the table of precomputed points (passed between the below two
1994:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *   functions): allocation, computation, ownership tranfer, freeing.
1995:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1996:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * It delegates the actual arithmetic work to:
1997:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *      ecp_precompute_comb() and ecp_mul_comb_with_precomp()
GAS LISTING /tmp/ccajKZL5.s 			page 173


1998:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
1999:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * See comments on ecp_comb_recode_core() regarding the computation strategy.
2000:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
2001:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static int ecp_mul_comb( mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
2002:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                          const mbedtls_mpi *m, const mbedtls_ecp_point *P,
2003:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                          int (*f_rng)(void *, unsigned char *, size_t),
2004:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                          void *p_rng,
2005:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                          mbedtls_ecp_restart_ctx *rs_ctx )
2006:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 6240              		.loc 1 2006 1
 6241              		.cfi_startproc
 6242 0000 F30F1EFA 		endbr64
 6243 0004 55       		pushq	%rbp
 6244              	.LCFI117:
 6245              		.cfi_def_cfa_offset 16
 6246              		.cfi_offset 6, -16
 6247 0005 4889E5   		movq	%rsp, %rbp
 6248              	.LCFI118:
 6249              		.cfi_def_cfa_register 6
 6250 0008 4883EC70 		subq	$112, %rsp
 6251 000c 48897DC8 		movq	%rdi, -56(%rbp)
 6252 0010 488975C0 		movq	%rsi, -64(%rbp)
 6253 0014 488955B8 		movq	%rdx, -72(%rbp)
 6254 0018 48894DB0 		movq	%rcx, -80(%rbp)
 6255 001c 4C8945A8 		movq	%r8, -88(%rbp)
 6256 0020 4C894DA0 		movq	%r9, -96(%rbp)
 6257 0024 488B4510 		movq	16(%rbp), %rax
 6258 0028 48894598 		movq	%rax, -104(%rbp)
 6259              		.loc 1 2006 1
 6260 002c 64488B04 		movq	%fs:40, %rax
 6260      25280000 
 6260      00
 6261 0035 488945F8 		movq	%rax, -8(%rbp)
 6262 0039 31C0     		xorl	%eax, %eax
2007:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
2008:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     unsigned char w, p_eq_g, i;
2009:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     size_t d;
2010:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     unsigned char T_size, T_ok;
2011:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point *T;
2012:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2013:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_RS_ENTER( rsm );
2014:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2015:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Is P the base point ? */
2016:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if MBEDTLS_ECP_FIXED_POINT_OPTIM == 1
2017:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     p_eq_g = ( mbedtls_mpi_cmp_mpi( &P->Y, &grp->G.Y ) == 0 &&
 6263              		.loc 1 2017 44
 6264 003b 488B45C8 		movq	-56(%rbp), %rax
 6265 003f 488D5068 		leaq	104(%rax), %rdx
 6266              		.loc 1 2017 16
 6267 0043 488B45B0 		movq	-80(%rbp), %rax
 6268 0047 4883C018 		addq	$24, %rax
 6269 004b 4889D6   		movq	%rdx, %rsi
 6270 004e 4889C7   		movq	%rax, %rdi
 6271 0051 E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 6271      00
 6272              		.loc 1 2017 61
 6273 0056 85C0     		testl	%eax, %eax
GAS LISTING /tmp/ccajKZL5.s 			page 174


 6274 0058 7522     		jne	.L591
2018:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                mbedtls_mpi_cmp_mpi( &P->X, &grp->G.X ) == 0 );
 6275              		.loc 1 2018 44 discriminator 1
 6276 005a 488B45C8 		movq	-56(%rbp), %rax
 6277 005e 488D5050 		leaq	80(%rax), %rdx
 6278              		.loc 1 2018 16 discriminator 1
 6279 0062 488B45B0 		movq	-80(%rbp), %rax
 6280 0066 4889D6   		movq	%rdx, %rsi
 6281 0069 4889C7   		movq	%rax, %rdi
 6282 006c E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 6282      00
2017:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                mbedtls_mpi_cmp_mpi( &P->X, &grp->G.X ) == 0 );
 6283              		.loc 1 2017 61 discriminator 1
 6284 0071 85C0     		testl	%eax, %eax
 6285 0073 7507     		jne	.L591
2017:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                mbedtls_mpi_cmp_mpi( &P->X, &grp->G.X ) == 0 );
 6286              		.loc 1 2017 61 is_stmt 0 discriminator 3
 6287 0075 B8010000 		movl	$1, %eax
 6287      00
 6288 007a EB05     		jmp	.L592
 6289              	.L591:
2017:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                mbedtls_mpi_cmp_mpi( &P->X, &grp->G.X ) == 0 );
 6290              		.loc 1 2017 61 discriminator 4
 6291 007c B8000000 		movl	$0, %eax
 6291      00
 6292              	.L592:
2017:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                mbedtls_mpi_cmp_mpi( &P->X, &grp->G.X ) == 0 );
 6293              		.loc 1 2017 12 is_stmt 1 discriminator 6
 6294 0081 8845E1   		movb	%al, -31(%rbp)
2019:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #else
2020:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     p_eq_g = 0;
2021:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
2022:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2023:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Pick window size and deduce related sizes */
2024:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     w = ecp_pick_window_size( grp, p_eq_g );
 6295              		.loc 1 2024 9 discriminator 6
 6296 0084 0FB655E1 		movzbl	-31(%rbp), %edx
 6297 0088 488B45C8 		movq	-56(%rbp), %rax
 6298 008c 89D6     		movl	%edx, %esi
 6299 008e 4889C7   		movq	%rax, %rdi
 6300 0091 E8000000 		call	ecp_pick_window_size
 6300      00
 6301 0096 8845E2   		movb	%al, -30(%rbp)
2025:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     T_size = 1U << ( w - 1 );
 6302              		.loc 1 2025 24 discriminator 6
 6303 0099 0FB645E2 		movzbl	-30(%rbp), %eax
 6304 009d 83E801   		subl	$1, %eax
 6305              		.loc 1 2025 17 discriminator 6
 6306 00a0 BA010000 		movl	$1, %edx
 6306      00
 6307 00a5 89C1     		movl	%eax, %ecx
 6308 00a7 D3E2     		sall	%cl, %edx
 6309 00a9 89D0     		movl	%edx, %eax
 6310              		.loc 1 2025 12 discriminator 6
 6311 00ab 8845E3   		movb	%al, -29(%rbp)
2026:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     d = ( grp->nbits + w - 1 ) / w;
 6312              		.loc 1 2026 14 discriminator 6
GAS LISTING /tmp/ccajKZL5.s 			page 175


 6313 00ae 488B45C8 		movq	-56(%rbp), %rax
 6314 00b2 488B90B8 		movq	184(%rax), %rdx
 6314      000000
 6315              		.loc 1 2026 22 discriminator 6
 6316 00b9 0FB645E2 		movzbl	-30(%rbp), %eax
 6317 00bd 4801D0   		addq	%rdx, %rax
 6318              		.loc 1 2026 26 discriminator 6
 6319 00c0 4883E801 		subq	$1, %rax
 6320              		.loc 1 2026 32 discriminator 6
 6321 00c4 0FB64DE2 		movzbl	-30(%rbp), %ecx
 6322              		.loc 1 2026 7 discriminator 6
 6323 00c8 BA000000 		movl	$0, %edx
 6323      00
 6324 00cd 48F7F1   		divq	%rcx
 6325 00d0 488945F0 		movq	%rax, -16(%rbp)
2027:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2028:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Pre-computed table: do we have it already for the base point? */
2029:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( p_eq_g && grp->T != NULL )
 6326              		.loc 1 2029 7 discriminator 6
 6327 00d4 807DE100 		cmpb	$0, -31(%rbp)
 6328 00d8 7425     		je	.L593
 6329              		.loc 1 2029 22 discriminator 1
 6330 00da 488B45C8 		movq	-56(%rbp), %rax
 6331 00de 488B80E8 		movq	232(%rax), %rax
 6331      000000
 6332              		.loc 1 2029 16 discriminator 1
 6333 00e5 4885C0   		testq	%rax, %rax
 6334 00e8 7415     		je	.L593
2030:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
2031:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* second pointer to the same table, will be deleted on exit */
2032:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         T = grp->T;
 6335              		.loc 1 2032 11
 6336 00ea 488B45C8 		movq	-56(%rbp), %rax
 6337 00ee 488B80E8 		movq	232(%rax), %rax
 6337      000000
 6338 00f5 488945E8 		movq	%rax, -24(%rbp)
2033:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         T_ok = 1;
 6339              		.loc 1 2033 14
 6340 00f9 C645E001 		movb	$1, -32(%rbp)
 6341 00fd EB69     		jmp	.L594
 6342              	.L593:
2034:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
2035:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     else
2036:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
2037:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Pre-computed table: do we have one in progress? complete? */
2038:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && rs_ctx->rsm != NULL && rs_ctx->rsm->T != NULL )
2039:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
2040:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* transfer ownership of T from rsm to local function */
2041:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         T = rs_ctx->rsm->T;
2042:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->rsm->T = NULL;
2043:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->rsm->T_size = 0;
2044:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2045:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* This effectively jumps to the call to mul_comb_after_precomp() */
2046:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         T_ok = rs_ctx->rsm->state >= ecp_rsm_comb_core;
2047:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
2048:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     else
2049:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
GAS LISTING /tmp/ccajKZL5.s 			page 176


2050:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Allocate table if we didn't have any */
2051:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
2052:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         T = mbedtls_calloc( T_size, sizeof( mbedtls_ecp_point ) );
 6343              		.loc 1 2052 13
 6344 00ff 0FB645E3 		movzbl	-29(%rbp), %eax
 6345 0103 BE480000 		movl	$72, %esi
 6345      00
 6346 0108 4889C7   		movq	%rax, %rdi
 6347 010b E8000000 		call	mbedtls_calloc@PLT
 6347      00
 6348 0110 488945E8 		movq	%rax, -24(%rbp)
2053:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( T == NULL )
 6349              		.loc 1 2053 11
 6350 0114 48837DE8 		cmpq	$0, -24(%rbp)
 6350      00
 6351 0119 750C     		jne	.L595
2054:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         {
2055:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             ret = MBEDTLS_ERR_ECP_ALLOC_FAILED;
 6352              		.loc 1 2055 17
 6353 011b C745E480 		movl	$-19840, -28(%rbp)
 6353      B2FFFF
2056:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             goto cleanup;
 6354              		.loc 1 2056 13
 6355 0122 E9DB0000 		jmp	.L596
 6355      00
 6356              	.L595:
2057:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         }
2058:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2059:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         for( i = 0; i < T_size; i++ )
 6357              		.loc 1 2059 16
 6358 0127 C645DF00 		movb	$0, -33(%rbp)
 6359              		.loc 1 2059 9
 6360 012b EB2E     		jmp	.L597
 6361              	.L598:
2060:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             mbedtls_ecp_point_init( &T[i] );
 6362              		.loc 1 2060 39 discriminator 3
 6363 012d 0FB655DF 		movzbl	-33(%rbp), %edx
 6364 0131 4889D0   		movq	%rdx, %rax
 6365 0134 48C1E003 		salq	$3, %rax
 6366 0138 4801D0   		addq	%rdx, %rax
 6367 013b 48C1E003 		salq	$3, %rax
 6368 013f 4889C2   		movq	%rax, %rdx
 6369              		.loc 1 2060 13 discriminator 3
 6370 0142 488B45E8 		movq	-24(%rbp), %rax
 6371 0146 4801D0   		addq	%rdx, %rax
 6372 0149 4889C7   		movq	%rax, %rdi
 6373 014c E8000000 		call	mbedtls_ecp_point_init
 6373      00
2059:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             mbedtls_ecp_point_init( &T[i] );
 6374              		.loc 1 2059 34 discriminator 3
 6375 0151 0FB645DF 		movzbl	-33(%rbp), %eax
 6376 0155 83C001   		addl	$1, %eax
 6377 0158 8845DF   		movb	%al, -33(%rbp)
 6378              	.L597:
2059:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             mbedtls_ecp_point_init( &T[i] );
 6379              		.loc 1 2059 9 discriminator 1
 6380 015b 0FB645DF 		movzbl	-33(%rbp), %eax
GAS LISTING /tmp/ccajKZL5.s 			page 177


 6381 015f 3A45E3   		cmpb	-29(%rbp), %al
 6382 0162 72C9     		jb	.L598
2061:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2062:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         T_ok = 0;
 6383              		.loc 1 2062 14
 6384 0164 C645E000 		movb	$0, -32(%rbp)
 6385              	.L594:
2063:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
2064:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2065:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Compute table (or finish computing it) if not done already */
2066:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( !T_ok )
 6386              		.loc 1 2066 7
 6387 0168 807DE000 		cmpb	$0, -32(%rbp)
 6388 016c 7553     		jne	.L599
2067:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
2068:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( ecp_precompute_comb( grp, T, P, w, d, rs_ctx ) );
 6389              		.loc 1 2068 9
 6390 016e 0FB64DE2 		movzbl	-30(%rbp), %ecx
 6391 0172 4C8B4598 		movq	-104(%rbp), %r8
 6392 0176 488B7DF0 		movq	-16(%rbp), %rdi
 6393 017a 488B55B0 		movq	-80(%rbp), %rdx
 6394 017e 488B75E8 		movq	-24(%rbp), %rsi
 6395 0182 488B45C8 		movq	-56(%rbp), %rax
 6396 0186 4D89C1   		movq	%r8, %r9
 6397 0189 4989F8   		movq	%rdi, %r8
 6398 018c 4889C7   		movq	%rax, %rdi
 6399 018f E8000000 		call	ecp_precompute_comb
 6399      00
 6400 0194 8945E4   		movl	%eax, -28(%rbp)
 6401 0197 837DE400 		cmpl	$0, -28(%rbp)
 6402 019b 7564     		jne	.L608
2069:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2070:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( p_eq_g )
 6403              		.loc 1 2070 11
 6404 019d 807DE100 		cmpb	$0, -31(%rbp)
 6405 01a1 741E     		je	.L599
2071:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         {
2072:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             /* almost transfer ownership of T to the group, but keep a copy of
2073:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              * the pointer to use for calling the next function more easily */
2074:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             grp->T = T;
 6406              		.loc 1 2074 20
 6407 01a3 488B45C8 		movq	-56(%rbp), %rax
 6408 01a7 488B55E8 		movq	-24(%rbp), %rdx
 6409 01ab 488990E8 		movq	%rdx, 232(%rax)
 6409      000000
2075:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             grp->T_size = T_size;
 6410              		.loc 1 2075 25
 6411 01b2 0FB655E3 		movzbl	-29(%rbp), %edx
 6412 01b6 488B45C8 		movq	-56(%rbp), %rax
 6413 01ba 488990F0 		movq	%rdx, 240(%rax)
 6413      000000
 6414              	.L599:
2076:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         }
2077:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
2078:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2079:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Actual comb multiplication using precomputed points */
2080:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( ecp_mul_comb_after_precomp( grp, R, m,
GAS LISTING /tmp/ccajKZL5.s 			page 178


 6415              		.loc 1 2080 5
 6416 01c1 440FB645 		movzbl	-30(%rbp), %r8d
 6416      E2
 6417 01c6 0FB67DE3 		movzbl	-29(%rbp), %edi
 6418 01ca 488B4DE8 		movq	-24(%rbp), %rcx
 6419 01ce 488B55B8 		movq	-72(%rbp), %rdx
 6420 01d2 488B75C0 		movq	-64(%rbp), %rsi
 6421 01d6 488B45C8 		movq	-56(%rbp), %rax
 6422 01da FF7598   		pushq	-104(%rbp)
 6423 01dd FF75A0   		pushq	-96(%rbp)
 6424 01e0 FF75A8   		pushq	-88(%rbp)
 6425 01e3 FF75F0   		pushq	-16(%rbp)
 6426 01e6 4589C1   		movl	%r8d, %r9d
 6427 01e9 4189F8   		movl	%edi, %r8d
 6428 01ec 4889C7   		movq	%rax, %rdi
 6429 01ef E8000000 		call	ecp_mul_comb_after_precomp
 6429      00
 6430 01f4 4883C420 		addq	$32, %rsp
 6431 01f8 8945E4   		movl	%eax, -28(%rbp)
 6432 01fb 837DE400 		cmpl	$0, -28(%rbp)
2081:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                                  T, T_size, w, d,
2082:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                                  f_rng, p_rng, rs_ctx ) );
2083:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2084:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
 6433              		.loc 1 2084 1
 6434 01ff EB01     		jmp	.L596
 6435              	.L608:
2068:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 6436              		.loc 1 2068 9
 6437 0201 90       		nop
 6438              	.L596:
2085:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2086:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* does T belong to the group? */
2087:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( T == grp->T )
 6439              		.loc 1 2087 17
 6440 0202 488B45C8 		movq	-56(%rbp), %rax
 6441 0206 488B80E8 		movq	232(%rax), %rax
 6441      000000
 6442              		.loc 1 2087 7
 6443 020d 483945E8 		cmpq	%rax, -24(%rbp)
 6444 0211 7508     		jne	.L601
2088:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         T = NULL;
 6445              		.loc 1 2088 11
 6446 0213 48C745E8 		movq	$0, -24(%rbp)
 6446      00000000 
 6447              	.L601:
2089:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2090:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* does T belong to the restart context? */
2091:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
2092:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && rs_ctx->rsm != NULL && ret == MBEDTLS_ERR_ECP_IN_PROGRESS && T != NULL )
2093:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
2094:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* transfer ownership of T from local function to rsm */
2095:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->rsm->T_size = T_size;
2096:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->rsm->T = T;
2097:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         T = NULL;
2098:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
2099:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
GAS LISTING /tmp/ccajKZL5.s 			page 179


2100:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2101:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* did T belong to us? then let's destroy it! */
2102:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( T != NULL )
 6448              		.loc 1 2102 7
 6449 021b 48837DE8 		cmpq	$0, -24(%rbp)
 6449      00
 6450 0220 7449     		je	.L602
2103:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
2104:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         for( i = 0; i < T_size; i++ )
 6451              		.loc 1 2104 16
 6452 0222 C645DF00 		movb	$0, -33(%rbp)
 6453              		.loc 1 2104 9
 6454 0226 EB2E     		jmp	.L603
 6455              	.L604:
2105:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             mbedtls_ecp_point_free( &T[i] );
 6456              		.loc 1 2105 39 discriminator 3
 6457 0228 0FB655DF 		movzbl	-33(%rbp), %edx
 6458 022c 4889D0   		movq	%rdx, %rax
 6459 022f 48C1E003 		salq	$3, %rax
 6460 0233 4801D0   		addq	%rdx, %rax
 6461 0236 48C1E003 		salq	$3, %rax
 6462 023a 4889C2   		movq	%rax, %rdx
 6463              		.loc 1 2105 13 discriminator 3
 6464 023d 488B45E8 		movq	-24(%rbp), %rax
 6465 0241 4801D0   		addq	%rdx, %rax
 6466 0244 4889C7   		movq	%rax, %rdi
 6467 0247 E8000000 		call	mbedtls_ecp_point_free
 6467      00
2104:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             mbedtls_ecp_point_free( &T[i] );
 6468              		.loc 1 2104 34 discriminator 3
 6469 024c 0FB645DF 		movzbl	-33(%rbp), %eax
 6470 0250 83C001   		addl	$1, %eax
 6471 0253 8845DF   		movb	%al, -33(%rbp)
 6472              	.L603:
2104:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             mbedtls_ecp_point_free( &T[i] );
 6473              		.loc 1 2104 9 discriminator 1
 6474 0256 0FB645DF 		movzbl	-33(%rbp), %eax
 6475 025a 3A45E3   		cmpb	-29(%rbp), %al
 6476 025d 72C9     		jb	.L604
2106:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_free( T );
 6477              		.loc 1 2106 9
 6478 025f 488B45E8 		movq	-24(%rbp), %rax
 6479 0263 4889C7   		movq	%rax, %rdi
 6480 0266 E8000000 		call	mbedtls_free@PLT
 6480      00
 6481              	.L602:
2107:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
2108:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2109:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* don't free R while in progress in case R == P */
2110:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
2111:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ret != MBEDTLS_ERR_ECP_IN_PROGRESS )
2112:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
2113:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* prevent caller from using invalid value */
2114:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ret != 0 )
 6482              		.loc 1 2114 7
 6483 026b 837DE400 		cmpl	$0, -28(%rbp)
 6484 026f 740C     		je	.L605
GAS LISTING /tmp/ccajKZL5.s 			page 180


2115:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_ecp_point_free( R );
 6485              		.loc 1 2115 9
 6486 0271 488B45C0 		movq	-64(%rbp), %rax
 6487 0275 4889C7   		movq	%rax, %rdi
 6488 0278 E8000000 		call	mbedtls_ecp_point_free
 6488      00
 6489              	.L605:
2116:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2117:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_RS_LEAVE( rsm );
2118:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2119:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 6490              		.loc 1 2119 11
 6491 027d 8B45E4   		movl	-28(%rbp), %eax
2120:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 6492              		.loc 1 2120 1
 6493 0280 488B4DF8 		movq	-8(%rbp), %rcx
 6494 0284 6448330C 		xorq	%fs:40, %rcx
 6494      25280000 
 6494      00
 6495 028d 7405     		je	.L607
 6496 028f E8000000 		call	__stack_chk_fail@PLT
 6496      00
 6497              	.L607:
 6498 0294 C9       		leave
 6499              	.LCFI119:
 6500              		.cfi_def_cfa 7, 8
 6501 0295 C3       		ret
 6502              		.cfi_endproc
 6503              	.LFE45:
 6505              		.section	.text.mbedtls_ecp_mul_restartable,"ax",@progbits
 6506              		.globl	mbedtls_ecp_mul_restartable
 6508              	mbedtls_ecp_mul_restartable:
 6509              	.LFB46:
2121:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2122:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif /* ECP_SHORTWEIERSTRASS */
2123:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2124:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(ECP_MONTGOMERY)
2125:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
2126:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * For Montgomery curves, we do all the internal arithmetic in projective
2127:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * coordinates. Import/export of points uses only the x coordinates, which is
2128:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * internaly represented as X / Z.
2129:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
2130:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * For scalar multiplication, we'll use a Montgomery ladder.
2131:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
2132:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2133:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
2134:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Normalize Montgomery x/z coordinates: X = X/Z, Z = 1
2135:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Cost: 1M + 1I
2136:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
2137:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static int ecp_normalize_mxz( const mbedtls_ecp_group *grp, mbedtls_ecp_point *P )
2138:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
2139:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
2140:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2141:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_NORMALIZE_MXZ_ALT)
2142:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( mbedtls_internal_ecp_grp_capable( grp ) )
2143:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( mbedtls_internal_ecp_normalize_mxz( grp, P ) );
2144:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif /* MBEDTLS_ECP_NORMALIZE_MXZ_ALT */
GAS LISTING /tmp/ccajKZL5.s 			page 181


2145:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2146:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_inv_mod( &P->Z, &P->Z, &grp->P ) );
2147:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &P->X, &P->X, &P->Z ) ); MOD_MUL( P->X );
2148:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_lset( &P->Z, 1 ) );
2149:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2150:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
2151:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
2152:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
2153:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2154:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
2155:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Randomize projective x/z coordinates:
2156:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * (X, Z) -> (l X, l Z) for random l
2157:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * This is sort of the reverse operation of ecp_normalize_mxz().
2158:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
2159:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * This countermeasure was first suggested in [2].
2160:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Cost: 2M
2161:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
2162:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static int ecp_randomize_mxz( const mbedtls_ecp_group *grp, mbedtls_ecp_point *P,
2163:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                 int (*f_rng)(void *, unsigned char *, size_t), void *p_rng )
2164:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
2165:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
2166:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi l;
2167:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     size_t p_size;
2168:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int count = 0;
2169:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2170:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RANDOMIZE_MXZ_ALT)
2171:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( mbedtls_internal_ecp_grp_capable( grp ) )
2172:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( mbedtls_internal_ecp_randomize_mxz( grp, P, f_rng, p_rng );
2173:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif /* MBEDTLS_ECP_RANDOMIZE_MXZ_ALT */
2174:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2175:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     p_size = ( grp->pbits + 7 ) / 8;
2176:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_init( &l );
2177:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2178:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Generate l such that 1 < l < p */
2179:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     do
2180:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
2181:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_fill_random( &l, p_size, f_rng, p_rng ) );
2182:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2183:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         while( mbedtls_mpi_cmp_mpi( &l, &grp->P ) >= 0 )
2184:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_shift_r( &l, 1 ) );
2185:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2186:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( count++ > 10 )
2187:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             return( MBEDTLS_ERR_ECP_RANDOM_FAILED );
2188:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
2189:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     while( mbedtls_mpi_cmp_int( &l, 1 ) <= 0 );
2190:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2191:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &P->X, &P->X, &l ) ); MOD_MUL( P->X );
2192:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &P->Z, &P->Z, &l ) ); MOD_MUL( P->Z );
2193:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2194:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
2195:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_free( &l );
2196:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2197:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
2198:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
2199:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2200:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
2201:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Double-and-add: R = 2P, S = P + Q, with d = X(P - Q),
GAS LISTING /tmp/ccajKZL5.s 			page 182


2202:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * for Montgomery curves in x/z coordinates.
2203:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
2204:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * http://www.hyperelliptic.org/EFD/g1p/auto-code/montgom/xz/ladder/mladd-1987-m.op3
2205:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * with
2206:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * d =  X1
2207:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * P = (X2, Z2)
2208:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Q = (X3, Z3)
2209:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * R = (X4, Z4)
2210:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * S = (X5, Z5)
2211:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * and eliminating temporary variables tO, ..., t4.
2212:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  *
2213:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Cost: 5M + 4S
2214:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
2215:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static int ecp_double_add_mxz( const mbedtls_ecp_group *grp,
2216:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                mbedtls_ecp_point *R, mbedtls_ecp_point *S,
2217:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                const mbedtls_ecp_point *P, const mbedtls_ecp_point *Q,
2218:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                const mbedtls_mpi *d )
2219:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
2220:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
2221:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi A, AA, B, BB, E, C, D, DA, CB;
2222:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2223:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_DOUBLE_ADD_MXZ_ALT)
2224:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( mbedtls_internal_ecp_grp_capable( grp ) )
2225:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( mbedtls_internal_ecp_double_add_mxz( grp, R, S, P, Q, d ) );
2226:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif /* MBEDTLS_ECP_DOUBLE_ADD_MXZ_ALT */
2227:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2228:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_init( &A ); mbedtls_mpi_init( &AA ); mbedtls_mpi_init( &B );
2229:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_init( &BB ); mbedtls_mpi_init( &E ); mbedtls_mpi_init( &C );
2230:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_init( &D ); mbedtls_mpi_init( &DA ); mbedtls_mpi_init( &CB );
2231:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2232:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( &A,    &P->X,   &P->Z ) ); MOD_ADD( A    );
2233:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &AA,   &A,      &A    ) ); MOD_MUL( AA   );
2234:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &B,    &P->X,   &P->Z ) ); MOD_SUB( B    );
2235:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &BB,   &B,      &B    ) ); MOD_MUL( BB   );
2236:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &E,    &AA,     &BB   ) ); MOD_SUB( E    );
2237:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( &C,    &Q->X,   &Q->Z ) ); MOD_ADD( C    );
2238:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &D,    &Q->X,   &Q->Z ) ); MOD_SUB( D    );
2239:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &DA,   &D,      &A    ) ); MOD_MUL( DA   );
2240:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &CB,   &C,      &B    ) ); MOD_MUL( CB   );
2241:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( &S->X, &DA,     &CB   ) ); MOD_MUL( S->X );
2242:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &S->X, &S->X,   &S->X ) ); MOD_MUL( S->X );
2243:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &S->Z, &DA,     &CB   ) ); MOD_SUB( S->Z );
2244:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &S->Z, &S->Z,   &S->Z ) ); MOD_MUL( S->Z );
2245:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &S->Z, d,       &S->Z ) ); MOD_MUL( S->Z );
2246:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &R->X, &AA,     &BB   ) ); MOD_MUL( R->X );
2247:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &R->Z, &grp->A, &E    ) ); MOD_MUL( R->Z );
2248:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( &R->Z, &BB,     &R->Z ) ); MOD_ADD( R->Z );
2249:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &R->Z, &E,      &R->Z ) ); MOD_MUL( R->Z );
2250:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2251:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
2252:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_free( &A ); mbedtls_mpi_free( &AA ); mbedtls_mpi_free( &B );
2253:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_free( &BB ); mbedtls_mpi_free( &E ); mbedtls_mpi_free( &C );
2254:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_free( &D ); mbedtls_mpi_free( &DA ); mbedtls_mpi_free( &CB );
2255:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2256:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
2257:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
2258:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
GAS LISTING /tmp/ccajKZL5.s 			page 183


2259:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
2260:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Multiplication with Montgomery ladder in x/z coordinates,
2261:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * for curves in Montgomery form
2262:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
2263:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static int ecp_mul_mxz( mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
2264:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                         const mbedtls_mpi *m, const mbedtls_ecp_point *P,
2265:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                         int (*f_rng)(void *, unsigned char *, size_t),
2266:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                         void *p_rng )
2267:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
2268:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
2269:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     size_t i;
2270:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     unsigned char b;
2271:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point RP;
2272:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi PX;
2273:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2274:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point_init( &RP ); mbedtls_mpi_init( &PX );
2275:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2276:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Save PX and read from P before writing to R, in case P == R */
2277:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_copy( &PX, &P->X ) );
2278:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_ecp_copy( &RP, P ) );
2279:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2280:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Set R to zero in modified x/z coordinates */
2281:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_lset( &R->X, 1 ) );
2282:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_lset( &R->Z, 0 ) );
2283:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_free( &R->Y );
2284:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2285:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* RP.X might be sligtly larger than P, so reduce it */
2286:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MOD_ADD( RP.X );
2287:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2288:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Randomize coordinates of the starting point */
2289:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( f_rng != NULL )
2290:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( ecp_randomize_mxz( grp, &RP, f_rng, p_rng ) );
2291:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2292:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Loop invariant: R = result so far, RP = R + P */
2293:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     i = mbedtls_mpi_bitlen( m ); /* one past the (zero-based) most significant bit */
2294:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     while( i-- > 0 )
2295:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
2296:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         b = mbedtls_mpi_get_bit( m, i );
2297:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /*
2298:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          *  if (b) R = 2R + P else R = 2R,
2299:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          * which is:
2300:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          *  if (b) double_add( RP, R, RP, R )
2301:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          *  else   double_add( R, RP, R, RP )
2302:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          * but using safe conditional swaps to avoid leaks
2303:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          */
2304:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_safe_cond_swap( &R->X, &RP.X, b ) );
2305:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_safe_cond_swap( &R->Z, &RP.Z, b ) );
2306:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( ecp_double_add_mxz( grp, R, &RP, R, &RP, &PX ) );
2307:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_safe_cond_swap( &R->X, &RP.X, b ) );
2308:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_safe_cond_swap( &R->Z, &RP.Z, b ) );
2309:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
2310:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2311:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( ecp_normalize_mxz( grp, R ) );
2312:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2313:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
2314:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point_free( &RP ); mbedtls_mpi_free( &PX );
2315:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
GAS LISTING /tmp/ccajKZL5.s 			page 184


2316:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
2317:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
2318:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2319:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif /* ECP_MONTGOMERY */
2320:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2321:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
2322:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Restartable multiplication R = m * P
2323:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
2324:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_mul_restartable( mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
2325:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              const mbedtls_mpi *m, const mbedtls_ecp_point *P,
2326:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              int (*f_rng)(void *, unsigned char *, size_t), void *p_rng,
2327:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              mbedtls_ecp_restart_ctx *rs_ctx )
2328:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 6510              		.loc 1 2328 1
 6511              		.cfi_startproc
 6512 0000 F30F1EFA 		endbr64
 6513 0004 55       		pushq	%rbp
 6514              	.LCFI120:
 6515              		.cfi_def_cfa_offset 16
 6516              		.cfi_offset 6, -16
 6517 0005 4889E5   		movq	%rsp, %rbp
 6518              	.LCFI121:
 6519              		.cfi_def_cfa_register 6
 6520 0008 4883EC50 		subq	$80, %rsp
 6521 000c 48897DE8 		movq	%rdi, -24(%rbp)
 6522 0010 488975E0 		movq	%rsi, -32(%rbp)
 6523 0014 488955D8 		movq	%rdx, -40(%rbp)
 6524 0018 48894DD0 		movq	%rcx, -48(%rbp)
 6525 001c 4C8945C8 		movq	%r8, -56(%rbp)
 6526 0020 4C894DC0 		movq	%r9, -64(%rbp)
 6527 0024 488B4510 		movq	16(%rbp), %rax
 6528 0028 488945B8 		movq	%rax, -72(%rbp)
 6529              		.loc 1 2328 1
 6530 002c 64488B04 		movq	%fs:40, %rax
 6530      25280000 
 6530      00
 6531 0035 488945F8 		movq	%rax, -8(%rbp)
 6532 0039 31C0     		xorl	%eax, %eax
2329:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret = MBEDTLS_ERR_ECP_BAD_INPUT_DATA;
 6533              		.loc 1 2329 9
 6534 003b C745F480 		movl	$-20352, -12(%rbp)
 6534      B0FFFF
2330:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_INTERNAL_ALT)
2331:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     char is_grp_capable = 0;
2332:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
2333:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( grp != NULL );
2334:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( R   != NULL );
2335:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( m   != NULL );
2336:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( P   != NULL );
2337:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2338:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
2339:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* reset ops count for this call if top-level */
2340:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && rs_ctx->depth++ == 0 )
2341:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->ops_done = 0;
2342:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
2343:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2344:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_INTERNAL_ALT)
GAS LISTING /tmp/ccajKZL5.s 			page 185


2345:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ( is_grp_capable = mbedtls_internal_ecp_grp_capable( grp ) ) )
2346:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_internal_ecp_init( grp ) );
2347:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif /* MBEDTLS_ECP_INTERNAL_ALT */
2348:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2349:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
2350:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* skip argument check when restarting */
2351:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx == NULL || rs_ctx->rsm == NULL )
2352:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
2353:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
2354:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* check_privkey is free */
2355:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_ECP_BUDGET( MBEDTLS_ECP_OPS_CHK );
2356:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2357:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* Common sanity checks */
2358:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_ecp_check_privkey( grp, m ) );
 6535              		.loc 1 2358 9
 6536 0042 488B55D8 		movq	-40(%rbp), %rdx
 6537 0046 488B45E8 		movq	-24(%rbp), %rax
 6538 004a 4889D6   		movq	%rdx, %rsi
 6539 004d 4889C7   		movq	%rax, %rdi
 6540 0050 E8000000 		call	mbedtls_ecp_check_privkey
 6540      00
 6541 0055 8945F4   		movl	%eax, -12(%rbp)
 6542 0058 837DF400 		cmpl	$0, -12(%rbp)
 6543 005c 756E     		jne	.L615
2359:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_ecp_check_pubkey( grp, P ) );
 6544              		.loc 1 2359 9
 6545 005e 488B55D0 		movq	-48(%rbp), %rdx
 6546 0062 488B45E8 		movq	-24(%rbp), %rax
 6547 0066 4889D6   		movq	%rdx, %rsi
 6548 0069 4889C7   		movq	%rax, %rdi
 6549 006c E8000000 		call	mbedtls_ecp_check_pubkey
 6549      00
 6550 0071 8945F4   		movl	%eax, -12(%rbp)
 6551 0074 837DF400 		cmpl	$0, -12(%rbp)
 6552 0078 7555     		jne	.L616
2360:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
2361:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2362:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ret = MBEDTLS_ERR_ECP_BAD_INPUT_DATA;
 6553              		.loc 1 2362 9
 6554 007a C745F480 		movl	$-20352, -12(%rbp)
 6554      B0FFFF
2363:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(ECP_MONTGOMERY)
2364:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ecp_get_type( grp ) == ECP_TYPE_MONTGOMERY )
2365:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( ecp_mul_mxz( grp, R, m, P, f_rng, p_rng ) );
2366:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
2367:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(ECP_SHORTWEIERSTRASS)
2368:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ecp_get_type( grp ) == ECP_TYPE_SHORT_WEIERSTRASS )
 6555              		.loc 1 2368 9
 6556 0081 488B45E8 		movq	-24(%rbp), %rax
 6557 0085 4889C7   		movq	%rax, %rdi
 6558 0088 E8000000 		call	ecp_get_type
 6558      00
 6559              		.loc 1 2368 7
 6560 008d 83F801   		cmpl	$1, %eax
 6561 0090 7540     		jne	.L617
2369:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( ecp_mul_comb( grp, R, m, P, f_rng, p_rng, rs_ctx ) );
 6562              		.loc 1 2369 9
GAS LISTING /tmp/ccajKZL5.s 			page 186


 6563 0092 4C8B45C0 		movq	-64(%rbp), %r8
 6564 0096 488B7DC8 		movq	-56(%rbp), %rdi
 6565 009a 488B4DD0 		movq	-48(%rbp), %rcx
 6566 009e 488B55D8 		movq	-40(%rbp), %rdx
 6567 00a2 488B75E0 		movq	-32(%rbp), %rsi
 6568 00a6 488B45E8 		movq	-24(%rbp), %rax
 6569 00aa 4883EC08 		subq	$8, %rsp
 6570 00ae FF75B8   		pushq	-72(%rbp)
 6571 00b1 4D89C1   		movq	%r8, %r9
 6572 00b4 4989F8   		movq	%rdi, %r8
 6573 00b7 4889C7   		movq	%rax, %rdi
 6574 00ba E8000000 		call	ecp_mul_comb
 6574      00
 6575 00bf 4883C410 		addq	$16, %rsp
 6576 00c3 8945F4   		movl	%eax, -12(%rbp)
 6577 00c6 837DF400 		cmpl	$0, -12(%rbp)
2370:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
2371:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2372:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
 6578              		.loc 1 2372 1
 6579 00ca EB06     		jmp	.L617
 6580              	.L615:
2358:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_ecp_check_pubkey( grp, P ) );
 6581              		.loc 1 2358 9
 6582 00cc 90       		nop
 6583 00cd EB04     		jmp	.L611
 6584              	.L616:
2359:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 6585              		.loc 1 2359 9
 6586 00cf 90       		nop
 6587 00d0 EB01     		jmp	.L611
 6588              	.L617:
 6589              		.loc 1 2372 1
 6590 00d2 90       		nop
 6591              	.L611:
2373:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2374:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_INTERNAL_ALT)
2375:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( is_grp_capable )
2376:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_internal_ecp_free( grp );
2377:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif /* MBEDTLS_ECP_INTERNAL_ALT */
2378:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2379:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
2380:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL )
2381:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->depth--;
2382:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
2383:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2384:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 6592              		.loc 1 2384 11
 6593 00d3 8B45F4   		movl	-12(%rbp), %eax
2385:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 6594              		.loc 1 2385 1
 6595 00d6 488B4DF8 		movq	-8(%rbp), %rcx
 6596 00da 6448330C 		xorq	%fs:40, %rcx
 6596      25280000 
 6596      00
 6597 00e3 7405     		je	.L614
 6598 00e5 E8000000 		call	__stack_chk_fail@PLT
GAS LISTING /tmp/ccajKZL5.s 			page 187


 6598      00
 6599              	.L614:
 6600 00ea C9       		leave
 6601              	.LCFI122:
 6602              		.cfi_def_cfa 7, 8
 6603 00eb C3       		ret
 6604              		.cfi_endproc
 6605              	.LFE46:
 6607              		.section	.text.mbedtls_ecp_mul,"ax",@progbits
 6608              		.globl	mbedtls_ecp_mul
 6610              	mbedtls_ecp_mul:
 6611              	.LFB47:
2386:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2387:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
2388:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Multiplication R = m * P
2389:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
2390:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_mul( mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
2391:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              const mbedtls_mpi *m, const mbedtls_ecp_point *P,
2392:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              int (*f_rng)(void *, unsigned char *, size_t), void *p_rng )
2393:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 6612              		.loc 1 2393 1
 6613              		.cfi_startproc
 6614 0000 F30F1EFA 		endbr64
 6615 0004 55       		pushq	%rbp
 6616              	.LCFI123:
 6617              		.cfi_def_cfa_offset 16
 6618              		.cfi_offset 6, -16
 6619 0005 4889E5   		movq	%rsp, %rbp
 6620              	.LCFI124:
 6621              		.cfi_def_cfa_register 6
 6622 0008 4883EC40 		subq	$64, %rsp
 6623 000c 48897DE8 		movq	%rdi, -24(%rbp)
 6624 0010 488975E0 		movq	%rsi, -32(%rbp)
 6625 0014 488955D8 		movq	%rdx, -40(%rbp)
 6626 0018 48894DD0 		movq	%rcx, -48(%rbp)
 6627 001c 4C8945C8 		movq	%r8, -56(%rbp)
 6628 0020 4C894DC0 		movq	%r9, -64(%rbp)
 6629              		.loc 1 2393 1
 6630 0024 64488B04 		movq	%fs:40, %rax
 6630      25280000 
 6630      00
 6631 002d 488945F8 		movq	%rax, -8(%rbp)
 6632 0031 31C0     		xorl	%eax, %eax
2394:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( grp != NULL );
2395:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( R   != NULL );
2396:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( m   != NULL );
2397:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( P   != NULL );
2398:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( mbedtls_ecp_mul_restartable( grp, R, m, P, f_rng, p_rng, NULL ) );
 6633              		.loc 1 2398 13
 6634 0033 4C8B45C0 		movq	-64(%rbp), %r8
 6635 0037 488B7DC8 		movq	-56(%rbp), %rdi
 6636 003b 488B4DD0 		movq	-48(%rbp), %rcx
 6637 003f 488B55D8 		movq	-40(%rbp), %rdx
 6638 0043 488B75E0 		movq	-32(%rbp), %rsi
 6639 0047 488B45E8 		movq	-24(%rbp), %rax
 6640 004b 4883EC08 		subq	$8, %rsp
 6641 004f 6A00     		pushq	$0
GAS LISTING /tmp/ccajKZL5.s 			page 188


 6642 0051 4D89C1   		movq	%r8, %r9
 6643 0054 4989F8   		movq	%rdi, %r8
 6644 0057 4889C7   		movq	%rax, %rdi
 6645 005a E8000000 		call	mbedtls_ecp_mul_restartable
 6645      00
 6646 005f 4883C410 		addq	$16, %rsp
2399:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 6647              		.loc 1 2399 1
 6648 0063 488B55F8 		movq	-8(%rbp), %rdx
 6649 0067 64483314 		xorq	%fs:40, %rdx
 6649      25280000 
 6649      00
 6650 0070 7405     		je	.L620
 6651 0072 E8000000 		call	__stack_chk_fail@PLT
 6651      00
 6652              	.L620:
 6653 0077 C9       		leave
 6654              	.LCFI125:
 6655              		.cfi_def_cfa 7, 8
 6656 0078 C3       		ret
 6657              		.cfi_endproc
 6658              	.LFE47:
 6660              		.section	.text.ecp_check_pubkey_sw,"ax",@progbits
 6662              	ecp_check_pubkey_sw:
 6663              	.LFB48:
2400:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2401:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(ECP_SHORTWEIERSTRASS)
2402:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
2403:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Check that an affine point is valid as a public key,
2404:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * short weierstrass curves (SEC1 3.2.3.1)
2405:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
2406:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static int ecp_check_pubkey_sw( const mbedtls_ecp_group *grp, const mbedtls_ecp_point *pt )
2407:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 6664              		.loc 1 2407 1
 6665              		.cfi_startproc
 6666 0000 F30F1EFA 		endbr64
 6667 0004 55       		pushq	%rbp
 6668              	.LCFI126:
 6669              		.cfi_def_cfa_offset 16
 6670              		.cfi_offset 6, -16
 6671 0005 4889E5   		movq	%rsp, %rbp
 6672              	.LCFI127:
 6673              		.cfi_def_cfa_register 6
 6674 0008 4883EC60 		subq	$96, %rsp
 6675 000c 48897DA8 		movq	%rdi, -88(%rbp)
 6676 0010 488975A0 		movq	%rsi, -96(%rbp)
 6677              		.loc 1 2407 1
 6678 0014 64488B04 		movq	%fs:40, %rax
 6678      25280000 
 6678      00
 6679 001d 488945F8 		movq	%rax, -8(%rbp)
 6680 0021 31C0     		xorl	%eax, %eax
2408:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
2409:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi YY, RHS;
2410:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2411:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* pt coordinates must be normalized for our checks */
2412:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( mbedtls_mpi_cmp_int( &pt->X, 0 ) < 0 ||
GAS LISTING /tmp/ccajKZL5.s 			page 189


 6681              		.loc 1 2412 9
 6682 0023 488B45A0 		movq	-96(%rbp), %rax
 6683 0027 BE000000 		movl	$0, %esi
 6683      00
 6684 002c 4889C7   		movq	%rax, %rdi
 6685 002f E8000000 		call	mbedtls_mpi_cmp_int@PLT
 6685      00
 6686              		.loc 1 2412 7
 6687 0034 85C0     		testl	%eax, %eax
 6688 0036 7853     		js	.L622
2413:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_cmp_int( &pt->Y, 0 ) < 0 ||
 6689              		.loc 1 2413 9 discriminator 1
 6690 0038 488B45A0 		movq	-96(%rbp), %rax
 6691 003c 4883C018 		addq	$24, %rax
 6692 0040 BE000000 		movl	$0, %esi
 6692      00
 6693 0045 4889C7   		movq	%rax, %rdi
 6694 0048 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 6694      00
2412:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_cmp_int( &pt->Y, 0 ) < 0 ||
 6695              		.loc 1 2412 46 discriminator 1
 6696 004d 85C0     		testl	%eax, %eax
 6697 004f 783A     		js	.L622
2414:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_cmp_mpi( &pt->X, &grp->P ) >= 0 ||
 6698              		.loc 1 2414 9
 6699 0051 488B45A8 		movq	-88(%rbp), %rax
 6700 0055 488D5008 		leaq	8(%rax), %rdx
 6701 0059 488B45A0 		movq	-96(%rbp), %rax
 6702 005d 4889D6   		movq	%rdx, %rsi
 6703 0060 4889C7   		movq	%rax, %rdi
 6704 0063 E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 6704      00
2413:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_cmp_int( &pt->Y, 0 ) < 0 ||
 6705              		.loc 1 2413 46
 6706 0068 85C0     		testl	%eax, %eax
 6707 006a 791F     		jns	.L622
2415:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_cmp_mpi( &pt->Y, &grp->P ) >= 0 )
 6708              		.loc 1 2415 9
 6709 006c 488B45A8 		movq	-88(%rbp), %rax
 6710 0070 488D5008 		leaq	8(%rax), %rdx
 6711 0074 488B45A0 		movq	-96(%rbp), %rax
 6712 0078 4883C018 		addq	$24, %rax
 6713 007c 4889D6   		movq	%rdx, %rsi
 6714 007f 4889C7   		movq	%rax, %rdi
 6715 0082 E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 6715      00
2414:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_cmp_mpi( &pt->X, &grp->P ) >= 0 ||
 6716              		.loc 1 2414 53
 6717 0087 85C0     		testl	%eax, %eax
 6718 0089 780A     		js	.L623
 6719              	.L622:
2416:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( MBEDTLS_ERR_ECP_INVALID_KEY );
 6720              		.loc 1 2416 15
 6721 008b B880B3FF 		movl	$-19584, %eax
 6721      FF
 6722 0090 E99C0200 		jmp	.L643
 6722      00
GAS LISTING /tmp/ccajKZL5.s 			page 190


 6723              	.L623:
2417:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2418:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_init( &YY ); mbedtls_mpi_init( &RHS );
 6724              		.loc 1 2418 5
 6725 0095 488D45C0 		leaq	-64(%rbp), %rax
 6726 0099 4889C7   		movq	%rax, %rdi
 6727 009c E8000000 		call	mbedtls_mpi_init@PLT
 6727      00
 6728              		.loc 1 2418 30
 6729 00a1 488D45E0 		leaq	-32(%rbp), %rax
 6730 00a5 4889C7   		movq	%rax, %rdi
 6731 00a8 E8000000 		call	mbedtls_mpi_init@PLT
 6731      00
2419:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2420:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /*
2421:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * YY = Y^2
2422:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * RHS = X (X^2 + A) + B = X^3 + A X + B
2423:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      */
2424:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &YY,  &pt->Y,   &pt->Y  ) );  MOD_MUL( YY  );
 6732              		.loc 1 2424 5
 6733 00ad 488B45A0 		movq	-96(%rbp), %rax
 6734 00b1 488D5018 		leaq	24(%rax), %rdx
 6735 00b5 488B45A0 		movq	-96(%rbp), %rax
 6736 00b9 488D4818 		leaq	24(%rax), %rcx
 6737 00bd 488D45C0 		leaq	-64(%rbp), %rax
 6738 00c1 4889CE   		movq	%rcx, %rsi
 6739 00c4 4889C7   		movq	%rax, %rdi
 6740 00c7 E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 6740      00
 6741 00cc 8945BC   		movl	%eax, -68(%rbp)
 6742 00cf 837DBC00 		cmpl	$0, -68(%rbp)
 6743 00d3 0F851802 		jne	.L645
 6743      0000
 6744              		.loc 1 2424 73 discriminator 2
 6745 00d9 488B55A8 		movq	-88(%rbp), %rdx
 6746 00dd 488D45C0 		leaq	-64(%rbp), %rax
 6747 00e1 4889D6   		movq	%rdx, %rsi
 6748 00e4 4889C7   		movq	%rax, %rdi
 6749 00e7 E8000000 		call	ecp_modp
 6749      00
 6750 00ec 8945BC   		movl	%eax, -68(%rbp)
 6751 00ef 837DBC00 		cmpl	$0, -68(%rbp)
 6752 00f3 0F85FB01 		jne	.L646
 6752      0000
2425:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &RHS, &pt->X,   &pt->X  ) );  MOD_MUL( RHS );
 6753              		.loc 1 2425 5
 6754 00f9 488B55A0 		movq	-96(%rbp), %rdx
 6755 00fd 488B4DA0 		movq	-96(%rbp), %rcx
 6756 0101 488D45E0 		leaq	-32(%rbp), %rax
 6757 0105 4889CE   		movq	%rcx, %rsi
 6758 0108 4889C7   		movq	%rax, %rdi
 6759 010b E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 6759      00
 6760 0110 8945BC   		movl	%eax, -68(%rbp)
 6761 0113 837DBC00 		cmpl	$0, -68(%rbp)
 6762 0117 0F85DA01 		jne	.L647
 6762      0000
GAS LISTING /tmp/ccajKZL5.s 			page 191


 6763              		.loc 1 2425 73 discriminator 2
 6764 011d 488B55A8 		movq	-88(%rbp), %rdx
 6765 0121 488D45E0 		leaq	-32(%rbp), %rax
 6766 0125 4889D6   		movq	%rdx, %rsi
 6767 0128 4889C7   		movq	%rax, %rdi
 6768 012b E8000000 		call	ecp_modp
 6768      00
 6769 0130 8945BC   		movl	%eax, -68(%rbp)
 6770 0133 837DBC00 		cmpl	$0, -68(%rbp)
 6771 0137 0F85BD01 		jne	.L648
 6771      0000
2426:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2427:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Special case for A = -3 */
2428:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( grp->A.p == NULL )
 6772              		.loc 1 2428 15
 6773 013d 488B45A8 		movq	-88(%rbp), %rax
 6774 0141 488B4030 		movq	48(%rax), %rax
 6775              		.loc 1 2428 7
 6776 0145 4885C0   		testq	%rax, %rax
 6777 0148 7571     		jne	.L630
2429:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
2430:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_sub_int( &RHS, &RHS, 3       ) );  MOD_SUB( RHS );
 6778              		.loc 1 2430 9
 6779 014a 488D4DE0 		leaq	-32(%rbp), %rcx
 6780 014e 488D45E0 		leaq	-32(%rbp), %rax
 6781 0152 BA030000 		movl	$3, %edx
 6781      00
 6782 0157 4889CE   		movq	%rcx, %rsi
 6783 015a 4889C7   		movq	%rax, %rdi
 6784 015d E8000000 		call	mbedtls_mpi_sub_int@PLT
 6784      00
 6785 0162 8945BC   		movl	%eax, -68(%rbp)
 6786 0165 837DBC00 		cmpl	$0, -68(%rbp)
 6787 0169 0F858E01 		jne	.L649
 6787      0000
 6788              		.loc 1 2430 73
 6789 016f EB28     		jmp	.L632
 6790              	.L634:
 6791              		.loc 1 2430 73 is_stmt 0 discriminator 5
 6792 0171 488B45A8 		movq	-88(%rbp), %rax
 6793 0175 488D5008 		leaq	8(%rax), %rdx
 6794 0179 488D4DE0 		leaq	-32(%rbp), %rcx
 6795 017d 488D45E0 		leaq	-32(%rbp), %rax
 6796 0181 4889CE   		movq	%rcx, %rsi
 6797 0184 4889C7   		movq	%rax, %rdi
 6798 0187 E8000000 		call	mbedtls_mpi_add_mpi@PLT
 6798      00
 6799 018c 8945BC   		movl	%eax, -68(%rbp)
 6800 018f 837DBC00 		cmpl	$0, -68(%rbp)
 6801 0193 0F856701 		jne	.L650
 6801      0000
 6802              	.L632:
 6803              		.loc 1 2430 73 discriminator 3
 6804 0199 8B45E0   		movl	-32(%rbp), %eax
 6805 019c 85C0     		testl	%eax, %eax
 6806 019e 0F898400 		jns	.L633
 6806      0000
GAS LISTING /tmp/ccajKZL5.s 			page 192


 6807              		.loc 1 2430 73 discriminator 4
 6808 01a4 488D45E0 		leaq	-32(%rbp), %rax
 6809 01a8 BE000000 		movl	$0, %esi
 6809      00
 6810 01ad 4889C7   		movq	%rax, %rdi
 6811 01b0 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 6811      00
 6812 01b5 85C0     		testl	%eax, %eax
 6813 01b7 75B8     		jne	.L634
 6814 01b9 EB6D     		jmp	.L633
 6815              	.L630:
2431:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
2432:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     else
2433:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
2434:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( &RHS, &RHS, &grp->A ) );  MOD_ADD( RHS );
 6816              		.loc 1 2434 9 is_stmt 1
 6817 01bb 488B45A8 		movq	-88(%rbp), %rax
 6818 01bf 488D5020 		leaq	32(%rax), %rdx
 6819 01c3 488D4DE0 		leaq	-32(%rbp), %rcx
 6820 01c7 488D45E0 		leaq	-32(%rbp), %rax
 6821 01cb 4889CE   		movq	%rcx, %rsi
 6822 01ce 4889C7   		movq	%rax, %rdi
 6823 01d1 E8000000 		call	mbedtls_mpi_add_mpi@PLT
 6823      00
 6824 01d6 8945BC   		movl	%eax, -68(%rbp)
 6825 01d9 837DBC00 		cmpl	$0, -68(%rbp)
 6826 01dd 0F852001 		jne	.L651
 6826      0000
 6827              		.loc 1 2434 73
 6828 01e3 EB28     		jmp	.L636
 6829              	.L637:
 6830              		.loc 1 2434 73 is_stmt 0 discriminator 4
 6831 01e5 488B45A8 		movq	-88(%rbp), %rax
 6832 01e9 488D5008 		leaq	8(%rax), %rdx
 6833 01ed 488D4DE0 		leaq	-32(%rbp), %rcx
 6834 01f1 488D45E0 		leaq	-32(%rbp), %rax
 6835 01f5 4889CE   		movq	%rcx, %rsi
 6836 01f8 4889C7   		movq	%rax, %rdi
 6837 01fb E8000000 		call	mbedtls_mpi_sub_abs@PLT
 6837      00
 6838 0200 8945BC   		movl	%eax, -68(%rbp)
 6839 0203 837DBC00 		cmpl	$0, -68(%rbp)
 6840 0207 0F85F900 		jne	.L652
 6840      0000
 6841              	.L636:
 6842              		.loc 1 2434 73 discriminator 3
 6843 020d 488B45A8 		movq	-88(%rbp), %rax
 6844 0211 488D5008 		leaq	8(%rax), %rdx
 6845 0215 488D45E0 		leaq	-32(%rbp), %rax
 6846 0219 4889D6   		movq	%rdx, %rsi
 6847 021c 4889C7   		movq	%rax, %rdi
 6848 021f E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 6848      00
 6849 0224 85C0     		testl	%eax, %eax
 6850 0226 79BD     		jns	.L637
 6851              	.L633:
2435:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
GAS LISTING /tmp/ccajKZL5.s 			page 193


2436:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2437:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &RHS, &RHS,     &pt->X  ) );  MOD_MUL( RHS );
 6852              		.loc 1 2437 5 is_stmt 1
 6853 0228 488B55A0 		movq	-96(%rbp), %rdx
 6854 022c 488D4DE0 		leaq	-32(%rbp), %rcx
 6855 0230 488D45E0 		leaq	-32(%rbp), %rax
 6856 0234 4889CE   		movq	%rcx, %rsi
 6857 0237 4889C7   		movq	%rax, %rdi
 6858 023a E8000000 		call	mbedtls_mpi_mul_mpi@PLT
 6858      00
 6859 023f 8945BC   		movl	%eax, -68(%rbp)
 6860 0242 837DBC00 		cmpl	$0, -68(%rbp)
 6861 0246 0F85BD00 		jne	.L653
 6861      0000
 6862              		.loc 1 2437 73 discriminator 2
 6863 024c 488B55A8 		movq	-88(%rbp), %rdx
 6864 0250 488D45E0 		leaq	-32(%rbp), %rax
 6865 0254 4889D6   		movq	%rdx, %rsi
 6866 0257 4889C7   		movq	%rax, %rdi
 6867 025a E8000000 		call	ecp_modp
 6867      00
 6868 025f 8945BC   		movl	%eax, -68(%rbp)
 6869 0262 837DBC00 		cmpl	$0, -68(%rbp)
 6870 0266 0F85A000 		jne	.L654
 6870      0000
2438:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( &RHS, &RHS,     &grp->B ) );  MOD_ADD( RHS );
 6871              		.loc 1 2438 5
 6872 026c 488B45A8 		movq	-88(%rbp), %rax
 6873 0270 488D5038 		leaq	56(%rax), %rdx
 6874 0274 488D4DE0 		leaq	-32(%rbp), %rcx
 6875 0278 488D45E0 		leaq	-32(%rbp), %rax
 6876 027c 4889CE   		movq	%rcx, %rsi
 6877 027f 4889C7   		movq	%rax, %rdi
 6878 0282 E8000000 		call	mbedtls_mpi_add_mpi@PLT
 6878      00
 6879 0287 8945BC   		movl	%eax, -68(%rbp)
 6880 028a 837DBC00 		cmpl	$0, -68(%rbp)
 6881 028e 757F     		jne	.L655
 6882              		.loc 1 2438 73
 6883 0290 EB24     		jmp	.L641
 6884              	.L642:
 6885              		.loc 1 2438 73 is_stmt 0 discriminator 4
 6886 0292 488B45A8 		movq	-88(%rbp), %rax
 6887 0296 488D5008 		leaq	8(%rax), %rdx
 6888 029a 488D4DE0 		leaq	-32(%rbp), %rcx
 6889 029e 488D45E0 		leaq	-32(%rbp), %rax
 6890 02a2 4889CE   		movq	%rcx, %rsi
 6891 02a5 4889C7   		movq	%rax, %rdi
 6892 02a8 E8000000 		call	mbedtls_mpi_sub_abs@PLT
 6892      00
 6893 02ad 8945BC   		movl	%eax, -68(%rbp)
 6894 02b0 837DBC00 		cmpl	$0, -68(%rbp)
 6895 02b4 755C     		jne	.L656
 6896              	.L641:
 6897              		.loc 1 2438 73 discriminator 3
 6898 02b6 488B45A8 		movq	-88(%rbp), %rax
 6899 02ba 488D5008 		leaq	8(%rax), %rdx
GAS LISTING /tmp/ccajKZL5.s 			page 194


 6900 02be 488D45E0 		leaq	-32(%rbp), %rax
 6901 02c2 4889D6   		movq	%rdx, %rsi
 6902 02c5 4889C7   		movq	%rax, %rdi
 6903 02c8 E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 6903      00
 6904 02cd 85C0     		testl	%eax, %eax
 6905 02cf 79C1     		jns	.L642
2439:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2440:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( mbedtls_mpi_cmp_mpi( &YY, &RHS ) != 0 )
 6906              		.loc 1 2440 9 is_stmt 1
 6907 02d1 488D55E0 		leaq	-32(%rbp), %rdx
 6908 02d5 488D45C0 		leaq	-64(%rbp), %rax
 6909 02d9 4889D6   		movq	%rdx, %rsi
 6910 02dc 4889C7   		movq	%rax, %rdi
 6911 02df E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 6911      00
 6912              		.loc 1 2440 7
 6913 02e4 85C0     		testl	%eax, %eax
 6914 02e6 742D     		je	.L657
2441:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         ret = MBEDTLS_ERR_ECP_INVALID_KEY;
 6915              		.loc 1 2441 13
 6916 02e8 C745BC80 		movl	$-19584, -68(%rbp)
 6916      B3FFFF
 6917 02ef EB25     		jmp	.L626
 6918              	.L645:
2424:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &RHS, &pt->X,   &pt->X  ) );  MOD_MUL( RHS );
 6919              		.loc 1 2424 5
 6920 02f1 90       		nop
 6921 02f2 EB22     		jmp	.L626
 6922              	.L646:
2424:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &RHS, &pt->X,   &pt->X  ) );  MOD_MUL( RHS );
 6923              		.loc 1 2424 73
 6924 02f4 90       		nop
 6925 02f5 EB1F     		jmp	.L626
 6926              	.L647:
2425:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 6927              		.loc 1 2425 5
 6928 02f7 90       		nop
 6929 02f8 EB1C     		jmp	.L626
 6930              	.L648:
2425:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 6931              		.loc 1 2425 73
 6932 02fa 90       		nop
 6933 02fb EB19     		jmp	.L626
 6934              	.L649:
2430:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 6935              		.loc 1 2430 9
 6936 02fd 90       		nop
 6937 02fe EB16     		jmp	.L626
 6938              	.L650:
2430:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 6939              		.loc 1 2430 73
 6940 0300 90       		nop
 6941 0301 EB13     		jmp	.L626
 6942              	.L651:
2434:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 6943              		.loc 1 2434 9
GAS LISTING /tmp/ccajKZL5.s 			page 195


 6944 0303 90       		nop
 6945 0304 EB10     		jmp	.L626
 6946              	.L652:
2434:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
 6947              		.loc 1 2434 73
 6948 0306 90       		nop
 6949 0307 EB0D     		jmp	.L626
 6950              	.L653:
2437:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( &RHS, &RHS,     &grp->B ) );  MOD_ADD( RHS );
 6951              		.loc 1 2437 5
 6952 0309 90       		nop
 6953 030a EB0A     		jmp	.L626
 6954              	.L654:
2437:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_mpi_add_mpi( &RHS, &RHS,     &grp->B ) );  MOD_ADD( RHS );
 6955              		.loc 1 2437 73
 6956 030c 90       		nop
 6957 030d EB07     		jmp	.L626
 6958              	.L655:
2438:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 6959              		.loc 1 2438 5
 6960 030f 90       		nop
 6961 0310 EB04     		jmp	.L626
 6962              	.L656:
2438:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 6963              		.loc 1 2438 73
 6964 0312 90       		nop
 6965 0313 EB01     		jmp	.L626
 6966              	.L657:
2442:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2443:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
 6967              		.loc 1 2443 1
 6968 0315 90       		nop
 6969              	.L626:
2444:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2445:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_mpi_free( &YY ); mbedtls_mpi_free( &RHS );
 6970              		.loc 1 2445 5
 6971 0316 488D45C0 		leaq	-64(%rbp), %rax
 6972 031a 4889C7   		movq	%rax, %rdi
 6973 031d E8000000 		call	mbedtls_mpi_free@PLT
 6973      00
 6974              		.loc 1 2445 30
 6975 0322 488D45E0 		leaq	-32(%rbp), %rax
 6976 0326 4889C7   		movq	%rax, %rdi
 6977 0329 E8000000 		call	mbedtls_mpi_free@PLT
 6977      00
2446:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2447:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 6978              		.loc 1 2447 11
 6979 032e 8B45BC   		movl	-68(%rbp), %eax
 6980              	.L643:
2448:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 6981              		.loc 1 2448 1 discriminator 1
 6982 0331 488B4DF8 		movq	-8(%rbp), %rcx
 6983 0335 6448330C 		xorq	%fs:40, %rcx
 6983      25280000 
 6983      00
 6984 033e 7405     		je	.L644
GAS LISTING /tmp/ccajKZL5.s 			page 196


 6985              		.loc 1 2448 1 is_stmt 0
 6986 0340 E8000000 		call	__stack_chk_fail@PLT
 6986      00
 6987              	.L644:
 6988 0345 C9       		leave
 6989              	.LCFI128:
 6990              		.cfi_def_cfa 7, 8
 6991 0346 C3       		ret
 6992              		.cfi_endproc
 6993              	.LFE48:
 6995              		.section	.text.mbedtls_ecp_mul_shortcuts,"ax",@progbits
 6997              	mbedtls_ecp_mul_shortcuts:
 6998              	.LFB49:
2449:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif /* ECP_SHORTWEIERSTRASS */
2450:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2451:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
2452:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * R = m * P with shortcuts for m == 1 and m == -1
2453:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * NOT constant-time - ONLY for short Weierstrass!
2454:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
2455:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static int mbedtls_ecp_mul_shortcuts( mbedtls_ecp_group *grp,
2456:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                       mbedtls_ecp_point *R,
2457:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                       const mbedtls_mpi *m,
2458:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                       const mbedtls_ecp_point *P,
2459:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                       mbedtls_ecp_restart_ctx *rs_ctx )
2460:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 6999              		.loc 1 2460 1 is_stmt 1
 7000              		.cfi_startproc
 7001 0000 F30F1EFA 		endbr64
 7002 0004 55       		pushq	%rbp
 7003              	.LCFI129:
 7004              		.cfi_def_cfa_offset 16
 7005              		.cfi_offset 6, -16
 7006 0005 4889E5   		movq	%rsp, %rbp
 7007              	.LCFI130:
 7008              		.cfi_def_cfa_register 6
 7009 0008 4883EC40 		subq	$64, %rsp
 7010 000c 48897DE8 		movq	%rdi, -24(%rbp)
 7011 0010 488975E0 		movq	%rsi, -32(%rbp)
 7012 0014 488955D8 		movq	%rdx, -40(%rbp)
 7013 0018 48894DD0 		movq	%rcx, -48(%rbp)
 7014 001c 4C8945C8 		movq	%r8, -56(%rbp)
 7015              		.loc 1 2460 1
 7016 0020 64488B04 		movq	%fs:40, %rax
 7016      25280000 
 7016      00
 7017 0029 488945F8 		movq	%rax, -8(%rbp)
 7018 002d 31C0     		xorl	%eax, %eax
2461:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
2462:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2463:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( mbedtls_mpi_cmp_int( m, 1 ) == 0 )
 7019              		.loc 1 2463 9
 7020 002f 488B45D8 		movq	-40(%rbp), %rax
 7021 0033 BE010000 		movl	$1, %esi
 7021      00
 7022 0038 4889C7   		movq	%rax, %rdi
 7023 003b E8000000 		call	mbedtls_mpi_cmp_int@PLT
 7023      00
GAS LISTING /tmp/ccajKZL5.s 			page 197


 7024              		.loc 1 2463 7
 7025 0040 85C0     		testl	%eax, %eax
 7026 0042 751F     		jne	.L659
2464:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
2465:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_ecp_copy( R, P ) );
 7027              		.loc 1 2465 9
 7028 0044 488B55D0 		movq	-48(%rbp), %rdx
 7029 0048 488B45E0 		movq	-32(%rbp), %rax
 7030 004c 4889D6   		movq	%rdx, %rsi
 7031 004f 4889C7   		movq	%rax, %rdi
 7032 0052 E8000000 		call	mbedtls_ecp_copy
 7032      00
 7033 0057 8945F4   		movl	%eax, -12(%rbp)
 7034 005a 837DF400 		cmpl	$0, -12(%rbp)
 7035 005e E9B10000 		jmp	.L660
 7035      00
 7036              	.L659:
2466:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
2467:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     else if( mbedtls_mpi_cmp_int( m, -1 ) == 0 )
 7037              		.loc 1 2467 14
 7038 0063 488B45D8 		movq	-40(%rbp), %rax
 7039 0067 48C7C6FF 		movq	$-1, %rsi
 7039      FFFFFF
 7040 006e 4889C7   		movq	%rax, %rdi
 7041 0071 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 7041      00
 7042              		.loc 1 2467 12
 7043 0076 85C0     		testl	%eax, %eax
 7044 0078 7561     		jne	.L661
2468:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
2469:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_ecp_copy( R, P ) );
 7045              		.loc 1 2469 9
 7046 007a 488B55D0 		movq	-48(%rbp), %rdx
 7047 007e 488B45E0 		movq	-32(%rbp), %rax
 7048 0082 4889D6   		movq	%rdx, %rsi
 7049 0085 4889C7   		movq	%rax, %rdi
 7050 0088 E8000000 		call	mbedtls_ecp_copy
 7050      00
 7051 008d 8945F4   		movl	%eax, -12(%rbp)
 7052 0090 837DF400 		cmpl	$0, -12(%rbp)
 7053 0094 757D     		jne	.L665
2470:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( mbedtls_mpi_cmp_int( &R->Y, 0 ) != 0 )
 7054              		.loc 1 2470 34
 7055 0096 488B45E0 		movq	-32(%rbp), %rax
 7056 009a 4883C018 		addq	$24, %rax
 7057              		.loc 1 2470 13
 7058 009e BE000000 		movl	$0, %esi
 7058      00
 7059 00a3 4889C7   		movq	%rax, %rdi
 7060 00a6 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 7060      00
 7061              		.loc 1 2470 11
 7062 00ab 85C0     		testl	%eax, %eax
 7063 00ad 7465     		je	.L660
2471:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_sub_mpi( &R->Y, &grp->P, &R->Y ) );
 7064              		.loc 1 2471 13
 7065 00af 488B45E0 		movq	-32(%rbp), %rax
GAS LISTING /tmp/ccajKZL5.s 			page 198


 7066 00b3 488D5018 		leaq	24(%rax), %rdx
 7067 00b7 488B45E8 		movq	-24(%rbp), %rax
 7068 00bb 488D4808 		leaq	8(%rax), %rcx
 7069 00bf 488B45E0 		movq	-32(%rbp), %rax
 7070 00c3 4883C018 		addq	$24, %rax
 7071 00c7 4889CE   		movq	%rcx, %rsi
 7072 00ca 4889C7   		movq	%rax, %rdi
 7073 00cd E8000000 		call	mbedtls_mpi_sub_mpi@PLT
 7073      00
 7074 00d2 8945F4   		movl	%eax, -12(%rbp)
 7075 00d5 837DF400 		cmpl	$0, -12(%rbp)
 7076 00d9 EB39     		jmp	.L660
 7077              	.L661:
2472:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
2473:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     else
2474:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
2475:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_ecp_mul_restartable( grp, R, m, P,
 7078              		.loc 1 2475 9
 7079 00db 488B4DD0 		movq	-48(%rbp), %rcx
 7080 00df 488B55D8 		movq	-40(%rbp), %rdx
 7081 00e3 488B75E0 		movq	-32(%rbp), %rsi
 7082 00e7 488B45E8 		movq	-24(%rbp), %rax
 7083 00eb 4883EC08 		subq	$8, %rsp
 7084 00ef FF75C8   		pushq	-56(%rbp)
 7085 00f2 41B90000 		movl	$0, %r9d
 7085      0000
 7086 00f8 41B80000 		movl	$0, %r8d
 7086      0000
 7087 00fe 4889C7   		movq	%rax, %rdi
 7088 0101 E8000000 		call	mbedtls_ecp_mul_restartable
 7088      00
 7089 0106 4883C410 		addq	$16, %rsp
 7090 010a 8945F4   		movl	%eax, -12(%rbp)
 7091 010d 837DF400 		cmpl	$0, -12(%rbp)
2476:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                                       NULL, NULL, rs_ctx ) );
2477:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
2478:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2479:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
 7092              		.loc 1 2479 1
 7093 0111 EB01     		jmp	.L660
 7094              	.L665:
2469:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( mbedtls_mpi_cmp_int( &R->Y, 0 ) != 0 )
 7095              		.loc 1 2469 9
 7096 0113 90       		nop
 7097              	.L660:
2480:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 7098              		.loc 1 2480 11
 7099 0114 8B45F4   		movl	-12(%rbp), %eax
2481:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 7100              		.loc 1 2481 1
 7101 0117 488B4DF8 		movq	-8(%rbp), %rcx
 7102 011b 6448330C 		xorq	%fs:40, %rcx
 7102      25280000 
 7102      00
 7103 0124 7405     		je	.L664
 7104 0126 E8000000 		call	__stack_chk_fail@PLT
 7104      00
GAS LISTING /tmp/ccajKZL5.s 			page 199


 7105              	.L664:
 7106 012b C9       		leave
 7107              	.LCFI131:
 7108              		.cfi_def_cfa 7, 8
 7109 012c C3       		ret
 7110              		.cfi_endproc
 7111              	.LFE49:
 7113              		.section	.text.mbedtls_ecp_muladd_restartable,"ax",@progbits
 7114              		.globl	mbedtls_ecp_muladd_restartable
 7116              	mbedtls_ecp_muladd_restartable:
 7117              	.LFB50:
2482:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2483:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
2484:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Restartable linear combination
2485:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * NOT constant-time
2486:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
2487:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_muladd_restartable(
2488:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
2489:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              const mbedtls_mpi *m, const mbedtls_ecp_point *P,
2490:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              const mbedtls_mpi *n, const mbedtls_ecp_point *Q,
2491:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              mbedtls_ecp_restart_ctx *rs_ctx )
2492:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 7118              		.loc 1 2492 1
 7119              		.cfi_startproc
 7120 0000 F30F1EFA 		endbr64
 7121 0004 55       		pushq	%rbp
 7122              	.LCFI132:
 7123              		.cfi_def_cfa_offset 16
 7124              		.cfi_offset 6, -16
 7125 0005 4889E5   		movq	%rsp, %rbp
 7126              	.LCFI133:
 7127              		.cfi_def_cfa_register 6
 7128 0008 4881ECB0 		subq	$176, %rsp
 7128      000000
 7129 000f 48897D88 		movq	%rdi, -120(%rbp)
 7130 0013 48897580 		movq	%rsi, -128(%rbp)
 7131 0017 48899578 		movq	%rdx, -136(%rbp)
 7131      FFFFFF
 7132 001e 48898D70 		movq	%rcx, -144(%rbp)
 7132      FFFFFF
 7133 0025 4C898568 		movq	%r8, -152(%rbp)
 7133      FFFFFF
 7134 002c 4C898D60 		movq	%r9, -160(%rbp)
 7134      FFFFFF
 7135 0033 488B4510 		movq	16(%rbp), %rax
 7136 0037 48898558 		movq	%rax, -168(%rbp)
 7136      FFFFFF
 7137              		.loc 1 2492 1
 7138 003e 64488B04 		movq	%fs:40, %rax
 7138      25280000 
 7138      00
 7139 0047 488945F8 		movq	%rax, -8(%rbp)
 7140 004b 31C0     		xorl	%eax, %eax
2493:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
2494:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point mP;
2495:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point *pmP = &mP;
 7141              		.loc 1 2495 24
GAS LISTING /tmp/ccajKZL5.s 			page 200


 7142 004d 488D45B0 		leaq	-80(%rbp), %rax
 7143 0051 488945A0 		movq	%rax, -96(%rbp)
2496:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point *pR = R;
 7144              		.loc 1 2496 24
 7145 0055 488B4580 		movq	-128(%rbp), %rax
 7146 0059 488945A8 		movq	%rax, -88(%rbp)
2497:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_INTERNAL_ALT)
2498:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     char is_grp_capable = 0;
2499:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
2500:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( grp != NULL );
2501:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( R   != NULL );
2502:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( m   != NULL );
2503:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( P   != NULL );
2504:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( n   != NULL );
2505:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( Q   != NULL );
2506:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2507:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ecp_get_type( grp ) != ECP_TYPE_SHORT_WEIERSTRASS )
 7147              		.loc 1 2507 9
 7148 005d 488B4588 		movq	-120(%rbp), %rax
 7149 0061 4889C7   		movq	%rax, %rdi
 7150 0064 E8000000 		call	ecp_get_type
 7150      00
 7151              		.loc 1 2507 7
 7152 0069 83F801   		cmpl	$1, %eax
 7153 006c 740A     		je	.L667
2508:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( MBEDTLS_ERR_ECP_FEATURE_UNAVAILABLE );
 7154              		.loc 1 2508 15
 7155 006e B880B1FF 		movl	$-20096, %eax
 7155      FF
 7156 0073 E9C10000 		jmp	.L673
 7156      00
 7157              	.L667:
2509:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2510:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point_init( &mP );
 7158              		.loc 1 2510 5
 7159 0078 488D45B0 		leaq	-80(%rbp), %rax
 7160 007c 4889C7   		movq	%rax, %rdi
 7161 007f E8000000 		call	mbedtls_ecp_point_init
 7161      00
2511:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2512:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_RS_ENTER( ma );
2513:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2514:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
2515:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && rs_ctx->ma != NULL )
2516:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
2517:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* redirect intermediate results to restart context */
2518:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         pmP = &rs_ctx->ma->mP;
2519:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         pR  = &rs_ctx->ma->R;
2520:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2521:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* jump to next operation */
2522:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( rs_ctx->ma->state == ecp_rsma_mul2 )
2523:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             goto mul2;
2524:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( rs_ctx->ma->state == ecp_rsma_add )
2525:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             goto add;
2526:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( rs_ctx->ma->state == ecp_rsma_norm )
2527:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             goto norm;
2528:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
GAS LISTING /tmp/ccajKZL5.s 			page 201


2529:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif /* MBEDTLS_ECP_RESTARTABLE */
2530:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2531:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_ecp_mul_shortcuts( grp, pmP, m, P, rs_ctx ) );
 7162              		.loc 1 2531 5
 7163 0084 488BBD58 		movq	-168(%rbp), %rdi
 7163      FFFFFF
 7164 008b 488B8D70 		movq	-144(%rbp), %rcx
 7164      FFFFFF
 7165 0092 488B9578 		movq	-136(%rbp), %rdx
 7165      FFFFFF
 7166 0099 488B75A0 		movq	-96(%rbp), %rsi
 7167 009d 488B4588 		movq	-120(%rbp), %rax
 7168 00a1 4989F8   		movq	%rdi, %r8
 7169 00a4 4889C7   		movq	%rax, %rdi
 7170 00a7 E8000000 		call	mbedtls_ecp_mul_shortcuts
 7170      00
 7171 00ac 89459C   		movl	%eax, -100(%rbp)
 7172 00af 837D9C00 		cmpl	$0, -100(%rbp)
 7173 00b3 756E     		jne	.L675
2532:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
2533:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && rs_ctx->ma != NULL )
2534:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->ma->state = ecp_rsma_mul2;
2535:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2536:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** mul2:
2537:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
2538:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_ecp_mul_shortcuts( grp, pR,  n, Q, rs_ctx ) );
 7174              		.loc 1 2538 5
 7175 00b5 488BBD58 		movq	-168(%rbp), %rdi
 7175      FFFFFF
 7176 00bc 488B8D60 		movq	-160(%rbp), %rcx
 7176      FFFFFF
 7177 00c3 488B9568 		movq	-152(%rbp), %rdx
 7177      FFFFFF
 7178 00ca 488B75A8 		movq	-88(%rbp), %rsi
 7179 00ce 488B4588 		movq	-120(%rbp), %rax
 7180 00d2 4989F8   		movq	%rdi, %r8
 7181 00d5 4889C7   		movq	%rax, %rdi
 7182 00d8 E8000000 		call	mbedtls_ecp_mul_shortcuts
 7182      00
 7183 00dd 89459C   		movl	%eax, -100(%rbp)
 7184 00e0 837D9C00 		cmpl	$0, -100(%rbp)
 7185 00e4 7540     		jne	.L676
2539:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2540:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_INTERNAL_ALT)
2541:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ( is_grp_capable = mbedtls_internal_ecp_grp_capable( grp ) ) )
2542:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_internal_ecp_init( grp ) );
2543:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif /* MBEDTLS_ECP_INTERNAL_ALT */
2544:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2545:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
2546:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && rs_ctx->ma != NULL )
2547:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->ma->state = ecp_rsma_add;
2548:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2549:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** add:
2550:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
2551:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_ECP_BUDGET( MBEDTLS_ECP_OPS_ADD );
2552:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( ecp_add_mixed( grp, pR, pmP, pR ) );
 7186              		.loc 1 2552 5
GAS LISTING /tmp/ccajKZL5.s 			page 202


 7187 00e6 488B4DA8 		movq	-88(%rbp), %rcx
 7188 00ea 488B55A0 		movq	-96(%rbp), %rdx
 7189 00ee 488B75A8 		movq	-88(%rbp), %rsi
 7190 00f2 488B4588 		movq	-120(%rbp), %rax
 7191 00f6 4889C7   		movq	%rax, %rdi
 7192 00f9 E8000000 		call	ecp_add_mixed
 7192      00
 7193 00fe 89459C   		movl	%eax, -100(%rbp)
 7194 0101 837D9C00 		cmpl	$0, -100(%rbp)
 7195 0105 7522     		jne	.L677
2553:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
2554:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && rs_ctx->ma != NULL )
2555:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         rs_ctx->ma->state = ecp_rsma_norm;
2556:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2557:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** norm:
2558:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
2559:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_ECP_BUDGET( MBEDTLS_ECP_OPS_INV );
2560:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( ecp_normalize_jac( grp, pR ) );
 7196              		.loc 1 2560 5
 7197 0107 488B55A8 		movq	-88(%rbp), %rdx
 7198 010b 488B4588 		movq	-120(%rbp), %rax
 7199 010f 4889D6   		movq	%rdx, %rsi
 7200 0112 4889C7   		movq	%rax, %rdi
 7201 0115 E8000000 		call	ecp_normalize_jac
 7201      00
 7202 011a 89459C   		movl	%eax, -100(%rbp)
 7203 011d 837D9C00 		cmpl	$0, -100(%rbp)
2561:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2562:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
2563:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( rs_ctx != NULL && rs_ctx->ma != NULL )
2564:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_ecp_copy( R, pR ) );
2565:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
2566:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2567:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
 7204              		.loc 1 2567 1
 7205 0121 EB07     		jmp	.L670
 7206              	.L675:
2531:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
 7207              		.loc 1 2531 5
 7208 0123 90       		nop
 7209 0124 EB04     		jmp	.L670
 7210              	.L676:
2538:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 7211              		.loc 1 2538 5
 7212 0126 90       		nop
 7213 0127 EB01     		jmp	.L670
 7214              	.L677:
2552:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_RESTARTABLE)
 7215              		.loc 1 2552 5
 7216 0129 90       		nop
 7217              	.L670:
2568:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(MBEDTLS_ECP_INTERNAL_ALT)
2569:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( is_grp_capable )
2570:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_internal_ecp_free( grp );
2571:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif /* MBEDTLS_ECP_INTERNAL_ALT */
2572:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2573:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point_free( &mP );
GAS LISTING /tmp/ccajKZL5.s 			page 203


 7218              		.loc 1 2573 5
 7219 012a 488D45B0 		leaq	-80(%rbp), %rax
 7220 012e 4889C7   		movq	%rax, %rdi
 7221 0131 E8000000 		call	mbedtls_ecp_point_free
 7221      00
2574:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2575:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_RS_LEAVE( ma );
2576:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2577:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 7222              		.loc 1 2577 11
 7223 0136 8B459C   		movl	-100(%rbp), %eax
 7224              	.L673:
2578:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 7225              		.loc 1 2578 1 discriminator 1
 7226 0139 488B4DF8 		movq	-8(%rbp), %rcx
 7227 013d 6448330C 		xorq	%fs:40, %rcx
 7227      25280000 
 7227      00
 7228 0146 7405     		je	.L674
 7229              		.loc 1 2578 1 is_stmt 0
 7230 0148 E8000000 		call	__stack_chk_fail@PLT
 7230      00
 7231              	.L674:
 7232 014d C9       		leave
 7233              	.LCFI134:
 7234              		.cfi_def_cfa 7, 8
 7235 014e C3       		ret
 7236              		.cfi_endproc
 7237              	.LFE50:
 7239              		.section	.text.mbedtls_ecp_muladd,"ax",@progbits
 7240              		.globl	mbedtls_ecp_muladd
 7242              	mbedtls_ecp_muladd:
 7243              	.LFB51:
2579:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2580:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
2581:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Linear combination
2582:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * NOT constant-time
2583:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
2584:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_muladd( mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
2585:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              const mbedtls_mpi *m, const mbedtls_ecp_point *P,
2586:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              const mbedtls_mpi *n, const mbedtls_ecp_point *Q )
2587:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 7244              		.loc 1 2587 1 is_stmt 1
 7245              		.cfi_startproc
 7246 0000 F30F1EFA 		endbr64
 7247 0004 55       		pushq	%rbp
 7248              	.LCFI135:
 7249              		.cfi_def_cfa_offset 16
 7250              		.cfi_offset 6, -16
 7251 0005 4889E5   		movq	%rsp, %rbp
 7252              	.LCFI136:
 7253              		.cfi_def_cfa_register 6
 7254 0008 4883EC40 		subq	$64, %rsp
 7255 000c 48897DE8 		movq	%rdi, -24(%rbp)
 7256 0010 488975E0 		movq	%rsi, -32(%rbp)
 7257 0014 488955D8 		movq	%rdx, -40(%rbp)
 7258 0018 48894DD0 		movq	%rcx, -48(%rbp)
GAS LISTING /tmp/ccajKZL5.s 			page 204


 7259 001c 4C8945C8 		movq	%r8, -56(%rbp)
 7260 0020 4C894DC0 		movq	%r9, -64(%rbp)
 7261              		.loc 1 2587 1
 7262 0024 64488B04 		movq	%fs:40, %rax
 7262      25280000 
 7262      00
 7263 002d 488945F8 		movq	%rax, -8(%rbp)
 7264 0031 31C0     		xorl	%eax, %eax
2588:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( grp != NULL );
2589:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( R   != NULL );
2590:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( m   != NULL );
2591:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( P   != NULL );
2592:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( n   != NULL );
2593:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( Q   != NULL );
2594:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( mbedtls_ecp_muladd_restartable( grp, R, m, P, n, Q, NULL ) );
 7265              		.loc 1 2594 13
 7266 0033 4C8B45C0 		movq	-64(%rbp), %r8
 7267 0037 488B7DC8 		movq	-56(%rbp), %rdi
 7268 003b 488B4DD0 		movq	-48(%rbp), %rcx
 7269 003f 488B55D8 		movq	-40(%rbp), %rdx
 7270 0043 488B75E0 		movq	-32(%rbp), %rsi
 7271 0047 488B45E8 		movq	-24(%rbp), %rax
 7272 004b 4883EC08 		subq	$8, %rsp
 7273 004f 6A00     		pushq	$0
 7274 0051 4D89C1   		movq	%r8, %r9
 7275 0054 4989F8   		movq	%rdi, %r8
 7276 0057 4889C7   		movq	%rax, %rdi
 7277 005a E8000000 		call	mbedtls_ecp_muladd_restartable
 7277      00
 7278 005f 4883C410 		addq	$16, %rsp
2595:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 7279              		.loc 1 2595 1
 7280 0063 488B55F8 		movq	-8(%rbp), %rdx
 7281 0067 64483314 		xorq	%fs:40, %rdx
 7281      25280000 
 7281      00
 7282 0070 7405     		je	.L680
 7283 0072 E8000000 		call	__stack_chk_fail@PLT
 7283      00
 7284              	.L680:
 7285 0077 C9       		leave
 7286              	.LCFI137:
 7287              		.cfi_def_cfa 7, 8
 7288 0078 C3       		ret
 7289              		.cfi_endproc
 7290              	.LFE51:
 7292              		.section	.text.mbedtls_ecp_check_pubkey,"ax",@progbits
 7293              		.globl	mbedtls_ecp_check_pubkey
 7295              	mbedtls_ecp_check_pubkey:
 7296              	.LFB52:
2596:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2597:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(ECP_MONTGOMERY)
2598:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
2599:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Check validity of a public key for Montgomery curves with x-only schemes
2600:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
2601:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** static int ecp_check_pubkey_mx( const mbedtls_ecp_group *grp, const mbedtls_ecp_point *pt )
2602:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
GAS LISTING /tmp/ccajKZL5.s 			page 205


2603:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* [Curve25519 p. 5] Just check X is the correct number of bytes */
2604:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Allow any public value, if it's too big then we'll just reduce it mod p
2605:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****      * (RFC 7748 sec. 5 para. 3). */
2606:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( mbedtls_mpi_size( &pt->X ) > ( grp->nbits + 7 ) / 8 )
2607:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( MBEDTLS_ERR_ECP_INVALID_KEY );
2608:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2609:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( 0 );
2610:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
2611:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif /* ECP_MONTGOMERY */
2612:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2613:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
2614:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Check that a point is valid as a public key
2615:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
2616:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_check_pubkey( const mbedtls_ecp_group *grp,
2617:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                               const mbedtls_ecp_point *pt )
2618:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 7297              		.loc 1 2618 1
 7298              		.cfi_startproc
 7299 0000 F30F1EFA 		endbr64
 7300 0004 55       		pushq	%rbp
 7301              	.LCFI138:
 7302              		.cfi_def_cfa_offset 16
 7303              		.cfi_offset 6, -16
 7304 0005 4889E5   		movq	%rsp, %rbp
 7305              	.LCFI139:
 7306              		.cfi_def_cfa_register 6
 7307 0008 4883EC20 		subq	$32, %rsp
 7308 000c 48897DE8 		movq	%rdi, -24(%rbp)
 7309 0010 488975E0 		movq	%rsi, -32(%rbp)
 7310              		.loc 1 2618 1
 7311 0014 64488B04 		movq	%fs:40, %rax
 7311      25280000 
 7311      00
 7312 001d 488945F8 		movq	%rax, -8(%rbp)
 7313 0021 31C0     		xorl	%eax, %eax
2619:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( grp != NULL );
2620:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( pt  != NULL );
2621:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2622:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Must use affine coordinates */
2623:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( mbedtls_mpi_cmp_int( &pt->Z, 1 ) != 0 )
 7314              		.loc 1 2623 9
 7315 0023 488B45E0 		movq	-32(%rbp), %rax
 7316 0027 4883C030 		addq	$48, %rax
 7317 002b BE010000 		movl	$1, %esi
 7317      00
 7318 0030 4889C7   		movq	%rax, %rdi
 7319 0033 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 7319      00
 7320              		.loc 1 2623 7
 7321 0038 85C0     		testl	%eax, %eax
 7322 003a 7407     		je	.L682
2624:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( MBEDTLS_ERR_ECP_INVALID_KEY );
 7323              		.loc 1 2624 15
 7324 003c B880B3FF 		movl	$-19584, %eax
 7324      FF
 7325 0041 EB2B     		jmp	.L683
 7326              	.L682:
GAS LISTING /tmp/ccajKZL5.s 			page 206


2625:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2626:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(ECP_MONTGOMERY)
2627:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ecp_get_type( grp ) == ECP_TYPE_MONTGOMERY )
2628:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( ecp_check_pubkey_mx( grp, pt ) );
2629:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
2630:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(ECP_SHORTWEIERSTRASS)
2631:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ecp_get_type( grp ) == ECP_TYPE_SHORT_WEIERSTRASS )
 7327              		.loc 1 2631 9
 7328 0043 488B45E8 		movq	-24(%rbp), %rax
 7329 0047 4889C7   		movq	%rax, %rdi
 7330 004a E8000000 		call	ecp_get_type
 7330      00
 7331              		.loc 1 2631 7
 7332 004f 83F801   		cmpl	$1, %eax
 7333 0052 7515     		jne	.L684
2632:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( ecp_check_pubkey_sw( grp, pt ) );
 7334              		.loc 1 2632 17
 7335 0054 488B55E0 		movq	-32(%rbp), %rdx
 7336 0058 488B45E8 		movq	-24(%rbp), %rax
 7337 005c 4889D6   		movq	%rdx, %rsi
 7338 005f 4889C7   		movq	%rax, %rdi
 7339 0062 E8000000 		call	ecp_check_pubkey_sw
 7339      00
 7340 0067 EB05     		jmp	.L683
 7341              	.L684:
2633:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif
2634:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( MBEDTLS_ERR_ECP_BAD_INPUT_DATA );
 7342              		.loc 1 2634 11
 7343 0069 B880B0FF 		movl	$-20352, %eax
 7343      FF
 7344              	.L683:
2635:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 7345              		.loc 1 2635 1
 7346 006e 488B4DF8 		movq	-8(%rbp), %rcx
 7347 0072 6448330C 		xorq	%fs:40, %rcx
 7347      25280000 
 7347      00
 7348 007b 7405     		je	.L685
 7349 007d E8000000 		call	__stack_chk_fail@PLT
 7349      00
 7350              	.L685:
 7351 0082 C9       		leave
 7352              	.LCFI140:
 7353              		.cfi_def_cfa 7, 8
 7354 0083 C3       		ret
 7355              		.cfi_endproc
 7356              	.LFE52:
 7358              		.section	.text.mbedtls_ecp_check_privkey,"ax",@progbits
 7359              		.globl	mbedtls_ecp_check_privkey
 7361              	mbedtls_ecp_check_privkey:
 7362              	.LFB53:
2636:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2637:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
2638:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Check that an mbedtls_mpi is valid as a private key
2639:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
2640:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_check_privkey( const mbedtls_ecp_group *grp,
2641:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                                const mbedtls_mpi *d )
GAS LISTING /tmp/ccajKZL5.s 			page 207


2642:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 7363              		.loc 1 2642 1
 7364              		.cfi_startproc
 7365 0000 F30F1EFA 		endbr64
 7366 0004 55       		pushq	%rbp
 7367              	.LCFI141:
 7368              		.cfi_def_cfa_offset 16
 7369              		.cfi_offset 6, -16
 7370 0005 4889E5   		movq	%rsp, %rbp
 7371              	.LCFI142:
 7372              		.cfi_def_cfa_register 6
 7373 0008 4883EC20 		subq	$32, %rsp
 7374 000c 48897DE8 		movq	%rdi, -24(%rbp)
 7375 0010 488975E0 		movq	%rsi, -32(%rbp)
 7376              		.loc 1 2642 1
 7377 0014 64488B04 		movq	%fs:40, %rax
 7377      25280000 
 7377      00
 7378 001d 488945F8 		movq	%rax, -8(%rbp)
 7379 0021 31C0     		xorl	%eax, %eax
2643:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( grp != NULL );
2644:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( d   != NULL );
2645:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2646:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(ECP_MONTGOMERY)
2647:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ecp_get_type( grp ) == ECP_TYPE_MONTGOMERY )
2648:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
2649:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* see RFC 7748 sec. 5 para. 5 */
2650:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( mbedtls_mpi_get_bit( d, 0 ) != 0 ||
2651:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             mbedtls_mpi_get_bit( d, 1 ) != 0 ||
2652:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             mbedtls_mpi_bitlen( d ) - 1 != grp->nbits ) /* mbedtls_mpi_bitlen is one-based! */
2653:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             return( MBEDTLS_ERR_ECP_INVALID_KEY );
2654:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2655:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* see [Curve25519] page 5 */
2656:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( grp->nbits == 254 && mbedtls_mpi_get_bit( d, 2 ) != 0 )
2657:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             return( MBEDTLS_ERR_ECP_INVALID_KEY );
2658:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2659:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( 0 );
2660:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
2661:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif /* ECP_MONTGOMERY */
2662:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(ECP_SHORTWEIERSTRASS)
2663:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ecp_get_type( grp ) == ECP_TYPE_SHORT_WEIERSTRASS )
 7380              		.loc 1 2663 9
 7381 0023 488B45E8 		movq	-24(%rbp), %rax
 7382 0027 4889C7   		movq	%rax, %rdi
 7383 002a E8000000 		call	ecp_get_type
 7383      00
 7384              		.loc 1 2663 7
 7385 002f 83F801   		cmpl	$1, %eax
 7386 0032 7541     		jne	.L687
2664:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
2665:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* see SEC1 3.2 */
2666:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( mbedtls_mpi_cmp_int( d, 1 ) < 0 ||
 7387              		.loc 1 2666 13
 7388 0034 488B45E0 		movq	-32(%rbp), %rax
 7389 0038 BE010000 		movl	$1, %esi
 7389      00
 7390 003d 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/ccajKZL5.s 			page 208


 7391 0040 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 7391      00
 7392              		.loc 1 2666 11
 7393 0045 85C0     		testl	%eax, %eax
 7394 0047 781E     		js	.L688
2667:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             mbedtls_mpi_cmp_mpi( d, &grp->N ) >= 0 )
 7395              		.loc 1 2667 13 discriminator 1
 7396 0049 488B45E8 		movq	-24(%rbp), %rax
 7397 004d 488D9098 		leaq	152(%rax), %rdx
 7397      000000
 7398 0054 488B45E0 		movq	-32(%rbp), %rax
 7399 0058 4889D6   		movq	%rdx, %rsi
 7400 005b 4889C7   		movq	%rax, %rdi
 7401 005e E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 7401      00
2666:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             mbedtls_mpi_cmp_mpi( d, &grp->N ) >= 0 )
 7402              		.loc 1 2666 45 discriminator 1
 7403 0063 85C0     		testl	%eax, %eax
 7404 0065 7807     		js	.L689
 7405              	.L688:
2668:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             return( MBEDTLS_ERR_ECP_INVALID_KEY );
 7406              		.loc 1 2668 19
 7407 0067 B880B3FF 		movl	$-19584, %eax
 7407      FF
 7408 006c EB0C     		jmp	.L690
 7409              	.L689:
2669:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         else
2670:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             return( 0 );
 7410              		.loc 1 2670 19
 7411 006e B8000000 		movl	$0, %eax
 7411      00
 7412 0073 EB05     		jmp	.L690
 7413              	.L687:
2671:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
2672:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif /* ECP_SHORTWEIERSTRASS */
2673:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2674:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( MBEDTLS_ERR_ECP_BAD_INPUT_DATA );
 7414              		.loc 1 2674 11
 7415 0075 B880B0FF 		movl	$-20352, %eax
 7415      FF
 7416              	.L690:
2675:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 7417              		.loc 1 2675 1
 7418 007a 488B4DF8 		movq	-8(%rbp), %rcx
 7419 007e 6448330C 		xorq	%fs:40, %rcx
 7419      25280000 
 7419      00
 7420 0087 7405     		je	.L691
 7421 0089 E8000000 		call	__stack_chk_fail@PLT
 7421      00
 7422              	.L691:
 7423 008e C9       		leave
 7424              	.LCFI143:
 7425              		.cfi_def_cfa 7, 8
 7426 008f C3       		ret
 7427              		.cfi_endproc
 7428              	.LFE53:
GAS LISTING /tmp/ccajKZL5.s 			page 209


 7430              		.section	.text.mbedtls_ecp_gen_privkey,"ax",@progbits
 7431              		.globl	mbedtls_ecp_gen_privkey
 7433              	mbedtls_ecp_gen_privkey:
 7434              	.LFB54:
2676:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2677:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
2678:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Generate a private key
2679:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
2680:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_gen_privkey( const mbedtls_ecp_group *grp,
2681:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                      mbedtls_mpi *d,
2682:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                      int (*f_rng)(void *, unsigned char *, size_t),
2683:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                      void *p_rng )
2684:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 7435              		.loc 1 2684 1
 7436              		.cfi_startproc
 7437 0000 F30F1EFA 		endbr64
 7438 0004 55       		pushq	%rbp
 7439              	.LCFI144:
 7440              		.cfi_def_cfa_offset 16
 7441              		.cfi_offset 6, -16
 7442 0005 4889E5   		movq	%rsp, %rbp
 7443              	.LCFI145:
 7444              		.cfi_def_cfa_register 6
 7445 0008 4883EC40 		subq	$64, %rsp
 7446 000c 48897DD8 		movq	%rdi, -40(%rbp)
 7447 0010 488975D0 		movq	%rsi, -48(%rbp)
 7448 0014 488955C8 		movq	%rdx, -56(%rbp)
 7449 0018 48894DC0 		movq	%rcx, -64(%rbp)
 7450              		.loc 1 2684 1
 7451 001c 64488B04 		movq	%fs:40, %rax
 7451      25280000 
 7451      00
 7452 0025 488945F8 		movq	%rax, -8(%rbp)
 7453 0029 31C0     		xorl	%eax, %eax
2685:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret = MBEDTLS_ERR_ECP_BAD_INPUT_DATA;
 7454              		.loc 1 2685 9
 7455 002b C745E880 		movl	$-20352, -24(%rbp)
 7455      B0FFFF
2686:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     size_t n_size;
2687:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2688:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( grp   != NULL );
2689:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( d     != NULL );
2690:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( f_rng != NULL );
2691:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2692:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     n_size = ( grp->nbits + 7 ) / 8;
 7456              		.loc 1 2692 19
 7457 0032 488B45D8 		movq	-40(%rbp), %rax
 7458 0036 488B80B8 		movq	184(%rax), %rax
 7458      000000
 7459              		.loc 1 2692 27
 7460 003d 4883C007 		addq	$7, %rax
 7461              		.loc 1 2692 12
 7462 0041 48C1E803 		shrq	$3, %rax
 7463 0045 488945F0 		movq	%rax, -16(%rbp)
2693:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2694:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(ECP_MONTGOMERY)
2695:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ecp_get_type( grp ) == ECP_TYPE_MONTGOMERY )
GAS LISTING /tmp/ccajKZL5.s 			page 210


2696:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
2697:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* [M225] page 5 */
2698:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         size_t b;
2699:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2700:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         do {
2701:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_fill_random( d, n_size, f_rng, p_rng ) );
2702:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         } while( mbedtls_mpi_bitlen( d ) == 0);
2703:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2704:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* Make sure the most significant bit is nbits */
2705:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         b = mbedtls_mpi_bitlen( d ) - 1; /* mbedtls_mpi_bitlen is one-based */
2706:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( b > grp->nbits )
2707:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_shift_r( d, b - grp->nbits ) );
2708:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         else
2709:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_set_bit( d, grp->nbits, 1 ) );
2710:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2711:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* Make sure the last two bits are unset for Curve448, three bits for
2712:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****            Curve25519 */
2713:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_set_bit( d, 0, 0 ) );
2714:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         MBEDTLS_MPI_CHK( mbedtls_mpi_set_bit( d, 1, 0 ) );
2715:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         if( grp->nbits == 254 )
2716:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         {
2717:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_set_bit( d, 2, 0 ) );
2718:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         }
2719:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
2720:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif /* ECP_MONTGOMERY */
2721:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2722:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #if defined(ECP_SHORTWEIERSTRASS)
2723:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ecp_get_type( grp ) == ECP_TYPE_SHORT_WEIERSTRASS )
 7464              		.loc 1 2723 9
 7465 0049 488B45D8 		movq	-40(%rbp), %rax
 7466 004d 4889C7   		movq	%rax, %rdi
 7467 0050 E8000000 		call	ecp_get_type
 7467      00
 7468              		.loc 1 2723 7
 7469 0055 83F801   		cmpl	$1, %eax
 7470 0058 0F85A200 		jne	.L700
 7470      0000
 7471              	.LBB3:
2724:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
2725:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /* SEC1 3.2.1: Generate d such that 1 <= n < N */
2726:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         int count = 0;
 7472              		.loc 1 2726 13
 7473 005e C745EC00 		movl	$0, -20(%rbp)
 7473      000000
 7474              	.L698:
2727:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2728:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         /*
2729:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          * Match the procedure given in RFC 6979 (deterministic ECDSA):
2730:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          * - use the same byte ordering;
2731:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          * - keep the leftmost nbits bits of the generated octet string;
2732:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          * - try until result is in the desired range.
2733:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          * This also avoids any biais, which is especially important for ECDSA.
2734:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****          */
2735:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         do
2736:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         {
2737:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_fill_random( d, n_size, f_rng, p_rng ) );
 7475              		.loc 1 2737 13
GAS LISTING /tmp/ccajKZL5.s 			page 211


 7476 0065 488B4DC0 		movq	-64(%rbp), %rcx
 7477 0069 488B55C8 		movq	-56(%rbp), %rdx
 7478 006d 488B75F0 		movq	-16(%rbp), %rsi
 7479 0071 488B45D0 		movq	-48(%rbp), %rax
 7480 0075 4889C7   		movq	%rax, %rdi
 7481 0078 E8000000 		call	mbedtls_mpi_fill_random@PLT
 7481      00
 7482 007d 8945E8   		movl	%eax, -24(%rbp)
 7483 0080 837DE800 		cmpl	$0, -24(%rbp)
 7484 0084 757D     		jne	.L701
2738:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_shift_r( d, 8 * n_size - grp->nbits ) );
 7485              		.loc 1 2738 13
 7486 0086 488B45F0 		movq	-16(%rbp), %rax
 7487 008a 488D14C5 		leaq	0(,%rax,8), %rdx
 7487      00000000 
 7488 0092 488B45D8 		movq	-40(%rbp), %rax
 7489 0096 488B80B8 		movq	184(%rax), %rax
 7489      000000
 7490 009d 4829C2   		subq	%rax, %rdx
 7491 00a0 488B45D0 		movq	-48(%rbp), %rax
 7492 00a4 4889D6   		movq	%rdx, %rsi
 7493 00a7 4889C7   		movq	%rax, %rdi
 7494 00aa E8000000 		call	mbedtls_mpi_shift_r@PLT
 7494      00
 7495 00af 8945E8   		movl	%eax, -24(%rbp)
 7496 00b2 837DE800 		cmpl	$0, -24(%rbp)
 7497 00b6 754E     		jne	.L702
2739:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2740:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             /*
2741:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              * Each try has at worst a probability 1/2 of failing (the msb has
2742:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              * a probability 1/2 of being 0, and then the result will be < N),
2743:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              * so after 30 tries failure probability is a most 2**(-30).
2744:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              *
2745:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              * For most curves, 1 try is enough with overwhelming probability,
2746:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              * since N starts with a lot of 1s in binary, but some curves
2747:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              * such as secp224k1 are actually very close to the worst case.
2748:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****              */
2749:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             if( ++count > 30 )
 7498              		.loc 1 2749 15
 7499 00b8 8345EC01 		addl	$1, -20(%rbp)
 7500 00bc 837DEC1E 		cmpl	$30, -20(%rbp)
 7501 00c0 7E07     		jle	.L696
2750:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                 return( MBEDTLS_ERR_ECP_RANDOM_FAILED );
 7502              		.loc 1 2750 23
 7503 00c2 B800B3FF 		movl	$-19712, %eax
 7503      FF
 7504 00c7 EB41     		jmp	.L697
 7505              	.L696:
2751:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         }
2752:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         while( mbedtls_mpi_cmp_int( d, 1 ) < 0 ||
 7506              		.loc 1 2752 16
 7507 00c9 488B45D0 		movq	-48(%rbp), %rax
 7508 00cd BE010000 		movl	$1, %esi
 7508      00
 7509 00d2 4889C7   		movq	%rax, %rdi
 7510 00d5 E8000000 		call	mbedtls_mpi_cmp_int@PLT
 7510      00
GAS LISTING /tmp/ccajKZL5.s 			page 212


2753:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                mbedtls_mpi_cmp_mpi( d, &grp->N ) >= 0 );
 7511              		.loc 1 2753 16
 7512 00da 85C0     		testl	%eax, %eax
 7513 00dc 7887     		js	.L698
 7514              		.loc 1 2753 16 is_stmt 0 discriminator 1
 7515 00de 488B45D8 		movq	-40(%rbp), %rax
 7516 00e2 488D9098 		leaq	152(%rax), %rdx
 7516      000000
 7517 00e9 488B45D0 		movq	-48(%rbp), %rax
 7518 00ed 4889D6   		movq	%rdx, %rsi
 7519 00f0 4889C7   		movq	%rax, %rdi
 7520 00f3 E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 7520      00
2752:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                mbedtls_mpi_cmp_mpi( d, &grp->N ) >= 0 );
 7521              		.loc 1 2752 48 is_stmt 1 discriminator 1
 7522 00f8 85C0     		testl	%eax, %eax
 7523 00fa 0F8965FF 		jns	.L698
 7523      FFFF
 7524              	.L700:
 7525              	.LBE3:
2754:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
2755:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** #endif /* ECP_SHORTWEIERSTRASS */
2756:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2757:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
 7526              		.loc 1 2757 1
 7527 0100 90       		nop
 7528 0101 EB04     		jmp	.L693
 7529              	.L701:
 7530              	.LBB4:
2737:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****             MBEDTLS_MPI_CHK( mbedtls_mpi_shift_r( d, 8 * n_size - grp->nbits ) );
 7531              		.loc 1 2737 13
 7532 0103 90       		nop
 7533 0104 EB01     		jmp	.L693
 7534              	.L702:
2738:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 7535              		.loc 1 2738 13
 7536 0106 90       		nop
 7537              	.L693:
 7538              	.LBE4:
2758:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 7539              		.loc 1 2758 11
 7540 0107 8B45E8   		movl	-24(%rbp), %eax
 7541              	.L697:
2759:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 7542              		.loc 1 2759 1
 7543 010a 488B4DF8 		movq	-8(%rbp), %rcx
 7544 010e 6448330C 		xorq	%fs:40, %rcx
 7544      25280000 
 7544      00
 7545 0117 7405     		je	.L699
 7546 0119 E8000000 		call	__stack_chk_fail@PLT
 7546      00
 7547              	.L699:
 7548 011e C9       		leave
 7549              	.LCFI146:
 7550              		.cfi_def_cfa 7, 8
 7551 011f C3       		ret
GAS LISTING /tmp/ccajKZL5.s 			page 213


 7552              		.cfi_endproc
 7553              	.LFE54:
 7555              		.section	.text.mbedtls_ecp_gen_keypair_base,"ax",@progbits
 7556              		.globl	mbedtls_ecp_gen_keypair_base
 7558              	mbedtls_ecp_gen_keypair_base:
 7559              	.LFB55:
2760:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2761:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
2762:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Generate a keypair with configurable base point
2763:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
2764:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_gen_keypair_base( mbedtls_ecp_group *grp,
2765:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                      const mbedtls_ecp_point *G,
2766:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                      mbedtls_mpi *d, mbedtls_ecp_point *Q,
2767:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                      int (*f_rng)(void *, unsigned char *, size_t),
2768:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                      void *p_rng )
2769:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 7560              		.loc 1 2769 1
 7561              		.cfi_startproc
 7562 0000 F30F1EFA 		endbr64
 7563 0004 55       		pushq	%rbp
 7564              	.LCFI147:
 7565              		.cfi_def_cfa_offset 16
 7566              		.cfi_offset 6, -16
 7567 0005 4889E5   		movq	%rsp, %rbp
 7568              	.LCFI148:
 7569              		.cfi_def_cfa_register 6
 7570 0008 4883EC40 		subq	$64, %rsp
 7571 000c 48897DE8 		movq	%rdi, -24(%rbp)
 7572 0010 488975E0 		movq	%rsi, -32(%rbp)
 7573 0014 488955D8 		movq	%rdx, -40(%rbp)
 7574 0018 48894DD0 		movq	%rcx, -48(%rbp)
 7575 001c 4C8945C8 		movq	%r8, -56(%rbp)
 7576 0020 4C894DC0 		movq	%r9, -64(%rbp)
 7577              		.loc 1 2769 1
 7578 0024 64488B04 		movq	%fs:40, %rax
 7578      25280000 
 7578      00
 7579 002d 488945F8 		movq	%rax, -8(%rbp)
 7580 0031 31C0     		xorl	%eax, %eax
2770:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
2771:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( grp   != NULL );
2772:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( d     != NULL );
2773:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( G     != NULL );
2774:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( Q     != NULL );
2775:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( f_rng != NULL );
2776:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2777:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_ecp_gen_privkey( grp, d, f_rng, p_rng ) );
 7581              		.loc 1 2777 5
 7582 0033 488B4DC0 		movq	-64(%rbp), %rcx
 7583 0037 488B55C8 		movq	-56(%rbp), %rdx
 7584 003b 488B75D8 		movq	-40(%rbp), %rsi
 7585 003f 488B45E8 		movq	-24(%rbp), %rax
 7586 0043 4889C7   		movq	%rax, %rdi
 7587 0046 E8000000 		call	mbedtls_ecp_gen_privkey
 7587      00
 7588 004b 8945F4   		movl	%eax, -12(%rbp)
 7589 004e 837DF400 		cmpl	$0, -12(%rbp)
GAS LISTING /tmp/ccajKZL5.s 			page 214


 7590 0052 752F     		jne	.L708
2778:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_ecp_mul( grp, Q, d, G, f_rng, p_rng ) );
 7591              		.loc 1 2778 5
 7592 0054 4C8B45C0 		movq	-64(%rbp), %r8
 7593 0058 488B7DC8 		movq	-56(%rbp), %rdi
 7594 005c 488B4DE0 		movq	-32(%rbp), %rcx
 7595 0060 488B55D8 		movq	-40(%rbp), %rdx
 7596 0064 488B75D0 		movq	-48(%rbp), %rsi
 7597 0068 488B45E8 		movq	-24(%rbp), %rax
 7598 006c 4D89C1   		movq	%r8, %r9
 7599 006f 4989F8   		movq	%rdi, %r8
 7600 0072 4889C7   		movq	%rax, %rdi
 7601 0075 E8000000 		call	mbedtls_ecp_mul
 7601      00
 7602 007a 8945F4   		movl	%eax, -12(%rbp)
 7603 007d 837DF400 		cmpl	$0, -12(%rbp)
2779:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2780:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
 7604              		.loc 1 2780 1
 7605 0081 EB01     		jmp	.L705
 7606              	.L708:
2777:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_ecp_mul( grp, Q, d, G, f_rng, p_rng ) );
 7607              		.loc 1 2777 5
 7608 0083 90       		nop
 7609              	.L705:
2781:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 7610              		.loc 1 2781 11
 7611 0084 8B45F4   		movl	-12(%rbp), %eax
2782:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 7612              		.loc 1 2782 1
 7613 0087 488B7DF8 		movq	-8(%rbp), %rdi
 7614 008b 6448333C 		xorq	%fs:40, %rdi
 7614      25280000 
 7614      00
 7615 0094 7405     		je	.L707
 7616 0096 E8000000 		call	__stack_chk_fail@PLT
 7616      00
 7617              	.L707:
 7618 009b C9       		leave
 7619              	.LCFI149:
 7620              		.cfi_def_cfa 7, 8
 7621 009c C3       		ret
 7622              		.cfi_endproc
 7623              	.LFE55:
 7625              		.section	.text.mbedtls_ecp_gen_keypair,"ax",@progbits
 7626              		.globl	mbedtls_ecp_gen_keypair
 7628              	mbedtls_ecp_gen_keypair:
 7629              	.LFB56:
2783:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2784:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
2785:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Generate key pair, wrapper for conventional base point
2786:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
2787:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_gen_keypair( mbedtls_ecp_group *grp,
2788:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                              mbedtls_mpi *d, mbedtls_ecp_point *Q,
2789:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                              int (*f_rng)(void *, unsigned char *, size_t),
2790:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                              void *p_rng )
2791:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
GAS LISTING /tmp/ccajKZL5.s 			page 215


 7630              		.loc 1 2791 1
 7631              		.cfi_startproc
 7632 0000 F30F1EFA 		endbr64
 7633 0004 55       		pushq	%rbp
 7634              	.LCFI150:
 7635              		.cfi_def_cfa_offset 16
 7636              		.cfi_offset 6, -16
 7637 0005 4889E5   		movq	%rsp, %rbp
 7638              	.LCFI151:
 7639              		.cfi_def_cfa_register 6
 7640 0008 4883EC40 		subq	$64, %rsp
 7641 000c 48897DE8 		movq	%rdi, -24(%rbp)
 7642 0010 488975E0 		movq	%rsi, -32(%rbp)
 7643 0014 488955D8 		movq	%rdx, -40(%rbp)
 7644 0018 48894DD0 		movq	%rcx, -48(%rbp)
 7645 001c 4C8945C8 		movq	%r8, -56(%rbp)
 7646              		.loc 1 2791 1
 7647 0020 64488B04 		movq	%fs:40, %rax
 7647      25280000 
 7647      00
 7648 0029 488945F8 		movq	%rax, -8(%rbp)
 7649 002d 31C0     		xorl	%eax, %eax
2792:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( grp   != NULL );
2793:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( d     != NULL );
2794:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( Q     != NULL );
2795:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( f_rng != NULL );
2796:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2797:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( mbedtls_ecp_gen_keypair_base( grp, &grp->G, d, Q, f_rng, p_rng ) );
 7650              		.loc 1 2797 48
 7651 002f 488B45E8 		movq	-24(%rbp), %rax
 7652 0033 488D7050 		leaq	80(%rax), %rsi
 7653              		.loc 1 2797 13
 7654 0037 4C8B45C8 		movq	-56(%rbp), %r8
 7655 003b 488B7DD0 		movq	-48(%rbp), %rdi
 7656 003f 488B4DD8 		movq	-40(%rbp), %rcx
 7657 0043 488B55E0 		movq	-32(%rbp), %rdx
 7658 0047 488B45E8 		movq	-24(%rbp), %rax
 7659 004b 4D89C1   		movq	%r8, %r9
 7660 004e 4989F8   		movq	%rdi, %r8
 7661 0051 4889C7   		movq	%rax, %rdi
 7662 0054 E8000000 		call	mbedtls_ecp_gen_keypair_base
 7662      00
2798:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 7663              		.loc 1 2798 1
 7664 0059 488B55F8 		movq	-8(%rbp), %rdx
 7665 005d 64483314 		xorq	%fs:40, %rdx
 7665      25280000 
 7665      00
 7666 0066 7405     		je	.L711
 7667 0068 E8000000 		call	__stack_chk_fail@PLT
 7667      00
 7668              	.L711:
 7669 006d C9       		leave
 7670              	.LCFI152:
 7671              		.cfi_def_cfa 7, 8
 7672 006e C3       		ret
 7673              		.cfi_endproc
GAS LISTING /tmp/ccajKZL5.s 			page 216


 7674              	.LFE56:
 7676              		.section	.text.mbedtls_ecp_gen_key,"ax",@progbits
 7677              		.globl	mbedtls_ecp_gen_key
 7679              	mbedtls_ecp_gen_key:
 7680              	.LFB57:
2799:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2800:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
2801:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Generate a keypair, prettier wrapper
2802:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
2803:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_gen_key( mbedtls_ecp_group_id grp_id, mbedtls_ecp_keypair *key,
2804:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****                 int (*f_rng)(void *, unsigned char *, size_t), void *p_rng )
2805:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 7681              		.loc 1 2805 1
 7682              		.cfi_startproc
 7683 0000 F30F1EFA 		endbr64
 7684 0004 55       		pushq	%rbp
 7685              	.LCFI153:
 7686              		.cfi_def_cfa_offset 16
 7687              		.cfi_offset 6, -16
 7688 0005 4889E5   		movq	%rsp, %rbp
 7689              	.LCFI154:
 7690              		.cfi_def_cfa_register 6
 7691 0008 4883EC30 		subq	$48, %rsp
 7692 000c 897DEC   		movl	%edi, -20(%rbp)
 7693 000f 488975E0 		movq	%rsi, -32(%rbp)
 7694 0013 488955D8 		movq	%rdx, -40(%rbp)
 7695 0017 48894DD0 		movq	%rcx, -48(%rbp)
 7696              		.loc 1 2805 1
 7697 001b 64488B04 		movq	%fs:40, %rax
 7697      25280000 
 7697      00
 7698 0024 488945F8 		movq	%rax, -8(%rbp)
 7699 0028 31C0     		xorl	%eax, %eax
2806:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
2807:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( key   != NULL );
2808:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( f_rng != NULL );
2809:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2810:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( ( ret = mbedtls_ecp_group_load( &key->grp, grp_id ) ) != 0 )
 7700              		.loc 1 2810 17
 7701 002a 488B45E0 		movq	-32(%rbp), %rax
 7702 002e 8B55EC   		movl	-20(%rbp), %edx
 7703 0031 89D6     		movl	%edx, %esi
 7704 0033 4889C7   		movq	%rax, %rdi
 7705 0036 E8000000 		call	mbedtls_ecp_group_load@PLT
 7705      00
 7706 003b 8945F4   		movl	%eax, -12(%rbp)
 7707              		.loc 1 2810 7
 7708 003e 837DF400 		cmpl	$0, -12(%rbp)
 7709 0042 7405     		je	.L713
2811:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( ret );
 7710              		.loc 1 2811 15
 7711 0044 8B45F4   		movl	-12(%rbp), %eax
 7712 0047 EB33     		jmp	.L714
 7713              	.L713:
2812:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2813:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( mbedtls_ecp_gen_keypair( &key->grp, &key->d, &key->Q, f_rng, p_rng ) );
 7714              		.loc 1 2813 13
GAS LISTING /tmp/ccajKZL5.s 			page 217


 7715 0049 488B45E0 		movq	-32(%rbp), %rax
 7716 004d 488DB810 		leaq	272(%rax), %rdi
 7716      010000
 7717 0054 488B45E0 		movq	-32(%rbp), %rax
 7718 0058 488DB0F8 		leaq	248(%rax), %rsi
 7718      000000
 7719 005f 488B45E0 		movq	-32(%rbp), %rax
 7720 0063 488B4DD0 		movq	-48(%rbp), %rcx
 7721 0067 488B55D8 		movq	-40(%rbp), %rdx
 7722 006b 4989C8   		movq	%rcx, %r8
 7723 006e 4889D1   		movq	%rdx, %rcx
 7724 0071 4889FA   		movq	%rdi, %rdx
 7725 0074 4889C7   		movq	%rax, %rdi
 7726 0077 E8000000 		call	mbedtls_ecp_gen_keypair
 7726      00
 7727              	.L714:
2814:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 7728              		.loc 1 2814 1
 7729 007c 488B4DF8 		movq	-8(%rbp), %rcx
 7730 0080 6448330C 		xorq	%fs:40, %rcx
 7730      25280000 
 7730      00
 7731 0089 7405     		je	.L715
 7732 008b E8000000 		call	__stack_chk_fail@PLT
 7732      00
 7733              	.L715:
 7734 0090 C9       		leave
 7735              	.LCFI155:
 7736              		.cfi_def_cfa 7, 8
 7737 0091 C3       		ret
 7738              		.cfi_endproc
 7739              	.LFE57:
 7741              		.section	.text.mbedtls_ecp_check_pub_priv,"ax",@progbits
 7742              		.globl	mbedtls_ecp_check_pub_priv
 7744              	mbedtls_ecp_check_pub_priv:
 7745              	.LFB58:
2815:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2816:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** /*
2817:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  * Check a public-private key pair
2818:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****  */
2819:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** int mbedtls_ecp_check_pub_priv( const mbedtls_ecp_keypair *pub, const mbedtls_ecp_keypair *prv )
2820:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** {
 7746              		.loc 1 2820 1
 7747              		.cfi_startproc
 7748 0000 F30F1EFA 		endbr64
 7749 0004 55       		pushq	%rbp
 7750              	.LCFI156:
 7751              		.cfi_def_cfa_offset 16
 7752              		.cfi_offset 6, -16
 7753 0005 4889E5   		movq	%rsp, %rbp
 7754              	.LCFI157:
 7755              		.cfi_def_cfa_register 6
 7756 0008 4881EC70 		subq	$368, %rsp
 7756      010000
 7757 000f 4889BD98 		movq	%rdi, -360(%rbp)
 7757      FEFFFF
 7758 0016 4889B590 		movq	%rsi, -368(%rbp)
GAS LISTING /tmp/ccajKZL5.s 			page 218


 7758      FEFFFF
 7759              		.loc 1 2820 1
 7760 001d 64488B04 		movq	%fs:40, %rax
 7760      25280000 
 7760      00
 7761 0026 488945F8 		movq	%rax, -8(%rbp)
 7762 002a 31C0     		xorl	%eax, %eax
2821:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     int ret;
2822:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point Q;
2823:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_group grp;
2824:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( pub != NULL );
2825:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     ECP_VALIDATE_RET( prv != NULL );
2826:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2827:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( pub->grp.id == MBEDTLS_ECP_DP_NONE ||
 7763              		.loc 1 2827 17
 7764 002c 488B8598 		movq	-360(%rbp), %rax
 7764      FEFFFF
 7765 0033 8B00     		movl	(%rax), %eax
 7766              		.loc 1 2827 7
 7767 0035 85C0     		testl	%eax, %eax
 7768 0037 0F849400 		je	.L717
 7768      0000
2828:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         pub->grp.id != prv->grp.id ||
 7769              		.loc 1 2828 17 discriminator 1
 7770 003d 488B8598 		movq	-360(%rbp), %rax
 7770      FEFFFF
 7771 0044 8B10     		movl	(%rax), %edx
 7772              		.loc 1 2828 32 discriminator 1
 7773 0046 488B8590 		movq	-368(%rbp), %rax
 7773      FEFFFF
 7774 004d 8B00     		movl	(%rax), %eax
2827:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         pub->grp.id != prv->grp.id ||
 7775              		.loc 1 2827 44 discriminator 1
 7776 004f 39C2     		cmpl	%eax, %edx
 7777 0051 757E     		jne	.L717
2829:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_cmp_mpi( &pub->Q.X, &prv->Q.X ) ||
 7778              		.loc 1 2829 9
 7779 0053 488B8590 		movq	-368(%rbp), %rax
 7779      FEFFFF
 7780 005a 488D9010 		leaq	272(%rax), %rdx
 7780      010000
 7781 0061 488B8598 		movq	-360(%rbp), %rax
 7781      FEFFFF
 7782 0068 48051001 		addq	$272, %rax
 7782      0000
 7783 006e 4889D6   		movq	%rdx, %rsi
 7784 0071 4889C7   		movq	%rax, %rdi
 7785 0074 E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 7785      00
2828:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         pub->grp.id != prv->grp.id ||
 7786              		.loc 1 2828 36
 7787 0079 85C0     		testl	%eax, %eax
 7788 007b 7554     		jne	.L717
2830:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_cmp_mpi( &pub->Q.Y, &prv->Q.Y ) ||
 7789              		.loc 1 2830 9
 7790 007d 488B8590 		movq	-368(%rbp), %rax
 7790      FEFFFF
GAS LISTING /tmp/ccajKZL5.s 			page 219


 7791 0084 488D9028 		leaq	296(%rax), %rdx
 7791      010000
 7792 008b 488B8598 		movq	-360(%rbp), %rax
 7792      FEFFFF
 7793 0092 48052801 		addq	$296, %rax
 7793      0000
 7794 0098 4889D6   		movq	%rdx, %rsi
 7795 009b 4889C7   		movq	%rax, %rdi
 7796 009e E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 7796      00
2829:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_cmp_mpi( &pub->Q.X, &prv->Q.X ) ||
 7797              		.loc 1 2829 53
 7798 00a3 85C0     		testl	%eax, %eax
 7799 00a5 752A     		jne	.L717
2831:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_cmp_mpi( &pub->Q.Z, &prv->Q.Z ) )
 7800              		.loc 1 2831 9
 7801 00a7 488B8590 		movq	-368(%rbp), %rax
 7801      FEFFFF
 7802 00ae 488D9040 		leaq	320(%rax), %rdx
 7802      010000
 7803 00b5 488B8598 		movq	-360(%rbp), %rax
 7803      FEFFFF
 7804 00bc 48054001 		addq	$320, %rax
 7804      0000
 7805 00c2 4889D6   		movq	%rdx, %rsi
 7806 00c5 4889C7   		movq	%rax, %rdi
 7807 00c8 E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 7807      00
2830:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_cmp_mpi( &pub->Q.Y, &prv->Q.Y ) ||
 7808              		.loc 1 2830 53
 7809 00cd 85C0     		testl	%eax, %eax
 7810 00cf 740A     		je	.L718
 7811              	.L717:
2832:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
2833:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         return( MBEDTLS_ERR_ECP_BAD_INPUT_DATA );
 7812              		.loc 1 2833 15
 7813 00d1 B880B0FF 		movl	$-20352, %eax
 7813      FF
 7814 00d6 E92D0100 		jmp	.L723
 7814      00
 7815              	.L718:
2834:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
2835:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2836:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point_init( &Q );
 7816              		.loc 1 2836 5
 7817 00db 488D85B0 		leaq	-336(%rbp), %rax
 7817      FEFFFF
 7818 00e2 4889C7   		movq	%rax, %rdi
 7819 00e5 E8000000 		call	mbedtls_ecp_point_init
 7819      00
2837:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_group_init( &grp );
 7820              		.loc 1 2837 5
 7821 00ea 488D8500 		leaq	-256(%rbp), %rax
 7821      FFFFFF
 7822 00f1 4889C7   		movq	%rax, %rdi
 7823 00f4 E8000000 		call	mbedtls_ecp_group_init
 7823      00
GAS LISTING /tmp/ccajKZL5.s 			page 220


2838:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2839:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* mbedtls_ecp_mul() needs a non-const group... */
2840:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_group_copy( &grp, &prv->grp );
 7824              		.loc 1 2840 5
 7825 00f9 488B9590 		movq	-368(%rbp), %rdx
 7825      FEFFFF
 7826 0100 488D8500 		leaq	-256(%rbp), %rax
 7826      FFFFFF
 7827 0107 4889D6   		movq	%rdx, %rsi
 7828 010a 4889C7   		movq	%rax, %rdi
 7829 010d E8000000 		call	mbedtls_ecp_group_copy
 7829      00
2841:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2842:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     /* Also checks d is valid */
2843:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     MBEDTLS_MPI_CHK( mbedtls_ecp_mul( &grp, &Q, &prv->d, &prv->grp.G, NULL, NULL ) );
 7830              		.loc 1 2843 5
 7831 0112 488B8590 		movq	-368(%rbp), %rax
 7831      FEFFFF
 7832 0119 488D4850 		leaq	80(%rax), %rcx
 7833 011d 488B8590 		movq	-368(%rbp), %rax
 7833      FEFFFF
 7834 0124 488D90F8 		leaq	248(%rax), %rdx
 7834      000000
 7835 012b 488DB5B0 		leaq	-336(%rbp), %rsi
 7835      FEFFFF
 7836 0132 488D8500 		leaq	-256(%rbp), %rax
 7836      FFFFFF
 7837 0139 41B90000 		movl	$0, %r9d
 7837      0000
 7838 013f 41B80000 		movl	$0, %r8d
 7838      0000
 7839 0145 4889C7   		movq	%rax, %rdi
 7840 0148 E8000000 		call	mbedtls_ecp_mul
 7840      00
 7841 014d 8985ACFE 		movl	%eax, -340(%rbp)
 7841      FFFF
 7842 0153 83BDACFE 		cmpl	$0, -340(%rbp)
 7842      FFFF00
 7843 015a 0F858000 		jne	.L725
 7843      0000
2844:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2845:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     if( mbedtls_mpi_cmp_mpi( &Q.X, &prv->Q.X ) ||
 7844              		.loc 1 2845 9
 7845 0160 488B8590 		movq	-368(%rbp), %rax
 7845      FEFFFF
 7846 0167 488D9010 		leaq	272(%rax), %rdx
 7846      010000
 7847 016e 488D85B0 		leaq	-336(%rbp), %rax
 7847      FEFFFF
 7848 0175 4889D6   		movq	%rdx, %rsi
 7849 0178 4889C7   		movq	%rax, %rdi
 7850 017b E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 7850      00
 7851              		.loc 1 2845 7
 7852 0180 85C0     		testl	%eax, %eax
 7853 0182 7550     		jne	.L722
2846:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_cmp_mpi( &Q.Y, &prv->Q.Y ) ||
GAS LISTING /tmp/ccajKZL5.s 			page 221


 7854              		.loc 1 2846 9 discriminator 1
 7855 0184 488B8590 		movq	-368(%rbp), %rax
 7855      FEFFFF
 7856 018b 488D9028 		leaq	296(%rax), %rdx
 7856      010000
 7857 0192 488D85B0 		leaq	-336(%rbp), %rax
 7857      FEFFFF
 7858 0199 4883C018 		addq	$24, %rax
 7859 019d 4889D6   		movq	%rdx, %rsi
 7860 01a0 4889C7   		movq	%rax, %rdi
 7861 01a3 E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 7861      00
2845:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_cmp_mpi( &Q.Y, &prv->Q.Y ) ||
 7862              		.loc 1 2845 48 discriminator 1
 7863 01a8 85C0     		testl	%eax, %eax
 7864 01aa 7528     		jne	.L722
2847:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_cmp_mpi( &Q.Z, &prv->Q.Z ) )
 7865              		.loc 1 2847 9
 7866 01ac 488B8590 		movq	-368(%rbp), %rax
 7866      FEFFFF
 7867 01b3 488D9040 		leaq	320(%rax), %rdx
 7867      010000
 7868 01ba 488D85B0 		leaq	-336(%rbp), %rax
 7868      FEFFFF
 7869 01c1 4883C030 		addq	$48, %rax
 7870 01c5 4889D6   		movq	%rdx, %rsi
 7871 01c8 4889C7   		movq	%rax, %rdi
 7872 01cb E8000000 		call	mbedtls_mpi_cmp_mpi@PLT
 7872      00
2846:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         mbedtls_mpi_cmp_mpi( &Q.Y, &prv->Q.Y ) ||
 7873              		.loc 1 2846 48
 7874 01d0 85C0     		testl	%eax, %eax
 7875 01d2 740F     		je	.L726
 7876              	.L722:
2848:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     {
2849:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         ret = MBEDTLS_ERR_ECP_BAD_INPUT_DATA;
 7877              		.loc 1 2849 13
 7878 01d4 C785ACFE 		movl	$-20352, -340(%rbp)
 7878      FFFF80B0 
 7878      FFFF
2850:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****         goto cleanup;
 7879              		.loc 1 2850 9
 7880 01de EB04     		jmp	.L721
 7881              	.L725:
2843:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
 7882              		.loc 1 2843 5
 7883 01e0 90       		nop
 7884 01e1 EB01     		jmp	.L721
 7885              	.L726:
2851:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     }
2852:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2853:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** cleanup:
 7886              		.loc 1 2853 1
 7887 01e3 90       		nop
 7888              	.L721:
2854:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_point_free( &Q );
 7889              		.loc 1 2854 5
GAS LISTING /tmp/ccajKZL5.s 			page 222


 7890 01e4 488D85B0 		leaq	-336(%rbp), %rax
 7890      FEFFFF
 7891 01eb 4889C7   		movq	%rax, %rdi
 7892 01ee E8000000 		call	mbedtls_ecp_point_free
 7892      00
2855:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     mbedtls_ecp_group_free( &grp );
 7893              		.loc 1 2855 5
 7894 01f3 488D8500 		leaq	-256(%rbp), %rax
 7894      FFFFFF
 7895 01fa 4889C7   		movq	%rax, %rdi
 7896 01fd E8000000 		call	mbedtls_ecp_group_free
 7896      00
2856:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** 
2857:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c ****     return( ret );
 7897              		.loc 1 2857 11
 7898 0202 8B85ACFE 		movl	-340(%rbp), %eax
 7898      FFFF
 7899              	.L723:
2858:/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/library/ecp.c **** }
 7900              		.loc 1 2858 1 discriminator 1
 7901 0208 488B4DF8 		movq	-8(%rbp), %rcx
 7902 020c 6448330C 		xorq	%fs:40, %rcx
 7902      25280000 
 7902      00
 7903 0215 7405     		je	.L724
 7904              		.loc 1 2858 1 is_stmt 0
 7905 0217 E8000000 		call	__stack_chk_fail@PLT
 7905      00
 7906              	.L724:
 7907 021c C9       		leave
 7908              	.LCFI158:
 7909              		.cfi_def_cfa 7, 8
 7910 021d C3       		ret
 7911              		.cfi_endproc
 7912              	.LFE58:
 7914              		.section	.bss.init_done.3593,"aw",@nobits
 7915              		.align 4
 7918              	init_done.3593:
 7919 0000 00000000 		.zero	4
 7920              		.text
 7921              	.Letext0:
 7922              		.file 2 "/usr/lib/gcc/x86_64-linux-gnu/9/include/stddef.h"
 7923              		.file 3 "/usr/include/x86_64-linux-gnu/bits/types.h"
 7924              		.file 4 "/usr/include/x86_64-linux-gnu/bits/stdint-uintn.h"
 7925              		.file 5 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/bignum.
 7926              		.file 6 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/ecp.h"
 7927              		.file 7 "/usr/include/x86_64-linux-gnu/bits/types/struct_FILE.h"
 7928              		.file 8 "/usr/include/x86_64-linux-gnu/bits/types/FILE.h"
 7929              		.file 9 "/usr/include/stdio.h"
 7930              		.file 10 "/usr/include/x86_64-linux-gnu/bits/sys_errlist.h"
 7931              		.file 11 "/usr/include/time.h"
 7932              		.file 12 "/home/xingli/share/LiteOS_Lab/network/dtls/mbedtls/mbedtls-2.16.2/include/mbedtls/platfo
 14909              		.section	.note.gnu.property,"a"
 14910              		.align 8
 14911 0000 04000000 		.long	 1f - 0f
 14912 0004 10000000 		.long	 4f - 1f
 14913 0008 05000000 		.long	 5
GAS LISTING /tmp/ccajKZL5.s 			page 223


 14914              	0:
 14915 000c 474E5500 		.string	 "GNU"
 14916              	1:
 14917              		.align 8
 14918 0010 020000C0 		.long	 0xc0000002
 14919 0014 04000000 		.long	 3f - 2f
 14920              	2:
 14921 0018 03000000 		.long	 0x3
 14922              	3:
 14923 001c 00000000 		.align 8
 14924              	4:
GAS LISTING /tmp/ccajKZL5.s 			page 224


DEFINED SYMBOLS
                            *ABS*:0000000000000000 ecp.c
     /tmp/ccajKZL5.s:25     .data.rel.ro.local.ecp_supported_curves:0000000000000000 ecp_supported_curves
     /tmp/ccajKZL5.s:66     .bss.ecp_supported_grp_id:0000000000000000 ecp_supported_grp_id
     /tmp/ccajKZL5.s:71     .text.mbedtls_ecp_curve_list:0000000000000000 mbedtls_ecp_curve_list
     /tmp/ccajKZL5.s:107    .text.mbedtls_ecp_grp_id_list:0000000000000000 mbedtls_ecp_grp_id_list
     /tmp/ccajKZL5.s:7918   .bss.init_done.3593:0000000000000000 init_done.3593
     /tmp/ccajKZL5.s:185    .text.mbedtls_ecp_curve_info_from_grp_id:0000000000000000 mbedtls_ecp_curve_info_from_grp_id
     /tmp/ccajKZL5.s:247    .text.mbedtls_ecp_curve_info_from_tls_id:0000000000000000 mbedtls_ecp_curve_info_from_tls_id
     /tmp/ccajKZL5.s:310    .text.mbedtls_ecp_curve_info_from_name:0000000000000000 mbedtls_ecp_curve_info_from_name
     /tmp/ccajKZL5.s:382    .text.ecp_get_type:0000000000000000 ecp_get_type
     /tmp/ccajKZL5.s:438    .text.mbedtls_ecp_point_init:0000000000000000 mbedtls_ecp_point_init
     /tmp/ccajKZL5.s:487    .text.mbedtls_ecp_group_init:0000000000000000 mbedtls_ecp_group_init
     /tmp/ccajKZL5.s:577    .text.mbedtls_ecp_keypair_init:0000000000000000 mbedtls_ecp_keypair_init
     /tmp/ccajKZL5.s:626    .text.mbedtls_ecp_point_free:0000000000000000 mbedtls_ecp_point_free
     /tmp/ccajKZL5.s:682    .text.mbedtls_ecp_group_free:0000000000000000 mbedtls_ecp_group_free
     /tmp/ccajKZL5.s:801    .text.mbedtls_ecp_keypair_free:0000000000000000 mbedtls_ecp_keypair_free
     /tmp/ccajKZL5.s:857    .text.mbedtls_ecp_copy:0000000000000000 mbedtls_ecp_copy
     /tmp/ccajKZL5.s:934    .text.mbedtls_ecp_group_copy:0000000000000000 mbedtls_ecp_group_copy
     /tmp/ccajKZL5.s:976    .text.mbedtls_ecp_set_zero:0000000000000000 mbedtls_ecp_set_zero
     /tmp/ccajKZL5.s:1047   .text.mbedtls_ecp_is_zero:0000000000000000 mbedtls_ecp_is_zero
     /tmp/ccajKZL5.s:1092   .text.mbedtls_ecp_point_cmp:0000000000000000 mbedtls_ecp_point_cmp
     /tmp/ccajKZL5.s:1165   .text.mbedtls_ecp_point_read_string:0000000000000000 mbedtls_ecp_point_read_string
     /tmp/ccajKZL5.s:1243   .text.mbedtls_ecp_point_write_binary:0000000000000000 mbedtls_ecp_point_write_binary
     /tmp/ccajKZL5.s:1419   .text.mbedtls_ecp_point_read_binary:0000000000000000 mbedtls_ecp_point_read_binary
     /tmp/ccajKZL5.s:1556   .text.mbedtls_ecp_tls_read_point:0000000000000000 mbedtls_ecp_tls_read_point
     /tmp/ccajKZL5.s:1645   .text.mbedtls_ecp_tls_write_point:0000000000000000 mbedtls_ecp_tls_write_point
     /tmp/ccajKZL5.s:1730   .text.mbedtls_ecp_tls_read_group:0000000000000000 mbedtls_ecp_tls_read_group
     /tmp/ccajKZL5.s:1789   .text.mbedtls_ecp_tls_read_group_id:0000000000000000 mbedtls_ecp_tls_read_group_id
     /tmp/ccajKZL5.s:1895   .text.mbedtls_ecp_tls_write_group:0000000000000000 mbedtls_ecp_tls_write_group
     /tmp/ccajKZL5.s:1982   .text.ecp_modp:0000000000000000 ecp_modp
     /tmp/ccajKZL5.s:2145   .text.ecp_normalize_jac:0000000000000000 ecp_normalize_jac
     /tmp/ccajKZL5.s:2353   .text.ecp_normalize_jac_many:0000000000000000 ecp_normalize_jac_many
     /tmp/ccajKZL5.s:2894   .text.ecp_safe_invert_jac:0000000000000000 ecp_safe_invert_jac
     /tmp/ccajKZL5.s:2982   .text.ecp_double_jac:0000000000000000 ecp_double_jac
     /tmp/ccajKZL5.s:3993   .text.ecp_add_mixed:0000000000000000 ecp_add_mixed
     /tmp/ccajKZL5.s:4837   .text.ecp_randomize_jac:0000000000000000 ecp_randomize_jac
     /tmp/ccajKZL5.s:5101   .text.ecp_comb_recode_core:0000000000000000 ecp_comb_recode_core
     /tmp/ccajKZL5.s:5314   .text.ecp_precompute_comb:0000000000000000 ecp_precompute_comb
     /tmp/ccajKZL5.s:5612   .text.ecp_select_comb:0000000000000000 ecp_select_comb
     /tmp/ccajKZL5.s:5738   .text.ecp_mul_comb_core:0000000000000000 ecp_mul_comb_core
     /tmp/ccajKZL5.s:5905   .text.ecp_comb_recode_scalar:0000000000000000 ecp_comb_recode_scalar
     /tmp/ccajKZL5.s:6041   .text.ecp_mul_comb_after_precomp:0000000000000000 ecp_mul_comb_after_precomp
     /tmp/ccajKZL5.s:6161   .text.ecp_pick_window_size:0000000000000000 ecp_pick_window_size
     /tmp/ccajKZL5.s:6238   .text.ecp_mul_comb:0000000000000000 ecp_mul_comb
     /tmp/ccajKZL5.s:6508   .text.mbedtls_ecp_mul_restartable:0000000000000000 mbedtls_ecp_mul_restartable
     /tmp/ccajKZL5.s:7361   .text.mbedtls_ecp_check_privkey:0000000000000000 mbedtls_ecp_check_privkey
     /tmp/ccajKZL5.s:7295   .text.mbedtls_ecp_check_pubkey:0000000000000000 mbedtls_ecp_check_pubkey
     /tmp/ccajKZL5.s:6610   .text.mbedtls_ecp_mul:0000000000000000 mbedtls_ecp_mul
     /tmp/ccajKZL5.s:6662   .text.ecp_check_pubkey_sw:0000000000000000 ecp_check_pubkey_sw
     /tmp/ccajKZL5.s:6997   .text.mbedtls_ecp_mul_shortcuts:0000000000000000 mbedtls_ecp_mul_shortcuts
     /tmp/ccajKZL5.s:7116   .text.mbedtls_ecp_muladd_restartable:0000000000000000 mbedtls_ecp_muladd_restartable
     /tmp/ccajKZL5.s:7242   .text.mbedtls_ecp_muladd:0000000000000000 mbedtls_ecp_muladd
     /tmp/ccajKZL5.s:7433   .text.mbedtls_ecp_gen_privkey:0000000000000000 mbedtls_ecp_gen_privkey
     /tmp/ccajKZL5.s:7558   .text.mbedtls_ecp_gen_keypair_base:0000000000000000 mbedtls_ecp_gen_keypair_base
     /tmp/ccajKZL5.s:7628   .text.mbedtls_ecp_gen_keypair:0000000000000000 mbedtls_ecp_gen_keypair
     /tmp/ccajKZL5.s:7679   .text.mbedtls_ecp_gen_key:0000000000000000 mbedtls_ecp_gen_key
GAS LISTING /tmp/ccajKZL5.s 			page 225


     /tmp/ccajKZL5.s:7744   .text.mbedtls_ecp_check_pub_priv:0000000000000000 mbedtls_ecp_check_pub_priv

UNDEFINED SYMBOLS
_GLOBAL_OFFSET_TABLE_
__stack_chk_fail
strcmp
mbedtls_mpi_init
mbedtls_mpi_free
mbedtls_free
mbedtls_platform_zeroize
mbedtls_mpi_copy
mbedtls_ecp_group_load
mbedtls_mpi_lset
mbedtls_mpi_cmp_int
mbedtls_mpi_cmp_mpi
mbedtls_mpi_read_string
mbedtls_mpi_size
mbedtls_mpi_write_binary
mbedtls_mpi_get_bit
mbedtls_mpi_read_binary
mbedtls_mpi_mod_mpi
mbedtls_mpi_bitlen
mbedtls_mpi_add_mpi
mbedtls_mpi_sub_abs
mbedtls_mpi_inv_mod
mbedtls_mpi_mul_mpi
mbedtls_calloc
mbedtls_mpi_shrink
mbedtls_mpi_sub_mpi
mbedtls_mpi_safe_cond_assign
mbedtls_mpi_mul_int
mbedtls_mpi_shift_l
mbedtls_mpi_fill_random
mbedtls_mpi_shift_r
memset
mbedtls_mpi_sub_int
